let balls,ground,tempBall,canDrop,nextBall,cloudBall,cloud;let images=["assets/cherry.png","assets/strawberry.png","assets/grape.png","assets/lemon.png","assets/orange.png","assets/apple.png","assets/whitefruit.png","assets/peach.png","assets/pineapple.png","assets/honeydew.png","assets/watermelon.png"];let points=[1,3,6,10,15,21,28,36,45,55,66,78];let diameters=[30,46,75,80,100,125,150,177,200,230,290];let score=0;let ballsDropped=0;let ballTimeout=1e3;let combining=false;let f1,f2;function setup(){new Canvas(600,800);world.gravity.y=20;wall1=new Sprite(0,canvas.h/2,15,canvas.h,"s");wall1.color="gray";wall2=new Sprite(canvas.w,canvas.h/2,15,canvas.h,"s");wall2.color="gray";ground=new Sprite(canvas.w/2,canvas.h,canvas.w,55,"s");ground.color="gray";nextBall=new Sprite(canvas.w-100,100);nextBall.tier=round(random(0,4));nextBall.collider="n";nextBall.diameter=diameters[nextBall.tier];nextBall.img=images[nextBall.tier];nextBall.text=nextBall.diameter;cloud=new Sprite(mouseX,75,75,50,"n");cloud.img="assets/cloud.png";balls=new Group;balls.tier;balls.isCloud;balls.rotationDrag=.7;balls.textColor="white";balls.textSize=24;cloudBall=new balls.Sprite(mouseX,100);cloudBall.tier=round(random(0,4));cloudBall.diameter=diameters[cloudBall.tier];cloudBall.img=images[cloudBall.tier];cloudBall.collider="s";cloudBall.text=cloudBall.diameter;cloudBall.isCloud=true;balls.collide(balls,destroyFruits);canDrop=true}function draw(){background("#edecc5");text("Next Ball: ",canvas.w-125,50);text("Score: "+score,50,50);cloud.moveTowards(mouseX,cloud.y,.2);if(cloudBall){cloudBall.x=cloud.x;cloudBall.y=cloud.y+50}if(kb.presses("p"))allSprites.debug=!allSprites.debug;stroke("gray");strokeWeight(6);line(cloud.x,cloud.y,cloud.x,canvas.h);stroke("black");strokeWeight(1)}function gameOver(){alert("You lost!");window.location=window.location}function saveHighScore(score){storeItem("highscore",score)}function getHighScore(){return getItem("highscore")}async function destroyFruits(fruit1,fruit2){if(fruit1.isCloud||fruit2.isCloud)gameOver();if(fruit1.tier!=fruit2.tier)return;let tier=fruit1.tier;let aX=fruit1.x;let aY=fruit1.y;let bX=fruit2.x;let bY=fruit2.y;score+=points[tier];fruit1.overlaps(fruit2);fruit1.direction=fruit1.angleTo(fruit2);fruit2.direction=fruit2.angleTo(fruit1);fruit1.speed=5;fruit2.speed=5;await delay(100);fruit1.remove();fruit2.remove();if(tier==10)return;let ball=createBall((aX+bX)/2,(aY+bY)/2,tier+1);ball.moveTowards(aX>=bY?bX:aX,aY>=bY?bY:aY,.02)}function mouseReleased(){if(!canDrop)return;canDrop=false;ballsDropped++;storeItem("ballsDropped",ballsDropped);let ball=cloudBall;cloudBall=undefined;ball.collider="d";ball.isCloud=false;ball.x=ball.x+random(-1,1);ball.diameter=diameters[ball.tier];ball.text=ball.diameter;ball.resetMass();setTimeout(()=>{createCloudBall(cloud.x,cloud.y,nextBall);queueBall();canDrop=true},ballTimeout)}function queueBall(){nextBall.tier=round(random(0,4));nextBall.diameter=diameters[nextBall.tier];nextBall.img=images[nextBall.tier];nextBall.text=nextBall.diameter}function createCloudBall(x,y,nb){cloudBall=new balls.Sprite(x,y);cloudBall.tier=nb.tier;cloudBall.img=images[cloudBall.tier];cloudBall.collider="s";cloudBall.diameter=nb.diameter;cloudBall.text=cloudBall.diameter;cloudBall.isCloud=true}function createBall(x,y,tier){let ball=new balls.Sprite(x,y);ball.tier=tier;ball.diameter=diameters[ball.tier];ball.img=images[tier];ball.collider="d";ball.resetMass();ball.text=ball.diameter;return ball}(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.p5=f()}})(function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(_dereq_,module,exports){module.exports={p5:{describe:{name:"describe",params:[{name:"text",description:"<p>description of the canvas.</p>\n",type:"String"},{name:"display",description:"<p>either LABEL or FALLBACK.</p>\n",type:"Constant",optional:true}],class:"p5",module:"Environment"},describeElement:{name:"describeElement",params:[{name:"name",description:"<p>name of the element.</p>\n",type:"String"},{name:"text",description:"<p>description of the element.</p>\n",type:"String"},{name:"display",description:"<p>either LABEL or FALLBACK.</p>\n",type:"Constant",optional:true}],class:"p5",module:"Environment"},textOutput:{name:"textOutput",params:[{name:"display",description:"<p>either FALLBACK or LABEL.</p>\n",type:"Constant",optional:true}],class:"p5",module:"Environment"},gridOutput:{name:"gridOutput",params:[{name:"display",description:"<p>either FALLBACK or LABEL.</p>\n",type:"Constant",optional:true}],class:"p5",module:"Environment"},alpha:{name:"alpha",params:[{name:"color",description:'<p><a href="#/p5.Color">p5.Color</a> object, array of\n                                        color components, or CSS color string.</p>\n',type:"p5.Color|Number[]|String"}],class:"p5",module:"Color"},blue:{name:"blue",params:[{name:"color",description:'<p><a href="#/p5.Color">p5.Color</a> object, array of\n                                        color components, or CSS color string.</p>\n',type:"p5.Color|Number[]|String"}],class:"p5",module:"Color"},brightness:{name:"brightness",params:[{name:"color",description:'<p><a href="#/p5.Color">p5.Color</a> object, array of\n                                        color components, or CSS color string.</p>\n',type:"p5.Color|Number[]|String"}],class:"p5",module:"Color"},color:{name:"color",class:"p5",module:"Color",overloads:[{params:[{name:"gray",description:"<p>number specifying value between white and black.</p>\n",type:"Number"},{name:"alpha",description:"<p>alpha value relative to current color range\n                                (default is 0-255).</p>\n",type:"Number",optional:true}]},{params:[{name:"v1",description:"<p>red or hue value relative to\n                                the current color range.</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value\n                                relative to the current color range.</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness value\n                                relative to the current color range.</p>\n",type:"Number"},{name:"alpha",description:"",type:"Number",optional:true}]},{params:[{name:"value",description:"<p>a color string.</p>\n",type:"String"}]},{params:[{name:"values",description:"<p>an array containing the red, green, blue,\n                                and alpha components of the color.</p>\n",type:"Number[]"}]},{params:[{name:"color",description:"",type:"p5.Color"}]}]},green:{name:"green",params:[{name:"color",description:'<p><a href="#/p5.Color">p5.Color</a> object, array of\n                                        color components, or CSS color string.</p>\n',type:"p5.Color|Number[]|String"}],class:"p5",module:"Color"},hue:{name:"hue",params:[{name:"color",description:'<p><a href="#/p5.Color">p5.Color</a> object, array of\n                                        color components, or CSS color string.</p>\n',type:"p5.Color|Number[]|String"}],class:"p5",module:"Color"},lerpColor:{name:"lerpColor",params:[{name:"c1",description:"<p>interpolate from this color.</p>\n",type:"p5.Color"},{name:"c2",description:"<p>interpolate to this color.</p>\n",type:"p5.Color"},{name:"amt",description:"<p>number between 0 and 1.</p>\n",type:"Number"}],class:"p5",module:"Color"},lightness:{name:"lightness",params:[{name:"color",description:'<p><a href="#/p5.Color">p5.Color</a> object, array of\n                                        color components, or CSS color string.</p>\n',type:"p5.Color|Number[]|String"}],class:"p5",module:"Color"},red:{name:"red",params:[{name:"color",description:'<p><a href="#/p5.Color">p5.Color</a> object, array of\n                                        color components, or CSS color string.</p>\n',type:"p5.Color|Number[]|String"}],class:"p5",module:"Color"},saturation:{name:"saturation",params:[{name:"color",description:'<p><a href="#/p5.Color">p5.Color</a> object, array of\n                                        color components, or CSS color string.</p>\n',type:"p5.Color|Number[]|String"}],class:"p5",module:"Color"},beginClip:{name:"beginClip",params:[{name:"options",description:"<p>An object containing clip settings.</p>\n",type:"Object",optional:true}],class:"p5",module:"Color"},endClip:{name:"endClip",class:"p5",module:"Color"},clip:{name:"clip",params:[{name:"callback",description:"<p>A function that draws the mask shape.</p>\n",type:"Function"},{name:"options",description:"<p>An object containing clip settings.</p>\n",type:"Object",optional:true}],class:"p5",module:"Color"},background:{name:"background",class:"p5",module:"Color",overloads:[{params:[{name:"color",description:'<p>any value created by the <a href="#/p5/color">color()</a> function</p>\n',type:"p5.Color"}],chainable:1},{params:[{name:"colorstring",description:"<p>color string, possible formats include: integer\n                        rgb() or rgba(), percentage rgb() or rgba(),\n                        3-digit hex, 6-digit hex.</p>\n",type:"String"},{name:"a",description:"<p>opacity of the background relative to current\n                            color range (default is 0-255).</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"gray",description:"<p>specifies a value between white and black.</p>\n",type:"Number"},{name:"a",description:"",type:"Number",optional:true}],chainable:1},{params:[{name:"v1",description:"<p>red value if color mode is RGB, or hue value if color mode is HSB.</p>\n",type:"Number"},{name:"v2",description:"<p>green value if color mode is RGB, or saturation value if color mode is HSB.</p>\n",type:"Number"},{name:"v3",description:"<p>blue value if color mode is RGB, or brightness value if color mode is HSB.</p>\n",type:"Number"},{name:"a",description:"",type:"Number",optional:true}],chainable:1},{params:[{name:"values",description:"<p>an array containing the red, green, blue\n                                and alpha components of the color.</p>\n",type:"Number[]"}],chainable:1},{params:[{name:"image",description:'<p>image created with <a href="#/p5/loadImage">loadImage()</a>\n                            or <a href="#/p5/createImage">createImage()</a>,\n                            to set as background.\n                            (must be same size as the sketch window).</p>\n',type:"p5.Image"},{name:"a",description:"",type:"Number",optional:true}],chainable:1}]},clear:{name:"clear",params:[{name:"r",description:"<p>normalized red value.</p>\n",type:"Number"},{name:"g",description:"<p>normalized green value.</p>\n",type:"Number"},{name:"b",description:"<p>normalized blue value.</p>\n",type:"Number"},{name:"a",description:"<p>normalized alpha value.</p>\n",type:"Number"}],class:"p5",module:"Color"},colorMode:{name:"colorMode",class:"p5",module:"Color",overloads:[{params:[{name:"mode",description:"<p>either RGB, HSB or HSL, corresponding to\n                         Red/Green/Blue and Hue/Saturation/Brightness\n                         (or Lightness).</p>\n",type:"Constant"},{name:"max",description:"<p>range for all values.</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"mode",description:"",type:"Constant"},{name:"max1",description:"<p>range for the red or hue depending on the\n                             current color mode.</p>\n",type:"Number"},{name:"max2",description:"<p>range for the green or saturation depending\n                             on the current color mode.</p>\n",type:"Number"},{name:"max3",description:"<p>range for the blue or brightness/lightness\n                             depending on the current color mode.</p>\n",type:"Number"},{name:"maxA",description:"<p>range for the alpha.</p>\n",type:"Number",optional:true}],chainable:1}]},fill:{name:"fill",class:"p5",module:"Color",overloads:[{params:[{name:"v1",description:"<p>red value if color mode is RGB or hue value if color mode is HSB.</p>\n",type:"Number"},{name:"v2",description:"<p>green value if color mode is RGB or saturation value if color mode is HSB.</p>\n",type:"Number"},{name:"v3",description:"<p>blue value if color mode is RGB or brightness value if color mode is HSB.</p>\n",type:"Number"},{name:"alpha",description:"",type:"Number",optional:true}],chainable:1},{params:[{name:"value",description:"<p>a color string.</p>\n",type:"String"}],chainable:1},{params:[{name:"gray",description:"<p>a grayscale value.</p>\n",type:"Number"},{name:"alpha",description:"",type:"Number",optional:true}],chainable:1},{params:[{name:"values",description:"<p>an array containing the red, green, blue &\n                                and alpha components of the color.</p>\n",type:"Number[]"}],chainable:1},{params:[{name:"color",description:"<p>the fill color.</p>\n",type:"p5.Color"}],chainable:1}]},noFill:{name:"noFill",class:"p5",module:"Color"},noStroke:{name:"noStroke",class:"p5",module:"Color"},stroke:{name:"stroke",class:"p5",module:"Color",overloads:[{params:[{name:"v1",description:"<p>red value if color mode is RGB or hue value if color mode is HSB.</p>\n",type:"Number"},{name:"v2",description:"<p>green value if color mode is RGB or saturation value if color mode is HSB.</p>\n",type:"Number"},{name:"v3",description:"<p>blue value if color mode is RGB or brightness value if color mode is HSB.</p>\n",type:"Number"},{name:"alpha",description:"",type:"Number",optional:true}],chainable:1},{params:[{name:"value",description:"<p>a color string.</p>\n",type:"String"}],chainable:1},{params:[{name:"gray",description:"<p>a grayscale value.</p>\n",type:"Number"},{name:"alpha",description:"",type:"Number",optional:true}],chainable:1},{params:[{name:"values",description:"<p>an array containing the red, green, blue,\n                                and alpha components of the color.</p>\n",type:"Number[]"}],chainable:1},{params:[{name:"color",description:"<p>the stroke color.</p>\n",type:"p5.Color"}],chainable:1}]},erase:{name:"erase",params:[{name:"strengthFill",description:"<p>a number (0-255) for the strength of erasing under a shape's interior.\n                                       Defaults to 255, which is full strength.</p>\n",type:"Number",optional:true},{name:"strengthStroke",description:"<p>a number (0-255) for the strength of erasing under a shape's edge.\n                                       Defaults to 255, which is full strength.</p>\n",type:"Number",optional:true}],class:"p5",module:"Color"},noErase:{name:"noErase",class:"p5",module:"Color"},arc:{name:"arc",params:[{name:"x",description:"<p>x-coordinate of the arc's ellipse.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the arc's ellipse.</p>\n",type:"Number"},{name:"w",description:"<p>width of the arc's ellipse by default.</p>\n",type:"Number"},{name:"h",description:"<p>height of the arc's ellipse by default.</p>\n",type:"Number"},{name:"start",description:"<p>angle to start the arc, specified in radians.</p>\n",type:"Number"},{name:"stop",description:"<p>angle to stop the arc, specified in radians.</p>\n",type:"Number"},{name:"mode",description:"<p>optional parameter to determine the way of drawing\n                        the arc. either CHORD, PIE, or OPEN.</p>\n",type:"Constant",optional:true},{name:"detail",description:"<p>optional parameter for WebGL mode only. This is to\n                        specify the number of vertices that makes up the\n                        perimeter of the arc. Default value is 25. Won't\n                        draw a stroke for a detail of more than 50.</p>\n",type:"Integer",optional:true}],class:"p5",module:"Shape"},ellipse:{name:"ellipse",class:"p5",module:"Shape",overloads:[{params:[{name:"x",description:"<p>x-coordinate of the center of the ellipse.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the center of the ellipse.</p>\n",type:"Number"},{name:"w",description:"<p>width of the ellipse.</p>\n",type:"Number"},{name:"h",description:"<p>height of the ellipse.</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"w",description:"",type:"Number"},{name:"h",description:"",type:"Number"},{name:"detail",description:"<p>optional parameter for WebGL mode only. This is to\n                        specify the number of vertices that makes up the\n                        perimeter of the ellipse. Default value is 25. Won't\n                        draw a stroke for a detail of more than 50.</p>\n",type:"Integer",optional:true}]}]},circle:{name:"circle",params:[{name:"x",description:"<p>x-coordinate of the center of the circle.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the center of the circle.</p>\n",type:"Number"},{name:"d",description:"<p>diameter of the circle.</p>\n",type:"Number"}],class:"p5",module:"Shape"},line:{name:"line",class:"p5",module:"Shape",overloads:[{params:[{name:"x1",description:"<p>the x-coordinate of the first point.</p>\n",type:"Number"},{name:"y1",description:"<p>the y-coordinate of the first point.</p>\n",type:"Number"},{name:"x2",description:"<p>the x-coordinate of the second point.</p>\n",type:"Number"},{name:"y2",description:"<p>the y-coordinate of the second point.</p>\n",type:"Number"}],chainable:1},{params:[{name:"x1",description:"",type:"Number"},{name:"y1",description:"",type:"Number"},{name:"z1",description:"<p>the z-coordinate of the first point.</p>\n",type:"Number"},{name:"x2",description:"",type:"Number"},{name:"y2",description:"",type:"Number"},{name:"z2",description:"<p>the z-coordinate of the second point.</p>\n",type:"Number"}],chainable:1}]},point:{name:"point",class:"p5",module:"Shape",overloads:[{params:[{name:"x",description:"<p>the x-coordinate.</p>\n",type:"Number"},{name:"y",description:"<p>the y-coordinate.</p>\n",type:"Number"},{name:"z",description:"<p>the z-coordinate (for WebGL mode).</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"coordinateVector",description:"<p>the coordinate vector.</p>\n",type:"p5.Vector"}],chainable:1}]},quad:{name:"quad",class:"p5",module:"Shape",overloads:[{params:[{name:"x1",description:"<p>the x-coordinate of the first point.</p>\n",type:"Number"},{name:"y1",description:"<p>the y-coordinate of the first point.</p>\n",type:"Number"},{name:"x2",description:"<p>the x-coordinate of the second point.</p>\n",type:"Number"},{name:"y2",description:"<p>the y-coordinate of the second point.</p>\n",type:"Number"},{name:"x3",description:"<p>the x-coordinate of the third point.</p>\n",type:"Number"},{name:"y3",description:"<p>the y-coordinate of the third point.</p>\n",type:"Number"},{name:"x4",description:"<p>the x-coordinate of the fourth point.</p>\n",type:"Number"},{name:"y4",description:"<p>the y-coordinate of the fourth point.</p>\n",type:"Number"},{name:"detailX",description:"<p>number of segments in the x-direction.</p>\n",type:"Integer",optional:true},{name:"detailY",description:"<p>number of segments in the y-direction.</p>\n",type:"Integer",optional:true}],chainable:1},{params:[{name:"x1",description:"",type:"Number"},{name:"y1",description:"",type:"Number"},{name:"z1",description:"<p>the z-coordinate of the first point.</p>\n",type:"Number"},{name:"x2",description:"",type:"Number"},{name:"y2",description:"",type:"Number"},{name:"z2",description:"<p>the z-coordinate of the second point.</p>\n",type:"Number"},{name:"x3",description:"",type:"Number"},{name:"y3",description:"",type:"Number"},{name:"z3",description:"<p>the z-coordinate of the third point.</p>\n",type:"Number"},{name:"x4",description:"",type:"Number"},{name:"y4",description:"",type:"Number"},{name:"z4",description:"<p>the z-coordinate of the fourth point.</p>\n",type:"Number"},{name:"detailX",description:"",type:"Integer",optional:true},{name:"detailY",description:"",type:"Integer",optional:true}],chainable:1}]},rect:{name:"rect",class:"p5",module:"Shape",overloads:[{params:[{name:"x",description:"<p>x-coordinate of the rectangle.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the rectangle.</p>\n",type:"Number"},{name:"w",description:"<p>width of the rectangle.</p>\n",type:"Number"},{name:"h",description:"<p>height of the rectangle.</p>\n",type:"Number",optional:true},{name:"tl",description:"<p>optional radius of top-left corner.</p>\n",type:"Number",optional:true},{name:"tr",description:"<p>optional radius of top-right corner.</p>\n",type:"Number",optional:true},{name:"br",description:"<p>optional radius of bottom-right corner.</p>\n",type:"Number",optional:true},{name:"bl",description:"<p>optional radius of bottom-left corner.</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"w",description:"",type:"Number"},{name:"h",description:"",type:"Number"},{name:"detailX",description:"<p>number of segments in the x-direction (for WebGL mode).</p>\n",type:"Integer",optional:true},{name:"detailY",description:"<p>number of segments in the y-direction (for WebGL mode).</p>\n",type:"Integer",optional:true}],chainable:1}]},square:{name:"square",params:[{name:"x",description:"<p>x-coordinate of the square.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the square.</p>\n",type:"Number"},{name:"s",description:"<p>side size of the square.</p>\n",type:"Number"},{name:"tl",description:"<p>optional radius of top-left corner.</p>\n",type:"Number",optional:true},{name:"tr",description:"<p>optional radius of top-right corner.</p>\n",type:"Number",optional:true},{name:"br",description:"<p>optional radius of bottom-right corner.</p>\n",type:"Number",optional:true},{name:"bl",description:"<p>optional radius of bottom-left corner.</p>\n",type:"Number",optional:true}],class:"p5",module:"Shape"},triangle:{name:"triangle",params:[{name:"x1",description:"<p>x-coordinate of the first point.</p>\n",type:"Number"},{name:"y1",description:"<p>y-coordinate of the first point.</p>\n",type:"Number"},{name:"x2",description:"<p>x-coordinate of the second point.</p>\n",type:"Number"},{name:"y2",description:"<p>y-coordinate of the second point.</p>\n",type:"Number"},{name:"x3",description:"<p>x-coordinate of the third point.</p>\n",type:"Number"},{name:"y3",description:"<p>y-coordinate of the third point.</p>\n",type:"Number"}],class:"p5",module:"Shape"},ellipseMode:{name:"ellipseMode",params:[{name:"mode",description:"<p>either CENTER, RADIUS, CORNER, or CORNERS</p>\n",type:"Constant"}],class:"p5",module:"Shape"},noSmooth:{name:"noSmooth",class:"p5",module:"Shape"},rectMode:{name:"rectMode",params:[{name:"mode",description:"<p>either CORNER, CORNERS, CENTER, or RADIUS</p>\n",type:"Constant"}],class:"p5",module:"Shape"},smooth:{name:"smooth",class:"p5",module:"Shape"},strokeCap:{name:"strokeCap",params:[{name:"cap",description:"<p>either ROUND, SQUARE, or PROJECT</p>\n",type:"Constant"}],class:"p5",module:"Shape"},strokeJoin:{name:"strokeJoin",params:[{name:"join",description:"<p>either MITER, BEVEL, or ROUND</p>\n",type:"Constant"}],class:"p5",module:"Shape"},strokeWeight:{name:"strokeWeight",params:[{name:"weight",description:"<p>the weight of the stroke (in pixels).</p>\n",type:"Number"}],class:"p5",module:"Shape"},bezier:{name:"bezier",class:"p5",module:"Shape",overloads:[{params:[{name:"x1",description:"<p>x-coordinate for the first anchor point</p>\n",type:"Number"},{name:"y1",description:"<p>y-coordinate for the first anchor point</p>\n",type:"Number"},{name:"x2",description:"<p>x-coordinate for the first control point</p>\n",type:"Number"},{name:"y2",description:"<p>y-coordinate for the first control point</p>\n",type:"Number"},{name:"x3",description:"<p>x-coordinate for the second control point</p>\n",type:"Number"},{name:"y3",description:"<p>y-coordinate for the second control point</p>\n",type:"Number"},{name:"x4",description:"<p>x-coordinate for the second anchor point</p>\n",type:"Number"},{name:"y4",description:"<p>y-coordinate for the second anchor point</p>\n",type:"Number"}],chainable:1},{params:[{name:"x1",description:"",type:"Number"},{name:"y1",description:"",type:"Number"},{name:"z1",description:"<p>z-coordinate for the first anchor point</p>\n",type:"Number"},{name:"x2",description:"",type:"Number"},{name:"y2",description:"",type:"Number"},{name:"z2",description:"<p>z-coordinate for the first control point</p>\n",type:"Number"},{name:"x3",description:"",type:"Number"},{name:"y3",description:"",type:"Number"},{name:"z3",description:"<p>z-coordinate for the second control point</p>\n",type:"Number"},{name:"x4",description:"",type:"Number"},{name:"y4",description:"",type:"Number"},{name:"z4",description:"<p>z-coordinate for the second anchor point</p>\n",type:"Number"}],chainable:1}]},bezierDetail:{name:"bezierDetail",params:[{name:"detail",description:"<p>resolution of the curves</p>\n",type:"Number"}],class:"p5",module:"Shape"},bezierPoint:{name:"bezierPoint",params:[{name:"a",description:"<p>coordinate of first point on the curve</p>\n",type:"Number"},{name:"b",description:"<p>coordinate of first control point</p>\n",type:"Number"},{name:"c",description:"<p>coordinate of second control point</p>\n",type:"Number"},{name:"d",description:"<p>coordinate of second point on the curve</p>\n",type:"Number"},{name:"t",description:"<p>value between 0 and 1</p>\n",type:"Number"}],class:"p5",module:"Shape"},bezierTangent:{name:"bezierTangent",params:[{name:"a",description:"<p>coordinate of first point on the curve</p>\n",type:"Number"},{name:"b",description:"<p>coordinate of first control point</p>\n",type:"Number"},{name:"c",description:"<p>coordinate of second control point</p>\n",type:"Number"},{name:"d",description:"<p>coordinate of second point on the curve</p>\n",type:"Number"},{name:"t",description:"<p>value between 0 and 1</p>\n",type:"Number"}],class:"p5",module:"Shape"},curve:{name:"curve",class:"p5",module:"Shape",overloads:[{params:[{name:"x1",description:"<p>x-coordinate for the beginning control point</p>\n",type:"Number"},{name:"y1",description:"<p>y-coordinate for the beginning control point</p>\n",type:"Number"},{name:"x2",description:"<p>x-coordinate for the first point</p>\n",type:"Number"},{name:"y2",description:"<p>y-coordinate for the first point</p>\n",type:"Number"},{name:"x3",description:"<p>x-coordinate for the second point</p>\n",type:"Number"},{name:"y3",description:"<p>y-coordinate for the second point</p>\n",type:"Number"},{name:"x4",description:"<p>x-coordinate for the ending control point</p>\n",type:"Number"},{name:"y4",description:"<p>y-coordinate for the ending control point</p>\n",type:"Number"}],chainable:1},{params:[{name:"x1",description:"",type:"Number"},{name:"y1",description:"",type:"Number"},{name:"z1",description:"<p>z-coordinate for the beginning control point</p>\n",type:"Number"},{name:"x2",description:"",type:"Number"},{name:"y2",description:"",type:"Number"},{name:"z2",description:"<p>z-coordinate for the first point</p>\n",type:"Number"},{name:"x3",description:"",type:"Number"},{name:"y3",description:"",type:"Number"},{name:"z3",description:"<p>z-coordinate for the second point</p>\n",type:"Number"},{name:"x4",description:"",type:"Number"},{name:"y4",description:"",type:"Number"},{name:"z4",description:"<p>z-coordinate for the ending control point</p>\n",type:"Number"}],chainable:1}]},curveDetail:{name:"curveDetail",params:[{name:"resolution",description:"<p>resolution of the curves</p>\n",type:"Number"}],class:"p5",module:"Shape"},curveTightness:{name:"curveTightness",params:[{name:"amount",description:"<p>amount of deformation from the original vertices</p>\n",type:"Number"}],class:"p5",module:"Shape"},curvePoint:{name:"curvePoint",params:[{name:"a",description:"<p>coordinate of first control point of the curve</p>\n",type:"Number"},{name:"b",description:"<p>coordinate of first point</p>\n",type:"Number"},{name:"c",description:"<p>coordinate of second point</p>\n",type:"Number"},{name:"d",description:"<p>coordinate of second control point</p>\n",type:"Number"},{name:"t",description:"<p>value between 0 and 1</p>\n",type:"Number"}],class:"p5",module:"Shape"},curveTangent:{name:"curveTangent",params:[{name:"a",description:"<p>coordinate of first control point</p>\n",type:"Number"},{name:"b",description:"<p>coordinate of first point on the curve</p>\n",type:"Number"},{name:"c",description:"<p>coordinate of second point on the curve</p>\n",type:"Number"},{name:"d",description:"<p>coordinate of second conrol point</p>\n",type:"Number"},{name:"t",description:"<p>value between 0 and 1</p>\n",type:"Number"}],class:"p5",module:"Shape"},beginContour:{name:"beginContour",class:"p5",module:"Shape"},beginShape:{name:"beginShape",params:[{name:"kind",description:"<p>either POINTS, LINES, TRIANGLES, TRIANGLE_FAN\n                               TRIANGLE_STRIP, QUADS, QUAD_STRIP or TESS</p>\n",type:"Constant",optional:true}],class:"p5",module:"Shape"},bezierVertex:{name:"bezierVertex",class:"p5",module:"Shape",overloads:[{params:[{name:"x2",description:"<p>x-coordinate for the first control point</p>\n",type:"Number"},{name:"y2",description:"<p>y-coordinate for the first control point</p>\n",type:"Number"},{name:"x3",description:"<p>x-coordinate for the second control point</p>\n",type:"Number"},{name:"y3",description:"<p>y-coordinate for the second control point</p>\n",type:"Number"},{name:"x4",description:"<p>x-coordinate for the anchor point</p>\n",type:"Number"},{name:"y4",description:"<p>y-coordinate for the anchor point</p>\n",type:"Number"}],chainable:1},{params:[{name:"x2",description:"",type:"Number"},{name:"y2",description:"",type:"Number"},{name:"z2",description:"<p>z-coordinate for the first control point (for WebGL mode)</p>\n",type:"Number"},{name:"x3",description:"",type:"Number"},{name:"y3",description:"",type:"Number"},{name:"z3",description:"<p>z-coordinate for the second control point (for WebGL mode)</p>\n",type:"Number"},{name:"x4",description:"",type:"Number"},{name:"y4",description:"",type:"Number"},{name:"z4",description:"<p>z-coordinate for the anchor point (for WebGL mode)</p>\n",type:"Number"}],chainable:1}]},curveVertex:{name:"curveVertex",class:"p5",module:"Shape",overloads:[{params:[{name:"x",description:"<p>x-coordinate of the vertex</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the vertex</p>\n",type:"Number"}],chainable:1},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"<p>z-coordinate of the vertex (for WebGL mode)</p>\n",type:"Number",optional:true}],chainable:1}]},endContour:{name:"endContour",class:"p5",module:"Shape"},endShape:{name:"endShape",params:[{name:"mode",description:"<p>use CLOSE to close the shape</p>\n",type:"Constant",optional:true},{name:"count",description:"<p>number of times you want to draw/instance the shape (for WebGL mode).</p>\n",type:"Integer",optional:true}],class:"p5",module:"Shape"},quadraticVertex:{name:"quadraticVertex",class:"p5",module:"Shape",overloads:[{params:[{name:"cx",description:"<p>x-coordinate for the control point</p>\n",type:"Number"},{name:"cy",description:"<p>y-coordinate for the control point</p>\n",type:"Number"},{name:"x3",description:"<p>x-coordinate for the anchor point</p>\n",type:"Number"},{name:"y3",description:"<p>y-coordinate for the anchor point</p>\n",type:"Number"}],chainable:1},{params:[{name:"cx",description:"",type:"Number"},{name:"cy",description:"",type:"Number"},{name:"cz",description:"<p>z-coordinate for the control point (for WebGL mode)</p>\n",type:"Number"},{name:"x3",description:"",type:"Number"},{name:"y3",description:"",type:"Number"},{name:"z3",description:"<p>z-coordinate for the anchor point (for WebGL mode)</p>\n",type:"Number"}],chainable:1}]},vertex:{name:"vertex",class:"p5",module:"Shape",overloads:[{params:[{name:"x",description:"<p>x-coordinate of the vertex</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the vertex</p>\n",type:"Number"}],chainable:1},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"<p>z-coordinate of the vertex.\n                      Defaults to 0 if not specified.</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"",type:"Number",optional:true},{name:"u",description:"<p>the vertex's texture u-coordinate</p>\n",type:"Number",optional:true},{name:"v",description:"<p>the vertex's texture v-coordinate</p>\n",type:"Number",optional:true}],chainable:1}]},normal:{name:"normal",class:"p5",module:"Shape",overloads:[{params:[{name:"vector",description:"<p>A p5.Vector representing the vertex normal.</p>\n",type:"Vector"}],chainable:1},{params:[{name:"x",description:"<p>The x component of the vertex normal.</p>\n",type:"Number"},{name:"y",description:"<p>The y component of the vertex normal.</p>\n",type:"Number"},{name:"z",description:"<p>The z component of the vertex normal.</p>\n",type:"Number"}],chainable:1}]},VERSION:{name:"VERSION",class:"p5",module:"Constants"},P2D:{name:"P2D",class:"p5",module:"Constants"},WEBGL:{name:"WEBGL",class:"p5",module:"Constants"},WEBGL2:{name:"WEBGL2",class:"p5",module:"Constants"},ARROW:{name:"ARROW",class:"p5",module:"Constants"},CROSS:{name:"CROSS",class:"p5",module:"Constants"},HAND:{name:"HAND",class:"p5",module:"Constants"},MOVE:{name:"MOVE",class:"p5",module:"Constants"},TEXT:{name:"TEXT",class:"p5",module:"Constants"},WAIT:{name:"WAIT",class:"p5",module:"Constants"},HALF_PI:{name:"HALF_PI",class:"p5",module:"Constants"},PI:{name:"PI",class:"p5",module:"Constants"},QUARTER_PI:{name:"QUARTER_PI",class:"p5",module:"Constants"},TAU:{name:"TAU",class:"p5",module:"Constants"},TWO_PI:{name:"TWO_PI",class:"p5",module:"Constants"},DEGREES:{name:"DEGREES",class:"p5",module:"Constants"},RADIANS:{name:"RADIANS",class:"p5",module:"Constants"},CORNER:{name:"CORNER",class:"p5",module:"Constants"},CORNERS:{name:"CORNERS",class:"p5",module:"Constants"},RADIUS:{name:"RADIUS",class:"p5",module:"Constants"},RIGHT:{name:"RIGHT",class:"p5",module:"Constants"},LEFT:{name:"LEFT",class:"p5",module:"Constants"},CENTER:{name:"CENTER",class:"p5",module:"Constants"},TOP:{name:"TOP",class:"p5",module:"Constants"},BOTTOM:{name:"BOTTOM",class:"p5",module:"Constants"},BASELINE:{name:"BASELINE",class:"p5",module:"Constants"},POINTS:{name:"POINTS",class:"p5",module:"Constants"},LINES:{name:"LINES",class:"p5",module:"Constants"},LINE_STRIP:{name:"LINE_STRIP",class:"p5",module:"Constants"},LINE_LOOP:{name:"LINE_LOOP",class:"p5",module:"Constants"},TRIANGLES:{name:"TRIANGLES",class:"p5",module:"Constants"},TRIANGLE_FAN:{name:"TRIANGLE_FAN",class:"p5",module:"Constants"},TRIANGLE_STRIP:{name:"TRIANGLE_STRIP",class:"p5",module:"Constants"},QUADS:{name:"QUADS",class:"p5",module:"Constants"},QUAD_STRIP:{name:"QUAD_STRIP",class:"p5",module:"Constants"},TESS:{name:"TESS",class:"p5",module:"Constants"},CLOSE:{name:"CLOSE",class:"p5",module:"Constants"},OPEN:{name:"OPEN",class:"p5",module:"Constants"},CHORD:{name:"CHORD",class:"p5",module:"Constants"},PIE:{name:"PIE",class:"p5",module:"Constants"},PROJECT:{name:"PROJECT",class:"p5",module:"Constants"},SQUARE:{name:"SQUARE",class:"p5",module:"Constants"},ROUND:{name:"ROUND",class:"p5",module:"Constants"},BEVEL:{name:"BEVEL",class:"p5",module:"Constants"},MITER:{name:"MITER",class:"p5",module:"Constants"},RGB:{name:"RGB",class:"p5",module:"Constants"},HSB:{name:"HSB",class:"p5",module:"Constants"},HSL:{name:"HSL",class:"p5",module:"Constants"},AUTO:{name:"AUTO",class:"p5",module:"Constants"},ALT:{name:"ALT",class:"p5",module:"Constants"},BACKSPACE:{name:"BACKSPACE",class:"p5",module:"Constants"},CONTROL:{name:"CONTROL",class:"p5",module:"Constants"},DELETE:{name:"DELETE",class:"p5",module:"Constants"},DOWN_ARROW:{name:"DOWN_ARROW",class:"p5",module:"Constants"},ENTER:{name:"ENTER",class:"p5",module:"Constants"},ESCAPE:{name:"ESCAPE",class:"p5",module:"Constants"},LEFT_ARROW:{name:"LEFT_ARROW",class:"p5",module:"Constants"},OPTION:{name:"OPTION",class:"p5",module:"Constants"},RETURN:{name:"RETURN",class:"p5",module:"Constants"},RIGHT_ARROW:{name:"RIGHT_ARROW",class:"p5",module:"Constants"},SHIFT:{name:"SHIFT",class:"p5",module:"Constants"},TAB:{name:"TAB",class:"p5",module:"Constants"},UP_ARROW:{name:"UP_ARROW",class:"p5",module:"Constants"},BLEND:{name:"BLEND",class:"p5",module:"Constants"},REMOVE:{name:"REMOVE",class:"p5",module:"Constants"},ADD:{name:"ADD",class:"p5",module:"Constants"},DARKEST:{name:"DARKEST",class:"p5",module:"Constants"},LIGHTEST:{name:"LIGHTEST",class:"p5",module:"Constants"},DIFFERENCE:{name:"DIFFERENCE",class:"p5",module:"Constants"},SUBTRACT:{name:"SUBTRACT",class:"p5",module:"Constants"},EXCLUSION:{name:"EXCLUSION",class:"p5",module:"Constants"},MULTIPLY:{name:"MULTIPLY",class:"p5",module:"Constants"},SCREEN:{name:"SCREEN",class:"p5",module:"Constants"},REPLACE:{name:"REPLACE",class:"p5",module:"Constants"},OVERLAY:{name:"OVERLAY",class:"p5",module:"Constants"},HARD_LIGHT:{name:"HARD_LIGHT",class:"p5",module:"Constants"},SOFT_LIGHT:{name:"SOFT_LIGHT",class:"p5",module:"Constants"},DODGE:{name:"DODGE",class:"p5",module:"Constants"},BURN:{name:"BURN",class:"p5",module:"Constants"},THRESHOLD:{name:"THRESHOLD",class:"p5",module:"Constants"},GRAY:{name:"GRAY",class:"p5",module:"Constants"},OPAQUE:{name:"OPAQUE",class:"p5",module:"Constants"},INVERT:{name:"INVERT",class:"p5",module:"Constants"},POSTERIZE:{name:"POSTERIZE",class:"p5",module:"Constants"},DILATE:{name:"DILATE",class:"p5",module:"Constants"},ERODE:{name:"ERODE",class:"p5",module:"Constants"},BLUR:{name:"BLUR",class:"p5",module:"Constants"},NORMAL:{name:"NORMAL",class:"p5",module:"Constants"},ITALIC:{name:"ITALIC",class:"p5",module:"Constants"},BOLD:{name:"BOLD",class:"p5",module:"Constants"},BOLDITALIC:{name:"BOLDITALIC",class:"p5",module:"Constants"},CHAR:{name:"CHAR",class:"p5",module:"Constants"},WORD:{name:"WORD",class:"p5",module:"Constants"},LINEAR:{name:"LINEAR",class:"p5",module:"Constants"},QUADRATIC:{name:"QUADRATIC",class:"p5",module:"Constants"},BEZIER:{name:"BEZIER",class:"p5",module:"Constants"},CURVE:{name:"CURVE",class:"p5",module:"Constants"},STROKE:{name:"STROKE",class:"p5",module:"Constants"},FILL:{name:"FILL",class:"p5",module:"Constants"},TEXTURE:{name:"TEXTURE",class:"p5",module:"Constants"},IMMEDIATE:{name:"IMMEDIATE",class:"p5",module:"Constants"},IMAGE:{name:"IMAGE",class:"p5",module:"Constants"},NEAREST:{name:"NEAREST",class:"p5",module:"Constants"},REPEAT:{name:"REPEAT",class:"p5",module:"Constants"},CLAMP:{name:"CLAMP",class:"p5",module:"Constants"},MIRROR:{name:"MIRROR",class:"p5",module:"Constants"},FLAT:{name:"FLAT",class:"p5",module:"Constants"},SMOOTH:{name:"SMOOTH",class:"p5",module:"Constants"},LANDSCAPE:{name:"LANDSCAPE",class:"p5",module:"Constants"},PORTRAIT:{name:"PORTRAIT",class:"p5",module:"Constants"},GRID:{name:"GRID",class:"p5",module:"Constants"},AXES:{name:"AXES",class:"p5",module:"Constants"},LABEL:{name:"LABEL",class:"p5",module:"Constants"},FALLBACK:{name:"FALLBACK",class:"p5",module:"Constants"},CONTAIN:{name:"CONTAIN",class:"p5",module:"Constants"},COVER:{name:"COVER",class:"p5",module:"Constants"},UNSIGNED_BYTE:{name:"UNSIGNED_BYTE",class:"p5",module:"Constants"},UNSIGNED_INT:{name:"UNSIGNED_INT",class:"p5",module:"Constants"},FLOAT:{name:"FLOAT",class:"p5",module:"Constants"},HALF_FLOAT:{name:"HALF_FLOAT",class:"p5",module:"Constants"},RGBA:{name:"RGBA",class:"p5",module:"Constants"},print:{name:"print",params:[{name:"contents",description:"<p>content to print to the console.</p>\n",type:"Any"}],class:"p5",module:"Environment"},frameCount:{name:"frameCount",class:"p5",module:"Environment"},deltaTime:{name:"deltaTime",class:"p5",module:"Environment"},focused:{name:"focused",class:"p5",module:"Environment"},cursor:{name:"cursor",params:[{name:"type",description:"<p>Built-in: either ARROW, CROSS, HAND, MOVE, TEXT, or WAIT.\n                              Native CSS properties: 'grab', 'progress', and so on.\n                              Path to cursor image.</p>\n",type:"String|Constant"},{name:"x",description:"<p>horizontal active spot of the cursor.</p>\n",type:"Number",optional:true},{name:"y",description:"<p>vertical active spot of the cursor.</p>\n",type:"Number",optional:true}],class:"p5",module:"Environment"},frameRate:{name:"frameRate",class:"p5",module:"Environment",overloads:[{params:[{name:"fps",description:"<p>number of frames to draw per second.</p>\n",type:"Number"}],chainable:1},{params:[]}]},getTargetFrameRate:{name:"getTargetFrameRate",class:"p5",module:"Environment"},noCursor:{name:"noCursor",class:"p5",module:"Environment"},webglVersion:{name:"webglVersion",class:"p5",module:"Environment"},displayWidth:{name:"displayWidth",class:"p5",module:"Environment"},displayHeight:{name:"displayHeight",class:"p5",module:"Environment"},windowWidth:{name:"windowWidth",class:"p5",module:"Environment"},windowHeight:{name:"windowHeight",class:"p5",module:"Environment"},windowResized:{name:"windowResized",params:[{name:"event",description:"<p>optional resize Event.</p>\n",type:"UIEvent",optional:true}],class:"p5",module:"Environment"},width:{name:"width",class:"p5",module:"Environment"},height:{name:"height",class:"p5",module:"Environment"},fullscreen:{name:"fullscreen",params:[{name:"val",description:"<p>whether the sketch should be in fullscreen mode.</p>\n",type:"Boolean",optional:true}],class:"p5",module:"Environment"},pixelDensity:{name:"pixelDensity",class:"p5",module:"Environment",overloads:[{params:[{name:"val",description:"<p>desired pixel density.</p>\n",type:"Number",optional:true}],chainable:1},{params:[]}]},displayDensity:{name:"displayDensity",class:"p5",module:"Environment"},getURL:{name:"getURL",class:"p5",module:"Environment"},getURLPath:{name:"getURLPath",class:"p5",module:"Environment"},getURLParams:{name:"getURLParams",class:"p5",module:"Environment"},preload:{name:"preload",class:"p5",module:"Structure"},setup:{name:"setup",class:"p5",module:"Structure"},draw:{name:"draw",class:"p5",module:"Structure"},remove:{name:"remove",class:"p5",module:"Structure"},disableFriendlyErrors:{name:"disableFriendlyErrors",class:"p5",module:"Structure"},let:{name:"let",class:"p5",module:"Foundation"},const:{name:"const",class:"p5",module:"Foundation"},"===":{name:"===",class:"p5",module:"Foundation"},">":{name:">",class:"p5",module:"Foundation"},">=":{name:">=",class:"p5",module:"Foundation"},"<":{name:"<",class:"p5",module:"Foundation"},"<=":{name:"<=",class:"p5",module:"Foundation"},"if-else":{name:"if-else",class:"p5",module:"Foundation"},function:{name:"function",class:"p5",module:"Foundation"},return:{name:"return",class:"p5",module:"Foundation"},boolean:{name:"boolean",params:[{name:"n",description:"<p>value to parse</p>\n",type:"String|Boolean|Number|Array"}],class:"p5",module:"Data"},string:{name:"string",class:"p5",module:"Foundation"},number:{name:"number",class:"p5",module:"Foundation"},object:{name:"object",class:"p5",module:"Foundation"},class:{name:"class",class:"p5",module:"Foundation"},for:{name:"for",class:"p5",module:"Foundation"},while:{name:"while",class:"p5",module:"Foundation"},createCanvas:{name:"createCanvas",class:"p5",module:"Rendering",overloads:[{params:[{name:"w",description:"<p>width of the canvas</p>\n",type:"Number"},{name:"h",description:"<p>height of the canvas</p>\n",type:"Number"},{name:"renderer",description:"<p>either P2D or WEBGL</p>\n",type:"Constant",optional:true},{name:"canvas",description:"<p>existing html canvas element</p>\n",type:"HTMLCanvasElement",optional:true}]},{params:[{name:"w",description:"",type:"Number"},{name:"h",description:"",type:"Number"},{name:"canvas",description:"",type:"HTMLCanvasElement",optional:true}]}]},resizeCanvas:{name:"resizeCanvas",params:[{name:"w",description:"<p>width of the canvas</p>\n",type:"Number"},{name:"h",description:"<p>height of the canvas</p>\n",type:"Number"},{name:"noRedraw",description:"<p>don't redraw the canvas immediately</p>\n",type:"Boolean",optional:true}],class:"p5",module:"Rendering"},noCanvas:{name:"noCanvas",class:"p5",module:"Rendering"},createGraphics:{name:"createGraphics",class:"p5",module:"Rendering",overloads:[{params:[{name:"w",description:"<p>width of the offscreen graphics buffer</p>\n",type:"Number"},{name:"h",description:"<p>height of the offscreen graphics buffer</p>\n",type:"Number"},{name:"renderer",description:"<p>either P2D or WEBGL\n                              undefined defaults to p2d</p>\n",type:"Constant",optional:true},{name:"canvas",description:"<p>existing html canvas element</p>\n",type:"HTMLCanvasElement",optional:true}]},{params:[{name:"w",description:"",type:"Number"},{name:"h",description:"",type:"Number"},{name:"canvas",description:"",type:"HTMLCanvasElement",optional:true}]}]},createFramebuffer:{name:"createFramebuffer",params:[{name:"options",description:"<p>An optional object with configuration</p>\n",type:"Object",optional:true}],class:"p5",module:"Rendering"},blendMode:{name:"blendMode",params:[{name:"mode",description:"<p>blend mode to set for canvas.\n               either BLEND, DARKEST, LIGHTEST, DIFFERENCE, MULTIPLY,\n               EXCLUSION, SCREEN, REPLACE, OVERLAY, HARD_LIGHT,\n               SOFT_LIGHT, DODGE, BURN, ADD, REMOVE or SUBTRACT</p>\n",type:"Constant"}],class:"p5",module:"Rendering"},drawingContext:{name:"drawingContext",class:"p5",module:"Rendering"},noLoop:{name:"noLoop",class:"p5",module:"Structure"},loop:{name:"loop",class:"p5",module:"Structure"},isLooping:{name:"isLooping",class:"p5",module:"Structure"},push:{name:"push",class:"p5",module:"Structure"},pop:{name:"pop",class:"p5",module:"Structure"},redraw:{name:"redraw",params:[{name:"n",description:"<p>Redraw for n-times. The default value is 1.</p>\n",type:"Integer",optional:true}],class:"p5",module:"Structure"},p5:{name:"p5",params:[{name:"sketch",description:"<p>a function containing a p5.js sketch</p>\n",type:"Object"},{name:"node",description:"<p>ID or pointer to HTML DOM node to contain sketch in</p>\n",type:"String|Object"}],class:"p5",module:"Structure"},applyMatrix:{name:"applyMatrix",class:"p5",module:"Transform",overloads:[{params:[{name:"arr",description:"<p>an array of numbers - should be 6 or 16 length (2×3 or 4×4 matrix values)</p>\n",type:"Array"}],chainable:1},{params:[{name:"a",description:"<p>numbers which define the 2×3 or 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"b",description:"<p>numbers which define the 2×3 or 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"c",description:"<p>numbers which define the 2×3 or 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"d",description:"<p>numbers which define the 2×3 or 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"e",description:"<p>numbers which define the 2×3 or 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"f",description:"<p>numbers which define the 2×3 or 4×4 matrix to be multiplied</p>\n",type:"Number"}],chainable:1},{params:[{name:"a",description:"",type:"Number"},{name:"b",description:"",type:"Number"},{name:"c",description:"",type:"Number"},{name:"d",description:"",type:"Number"},{name:"e",description:"",type:"Number"},{name:"f",description:"",type:"Number"},{name:"g",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"h",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"i",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"j",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"k",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"l",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"m",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"n",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"o",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"},{name:"p",description:"<p>numbers which define the 4×4 matrix to be multiplied</p>\n",type:"Number"}],chainable:1}]},resetMatrix:{name:"resetMatrix",class:"p5",module:"Transform"},rotate:{name:"rotate",params:[{name:"angle",description:"<p>the angle of rotation, specified in radians\n                       or degrees, depending on current angleMode</p>\n",type:"Number"},{name:"axis",description:"<p>(in 3d) the axis to rotate around</p>\n",type:"p5.Vector|Number[]",optional:true}],class:"p5",module:"Transform"},rotateX:{name:"rotateX",params:[{name:"angle",description:"<p>the angle of rotation, specified in radians\n                       or degrees, depending on current angleMode</p>\n",type:"Number"}],class:"p5",module:"Transform"},rotateY:{name:"rotateY",params:[{name:"angle",description:"<p>the angle of rotation, specified in radians\n                       or degrees, depending on current angleMode</p>\n",type:"Number"}],class:"p5",module:"Transform"},rotateZ:{name:"rotateZ",params:[{name:"angle",description:"<p>the angle of rotation, specified in radians\n                       or degrees, depending on current angleMode</p>\n",type:"Number"}],class:"p5",module:"Transform"},scale:{name:"scale",class:"p5",module:"Transform",overloads:[{params:[{name:"s",description:"<p>percent to scale the object, or percentage to\n                     scale the object in the x-axis if multiple arguments\n                     are given</p>\n",type:"Number|p5.Vector|Number[]"},{name:"y",description:"<p>percent to scale the object in the y-axis</p>\n",type:"Number",optional:true},{name:"z",description:"<p>percent to scale the object in the z-axis (webgl only)</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"scales",description:"<p>per-axis percents to scale the object</p>\n",type:"p5.Vector|Number[]"}],chainable:1}]},shearX:{name:"shearX",params:[{name:"angle",description:"<p>angle of shear specified in radians or degrees,\n                       depending on current angleMode</p>\n",type:"Number"}],class:"p5",module:"Transform"},shearY:{name:"shearY",params:[{name:"angle",description:"<p>angle of shear specified in radians or degrees,\n                       depending on current angleMode</p>\n",type:"Number"}],class:"p5",module:"Transform"},translate:{name:"translate",class:"p5",module:"Transform",overloads:[{params:[{name:"x",description:"<p>left/right translation</p>\n",type:"Number"},{name:"y",description:"<p>up/down translation</p>\n",type:"Number"},{name:"z",description:"<p>forward/backward translation (WEBGL only)</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"vector",description:"<p>the vector to translate by</p>\n",type:"p5.Vector"}],chainable:1}]},storeItem:{name:"storeItem",params:[{name:"key",description:"",type:"String"},{name:"value",description:"",type:"String|Number|Object|Boolean|p5.Color|p5.Vector"}],class:"p5",module:"Data"},getItem:{name:"getItem",params:[{name:"key",description:"<p>name that you wish to use to store in local storage</p>\n",type:"String"}],class:"p5",module:"Data"},clearStorage:{name:"clearStorage",class:"p5",module:"Data"},removeItem:{name:"removeItem",params:[{name:"key",description:"",type:"String"}],class:"p5",module:"Data"},createStringDict:{name:"createStringDict",class:"p5",module:"Data",overloads:[{params:[{name:"key",description:"",type:"String"},{name:"value",description:"",type:"String"}]},{params:[{name:"object",description:"<p>object</p>\n",type:"Object"}]}]},createNumberDict:{name:"createNumberDict",class:"p5",module:"Data",overloads:[{params:[{name:"key",description:"",type:"Number"},{name:"value",description:"",type:"Number"}]},{params:[{name:"object",description:"<p>object</p>\n",type:"Object"}]}]},select:{name:"select",params:[{name:"selectors",description:"<p>CSS selector string of element to search for.</p>\n",type:"String"},{name:"container",description:'<p>CSS selector string, <a href="#/p5.Element">p5.Element</a>, or\n                                            <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement" target="_blank">HTMLElement</a> to search within.</p>\n',type:"String|p5.Element|HTMLElement",optional:true}],class:"p5",module:"DOM"},selectAll:{name:"selectAll",params:[{name:"selectors",description:"<p>CSS selector string of element to search for.</p>\n",type:"String"},{name:"container",description:'<p>CSS selector string, <a href="#/p5.Element">p5.Element</a>, or\n                                            <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement" target="_blank">HTMLElement</a> to search within.</p>\n',type:"String|p5.Element|HTMLElement",optional:true}],class:"p5",module:"DOM"},removeElements:{name:"removeElements",class:"p5",module:"DOM"},changed:{name:"changed",params:[{name:"fxn",description:"<p>function to call when the element changes.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5",module:"DOM"},input:{name:"input",params:[{name:"fxn",description:"<p>function to call when input is detected within\n                               the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5",module:"DOM"},createDiv:{name:"createDiv",params:[{name:"html",description:"<p>inner HTML for the new <code>&lt;div&gt;&lt;/div&gt;</code> element.</p>\n",type:"String",optional:true}],class:"p5",module:"DOM"},createP:{name:"createP",params:[{name:"html",description:"<p>inner HTML for the new <code>&lt;p&gt;&lt;/p&gt;</code> element.</p>\n",type:"String",optional:true}],class:"p5",module:"DOM"},createSpan:{name:"createSpan",params:[{name:"html",description:"<p>inner HTML for the new <code>&lt;span&gt;&lt;/span&gt;</code> element.</p>\n",type:"String",optional:true}],class:"p5",module:"DOM"},createImg:{name:"createImg",class:"p5",module:"DOM",overloads:[{params:[{name:"src",description:"<p>relative path or URL for the image.</p>\n",type:"String"},{name:"alt",description:"<p>alternate text for the image.</p>\n",type:"String"}]},{params:[{name:"src",description:"",type:"String"},{name:"alt",description:"",type:"String"},{name:"crossOrigin",description:"<p>crossOrigin property to use when fetching the image.</p>\n",type:"String",optional:true},{name:"successCallback",description:'<p>function to call once the image loads. The new image will be passed\n                                     to the function as a <a href="#/p5.Element">p5.Element</a> object.</p>\n',type:"Function",optional:true}]}]},createA:{name:"createA",params:[{name:"href",description:"<p>URL of linked page.</p>\n",type:"String"},{name:"html",description:"<p>inner HTML of link element to display.</p>\n",type:"String"},{name:"target",description:"<p>target where the new link should open,\n                            either <code>'_blank'</code>, <code>'_self'</code>, <code>'_parent'</code>, or <code>'_top'</code>.</p>\n",type:"String",optional:true}],class:"p5",module:"DOM"},createSlider:{name:"createSlider",params:[{name:"min",description:"<p>minimum value of the slider.</p>\n",type:"Number"},{name:"max",description:"<p>maximum value of the slider.</p>\n",type:"Number"},{name:"value",description:"<p>default value of the slider.</p>\n",type:"Number",optional:true},{name:"step",description:"<p>size for each step in the slider's range.</p>\n",type:"Number",optional:true}],class:"p5",module:"DOM"},createButton:{name:"createButton",params:[{name:"label",description:"<p>label displayed on the button.</p>\n",type:"String"},{name:"value",description:"<p>value of the button.</p>\n",type:"String",optional:true}],class:"p5",module:"DOM"},createCheckbox:{name:"createCheckbox",params:[{name:"label",description:"<p>label displayed after the checkbox.</p>\n",type:"String",optional:true},{name:"value",description:"<p>value of the checkbox. Checked is <code>true</code> and unchecked is <code>false</code>.</p>\n",type:"Boolean",optional:true}],class:"p5",module:"DOM"},createSelect:{name:"createSelect",class:"p5",module:"DOM",overloads:[{params:[{name:"multiple",description:"<p>support multiple selections.</p>\n",type:"Boolean",optional:true}]},{params:[{name:"existing",description:'<p>select element to wrap, either as a <a href="#/p5.Element">p5.Element</a> or\n                         a <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLSelectElement" target="_blank">HTMLSelectElement</a>.</p>\n',type:"Object"}]}]},createRadio:{name:"createRadio",class:"p5",module:"DOM",overloads:[{params:[{name:"containerElement",description:"<p>container HTML Element, either a <code>&lt;div&gt;&lt;/div&gt;</code>\nor <code>&lt;span&gt;&lt;/span&gt;</code>.</p>\n",type:"Object",optional:true}]},{params:[{name:"name",description:"<p>name parameter assigned to each option's <code>&lt;input&gt;&lt;/input&gt;</code> element.</p>\n",type:"String",optional:true}]},{params:[]}]},createColorPicker:{name:"createColorPicker",params:[{name:"value",description:'<p>default color as a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/color" target="_blank">CSS color string</a>.</p>\n',type:"String|p5.Color",optional:true}],class:"p5",module:"DOM"},createInput:{name:"createInput",class:"p5",module:"DOM",overloads:[{params:[{name:"value",description:"<p>default value of the input box. Defaults to an empty string <code>''</code>.</p>\n",type:"String",optional:true},{name:"type",description:"<p>type of input. Defaults to <code>'text'</code>.</p>\n",type:"String",optional:true}]},{params:[{name:"value",description:"",type:"String",optional:true}]}]},createFileInput:{name:"createFileInput",params:[{name:"callback",description:"<p>function to call once the file loads.</p>\n",type:"Function"},{name:"multiple",description:"<p>allow multiple files to be selected.</p>\n",type:"Boolean",optional:true}],class:"p5",module:"DOM"},createVideo:{name:"createVideo",params:[{name:"src",description:"<p>path to a video file, or an array of paths for\n                              supporting different browsers.</p>\n",type:"String|String[]"},{name:"callback",description:"<p>function to call once the video is ready to play.</p>\n",type:"Function",optional:true}],class:"p5",module:"DOM"},createAudio:{name:"createAudio",params:[{name:"src",description:"<p>path to an audio file, or an array of paths\n                                for supporting different browsers.</p>\n",type:"String|String[]",optional:true},{name:"callback",description:"<p>function to call once the audio is ready to play.</p>\n",type:"Function",optional:true}],class:"p5",module:"DOM"},createCapture:{name:"createCapture",params:[{name:"type",description:"<p>type of capture, either AUDIO or VIDEO,\n                                  or a constraints object. Both video and audio\n                                  audio streams are captured by default.</p>\n",type:"String|Constant|Object",optional:true},{name:"callback",description:"<p>function to call once the stream\n                                  has loaded.</p>\n",type:"Function",optional:true}],class:"p5",module:"DOM"},createElement:{name:"createElement",params:[{name:"tag",description:"<p>tag for the new element.</p>\n",type:"String"},{name:"content",description:"<p>HTML content to insert into the element.</p>\n",type:"String",optional:true}],class:"p5",module:"DOM"},deviceOrientation:{name:"deviceOrientation",class:"p5",module:"Events"},accelerationX:{name:"accelerationX",class:"p5",module:"Events"},accelerationY:{name:"accelerationY",class:"p5",module:"Events"},accelerationZ:{name:"accelerationZ",class:"p5",module:"Events"},pAccelerationX:{name:"pAccelerationX",class:"p5",module:"Events"},pAccelerationY:{name:"pAccelerationY",class:"p5",module:"Events"},pAccelerationZ:{name:"pAccelerationZ",class:"p5",module:"Events"},rotationX:{name:"rotationX",class:"p5",module:"Events"},rotationY:{name:"rotationY",class:"p5",module:"Events"},rotationZ:{name:"rotationZ",class:"p5",module:"Events"},pRotationX:{name:"pRotationX",class:"p5",module:"Events"},pRotationY:{name:"pRotationY",class:"p5",module:"Events"},pRotationZ:{name:"pRotationZ",class:"p5",module:"Events"},turnAxis:{name:"turnAxis",class:"p5",module:"Events"},setMoveThreshold:{name:"setMoveThreshold",params:[{name:"value",description:"<p>The threshold value</p>\n",type:"Number"}],class:"p5",module:"Events"},setShakeThreshold:{name:"setShakeThreshold",params:[{name:"value",description:"<p>The threshold value</p>\n",type:"Number"}],class:"p5",module:"Events"},deviceMoved:{name:"deviceMoved",class:"p5",module:"Events"},deviceTurned:{name:"deviceTurned",class:"p5",module:"Events"},deviceShaken:{name:"deviceShaken",class:"p5",module:"Events"},keyIsPressed:{name:"keyIsPressed",class:"p5",module:"Events"},key:{name:"key",class:"p5",module:"Events"},keyCode:{name:"keyCode",class:"p5",module:"Events"},keyPressed:{name:"keyPressed",params:[{name:"event",description:"<p>optional KeyboardEvent callback argument.</p>\n",type:"KeyboardEvent",optional:true}],class:"p5",module:"Events"},keyReleased:{name:"keyReleased",params:[{name:"event",description:"<p>optional KeyboardEvent callback argument.</p>\n",type:"KeyboardEvent",optional:true}],class:"p5",module:"Events"},keyTyped:{name:"keyTyped",params:[{name:"event",description:"<p>optional KeyboardEvent callback argument.</p>\n",type:"KeyboardEvent",optional:true}],class:"p5",module:"Events"},keyIsDown:{name:"keyIsDown",params:[{name:"code",description:"<p>The key to check for.</p>\n",type:"Number"}],class:"p5",module:"Events"},movedX:{name:"movedX",class:"p5",module:"Events"},movedY:{name:"movedY",class:"p5",module:"Events"},mouseX:{name:"mouseX",class:"p5",module:"Events"},mouseY:{name:"mouseY",class:"p5",module:"Events"},pmouseX:{name:"pmouseX",class:"p5",module:"Events"},pmouseY:{name:"pmouseY",class:"p5",module:"Events"},winMouseX:{name:"winMouseX",class:"p5",module:"Events"},winMouseY:{name:"winMouseY",class:"p5",module:"Events"},pwinMouseX:{name:"pwinMouseX",class:"p5",module:"Events"},pwinMouseY:{name:"pwinMouseY",class:"p5",module:"Events"},mouseButton:{name:"mouseButton",class:"p5",module:"Events"},mouseIsPressed:{name:"mouseIsPressed",class:"p5",module:"Events"},mouseMoved:{name:"mouseMoved",params:[{name:"event",description:"<p>optional MouseEvent callback argument.</p>\n",type:"MouseEvent",optional:true}],class:"p5",module:"Events"},mouseDragged:{name:"mouseDragged",params:[{name:"event",description:"<p>optional MouseEvent callback argument.</p>\n",type:"MouseEvent",optional:true}],class:"p5",module:"Events"},mousePressed:{name:"mousePressed",params:[{name:"event",description:"<p>optional MouseEvent callback argument.</p>\n",type:"MouseEvent",optional:true}],class:"p5",module:"Events"},mouseReleased:{name:"mouseReleased",params:[{name:"event",description:"<p>optional MouseEvent callback argument.</p>\n",type:"MouseEvent",optional:true}],class:"p5",module:"Events"},mouseClicked:{name:"mouseClicked",params:[{name:"event",description:"<p>optional MouseEvent callback argument.</p>\n",type:"MouseEvent",optional:true}],class:"p5",module:"Events"},doubleClicked:{name:"doubleClicked",params:[{name:"event",description:"<p>optional MouseEvent callback argument.</p>\n",type:"MouseEvent",optional:true}],class:"p5",module:"Events"},mouseWheel:{name:"mouseWheel",params:[{name:"event",description:"<p>optional WheelEvent callback argument.</p>\n",type:"WheelEvent",optional:true}],class:"p5",module:"Events"},requestPointerLock:{name:"requestPointerLock",class:"p5",module:"Events"},exitPointerLock:{name:"exitPointerLock",class:"p5",module:"Events"},touches:{name:"touches",class:"p5",module:"Events"},touchStarted:{name:"touchStarted",params:[{name:"event",description:"<p>optional TouchEvent callback argument.</p>\n",type:"TouchEvent",optional:true}],class:"p5",module:"Events"},touchMoved:{name:"touchMoved",params:[{name:"event",description:"<p>optional TouchEvent callback argument.</p>\n",type:"TouchEvent",optional:true}],class:"p5",module:"Events"},touchEnded:{name:"touchEnded",params:[{name:"event",description:"<p>optional TouchEvent callback argument.</p>\n",type:"TouchEvent",optional:true}],class:"p5",module:"Events"},createImage:{name:"createImage",params:[{name:"width",description:"<p>width in pixels.</p>\n",type:"Integer"},{name:"height",description:"<p>height in pixels.</p>\n",type:"Integer"}],class:"p5",module:"Image"},saveCanvas:{name:"saveCanvas",class:"p5",module:"Image",overloads:[{params:[{name:"selectedCanvas",description:"<p>reference to a\n                                                        specific HTML5 canvas element.</p>\n",type:"p5.Framebuffer|p5.Element|HTMLCanvasElement"},{name:"filename",description:"<p>file name. Defaults to 'untitled'.</p>\n",type:"String",optional:true},{name:"extension",description:"<p>file extension, either 'jpg' or 'png'. Defaults to 'png'.</p>\n",type:"String",optional:true}]},{params:[{name:"filename",description:"",type:"String",optional:true},{name:"extension",description:"",type:"String",optional:true}]}]},saveFrames:{name:"saveFrames",params:[{name:"filename",description:"<p>prefix of file name.</p>\n",type:"String"},{name:"extension",description:"<p>file extension, either 'jpg' or 'png'.</p>\n",type:"String"},{name:"duration",description:"<p>duration in seconds to record. This parameter will be constrained to be less or equal to 15.</p>\n",type:"Number"},{name:"framerate",description:"<p>number of frames to save per second. This parameter will be constrained to be less or equal to 22.</p>\n",type:"Number"},{name:"callback",description:"<p>callback function that will be executed\n                                 to handle the image data. This function\n                                 should accept an array as argument. The\n                                 array will contain the specified number of\n                                 frames of objects. Each object has three\n                                 properties: <code>imageData</code>, <code>filename</code>, and <code>extension</code>.</p>\n",type:"Function(Array)",optional:true}],class:"p5",module:"Image"},loadImage:{name:"loadImage",params:[{name:"path",description:"<p>path of the image to be loaded or base64 encoded image.</p>\n",type:"String"},{name:"successCallback",description:'<p>function called with\n                              <a href="#/p5.Image">p5.Image</a> once it\n                              loads.</p>\n',type:"function(p5.Image)",optional:true},{name:"failureCallback",description:"<p>function called with event\n                              error if the image fails to load.</p>\n",type:"Function(Event)",optional:true}],class:"p5",module:"Image"},saveGif:{name:"saveGif",params:[{name:"filename",description:"<p>file name of gif.</p>\n",type:"String"},{name:"duration",description:"<p>duration in seconds to capture from the sketch.</p>\n",type:"Number"},{name:"options",description:"<p>an object that can contain five more properties:\n                 <code>delay</code>, a Number specifying how much time to wait before recording;\n                 <code>units</code>, a String that can be either 'seconds' or 'frames'. By default it's 'seconds’;\n                 <code>silent</code>, a Boolean that defines presence of progress notifications. By default it’s <code>false</code>;\n                 <code>notificationDuration</code>, a Number that defines how long in seconds the final notification\n                 will live. By default it's <code>0</code>, meaning the notification will never be removed;\n                 <code>notificationID</code>, a String that specifies the id of the notification's DOM element. By default it’s <code>'progressBar’</code>.</p>\n",type:"Object",optional:true}],class:"p5",module:"Image"},image:{name:"image",class:"p5",module:"Image",overloads:[{params:[{name:"img",description:"<p>image to display.</p>\n",type:"p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture"},{name:"x",description:"<p>x-coordinate of the top-left corner of the image.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the top-left corner of the image.</p>\n",type:"Number"},{name:"width",description:"<p>width to draw the image.</p>\n",type:"Number",optional:true},{name:"height",description:"<p>height to draw the image.</p>\n",type:"Number",optional:true}]},{params:[{name:"img",description:"",type:"p5.Image|p5.Element|p5.Texture|p5.Framebuffer|p5.FramebufferTexture"},{name:"dx",description:"<p>the x-coordinate of the destination\n                          rectangle in which to draw the source image</p>\n",type:"Number"},{name:"dy",description:"<p>the y-coordinate of the destination\n                          rectangle in which to draw the source image</p>\n",type:"Number"},{name:"dWidth",description:"<p>the width of the destination rectangle</p>\n",type:"Number"},{name:"dHeight",description:"<p>the height of the destination rectangle</p>\n",type:"Number"},{name:"sx",description:"<p>the x-coordinate of the subsection of the source\nimage to draw into the destination rectangle</p>\n",type:"Number"},{name:"sy",description:"<p>the y-coordinate of the subsection of the source\nimage to draw into the destination rectangle</p>\n",type:"Number"},{name:"sWidth",description:"<p>the width of the subsection of the\n                          source image to draw into the destination\n                          rectangle</p>\n",type:"Number",optional:true},{name:"sHeight",description:"<p>the height of the subsection of the\n                           source image to draw into the destination rectangle</p>\n",type:"Number",optional:true},{name:"fit",description:"<p>either CONTAIN or COVER</p>\n",type:"Constant",optional:true},{name:"xAlign",description:"<p>either LEFT, RIGHT or CENTER default is CENTER</p>\n",type:"Constant",optional:true},{name:"yAlign",description:"<p>either TOP, BOTTOM or CENTER default is CENTER</p>\n",type:"Constant",optional:true}]}]},tint:{name:"tint",class:"p5",module:"Image",overloads:[{params:[{name:"v1",description:"<p>red or hue value.</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value.</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness.</p>\n",type:"Number"},{name:"alpha",description:"",type:"Number",optional:true}]},{params:[{name:"value",description:"<p>CSS color string.</p>\n",type:"String"}]},{params:[{name:"gray",description:"<p>grayscale value.</p>\n",type:"Number"},{name:"alpha",description:"",type:"Number",optional:true}]},{params:[{name:"values",description:"<p>array containing the red, green, blue &\n                                alpha components of the color.</p>\n",type:"Number[]"}]},{params:[{name:"color",description:"<p>the tint color</p>\n",type:"p5.Color"}]}]},noTint:{name:"noTint",class:"p5",module:"Image"},imageMode:{name:"imageMode",params:[{name:"mode",description:"<p>either CORNER, CORNERS, or CENTER.</p>\n",type:"Constant"}],class:"p5",module:"Image"},pixels:{name:"pixels",class:"p5",module:"Image"},blend:{name:"blend",class:"p5",module:"Image",overloads:[{params:[{name:"srcImage",description:"<p>source image.</p>\n",type:"p5.Image"},{name:"sx",description:"<p>x-coordinate of the source's upper-left corner.</p>\n",type:"Integer"},{name:"sy",description:"<p>y-coordinate of the source's upper-left corner.</p>\n",type:"Integer"},{name:"sw",description:"<p>source image width.</p>\n",type:"Integer"},{name:"sh",description:"<p>source image height.</p>\n",type:"Integer"},{name:"dx",description:"<p>x-coordinate of the destination's upper-left corner.</p>\n",type:"Integer"},{name:"dy",description:"<p>y-coordinate of the destination's upper-left corner.</p>\n",type:"Integer"},{name:"dw",description:"<p>destination image width.</p>\n",type:"Integer"},{name:"dh",description:"<p>destination image height.</p>\n",type:"Integer"},{name:"blendMode",description:"<p>the blend mode. either\n    BLEND, DARKEST, LIGHTEST, DIFFERENCE,\n    MULTIPLY, EXCLUSION, SCREEN, REPLACE, OVERLAY, HARD_LIGHT,\n    SOFT_LIGHT, DODGE, BURN, ADD or NORMAL.</p>\n",type:"Constant"}]},{params:[{name:"sx",description:"",type:"Integer"},{name:"sy",description:"",type:"Integer"},{name:"sw",description:"",type:"Integer"},{name:"sh",description:"",type:"Integer"},{name:"dx",description:"",type:"Integer"},{name:"dy",description:"",type:"Integer"},{name:"dw",description:"",type:"Integer"},{name:"dh",description:"",type:"Integer"},{name:"blendMode",description:"",type:"Constant"}]}]},copy:{name:"copy",class:"p5",module:"Image",overloads:[{params:[{name:"srcImage",description:"<p>source image.</p>\n",type:"p5.Image|p5.Element"},{name:"sx",description:"<p>x-coordinate of the source's upper-left corner.</p>\n",type:"Integer"},{name:"sy",description:"<p>y-coordinate of the source's upper-left corner.</p>\n",type:"Integer"},{name:"sw",description:"<p>source image width.</p>\n",type:"Integer"},{name:"sh",description:"<p>source image height.</p>\n",type:"Integer"},{name:"dx",description:"<p>x-coordinate of the destination's upper-left corner.</p>\n",type:"Integer"},{name:"dy",description:"<p>y-coordinate of the destination's upper-left corner.</p>\n",type:"Integer"},{name:"dw",description:"<p>destination image width.</p>\n",type:"Integer"},{name:"dh",description:"<p>destination image height.</p>\n",type:"Integer"}]},{params:[{name:"sx",description:"",type:"Integer"},{name:"sy",description:"",type:"Integer"},{name:"sw",description:"",type:"Integer"},{name:"sh",description:"",type:"Integer"},{name:"dx",description:"",type:"Integer"},{name:"dy",description:"",type:"Integer"},{name:"dw",description:"",type:"Integer"},{name:"dh",description:"",type:"Integer"}]}]},filter:{name:"filter",class:"p5",module:"Image",overloads:[{params:[{name:"filterType",description:"<p>either THRESHOLD, GRAY, OPAQUE, INVERT,\n                               POSTERIZE, BLUR, ERODE, DILATE or BLUR.</p>\n",type:"Constant"},{name:"filterParam",description:"<p>parameter unique to each filter.</p>\n",type:"Number",optional:true},{name:"useWebGL",description:"<p>flag to control whether to use fast\n                               WebGL filters (GPU) or original image\n                               filters (CPU); defaults to <code>true</code>.</p>\n",type:"Boolean",optional:true}]},{params:[{name:"filterType",description:"",type:"Constant"},{name:"useWebGL",description:"",type:"Boolean",optional:true}]},{params:[{name:"shaderFilter",description:"<p>shader that's been loaded, with the\n                                  frag shader using a <code>tex0</code> uniform.</p>\n",type:"p5.Shader"}]}]},get:{name:"get",class:"p5",module:"Image",overloads:[{params:[{name:"x",description:"<p>x-coordinate of the pixel.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the pixel.</p>\n",type:"Number"},{name:"w",description:"<p>width of the subsection to be returned.</p>\n",type:"Number"},{name:"h",description:"<p>height of the subsection to be returned.</p>\n",type:"Number"}]},{params:[]},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"}]}]},loadPixels:{name:"loadPixels",class:"p5",module:"Image"},set:{name:"set",params:[{name:"x",description:"<p>x-coordinate of the pixel.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the pixel.</p>\n",type:"Number"},{name:"c",description:'<p>grayscale value | pixel array |\n                               <a href="#/p5.Color">p5.Color</a> object | <a href="#/p5.Image">p5.Image</a> to copy.</p>\n',type:"Number|Number[]|Object"}],class:"p5",module:"Image"},updatePixels:{name:"updatePixels",params:[{name:"x",description:"<p>x-coordinate of the upper-left corner of region\n                        to update.</p>\n",type:"Number",optional:true},{name:"y",description:"<p>y-coordinate of the upper-left corner of region\n                        to update.</p>\n",type:"Number",optional:true},{name:"w",description:"<p>width of region to update.</p>\n",type:"Number",optional:true},{name:"h",description:"<p>height of region to update.</p>\n",type:"Number",optional:true}],class:"p5",module:"Image"},loadJSON:{name:"loadJSON",class:"p5",module:"IO",overloads:[{params:[{name:"path",description:"<p>name of the file or url to load</p>\n",type:"String"},{name:"jsonpOptions",description:"<p>options object for jsonp related settings</p>\n",type:"Object",optional:true},{name:"datatype",description:'<p>"json" or "jsonp"</p>\n',type:"String",optional:true},{name:"callback",description:'<p>function to be executed after\n                                   <a href="#/p5/loadJSON">loadJSON()</a> completes, data is passed\n                                   in as first argument</p>\n',type:"Function",optional:true},{name:"errorCallback",description:"<p>function to be executed if\n                                   there is an error, response is passed\n                                   in as first argument</p>\n",type:"Function",optional:true}]},{params:[{name:"path",description:"",type:"String"},{name:"datatype",description:"",type:"String"},{name:"callback",description:"",type:"Function",optional:true},{name:"errorCallback",description:"",type:"Function",optional:true}]},{params:[{name:"path",description:"",type:"String"},{name:"callback",description:"",type:"Function"},{name:"errorCallback",description:"",type:"Function",optional:true}]}]},loadStrings:{name:"loadStrings",params:[{name:"filename",description:"<p>name of the file or url to load</p>\n",type:"String"},{name:"callback",description:'<p>function to be executed after <a href="#/p5/loadStrings">loadStrings()</a>\n                              completes, Array is passed in as first\n                              argument</p>\n',type:"Function",optional:true},{name:"errorCallback",description:"<p>function to be executed if\n                              there is an error, response is passed\n                              in as first argument</p>\n",type:"Function",optional:true}],class:"p5",module:"IO"},loadTable:{name:"loadTable",params:[{name:"filename",description:"<p>name of the file or URL to load</p>\n",type:"String"},{name:"extension",description:'<p>parse the table by comma-separated values "csv", semicolon-separated\n                                     values "ssv", or tab-separated values "tsv"</p>\n',type:"String",optional:true},{name:"header",description:'<p>"header" to indicate table has header row</p>\n',type:"String",optional:true},{name:"callback",description:'<p>function to be executed after\n                                     <a href="#/p5/loadTable">loadTable()</a> completes. On success, the\n                                     <a href="#/p5.Table">Table</a> object is passed in as the\n                                     first argument.</p>\n',type:"Function",optional:true},{name:"errorCallback",description:"<p>function to be executed if\n                                     there is an error, response is passed\n                                     in as first argument</p>\n",type:"Function",optional:true}],class:"p5",module:"IO"},loadXML:{name:"loadXML",params:[{name:"filename",description:"<p>name of the file or URL to load</p>\n",type:"String"},{name:"callback",description:'<p>function to be executed after <a href="#/p5/loadXML">loadXML()</a>\n                              completes, XML object is passed in as\n                              first argument</p>\n',type:"Function",optional:true},{name:"errorCallback",description:"<p>function to be executed if\n                              there is an error, response is passed\n                              in as first argument</p>\n",type:"Function",optional:true}],class:"p5",module:"IO"},loadBytes:{name:"loadBytes",params:[{name:"file",description:"<p>name of the file or URL to load</p>\n",type:"String"},{name:"callback",description:'<p>function to be executed after <a href="#/p5/loadBytes">loadBytes()</a>\n                                   completes</p>\n',type:"Function",optional:true},{name:"errorCallback",description:"<p>function to be executed if there\n                                   is an error</p>\n",type:"Function",optional:true}],class:"p5",module:"IO"},httpGet:{name:"httpGet",class:"p5",module:"IO",overloads:[{params:[{name:"path",description:"<p>name of the file or url to load</p>\n",type:"String"},{name:"datatype",description:'<p>"json", "jsonp", "binary", "arrayBuffer",\n                                   "xml", or "text"</p>\n',type:"String",optional:true},{name:"data",description:"<p>param data passed sent with request</p>\n",type:"Object|Boolean",optional:true},{name:"callback",description:'<p>function to be executed after\n                                   <a href="#/p5/httpGet">httpGet()</a> completes, data is passed in\n                                   as first argument</p>\n',type:"Function",optional:true},{name:"errorCallback",description:"<p>function to be executed if\n                                   there is an error, response is passed\n                                   in as first argument</p>\n",type:"Function",optional:true}]},{params:[{name:"path",description:"",type:"String"},{name:"data",description:"",type:"Object|Boolean"},{name:"callback",description:"",type:"Function",optional:true},{name:"errorCallback",description:"",type:"Function",optional:true}]},{params:[{name:"path",description:"",type:"String"},{name:"callback",description:"",type:"Function"},{name:"errorCallback",description:"",type:"Function",optional:true}]}]},httpPost:{name:"httpPost",class:"p5",module:"IO",overloads:[{params:[{name:"path",description:"<p>name of the file or url to load</p>\n",type:"String"},{name:"datatype",description:'<p>"json", "jsonp", "xml", or "text".\n                                   If omitted, <a href="#/p5/httpPost">httpPost()</a> will guess.</p>\n',type:"String",optional:true},{name:"data",description:"<p>param data passed sent with request</p>\n",type:"Object|Boolean",optional:true},{name:"callback",description:'<p>function to be executed after\n                                   <a href="#/p5/httpPost">httpPost()</a> completes, data is passed in\n                                   as first argument</p>\n',type:"Function",optional:true},{name:"errorCallback",description:"<p>function to be executed if\n                                   there is an error, response is passed\n                                   in as first argument</p>\n",type:"Function",optional:true}]},{params:[{name:"path",description:"",type:"String"},{name:"data",description:"",type:"Object|Boolean"},{name:"callback",description:"",type:"Function",optional:true},{name:"errorCallback",description:"",type:"Function",optional:true}]},{params:[{name:"path",description:"",type:"String"},{name:"callback",description:"",type:"Function"},{name:"errorCallback",description:"",type:"Function",optional:true}]}]},httpDo:{name:"httpDo",class:"p5",module:"IO",overloads:[{params:[{name:"path",description:"<p>name of the file or url to load</p>\n",type:"String"},{name:"method",description:'<p>either "GET", "POST", or "PUT",\n                                   defaults to "GET"</p>\n',type:"String",optional:true},{name:"datatype",description:'<p>"json", "jsonp", "xml", or "text"</p>\n',type:"String",optional:true},{name:"data",description:"<p>param data passed sent with request</p>\n",type:"Object",optional:true},{name:"callback",description:'<p>function to be executed after\n                                   <a href="#/p5/httpGet">httpGet()</a> completes, data is passed in\n                                   as first argument</p>\n',type:"Function",optional:true},{name:"errorCallback",description:"<p>function to be executed if\n                                   there is an error, response is passed\n                                   in as first argument</p>\n",type:"Function",optional:true}]},{params:[{name:"path",description:"",type:"String"},{name:"options",description:'<p>Request object options as documented in the\n                                   "fetch" API\n<a href="https://developer.mozilla.org/en/docs/Web/API/Fetch_API">reference</a></p>\n',type:"Object"},{name:"callback",description:"",type:"Function",optional:true},{name:"errorCallback",description:"",type:"Function",optional:true}]}]},createWriter:{name:"createWriter",params:[{name:"name",description:"<p>name of the file to be created</p>\n",type:"String"},{name:"extension",description:"",type:"String",optional:true}],class:"p5",module:"IO"},save:{name:"save",params:[{name:"objectOrFilename",description:"<p>If filename is provided, will\n                                           save canvas as an image with\n                                           either png or jpg extension\n                                           depending on the filename.\n                                           If object is provided, will\n                                           save depending on the object\n                                           and filename (see examples\n                                           above).</p>\n",type:"Object|String",optional:true},{name:"filename",description:"<p>If an object is provided as the first\n                             parameter, then the second parameter\n                             indicates the filename,\n                             and should include an appropriate\n                             file extension (see examples above).</p>\n",type:"String",optional:true},{name:"options",description:"<p>Additional options depend on\n                          filetype. For example, when saving JSON,\n                          <code>true</code> indicates that the\n                          output will be optimized for filesize,\n                          rather than readability.</p>\n",type:"Boolean|String",optional:true}],class:"p5",module:"IO"},saveJSON:{name:"saveJSON",params:[{name:"json",description:"",type:"Array|Object"},{name:"filename",description:"",type:"String"},{name:"optimize",description:"<p>If true, removes line breaks\n                               and spaces from the output\n                               file to optimize filesize\n                               (but not readability).</p>\n",type:"Boolean",optional:true}],class:"p5",module:"IO"},saveStrings:{name:"saveStrings",params:[{name:"list",description:"<p>string array to be written</p>\n",type:"String[]"},{name:"filename",description:"<p>filename for output</p>\n",type:"String"},{name:"extension",description:"<p>the filename's extension</p>\n",type:"String",optional:true},{name:"isCRLF",description:"<p>if true, change line-break to CRLF</p>\n",type:"Boolean",optional:true}],class:"p5",module:"IO"},saveTable:{name:"saveTable",params:[{name:"Table",description:'<p>the <a href="#/p5.Table">Table</a> object to save to a file</p>\n',type:"p5.Table"},{name:"filename",description:"<p>the filename to which the Table should be saved</p>\n",type:"String"},{name:"options",description:'<p>can be one of "tsv", "csv", or "html"</p>\n',type:"String",optional:true}],class:"p5",module:"IO"},abs:{name:"abs",params:[{name:"n",description:"<p>number to compute.</p>\n",type:"Number"}],class:"p5",module:"Math"},ceil:{name:"ceil",params:[{name:"n",description:"<p>number to round up.</p>\n",type:"Number"}],class:"p5",module:"Math"},constrain:{name:"constrain",params:[{name:"n",description:"<p>number to constrain.</p>\n",type:"Number"},{name:"low",description:"<p>minimum limit.</p>\n",type:"Number"},{name:"high",description:"<p>maximum limit.</p>\n",type:"Number"}],class:"p5",module:"Math"},dist:{name:"dist",class:"p5",module:"Math",overloads:[{params:[{name:"x1",description:"<p>x-coordinate of the first point.</p>\n",type:"Number"},{name:"y1",description:"<p>y-coordinate of the first point.</p>\n",type:"Number"},{name:"x2",description:"<p>x-coordinate of the second point.</p>\n",type:"Number"},{name:"y2",description:"<p>y-coordinate of the second point.</p>\n",type:"Number"}]},{params:[{name:"x1",description:"",type:"Number"},{name:"y1",description:"",type:"Number"},{name:"z1",description:"<p>z-coordinate of the first point.</p>\n",type:"Number"},{name:"x2",description:"",type:"Number"},{name:"y2",description:"",type:"Number"},{name:"z2",description:"<p>z-coordinate of the second point.</p>\n",type:"Number"}]}]},exp:{name:"exp",params:[{name:"n",description:"<p>exponent to raise.</p>\n",type:"Number"}],class:"p5",module:"Math"},floor:{name:"floor",params:[{name:"n",description:"<p>number to round down.</p>\n",type:"Number"}],class:"p5",module:"Math"},lerp:{name:"lerp",params:[{name:"start",description:"<p>first value.</p>\n",type:"Number"},{name:"stop",description:"<p>second value.</p>\n",type:"Number"},{name:"amt",description:"<p>number.</p>\n",type:"Number"}],class:"p5",module:"Math"},log:{name:"log",params:[{name:"n",description:"<p>number greater than 0.</p>\n",type:"Number"}],class:"p5",module:"Math"},mag:{name:"mag",params:[{name:"x",description:"<p>first component.</p>\n",type:"Number"},{name:"y",description:"<p>second component.</p>\n",type:"Number"}],class:"p5",module:"Math"},map:{name:"map",params:[{name:"value",description:"<p>the incoming value to be converted.</p>\n",type:"Number"},{name:"start1",description:"<p>lower bound of the value's current range.</p>\n",type:"Number"},{name:"stop1",description:"<p>upper bound of the value's current range.</p>\n",type:"Number"},{name:"start2",description:"<p>lower bound of the value's target range.</p>\n",type:"Number"},{name:"stop2",description:"<p>upper bound of the value's target range.</p>\n",type:"Number"},{name:"withinBounds",description:"<p>constrain the value to the newly mapped range.</p>\n",type:"Boolean",optional:true}],class:"p5",module:"Math"},max:{name:"max",class:"p5",module:"Math",overloads:[{params:[{name:"n0",description:"<p>first number to compare.</p>\n",type:"Number"},{name:"n1",description:"<p>second number to compare.</p>\n",type:"Number"}]},{params:[{name:"nums",description:"<p>numbers to compare.</p>\n",type:"Number[]"}]}]},min:{name:"min",class:"p5",module:"Math",overloads:[{params:[{name:"n0",description:"<p>first number to compare.</p>\n",type:"Number"},{name:"n1",description:"<p>second number to compare.</p>\n",type:"Number"}]},{params:[{name:"nums",description:"<p>numbers to compare.</p>\n",type:"Number[]"}]}]},norm:{name:"norm",params:[{name:"value",description:"<p>incoming value to be normalized.</p>\n",type:"Number"},{name:"start",description:"<p>lower bound of the value's current range.</p>\n",type:"Number"},{name:"stop",description:"<p>upper bound of the value's current range.</p>\n",type:"Number"}],class:"p5",module:"Math"},pow:{name:"pow",params:[{name:"n",description:"<p>base of the exponential expression.</p>\n",type:"Number"},{name:"e",description:"<p>power by which to raise the base.</p>\n",type:"Number"}],class:"p5",module:"Math"},round:{name:"round",params:[{name:"n",description:"<p>number to round.</p>\n",type:"Number"},{name:"decimals",description:"<p>number of decimal places to round to, default is 0.</p>\n",type:"Number",optional:true}],class:"p5",module:"Math"},sq:{name:"sq",params:[{name:"n",description:"<p>number to square.</p>\n",type:"Number"}],class:"p5",module:"Math"},sqrt:{name:"sqrt",params:[{name:"n",description:"<p>non-negative number to square root.</p>\n",type:"Number"}],class:"p5",module:"Math"},fract:{name:"fract",params:[{name:"n",description:"<p>number whose fractional part will be found.</p>\n",type:"Number"}],class:"p5",module:"Math"},createVector:{name:"createVector",params:[{name:"x",description:"<p>x component of the vector.</p>\n",type:"Number",optional:true},{name:"y",description:"<p>y component of the vector.</p>\n",type:"Number",optional:true},{name:"z",description:"<p>z component of the vector.</p>\n",type:"Number",optional:true}],class:"p5",module:"Math"},noise:{name:"noise",params:[{name:"x",description:"<p>x-coordinate in noise space.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate in noise space.</p>\n",type:"Number",optional:true},{name:"z",description:"<p>z-coordinate in noise space.</p>\n",type:"Number",optional:true}],class:"p5",module:"Math"},noiseDetail:{name:"noiseDetail",params:[{name:"lod",description:"<p>number of octaves to be used by the noise.</p>\n",type:"Number"},{name:"falloff",description:"<p>falloff factor for each octave.</p>\n",type:"Number"}],class:"p5",module:"Math"},noiseSeed:{name:"noiseSeed",params:[{name:"seed",description:"<p>seed value.</p>\n",type:"Number"}],class:"p5",module:"Math"},randomSeed:{name:"randomSeed",params:[{name:"seed",description:"<p>seed value.</p>\n",type:"Number"}],class:"p5",module:"Math"},random:{name:"random",class:"p5",module:"Math",overloads:[{params:[{name:"min",description:"<p>lower bound (inclusive).</p>\n",type:"Number",optional:true},{name:"max",description:"<p>upper bound (exclusive).</p>\n",type:"Number",optional:true}]},{params:[{name:"choices",description:"<p>array to choose from.</p>\n",type:"Array"}]}]},randomGaussian:{name:"randomGaussian",params:[{name:"mean",description:"<p>mean.</p>\n",type:"Number",optional:true},{name:"sd",description:"<p>standard deviation.</p>\n",type:"Number",optional:true}],class:"p5",module:"Math"},acos:{name:"acos",params:[{name:"value",description:"<p>value whose arc cosine is to be returned.</p>\n",type:"Number"}],class:"p5",module:"Math"},asin:{name:"asin",params:[{name:"value",description:"<p>value whose arc sine is to be returned.</p>\n",type:"Number"}],class:"p5",module:"Math"},atan:{name:"atan",params:[{name:"value",description:"<p>value whose arc tangent is to be returned.</p>\n",type:"Number"}],class:"p5",module:"Math"},atan2:{name:"atan2",params:[{name:"y",description:"<p>y-coordinate of the point.</p>\n",type:"Number"},{name:"x",description:"<p>x-coordinate of the point.</p>\n",type:"Number"}],class:"p5",module:"Math"},cos:{name:"cos",params:[{name:"angle",description:"<p>the angle.</p>\n",type:"Number"}],class:"p5",module:"Math"},sin:{name:"sin",params:[{name:"angle",description:"<p>the angle.</p>\n",type:"Number"}],class:"p5",module:"Math"},tan:{name:"tan",params:[{name:"angle",description:"<p>the angle.</p>\n",type:"Number"}],class:"p5",module:"Math"},degrees:{name:"degrees",params:[{name:"radians",description:"<p>radians value to convert to degrees.</p>\n",type:"Number"}],class:"p5",module:"Math"},radians:{name:"radians",params:[{name:"degrees",description:"<p>degree value to convert to radians.</p>\n",type:"Number"}],class:"p5",module:"Math"},angleMode:{name:"angleMode",class:"p5",module:"Math",overloads:[{params:[{name:"mode",description:"<p>either RADIANS or DEGREES.</p>\n",type:"Constant"}]},{params:[]}]},textAlign:{name:"textAlign",class:"p5",module:"Typography",overloads:[{params:[{name:"horizAlign",description:"<p>horizontal alignment, either LEFT,\n                           CENTER, or RIGHT.</p>\n",type:"Constant"},{name:"vertAlign",description:"<p>vertical alignment, either TOP,\n                           BOTTOM, CENTER, or BASELINE.</p>\n",type:"Constant",optional:true}],chainable:1},{params:[]}]},textLeading:{name:"textLeading",class:"p5",module:"Typography",overloads:[{params:[{name:"leading",description:"<p>spacing between lines of text in units of pixels.</p>\n",type:"Number"}],chainable:1},{params:[]}]},textSize:{name:"textSize",class:"p5",module:"Typography",overloads:[{params:[{name:"size",description:"<p>size of the letters in units of pixels</p>\n",type:"Number"}],chainable:1},{params:[]}]},textStyle:{name:"textStyle",class:"p5",module:"Typography",overloads:[{params:[{name:"style",description:"<p>styling for text, either NORMAL,\n                           ITALIC, BOLD or BOLDITALIC</p>\n",type:"Constant"}],chainable:1},{params:[]}]},textWidth:{name:"textWidth",params:[{name:"str",description:"<p>string of text to measure.</p>\n",type:"String"}],class:"p5",module:"Typography"},textAscent:{name:"textAscent",class:"p5",module:"Typography"},textDescent:{name:"textDescent",class:"p5",module:"Typography"},textWrap:{name:"textWrap",params:[{name:"style",description:"<p>text wrapping style, either WORD or CHAR.</p>\n",type:"Constant"}],class:"p5",module:"Typography"},loadFont:{name:"loadFont",params:[{name:"path",description:"<p>path of the font to be loaded.</p>\n",type:"String"},{name:"successCallback",description:'<p>function called with the\n                                          <a href="#/p5.Font">p5.Font</a> object after it\n                                          loads.</p>\n',type:"Function",optional:true},{name:"failureCallback",description:'<p>function called with the error\n                                          <a href="https://developer.mozilla.org/en-US/docs/Web/API/Event" target="_blank">Event</a>\n                                          object if the font fails to load.</p>\n',type:"Function",optional:true}],class:"p5",module:"Typography"},text:{name:"text",params:[{name:"str",description:"<p>text to be displayed.</p>\n",type:"String|Object|Array|Number|Boolean"},{name:"x",description:"<p>x-coordinate of the text box.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the text box.</p>\n",type:"Number"},{name:"maxWidth",description:'<p>maximum width of the text box. See\n                           <a href="#/p5/rectMode">rectMode()</a> for\n                           other options.</p>\n',type:"Number",optional:true},{name:"maxHeight",description:'<p>maximum height of the text box. See\n                           <a href="#/p5/rectMode">rectMode()</a> for\n                           other options.</p>\n',type:"Number",optional:true}],class:"p5",module:"Typography"},textFont:{name:"textFont",class:"p5",module:"Typography",overloads:[{params:[]},{params:[{name:"font",description:'<p>font as a <a href="#/p5.Font">p5.Font</a> object or a string.</p>\n',type:"Object|String"},{name:"size",description:"<p>font size in pixels.</p>\n",type:"Number",optional:true}],chainable:1}]},append:{name:"append",params:[{name:"array",description:"<p>Array to append</p>\n",type:"Array"},{name:"value",description:"<p>to be added to the Array</p>\n",type:"Any"}],class:"p5",module:"Data"},arrayCopy:{name:"arrayCopy",class:"p5",module:"Data",overloads:[{params:[{name:"src",description:"<p>the source Array</p>\n",type:"Array"},{name:"srcPosition",description:"<p>starting position in the source Array</p>\n",type:"Integer"},{name:"dst",description:"<p>the destination Array</p>\n",type:"Array"},{name:"dstPosition",description:"<p>starting position in the destination Array</p>\n",type:"Integer"},{name:"length",description:"<p>number of Array elements to be copied</p>\n",type:"Integer"}]},{params:[{name:"src",description:"",type:"Array"},{name:"dst",description:"",type:"Array"},{name:"length",description:"",type:"Integer",optional:true}]}]},concat:{name:"concat",params:[{name:"a",description:"<p>first Array to concatenate</p>\n",type:"Array"},{name:"b",description:"<p>second Array to concatenate</p>\n",type:"Array"}],class:"p5",module:"Data"},reverse:{name:"reverse",params:[{name:"list",description:"<p>Array to reverse</p>\n",type:"Array"}],class:"p5",module:"Data"},shorten:{name:"shorten",params:[{name:"list",description:"<p>Array to shorten</p>\n",type:"Array"}],class:"p5",module:"Data"},shuffle:{name:"shuffle",params:[{name:"array",description:"<p>Array to shuffle</p>\n",type:"Array"},{name:"bool",description:"<p>modify passed array</p>\n",type:"Boolean",optional:true}],class:"p5",module:"Data"},sort:{name:"sort",params:[{name:"list",description:"<p>Array to sort</p>\n",type:"Array"},{name:"count",description:"<p>number of elements to sort, starting from 0</p>\n",type:"Integer",optional:true}],class:"p5",module:"Data"},splice:{name:"splice",params:[{name:"list",description:"<p>Array to splice into</p>\n",type:"Array"},{name:"value",description:"<p>value to be spliced in</p>\n",type:"Any"},{name:"position",description:"<p>in the array from which to insert data</p>\n",type:"Integer"}],class:"p5",module:"Data"},subset:{name:"subset",params:[{name:"list",description:"<p>Array to extract from</p>\n",type:"Array"},{name:"start",description:"<p>position to begin</p>\n",type:"Integer"},{name:"count",description:"<p>number of values to extract</p>\n",type:"Integer",optional:true}],class:"p5",module:"Data"},float:{name:"float",params:[{name:"str",description:"<p>float string to parse</p>\n",type:"String"}],class:"p5",module:"Data"},int:{name:"int",class:"p5",module:"Data",overloads:[{params:[{name:"n",description:"<p>value to parse</p>\n",type:"String|Boolean|Number"},{name:"radix",description:"<p>the radix to convert to (default: 10)</p>\n",type:"Integer",optional:true}]},{params:[{name:"ns",description:"<p>values to parse</p>\n",type:"Array"},{name:"radix",description:"",type:"Integer",optional:true}]}]},str:{name:"str",params:[{name:"n",description:"<p>value to parse</p>\n",type:"String|Boolean|Number|Array"}],class:"p5",module:"Data"},byte:{name:"byte",class:"p5",module:"Data",overloads:[{params:[{name:"n",description:"<p>value to parse</p>\n",type:"String|Boolean|Number"}]},{params:[{name:"ns",description:"<p>values to parse</p>\n",type:"Array"}]}]},char:{name:"char",class:"p5",module:"Data",overloads:[{params:[{name:"n",description:"<p>value to parse</p>\n",type:"String|Number"}]},{params:[{name:"ns",description:"<p>values to parse</p>\n",type:"Array"}]}]},unchar:{name:"unchar",class:"p5",module:"Data",overloads:[{params:[{name:"n",description:"<p>value to parse</p>\n",type:"String"}]},{params:[{name:"ns",description:"<p>values to parse</p>\n",type:"Array"}]}]},hex:{name:"hex",class:"p5",module:"Data",overloads:[{params:[{name:"n",description:"<p>value to parse</p>\n",type:"Number"},{name:"digits",description:"",type:"Number",optional:true}]},{params:[{name:"ns",description:"<p>array of values to parse</p>\n",type:"Number[]"},{name:"digits",description:"",type:"Number",optional:true}]}]},unhex:{name:"unhex",class:"p5",module:"Data",overloads:[{params:[{name:"n",description:"<p>value to parse</p>\n",type:"String"}]},{params:[{name:"ns",description:"<p>values to parse</p>\n",type:"Array"}]}]},join:{name:"join",params:[{name:"list",description:"<p>array of Strings to be joined</p>\n",type:"Array"},{name:"separator",description:"<p>String to be placed between each item</p>\n",type:"String"}],class:"p5",module:"Data"},match:{name:"match",params:[{name:"str",description:"<p>the String to be searched</p>\n",type:"String"},{name:"regexp",description:"<p>the regexp to be used for matching</p>\n",type:"String"}],class:"p5",module:"Data"},matchAll:{name:"matchAll",params:[{name:"str",description:"<p>the String to be searched</p>\n",type:"String"},{name:"regexp",description:"<p>the regexp to be used for matching</p>\n",type:"String"}],class:"p5",module:"Data"},nf:{name:"nf",class:"p5",module:"Data",overloads:[{params:[{name:"num",description:"<p>the Number to format</p>\n",type:"Number|String"},{name:"left",description:"<p>number of digits to the left of the\n                               decimal point</p>\n",type:"Integer|String",optional:true},{name:"right",description:"<p>number of digits to the right of the\n                               decimal point</p>\n",type:"Integer|String",optional:true}]},{params:[{name:"nums",description:"<p>the Numbers to format</p>\n",type:"Array"},{name:"left",description:"",type:"Integer|String",optional:true},{name:"right",description:"",type:"Integer|String",optional:true}]}]},nfc:{name:"nfc",class:"p5",module:"Data",overloads:[{params:[{name:"num",description:"<p>the Number to format</p>\n",type:"Number|String"},{name:"right",description:"<p>number of digits to the right of the\n                                 decimal point</p>\n",type:"Integer|String",optional:true}]},{params:[{name:"nums",description:"<p>the Numbers to format</p>\n",type:"Array"},{name:"right",description:"",type:"Integer|String",optional:true}]}]},nfp:{name:"nfp",class:"p5",module:"Data",overloads:[{params:[{name:"num",description:"<p>the Number to format</p>\n",type:"Number"},{name:"left",description:"<p>number of digits to the left of the decimal\n                               point</p>\n",type:"Integer",optional:true},{name:"right",description:"<p>number of digits to the right of the\n                               decimal point</p>\n",type:"Integer",optional:true}]},{params:[{name:"nums",description:"<p>the Numbers to format</p>\n",type:"Number[]"},{name:"left",description:"",type:"Integer",optional:true},{name:"right",description:"",type:"Integer",optional:true}]}]},nfs:{name:"nfs",class:"p5",module:"Data",overloads:[{params:[{name:"num",description:"<p>the Number to format</p>\n",type:"Number"},{name:"left",description:"<p>number of digits to the left of the decimal\n                               point</p>\n",type:"Integer",optional:true},{name:"right",description:"<p>number of digits to the right of the\n                               decimal point</p>\n",type:"Integer",optional:true}]},{params:[{name:"nums",description:"<p>the Numbers to format</p>\n",type:"Array"},{name:"left",description:"",type:"Integer",optional:true},{name:"right",description:"",type:"Integer",optional:true}]}]},split:{name:"split",params:[{name:"value",description:"<p>the String to be split</p>\n",type:"String"},{name:"delim",description:"<p>the String used to separate the data</p>\n",type:"String"}],class:"p5",module:"Data"},splitTokens:{name:"splitTokens",params:[{name:"value",description:"<p>the String to be split</p>\n",type:"String"},{name:"delim",description:"<p>list of individual Strings that will be used as\n                         separators</p>\n",type:"String",optional:true}],class:"p5",module:"Data"},trim:{name:"trim",class:"p5",module:"Data",overloads:[{params:[{name:"str",description:"<p>a String to be trimmed</p>\n",type:"String"}]},{params:[{name:"strs",description:"<p>an Array of Strings to be trimmed</p>\n",type:"Array"}]}]},day:{name:"day",class:"p5",module:"IO"},hour:{name:"hour",class:"p5",module:"IO"},minute:{name:"minute",class:"p5",module:"IO"},millis:{name:"millis",class:"p5",module:"IO"},month:{name:"month",class:"p5",module:"IO"},second:{name:"second",class:"p5",module:"IO"},year:{name:"year",class:"p5",module:"IO"},beginGeometry:{name:"beginGeometry",class:"p5",module:"Shape"},endGeometry:{name:"endGeometry",class:"p5",module:"Shape"},buildGeometry:{name:"buildGeometry",params:[{name:"callback",description:"<p>A function that draws shapes.</p>\n",type:"Function"}],class:"p5",module:"Shape"},freeGeometry:{name:"freeGeometry",params:[{name:"geometry",description:"<p>The geometry whose resources should be freed</p>\n",type:"p5.Geometry"}],class:"p5",module:"Shape"},plane:{name:"plane",params:[{name:"width",description:"<p>width of the plane</p>\n",type:"Number",optional:true},{name:"height",description:"<p>height of the plane</p>\n",type:"Number",optional:true},{name:"detailX",description:"<p>Optional number of triangle\n                            subdivisions in x-dimension</p>\n",type:"Integer",optional:true},{name:"detailY",description:"<p>Optional number of triangle\n                            subdivisions in y-dimension</p>\n",type:"Integer",optional:true}],class:"p5",module:"Shape"},box:{name:"box",params:[{name:"width",description:"<p>width of the box</p>\n",type:"Number",optional:true},{name:"height",description:"<p>height of the box</p>\n",type:"Number",optional:true},{name:"depth",description:"<p>depth of the box</p>\n",type:"Number",optional:true},{name:"detailX",description:"<p>Optional number of triangle\n                           subdivisions in x-dimension</p>\n",type:"Integer",optional:true},{name:"detailY",description:"<p>Optional number of triangle\n                           subdivisions in y-dimension</p>\n",type:"Integer",optional:true}],class:"p5",module:"Shape"},sphere:{name:"sphere",params:[{name:"radius",description:"<p>radius of circle</p>\n",type:"Number",optional:true},{name:"detailX",description:"<p>optional number of subdivisions in x-dimension</p>\n",type:"Integer",optional:true},{name:"detailY",description:"<p>optional number of subdivisions in y-dimension</p>\n",type:"Integer",optional:true}],class:"p5",module:"Shape"},cylinder:{name:"cylinder",params:[{name:"radius",description:"<p>radius of the surface</p>\n",type:"Number",optional:true},{name:"height",description:"<p>height of the cylinder</p>\n",type:"Number",optional:true},{name:"detailX",description:"<p>number of subdivisions in x-dimension;\n                              default is 24</p>\n",type:"Integer",optional:true},{name:"detailY",description:"<p>number of subdivisions in y-dimension;\n                              default is 1</p>\n",type:"Integer",optional:true},{name:"bottomCap",description:"<p>whether to draw the bottom of the cylinder</p>\n",type:"Boolean",optional:true},{name:"topCap",description:"<p>whether to draw the top of the cylinder</p>\n",type:"Boolean",optional:true}],class:"p5",module:"Shape"},cone:{name:"cone",params:[{name:"radius",description:"<p>radius of the bottom surface</p>\n",type:"Number",optional:true},{name:"height",description:"<p>height of the cone</p>\n",type:"Number",optional:true},{name:"detailX",description:"<p>number of segments,\n                            the more segments the smoother geometry\n                            default is 24</p>\n",type:"Integer",optional:true},{name:"detailY",description:"<p>number of segments,\n                            the more segments the smoother geometry\n                            default is 1</p>\n",type:"Integer",optional:true},{name:"cap",description:"<p>whether to draw the base of the cone</p>\n",type:"Boolean",optional:true}],class:"p5",module:"Shape"},ellipsoid:{name:"ellipsoid",params:[{name:"radiusx",description:"<p>x-radius of ellipsoid</p>\n",type:"Number",optional:true},{name:"radiusy",description:"<p>y-radius of ellipsoid</p>\n",type:"Number",optional:true},{name:"radiusz",description:"<p>z-radius of ellipsoid</p>\n",type:"Number",optional:true},{name:"detailX",description:"<p>number of segments,\n                                   the more segments the smoother geometry\n                                   default is 24. Avoid detail number above\n                                   150, it may crash the browser.</p>\n",type:"Integer",optional:true},{name:"detailY",description:"<p>number of segments,\n                                   the more segments the smoother geometry\n                                   default is 16. Avoid detail number above\n                                   150, it may crash the browser.</p>\n",type:"Integer",optional:true}],class:"p5",module:"Shape"},torus:{name:"torus",params:[{name:"radius",description:"<p>radius of the whole ring</p>\n",type:"Number",optional:true},{name:"tubeRadius",description:"<p>radius of the tube</p>\n",type:"Number",optional:true},{name:"detailX",description:"<p>number of segments in x-dimension,\n                               the more segments the smoother geometry\n                               default is 24</p>\n",type:"Integer",optional:true},{name:"detailY",description:"<p>number of segments in y-dimension,\n                               the more segments the smoother geometry\n                               default is 16</p>\n",type:"Integer",optional:true}],class:"p5",module:"Shape"},orbitControl:{name:"orbitControl",params:[{name:"sensitivityX",description:"<p>sensitivity to mouse movement along X axis</p>\n",type:"Number",optional:true},{name:"sensitivityY",description:"<p>sensitivity to mouse movement along Y axis</p>\n",type:"Number",optional:true},{name:"sensitivityZ",description:"<p>sensitivity to scroll movement along Z axis</p>\n",type:"Number",optional:true},{name:"options",description:"<p>An optional object that can contain additional settings,\ndisableTouchActions - Boolean, default value is true.\nSetting this to true makes mobile interactions smoother by preventing\naccidental interactions with the page while orbiting. But if you're already\ndoing it via css or want the default touch actions, consider setting it to false.\nfreeRotation - Boolean, default value is false.\nBy default, horizontal movement of the mouse or touch pointer rotates the camera\naround the y-axis, and vertical movement rotates the camera around the x-axis.\nBut if setting this option to true, the camera always rotates in the direction\nthe pointer is moving. For zoom and move, the behavior is the same regardless of\ntrue/false.</p>\n",type:"Object",optional:true}],class:"p5",module:"3D"},debugMode:{name:"debugMode",class:"p5",module:"3D",overloads:[{params:[]},{params:[{name:"mode",description:"<p>either GRID or AXES</p>\n",type:"Constant"}]},{params:[{name:"mode",description:"",type:"Constant"},{name:"gridSize",description:"<p>size of one side of the grid</p>\n",type:"Number",optional:true},{name:"gridDivisions",description:"<p>number of divisions in the grid</p>\n",type:"Number",optional:true},{name:"xOff",description:"<p>X axis offset from origin (0,0,0)</p>\n",type:"Number",optional:true},{name:"yOff",description:"<p>Y axis offset from origin (0,0,0)</p>\n",type:"Number",optional:true},{name:"zOff",description:"<p>Z axis offset from origin (0,0,0)</p>\n",type:"Number",optional:true}]},{params:[{name:"mode",description:"",type:"Constant"},{name:"axesSize",description:"<p>size of axes icon</p>\n",type:"Number",optional:true},{name:"xOff",description:"",type:"Number",optional:true},{name:"yOff",description:"",type:"Number",optional:true},{name:"zOff",description:"",type:"Number",optional:true}]},{params:[{name:"gridSize",description:"",type:"Number",optional:true},{name:"gridDivisions",description:"",type:"Number",optional:true},{name:"gridXOff",description:"",type:"Number",optional:true},{name:"gridYOff",description:"",type:"Number",optional:true},{name:"gridZOff",description:"",type:"Number",optional:true},{name:"axesSize",description:"",type:"Number",optional:true},{name:"axesXOff",description:"",type:"Number",optional:true},{name:"axesYOff",description:"",type:"Number",optional:true},{name:"axesZOff",description:"",type:"Number",optional:true}]}]},noDebugMode:{name:"noDebugMode",class:"p5",module:"3D"},ambientLight:{name:"ambientLight",class:"p5",module:"3D",overloads:[{params:[{name:"v1",description:"<p>red or hue value relative to\n                                  the current color range</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value\n                                  relative to the current color range</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness value\n                                  relative to the current color range</p>\n",type:"Number"},{name:"alpha",description:"<p>alpha value relative to current\n                                  color range (default is 0-255)</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"gray",description:"<p>number specifying value between\n                                 white and black</p>\n",type:"Number"},{name:"alpha",description:"",type:"Number",optional:true}],chainable:1},{params:[{name:"value",description:"<p>a color string</p>\n",type:"String"}],chainable:1},{params:[{name:"values",description:"<p>an array containing the red,green,blue &\n                                 and alpha components of the color</p>\n",type:"Number[]"}],chainable:1},{params:[{name:"color",description:'<p>color as a <a href="#/p5.Color">p5.Color</a></p>\n',type:"p5.Color"}],chainable:1}]},specularColor:{name:"specularColor",class:"p5",module:"3D",overloads:[{params:[{name:"v1",description:"<p>red or hue value relative to\n                                 the current color range</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value\n                                 relative to the current color range</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness value\n                                 relative to the current color range</p>\n",type:"Number"}],chainable:1},{params:[{name:"gray",description:"<p>number specifying value between\n                                 white and black</p>\n",type:"Number"}],chainable:1},{params:[{name:"value",description:"<p>color as a CSS string</p>\n",type:"String"}],chainable:1},{params:[{name:"values",description:"<p>color as an array containing the\n                                 red, green, and blue components</p>\n",type:"Number[]"}],chainable:1},{params:[{name:"color",description:'<p>color as a <a href="#/p5.Color">p5.Color</a></p>\n',type:"p5.Color"}],chainable:1}]},directionalLight:{name:"directionalLight",class:"p5",module:"3D",overloads:[{params:[{name:"v1",description:"<p>red or hue value relative to the current\n                                color range</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value relative to the\n                                current color range</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness value relative to the\n                                current color range</p>\n",type:"Number"},{name:"x",description:"<p>x component of direction (inclusive range of -1 to 1)</p>\n",type:"Number"},{name:"y",description:"<p>y component of direction (inclusive range of -1 to 1)</p>\n",type:"Number"},{name:"z",description:"<p>z component of direction (inclusive range of -1 to 1)</p>\n",type:"Number"}],chainable:1},{params:[{name:"v1",description:"",type:"Number"},{name:"v2",description:"",type:"Number"},{name:"v3",description:"",type:"Number"},{name:"direction",description:'<p>direction of light as a\n                                <a href="#/p5.Vector">p5.Vector</a></p>\n',type:"p5.Vector"}],chainable:1},{params:[{name:"color",description:'<p>color as a <a href="#/p5.Color">p5.Color</a>,\n                                           as an array, or as a CSS string</p>\n',type:"p5.Color|Number[]|String"},{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"",type:"Number"}],chainable:1},{params:[{name:"color",description:"",type:"p5.Color|Number[]|String"},{name:"direction",description:"",type:"p5.Vector"}],chainable:1}]},pointLight:{name:"pointLight",class:"p5",module:"3D",overloads:[{params:[{name:"v1",description:"<p>red or hue value relative to the current\n                         color range</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value relative to the\n                         current color range</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness value relative to the\n                         current color range</p>\n",type:"Number"},{name:"x",description:"<p>x component of position</p>\n",type:"Number"},{name:"y",description:"<p>y component of position</p>\n",type:"Number"},{name:"z",description:"<p>z component of position</p>\n",type:"Number"}],chainable:1},{params:[{name:"v1",description:"",type:"Number"},{name:"v2",description:"",type:"Number"},{name:"v3",description:"",type:"Number"},{name:"position",description:'<p>of light as a <a href="#/p5.Vector">p5.Vector</a></p>\n',type:"p5.Vector"}],chainable:1},{params:[{name:"color",description:'<p>color as a <a href="#/p5.Color">p5.Color</a>,\n                                           as an array, or as a CSS string</p>\n',type:"p5.Color|Number[]|String"},{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"",type:"Number"}],chainable:1},{params:[{name:"color",description:"",type:"p5.Color|Number[]|String"},{name:"position",description:"",type:"p5.Vector"}],chainable:1}]},imageLight:{name:"imageLight",params:[{name:"img",description:"<p>image for the background</p>\n",type:"p5.image"}],class:"p5",module:"3D"},lights:{name:"lights",class:"p5",module:"3D"},lightFalloff:{name:"lightFalloff",params:[{name:"constant",description:"<p>CONSTANT value for determining falloff</p>\n",type:"Number"},{name:"linear",description:"<p>LINEAR value for determining falloff</p>\n",type:"Number"},{name:"quadratic",description:"<p>QUADRATIC value for determining falloff</p>\n",type:"Number"}],class:"p5",module:"3D"},spotLight:{name:"spotLight",class:"p5",module:"3D",overloads:[{params:[{name:"v1",description:"<p>red or hue value relative to the current color range</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value relative to the current color range</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness value relative to the current color range</p>\n",type:"Number"},{name:"x",description:"<p>x component of position</p>\n",type:"Number"},{name:"y",description:"<p>y component of position</p>\n",type:"Number"},{name:"z",description:"<p>z component of position</p>\n",type:"Number"},{name:"rx",description:"<p>x component of light direction (inclusive range of -1 to 1)</p>\n",type:"Number"},{name:"ry",description:"<p>y component of light direction (inclusive range of -1 to 1)</p>\n",type:"Number"},{name:"rz",description:"<p>z component of light direction (inclusive range of -1 to 1)</p>\n",type:"Number"},{name:"angle",description:"<p>angle of cone. Defaults to PI/3</p>\n",type:"Number",optional:true},{name:"concentration",description:"<p>concentration of cone. Defaults to 100</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"color",description:'<p>color as a <a href="#/p5.Color">p5.Color</a>,\n                                                    as an array, or as a CSS string</p>\n',type:"p5.Color|Number[]|String"},{name:"position",description:'<p>position of light as a <a href="#/p5.Vector">p5.Vector</a></p>\n',type:"p5.Vector"},{name:"direction",description:'<p>direction of light as a <a href="#/p5.Vector">p5.Vector</a></p>\n',type:"p5.Vector"},{name:"angle",description:"",type:"Number",optional:true},{name:"concentration",description:"",type:"Number",optional:true}]},{params:[{name:"v1",description:"",type:"Number"},{name:"v2",description:"",type:"Number"},{name:"v3",description:"",type:"Number"},{name:"position",description:"",type:"p5.Vector"},{name:"direction",description:"",type:"p5.Vector"},{name:"angle",description:"",type:"Number",optional:true},{name:"concentration",description:"",type:"Number",optional:true}]},{params:[{name:"color",description:"",type:"p5.Color|Number[]|String"},{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"",type:"Number"},{name:"direction",description:"",type:"p5.Vector"},{name:"angle",description:"",type:"Number",optional:true},{name:"concentration",description:"",type:"Number",optional:true}]},{params:[{name:"color",description:"",type:"p5.Color|Number[]|String"},{name:"position",description:"",type:"p5.Vector"},{name:"rx",description:"",type:"Number"},{name:"ry",description:"",type:"Number"},{name:"rz",description:"",type:"Number"},{name:"angle",description:"",type:"Number",optional:true},{name:"concentration",description:"",type:"Number",optional:true}]},{params:[{name:"v1",description:"",type:"Number"},{name:"v2",description:"",type:"Number"},{name:"v3",description:"",type:"Number"},{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"",type:"Number"},{name:"direction",description:"",type:"p5.Vector"},{name:"angle",description:"",type:"Number",optional:true},{name:"concentration",description:"",type:"Number",optional:true}]},{params:[{name:"v1",description:"",type:"Number"},{name:"v2",description:"",type:"Number"},{name:"v3",description:"",type:"Number"},{name:"position",description:"",type:"p5.Vector"},{name:"rx",description:"",type:"Number"},{name:"ry",description:"",type:"Number"},{name:"rz",description:"",type:"Number"},{name:"angle",description:"",type:"Number",optional:true},{name:"concentration",description:"",type:"Number",optional:true}]},{params:[{name:"color",description:"",type:"p5.Color|Number[]|String"},{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"",type:"Number"},{name:"rx",description:"",type:"Number"},{name:"ry",description:"",type:"Number"},{name:"rz",description:"",type:"Number"},{name:"angle",description:"",type:"Number",optional:true},{name:"concentration",description:"",type:"Number",optional:true}]}]},noLights:{name:"noLights",class:"p5",module:"3D"},loadModel:{name:"loadModel",class:"p5",module:"Shape",overloads:[{params:[{name:"path",description:"<p>Path of the model to be loaded</p>\n",type:"String"},{name:"normalize",description:"<p>If true, scale the model to a\n                                     standardized size when loading</p>\n",type:"Boolean"},{name:"successCallback",description:"<p>Function to be called\n                                    once the model is loaded. Will be passed\n                                    the 3D model object.</p>\n",type:"function(p5.Geometry)",optional:true},{name:"failureCallback",description:"<p>called with event error if\n                                        the model fails to load.</p>\n",type:"Function(Event)",optional:true},{name:"fileType",description:"<p>The file extension of the model\n                                     (<code>.stl</code>, <code>.obj</code>).</p>\n",type:"String",optional:true}]},{params:[{name:"path",description:"",type:"String"},{name:"successCallback",description:"",type:"function(p5.Geometry)",optional:true},{name:"failureCallback",description:"",type:"Function(Event)",optional:true},{name:"fileType",description:"",type:"String",optional:true}]}]},model:{name:"model",params:[{name:"model",description:"<p>Loaded 3d model to be rendered</p>\n",type:"p5.Geometry"}],class:"p5",module:"Shape"},loadShader:{name:"loadShader",params:[{name:"vertFilename",description:"<p>path to file containing vertex shader\nsource code</p>\n",type:"String"},{name:"fragFilename",description:"<p>path to file containing fragment shader\nsource code</p>\n",type:"String"},{name:"callback",description:"<p>callback to be executed after loadShader\ncompletes. On success, the p5.Shader object is passed as the first argument.</p>\n",type:"Function",optional:true},{name:"errorCallback",description:"<p>callback to be executed when an error\noccurs inside loadShader. On error, the error is passed as the first\nargument.</p>\n",type:"Function",optional:true}],class:"p5",module:"3D"},createShader:{name:"createShader",params:[{name:"vertSrc",description:"<p>source code for the vertex shader</p>\n",type:"String"},{name:"fragSrc",description:"<p>source code for the fragment shader</p>\n",type:"String"}],class:"p5",module:"3D"},createFilterShader:{name:"createFilterShader",params:[{name:"fragSrc",description:"<p>source code for the fragment shader</p>\n",type:"String"}],class:"p5",module:"3D"},shader:{name:"shader",params:[{name:"s",description:'<p>the <a href="#/p5.Shader">p5.Shader</a> object\nto use for rendering shapes.</p>\n',type:"p5.Shader"}],class:"p5",module:"3D"},resetShader:{name:"resetShader",class:"p5",module:"3D"},texture:{name:"texture",params:[{name:"tex",description:"<p>image to use as texture</p>\n",type:"p5.Image|p5.MediaElement|p5.Graphics|p5.Texture|p5.Framebuffer|p5.FramebufferTexture"}],class:"p5",module:"3D"},textureMode:{name:"textureMode",params:[{name:"mode",description:"<p>either IMAGE or NORMAL</p>\n",type:"Constant"}],class:"p5",module:"3D"},textureWrap:{name:"textureWrap",params:[{name:"wrapX",description:"<p>either CLAMP, REPEAT, or MIRROR</p>\n",type:"Constant"},{name:"wrapY",description:"<p>either CLAMP, REPEAT, or MIRROR</p>\n",type:"Constant",optional:true}],class:"p5",module:"3D"},normalMaterial:{name:"normalMaterial",class:"p5",module:"3D"},ambientMaterial:{name:"ambientMaterial",class:"p5",module:"3D",overloads:[{params:[{name:"v1",description:"<p>red or hue value relative to the current\n                      color range</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value relative to the\n                      current color range</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness value relative to the\n                      current color range</p>\n",type:"Number"}],chainable:1},{params:[{name:"gray",description:"<p>number specifying value between\n                        white and black</p>\n",type:"Number"}],chainable:1},{params:[{name:"color",description:'<p>color as a <a href="#/p5.Color">p5.Color</a>,\n           as an array, or as a CSS string</p>\n',type:"p5.Color|Number[]|String"}],chainable:1}]},emissiveMaterial:{name:"emissiveMaterial",class:"p5",module:"3D",overloads:[{params:[{name:"v1",description:"<p>red or hue value relative to the current\n                           color range</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value relative to the\n                           current color range</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness value relative to the\n                           current color range</p>\n",type:"Number"},{name:"alpha",description:"<p>alpha value relative to current color\n                           range (default is 0-255)</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"gray",description:"<p>number specifying value between\n                        white and black</p>\n",type:"Number"}],chainable:1},{params:[{name:"color",description:'<p>color as a <a href="#/p5.Color">p5.Color</a>,\n           as an array, or as a CSS string</p>\n',type:"p5.Color|Number[]|String"}],chainable:1}]},specularMaterial:{name:"specularMaterial",class:"p5",module:"3D",overloads:[{params:[{name:"gray",description:"<p>number specifying value between white and black.</p>\n",type:"Number"},{name:"alpha",description:"<p>alpha value relative to current color range\n                                (default is 0-255)</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"v1",description:"<p>red or hue value relative to\n                                the current color range</p>\n",type:"Number"},{name:"v2",description:"<p>green or saturation value\n                                relative to the current color range</p>\n",type:"Number"},{name:"v3",description:"<p>blue or brightness value\n                                relative to the current color range</p>\n",type:"Number"},{name:"alpha",description:"",type:"Number",optional:true}],chainable:1},{params:[{name:"color",description:'<p>color as a <a href="#/p5.Color">p5.Color</a>,\n           as an array, or as a CSS string</p>\n',type:"p5.Color|Number[]|String"}],chainable:1}]},shininess:{name:"shininess",params:[{name:"shine",description:"<p>degree of shininess</p>\n",type:"Number"}],class:"p5",module:"3D"},camera:{name:"camera",params:[{name:"x",description:"<p>camera position value on x axis</p>\n",type:"Number",optional:true},{name:"y",description:"<p>camera position value on y axis</p>\n",type:"Number",optional:true},{name:"z",description:"<p>camera position value on z axis</p>\n",type:"Number",optional:true},{name:"centerX",description:"<p>x coordinate representing center of the sketch</p>\n",type:"Number",optional:true},{name:"centerY",description:"<p>y coordinate representing center of the sketch</p>\n",type:"Number",optional:true},{name:"centerZ",description:"<p>z coordinate representing center of the sketch</p>\n",type:"Number",optional:true},{name:"upX",description:"<p>x component of direction 'up' from camera</p>\n",type:"Number",optional:true},{name:"upY",description:"<p>y component of direction 'up' from camera</p>\n",type:"Number",optional:true},{name:"upZ",description:"<p>z component of direction 'up' from camera</p>\n",type:"Number",optional:true}],class:"p5",module:"3D"},perspective:{name:"perspective",params:[{name:"fovy",description:'<p>camera frustum vertical field of view,\n                          from bottom to top of view, in <a href="#/p5/angleMode">angleMode</a> units</p>\n',type:"Number",optional:true},{name:"aspect",description:"<p>camera frustum aspect ratio</p>\n",type:"Number",optional:true},{name:"near",description:"<p>frustum near plane length</p>\n",type:"Number",optional:true},{name:"far",description:"<p>frustum far plane length</p>\n",type:"Number",optional:true}],class:"p5",module:"3D"},ortho:{name:"ortho",params:[{name:"left",description:"<p>camera frustum left plane</p>\n",type:"Number",optional:true},{name:"right",description:"<p>camera frustum right plane</p>\n",type:"Number",optional:true},{name:"bottom",description:"<p>camera frustum bottom plane</p>\n",type:"Number",optional:true},{name:"top",description:"<p>camera frustum top plane</p>\n",type:"Number",optional:true},{name:"near",description:"<p>camera frustum near plane</p>\n",type:"Number",optional:true},{name:"far",description:"<p>camera frustum far plane</p>\n",type:"Number",optional:true}],class:"p5",module:"3D"},frustum:{name:"frustum",params:[{name:"left",description:"<p>camera frustum left plane</p>\n",type:"Number",optional:true},{name:"right",description:"<p>camera frustum right plane</p>\n",type:"Number",optional:true},{name:"bottom",description:"<p>camera frustum bottom plane</p>\n",type:"Number",optional:true},{name:"top",description:"<p>camera frustum top plane</p>\n",type:"Number",optional:true},{name:"near",description:"<p>camera frustum near plane</p>\n",type:"Number",optional:true},{name:"far",description:"<p>camera frustum far plane</p>\n",type:"Number",optional:true}],class:"p5",module:"3D"},createCamera:{name:"createCamera",class:"p5",module:"3D"},setCamera:{name:"setCamera",params:[{name:"cam",description:"<p>p5.Camera object</p>\n",type:"p5.Camera"}],class:"p5",module:"3D"},vertexNormal:{name:"vertexNormal",params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"",type:"Number"},{name:"v",description:"",type:"Vector"}],class:"p5",module:"Shape"},setAttributes:{name:"setAttributes",class:"p5",module:"Rendering",overloads:[{params:[{name:"key",description:"<p>Name of attribute</p>\n",type:"String"},{name:"value",description:"<p>New value of named attribute</p>\n",type:"Boolean"}]},{params:[{name:"obj",description:"<p>object with key-value pairs</p>\n",type:"Object"}]}]},getAudioContext:{name:"getAudioContext",class:"p5",module:"p5.sound"},userStartAudio:{params:[{name:"elements",description:"<p>This argument can be an Element,\n                              Selector String, NodeList, p5.Element,\n                              jQuery Element, or an Array of any of those.</p>\n",type:"Element|Array",optional:true},{name:"callback",description:"<p>Callback to invoke when the AudioContext\n                              has started</p>\n",type:"Function",optional:true}],name:"userStartAudio",class:"p5",module:"p5.sound"},getOutputVolume:{name:"getOutputVolume",class:"p5",module:"p5.sound"},outputVolume:{name:"outputVolume",params:[{name:"volume",description:"<p>Volume (amplitude) between 0.0\n                                   and 1.0 or modulating signal/oscillator</p>\n",type:"Number|Object"},{name:"rampTime",description:"<p>Fade for t seconds</p>\n",type:"Number",optional:true},{name:"timeFromNow",description:"<p>Schedule this event to happen at\n                               t seconds in the future</p>\n",type:"Number",optional:true}],class:"p5",module:"p5.sound"},soundOut:{name:"soundOut",class:"p5",module:"p5.sound"},sampleRate:{name:"sampleRate",class:"p5",module:"p5.sound"},freqToMidi:{name:"freqToMidi",params:[{name:"frequency",description:'<p>A freqeuncy, for example, the "A"\n                           above Middle C is 440Hz</p>\n',type:"Number"}],class:"p5",module:"p5.sound"},midiToFreq:{name:"midiToFreq",params:[{name:"midiNote",description:"<p>The number of a MIDI note</p>\n",type:"Number"}],class:"p5",module:"p5.sound"},soundFormats:{name:"soundFormats",params:[{name:"formats",description:"<p>i.e. 'mp3', 'wav', 'ogg'</p>\n",type:"String",optional:true,multiple:true}],class:"p5",module:"p5.sound"},saveSound:{name:"saveSound",params:[{name:"soundFile",description:"<p>p5.SoundFile that you wish to save</p>\n",type:"p5.SoundFile"},{name:"fileName",description:"<p>name of the resulting .wav file.</p>\n",type:"String"}],class:"p5",module:"p5.sound"},loadSound:{name:"loadSound",params:[{name:"path",description:"<p>Path to the sound file, or an array with\n                                  paths to soundfiles in multiple formats\n                                  i.e. ['sound.ogg', 'sound.mp3'].\n                                  Alternately, accepts an object: either\n                                  from the HTML5 File API, or a p5.File.</p>\n",type:"String|Array"},{name:"successCallback",description:"<p>Name of a function to call once file loads</p>\n",type:"Function",optional:true},{name:"errorCallback",description:"<p>Name of a function to call if there is\n                                    an error loading the file.</p>\n",type:"Function",optional:true},{name:"whileLoading",description:"<p>Name of a function to call while file is loading.\n                               This function will receive the percentage loaded\n                               so far, from 0.0 to 1.0.</p>\n",type:"Function",optional:true}],class:"p5",module:"p5.sound"},createConvolver:{name:"createConvolver",params:[{name:"path",description:"<p>path to a sound file</p>\n",type:"String"},{name:"callback",description:"<p>function to call if loading is successful.\n                              The object will be passed in as the argument\n                              to the callback function.</p>\n",type:"Function",optional:true},{name:"errorCallback",description:"<p>function to call if loading is not successful.\n                              A custom error will be passed in as the argument\n                              to the callback function.</p>\n",type:"Function",optional:true}],class:"p5",module:"p5.sound"},setBPM:{name:"setBPM",params:[{name:"BPM",description:"<p>Beats Per Minute</p>\n",type:"Number"},{name:"rampTime",description:"<p>Seconds from now</p>\n",type:"Number"}],class:"p5",module:"p5.sound"}},"p5.Color":{toString:{name:"toString",params:[{name:"format",description:"<p>how the color string will be formatted.\nLeaving this empty formats the string as rgba(r, g, b, a).\n'#rgb' '#rgba' '#rrggbb' and '#rrggbbaa' format as hexadecimal color codes.\n'rgb' 'hsb' and 'hsl' return the color formatted in the specified color mode.\n'rgba' 'hsba' and 'hsla' are the same as above but with alpha channels.\n'rgb%' 'hsb%' 'hsl%' 'rgba%' 'hsba%' and 'hsla%' format as percentages.</p>\n",type:"String",optional:true}],class:"p5.Color",module:"Color"},setRed:{name:"setRed",params:[{name:"red",description:"<p>the new red value.</p>\n",type:"Number"}],class:"p5.Color",module:"Color"},setGreen:{name:"setGreen",params:[{name:"green",description:"<p>the new green value.</p>\n",type:"Number"}],class:"p5.Color",module:"Color"},setBlue:{name:"setBlue",params:[{name:"blue",description:"<p>the new blue value.</p>\n",type:"Number"}],class:"p5.Color",module:"Color"},setAlpha:{name:"setAlpha",params:[{name:"alpha",description:"<p>the new alpha value.</p>\n",type:"Number"}],class:"p5.Color",module:"Color"}},"p5.Element":{elt:{name:"elt",class:"p5.Element",module:"DOM"},width:{name:"width",class:"p5.Element",module:"DOM"},height:{name:"height",class:"p5.Element",module:"DOM"},parent:{name:"parent",class:"p5.Element",module:"DOM",overloads:[{params:[{name:"parent",description:'<p>ID, <a href="#/p5.Element">p5.Element</a>,\n                                          or HTMLElement of desired parent element.</p>\n',type:"String|p5.Element|Object"}],chainable:1},{params:[]}]},id:{name:"id",class:"p5.Element",module:"DOM",overloads:[{params:[{name:"id",description:"<p>ID of the element.</p>\n",type:"String"}],chainable:1},{params:[]}]},class:{name:"class",class:"p5.Element",module:"DOM",overloads:[{params:[{name:"class",description:"<p>class to add.</p>\n",type:"String"}],chainable:1},{params:[]}]},mousePressed:{name:"mousePressed",params:[{name:"fxn",description:"<p>function to call when the mouse is\n                               pressed over the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},doubleClicked:{name:"doubleClicked",params:[{name:"fxn",description:"<p>function to call when the mouse is\n                               double clicked over the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},mouseWheel:{name:"mouseWheel",params:[{name:"fxn",description:"<p>function to call when the mouse wheel is\n                               scrolled over the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},mouseReleased:{name:"mouseReleased",params:[{name:"fxn",description:"<p>function to call when the mouse is\n                               pressed over the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},mouseClicked:{name:"mouseClicked",params:[{name:"fxn",description:"<p>function to call when the mouse is\n                               pressed and released over the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},mouseMoved:{name:"mouseMoved",params:[{name:"fxn",description:"<p>function to call when the mouse\n                               moves over the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},mouseOver:{name:"mouseOver",params:[{name:"fxn",description:"<p>function to call when the mouse\n                               moves onto the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},mouseOut:{name:"mouseOut",params:[{name:"fxn",description:"<p>function to call when the mouse\n                               moves off the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},touchStarted:{name:"touchStarted",params:[{name:"fxn",description:"<p>function to call when the touch\n                               starts.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},touchMoved:{name:"touchMoved",params:[{name:"fxn",description:"<p>function to call when the touch\n                               moves over the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},touchEnded:{name:"touchEnded",params:[{name:"fxn",description:"<p>function to call when the touch\n                               ends.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},dragOver:{name:"dragOver",params:[{name:"fxn",description:"<p>function to call when the file is\n                               dragged over the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},dragLeave:{name:"dragLeave",params:[{name:"fxn",description:"<p>function to call when the file is\n                               dragged off the element.\n                               <code>false</code> disables the function.</p>\n",type:"Function|Boolean"}],class:"p5.Element",module:"DOM"},addClass:{name:"addClass",params:[{name:"class",description:"<p>name of class to add</p>\n",type:"String"}],class:"p5.Element",module:"DOM"},removeClass:{name:"removeClass",params:[{name:"class",description:"<p>name of class to remove</p>\n",type:"String"}],class:"p5.Element",module:"DOM"},hasClass:{name:"hasClass",params:[{name:"c",description:"<p>class name of class to check</p>\n",type:"String"}],class:"p5.Element",module:"DOM"},toggleClass:{name:"toggleClass",params:[{name:"c",description:"<p>class name to toggle</p>\n",type:"String"}],class:"p5.Element",module:"DOM"},child:{name:"child",class:"p5.Element",module:"DOM",overloads:[{params:[]},{params:[{name:"child",description:'<p>the ID, DOM node, or <a href="#/p5.Element">p5.Element</a>\n                        to add to the current element</p>\n',type:"String|p5.Element",optional:true}],chainable:1}]},center:{name:"center",params:[{name:"align",description:"<p>passing 'vertical', 'horizontal' aligns element accordingly</p>\n",type:"String",optional:true}],class:"p5.Element",module:"DOM"},html:{name:"html",class:"p5.Element",module:"DOM",overloads:[{params:[]},{params:[{name:"html",description:"<p>the HTML to be placed inside the element</p>\n",type:"String",optional:true},{name:"append",description:"<p>whether to append HTML to existing</p>\n",type:"Boolean",optional:true}],chainable:1}]},position:{name:"position",class:"p5.Element",module:"DOM",overloads:[{params:[]},{params:[{name:"x",description:"<p>x-position relative to upper left of window (optional)</p>\n",type:"Number",optional:true},{name:"y",description:"<p>y-position relative to upper left of window (optional)</p>\n",type:"Number",optional:true},{name:"positionType",description:"<p>it can be static, fixed, relative, sticky, initial or inherit (optional)</p>\n",type:"String",optional:true}],chainable:1}]},style:{name:"style",class:"p5.Element",module:"DOM",overloads:[{params:[{name:"property",description:"<p>style property to set.</p>\n",type:"String"}]},{params:[{name:"property",description:"",type:"String"},{name:"value",description:"<p>value to assign to the property.</p>\n",type:"String|p5.Color"}],chainable:1}]},attribute:{name:"attribute",class:"p5.Element",module:"DOM",overloads:[{params:[]},{params:[{name:"attr",description:"<p>attribute to set.</p>\n",type:"String"},{name:"value",description:"<p>value to assign to the attribute.</p>\n",type:"String"}],chainable:1}]},removeAttribute:{name:"removeAttribute",params:[{name:"attr",description:"<p>attribute to remove.</p>\n",type:"String"}],class:"p5.Element",module:"DOM"},value:{name:"value",class:"p5.Element",module:"DOM",overloads:[{params:[]},{params:[{name:"value",description:"",type:"String|Number"}],chainable:1}]},show:{name:"show",class:"p5.Element",module:"DOM"},hide:{name:"hide",class:"p5.Element",module:"DOM"},size:{name:"size",class:"p5.Element",module:"DOM",overloads:[{params:[]},{params:[{name:"w",description:"<p>width of the element, either AUTO, or a number.</p>\n",type:"Number|Constant"},{name:"h",description:"<p>height of the element, either AUTO, or a number.</p>\n",type:"Number|Constant",optional:true}],chainable:1}]},remove:{name:"remove",class:"p5.Element",module:"DOM"},drop:{name:"drop",params:[{name:"callback",description:"<p>called when a file loads. Called once for each file dropped.</p>\n",type:"Function"},{name:"fxn",description:"<p>called once when any files are dropped.</p>\n",type:"Function",optional:true}],class:"p5.Element",module:"DOM"},draggable:{name:"draggable",params:[{name:"elmnt",description:"<p>pass another p5.Element</p>\n",type:"p5.Element",optional:true}],class:"p5.Element",module:"DOM"}},"p5.Graphics":{reset:{name:"reset",class:"p5.Graphics",module:"Rendering"},remove:{name:"remove",class:"p5.Graphics",module:"Rendering"},createFramebuffer:{name:"createFramebuffer",class:"p5.Graphics",module:"Rendering"}},JSON:{stringify:{name:"stringify",params:[{name:"object",description:"<p>:Javascript object that you would like to convert to JSON</p>\n",type:"Object"}],class:"JSON",module:"Foundation"}},console:{log:{name:"log",params:[{name:"message",description:"<p>:Message that you would like to print to the console</p>\n",type:"String|Expression|Object"}],class:"console",module:"Foundation"}},"p5.TypedDict":{size:{name:"size",class:"p5.TypedDict",module:"Data"},hasKey:{name:"hasKey",params:[{name:"key",description:"<p>that you want to look up</p>\n",type:"Number|String"}],class:"p5.TypedDict",module:"Data"},get:{name:"get",params:[{name:"the",description:"<p>key you want to access</p>\n",type:"Number|String"}],class:"p5.TypedDict",module:"Data"},set:{name:"set",params:[{name:"key",description:"",type:"Number|String"},{name:"value",description:"",type:"Number|String"}],class:"p5.TypedDict",module:"Data"},create:{name:"create",class:"p5.TypedDict",module:"Data",overloads:[{params:[{name:"key",description:"",type:"Number|String"},{name:"value",description:"",type:"Number|String"}]},{params:[{name:"obj",description:"<p>key/value pair</p>\n",type:"Object"}]}]},clear:{name:"clear",class:"p5.TypedDict",module:"Data"},remove:{name:"remove",params:[{name:"key",description:"<p>for the pair to remove</p>\n",type:"Number|String"}],class:"p5.TypedDict",module:"Data"},print:{name:"print",class:"p5.TypedDict",module:"Data"},saveTable:{name:"saveTable",class:"p5.TypedDict",module:"Data"},saveJSON:{name:"saveJSON",class:"p5.TypedDict",module:"Data"}},"p5.NumberDict":{add:{name:"add",params:[{name:"Key",description:"<p>for the value you wish to add to</p>\n",type:"Number"},{name:"Number",description:"<p>to add to the value</p>\n",type:"Number"}],class:"p5.NumberDict",module:"Data"},sub:{name:"sub",params:[{name:"Key",description:"<p>for the value you wish to subtract from</p>\n",type:"Number"},{name:"Number",description:"<p>to subtract from the value</p>\n",type:"Number"}],class:"p5.NumberDict",module:"Data"},mult:{name:"mult",params:[{name:"Key",description:"<p>for value you wish to multiply</p>\n",type:"Number"},{name:"Amount",description:"<p>to multiply the value by</p>\n",type:"Number"}],class:"p5.NumberDict",module:"Data"},div:{name:"div",params:[{name:"Key",description:"<p>for value you wish to divide</p>\n",type:"Number"},{name:"Amount",description:"<p>to divide the value by</p>\n",type:"Number"}],class:"p5.NumberDict",module:"Data"},minValue:{name:"minValue",class:"p5.NumberDict",module:"Data"},maxValue:{name:"maxValue",class:"p5.NumberDict",module:"Data"},minKey:{name:"minKey",class:"p5.NumberDict",module:"Data"},maxKey:{name:"maxKey",class:"p5.NumberDict",module:"Data"}},"p5.MediaElement":{src:{name:"src",class:"p5.MediaElement",module:"DOM"},play:{name:"play",class:"p5.MediaElement",module:"DOM"},stop:{name:"stop",class:"p5.MediaElement",module:"DOM"},pause:{name:"pause",class:"p5.MediaElement",module:"DOM"},loop:{name:"loop",class:"p5.MediaElement",module:"DOM"},noLoop:{name:"noLoop",class:"p5.MediaElement",module:"DOM"},autoplay:{name:"autoplay",params:[{name:"shouldAutoplay",description:"<p>whether the element should autoplay.</p>\n",type:"Boolean",optional:true}],class:"p5.MediaElement",module:"DOM"},volume:{name:"volume",class:"p5.MediaElement",module:"DOM",overloads:[{params:[]},{params:[{name:"val",description:"<p>volume between 0.0 and 1.0.</p>\n",type:"Number"}],chainable:1}]},speed:{name:"speed",class:"p5.MediaElement",module:"DOM",overloads:[{params:[]},{params:[{name:"speed",description:"<p>speed multiplier for playback.</p>\n",type:"Number"}],chainable:1}]},time:{name:"time",class:"p5.MediaElement",module:"DOM",overloads:[{params:[]},{params:[{name:"time",description:"<p>time to jump to (in seconds).</p>\n",type:"Number"}],chainable:1}]},duration:{name:"duration",class:"p5.MediaElement",module:"DOM"},onended:{name:"onended",params:[{name:"callback",description:"<p>function to call when playback ends.\n                            The <code>p5.MediaElement</code> is passed as\n                            the argument.</p>\n",type:"Function"}],class:"p5.MediaElement",module:"DOM"},connect:{name:"connect",params:[{name:"audioNode",description:"<p>AudioNode from the Web Audio API,\nor an object from the p5.sound library</p>\n",type:"AudioNode|Object"}],class:"p5.MediaElement",module:"DOM"},disconnect:{name:"disconnect",class:"p5.MediaElement",module:"DOM"},showControls:{name:"showControls",class:"p5.MediaElement",module:"DOM"},hideControls:{name:"hideControls",class:"p5.MediaElement",module:"DOM"},addCue:{name:"addCue",params:[{name:"time",description:"<p>cue time to run the callback function.</p>\n",type:"Number"},{name:"callback",description:"<p>function to call at the cue time.</p>\n",type:"Function"},{name:"value",description:"<p>object to pass as the argument to\n                           <code>callback</code>.</p>\n",type:"Object",optional:true}],class:"p5.MediaElement",module:"DOM"},removeCue:{name:"removeCue",params:[{name:"id",description:"<p>ID of the cue, created by <code>media.addCue()</code>.</p>\n",type:"Number"}],class:"p5.MediaElement",module:"DOM"},clearCues:{name:"clearCues",class:"p5.MediaElement",module:"DOM"}},"p5.File":{file:{name:"file",class:"p5.File",module:"DOM"},type:{name:"type",class:"p5.File",module:"DOM"},subtype:{name:"subtype",class:"p5.File",module:"DOM"},name:{name:"name",class:"p5.File",module:"DOM"},size:{name:"size",class:"p5.File",module:"DOM"},data:{name:"data",class:"p5.File",module:"DOM"}},"p5.Image":{width:{name:"width",class:"p5.Image",module:"Image"},height:{name:"height",class:"p5.Image",module:"Image"},pixels:{name:"pixels",class:"p5.Image",module:"Image"},pixelDensity:{name:"pixelDensity",params:[{name:"density",description:"<p>A scaling factor for the number of pixels per\nside</p>\n",type:"Number",optional:true}],class:"p5.Image",module:"Image"},loadPixels:{name:"loadPixels",class:"p5.Image",module:"Image"},updatePixels:{name:"updatePixels",class:"p5.Image",module:"Image",overloads:[{params:[{name:"x",description:"<p>x-coordinate of the upper-left corner\n                   of the subsection to update.</p>\n",type:"Integer"},{name:"y",description:"<p>y-coordinate of the upper-left corner\n                   of the subsection to update.</p>\n",type:"Integer"},{name:"w",description:"<p>width of the subsection to update.</p>\n",type:"Integer"},{name:"h",description:"<p>height of the subsection to update.</p>\n",type:"Integer"}]},{params:[]}]},get:{name:"get",class:"p5.Image",module:"Image",overloads:[{params:[{name:"x",description:"<p>x-coordinate of the pixel.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the pixel.</p>\n",type:"Number"},{name:"w",description:"<p>width of the subsection to be returned.</p>\n",type:"Number"},{name:"h",description:"<p>height of the subsection to be returned.</p>\n",type:"Number"}]},{params:[]},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"}]}]},set:{name:"set",params:[{name:"x",description:"<p>x-coordinate of the pixel.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the pixel.</p>\n",type:"Number"},{name:"a",description:'<p>grayscale value | pixel array |\n                                  <a href="#/p5.Color">p5.Color</a> object |\n                                  <a href="#/p5.Image">p5.Image</a> to copy.</p>\n',type:"Number|Number[]|Object"}],class:"p5.Image",module:"Image"},resize:{name:"resize",params:[{name:"width",description:"<p>resized image width.</p>\n",type:"Number"},{name:"height",description:"<p>resized image height.</p>\n",type:"Number"}],class:"p5.Image",module:"Image"},copy:{name:"copy",class:"p5.Image",module:"Image",overloads:[{params:[{name:"srcImage",description:"<p>source image.</p>\n",type:"p5.Image|p5.Element"},{name:"sx",description:"<p>x-coordinate of the source's upper-left corner.</p>\n",type:"Integer"},{name:"sy",description:"<p>y-coordinate of the source's upper-left corner.</p>\n",type:"Integer"},{name:"sw",description:"<p>source image width.</p>\n",type:"Integer"},{name:"sh",description:"<p>source image height.</p>\n",type:"Integer"},{name:"dx",description:"<p>x-coordinate of the destination's upper-left corner.</p>\n",type:"Integer"},{name:"dy",description:"<p>y-coordinate of the destination's upper-left corner.</p>\n",type:"Integer"},{name:"dw",description:"<p>destination image width.</p>\n",type:"Integer"},{name:"dh",description:"<p>destination image height.</p>\n",type:"Integer"}]},{params:[{name:"sx",description:"",type:"Integer"},{name:"sy",description:"",type:"Integer"},{name:"sw",description:"",type:"Integer"},{name:"sh",description:"",type:"Integer"},{name:"dx",description:"",type:"Integer"},{name:"dy",description:"",type:"Integer"},{name:"dw",description:"",type:"Integer"},{name:"dh",description:"",type:"Integer"}]}]},mask:{name:"mask",params:[{name:"srcImage",description:"<p>source image.</p>\n",type:"p5.Image"}],class:"p5.Image",module:"Image"},filter:{name:"filter",params:[{name:"filterType",description:"<p>either THRESHOLD, GRAY, OPAQUE, INVERT,\n                               POSTERIZE, ERODE, DILATE or BLUR.</p>\n",type:"Constant"},{name:"filterParam",description:"<p>parameter unique to each filter.</p>\n",type:"Number",optional:true}],class:"p5.Image",module:"Image"},blend:{name:"blend",class:"p5.Image",module:"Image",overloads:[{params:[{name:"srcImage",description:"<p>source image</p>\n",type:"p5.Image"},{name:"sx",description:"<p>x-coordinate of the source's upper-left corner.</p>\n",type:"Integer"},{name:"sy",description:"<p>y-coordinate of the source's upper-left corner.</p>\n",type:"Integer"},{name:"sw",description:"<p>source image width.</p>\n",type:"Integer"},{name:"sh",description:"<p>source image height.</p>\n",type:"Integer"},{name:"dx",description:"<p>x-coordinate of the destination's upper-left corner.</p>\n",type:"Integer"},{name:"dy",description:"<p>y-coordinate of the destination's upper-left corner.</p>\n",type:"Integer"},{name:"dw",description:"<p>destination image width.</p>\n",type:"Integer"},{name:"dh",description:"<p>destination image height.</p>\n",type:"Integer"},{name:"blendMode",description:'<p>the blend mode. either\n    BLEND, DARKEST, LIGHTEST, DIFFERENCE,\n    MULTIPLY, EXCLUSION, SCREEN, REPLACE, OVERLAY, HARD_LIGHT,\n    SOFT_LIGHT, DODGE, BURN, ADD or NORMAL.</p>\n<p>Available blend modes are: normal | multiply | screen | overlay |\n           darken | lighten | color-dodge | color-burn | hard-light |\n           soft-light | difference | exclusion | hue | saturation |\n           color | luminosity</p>\n<p><a href="http://blogs.adobe.com/webplatform/2013/01/28/blending-features-in-canvas/">http://blogs.adobe.com/webplatform/2013/01/28/blending-features-in-canvas/</a></p>\n',type:"Constant"}]},{params:[{name:"sx",description:"",type:"Integer"},{name:"sy",description:"",type:"Integer"},{name:"sw",description:"",type:"Integer"},{name:"sh",description:"",type:"Integer"},{name:"dx",description:"",type:"Integer"},{name:"dy",description:"",type:"Integer"},{name:"dw",description:"",type:"Integer"},{name:"dh",description:"",type:"Integer"},{name:"blendMode",description:"",type:"Constant"}]}]},save:{name:"save",params:[{name:"filename",description:"<p>filename. Defaults to 'untitled'.</p>\n",type:"String"},{name:"extension",description:"<p>file extension, either 'png' or 'jpg'.\n                           Defaults to 'png'.</p>\n",type:"String",optional:true}],class:"p5.Image",module:"Image"},reset:{name:"reset",class:"p5.Image",module:"Image"},getCurrentFrame:{name:"getCurrentFrame",class:"p5.Image",module:"Image"},setFrame:{name:"setFrame",params:[{name:"index",description:"<p>index of the frame to display.</p>\n",type:"Number"}],class:"p5.Image",module:"Image"},numFrames:{name:"numFrames",class:"p5.Image",module:"Image"},play:{name:"play",class:"p5.Image",module:"Image"},pause:{name:"pause",class:"p5.Image",module:"Image"},delay:{name:"delay",params:[{name:"d",description:"<p>delay in milliseconds between switching frames.</p>\n",type:"Number"},{name:"index",description:"<p>index of the frame that will have its delay modified.</p>\n",type:"Number",optional:true}],class:"p5.Image",module:"Image"}},"p5.PrintWriter":{write:{name:"write",params:[{name:"data",description:"<p>all data to be written by the PrintWriter</p>\n",type:"Array"}],class:"p5.PrintWriter",module:"IO"},print:{name:"print",params:[{name:"data",description:"<p>all data to be printed by the PrintWriter</p>\n",type:"Array"}],class:"p5.PrintWriter",module:"IO"},clear:{name:"clear",class:"p5.PrintWriter",module:"IO"},close:{name:"close",class:"p5.PrintWriter",module:"IO"}},"p5.Table":{columns:{name:"columns",class:"p5.Table",module:"IO"},rows:{name:"rows",class:"p5.Table",module:"IO"},addRow:{name:"addRow",params:[{name:"row",description:"<p>row to be added to the table</p>\n",type:"p5.TableRow",optional:true}],class:"p5.Table",module:"IO"},removeRow:{name:"removeRow",params:[{name:"id",description:"<p>ID number of the row to remove</p>\n",type:"Integer"}],class:"p5.Table",module:"IO"},getRow:{name:"getRow",params:[{name:"rowID",description:"<p>ID number of the row to get</p>\n",type:"Integer"}],class:"p5.Table",module:"IO"},getRows:{name:"getRows",class:"p5.Table",module:"IO"},findRow:{name:"findRow",params:[{name:"value",description:"<p>The value to match</p>\n",type:"String"},{name:"column",description:"<p>ID number or title of the\n                               column to search</p>\n",type:"Integer|String"}],class:"p5.Table",module:"IO"},findRows:{name:"findRows",params:[{name:"value",description:"<p>The value to match</p>\n",type:"String"},{name:"column",description:"<p>ID number or title of the\n                               column to search</p>\n",type:"Integer|String"}],class:"p5.Table",module:"IO"},matchRow:{name:"matchRow",params:[{name:"regexp",description:"<p>The regular expression to match</p>\n",type:"String|RegExp"},{name:"column",description:"<p>The column ID (number) or\n                                 title (string)</p>\n",type:"String|Integer"}],class:"p5.Table",module:"IO"},matchRows:{name:"matchRows",params:[{name:"regexp",description:"<p>The regular expression to match</p>\n",type:"String"},{name:"column",description:"<p>The column ID (number) or\n                                 title (string)</p>\n",type:"String|Integer",optional:true}],class:"p5.Table",module:"IO"},getColumn:{name:"getColumn",params:[{name:"column",description:"<p>String or Number of the column to return</p>\n",type:"String|Number"}],class:"p5.Table",module:"IO"},clearRows:{name:"clearRows",class:"p5.Table",module:"IO"},addColumn:{name:"addColumn",params:[{name:"title",description:"<p>title of the given column</p>\n",type:"String",optional:true}],class:"p5.Table",module:"IO"},getColumnCount:{name:"getColumnCount",class:"p5.Table",module:"IO"},getRowCount:{name:"getRowCount",class:"p5.Table",module:"IO"},removeTokens:{name:"removeTokens",params:[{name:"chars",description:"<p>String listing characters to be removed</p>\n",type:"String"},{name:"column",description:"<p>Column ID (number)\n                                 or name (string)</p>\n",type:"String|Integer",optional:true}],class:"p5.Table",module:"IO"},trim:{name:"trim",params:[{name:"column",description:"<p>Column ID (number)\n                                 or name (string)</p>\n",type:"String|Integer",optional:true}],class:"p5.Table",module:"IO"},removeColumn:{name:"removeColumn",params:[{name:"column",description:"<p>columnName (string) or ID (number)</p>\n",type:"String|Integer"}],class:"p5.Table",module:"IO"},set:{name:"set",params:[{name:"row",description:"<p>row ID</p>\n",type:"Integer"},{name:"column",description:"<p>column ID (Number)\n                              or title (String)</p>\n",type:"String|Integer"},{name:"value",description:"<p>value to assign</p>\n",type:"String|Number"}],class:"p5.Table",module:"IO"},setNum:{name:"setNum",params:[{name:"row",description:"<p>row ID</p>\n",type:"Integer"},{name:"column",description:"<p>column ID (Number)\n                              or title (String)</p>\n",type:"String|Integer"},{name:"value",description:"<p>value to assign</p>\n",type:"Number"}],class:"p5.Table",module:"IO"},setString:{name:"setString",params:[{name:"row",description:"<p>row ID</p>\n",type:"Integer"},{name:"column",description:"<p>column ID (Number)\n                              or title (String)</p>\n",type:"String|Integer"},{name:"value",description:"<p>value to assign</p>\n",type:"String"}],class:"p5.Table",module:"IO"},get:{name:"get",params:[{name:"row",description:"<p>row ID</p>\n",type:"Integer"},{name:"column",description:"<p>columnName (string) or\n                                  ID (number)</p>\n",type:"String|Integer"}],class:"p5.Table",module:"IO"},getNum:{name:"getNum",params:[{name:"row",description:"<p>row ID</p>\n",type:"Integer"},{name:"column",description:"<p>columnName (string) or\n                                  ID (number)</p>\n",type:"String|Integer"}],class:"p5.Table",module:"IO"},getString:{name:"getString",params:[{name:"row",description:"<p>row ID</p>\n",type:"Integer"},{name:"column",description:"<p>columnName (string) or\n                                  ID (number)</p>\n",type:"String|Integer"}],class:"p5.Table",module:"IO"},getObject:{name:"getObject",params:[{name:"headerColumn",description:"<p>Name of the column which should be used to\n                             title each row object (optional)</p>\n",type:"String",optional:true}],class:"p5.Table",module:"IO"},getArray:{name:"getArray",class:"p5.Table",module:"IO"}},"p5.TableRow":{set:{name:"set",params:[{name:"column",description:"<p>Column ID (Number)\n                              or Title (String)</p>\n",type:"String|Integer"},{name:"value",description:"<p>The value to be stored</p>\n",type:"String|Number"}],class:"p5.TableRow",module:"IO"},setNum:{name:"setNum",params:[{name:"column",description:"<p>Column ID (Number)\n                              or Title (String)</p>\n",type:"String|Integer"},{name:"value",description:"<p>The value to be stored\n                              as a Float</p>\n",type:"Number|String"}],class:"p5.TableRow",module:"IO"},setString:{name:"setString",params:[{name:"column",description:"<p>Column ID (Number)\n                              or Title (String)</p>\n",type:"String|Integer"},{name:"value",description:"<p>The value to be stored\n                              as a String</p>\n",type:"String|Number|Boolean|Object"}],class:"p5.TableRow",module:"IO"},get:{name:"get",params:[{name:"column",description:"<p>columnName (string) or\n                                 ID (number)</p>\n",type:"String|Integer"}],class:"p5.TableRow",module:"IO"},getNum:{name:"getNum",params:[{name:"column",description:"<p>columnName (string) or\n                                 ID (number)</p>\n",type:"String|Integer"}],class:"p5.TableRow",module:"IO"},getString:{name:"getString",params:[{name:"column",description:"<p>columnName (string) or\n                                 ID (number)</p>\n",type:"String|Integer"}],class:"p5.TableRow",module:"IO"}},"p5.XML":{getParent:{name:"getParent",class:"p5.XML",module:"IO"},getName:{name:"getName",class:"p5.XML",module:"IO"},setName:{name:"setName",params:[{name:"the",description:"<p>new name of the node</p>\n",type:"String"}],class:"p5.XML",module:"IO"},hasChildren:{name:"hasChildren",class:"p5.XML",module:"IO"},listChildren:{name:"listChildren",class:"p5.XML",module:"IO"},getChildren:{name:"getChildren",params:[{name:"name",description:"<p>element name</p>\n",type:"String",optional:true}],class:"p5.XML",module:"IO"},getChild:{name:"getChild",params:[{name:"name",description:"<p>element name or index</p>\n",type:"String|Integer"}],class:"p5.XML",module:"IO"},addChild:{name:"addChild",params:[{name:"node",description:'<p>a <a href="#/p5.XML">p5.XML</a> Object which will be the child to be added</p>\n',type:"p5.XML"}],class:"p5.XML",module:"IO"},removeChild:{name:"removeChild",params:[{name:"name",description:"<p>element name or index</p>\n",type:"String|Integer"}],class:"p5.XML",module:"IO"},getAttributeCount:{name:"getAttributeCount",class:"p5.XML",module:"IO"},listAttributes:{name:"listAttributes",class:"p5.XML",module:"IO"},hasAttribute:{name:"hasAttribute",params:[{name:"the",description:"<p>attribute to be checked</p>\n",type:"String"}],class:"p5.XML",module:"IO"},getNum:{name:"getNum",params:[{name:"name",description:"<p>the non-null full name of the attribute</p>\n",type:"String"},{name:"defaultValue",description:"<p>the default value of the attribute</p>\n",type:"Number",optional:true}],class:"p5.XML",module:"IO"},getString:{name:"getString",params:[{name:"name",description:"<p>the non-null full name of the attribute</p>\n",type:"String"},{name:"defaultValue",description:"<p>the default value of the attribute</p>\n",type:"Number",optional:true}],class:"p5.XML",module:"IO"},setAttribute:{name:"setAttribute",params:[{name:"name",description:"<p>the full name of the attribute</p>\n",type:"String"},{name:"value",description:"<p>the value of the attribute</p>\n",type:"Number|String|Boolean"}],class:"p5.XML",module:"IO"},getContent:{name:"getContent",params:[{name:"defaultValue",description:"<p>value returned if no content is found</p>\n",type:"String",optional:true}],class:"p5.XML",module:"IO"},setContent:{name:"setContent",params:[{name:"text",description:"<p>the new content</p>\n",type:"String"}],class:"p5.XML",module:"IO"},serialize:{name:"serialize",class:"p5.XML",module:"IO"}},"p5.Vector":{x:{name:"x",class:"p5.Vector",module:"Math"},y:{name:"y",class:"p5.Vector",module:"Math"},z:{name:"z",class:"p5.Vector",module:"Math"},toString:{name:"toString",class:"p5.Vector",module:"Math"},set:{name:"set",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"x",description:"<p>x component of the vector.</p>\n",type:"Number",optional:true},{name:"y",description:"<p>y component of the vector.</p>\n",type:"Number",optional:true},{name:"z",description:"<p>z component of the vector.</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"value",description:"<p>vector to set.</p>\n",type:"p5.Vector|Number[]"}],chainable:1}]},copy:{name:"copy",class:"p5.Vector",module:"Math",overloads:[{params:[]},{params:[{name:"v",description:'<p>the <a href="#/p5.Vector">p5.Vector</a> to create a copy of</p>\n',type:"p5.Vector"}],static:1}]},add:{name:"add",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"x",description:"<p>x component of the vector to be added.</p>\n",type:"Number"},{name:"y",description:"<p>y component of the vector to be added.</p>\n",type:"Number",optional:true},{name:"z",description:"<p>z component of the vector to be added.</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"value",description:"<p>The vector to add</p>\n",type:"p5.Vector|Number[]"}],chainable:1},{params:[{name:"v1",description:'<p>A <a href="#/p5.Vector">p5.Vector</a> to add</p>\n',type:"p5.Vector"},{name:"v2",description:'<p>A <a href="#/p5.Vector">p5.Vector</a> to add</p>\n',type:"p5.Vector"},{name:"target",description:"<p>vector to receive the result.</p>\n",type:"p5.Vector",optional:true}],static:1}]},rem:{name:"rem",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"x",description:"<p>x component of divisor vector.</p>\n",type:"Number"},{name:"y",description:"<p>y component of divisor vector.</p>\n",type:"Number"},{name:"z",description:"<p>z component of divisor vector.</p>\n",type:"Number"}],chainable:1},{params:[{name:"value",description:"<p>divisor vector.</p>\n",type:"p5.Vector | Number[]"}],chainable:1},{params:[{name:"v1",description:'<p>The dividend <a href="#/p5.Vector">p5.Vector</a></p>\n',type:"p5.Vector"},{name:"v2",description:'<p>The divisor <a href="#/p5.Vector">p5.Vector</a></p>\n',type:"p5.Vector"}],static:1},{params:[{name:"v1",description:"",type:"p5.Vector"},{name:"v2",description:"",type:"p5.Vector"}],static:1}]},sub:{name:"sub",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"x",description:"<p>x component of the vector to subtract.</p>\n",type:"Number"},{name:"y",description:"<p>y component of the vector to subtract.</p>\n",type:"Number",optional:true},{name:"z",description:"<p>z component of the vector to subtract.</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"value",description:"<p>the vector to subtract</p>\n",type:"p5.Vector|Number[]"}],chainable:1},{params:[{name:"v1",description:'<p>A <a href="#/p5.Vector">p5.Vector</a> to subtract from</p>\n',type:"p5.Vector"},{name:"v2",description:'<p>A <a href="#/p5.Vector">p5.Vector</a> to subtract</p>\n',type:"p5.Vector"},{name:"target",description:"<p>vector to receive the result.</p>\n",type:"p5.Vector",optional:true}],static:1}]},mult:{name:"mult",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"n",description:"<p>The number to multiply with the vector</p>\n",type:"Number"}],chainable:1},{params:[{name:"x",description:"<p>number to multiply with the x component of the vector.</p>\n",type:"Number"},{name:"y",description:"<p>number to multiply with the y component of the vector.</p>\n",type:"Number"},{name:"z",description:"<p>number to multiply with the z component of the vector.</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"arr",description:"<p>array to multiply with the components of the vector.</p>\n",type:"Number[]"}],chainable:1},{params:[{name:"v",description:"<p>vector to multiply with the components of the original vector.</p>\n",type:"p5.Vector"}],chainable:1},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"",type:"Number",optional:true}],static:1},{params:[{name:"v",description:"",type:"p5.Vector"},{name:"n",description:"",type:"Number"},{name:"target",description:"<p>vector to receive the result.</p>\n",type:"p5.Vector",optional:true}],static:1},{params:[{name:"v0",description:"",type:"p5.Vector"},{name:"v1",description:"",type:"p5.Vector"},{name:"target",description:"",type:"p5.Vector",optional:true}],static:1},{params:[{name:"v0",description:"",type:"p5.Vector"},{name:"arr",description:"",type:"Number[]"},{name:"target",description:"",type:"p5.Vector",optional:true}],static:1}]},div:{name:"div",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"n",description:"<p>The number to divide the vector by</p>\n",type:"Number"}],chainable:1},{params:[{name:"x",description:"<p>number to divide with the x component of the vector.</p>\n",type:"Number"},{name:"y",description:"<p>number to divide with the y component of the vector.</p>\n",type:"Number"},{name:"z",description:"<p>number to divide with the z component of the vector.</p>\n",type:"Number",optional:true}],chainable:1},{params:[{name:"arr",description:"<p>array to divide the components of the vector by.</p>\n",type:"Number[]"}],chainable:1},{params:[{name:"v",description:"<p>vector to divide the components of the original vector by.</p>\n",type:"p5.Vector"}],chainable:1},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"},{name:"z",description:"",type:"Number",optional:true}],static:1},{params:[{name:"v",description:"",type:"p5.Vector"},{name:"n",description:"",type:"Number"},{name:"target",description:"<p>The vector to receive the result</p>\n",type:"p5.Vector",optional:true}],static:1},{params:[{name:"v0",description:"",type:"p5.Vector"},{name:"v1",description:"",type:"p5.Vector"},{name:"target",description:"",type:"p5.Vector",optional:true}],static:1},{params:[{name:"v0",description:"",type:"p5.Vector"},{name:"arr",description:"",type:"Number[]"},{name:"target",description:"",type:"p5.Vector",optional:true}],static:1}]},mag:{name:"mag",class:"p5.Vector",module:"Math",overloads:[{params:[]},{params:[{name:"vecT",description:"<p>The vector to return the magnitude of</p>\n",type:"p5.Vector"}],static:1}]},magSq:{name:"magSq",class:"p5.Vector",module:"Math",overloads:[{params:[]},{params:[{name:"vecT",description:"<p>the vector to return the squared magnitude of</p>\n",type:"p5.Vector"}],static:1}]},dot:{name:"dot",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"x",description:"<p>x component of the vector.</p>\n",type:"Number"},{name:"y",description:"<p>y component of the vector.</p>\n",type:"Number",optional:true},{name:"z",description:"<p>z component of the vector.</p>\n",type:"Number",optional:true}]},{params:[{name:"v",description:'<p><a href="#/p5.Vector">p5.Vector</a> to be dotted.</p>\n',type:"p5.Vector"}]},{params:[{name:"v1",description:'<p>first <a href="#/p5.Vector">p5.Vector</a>.</p>\n',type:"p5.Vector"},{name:"v2",description:'<p>second <a href="#/p5.Vector">p5.Vector</a>.</p>\n',type:"p5.Vector"}],static:1}]},cross:{name:"cross",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"v",description:'<p><a href="#/p5.Vector">p5.Vector</a> to be crossed.</p>\n',type:"p5.Vector"}]},{params:[{name:"v1",description:'<p>first <a href="#/p5.Vector">p5.Vector</a>.</p>\n',type:"p5.Vector"},{name:"v2",description:'<p>second <a href="#/p5.Vector">p5.Vector</a>.</p>\n',type:"p5.Vector"}],static:1}]},dist:{name:"dist",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"v",description:'<p>x, y, and z coordinates of a <a href="#/p5.Vector">p5.Vector</a>.</p>\n',type:"p5.Vector"}]},{params:[{name:"v1",description:'<p>The first <a href="#/p5.Vector">p5.Vector</a></p>\n',type:"p5.Vector"},{name:"v2",description:'<p>The second <a href="#/p5.Vector">p5.Vector</a></p>\n',type:"p5.Vector"}],static:1}]},normalize:{name:"normalize",class:"p5.Vector",module:"Math",overloads:[{params:[]},{params:[{name:"v",description:"<p>The vector to normalize</p>\n",type:"p5.Vector"},{name:"target",description:"<p>The vector to receive the result</p>\n",type:"p5.Vector",optional:true}],static:1}]},limit:{name:"limit",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"max",description:"<p>maximum magnitude for the vector.</p>\n",type:"Number"}],chainable:1},{params:[{name:"v",description:"<p>the vector to limit</p>\n",type:"p5.Vector"},{name:"max",description:"",type:"Number"},{name:"target",description:"<p>the vector to receive the result (Optional)</p>\n",type:"p5.Vector",optional:true}],static:1}]},setMag:{name:"setMag",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"len",description:"<p>new length for this vector.</p>\n",type:"Number"}],chainable:1},{params:[{name:"v",description:"<p>the vector to set the magnitude of</p>\n",type:"p5.Vector"},{name:"len",description:"",type:"Number"},{name:"target",description:"<p>the vector to receive the result (Optional)</p>\n",type:"p5.Vector",optional:true}],static:1}]},heading:{name:"heading",class:"p5.Vector",module:"Math",overloads:[{params:[]},{params:[{name:"v",description:"<p>the vector to find the angle of</p>\n",type:"p5.Vector"}],static:1}]},setHeading:{name:"setHeading",params:[{name:"angle",description:"<p>angle of rotation.</p>\n",type:"Number"}],class:"p5.Vector",module:"Math"},rotate:{name:"rotate",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"angle",description:"<p>angle of rotation.</p>\n",type:"Number"}],chainable:1},{params:[{name:"v",description:"",type:"p5.Vector"},{name:"angle",description:"",type:"Number"},{name:"target",description:"<p>The vector to receive the result</p>\n",type:"p5.Vector",optional:true}],static:1}]},angleBetween:{name:"angleBetween",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"value",description:'<p>x, y, and z components of a <a href="#/p5.Vector">p5.Vector</a>.</p>\n',type:"p5.Vector"}]},{params:[{name:"v1",description:"<p>the first vector.</p>\n",type:"p5.Vector"},{name:"v2",description:"<p>the second vector.</p>\n",type:"p5.Vector"}],static:1}]},lerp:{name:"lerp",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"x",description:"<p>x component.</p>\n",type:"Number"},{name:"y",description:"<p>y component.</p>\n",type:"Number"},{name:"z",description:"<p>z component.</p>\n",type:"Number"},{name:"amt",description:"<p>amount of interpolation between 0.0 (old vector)\n                        and 1.0 (new vector). 0.5 is halfway between.</p>\n",type:"Number"}],chainable:1},{params:[{name:"v",description:'<p><a href="#/p5.Vector">p5.Vector</a> to lerp toward.</p>\n',type:"p5.Vector"},{name:"amt",description:"",type:"Number"}],chainable:1},{params:[{name:"v1",description:"",type:"p5.Vector"},{name:"v2",description:"",type:"p5.Vector"},{name:"amt",description:"",type:"Number"},{name:"target",description:"<p>The vector to receive the result</p>\n",type:"p5.Vector",optional:true}],static:1}]},slerp:{name:"slerp",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"v",description:'<p><a href="#/p5.Vector">p5.Vector</a> to slerp toward.</p>\n',type:"p5.Vector"},{name:"amt",description:"<p>amount of interpolation between 0.0 (old vector)\n                     and 1.0 (new vector). 0.5 is halfway between.</p>\n",type:"Number"}]},{params:[{name:"v1",description:"<p>old vector.</p>\n",type:"p5.Vector"},{name:"v2",description:"<p>new vector.</p>\n",type:"p5.Vector"},{name:"amt",description:"",type:"Number"},{name:"target",description:"<p>vector to receive the result.</p>\n",type:"p5.Vector",optional:true}],static:1}]},reflect:{name:"reflect",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"surfaceNormal",description:'<p><a href="#/p5.Vector">p5.Vector</a>\n                                   to reflect about.</p>\n',type:"p5.Vector"}],chainable:1},{params:[{name:"incidentVector",description:"<p>vector to be reflected.</p>\n",type:"p5.Vector"},{name:"surfaceNormal",description:"",type:"p5.Vector"},{name:"target",description:"<p>vector to receive the result.</p>\n",type:"p5.Vector",optional:true}],static:1}]},array:{name:"array",class:"p5.Vector",module:"Math",overloads:[{params:[]},{params:[{name:"v",description:"<p>the vector to convert to an array</p>\n",type:"p5.Vector"}],static:1}]},equals:{name:"equals",class:"p5.Vector",module:"Math",overloads:[{params:[{name:"x",description:"<p>x component of the vector.</p>\n",type:"Number",optional:true},{name:"y",description:"<p>y component of the vector.</p>\n",type:"Number",optional:true},{name:"z",description:"<p>z component of the vector.</p>\n",type:"Number",optional:true}]},{params:[{name:"value",description:"<p>vector to compare.</p>\n",type:"p5.Vector|Array"}]},{params:[{name:"v1",description:"<p>the first vector to compare</p>\n",type:"p5.Vector|Array"},{name:"v2",description:"<p>the second vector to compare</p>\n",type:"p5.Vector|Array"}],static:1}]},fromAngle:{name:"fromAngle",params:[{name:"angle",description:'<p>desired angle, in radians. Unaffected by <a href="#/p5/angleMode">angleMode()</a>.</p>\n',type:"Number"},{name:"length",description:"<p>length of the new vector (defaults to 1).</p>\n",type:"Number",optional:true}],class:"p5.Vector",module:"Math"},fromAngles:{name:"fromAngles",params:[{name:"theta",description:"<p>polar angle in radians (zero is up).</p>\n",type:"Number"},{name:"phi",description:"<p>azimuthal angle in radians\n                              (zero is out of the screen).</p>\n",type:"Number"},{name:"length",description:"<p>length of the new vector (defaults to 1).</p>\n",type:"Number",optional:true}],class:"p5.Vector",module:"Math"},random2D:{name:"random2D",class:"p5.Vector",module:"Math"},random3D:{name:"random3D",class:"p5.Vector",module:"Math"}},"p5.Font":{font:{name:"font",class:"p5.Font",module:"Typography"},textBounds:{name:"textBounds",params:[{name:"str",description:"<p>string of text.</p>\n",type:"String"},{name:"x",description:"<p>x-coordinate of the text.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the text.</p>\n",type:"Number"},{name:"fontSize",description:'<p>font size. Defaults to the current\n                            <a href="#/p5/textSize">textSize()</a>.</p>\n',type:"Number",optional:true}],class:"p5.Font",module:"Typography"},textToPoints:{name:"textToPoints",params:[{name:"str",description:"<p>string of text.</p>\n",type:"String"},{name:"x",description:"<p>x-coordinate of the text.</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the text.</p>\n",type:"Number"},{name:"fontSize",description:'<p>font size. Defaults to the current\n                            <a href="#/p5/textSize">textSize()</a>.</p>\n',type:"Number",optional:true},{name:"options",description:"<p>object with sampleFactor and simplifyThreshold\n                            properties.</p>\n",type:"Object",optional:true}],class:"p5.Font",module:"Typography"}},"p5.Camera":{eyeX:{name:"eyeX",class:"p5.Camera",module:"3D"},eyeY:{name:"eyeY",class:"p5.Camera",module:"3D"},eyeZ:{name:"eyeZ",class:"p5.Camera",module:"3D"},centerX:{name:"centerX",class:"p5.Camera",module:"3D"},centerY:{name:"centerY",class:"p5.Camera",module:"3D"},centerZ:{name:"centerZ",class:"p5.Camera",module:"3D"},upX:{name:"upX",class:"p5.Camera",module:"3D"},upY:{name:"upY",class:"p5.Camera",module:"3D"},upZ:{name:"upZ",class:"p5.Camera",module:"3D"},perspective:{name:"perspective",class:"p5.Camera",module:"3D"},ortho:{name:"ortho",class:"p5.Camera",module:"3D"},frustum:{name:"frustum",class:"p5.Camera",module:"3D"},pan:{name:"pan",params:[{name:"angle",description:'<p>amount to rotate camera in current\n<a href="#/p5/angleMode">angleMode</a> units.\nGreater than 0 values rotate counterclockwise (to the left).</p>\n',type:"Number"}],class:"p5.Camera",module:"3D"},tilt:{name:"tilt",params:[{name:"angle",description:'<p>amount to rotate camera in current\n<a href="#/p5/angleMode">angleMode</a> units.\nGreater than 0 values rotate counterclockwise (to the left).</p>\n',type:"Number"}],class:"p5.Camera",module:"3D"},lookAt:{name:"lookAt",params:[{name:"x",description:"<p>x position of a point in world space</p>\n",type:"Number"},{name:"y",description:"<p>y position of a point in world space</p>\n",type:"Number"},{name:"z",description:"<p>z position of a point in world space</p>\n",type:"Number"}],class:"p5.Camera",module:"3D"},camera:{name:"camera",class:"p5.Camera",module:"3D"},move:{name:"move",params:[{name:"x",description:"<p>amount to move along camera's left-right axis</p>\n",type:"Number"},{name:"y",description:"<p>amount to move along camera's up-down axis</p>\n",type:"Number"},{name:"z",description:"<p>amount to move along camera's forward-backward axis</p>\n",type:"Number"}],class:"p5.Camera",module:"3D"},setPosition:{name:"setPosition",params:[{name:"x",description:"<p>x position of a point in world space</p>\n",type:"Number"},{name:"y",description:"<p>y position of a point in world space</p>\n",type:"Number"},{name:"z",description:"<p>z position of a point in world space</p>\n",type:"Number"}],class:"p5.Camera",module:"3D"},set:{name:"set",params:[{name:"cam",description:"<p>source camera</p>\n",type:"p5.Camera"}],class:"p5.Camera",module:"3D"},slerp:{name:"slerp",params:[{name:"cam0",description:"<p>first p5.Camera</p>\n",type:"p5.Camera"},{name:"cam1",description:"<p>second p5.Camera</p>\n",type:"p5.Camera"},{name:"amt",description:"<p>amount to use for interpolation during slerp</p>\n",type:"Number"}],class:"p5.Camera",module:"3D"}},"p5.Framebuffer":{pixels:{name:"pixels",class:"p5.Framebuffer",module:"Rendering"},resize:{name:"resize",params:[{name:"width",description:"",type:"Number"},{name:"height",description:"",type:"Number"}],class:"p5.Framebuffer",module:"Rendering"},pixelDensity:{name:"pixelDensity",params:[{name:"density",description:"<p>A scaling factor for the number of pixels per\nside of the framebuffer</p>\n",type:"Number",optional:true}],class:"p5.Framebuffer",module:"Rendering"},autoSized:{name:"autoSized",params:[{name:"autoSized",description:"<p>Whether or not the framebuffer should resize\nalong with the canvas it's attached to</p>\n",type:"Boolean",optional:true}],class:"p5.Framebuffer",module:"Rendering"},createCamera:{name:"createCamera",class:"p5.Framebuffer",module:"Rendering"},remove:{name:"remove",class:"p5.Framebuffer",module:"Rendering"},begin:{name:"begin",class:"p5.Framebuffer",module:"Rendering"},end:{name:"end",class:"p5.Framebuffer",module:"Rendering"},draw:{name:"draw",params:[{name:"callback",description:"<p>A function to run that draws to the canvas. The\nfunction will immediately be run, but it will draw to the framebuffer\ninstead of the canvas.</p>\n",type:"Function"}],class:"p5.Framebuffer",module:"Rendering"},get:{name:"get",class:"p5.Framebuffer",module:"Rendering",overloads:[{params:[{name:"x",description:"<p>x-coordinate of the pixel</p>\n",type:"Number"},{name:"y",description:"<p>y-coordinate of the pixel</p>\n",type:"Number"},{name:"w",description:"<p>width of the section to be returned</p>\n",type:"Number"},{name:"h",description:"<p>height of the section to be returned</p>\n",type:"Number"}]},{params:[]},{params:[{name:"x",description:"",type:"Number"},{name:"y",description:"",type:"Number"}]}]},color:{name:"color",class:"p5.Framebuffer",module:"Rendering"},depth:{name:"depth",class:"p5.Framebuffer",module:"Rendering"}},"p5.Geometry":{clearColors:{name:"clearColors",class:"p5.Geometry",module:"Shape"},computeFaces:{name:"computeFaces",class:"p5.Geometry",module:"Shape"},computeNormals:{name:"computeNormals",params:[{name:"shadingType",description:"<p>shading type (<code>FLAT</code> for flat shading or <code>SMOOTH</code> for smooth shading) for buildGeometry() outputs. Defaults to <code>FLAT</code>.</p>\n",type:"String",optional:true},{name:"options",description:"<p>An optional object with configuration.</p>\n",type:"Object",optional:true}],class:"p5.Geometry",module:"Shape"},averageNormals:{name:"averageNormals",class:"p5.Geometry",module:"Shape"},averagePoleNormals:{name:"averagePoleNormals",class:"p5.Geometry",module:"Shape"},normalize:{name:"normalize",class:"p5.Geometry",module:"Shape"}},"p5.Shader":{copyToContext:{name:"copyToContext",params:[{name:"context",description:"<p>The graphic or instance to copy this shader to.\nPass <code>window</code> if you need to copy to the main canvas.</p>\n",type:"p5|p5.Graphics"}],class:"p5.Shader",module:"3D"},setUniform:{name:"setUniform",params:[{name:"uniformName",description:"<p>the name of the uniform.\nMust correspond to the name used in the vertex and fragment shaders</p>\n",type:"String"},{name:"data",description:"<p>the data to associate with the uniform. The type can be\na boolean (true/false), a number, an array of numbers, or\nan image (p5.Image, p5.Graphics, p5.MediaElement, p5.Texture)</p>\n",type:"Boolean|Number|Number[]|p5.Image|p5.Graphics|p5.MediaElement|p5.Texture"}],class:"p5.Shader",module:"3D"}},"p5.SoundFile":{isLoaded:{name:"isLoaded",class:"p5.SoundFile",module:"p5.sound"},play:{name:"play",params:[{name:"startTime",description:"<p>(optional) schedule playback to start (in seconds from now).</p>\n",type:"Number",optional:true},{name:"rate",description:"<p>(optional) playback rate</p>\n",type:"Number",optional:true},{name:"amp",description:"<p>(optional) amplitude (volume)\n                                    of playback</p>\n",type:"Number",optional:true},{name:"cueStart",description:"<p>(optional) cue start time in seconds</p>\n",type:"Number",optional:true},{name:"duration",description:"<p>(optional) duration of playback in seconds</p>\n",type:"Number",optional:true}],class:"p5.SoundFile",module:"p5.sound"},playMode:{name:"playMode",params:[{name:"str",description:"<p>'restart' or 'sustain' or 'untilDone'</p>\n",type:"String"}],class:"p5.SoundFile",module:"p5.sound"},pause:{name:"pause",params:[{name:"startTime",description:"<p>(optional) schedule event to occur\n                             seconds from now</p>\n",type:"Number",optional:true}],class:"p5.SoundFile",module:"p5.sound"},loop:{name:"loop",params:[{name:"startTime",description:"<p>(optional) schedule event to occur\n                            seconds from now</p>\n",type:"Number",optional:true},{name:"rate",description:"<p>(optional) playback rate</p>\n",type:"Number",optional:true},{name:"amp",description:"<p>(optional) playback volume</p>\n",type:"Number",optional:true},{name:"cueLoopStart",description:"<p>(optional) startTime in seconds</p>\n",type:"Number",optional:true},{name:"duration",description:"<p>(optional) loop duration in seconds</p>\n",type:"Number",optional:true}],class:"p5.SoundFile",module:"p5.sound"},setLoop:{name:"setLoop",params:[{name:"Boolean",description:"<p>set looping to true or false</p>\n",type:"Boolean"}],class:"p5.SoundFile",module:"p5.sound"},isLooping:{name:"isLooping",class:"p5.SoundFile",module:"p5.sound"},isPlaying:{name:"isPlaying",class:"p5.SoundFile",module:"p5.sound"},isPaused:{name:"isPaused",class:"p5.SoundFile",module:"p5.sound"},stop:{name:"stop",params:[{name:"startTime",description:"<p>(optional) schedule event to occur\n                            in seconds from now</p>\n",type:"Number",optional:true}],class:"p5.SoundFile",module:"p5.sound"},pan:{name:"pan",params:[{name:"panValue",description:"<p>Set the stereo panner</p>\n",type:"Number",optional:true},{name:"timeFromNow",description:"<p>schedule this event to happen\n                                seconds from now</p>\n",type:"Number",optional:true}],class:"p5.SoundFile",module:"p5.sound"},getPan:{name:"getPan",class:"p5.SoundFile",module:"p5.sound"},rate:{name:"rate",params:[{name:"playbackRate",description:"<p>Set the playback rate. 1.0 is normal,\n                                   .5 is half-speed, 2.0 is twice as fast.\n                                   Values less than zero play backwards.</p>\n",type:"Number",optional:true}],class:"p5.SoundFile",module:"p5.sound"},setVolume:{name:"setVolume",params:[{name:"volume",description:"<p>Volume (amplitude) between 0.0\n                                   and 1.0 or modulating signal/oscillator</p>\n",type:"Number|Object"},{name:"rampTime",description:"<p>Fade for t seconds</p>\n",type:"Number",optional:true},{name:"timeFromNow",description:"<p>Schedule this event to happen at\n                               t seconds in the future</p>\n",type:"Number",optional:true}],class:"p5.SoundFile",module:"p5.sound"},duration:{name:"duration",class:"p5.SoundFile",module:"p5.sound"},currentTime:{name:"currentTime",class:"p5.SoundFile",module:"p5.sound"},jump:{name:"jump",params:[{name:"cueTime",description:"<p>cueTime of the soundFile in seconds.</p>\n",type:"Number"},{name:"duration",description:"<p>duration in seconds.</p>\n",type:"Number"}],class:"p5.SoundFile",module:"p5.sound"},channels:{name:"channels",class:"p5.SoundFile",module:"p5.sound"},sampleRate:{name:"sampleRate",class:"p5.SoundFile",module:"p5.sound"},frames:{name:"frames",class:"p5.SoundFile",module:"p5.sound"},getPeaks:{name:"getPeaks",params:[{name:"length",description:"<p>length is the size of the returned array.\n                         Larger length results in more precision.\n                         Defaults to 5*width of the browser window.</p>\n",type:"Number",optional:true}],class:"p5.SoundFile",module:"p5.sound"},reverseBuffer:{name:"reverseBuffer",class:"p5.SoundFile",module:"p5.sound"},onended:{name:"onended",params:[{name:"callback",description:"<p>function to call when the\n                            soundfile has ended.</p>\n",type:"Function"}],class:"p5.SoundFile",module:"p5.sound"},connect:{name:"connect",params:[{name:"object",description:"<p>Audio object that accepts an input</p>\n",type:"Object",optional:true}],class:"p5.SoundFile",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.SoundFile",module:"p5.sound"},setPath:{name:"setPath",params:[{name:"path",description:"<p>path to audio file</p>\n",type:"String"},{name:"callback",description:"<p>Callback</p>\n",type:"Function"}],class:"p5.SoundFile",module:"p5.sound"},setBuffer:{name:"setBuffer",params:[{name:"buf",description:"<p>Array of Float32 Array(s). 2 Float32 Arrays\n                   will create a stereo source. 1 will create\n                   a mono source.</p>\n",type:"Array"}],class:"p5.SoundFile",module:"p5.sound"},addCue:{name:"addCue",params:[{name:"time",description:"<p>Time in seconds, relative to this media\n                           element's playback. For example, to trigger\n                           an event every time playback reaches two\n                           seconds, pass in the number 2. This will be\n                           passed as the first parameter to\n                           the callback function.</p>\n",type:"Number"},{name:"callback",description:"<p>Name of a function that will be\n                           called at the given time. The callback will\n                           receive time and (optionally) param as its\n                           two parameters.</p>\n",type:"Function"},{name:"value",description:"<p>An object to be passed as the\n                           second parameter to the\n                           callback function.</p>\n",type:"Object",optional:true}],class:"p5.SoundFile",module:"p5.sound"},removeCue:{name:"removeCue",params:[{name:"id",description:"<p>ID of the cue, as returned by addCue</p>\n",type:"Number"}],class:"p5.SoundFile",module:"p5.sound"},clearCues:{name:"clearCues",class:"p5.SoundFile",module:"p5.sound"},save:{name:"save",params:[{name:"fileName",description:"<p>name of the resulting .wav file.</p>\n",type:"String",optional:true}],class:"p5.SoundFile",module:"p5.sound"},getBlob:{name:"getBlob",class:"p5.SoundFile",module:"p5.sound"}},"p5.Amplitude":{setInput:{name:"setInput",params:[{name:"snd",description:"<p>set the sound source\n                                     (optional, defaults to\n                                     main output)</p>\n",type:"SoundObject|undefined",optional:true},{name:"smoothing",description:"<p>a range between 0.0 and 1.0\n                                      to smooth amplitude readings</p>\n",type:"Number|undefined",optional:true}],class:"p5.Amplitude",module:"p5.sound"},getLevel:{name:"getLevel",params:[{name:"channel",description:"<p>Optionally return only channel 0 (left) or 1 (right)</p>\n",type:"Number",optional:true}],class:"p5.Amplitude",module:"p5.sound"},toggleNormalize:{name:"toggleNormalize",params:[{name:"boolean",description:"<p>set normalize to true (1) or false (0)</p>\n",type:"Boolean",optional:true}],class:"p5.Amplitude",module:"p5.sound"},smooth:{name:"smooth",params:[{name:"set",description:"<p>smoothing from 0.0 <= 1</p>\n",type:"Number"}],class:"p5.Amplitude",module:"p5.sound"}},"p5.FFT":{setInput:{name:"setInput",params:[{name:"source",description:"<p>p5.sound object (or web audio API source node)</p>\n",type:"Object",optional:true}],class:"p5.FFT",module:"p5.sound"},waveform:{name:"waveform",params:[{name:"bins",description:"<p>Must be a power of two between\n                          16 and 1024. Defaults to 1024.</p>\n",type:"Number",optional:true},{name:"precision",description:"<p>If any value is provided, will return results\n                            in a Float32 Array which is more precise\n                            than a regular array.</p>\n",type:"String",optional:true}],class:"p5.FFT",module:"p5.sound"},analyze:{name:"analyze",params:[{name:"bins",description:"<p>Must be a power of two between\n                           16 and 1024. Defaults to 1024.</p>\n",type:"Number",optional:true},{name:"scale",description:'<p>If "dB," returns decibel\n                           float measurements between\n                           -140 and 0 (max).\n                           Otherwise returns integers from 0-255.</p>\n',type:"Number",optional:true}],class:"p5.FFT",module:"p5.sound"},getEnergy:{name:"getEnergy",params:[{name:"frequency1",description:'<p>Will return a value representing\n                              energy at this frequency. Alternately,\n                              the strings "bass", "lowMid" "mid",\n                              "highMid", and "treble" will return\n                              predefined frequency ranges.</p>\n',type:"Number|String"},{name:"frequency2",description:"<p>If a second frequency is given,\n                              will return average amount of\n                              energy that exists between the\n                              two frequencies.</p>\n",type:"Number",optional:true}],class:"p5.FFT",module:"p5.sound"},getCentroid:{name:"getCentroid",class:"p5.FFT",module:"p5.sound"},smooth:{name:"smooth",params:[{name:"smoothing",description:"<p>0.0 < smoothing < 1.0.\n                             Defaults to 0.8.</p>\n",type:"Number"}],class:"p5.FFT",module:"p5.sound"},linAverages:{name:"linAverages",params:[{name:"N",description:"<p>Number of returned frequency groups</p>\n",type:"Number"}],class:"p5.FFT",module:"p5.sound"},logAverages:{name:"logAverages",params:[{name:"octaveBands",description:"<p>Array of Octave Bands objects for grouping</p>\n",type:"Array"}],class:"p5.FFT",module:"p5.sound"},getOctaveBands:{name:"getOctaveBands",params:[{name:"N",description:"<p>Specifies the 1/N type of generated octave bands</p>\n",type:"Number"},{name:"fCtr0",description:"<p>Minimum central frequency for the lowest band</p>\n",type:"Number"}],class:"p5.FFT",module:"p5.sound"}},"p5.Oscillator":{start:{name:"start",params:[{name:"time",description:"<p>startTime in seconds from now.</p>\n",type:"Number",optional:true},{name:"frequency",description:"<p>frequency in Hz.</p>\n",type:"Number",optional:true}],class:"p5.Oscillator",module:"p5.sound"},stop:{name:"stop",params:[{name:"secondsFromNow",description:"<p>Time, in seconds from now.</p>\n",type:"Number"}],class:"p5.Oscillator",module:"p5.sound"},amp:{name:"amp",params:[{name:"vol",description:"<p>between 0 and 1.0\n                            or a modulating signal/oscillator</p>\n",type:"Number|Object"},{name:"rampTime",description:"<p>create a fade that lasts rampTime</p>\n",type:"Number",optional:true},{name:"timeFromNow",description:"<p>schedule this event to happen\n                              seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Oscillator",module:"p5.sound"},getAmp:{name:"getAmp",class:"p5.Oscillator",module:"p5.sound"},freq:{name:"freq",params:[{name:"Frequency",description:"<p>Frequency in Hz\n                                      or modulating signal/oscillator</p>\n",type:"Number|Object"},{name:"rampTime",description:"<p>Ramp time (in seconds)</p>\n",type:"Number",optional:true},{name:"timeFromNow",description:"<p>Schedule this event to happen\n                                 at x seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Oscillator",module:"p5.sound"},getFreq:{name:"getFreq",class:"p5.Oscillator",module:"p5.sound"},setType:{name:"setType",params:[{name:"type",description:"<p>'sine', 'triangle', 'sawtooth' or 'square'.</p>\n",type:"String"}],class:"p5.Oscillator",module:"p5.sound"},getType:{name:"getType",class:"p5.Oscillator",module:"p5.sound"},connect:{name:"connect",params:[{name:"unit",description:"<p>A p5.sound or Web Audio object</p>\n",type:"Object"}],class:"p5.Oscillator",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.Oscillator",module:"p5.sound"},pan:{name:"pan",params:[{name:"panning",description:"<p>Number between -1 and 1</p>\n",type:"Number"},{name:"timeFromNow",description:"<p>schedule this event to happen\n                              seconds from now</p>\n",type:"Number"}],class:"p5.Oscillator",module:"p5.sound"},getPan:{name:"getPan",class:"p5.Oscillator",module:"p5.sound"},phase:{name:"phase",params:[{name:"phase",description:"<p>float between 0.0 and 1.0</p>\n",type:"Number"}],class:"p5.Oscillator",module:"p5.sound"},add:{name:"add",params:[{name:"number",description:"<p>Constant number to add</p>\n",type:"Number"}],class:"p5.Oscillator",module:"p5.sound"},mult:{name:"mult",params:[{name:"number",description:"<p>Constant number to multiply</p>\n",type:"Number"}],class:"p5.Oscillator",module:"p5.sound"},scale:{name:"scale",params:[{name:"inMin",description:"<p>input range minumum</p>\n",type:"Number"},{name:"inMax",description:"<p>input range maximum</p>\n",type:"Number"},{name:"outMin",description:"<p>input range minumum</p>\n",type:"Number"},{name:"outMax",description:"<p>input range maximum</p>\n",type:"Number"}],class:"p5.Oscillator",module:"p5.sound"}},"p5.Envelope":{attackTime:{name:"attackTime",class:"p5.Envelope",module:"p5.sound"},attackLevel:{name:"attackLevel",class:"p5.Envelope",module:"p5.sound"},decayTime:{name:"decayTime",class:"p5.Envelope",module:"p5.sound"},decayLevel:{name:"decayLevel",class:"p5.Envelope",module:"p5.sound"},releaseTime:{name:"releaseTime",class:"p5.Envelope",module:"p5.sound"},releaseLevel:{name:"releaseLevel",class:"p5.Envelope",module:"p5.sound"},set:{name:"set",params:[{name:"attackTime",description:"<p>Time (in seconds) before level\n                               reaches attackLevel</p>\n",type:"Number"},{name:"attackLevel",description:"<p>Typically an amplitude between\n                               0.0 and 1.0</p>\n",type:"Number"},{name:"decayTime",description:"<p>Time</p>\n",type:"Number"},{name:"decayLevel",description:"<p>Amplitude (In a standard ADSR envelope,\n                               decayLevel = sustainLevel)</p>\n",type:"Number"},{name:"releaseTime",description:"<p>Release Time (in seconds)</p>\n",type:"Number"},{name:"releaseLevel",description:"<p>Amplitude</p>\n",type:"Number"}],class:"p5.Envelope",module:"p5.sound"},setADSR:{name:"setADSR",params:[{name:"attackTime",description:"<p>Time (in seconds before envelope\n                              reaches Attack Level</p>\n",type:"Number"},{name:"decayTime",description:"<p>Time (in seconds) before envelope\n                              reaches Decay/Sustain Level</p>\n",type:"Number",optional:true},{name:"susRatio",description:"<p>Ratio between attackLevel and releaseLevel, on a scale from 0 to 1,\n                              where 1.0 = attackLevel, 0.0 = releaseLevel.\n                              The susRatio determines the decayLevel and the level at which the\n                              sustain portion of the envelope will sustain.\n                              For example, if attackLevel is 0.4, releaseLevel is 0,\n                              and susAmt is 0.5, the decayLevel would be 0.2. If attackLevel is\n                              increased to 1.0 (using <code>setRange</code>),\n                              then decayLevel would increase proportionally, to become 0.5.</p>\n",type:"Number",optional:true},{name:"releaseTime",description:"<p>Time in seconds from now (defaults to 0)</p>\n",type:"Number",optional:true}],class:"p5.Envelope",module:"p5.sound"},setRange:{name:"setRange",params:[{name:"aLevel",description:"<p>attack level (defaults to 1)</p>\n",type:"Number"},{name:"rLevel",description:"<p>release level (defaults to 0)</p>\n",type:"Number"}],class:"p5.Envelope",module:"p5.sound"},setInput:{name:"setInput",params:[{name:"inputs",description:"<p>A p5.sound object or\n                              Web Audio Param.</p>\n",type:"Object",optional:true,multiple:true}],class:"p5.Envelope",module:"p5.sound"},setExp:{name:"setExp",params:[{name:"isExp",description:"<p>true is exponential, false is linear</p>\n",type:"Boolean"}],class:"p5.Envelope",module:"p5.sound"},play:{name:"play",params:[{name:"unit",description:"<p>A p5.sound object or\n                              Web Audio Param.</p>\n",type:"Object"},{name:"startTime",description:"<p>time from now (in seconds) at which to play</p>\n",type:"Number",optional:true},{name:"sustainTime",description:"<p>time to sustain before releasing the envelope</p>\n",type:"Number",optional:true}],class:"p5.Envelope",module:"p5.sound"},triggerAttack:{name:"triggerAttack",params:[{name:"unit",description:"<p>p5.sound Object or Web Audio Param</p>\n",type:"Object"},{name:"secondsFromNow",description:"<p>time from now (in seconds)</p>\n",type:"Number"}],class:"p5.Envelope",module:"p5.sound"},triggerRelease:{name:"triggerRelease",params:[{name:"unit",description:"<p>p5.sound Object or Web Audio Param</p>\n",type:"Object"},{name:"secondsFromNow",description:"<p>time to trigger the release</p>\n",type:"Number"}],class:"p5.Envelope",module:"p5.sound"},ramp:{name:"ramp",params:[{name:"unit",description:"<p>p5.sound Object or Web Audio Param</p>\n",type:"Object"},{name:"secondsFromNow",description:"<p>When to trigger the ramp</p>\n",type:"Number"},{name:"v",description:"<p>Target value</p>\n",type:"Number"},{name:"v2",description:"<p>Second target value</p>\n",type:"Number",optional:true}],class:"p5.Envelope",module:"p5.sound"},add:{name:"add",params:[{name:"number",description:"<p>Constant number to add</p>\n",type:"Number"}],class:"p5.Envelope",module:"p5.sound"},mult:{name:"mult",params:[{name:"number",description:"<p>Constant number to multiply</p>\n",type:"Number"}],class:"p5.Envelope",module:"p5.sound"},scale:{name:"scale",params:[{name:"inMin",description:"<p>input range minumum</p>\n",type:"Number"},{name:"inMax",description:"<p>input range maximum</p>\n",type:"Number"},{name:"outMin",description:"<p>input range minumum</p>\n",type:"Number"},{name:"outMax",description:"<p>input range maximum</p>\n",type:"Number"}],class:"p5.Envelope",module:"p5.sound"}},"p5.Noise":{setType:{name:"setType",params:[{name:"type",description:"<p>'white', 'pink' or 'brown'</p>\n",type:"String",optional:true}],class:"p5.Noise",module:"p5.sound"}},"p5.Pulse":{width:{name:"width",params:[{name:"width",description:"<p>Width between the pulses (0 to 1.0,\n                       defaults to 0)</p>\n",type:"Number",optional:true}],class:"p5.Pulse",module:"p5.sound"}},"p5.AudioIn":{input:{name:"input",class:"p5.AudioIn",module:"p5.sound"},output:{name:"output",class:"p5.AudioIn",module:"p5.sound"},stream:{name:"stream",class:"p5.AudioIn",module:"p5.sound"},mediaStream:{name:"mediaStream",class:"p5.AudioIn",module:"p5.sound"},currentSource:{name:"currentSource",class:"p5.AudioIn",module:"p5.sound"},enabled:{name:"enabled",class:"p5.AudioIn",module:"p5.sound"},amplitude:{name:"amplitude",class:"p5.AudioIn",module:"p5.sound"},start:{name:"start",params:[{name:"successCallback",description:"<p>Name of a function to call on\n                                  success.</p>\n",type:"Function",optional:true},{name:"errorCallback",description:"<p>Name of a function to call if\n                                  there was an error. For example,\n                                  some browsers do not support\n                                  getUserMedia.</p>\n",type:"Function",optional:true}],class:"p5.AudioIn",module:"p5.sound"},stop:{name:"stop",class:"p5.AudioIn",module:"p5.sound"},connect:{name:"connect",params:[{name:"unit",description:"<p>An object that accepts audio input,\n                        such as an FFT</p>\n",type:"Object",optional:true}],class:"p5.AudioIn",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.AudioIn",module:"p5.sound"},getLevel:{name:"getLevel",params:[{name:"smoothing",description:"<p>Smoothing is 0.0 by default.\n                             Smooths values based on previous values.</p>\n",type:"Number",optional:true}],class:"p5.AudioIn",module:"p5.sound"},amp:{name:"amp",params:[{name:"vol",description:"<p>between 0 and 1.0</p>\n",type:"Number"},{name:"time",description:"<p>ramp time (optional)</p>\n",type:"Number",optional:true}],class:"p5.AudioIn",module:"p5.sound"},getSources:{name:"getSources",params:[{name:"successCallback",description:"<p>This callback function handles the sources when they\n                                     have been enumerated. The callback function\n                                     receives the deviceList array as its only argument</p>\n",type:"Function",optional:true},{name:"errorCallback",description:"<p>This optional callback receives the error\n                                   message as its argument.</p>\n",type:"Function",optional:true}],class:"p5.AudioIn",module:"p5.sound"},setSource:{name:"setSource",params:[{name:"num",description:"<p>position of input source in the array</p>\n",type:"Number"}],class:"p5.AudioIn",module:"p5.sound"}},"p5.Effect":{amp:{name:"amp",params:[{name:"vol",description:"<p>amplitude between 0 and 1.0</p>\n",type:"Number",optional:true},{name:"rampTime",description:"<p>create a fade that lasts until rampTime</p>\n",type:"Number",optional:true},{name:"tFromNow",description:"<p>schedule this event to happen in tFromNow seconds</p>\n",type:"Number",optional:true}],class:"p5.Effect",module:"p5.sound"},chain:{name:"chain",params:[{name:"arguments",description:"<p>Chain together multiple sound objects</p>\n",type:"Object",optional:true}],class:"p5.Effect",module:"p5.sound"},drywet:{name:"drywet",params:[{name:"fade",description:"<p>The desired drywet value (0 - 1.0)</p>\n",type:"Number",optional:true}],class:"p5.Effect",module:"p5.sound"},connect:{name:"connect",params:[{name:"unit",description:"",type:"Object"}],class:"p5.Effect",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.Effect",module:"p5.sound"}},"p5.Filter":{biquadFilter:{name:"biquadFilter",class:"p5.Filter",module:"p5.sound"},process:{name:"process",params:[{name:"Signal",description:"<p>An object that outputs audio</p>\n",type:"Object"},{name:"freq",description:"<p>Frequency in Hz, from 10 to 22050</p>\n",type:"Number",optional:true},{name:"res",description:"<p>Resonance/Width of the filter frequency\n                      from 0.001 to 1000</p>\n",type:"Number",optional:true}],class:"p5.Filter",module:"p5.sound"},set:{name:"set",params:[{name:"freq",description:"<p>Frequency in Hz, from 10 to 22050</p>\n",type:"Number",optional:true},{name:"res",description:"<p>Resonance (Q) from 0.001 to 1000</p>\n",type:"Number",optional:true},{name:"timeFromNow",description:"<p>schedule this event to happen\n                              seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Filter",module:"p5.sound"},freq:{name:"freq",params:[{name:"freq",description:"<p>Filter Frequency</p>\n",type:"Number"},{name:"timeFromNow",description:"<p>schedule this event to happen\n                              seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Filter",module:"p5.sound"},res:{name:"res",params:[{name:"res",description:"<p>Resonance/Width of filter freq\n                     from 0.001 to 1000</p>\n",type:"Number"},{name:"timeFromNow",description:"<p>schedule this event to happen\n                              seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Filter",module:"p5.sound"},gain:{name:"gain",params:[{name:"gain",description:"",type:"Number"}],class:"p5.Filter",module:"p5.sound"},toggle:{name:"toggle",class:"p5.Filter",module:"p5.sound"},setType:{name:"setType",params:[{name:"t",description:"",type:"String"}],class:"p5.Filter",module:"p5.sound"}},"p5.EQ":{bands:{name:"bands",class:"p5.EQ",module:"p5.sound"},process:{name:"process",params:[{name:"src",description:"<p>Audio source</p>\n",type:"Object"}],class:"p5.EQ",module:"p5.sound"}},"p5.Panner3D":{panner:{name:"panner",class:"p5.Panner3D",module:"p5.sound"},process:{name:"process",params:[{name:"src",description:"<p>Input source</p>\n",type:"Object"}],class:"p5.Panner3D",module:"p5.sound"},set:{name:"set",params:[{name:"xVal",description:"",type:"Number"},{name:"yVal",description:"",type:"Number"},{name:"zVal",description:"",type:"Number"},{name:"time",description:"",type:"Number"}],class:"p5.Panner3D",module:"p5.sound"},positionX:{name:"positionX",class:"p5.Panner3D",module:"p5.sound"},positionY:{name:"positionY",class:"p5.Panner3D",module:"p5.sound"},positionZ:{name:"positionZ",class:"p5.Panner3D",module:"p5.sound"},orient:{name:"orient",params:[{name:"xVal",description:"",type:"Number"},{name:"yVal",description:"",type:"Number"},{name:"zVal",description:"",type:"Number"},{name:"time",description:"",type:"Number"}],class:"p5.Panner3D",module:"p5.sound"},orientX:{name:"orientX",class:"p5.Panner3D",module:"p5.sound"},orientY:{name:"orientY",class:"p5.Panner3D",module:"p5.sound"},orientZ:{name:"orientZ",class:"p5.Panner3D",module:"p5.sound"},setFalloff:{name:"setFalloff",params:[{name:"maxDistance",description:"",type:"Number",optional:true},{name:"rolloffFactor",description:"",type:"Number",optional:true}],class:"p5.Panner3D",module:"p5.sound"},maxDist:{name:"maxDist",params:[{name:"maxDistance",description:"",type:"Number"}],class:"p5.Panner3D",module:"p5.sound"},rollof:{name:"rollof",params:[{name:"rolloffFactor",description:"",type:"Number"}],class:"p5.Panner3D",module:"p5.sound"}},"p5.Delay":{leftDelay:{name:"leftDelay",class:"p5.Delay",module:"p5.sound"},rightDelay:{name:"rightDelay",class:"p5.Delay",module:"p5.sound"},process:{name:"process",params:[{name:"Signal",description:"<p>An object that outputs audio</p>\n",type:"Object"},{name:"delayTime",description:"<p>Time (in seconds) of the delay/echo.\n                             Some browsers limit delayTime to\n                             1 second.</p>\n",type:"Number",optional:true},{name:"feedback",description:"<p>sends the delay back through itself\n                             in a loop that decreases in volume\n                             each time.</p>\n",type:"Number",optional:true},{name:"lowPass",description:"<p>Cutoff frequency. Only frequencies\n                             below the lowPass will be part of the\n                             delay.</p>\n",type:"Number",optional:true}],class:"p5.Delay",module:"p5.sound"},delayTime:{name:"delayTime",params:[{name:"delayTime",description:"<p>Time (in seconds) of the delay</p>\n",type:"Number"}],class:"p5.Delay",module:"p5.sound"},feedback:{name:"feedback",params:[{name:"feedback",description:"<p>0.0 to 1.0, or an object such as an\n                                Oscillator that can be used to\n                                modulate this param</p>\n",type:"Number|Object"}],class:"p5.Delay",module:"p5.sound"},filter:{name:"filter",params:[{name:"cutoffFreq",description:"<p>A lowpass filter will cut off any\n                            frequencies higher than the filter frequency.</p>\n",type:"Number|Object"},{name:"res",description:"<p>Resonance of the filter frequency\n                            cutoff, or an object (i.e. a p5.Oscillator)\n                            that can be used to modulate this parameter.\n                            High numbers (i.e. 15) will produce a resonance,\n                            low numbers (i.e. .2) will produce a slope.</p>\n",type:"Number|Object"}],class:"p5.Delay",module:"p5.sound"},setType:{name:"setType",params:[{name:"type",description:"<p>'pingPong' (1) or 'default' (0)</p>\n",type:"String|Number"}],class:"p5.Delay",module:"p5.sound"},amp:{name:"amp",params:[{name:"volume",description:"<p>amplitude between 0 and 1.0</p>\n",type:"Number"},{name:"rampTime",description:"<p>create a fade that lasts rampTime</p>\n",type:"Number",optional:true},{name:"timeFromNow",description:"<p>schedule this event to happen\n                              seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Delay",module:"p5.sound"},connect:{name:"connect",params:[{name:"unit",description:"",type:"Object"}],class:"p5.Delay",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.Delay",module:"p5.sound"}},"p5.Reverb":{process:{name:"process",params:[{name:"src",description:"<p>p5.sound / Web Audio object with a sound\n                         output.</p>\n",type:"Object"},{name:"seconds",description:"<p>Duration of the reverb, in seconds.\n                         Min: 0, Max: 10. Defaults to 3.</p>\n",type:"Number",optional:true},{name:"decayRate",description:"<p>Percentage of decay with each echo.\n                          Min: 0, Max: 100. Defaults to 2.</p>\n",type:"Number",optional:true},{name:"reverse",description:"<p>Play the reverb backwards or forwards.</p>\n",type:"Boolean",optional:true}],class:"p5.Reverb",module:"p5.sound"},set:{name:"set",params:[{name:"seconds",description:"<p>Duration of the reverb, in seconds.\n                         Min: 0, Max: 10. Defaults to 3.</p>\n",type:"Number",optional:true},{name:"decayRate",description:"<p>Percentage of decay with each echo.\n                          Min: 0, Max: 100. Defaults to 2.</p>\n",type:"Number",optional:true},{name:"reverse",description:"<p>Play the reverb backwards or forwards.</p>\n",type:"Boolean",optional:true}],class:"p5.Reverb",module:"p5.sound"},amp:{name:"amp",params:[{name:"volume",description:"<p>amplitude between 0 and 1.0</p>\n",type:"Number"},{name:"rampTime",description:"<p>create a fade that lasts rampTime</p>\n",type:"Number",optional:true},{name:"timeFromNow",description:"<p>schedule this event to happen\n                              seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Reverb",module:"p5.sound"},connect:{name:"connect",params:[{name:"unit",description:"",type:"Object"}],class:"p5.Reverb",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.Reverb",module:"p5.sound"}},"p5.Convolver":{convolverNode:{name:"convolverNode",class:"p5.Convolver",module:"p5.sound"},impulses:{name:"impulses",class:"p5.Convolver",module:"p5.sound"},process:{name:"process",params:[{name:"src",description:"<p>p5.sound / Web Audio object with a sound\n                         output.</p>\n",type:"Object"}],class:"p5.Convolver",module:"p5.sound"},addImpulse:{name:"addImpulse",params:[{name:"path",description:"<p>path to a sound file</p>\n",type:"String"},{name:"callback",description:"<p>function (optional)</p>\n",type:"Function"},{name:"errorCallback",description:"<p>function (optional)</p>\n",type:"Function"}],class:"p5.Convolver",module:"p5.sound"},resetImpulse:{name:"resetImpulse",params:[{name:"path",description:"<p>path to a sound file</p>\n",type:"String"},{name:"callback",description:"<p>function (optional)</p>\n",type:"Function"},{name:"errorCallback",description:"<p>function (optional)</p>\n",type:"Function"}],class:"p5.Convolver",module:"p5.sound"},toggleImpulse:{name:"toggleImpulse",params:[{name:"id",description:"<p>Identify the impulse by its original filename\n                          (String), or by its position in the\n                          <code>.impulses</code> Array (Number).</p>\n",type:"String|Number"}],class:"p5.Convolver",module:"p5.sound"}},"p5.Phrase":{sequence:{name:"sequence",class:"p5.Phrase",module:"p5.sound"}},"p5.Part":{setBPM:{name:"setBPM",params:[{name:"BPM",description:"<p>Beats Per Minute</p>\n",type:"Number"},{name:"rampTime",description:"<p>Seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Part",module:"p5.sound"},getBPM:{name:"getBPM",class:"p5.Part",module:"p5.sound"},start:{name:"start",params:[{name:"time",description:"<p>seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Part",module:"p5.sound"},loop:{name:"loop",params:[{name:"time",description:"<p>seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Part",module:"p5.sound"},noLoop:{name:"noLoop",class:"p5.Part",module:"p5.sound"},stop:{name:"stop",params:[{name:"time",description:"<p>seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Part",module:"p5.sound"},pause:{name:"pause",params:[{name:"time",description:"<p>seconds from now</p>\n",type:"Number"}],class:"p5.Part",module:"p5.sound"},addPhrase:{name:"addPhrase",params:[{name:"phrase",description:"<p>reference to a p5.Phrase</p>\n",type:"p5.Phrase"}],class:"p5.Part",module:"p5.sound"},removePhrase:{name:"removePhrase",params:[{name:"phraseName",description:"",type:"String"}],class:"p5.Part",module:"p5.sound"},getPhrase:{name:"getPhrase",params:[{name:"phraseName",description:"",type:"String"}],class:"p5.Part",module:"p5.sound"},replaceSequence:{name:"replaceSequence",params:[{name:"phraseName",description:"",type:"String"},{name:"sequence",description:"<p>Array of values to pass into the callback\n                          at each step of the phrase.</p>\n",type:"Array"}],class:"p5.Part",module:"p5.sound"},onStep:{name:"onStep",params:[{name:"callback",description:"<p>The name of the callback\n                            you want to fire\n                            on every beat/tatum.</p>\n",type:"Function"}],class:"p5.Part",module:"p5.sound"}},"p5.Score":{start:{name:"start",class:"p5.Score",module:"p5.sound"},stop:{name:"stop",class:"p5.Score",module:"p5.sound"},pause:{name:"pause",class:"p5.Score",module:"p5.sound"},loop:{name:"loop",class:"p5.Score",module:"p5.sound"},noLoop:{name:"noLoop",class:"p5.Score",module:"p5.sound"},setBPM:{name:"setBPM",params:[{name:"BPM",description:"<p>Beats Per Minute</p>\n",type:"Number"},{name:"rampTime",description:"<p>Seconds from now</p>\n",type:"Number"}],class:"p5.Score",module:"p5.sound"}},"p5.SoundLoop":{bpm:{name:"bpm",class:"p5.SoundLoop",module:"p5.sound"},timeSignature:{name:"timeSignature",class:"p5.SoundLoop",module:"p5.sound"},interval:{name:"interval",class:"p5.SoundLoop",module:"p5.sound"},iterations:{name:"iterations",class:"p5.SoundLoop",module:"p5.sound"},musicalTimeMode:{name:"musicalTimeMode",class:"p5.SoundLoop",module:"p5.sound"},maxIterations:{name:"maxIterations",class:"p5.SoundLoop",module:"p5.sound"},start:{name:"start",params:[{name:"timeFromNow",description:"<p>schedule a starting time</p>\n",type:"Number",optional:true}],class:"p5.SoundLoop",module:"p5.sound"},stop:{name:"stop",params:[{name:"timeFromNow",description:"<p>schedule a stopping time</p>\n",type:"Number",optional:true}],class:"p5.SoundLoop",module:"p5.sound"},pause:{name:"pause",params:[{name:"timeFromNow",description:"<p>schedule a pausing time</p>\n",type:"Number",optional:true}],class:"p5.SoundLoop",module:"p5.sound"},syncedStart:{name:"syncedStart",params:[{name:"otherLoop",description:"<p>a p5.SoundLoop to sync with</p>\n",type:"Object"},{name:"timeFromNow",description:"<p>Start the loops in sync after timeFromNow seconds</p>\n",type:"Number",optional:true}],class:"p5.SoundLoop",module:"p5.sound"}},"p5.Compressor":{compressor:{name:"compressor",class:"p5.Compressor",module:"p5.sound"},process:{name:"process",params:[{name:"src",description:"<p>Sound source to be connected</p>\n",type:"Object"},{name:"attack",description:"<p>The amount of time (in seconds) to reduce the gain by 10dB,\n                           default = .003, range 0 - 1</p>\n",type:"Number",optional:true},{name:"knee",description:'<p>A decibel value representing the range above the\n                           threshold where the curve smoothly transitions to the "ratio" portion.\n                           default = 30, range 0 - 40</p>\n',type:"Number",optional:true},{name:"ratio",description:"<p>The amount of dB change in input for a 1 dB change in output\n                           default = 12, range 1 - 20</p>\n",type:"Number",optional:true},{name:"threshold",description:"<p>The decibel value above which the compression will start taking effect\n                           default = -24, range -100 - 0</p>\n",type:"Number",optional:true},{name:"release",description:"<p>The amount of time (in seconds) to increase the gain by 10dB\n                           default = .25, range 0 - 1</p>\n",type:"Number",optional:true}],class:"p5.Compressor",module:"p5.sound"},set:{name:"set",params:[{name:"attack",description:"<p>The amount of time (in seconds) to reduce the gain by 10dB,\n                           default = .003, range 0 - 1</p>\n",type:"Number"},{name:"knee",description:'<p>A decibel value representing the range above the\n                           threshold where the curve smoothly transitions to the "ratio" portion.\n                           default = 30, range 0 - 40</p>\n',type:"Number"},{name:"ratio",description:"<p>The amount of dB change in input for a 1 dB change in output\n                           default = 12, range 1 - 20</p>\n",type:"Number"},{name:"threshold",description:"<p>The decibel value above which the compression will start taking effect\n                           default = -24, range -100 - 0</p>\n",type:"Number"},{name:"release",description:"<p>The amount of time (in seconds) to increase the gain by 10dB\n                           default = .25, range 0 - 1</p>\n",type:"Number"}],class:"p5.Compressor",module:"p5.sound"},attack:{name:"attack",params:[{name:"attack",description:"<p>Attack is the amount of time (in seconds) to reduce the gain by 10dB,\n                         default = .003, range 0 - 1</p>\n",type:"Number",optional:true},{name:"time",description:"<p>Assign time value to schedule the change in value</p>\n",type:"Number",optional:true}],class:"p5.Compressor",module:"p5.sound"},knee:{name:"knee",params:[{name:"knee",description:'<p>A decibel value representing the range above the\n                       threshold where the curve smoothly transitions to the "ratio" portion.\n                       default = 30, range 0 - 40</p>\n',type:"Number",optional:true},{name:"time",description:"<p>Assign time value to schedule the change in value</p>\n",type:"Number",optional:true}],class:"p5.Compressor",module:"p5.sound"},ratio:{name:"ratio",params:[{name:"ratio",description:"<p>The amount of dB change in input for a 1 dB change in output\n                           default = 12, range 1 - 20</p>\n",type:"Number",optional:true},{name:"time",description:"<p>Assign time value to schedule the change in value</p>\n",type:"Number",optional:true}],class:"p5.Compressor",module:"p5.sound"},threshold:{name:"threshold",params:[{name:"threshold",description:"<p>The decibel value above which the compression will start taking effect\n                           default = -24, range -100 - 0</p>\n",type:"Number"},{name:"time",description:"<p>Assign time value to schedule the change in value</p>\n",type:"Number",optional:true}],class:"p5.Compressor",module:"p5.sound"},release:{name:"release",params:[{name:"release",description:"<p>The amount of time (in seconds) to increase the gain by 10dB\n                           default = .25, range 0 - 1</p>\n",type:"Number"},{name:"time",description:"<p>Assign time value to schedule the change in value</p>\n",type:"Number",optional:true}],class:"p5.Compressor",module:"p5.sound"},reduction:{name:"reduction",class:"p5.Compressor",module:"p5.sound"}},"p5.PeakDetect":{isDetected:{name:"isDetected",class:"p5.PeakDetect",module:"p5.sound"},update:{name:"update",params:[{name:"fftObject",description:"<p>A p5.FFT object</p>\n",type:"p5.FFT"}],class:"p5.PeakDetect",module:"p5.sound"},onPeak:{name:"onPeak",params:[{name:"callback",description:"<p>Name of a function that will\n                            be called when a peak is\n                            detected.</p>\n",type:"Function"},{name:"val",description:"<p>Optional value to pass\n                            into the function when\n                            a peak is detected.</p>\n",type:"Object",optional:true}],class:"p5.PeakDetect",module:"p5.sound"}},"p5.SoundRecorder":{setInput:{name:"setInput",params:[{name:"unit",description:"<p>p5.sound object or a web audio unit\n                       that outputs sound</p>\n",type:"Object",optional:true}],class:"p5.SoundRecorder",module:"p5.sound"},record:{name:"record",params:[{name:"soundFile",description:"<p>p5.SoundFile</p>\n",type:"p5.SoundFile"},{name:"duration",description:"<p>Time (in seconds)</p>\n",type:"Number",optional:true},{name:"callback",description:"<p>The name of a function that will be\n                              called once the recording completes</p>\n",type:"Function",optional:true}],class:"p5.SoundRecorder",module:"p5.sound"},stop:{name:"stop",class:"p5.SoundRecorder",module:"p5.sound"}},"p5.Distortion":{WaveShaperNode:{name:"WaveShaperNode",class:"p5.Distortion",module:"p5.sound"},process:{name:"process",params:[{name:"amount",description:"<p>Unbounded distortion amount.\n                               Normal values range from 0-1.</p>\n",type:"Number",optional:true,optdefault:"0.25"},{name:"oversample",description:"<p>'none', '2x', or '4x'.</p>\n",type:"String",optional:true,optdefault:"'none'"}],class:"p5.Distortion",module:"p5.sound"},set:{name:"set",params:[{name:"amount",description:"<p>Unbounded distortion amount.\n                               Normal values range from 0-1.</p>\n",type:"Number",optional:true,optdefault:"0.25"},{name:"oversample",description:"<p>'none', '2x', or '4x'.</p>\n",type:"String",optional:true,optdefault:"'none'"}],class:"p5.Distortion",module:"p5.sound"},getAmount:{name:"getAmount",class:"p5.Distortion",module:"p5.sound"},getOversample:{name:"getOversample",class:"p5.Distortion",module:"p5.sound"}},"p5.Gain":{setInput:{name:"setInput",params:[{name:"src",description:"<p>p5.sound / Web Audio object with a sound\n                         output.</p>\n",type:"Object"}],class:"p5.Gain",module:"p5.sound"},connect:{name:"connect",params:[{name:"unit",description:"",type:"Object"}],class:"p5.Gain",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.Gain",module:"p5.sound"},amp:{name:"amp",params:[{name:"volume",description:"<p>amplitude between 0 and 1.0</p>\n",type:"Number"},{name:"rampTime",description:"<p>create a fade that lasts rampTime</p>\n",type:"Number",optional:true},{name:"timeFromNow",description:"<p>schedule this event to happen\n                              seconds from now</p>\n",type:"Number",optional:true}],class:"p5.Gain",module:"p5.sound"}},"p5.AudioVoice":{connect:{name:"connect",params:[{name:"unit",description:"",type:"Object"}],class:"p5.AudioVoice",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.AudioVoice",module:"p5.sound"}},"p5.MonoSynth":{attack:{name:"attack",class:"p5.MonoSynth",module:"p5.sound"},decay:{name:"decay",class:"p5.MonoSynth",module:"p5.sound"},sustain:{name:"sustain",class:"p5.MonoSynth",module:"p5.sound"},release:{name:"release",class:"p5.MonoSynth",module:"p5.sound"},play:{name:"play",params:[{name:"note",description:'<p>the note you want to play, specified as a\n                               frequency in Hertz (Number) or as a midi\n                               value in Note/Octave format ("C4", "Eb3"...etc")\n                               See <a href = "https://github.com/Tonejs/Tone.js/wiki/Instruments">\n                               Tone</a>. Defaults to 440 hz.</p>\n',type:"String | Number"},{name:"velocity",description:"<p>velocity of the note to play (ranging from 0 to 1)</p>\n",type:"Number",optional:true},{name:"secondsFromNow",description:"<p>time from now (in seconds) at which to play</p>\n",type:"Number",optional:true},{name:"sustainTime",description:"<p>time to sustain before releasing the envelope. Defaults to 0.15 seconds.</p>\n",type:"Number",optional:true}],class:"p5.MonoSynth",module:"p5.sound"},triggerAttack:{params:[{name:"note",description:'<p>the note you want to play, specified as a\n                               frequency in Hertz (Number) or as a midi\n                               value in Note/Octave format ("C4", "Eb3"...etc")\n                               See <a href = "https://github.com/Tonejs/Tone.js/wiki/Instruments">\n                               Tone</a>. Defaults to 440 hz</p>\n',type:"String | Number"},{name:"velocity",description:"<p>velocity of the note to play (ranging from 0 to 1)</p>\n",type:"Number",optional:true},{name:"secondsFromNow",description:"<p>time from now (in seconds) at which to play</p>\n",type:"Number",optional:true}],name:"triggerAttack",class:"p5.MonoSynth",module:"p5.sound"},triggerRelease:{params:[{name:"secondsFromNow",description:"<p>time to trigger the release</p>\n",type:"Number"}],name:"triggerRelease",class:"p5.MonoSynth",module:"p5.sound"},setADSR:{name:"setADSR",params:[{name:"attackTime",description:"<p>Time (in seconds before envelope\n                              reaches Attack Level</p>\n",type:"Number"},{name:"decayTime",description:"<p>Time (in seconds) before envelope\n                              reaches Decay/Sustain Level</p>\n",type:"Number",optional:true},{name:"susRatio",description:"<p>Ratio between attackLevel and releaseLevel, on a scale from 0 to 1,\n                              where 1.0 = attackLevel, 0.0 = releaseLevel.\n                              The susRatio determines the decayLevel and the level at which the\n                              sustain portion of the envelope will sustain.\n                              For example, if attackLevel is 0.4, releaseLevel is 0,\n                              and susAmt is 0.5, the decayLevel would be 0.2. If attackLevel is\n                              increased to 1.0 (using <code>setRange</code>),\n                              then decayLevel would increase proportionally, to become 0.5.</p>\n",type:"Number",optional:true},{name:"releaseTime",description:"<p>Time in seconds from now (defaults to 0)</p>\n",type:"Number",optional:true}],class:"p5.MonoSynth",module:"p5.sound"},amp:{name:"amp",params:[{name:"vol",description:"<p>desired volume</p>\n",type:"Number"},{name:"rampTime",description:"<p>Time to reach new volume</p>\n",type:"Number",optional:true}],class:"p5.MonoSynth",module:"p5.sound"},connect:{name:"connect",params:[{name:"unit",description:"<p>A p5.sound or Web Audio object</p>\n",type:"Object"}],class:"p5.MonoSynth",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.MonoSynth",module:"p5.sound"},dispose:{name:"dispose",class:"p5.MonoSynth",module:"p5.sound"}},"p5.PolySynth":{notes:{name:"notes",class:"p5.PolySynth",module:"p5.sound"},polyvalue:{name:"polyvalue",class:"p5.PolySynth",module:"p5.sound"},AudioVoice:{name:"AudioVoice",class:"p5.PolySynth",module:"p5.sound"},play:{name:"play",params:[{name:"note",description:"<p>midi note to play (ranging from 0 to 127 - 60 being a middle C)</p>\n",type:"Number",optional:true},{name:"velocity",description:"<p>velocity of the note to play (ranging from 0 to 1)</p>\n",type:"Number",optional:true},{name:"secondsFromNow",description:"<p>time from now (in seconds) at which to play</p>\n",type:"Number",optional:true},{name:"sustainTime",description:"<p>time to sustain before releasing the envelope</p>\n",type:"Number",optional:true}],class:"p5.PolySynth",module:"p5.sound"},noteADSR:{name:"noteADSR",params:[{name:"note",description:"<p>Midi note on which ADSR should be set.</p>\n",type:"Number",optional:true},{name:"attackTime",description:"<p>Time (in seconds before envelope\n                              reaches Attack Level</p>\n",type:"Number",optional:true},{name:"decayTime",description:"<p>Time (in seconds) before envelope\n                              reaches Decay/Sustain Level</p>\n",type:"Number",optional:true},{name:"susRatio",description:"<p>Ratio between attackLevel and releaseLevel, on a scale from 0 to 1,\n                              where 1.0 = attackLevel, 0.0 = releaseLevel.\n                              The susRatio determines the decayLevel and the level at which the\n                              sustain portion of the envelope will sustain.\n                              For example, if attackLevel is 0.4, releaseLevel is 0,\n                              and susAmt is 0.5, the decayLevel would be 0.2. If attackLevel is\n                              increased to 1.0 (using <code>setRange</code>),\n                              then decayLevel would increase proportionally, to become 0.5.</p>\n",type:"Number",optional:true},{name:"releaseTime",description:"<p>Time in seconds from now (defaults to 0)</p>\n",type:"Number",optional:true}],class:"p5.PolySynth",module:"p5.sound"},setADSR:{name:"setADSR",params:[{name:"attackTime",description:"<p>Time (in seconds before envelope\n                               reaches Attack Level</p>\n",type:"Number",optional:true},{name:"decayTime",description:"<p>Time (in seconds) before envelope\n                               reaches Decay/Sustain Level</p>\n",type:"Number",optional:true},{name:"susRatio",description:"<p>Ratio between attackLevel and releaseLevel, on a scale from 0 to 1,\n                               where 1.0 = attackLevel, 0.0 = releaseLevel.\n                               The susRatio determines the decayLevel and the level at which the\n                               sustain portion of the envelope will sustain.\n                               For example, if attackLevel is 0.4, releaseLevel is 0,\n                               and susAmt is 0.5, the decayLevel would be 0.2. If attackLevel is\n                               increased to 1.0 (using <code>setRange</code>),\n                               then decayLevel would increase proportionally, to become 0.5.</p>\n",type:"Number",optional:true},{name:"releaseTime",description:"<p>Time in seconds from now (defaults to 0)</p>\n",type:"Number",optional:true}],class:"p5.PolySynth",module:"p5.sound"},noteAttack:{name:"noteAttack",params:[{name:"note",description:"<p>midi note on which attack should be triggered.</p>\n",type:"Number",optional:true},{name:"velocity",description:"<p>velocity of the note to play (ranging from 0 to 1)/</p>\n",type:"Number",optional:true},{name:"secondsFromNow",description:"<p>time from now (in seconds)</p>\n",type:"Number",optional:true}],class:"p5.PolySynth",module:"p5.sound"},noteRelease:{name:"noteRelease",params:[{name:"note",description:"<p>midi note on which attack should be triggered.\n                                  If no value is provided, all notes will be released.</p>\n",type:"Number",optional:true},{name:"secondsFromNow",description:"<p>time to trigger the release</p>\n",type:"Number",optional:true}],class:"p5.PolySynth",module:"p5.sound"},connect:{name:"connect",params:[{name:"unit",description:"<p>A p5.sound or Web Audio object</p>\n",type:"Object"}],class:"p5.PolySynth",module:"p5.sound"},disconnect:{name:"disconnect",class:"p5.PolySynth",module:"p5.sound"},dispose:{name:"dispose",class:"p5.PolySynth",module:"p5.sound"}}}},{}],2:[function(_dereq_,module,exports){function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}module.exports=_arrayWithHoles},{}],3:[function(_dereq_,module,exports){function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}module.exports=_arrayWithoutHoles},{}],4:[function(_dereq_,module,exports){function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}module.exports=_assertThisInitialized},{}],5:[function(_dereq_,module,exports){function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}module.exports=_classCallCheck},{}],6:[function(_dereq_,module,exports){function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}module.exports=_createClass},{}],7:[function(_dereq_,module,exports){function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}module.exports=_defineProperty},{}],8:[function(_dereq_,module,exports){function _getPrototypeOf(o){module.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}module.exports=_getPrototypeOf},{}],9:[function(_dereq_,module,exports){var setPrototypeOf=_dereq_("./setPrototypeOf");function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)setPrototypeOf(subClass,superClass)}module.exports=_inherits},{"./setPrototypeOf":16}],10:[function(_dereq_,module,exports){function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}module.exports=_iterableToArray},{}],11:[function(_dereq_,module,exports){function _iterableToArrayLimit(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}module.exports=_iterableToArrayLimit},{}],12:[function(_dereq_,module,exports){function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}module.exports=_nonIterableRest},{}],13:[function(_dereq_,module,exports){function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}module.exports=_nonIterableSpread},{}],14:[function(_dereq_,module,exports){var defineProperty=_dereq_("./defineProperty");function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){defineProperty(target,key,source[key])})}return target}module.exports=_objectSpread},{"./defineProperty":7}],15:[function(_dereq_,module,exports){var _typeof=_dereq_("../helpers/typeof");var assertThisInitialized=_dereq_("./assertThisInitialized");function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return assertThisInitialized(self)}module.exports=_possibleConstructorReturn},{"../helpers/typeof":19,"./assertThisInitialized":4}],16:[function(_dereq_,module,exports){function _setPrototypeOf(o,p){module.exports=_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}module.exports=_setPrototypeOf},{}],17:[function(_dereq_,module,exports){var arrayWithHoles=_dereq_("./arrayWithHoles");var iterableToArrayLimit=_dereq_("./iterableToArrayLimit");var nonIterableRest=_dereq_("./nonIterableRest");function _slicedToArray(arr,i){return arrayWithHoles(arr)||iterableToArrayLimit(arr,i)||nonIterableRest()}module.exports=_slicedToArray},{"./arrayWithHoles":2,"./iterableToArrayLimit":11,"./nonIterableRest":12}],18:[function(_dereq_,module,exports){var arrayWithoutHoles=_dereq_("./arrayWithoutHoles");var iterableToArray=_dereq_("./iterableToArray");var nonIterableSpread=_dereq_("./nonIterableSpread");function _toConsumableArray(arr){return arrayWithoutHoles(arr)||iterableToArray(arr)||nonIterableSpread()}module.exports=_toConsumableArray},{"./arrayWithoutHoles":3,"./iterableToArray":10,"./nonIterableSpread":13}],19:[function(_dereq_,module,exports){function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){module.exports=_typeof=function _typeof(obj){return _typeof2(obj)}}else{module.exports=_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}module.exports=_typeof},{}],20:[function(_dereq_,module,exports){"use strict";exports.byteLength=byteLength;exports.toByteArray=toByteArray;exports.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i];revLookup[code.charCodeAt(i)]=i}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(b64){var len=b64.length;if(len%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var validLen=b64.indexOf("=");if(validLen===-1)validLen=len;var placeHoldersLen=validLen===len?0:4-validLen%4;return[validLen,placeHoldersLen]}function byteLength(b64){var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function _byteLength(b64,validLen,placeHoldersLen){return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function toByteArray(b64){var tmp;var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];var arr=new Arr(_byteLength(b64,validLen,placeHoldersLen));var curByte=0;var len=placeHoldersLen>0?validLen-4:validLen;var i;for(i=0;i<len;i+=4){tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)];arr[curByte++]=tmp>>16&255;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}if(placeHoldersLen===2){tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4;arr[curByte++]=tmp&255}if(placeHoldersLen===1){tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i=start;i<end;i+=3){tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(uint8[i+2]&255);output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){var tmp;var len=uint8.length;var extraBytes=len%3;var parts=[];var maxChunkLength=16383;for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength))}if(extraBytes===1){tmp=uint8[len-1];parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1];parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"=")}return parts.join("")}},{}],21:[function(_dereq_,module,exports){},{}],22:[function(_dereq_,module,exports){(function(Buffer){"use strict";var base64=_dereq_("base64-js");var ieee754=_dereq_("ieee754");var customInspectSymbol=typeof Symbol==="function"&&typeof Symbol.for==="function"?Symbol.for("nodejs.util.inspect.custom"):null;exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function typedArraySupport(){try{var arr=new Uint8Array(1);var proto={foo:function(){return 42}};Object.setPrototypeOf(proto,Uint8Array.prototype);Object.setPrototypeOf(arr,proto);return arr.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,"parent",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(Buffer.prototype,"offset",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.byteOffset}});function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError('The value "'+length+'" is invalid for option "size"')}var buf=new Uint8Array(length);Object.setPrototypeOf(buf,Buffer.prototype);return buf}function Buffer(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}Buffer.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="string"){return fromString(value,encodingOrOffset)}if(ArrayBuffer.isView(value)){return fromArrayLike(value)}if(value==null){throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer)){return fromArrayBuffer(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var valueOf=value.valueOf&&value.valueOf();if(valueOf!=null&&valueOf!==value){return Buffer.from(valueOf,encodingOrOffset,length)}var b=fromObject(value);if(b)return b;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof value[Symbol.toPrimitive]==="function"){return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)};Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype);Object.setPrototypeOf(Buffer,Uint8Array);function assertSize(size){if(typeof size!=="number"){throw new TypeError('"size" argument must be of type number')}else if(size<0){throw new RangeError('The value "'+size+'" is invalid for option "size"')}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size)}if(fill!==undefined){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}return createBuffer(size)}Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0)}Buffer.allocUnsafe=function(size){return allocUnsafe(size)};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i=0;i<length;i+=1){buf[i]=array[i]&255}return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError('"offset" is outside of buffer bounds')}if(array.byteLength<byteOffset+(length||0)){throw new RangeError('"length" is outside of buffer bounds')}var buf;if(byteOffset===undefined&&length===undefined){buf=new Uint8Array(array)}else if(length===undefined){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}Object.setPrototypeOf(buf,Buffer.prototype);return buf}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf}obj.copy(buf,0,0,len);return buf}if(obj.length!==undefined){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0)}return fromArrayLike(obj)}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer.alloc(+length)}Buffer.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true&&b!==Buffer.prototype};Buffer.compare=function compare(a,b){if(isInstance(a,Uint8Array))a=Buffer.from(a,a.offset,a.byteLength);if(isInstance(b,Uint8Array))b=Buffer.from(b,b.offset,b.byteLength);if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(a===b)return 0;var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers')}if(list.length===0){return Buffer.alloc(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;++i){length+=list[i].length}}var buffer=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array)){buf=Buffer.from(buf)}if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length}if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer)){return string.byteLength}if(typeof string!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof string)}var len=string.length;var mustMatch=arguments.length>2&&arguments[2]===true;if(!mustMatch&&len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase){return mustMatch?-1:utf8ToBytes(string).length}encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===undefined||start<0){start=0}if(start>this.length){return""}if(end===undefined||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype._isBuffer=true;function swap(b,n,m){var i=b[n];b[n]=b[m];b[m]=i}Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i=0;i<len;i+=2){swap(this,i,i+1)}return this};Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i=0;i<len;i+=4){swap(this,i,i+3);swap(this,i+1,i+2)}return this};Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i=0;i<len;i+=8){swap(this,i,i+7);swap(this,i+1,i+6);swap(this,i+2,i+5);swap(this,i+3,i+4)}return this};Buffer.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim();if(this.length>max)str+=" ... ";return"<Buffer "+str+">"};if(customInspectSymbol){Buffer.prototype[customInspectSymbol]=Buffer.prototype.inspect}Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)){target=Buffer.from(target,target.offset,target.byteLength)}if(!Buffer.isBuffer(target)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof target)}if(start===undefined){start=0}if(end===undefined){end=target?target.length:0}if(thisStart===undefined){thisStart=0}if(thisEnd===undefined){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart;var y=end-start;var len=Math.min(x,y);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i];y=targetCopy[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0;else return-1}if(typeof val==="string"){val=Buffer.from(val,encoding)}if(Buffer.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==undefined){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i){if(indexSize===1){return buf[i]}else{return buf.readUInt16BE(i*indexSize)}}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i-=i-foundIndex;foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i=byteOffset;i>=0;i--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i+j)!==read(val,j)){found=false;break}}if(found)return i}}return-1}Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(length>strLen/2){length=strLen/2}for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&127)}return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;++i){out+=hexSliceLookupTable[buf[i]]}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf=this.subarray(start,end);Object.setPrototypeOf(newBuf,Buffer.prototype);return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1};Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;if(this===target&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(targetStart,start,end)}else if(this===target&&start<targetStart&&targetStart<end){for(var i=len-1;i>=0;--i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart)}return len};Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(encoding!==undefined&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}if(val.length===1){var code=val.charCodeAt(0);if(encoding==="utf8"&&code<128||encoding==="latin1"){val=code}}}else if(typeof val==="number"){val=val&255}else if(typeof val==="boolean"){val=Number(val)}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===undefined?this.length:end>>>0;if(!val)val=0;var i;if(typeof val==="number"){for(i=start;i<end;++i){this[i]=val}}else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding);var len=bytes.length;if(len===0){throw new TypeError('The value "'+val+'" is invalid for argument "value"')}for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str){str=str.split("=")[0];str=str.trim().replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;++i){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;++i){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function isInstance(obj,type){return obj instanceof type||obj!=null&&obj.constructor!=null&&obj.constructor.name!=null&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!==obj}var hexSliceLookupTable=function(){var alphabet="0123456789abcdef";var table=new Array(256);for(var i=0;i<16;++i){var i16=i*16;for(var j=0;j<16;++j){table[i16+j]=alphabet[i]+alphabet[j]}}return table}()}).call(this,_dereq_("buffer").Buffer)},{"base64-js":20,buffer:22,ieee754:268}],23:[function(_dereq_,module,exports){module.exports=function(it){if(typeof it!="function"){throw TypeError(String(it)+" is not a function")}return it}},{}],24:[function(_dereq_,module,exports){var isObject=_dereq_("../internals/is-object");module.exports=function(it){if(!isObject(it)&&it!==null){throw TypeError("Can't set "+String(it)+" as a prototype")}return it}},{"../internals/is-object":92}],25:[function(_dereq_,module,exports){var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var create=_dereq_("../internals/object-create");var definePropertyModule=_dereq_("../internals/object-define-property");var UNSCOPABLES=wellKnownSymbol("unscopables");var ArrayPrototype=Array.prototype;if(ArrayPrototype[UNSCOPABLES]==undefined){definePropertyModule.f(ArrayPrototype,UNSCOPABLES,{configurable:true,value:create(null)})}module.exports=function(key){ArrayPrototype[UNSCOPABLES][key]=true}},{"../internals/object-create":108,"../internals/object-define-property":110,"../internals/well-known-symbol":166}],26:[function(_dereq_,module,exports){"use strict";var charAt=_dereq_("../internals/string-multibyte").charAt;module.exports=function(S,index,unicode){return index+(unicode?charAt(S,index).length:1)}},{"../internals/string-multibyte":141}],27:[function(_dereq_,module,exports){module.exports=function(it,Constructor,name){if(!(it instanceof Constructor)){throw TypeError("Incorrect "+(name?name+" ":"")+"invocation")}return it}},{}],28:[function(_dereq_,module,exports){var isObject=_dereq_("../internals/is-object");module.exports=function(it){if(!isObject(it)){throw TypeError(String(it)+" is not an object")}return it}},{"../internals/is-object":92}],29:[function(_dereq_,module,exports){module.exports=typeof ArrayBuffer!=="undefined"&&typeof DataView!=="undefined"},{}],30:[function(_dereq_,module,exports){"use strict";var NATIVE_ARRAY_BUFFER=_dereq_("../internals/array-buffer-native");var DESCRIPTORS=_dereq_("../internals/descriptors");var global=_dereq_("../internals/global");var isObject=_dereq_("../internals/is-object");var has=_dereq_("../internals/has");var classof=_dereq_("../internals/classof");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var redefine=_dereq_("../internals/redefine");var defineProperty=_dereq_("../internals/object-define-property").f;var getPrototypeOf=_dereq_("../internals/object-get-prototype-of");var setPrototypeOf=_dereq_("../internals/object-set-prototype-of");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var uid=_dereq_("../internals/uid");var Int8Array=global.Int8Array;var Int8ArrayPrototype=Int8Array&&Int8Array.prototype;var Uint8ClampedArray=global.Uint8ClampedArray;var Uint8ClampedArrayPrototype=Uint8ClampedArray&&Uint8ClampedArray.prototype;var TypedArray=Int8Array&&getPrototypeOf(Int8Array);var TypedArrayPrototype=Int8ArrayPrototype&&getPrototypeOf(Int8ArrayPrototype);var ObjectPrototype=Object.prototype;var isPrototypeOf=ObjectPrototype.isPrototypeOf;var TO_STRING_TAG=wellKnownSymbol("toStringTag");var TYPED_ARRAY_TAG=uid("TYPED_ARRAY_TAG");var NATIVE_ARRAY_BUFFER_VIEWS=NATIVE_ARRAY_BUFFER&&!!setPrototypeOf&&classof(global.opera)!=="Opera";var TYPED_ARRAY_TAG_REQIRED=false;var NAME;var TypedArrayConstructorsList={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};var isView=function isView(it){var klass=classof(it);return klass==="DataView"||has(TypedArrayConstructorsList,klass)};var isTypedArray=function(it){return isObject(it)&&has(TypedArrayConstructorsList,classof(it))};var aTypedArray=function(it){if(isTypedArray(it))return it;throw TypeError("Target is not a typed array")};var aTypedArrayConstructor=function(C){if(setPrototypeOf){if(isPrototypeOf.call(TypedArray,C))return C}else for(var ARRAY in TypedArrayConstructorsList)if(has(TypedArrayConstructorsList,NAME)){var TypedArrayConstructor=global[ARRAY];if(TypedArrayConstructor&&(C===TypedArrayConstructor||isPrototypeOf.call(TypedArrayConstructor,C))){return C}}throw TypeError("Target is not a typed array constructor")};var exportTypedArrayMethod=function(KEY,property,forced){if(!DESCRIPTORS)return;if(forced)for(var ARRAY in TypedArrayConstructorsList){var TypedArrayConstructor=global[ARRAY];if(TypedArrayConstructor&&has(TypedArrayConstructor.prototype,KEY)){delete TypedArrayConstructor.prototype[KEY]}}if(!TypedArrayPrototype[KEY]||forced){redefine(TypedArrayPrototype,KEY,forced?property:NATIVE_ARRAY_BUFFER_VIEWS&&Int8ArrayPrototype[KEY]||property)}};var exportTypedArrayStaticMethod=function(KEY,property,forced){var ARRAY,TypedArrayConstructor;if(!DESCRIPTORS)return;if(setPrototypeOf){if(forced)for(ARRAY in TypedArrayConstructorsList){TypedArrayConstructor=global[ARRAY];if(TypedArrayConstructor&&has(TypedArrayConstructor,KEY)){delete TypedArrayConstructor[KEY]}}if(!TypedArray[KEY]||forced){try{return redefine(TypedArray,KEY,forced?property:NATIVE_ARRAY_BUFFER_VIEWS&&Int8Array[KEY]||property)}catch(error){}}else return}for(ARRAY in TypedArrayConstructorsList){TypedArrayConstructor=global[ARRAY];if(TypedArrayConstructor&&(!TypedArrayConstructor[KEY]||forced)){redefine(TypedArrayConstructor,KEY,property)}}};for(NAME in TypedArrayConstructorsList){if(!global[NAME])NATIVE_ARRAY_BUFFER_VIEWS=false}if(!NATIVE_ARRAY_BUFFER_VIEWS||typeof TypedArray!="function"||TypedArray===Function.prototype){TypedArray=function TypedArray(){throw TypeError("Incorrect invocation")};if(NATIVE_ARRAY_BUFFER_VIEWS)for(NAME in TypedArrayConstructorsList){if(global[NAME])setPrototypeOf(global[NAME],TypedArray)}}if(!NATIVE_ARRAY_BUFFER_VIEWS||!TypedArrayPrototype||TypedArrayPrototype===ObjectPrototype){TypedArrayPrototype=TypedArray.prototype;if(NATIVE_ARRAY_BUFFER_VIEWS)for(NAME in TypedArrayConstructorsList){if(global[NAME])setPrototypeOf(global[NAME].prototype,TypedArrayPrototype)}}if(NATIVE_ARRAY_BUFFER_VIEWS&&getPrototypeOf(Uint8ClampedArrayPrototype)!==TypedArrayPrototype){setPrototypeOf(Uint8ClampedArrayPrototype,TypedArrayPrototype)}if(DESCRIPTORS&&!has(TypedArrayPrototype,TO_STRING_TAG)){TYPED_ARRAY_TAG_REQIRED=true;defineProperty(TypedArrayPrototype,TO_STRING_TAG,{get:function(){return isObject(this)?this[TYPED_ARRAY_TAG]:undefined}});for(NAME in TypedArrayConstructorsList)if(global[NAME]){createNonEnumerableProperty(global[NAME],TYPED_ARRAY_TAG,NAME)}}module.exports={NATIVE_ARRAY_BUFFER_VIEWS:NATIVE_ARRAY_BUFFER_VIEWS,TYPED_ARRAY_TAG:TYPED_ARRAY_TAG_REQIRED&&TYPED_ARRAY_TAG,aTypedArray:aTypedArray,aTypedArrayConstructor:aTypedArrayConstructor,exportTypedArrayMethod:exportTypedArrayMethod,exportTypedArrayStaticMethod:exportTypedArrayStaticMethod,isView:isView,isTypedArray:isTypedArray,TypedArray:TypedArray,TypedArrayPrototype:TypedArrayPrototype}},{"../internals/array-buffer-native":29,"../internals/classof":47,"../internals/create-non-enumerable-property":56,"../internals/descriptors":61,"../internals/global":77,"../internals/has":78,"../internals/is-object":92,"../internals/object-define-property":110,"../internals/object-get-prototype-of":115,"../internals/object-set-prototype-of":119,"../internals/redefine":126,"../internals/uid":163,"../internals/well-known-symbol":166}],31:[function(_dereq_,module,exports){"use strict";var global=_dereq_("../internals/global");var DESCRIPTORS=_dereq_("../internals/descriptors");var NATIVE_ARRAY_BUFFER=_dereq_("../internals/array-buffer-native");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var redefineAll=_dereq_("../internals/redefine-all");var fails=_dereq_("../internals/fails");var anInstance=_dereq_("../internals/an-instance");var toInteger=_dereq_("../internals/to-integer");var toLength=_dereq_("../internals/to-length");var toIndex=_dereq_("../internals/to-index");var IEEE754=_dereq_("../internals/ieee754");var getPrototypeOf=_dereq_("../internals/object-get-prototype-of");var setPrototypeOf=_dereq_("../internals/object-set-prototype-of");var getOwnPropertyNames=_dereq_("../internals/object-get-own-property-names").f;var defineProperty=_dereq_("../internals/object-define-property").f;var arrayFill=_dereq_("../internals/array-fill");var setToStringTag=_dereq_("../internals/set-to-string-tag");var InternalStateModule=_dereq_("../internals/internal-state");var getInternalState=InternalStateModule.get;var setInternalState=InternalStateModule.set;var ARRAY_BUFFER="ArrayBuffer";var DATA_VIEW="DataView";var PROTOTYPE="prototype";var WRONG_LENGTH="Wrong length";var WRONG_INDEX="Wrong index";var NativeArrayBuffer=global[ARRAY_BUFFER];var $ArrayBuffer=NativeArrayBuffer;var $DataView=global[DATA_VIEW];var $DataViewPrototype=$DataView&&$DataView[PROTOTYPE];var ObjectPrototype=Object.prototype;var RangeError=global.RangeError;var packIEEE754=IEEE754.pack;var unpackIEEE754=IEEE754.unpack;var packInt8=function(number){return[number&255]};var packInt16=function(number){return[number&255,number>>8&255]};var packInt32=function(number){return[number&255,number>>8&255,number>>16&255,number>>24&255]};var unpackInt32=function(buffer){return buffer[3]<<24|buffer[2]<<16|buffer[1]<<8|buffer[0]};var packFloat32=function(number){return packIEEE754(number,23,4)};var packFloat64=function(number){return packIEEE754(number,52,8)};var addGetter=function(Constructor,key){defineProperty(Constructor[PROTOTYPE],key,{get:function(){return getInternalState(this)[key]}})};var get=function(view,count,index,isLittleEndian){var intIndex=toIndex(index);var store=getInternalState(view);if(intIndex+count>store.byteLength)throw RangeError(WRONG_INDEX);var bytes=getInternalState(store.buffer).bytes;var start=intIndex+store.byteOffset;var pack=bytes.slice(start,start+count);return isLittleEndian?pack:pack.reverse()};var set=function(view,count,index,conversion,value,isLittleEndian){var intIndex=toIndex(index);var store=getInternalState(view);if(intIndex+count>store.byteLength)throw RangeError(WRONG_INDEX);var bytes=getInternalState(store.buffer).bytes;var start=intIndex+store.byteOffset;var pack=conversion(+value);for(var i=0;i<count;i++)bytes[start+i]=pack[isLittleEndian?i:count-i-1]};if(!NATIVE_ARRAY_BUFFER){$ArrayBuffer=function ArrayBuffer(length){anInstance(this,$ArrayBuffer,ARRAY_BUFFER);var byteLength=toIndex(length);setInternalState(this,{bytes:arrayFill.call(new Array(byteLength),0),byteLength:byteLength});if(!DESCRIPTORS)this.byteLength=byteLength};$DataView=function DataView(buffer,byteOffset,byteLength){anInstance(this,$DataView,DATA_VIEW);anInstance(buffer,$ArrayBuffer,DATA_VIEW);var bufferLength=getInternalState(buffer).byteLength;var offset=toInteger(byteOffset);if(offset<0||offset>bufferLength)throw RangeError("Wrong offset");byteLength=byteLength===undefined?bufferLength-offset:toLength(byteLength);if(offset+byteLength>bufferLength)throw RangeError(WRONG_LENGTH);setInternalState(this,{buffer:buffer,byteLength:byteLength,byteOffset:offset});if(!DESCRIPTORS){this.buffer=buffer;this.byteLength=byteLength;this.byteOffset=offset}};if(DESCRIPTORS){addGetter($ArrayBuffer,"byteLength");addGetter($DataView,"buffer");addGetter($DataView,"byteLength");addGetter($DataView,"byteOffset")}redefineAll($DataView[PROTOTYPE],{getInt8:function getInt8(byteOffset){return get(this,1,byteOffset)[0]<<24>>24},getUint8:function getUint8(byteOffset){return get(this,1,byteOffset)[0]},getInt16:function getInt16(byteOffset){var bytes=get(this,2,byteOffset,arguments.length>1?arguments[1]:undefined);return(bytes[1]<<8|bytes[0])<<16>>16},getUint16:function getUint16(byteOffset){var bytes=get(this,2,byteOffset,arguments.length>1?arguments[1]:undefined);return bytes[1]<<8|bytes[0]},getInt32:function getInt32(byteOffset){return unpackInt32(get(this,4,byteOffset,arguments.length>1?arguments[1]:undefined))},getUint32:function getUint32(byteOffset){return unpackInt32(get(this,4,byteOffset,arguments.length>1?arguments[1]:undefined))>>>0},getFloat32:function getFloat32(byteOffset){return unpackIEEE754(get(this,4,byteOffset,arguments.length>1?arguments[1]:undefined),23)},getFloat64:function getFloat64(byteOffset){return unpackIEEE754(get(this,8,byteOffset,arguments.length>1?arguments[1]:undefined),52)},setInt8:function setInt8(byteOffset,value){set(this,1,byteOffset,packInt8,value)},setUint8:function setUint8(byteOffset,value){set(this,1,byteOffset,packInt8,value)},setInt16:function setInt16(byteOffset,value){set(this,2,byteOffset,packInt16,value,arguments.length>2?arguments[2]:undefined)},setUint16:function setUint16(byteOffset,value){set(this,2,byteOffset,packInt16,value,arguments.length>2?arguments[2]:undefined)},setInt32:function setInt32(byteOffset,value){set(this,4,byteOffset,packInt32,value,arguments.length>2?arguments[2]:undefined)},setUint32:function setUint32(byteOffset,value){set(this,4,byteOffset,packInt32,value,arguments.length>2?arguments[2]:undefined)},setFloat32:function setFloat32(byteOffset,value){set(this,4,byteOffset,packFloat32,value,arguments.length>2?arguments[2]:undefined)},setFloat64:function setFloat64(byteOffset,value){set(this,8,byteOffset,packFloat64,value,arguments.length>2?arguments[2]:undefined)}})}else{if(!fails(function(){NativeArrayBuffer(1)})||!fails(function(){new NativeArrayBuffer(-1)})||fails(function(){new NativeArrayBuffer;new NativeArrayBuffer(1.5);new NativeArrayBuffer(NaN);return NativeArrayBuffer.name!=ARRAY_BUFFER})){$ArrayBuffer=function ArrayBuffer(length){anInstance(this,$ArrayBuffer);return new NativeArrayBuffer(toIndex(length))};var ArrayBufferPrototype=$ArrayBuffer[PROTOTYPE]=NativeArrayBuffer[PROTOTYPE];for(var keys=getOwnPropertyNames(NativeArrayBuffer),j=0,key;keys.length>j;){if(!((key=keys[j++])in $ArrayBuffer)){createNonEnumerableProperty($ArrayBuffer,key,NativeArrayBuffer[key])}}ArrayBufferPrototype.constructor=$ArrayBuffer}if(setPrototypeOf&&getPrototypeOf($DataViewPrototype)!==ObjectPrototype){setPrototypeOf($DataViewPrototype,ObjectPrototype)}var testView=new $DataView(new $ArrayBuffer(2));var nativeSetInt8=$DataViewPrototype.setInt8;testView.setInt8(0,2147483648);testView.setInt8(1,2147483649);if(testView.getInt8(0)||!testView.getInt8(1))redefineAll($DataViewPrototype,{setInt8:function setInt8(byteOffset,value){nativeSetInt8.call(this,byteOffset,value<<24>>24)},setUint8:function setUint8(byteOffset,value){nativeSetInt8.call(this,byteOffset,value<<24>>24)}},{unsafe:true})}setToStringTag($ArrayBuffer,ARRAY_BUFFER);setToStringTag($DataView,DATA_VIEW);module.exports={ArrayBuffer:$ArrayBuffer,DataView:$DataView}},{"../internals/an-instance":27,"../internals/array-buffer-native":29,"../internals/array-fill":33,"../internals/create-non-enumerable-property":56,"../internals/descriptors":61,"../internals/fails":69,"../internals/global":77,"../internals/ieee754":83,"../internals/internal-state":88,"../internals/object-define-property":110,"../internals/object-get-own-property-names":113,"../internals/object-get-prototype-of":115,"../internals/object-set-prototype-of":119,"../internals/redefine-all":125,"../internals/set-to-string-tag":135,"../internals/to-index":151,"../internals/to-integer":153,"../internals/to-length":154}],32:[function(_dereq_,module,exports){"use strict";var toObject=_dereq_("../internals/to-object");var toAbsoluteIndex=_dereq_("../internals/to-absolute-index");var toLength=_dereq_("../internals/to-length");var min=Math.min;module.exports=[].copyWithin||function copyWithin(target,start){var O=toObject(this);var len=toLength(O.length);var to=toAbsoluteIndex(target,len);var from=toAbsoluteIndex(start,len);var end=arguments.length>2?arguments[2]:undefined;var count=min((end===undefined?len:toAbsoluteIndex(end,len))-from,len-to);var inc=1;if(from<to&&to<from+count){inc=-1;from+=count-1;to+=count-1}while(count-- >0){if(from in O)O[to]=O[from];else delete O[to];to+=inc;from+=inc}return O}},{"../internals/to-absolute-index":150,"../internals/to-length":154,"../internals/to-object":155}],33:[function(_dereq_,module,exports){"use strict";var toObject=_dereq_("../internals/to-object");var toAbsoluteIndex=_dereq_("../internals/to-absolute-index");var toLength=_dereq_("../internals/to-length");module.exports=function fill(value){var O=toObject(this);var length=toLength(O.length);var argumentsLength=arguments.length;var index=toAbsoluteIndex(argumentsLength>1?arguments[1]:undefined,length);var end=argumentsLength>2?arguments[2]:undefined;var endPos=end===undefined?length:toAbsoluteIndex(end,length);while(endPos>index)O[index++]=value;return O}},{"../internals/to-absolute-index":150,"../internals/to-length":154,"../internals/to-object":155}],34:[function(_dereq_,module,exports){"use strict";var $forEach=_dereq_("../internals/array-iteration").forEach;var arrayMethodIsStrict=_dereq_("../internals/array-method-is-strict");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var STRICT_METHOD=arrayMethodIsStrict("forEach");var USES_TO_LENGTH=arrayMethodUsesToLength("forEach");module.exports=!STRICT_METHOD||!USES_TO_LENGTH?function forEach(callbackfn){return $forEach(this,callbackfn,arguments.length>1?arguments[1]:undefined)}:[].forEach},{"../internals/array-iteration":37,"../internals/array-method-is-strict":40,"../internals/array-method-uses-to-length":41}],35:[function(_dereq_,module,exports){"use strict";var bind=_dereq_("../internals/function-bind-context");var toObject=_dereq_("../internals/to-object");var callWithSafeIterationClosing=_dereq_("../internals/call-with-safe-iteration-closing");var isArrayIteratorMethod=_dereq_("../internals/is-array-iterator-method");var toLength=_dereq_("../internals/to-length");var createProperty=_dereq_("../internals/create-property");var getIteratorMethod=_dereq_("../internals/get-iterator-method");module.exports=function from(arrayLike){var O=toObject(arrayLike);var C=typeof this=="function"?this:Array;var argumentsLength=arguments.length;var mapfn=argumentsLength>1?arguments[1]:undefined;var mapping=mapfn!==undefined;var iteratorMethod=getIteratorMethod(O);var index=0;var length,result,step,iterator,next,value;if(mapping)mapfn=bind(mapfn,argumentsLength>2?arguments[2]:undefined,2);if(iteratorMethod!=undefined&&!(C==Array&&isArrayIteratorMethod(iteratorMethod))){iterator=iteratorMethod.call(O);next=iterator.next;result=new C;for(;!(step=next.call(iterator)).done;index++){value=mapping?callWithSafeIterationClosing(iterator,mapfn,[step.value,index],true):step.value;createProperty(result,index,value)}}else{length=toLength(O.length);result=new C(length);for(;length>index;index++){value=mapping?mapfn(O[index],index):O[index];createProperty(result,index,value)}}result.length=index;return result}},{"../internals/call-with-safe-iteration-closing":44,"../internals/create-property":58,"../internals/function-bind-context":72,"../internals/get-iterator-method":75,"../internals/is-array-iterator-method":89,"../internals/to-length":154,"../internals/to-object":155}],36:[function(_dereq_,module,exports){var toIndexedObject=_dereq_("../internals/to-indexed-object");var toLength=_dereq_("../internals/to-length");var toAbsoluteIndex=_dereq_("../internals/to-absolute-index");var createMethod=function(IS_INCLUDES){return function($this,el,fromIndex){var O=toIndexedObject($this);var length=toLength(O.length);var index=toAbsoluteIndex(fromIndex,length);var value;if(IS_INCLUDES&&el!=el)while(length>index){value=O[index++];if(value!=value)return true}else for(;length>index;index++){if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0}return!IS_INCLUDES&&-1}};module.exports={includes:createMethod(true),indexOf:createMethod(false)}},{"../internals/to-absolute-index":150,"../internals/to-indexed-object":152,"../internals/to-length":154}],37:[function(_dereq_,module,exports){var bind=_dereq_("../internals/function-bind-context");var IndexedObject=_dereq_("../internals/indexed-object");var toObject=_dereq_("../internals/to-object");var toLength=_dereq_("../internals/to-length");var arraySpeciesCreate=_dereq_("../internals/array-species-create");var push=[].push;var createMethod=function(TYPE){var IS_MAP=TYPE==1;var IS_FILTER=TYPE==2;var IS_SOME=TYPE==3;var IS_EVERY=TYPE==4;var IS_FIND_INDEX=TYPE==6;var NO_HOLES=TYPE==5||IS_FIND_INDEX;return function($this,callbackfn,that,specificCreate){var O=toObject($this);var self=IndexedObject(O);var boundFunction=bind(callbackfn,that,3);var length=toLength(self.length);var index=0;var create=specificCreate||arraySpeciesCreate;var target=IS_MAP?create($this,length):IS_FILTER?create($this,0):undefined;var value,result;for(;length>index;index++)if(NO_HOLES||index in self){value=self[index];result=boundFunction(value,index,O);if(TYPE){if(IS_MAP)target[index]=result;else if(result)switch(TYPE){case 3:return true;case 5:return value;case 6:return index;case 2:push.call(target,value)}else if(IS_EVERY)return false}}return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:target}};module.exports={forEach:createMethod(0),map:createMethod(1),filter:createMethod(2),some:createMethod(3),every:createMethod(4),find:createMethod(5),findIndex:createMethod(6)}},{"../internals/array-species-create":43,"../internals/function-bind-context":72,"../internals/indexed-object":84,"../internals/to-length":154,"../internals/to-object":155}],38:[function(_dereq_,module,exports){"use strict";var toIndexedObject=_dereq_("../internals/to-indexed-object");var toInteger=_dereq_("../internals/to-integer");var toLength=_dereq_("../internals/to-length");var arrayMethodIsStrict=_dereq_("../internals/array-method-is-strict");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var min=Math.min;var nativeLastIndexOf=[].lastIndexOf;var NEGATIVE_ZERO=!!nativeLastIndexOf&&1/[1].lastIndexOf(1,-0)<0;var STRICT_METHOD=arrayMethodIsStrict("lastIndexOf");var USES_TO_LENGTH=arrayMethodUsesToLength("indexOf",{ACCESSORS:true,1:0});var FORCED=NEGATIVE_ZERO||!STRICT_METHOD||!USES_TO_LENGTH;module.exports=FORCED?function lastIndexOf(searchElement){if(NEGATIVE_ZERO)return nativeLastIndexOf.apply(this,arguments)||0;var O=toIndexedObject(this);var length=toLength(O.length);var index=length-1;if(arguments.length>1)index=min(index,toInteger(arguments[1]));if(index<0)index=length+index;for(;index>=0;index--)if(index in O&&O[index]===searchElement)return index||0;return-1}:nativeLastIndexOf},{"../internals/array-method-is-strict":40,"../internals/array-method-uses-to-length":41,"../internals/to-indexed-object":152,"../internals/to-integer":153,"../internals/to-length":154}],39:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var V8_VERSION=_dereq_("../internals/engine-v8-version");var SPECIES=wellKnownSymbol("species");module.exports=function(METHOD_NAME){return V8_VERSION>=51||!fails(function(){var array=[];var constructor=array.constructor={};constructor[SPECIES]=function(){return{foo:1}};return array[METHOD_NAME](Boolean).foo!==1})}},{"../internals/engine-v8-version":66,"../internals/fails":69,"../internals/well-known-symbol":166}],40:[function(_dereq_,module,exports){"use strict";var fails=_dereq_("../internals/fails");module.exports=function(METHOD_NAME,argument){var method=[][METHOD_NAME];return!!method&&fails(function(){method.call(null,argument||function(){throw 1},1)})}},{"../internals/fails":69}],41:[function(_dereq_,module,exports){var DESCRIPTORS=_dereq_("../internals/descriptors");var fails=_dereq_("../internals/fails");var has=_dereq_("../internals/has");var defineProperty=Object.defineProperty;var cache={};var thrower=function(it){throw it};module.exports=function(METHOD_NAME,options){if(has(cache,METHOD_NAME))return cache[METHOD_NAME];if(!options)options={};var method=[][METHOD_NAME];var ACCESSORS=has(options,"ACCESSORS")?options.ACCESSORS:false;var argument0=has(options,0)?options[0]:thrower;var argument1=has(options,1)?options[1]:undefined;return cache[METHOD_NAME]=!!method&&!fails(function(){if(ACCESSORS&&!DESCRIPTORS)return true;var O={length:-1};if(ACCESSORS)defineProperty(O,1,{enumerable:true,get:thrower});else O[1]=1;method.call(O,argument0,argument1)})}},{"../internals/descriptors":61,"../internals/fails":69,"../internals/has":78}],42:[function(_dereq_,module,exports){var aFunction=_dereq_("../internals/a-function");var toObject=_dereq_("../internals/to-object");var IndexedObject=_dereq_("../internals/indexed-object");var toLength=_dereq_("../internals/to-length");var createMethod=function(IS_RIGHT){return function(that,callbackfn,argumentsLength,memo){aFunction(callbackfn);var O=toObject(that);var self=IndexedObject(O);var length=toLength(O.length);var index=IS_RIGHT?length-1:0;var i=IS_RIGHT?-1:1;if(argumentsLength<2)while(true){if(index in self){memo=self[index];index+=i;break}index+=i;if(IS_RIGHT?index<0:length<=index){throw TypeError("Reduce of empty array with no initial value")}}for(;IS_RIGHT?index>=0:length>index;index+=i)if(index in self){memo=callbackfn(memo,self[index],index,O)}return memo}};module.exports={left:createMethod(false),right:createMethod(true)}},{"../internals/a-function":23,"../internals/indexed-object":84,"../internals/to-length":154,"../internals/to-object":155}],43:[function(_dereq_,module,exports){var isObject=_dereq_("../internals/is-object");var isArray=_dereq_("../internals/is-array");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var SPECIES=wellKnownSymbol("species");module.exports=function(originalArray,length){var C;if(isArray(originalArray)){C=originalArray.constructor;if(typeof C=="function"&&(C===Array||isArray(C.prototype)))C=undefined;else if(isObject(C)){C=C[SPECIES];if(C===null)C=undefined}}return new(C===undefined?Array:C)(length===0?0:length)}},{"../internals/is-array":90,"../internals/is-object":92,"../internals/well-known-symbol":166}],44:[function(_dereq_,module,exports){var anObject=_dereq_("../internals/an-object");module.exports=function(iterator,fn,value,ENTRIES){try{return ENTRIES?fn(anObject(value)[0],value[1]):fn(value)}catch(error){var returnMethod=iterator["return"];if(returnMethod!==undefined)anObject(returnMethod.call(iterator));throw error}}},{"../internals/an-object":28}],45:[function(_dereq_,module,exports){var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var ITERATOR=wellKnownSymbol("iterator");var SAFE_CLOSING=false;try{var called=0;var iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=true}};iteratorWithReturn[ITERATOR]=function(){return this};Array.from(iteratorWithReturn,function(){throw 2})}catch(error){}module.exports=function(exec,SKIP_CLOSING){if(!SKIP_CLOSING&&!SAFE_CLOSING)return false;var ITERATION_SUPPORT=false;try{var object={};object[ITERATOR]=function(){return{next:function(){return{done:ITERATION_SUPPORT=true}}}};exec(object)}catch(error){}return ITERATION_SUPPORT}},{"../internals/well-known-symbol":166}],46:[function(_dereq_,module,exports){var toString={}.toString;module.exports=function(it){return toString.call(it).slice(8,-1)}},{}],47:[function(_dereq_,module,exports){var TO_STRING_TAG_SUPPORT=_dereq_("../internals/to-string-tag-support");var classofRaw=_dereq_("../internals/classof-raw");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var TO_STRING_TAG=wellKnownSymbol("toStringTag");var CORRECT_ARGUMENTS=classofRaw(function(){return arguments}())=="Arguments";var tryGet=function(it,key){try{return it[key]}catch(error){}};module.exports=TO_STRING_TAG_SUPPORT?classofRaw:function(it){var O,tag,result;return it===undefined?"Undefined":it===null?"Null":typeof(tag=tryGet(O=Object(it),TO_STRING_TAG))=="string"?tag:CORRECT_ARGUMENTS?classofRaw(O):(result=classofRaw(O))=="Object"&&typeof O.callee=="function"?"Arguments":result}},{"../internals/classof-raw":46,"../internals/to-string-tag-support":159,"../internals/well-known-symbol":166}],48:[function(_dereq_,module,exports){"use strict";var defineProperty=_dereq_("../internals/object-define-property").f;var create=_dereq_("../internals/object-create");var redefineAll=_dereq_("../internals/redefine-all");var bind=_dereq_("../internals/function-bind-context");var anInstance=_dereq_("../internals/an-instance");var iterate=_dereq_("../internals/iterate");var defineIterator=_dereq_("../internals/define-iterator");var setSpecies=_dereq_("../internals/set-species");var DESCRIPTORS=_dereq_("../internals/descriptors");var fastKey=_dereq_("../internals/internal-metadata").fastKey;var InternalStateModule=_dereq_("../internals/internal-state");var setInternalState=InternalStateModule.set;var internalStateGetterFor=InternalStateModule.getterFor;module.exports={getConstructor:function(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){anInstance(that,C,CONSTRUCTOR_NAME);setInternalState(that,{type:CONSTRUCTOR_NAME,index:create(null),first:undefined,last:undefined,size:0});if(!DESCRIPTORS)that.size=0;if(iterable!=undefined)iterate(iterable,that[ADDER],that,IS_MAP)});var getInternalState=internalStateGetterFor(CONSTRUCTOR_NAME);var define=function(that,key,value){var state=getInternalState(that);var entry=getEntry(that,key);var previous,index;if(entry){entry.value=value}else{state.last=entry={index:index=fastKey(key,true),key:key,value:value,previous:previous=state.last,next:undefined,removed:false};if(!state.first)state.first=entry;if(previous)previous.next=entry;if(DESCRIPTORS)state.size++;else that.size++;if(index!=="F")state.index[index]=entry}return that};var getEntry=function(that,key){var state=getInternalState(that);var index=fastKey(key);var entry;if(index!=="F")return state.index[index];for(entry=state.first;entry;entry=entry.next){if(entry.key==key)return entry}};redefineAll(C.prototype,{clear:function clear(){var that=this;var state=getInternalState(that);var data=state.index;var entry=state.first;while(entry){entry.removed=true;if(entry.previous)entry.previous=entry.previous.next=undefined;delete data[entry.index];entry=entry.next}state.first=state.last=undefined;if(DESCRIPTORS)state.size=0;else that.size=0},delete:function(key){var that=this;var state=getInternalState(that);var entry=getEntry(that,key);if(entry){var next=entry.next;var prev=entry.previous;delete state.index[entry.index];entry.removed=true;if(prev)prev.next=next;if(next)next.previous=prev;if(state.first==entry)state.first=next;if(state.last==entry)state.last=prev;if(DESCRIPTORS)state.size--;else that.size--}return!!entry},forEach:function forEach(callbackfn){var state=getInternalState(this);var boundFunction=bind(callbackfn,arguments.length>1?arguments[1]:undefined,3);var entry;while(entry=entry?entry.next:state.first){boundFunction(entry.value,entry.key,this);while(entry&&entry.removed)entry=entry.previous}},has:function has(key){return!!getEntry(this,key)}});redefineAll(C.prototype,IS_MAP?{get:function get(key){var entry=getEntry(this,key);return entry&&entry.value},set:function set(key,value){return define(this,key===0?0:key,value)}}:{add:function add(value){return define(this,value=value===0?0:value,value)}});if(DESCRIPTORS)defineProperty(C.prototype,"size",{get:function(){return getInternalState(this).size}});return C},setStrong:function(C,CONSTRUCTOR_NAME,IS_MAP){var ITERATOR_NAME=CONSTRUCTOR_NAME+" Iterator";var getInternalCollectionState=internalStateGetterFor(CONSTRUCTOR_NAME);var getInternalIteratorState=internalStateGetterFor(ITERATOR_NAME);defineIterator(C,CONSTRUCTOR_NAME,function(iterated,kind){setInternalState(this,{type:ITERATOR_NAME,target:iterated,state:getInternalCollectionState(iterated),kind:kind,last:undefined})},function(){var state=getInternalIteratorState(this);var kind=state.kind;var entry=state.last;while(entry&&entry.removed)entry=entry.previous;if(!state.target||!(state.last=entry=entry?entry.next:state.state.first)){state.target=undefined;return{value:undefined,done:true}}if(kind=="keys")return{value:entry.key,done:false};if(kind=="values")return{value:entry.value,done:false};return{value:[entry.key,entry.value],done:false}},IS_MAP?"entries":"values",!IS_MAP,true);setSpecies(CONSTRUCTOR_NAME)}}},{"../internals/an-instance":27,"../internals/define-iterator":59,"../internals/descriptors":61,"../internals/function-bind-context":72,"../internals/internal-metadata":87,"../internals/internal-state":88,"../internals/iterate":95,"../internals/object-create":108,"../internals/object-define-property":110,"../internals/redefine-all":125,"../internals/set-species":134}],49:[function(_dereq_,module,exports){"use strict";var redefineAll=_dereq_("../internals/redefine-all");var getWeakData=_dereq_("../internals/internal-metadata").getWeakData;var anObject=_dereq_("../internals/an-object");var isObject=_dereq_("../internals/is-object");var anInstance=_dereq_("../internals/an-instance");var iterate=_dereq_("../internals/iterate");var ArrayIterationModule=_dereq_("../internals/array-iteration");var $has=_dereq_("../internals/has");var InternalStateModule=_dereq_("../internals/internal-state");var setInternalState=InternalStateModule.set;var internalStateGetterFor=InternalStateModule.getterFor;var find=ArrayIterationModule.find;var findIndex=ArrayIterationModule.findIndex;var id=0;var uncaughtFrozenStore=function(store){return store.frozen||(store.frozen=new UncaughtFrozenStore)};var UncaughtFrozenStore=function(){this.entries=[]};var findUncaughtFrozen=function(store,key){return find(store.entries,function(it){return it[0]===key})};UncaughtFrozenStore.prototype={get:function(key){var entry=findUncaughtFrozen(this,key);if(entry)return entry[1]},has:function(key){return!!findUncaughtFrozen(this,key)},set:function(key,value){var entry=findUncaughtFrozen(this,key);if(entry)entry[1]=value;else this.entries.push([key,value])},delete:function(key){var index=findIndex(this.entries,function(it){return it[0]===key});if(~index)this.entries.splice(index,1);return!!~index}};module.exports={getConstructor:function(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER){var C=wrapper(function(that,iterable){anInstance(that,C,CONSTRUCTOR_NAME);setInternalState(that,{type:CONSTRUCTOR_NAME,id:id++,frozen:undefined});if(iterable!=undefined)iterate(iterable,that[ADDER],that,IS_MAP)});var getInternalState=internalStateGetterFor(CONSTRUCTOR_NAME);var define=function(that,key,value){var state=getInternalState(that);var data=getWeakData(anObject(key),true);if(data===true)uncaughtFrozenStore(state).set(key,value);else data[state.id]=value;return that};redefineAll(C.prototype,{delete:function(key){var state=getInternalState(this);if(!isObject(key))return false;var data=getWeakData(key);if(data===true)return uncaughtFrozenStore(state)["delete"](key);return data&&$has(data,state.id)&&delete data[state.id]},has:function has(key){var state=getInternalState(this);if(!isObject(key))return false;var data=getWeakData(key);if(data===true)return uncaughtFrozenStore(state).has(key);return data&&$has(data,state.id)}});redefineAll(C.prototype,IS_MAP?{get:function get(key){var state=getInternalState(this);if(isObject(key)){var data=getWeakData(key);if(data===true)return uncaughtFrozenStore(state).get(key);return data?data[state.id]:undefined}},set:function set(key,value){return define(this,key,value)}}:{add:function add(value){return define(this,value,true)}});return C}}},{"../internals/an-instance":27,"../internals/an-object":28,"../internals/array-iteration":37,"../internals/has":78,"../internals/internal-metadata":87,"../internals/internal-state":88,"../internals/is-object":92,"../internals/iterate":95,"../internals/redefine-all":125}],50:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var global=_dereq_("../internals/global");var isForced=_dereq_("../internals/is-forced");var redefine=_dereq_("../internals/redefine");var InternalMetadataModule=_dereq_("../internals/internal-metadata");var iterate=_dereq_("../internals/iterate");var anInstance=_dereq_("../internals/an-instance");var isObject=_dereq_("../internals/is-object");var fails=_dereq_("../internals/fails");var checkCorrectnessOfIteration=_dereq_("../internals/check-correctness-of-iteration");var setToStringTag=_dereq_("../internals/set-to-string-tag");var inheritIfRequired=_dereq_("../internals/inherit-if-required");module.exports=function(CONSTRUCTOR_NAME,wrapper,common){var IS_MAP=CONSTRUCTOR_NAME.indexOf("Map")!==-1;var IS_WEAK=CONSTRUCTOR_NAME.indexOf("Weak")!==-1;var ADDER=IS_MAP?"set":"add";var NativeConstructor=global[CONSTRUCTOR_NAME];var NativePrototype=NativeConstructor&&NativeConstructor.prototype;var Constructor=NativeConstructor;var exported={};var fixMethod=function(KEY){var nativeMethod=NativePrototype[KEY];redefine(NativePrototype,KEY,KEY=="add"?function add(value){nativeMethod.call(this,value===0?0:value);return this}:KEY=="delete"?function(key){return IS_WEAK&&!isObject(key)?false:nativeMethod.call(this,key===0?0:key)}:KEY=="get"?function get(key){return IS_WEAK&&!isObject(key)?undefined:nativeMethod.call(this,key===0?0:key)}:KEY=="has"?function has(key){return IS_WEAK&&!isObject(key)?false:nativeMethod.call(this,key===0?0:key)}:function set(key,value){nativeMethod.call(this,key===0?0:key,value);return this})};if(isForced(CONSTRUCTOR_NAME,typeof NativeConstructor!="function"||!(IS_WEAK||NativePrototype.forEach&&!fails(function(){(new NativeConstructor).entries().next()})))){Constructor=common.getConstructor(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER);InternalMetadataModule.REQUIRED=true}else if(isForced(CONSTRUCTOR_NAME,true)){var instance=new Constructor;var HASNT_CHAINING=instance[ADDER](IS_WEAK?{}:-0,1)!=instance;var THROWS_ON_PRIMITIVES=fails(function(){instance.has(1)});var ACCEPT_ITERABLES=checkCorrectnessOfIteration(function(iterable){new NativeConstructor(iterable)});var BUGGY_ZERO=!IS_WEAK&&fails(function(){var $instance=new NativeConstructor;var index=5;while(index--)$instance[ADDER](index,index);return!$instance.has(-0)});if(!ACCEPT_ITERABLES){Constructor=wrapper(function(dummy,iterable){anInstance(dummy,Constructor,CONSTRUCTOR_NAME);var that=inheritIfRequired(new NativeConstructor,dummy,Constructor);if(iterable!=undefined)iterate(iterable,that[ADDER],that,IS_MAP);return that});Constructor.prototype=NativePrototype;NativePrototype.constructor=Constructor}if(THROWS_ON_PRIMITIVES||BUGGY_ZERO){fixMethod("delete");fixMethod("has");IS_MAP&&fixMethod("get")}if(BUGGY_ZERO||HASNT_CHAINING)fixMethod(ADDER);if(IS_WEAK&&NativePrototype.clear)delete NativePrototype.clear}exported[CONSTRUCTOR_NAME]=Constructor;$({global:true,forced:Constructor!=NativeConstructor},exported);setToStringTag(Constructor,CONSTRUCTOR_NAME);if(!IS_WEAK)common.setStrong(Constructor,CONSTRUCTOR_NAME,IS_MAP);return Constructor}},{"../internals/an-instance":27,"../internals/check-correctness-of-iteration":45,"../internals/export":68,"../internals/fails":69,"../internals/global":77,"../internals/inherit-if-required":85,"../internals/internal-metadata":87,"../internals/is-forced":91,"../internals/is-object":92,"../internals/iterate":95,"../internals/redefine":126,"../internals/set-to-string-tag":135}],51:[function(_dereq_,module,exports){var has=_dereq_("../internals/has");var ownKeys=_dereq_("../internals/own-keys");var getOwnPropertyDescriptorModule=_dereq_("../internals/object-get-own-property-descriptor");var definePropertyModule=_dereq_("../internals/object-define-property");module.exports=function(target,source){var keys=ownKeys(source);var defineProperty=definePropertyModule.f;var getOwnPropertyDescriptor=getOwnPropertyDescriptorModule.f;for(var i=0;i<keys.length;i++){var key=keys[i];if(!has(target,key))defineProperty(target,key,getOwnPropertyDescriptor(source,key))}}},{"../internals/has":78,"../internals/object-define-property":110,"../internals/object-get-own-property-descriptor":111,"../internals/own-keys":121}],52:[function(_dereq_,module,exports){var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var MATCH=wellKnownSymbol("match");module.exports=function(METHOD_NAME){var regexp=/./;try{"/./"[METHOD_NAME](regexp)}catch(e){try{regexp[MATCH]=false;return"/./"[METHOD_NAME](regexp)}catch(f){}}return false}},{"../internals/well-known-symbol":166}],53:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");module.exports=!fails(function(){function F(){}F.prototype.constructor=null;return Object.getPrototypeOf(new F)!==F.prototype})},{"../internals/fails":69}],54:[function(_dereq_,module,exports){var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var quot=/"/g;module.exports=function(string,tag,attribute,value){var S=String(requireObjectCoercible(string));var p1="<"+tag;if(attribute!=="")p1+=" "+attribute+'="'+String(value).replace(quot,"&quot;")+'"';return p1+">"+S+"</"+tag+">"}},{"../internals/require-object-coercible":131}],55:[function(_dereq_,module,exports){"use strict";var IteratorPrototype=_dereq_("../internals/iterators-core").IteratorPrototype;var create=_dereq_("../internals/object-create");var createPropertyDescriptor=_dereq_("../internals/create-property-descriptor");var setToStringTag=_dereq_("../internals/set-to-string-tag");var Iterators=_dereq_("../internals/iterators");var returnThis=function(){return this};module.exports=function(IteratorConstructor,NAME,next){var TO_STRING_TAG=NAME+" Iterator";IteratorConstructor.prototype=create(IteratorPrototype,{next:createPropertyDescriptor(1,next)});setToStringTag(IteratorConstructor,TO_STRING_TAG,false,true);Iterators[TO_STRING_TAG]=returnThis;return IteratorConstructor}},{"../internals/create-property-descriptor":57,"../internals/iterators":97,"../internals/iterators-core":96,"../internals/object-create":108,"../internals/set-to-string-tag":135}],56:[function(_dereq_,module,exports){var DESCRIPTORS=_dereq_("../internals/descriptors");var definePropertyModule=_dereq_("../internals/object-define-property");var createPropertyDescriptor=_dereq_("../internals/create-property-descriptor");module.exports=DESCRIPTORS?function(object,key,value){return definePropertyModule.f(object,key,createPropertyDescriptor(1,value))}:function(object,key,value){object[key]=value;return object}},{"../internals/create-property-descriptor":57,"../internals/descriptors":61,"../internals/object-define-property":110}],57:[function(_dereq_,module,exports){module.exports=function(bitmap,value){return{enumerable:!(bitmap&1),configurable:!(bitmap&2),writable:!(bitmap&4),value:value}}},{}],58:[function(_dereq_,module,exports){"use strict";var toPrimitive=_dereq_("../internals/to-primitive");var definePropertyModule=_dereq_("../internals/object-define-property");var createPropertyDescriptor=_dereq_("../internals/create-property-descriptor");module.exports=function(object,key,value){var propertyKey=toPrimitive(key);if(propertyKey in object)definePropertyModule.f(object,propertyKey,createPropertyDescriptor(0,value));else object[propertyKey]=value}},{"../internals/create-property-descriptor":57,"../internals/object-define-property":110,"../internals/to-primitive":158}],59:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var createIteratorConstructor=_dereq_("../internals/create-iterator-constructor");var getPrototypeOf=_dereq_("../internals/object-get-prototype-of");var setPrototypeOf=_dereq_("../internals/object-set-prototype-of");var setToStringTag=_dereq_("../internals/set-to-string-tag");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var redefine=_dereq_("../internals/redefine");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var IS_PURE=_dereq_("../internals/is-pure");var Iterators=_dereq_("../internals/iterators");var IteratorsCore=_dereq_("../internals/iterators-core");var IteratorPrototype=IteratorsCore.IteratorPrototype;var BUGGY_SAFARI_ITERATORS=IteratorsCore.BUGGY_SAFARI_ITERATORS;var ITERATOR=wellKnownSymbol("iterator");var KEYS="keys";var VALUES="values";var ENTRIES="entries";var returnThis=function(){return this};module.exports=function(Iterable,NAME,IteratorConstructor,next,DEFAULT,IS_SET,FORCED){createIteratorConstructor(IteratorConstructor,NAME,next);var getIterationMethod=function(KIND){if(KIND===DEFAULT&&defaultIterator)return defaultIterator;if(!BUGGY_SAFARI_ITERATORS&&KIND in IterablePrototype)return IterablePrototype[KIND];switch(KIND){case KEYS:return function keys(){return new IteratorConstructor(this,KIND)};case VALUES:return function values(){return new IteratorConstructor(this,KIND)};case ENTRIES:return function entries(){return new IteratorConstructor(this,KIND)}}return function(){return new IteratorConstructor(this)}};var TO_STRING_TAG=NAME+" Iterator";var INCORRECT_VALUES_NAME=false;var IterablePrototype=Iterable.prototype;var nativeIterator=IterablePrototype[ITERATOR]||IterablePrototype["@@iterator"]||DEFAULT&&IterablePrototype[DEFAULT];var defaultIterator=!BUGGY_SAFARI_ITERATORS&&nativeIterator||getIterationMethod(DEFAULT);var anyNativeIterator=NAME=="Array"?IterablePrototype.entries||nativeIterator:nativeIterator;var CurrentIteratorPrototype,methods,KEY;if(anyNativeIterator){CurrentIteratorPrototype=getPrototypeOf(anyNativeIterator.call(new Iterable));if(IteratorPrototype!==Object.prototype&&CurrentIteratorPrototype.next){if(!IS_PURE&&getPrototypeOf(CurrentIteratorPrototype)!==IteratorPrototype){if(setPrototypeOf){setPrototypeOf(CurrentIteratorPrototype,IteratorPrototype)}else if(typeof CurrentIteratorPrototype[ITERATOR]!="function"){createNonEnumerableProperty(CurrentIteratorPrototype,ITERATOR,returnThis)}}setToStringTag(CurrentIteratorPrototype,TO_STRING_TAG,true,true);if(IS_PURE)Iterators[TO_STRING_TAG]=returnThis}}if(DEFAULT==VALUES&&nativeIterator&&nativeIterator.name!==VALUES){INCORRECT_VALUES_NAME=true;defaultIterator=function values(){return nativeIterator.call(this)}}if((!IS_PURE||FORCED)&&IterablePrototype[ITERATOR]!==defaultIterator){createNonEnumerableProperty(IterablePrototype,ITERATOR,defaultIterator)}Iterators[NAME]=defaultIterator;if(DEFAULT){methods={values:getIterationMethod(VALUES),keys:IS_SET?defaultIterator:getIterationMethod(KEYS),entries:getIterationMethod(ENTRIES)};if(FORCED)for(KEY in methods){if(BUGGY_SAFARI_ITERATORS||INCORRECT_VALUES_NAME||!(KEY in IterablePrototype)){redefine(IterablePrototype,KEY,methods[KEY])}}else $({target:NAME,proto:true,forced:BUGGY_SAFARI_ITERATORS||INCORRECT_VALUES_NAME},methods)}return methods}},{"../internals/create-iterator-constructor":55,"../internals/create-non-enumerable-property":56,"../internals/export":68,"../internals/is-pure":93,"../internals/iterators":97,"../internals/iterators-core":96,"../internals/object-get-prototype-of":115,"../internals/object-set-prototype-of":119,"../internals/redefine":126,"../internals/set-to-string-tag":135,"../internals/well-known-symbol":166}],60:[function(_dereq_,module,exports){var path=_dereq_("../internals/path");var has=_dereq_("../internals/has");var wrappedWellKnownSymbolModule=_dereq_("../internals/well-known-symbol-wrapped");var defineProperty=_dereq_("../internals/object-define-property").f;module.exports=function(NAME){var Symbol=path.Symbol||(path.Symbol={});if(!has(Symbol,NAME))defineProperty(Symbol,NAME,{value:wrappedWellKnownSymbolModule.f(NAME)})}},{"../internals/has":78,"../internals/object-define-property":110,"../internals/path":122,"../internals/well-known-symbol-wrapped":165}],61:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");module.exports=!fails(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},{"../internals/fails":69}],62:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var isObject=_dereq_("../internals/is-object");var document=global.document;var EXISTS=isObject(document)&&isObject(document.createElement);module.exports=function(it){return EXISTS?document.createElement(it):{}}},{"../internals/global":77,"../internals/is-object":92}],63:[function(_dereq_,module,exports){module.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},{}],64:[function(_dereq_,module,exports){var userAgent=_dereq_("../internals/engine-user-agent");module.exports=/(iphone|ipod|ipad).*applewebkit/i.test(userAgent)},{"../internals/engine-user-agent":65}],65:[function(_dereq_,module,exports){var getBuiltIn=_dereq_("../internals/get-built-in");module.exports=getBuiltIn("navigator","userAgent")||""},{"../internals/get-built-in":74}],66:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var userAgent=_dereq_("../internals/engine-user-agent");var process=global.process;var versions=process&&process.versions;var v8=versions&&versions.v8;var match,version;if(v8){match=v8.split(".");version=match[0]+match[1]}else if(userAgent){match=userAgent.match(/Edge\/(\d+)/);if(!match||match[1]>=74){match=userAgent.match(/Chrome\/(\d+)/);if(match)version=match[1]}}module.exports=version&&+version},{"../internals/engine-user-agent":65,"../internals/global":77}],67:[function(_dereq_,module,exports){module.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],68:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var getOwnPropertyDescriptor=_dereq_("../internals/object-get-own-property-descriptor").f;var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var redefine=_dereq_("../internals/redefine");var setGlobal=_dereq_("../internals/set-global");var copyConstructorProperties=_dereq_("../internals/copy-constructor-properties");var isForced=_dereq_("../internals/is-forced");module.exports=function(options,source){var TARGET=options.target;var GLOBAL=options.global;var STATIC=options.stat;var FORCED,target,key,targetProperty,sourceProperty,descriptor;if(GLOBAL){target=global}else if(STATIC){target=global[TARGET]||setGlobal(TARGET,{})}else{target=(global[TARGET]||{}).prototype}if(target)for(key in source){sourceProperty=source[key];if(options.noTargetGet){descriptor=getOwnPropertyDescriptor(target,key);targetProperty=descriptor&&descriptor.value}else targetProperty=target[key];FORCED=isForced(GLOBAL?key:TARGET+(STATIC?".":"#")+key,options.forced);if(!FORCED&&targetProperty!==undefined){if(typeof sourceProperty===typeof targetProperty)continue;copyConstructorProperties(sourceProperty,targetProperty)}if(options.sham||targetProperty&&targetProperty.sham){createNonEnumerableProperty(sourceProperty,"sham",true)}redefine(target,key,sourceProperty,options)}}},{"../internals/copy-constructor-properties":51,"../internals/create-non-enumerable-property":56,"../internals/global":77,"../internals/is-forced":91,"../internals/object-get-own-property-descriptor":111,"../internals/redefine":126,"../internals/set-global":133}],69:[function(_dereq_,module,exports){module.exports=function(exec){try{return!!exec()}catch(error){return true}}},{}],70:[function(_dereq_,module,exports){"use strict";_dereq_("../modules/es.regexp.exec");var redefine=_dereq_("../internals/redefine");var fails=_dereq_("../internals/fails");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var regexpExec=_dereq_("../internals/regexp-exec");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var SPECIES=wellKnownSymbol("species");var REPLACE_SUPPORTS_NAMED_GROUPS=!fails(function(){var re=/./;re.exec=function(){var result=[];result.groups={a:"7"};return result};return"".replace(re,"$<a>")!=="7"});var REPLACE_KEEPS_$0=function(){return"a".replace(/./,"$0")==="$0"}();var REPLACE=wellKnownSymbol("replace");var REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE=function(){if(/./[REPLACE]){return/./[REPLACE]("a","$0")===""}return false}();var SPLIT_WORKS_WITH_OVERWRITTEN_EXEC=!fails(function(){var re=/(?:)/;var originalExec=re.exec;re.exec=function(){return originalExec.apply(this,arguments)};var result="ab".split(re);return result.length!==2||result[0]!=="a"||result[1]!=="b"});module.exports=function(KEY,length,exec,sham){var SYMBOL=wellKnownSymbol(KEY);var DELEGATES_TO_SYMBOL=!fails(function(){var O={};O[SYMBOL]=function(){return 7};return""[KEY](O)!=7});var DELEGATES_TO_EXEC=DELEGATES_TO_SYMBOL&&!fails(function(){var execCalled=false;var re=/a/;if(KEY==="split"){re={};re.constructor={};re.constructor[SPECIES]=function(){return re};re.flags="";re[SYMBOL]=/./[SYMBOL]}re.exec=function(){execCalled=true;return null};re[SYMBOL]("");return!execCalled});if(!DELEGATES_TO_SYMBOL||!DELEGATES_TO_EXEC||KEY==="replace"&&!(REPLACE_SUPPORTS_NAMED_GROUPS&&REPLACE_KEEPS_$0&&!REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE)||KEY==="split"&&!SPLIT_WORKS_WITH_OVERWRITTEN_EXEC){var nativeRegExpMethod=/./[SYMBOL];var methods=exec(SYMBOL,""[KEY],function(nativeMethod,regexp,str,arg2,forceStringMethod){if(regexp.exec===regexpExec){if(DELEGATES_TO_SYMBOL&&!forceStringMethod){return{done:true,value:nativeRegExpMethod.call(regexp,str,arg2)}}return{done:true,value:nativeMethod.call(str,regexp,arg2)}}return{done:false}},{REPLACE_KEEPS_$0:REPLACE_KEEPS_$0,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE});var stringMethod=methods[0];var regexMethod=methods[1];redefine(String.prototype,KEY,stringMethod);redefine(RegExp.prototype,SYMBOL,length==2?function(string,arg){return regexMethod.call(string,this,arg)}:function(string){return regexMethod.call(string,this)})}if(sham)createNonEnumerableProperty(RegExp.prototype[SYMBOL],"sham",true)}},{"../internals/create-non-enumerable-property":56,"../internals/fails":69,"../internals/redefine":126,"../internals/regexp-exec":128,"../internals/well-known-symbol":166,"../modules/es.regexp.exec":205}],71:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");module.exports=!fails(function(){return Object.isExtensible(Object.preventExtensions({}))})},{"../internals/fails":69}],72:[function(_dereq_,module,exports){var aFunction=_dereq_("../internals/a-function");module.exports=function(fn,that,length){aFunction(fn);if(that===undefined)return fn;switch(length){case 0:return function(){return fn.call(that)};case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}}},{"../internals/a-function":23}],73:[function(_dereq_,module,exports){"use strict";var aFunction=_dereq_("../internals/a-function");var isObject=_dereq_("../internals/is-object");var slice=[].slice;var factories={};var construct=function(C,argsLength,args){if(!(argsLength in factories)){for(var list=[],i=0;i<argsLength;i++)list[i]="a["+i+"]";factories[argsLength]=Function("C,a","return new C("+list.join(",")+")")}return factories[argsLength](C,args)};module.exports=Function.bind||function bind(that){var fn=aFunction(this);var partArgs=slice.call(arguments,1);var boundFunction=function bound(){var args=partArgs.concat(slice.call(arguments));return this instanceof boundFunction?construct(fn,args.length,args):fn.apply(that,args)};if(isObject(fn.prototype))boundFunction.prototype=fn.prototype;return boundFunction}},{"../internals/a-function":23,"../internals/is-object":92}],74:[function(_dereq_,module,exports){var path=_dereq_("../internals/path");var global=_dereq_("../internals/global");var aFunction=function(variable){return typeof variable=="function"?variable:undefined};module.exports=function(namespace,method){return arguments.length<2?aFunction(path[namespace])||aFunction(global[namespace]):path[namespace]&&path[namespace][method]||global[namespace]&&global[namespace][method]}},{"../internals/global":77,"../internals/path":122}],75:[function(_dereq_,module,exports){var classof=_dereq_("../internals/classof");var Iterators=_dereq_("../internals/iterators");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var ITERATOR=wellKnownSymbol("iterator");module.exports=function(it){if(it!=undefined)return it[ITERATOR]||it["@@iterator"]||Iterators[classof(it)]}},{"../internals/classof":47,"../internals/iterators":97,"../internals/well-known-symbol":166}],76:[function(_dereq_,module,exports){var anObject=_dereq_("../internals/an-object");var getIteratorMethod=_dereq_("../internals/get-iterator-method");module.exports=function(it){var iteratorMethod=getIteratorMethod(it);if(typeof iteratorMethod!="function"){throw TypeError(String(it)+" is not iterable")}return anObject(iteratorMethod.call(it))}},{"../internals/an-object":28,"../internals/get-iterator-method":75}],77:[function(_dereq_,module,exports){(function(global){var check=function(it){return it&&it.Math==Math&&it};module.exports=check(typeof globalThis=="object"&&globalThis)||check(typeof window=="object"&&window)||check(typeof self=="object"&&self)||check(typeof global=="object"&&global)||Function("return this")()}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],78:[function(_dereq_,module,exports){var hasOwnProperty={}.hasOwnProperty;module.exports=function(it,key){return hasOwnProperty.call(it,key)}},{}],79:[function(_dereq_,module,exports){module.exports={}},{}],80:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");module.exports=function(a,b){var console=global.console;if(console&&console.error){arguments.length===1?console.error(a):console.error(a,b)}}},{"../internals/global":77}],81:[function(_dereq_,module,exports){var getBuiltIn=_dereq_("../internals/get-built-in");module.exports=getBuiltIn("document","documentElement")},{"../internals/get-built-in":74}],82:[function(_dereq_,module,exports){var DESCRIPTORS=_dereq_("../internals/descriptors");var fails=_dereq_("../internals/fails");var createElement=_dereq_("../internals/document-create-element");module.exports=!DESCRIPTORS&&!fails(function(){return Object.defineProperty(createElement("div"),"a",{get:function(){return 7}}).a!=7})},{"../internals/descriptors":61,"../internals/document-create-element":62,"../internals/fails":69}],83:[function(_dereq_,module,exports){var Infinity=1/0;var abs=Math.abs;var pow=Math.pow;var floor=Math.floor;var log=Math.log;var LN2=Math.LN2;var pack=function(number,mantissaLength,bytes){var buffer=new Array(bytes);var exponentLength=bytes*8-mantissaLength-1;var eMax=(1<<exponentLength)-1;var eBias=eMax>>1;var rt=mantissaLength===23?pow(2,-24)-pow(2,-77):0;var sign=number<0||number===0&&1/number<0?1:0;var index=0;var exponent,mantissa,c;number=abs(number);if(number!=number||number===Infinity){mantissa=number!=number?1:0;exponent=eMax}else{exponent=floor(log(number)/LN2);if(number*(c=pow(2,-exponent))<1){exponent--;c*=2}if(exponent+eBias>=1){number+=rt/c}else{number+=rt*pow(2,1-eBias)}if(number*c>=2){exponent++;c/=2}if(exponent+eBias>=eMax){mantissa=0;exponent=eMax}else if(exponent+eBias>=1){mantissa=(number*c-1)*pow(2,mantissaLength);exponent=exponent+eBias}else{mantissa=number*pow(2,eBias-1)*pow(2,mantissaLength);exponent=0}}for(;mantissaLength>=8;buffer[index++]=mantissa&255,mantissa/=256,mantissaLength-=8);exponent=exponent<<mantissaLength|mantissa;exponentLength+=mantissaLength;for(;exponentLength>0;buffer[index++]=exponent&255,exponent/=256,exponentLength-=8);buffer[--index]|=sign*128;return buffer};var unpack=function(buffer,mantissaLength){var bytes=buffer.length;var exponentLength=bytes*8-mantissaLength-1;var eMax=(1<<exponentLength)-1;var eBias=eMax>>1;var nBits=exponentLength-7;var index=bytes-1;var sign=buffer[index--];var exponent=sign&127;var mantissa;sign>>=7;for(;nBits>0;exponent=exponent*256+buffer[index],index--,nBits-=8);mantissa=exponent&(1<<-nBits)-1;exponent>>=-nBits;nBits+=mantissaLength;for(;nBits>0;mantissa=mantissa*256+buffer[index],index--,nBits-=8);if(exponent===0){exponent=1-eBias}else if(exponent===eMax){return mantissa?NaN:sign?-Infinity:Infinity}else{mantissa=mantissa+pow(2,mantissaLength);exponent=exponent-eBias}return(sign?-1:1)*mantissa*pow(2,exponent-mantissaLength)};module.exports={pack:pack,unpack:unpack}},{}],84:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");var classof=_dereq_("../internals/classof-raw");var split="".split;module.exports=fails(function(){return!Object("z").propertyIsEnumerable(0)})?function(it){return classof(it)=="String"?split.call(it,""):Object(it)}:Object},{"../internals/classof-raw":46,"../internals/fails":69}],85:[function(_dereq_,module,exports){var isObject=_dereq_("../internals/is-object");var setPrototypeOf=_dereq_("../internals/object-set-prototype-of");module.exports=function($this,dummy,Wrapper){var NewTarget,NewTargetPrototype;if(setPrototypeOf&&typeof(NewTarget=dummy.constructor)=="function"&&NewTarget!==Wrapper&&isObject(NewTargetPrototype=NewTarget.prototype)&&NewTargetPrototype!==Wrapper.prototype)setPrototypeOf($this,NewTargetPrototype);return $this}},{"../internals/is-object":92,"../internals/object-set-prototype-of":119}],86:[function(_dereq_,module,exports){var store=_dereq_("../internals/shared-store");var functionToString=Function.toString;if(typeof store.inspectSource!="function"){store.inspectSource=function(it){return functionToString.call(it)}}module.exports=store.inspectSource},{"../internals/shared-store":137}],87:[function(_dereq_,module,exports){var hiddenKeys=_dereq_("../internals/hidden-keys");var isObject=_dereq_("../internals/is-object");var has=_dereq_("../internals/has");var defineProperty=_dereq_("../internals/object-define-property").f;var uid=_dereq_("../internals/uid");var FREEZING=_dereq_("../internals/freezing");var METADATA=uid("meta");var id=0;var isExtensible=Object.isExtensible||function(){return true};var setMetadata=function(it){defineProperty(it,METADATA,{value:{objectID:"O"+ ++id,weakData:{}}})};var fastKey=function(it,create){if(!isObject(it))return typeof it=="symbol"?it:(typeof it=="string"?"S":"P")+it;if(!has(it,METADATA)){if(!isExtensible(it))return"F";if(!create)return"E";setMetadata(it)}return it[METADATA].objectID};var getWeakData=function(it,create){if(!has(it,METADATA)){if(!isExtensible(it))return true;if(!create)return false;setMetadata(it)}return it[METADATA].weakData};var onFreeze=function(it){if(FREEZING&&meta.REQUIRED&&isExtensible(it)&&!has(it,METADATA))setMetadata(it);return it};var meta=module.exports={REQUIRED:false,fastKey:fastKey,getWeakData:getWeakData,onFreeze:onFreeze};hiddenKeys[METADATA]=true},{"../internals/freezing":71,"../internals/has":78,"../internals/hidden-keys":79,"../internals/is-object":92,"../internals/object-define-property":110,"../internals/uid":163}],88:[function(_dereq_,module,exports){var NATIVE_WEAK_MAP=_dereq_("../internals/native-weak-map");var global=_dereq_("../internals/global");var isObject=_dereq_("../internals/is-object");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var objectHas=_dereq_("../internals/has");var sharedKey=_dereq_("../internals/shared-key");var hiddenKeys=_dereq_("../internals/hidden-keys");var WeakMap=global.WeakMap;var set,get,has;var enforce=function(it){return has(it)?get(it):set(it,{})};var getterFor=function(TYPE){return function(it){var state;if(!isObject(it)||(state=get(it)).type!==TYPE){throw TypeError("Incompatible receiver, "+TYPE+" required")}return state}};if(NATIVE_WEAK_MAP){var store=new WeakMap;var wmget=store.get;var wmhas=store.has;var wmset=store.set;set=function(it,metadata){wmset.call(store,it,metadata);return metadata};get=function(it){return wmget.call(store,it)||{}};has=function(it){return wmhas.call(store,it)}}else{var STATE=sharedKey("state");hiddenKeys[STATE]=true;set=function(it,metadata){createNonEnumerableProperty(it,STATE,metadata);return metadata};get=function(it){return objectHas(it,STATE)?it[STATE]:{}};has=function(it){return objectHas(it,STATE)}}module.exports={set:set,get:get,has:has,enforce:enforce,getterFor:getterFor}},{"../internals/create-non-enumerable-property":56,"../internals/global":77,"../internals/has":78,"../internals/hidden-keys":79,"../internals/is-object":92,"../internals/native-weak-map":103,"../internals/shared-key":136}],89:[function(_dereq_,module,exports){var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var Iterators=_dereq_("../internals/iterators");var ITERATOR=wellKnownSymbol("iterator");var ArrayPrototype=Array.prototype;module.exports=function(it){return it!==undefined&&(Iterators.Array===it||ArrayPrototype[ITERATOR]===it)}},{"../internals/iterators":97,"../internals/well-known-symbol":166}],90:[function(_dereq_,module,exports){var classof=_dereq_("../internals/classof-raw");module.exports=Array.isArray||function isArray(arg){return classof(arg)=="Array"}},{"../internals/classof-raw":46}],91:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");var replacement=/#|\.prototype\./;var isForced=function(feature,detection){var value=data[normalize(feature)];return value==POLYFILL?true:value==NATIVE?false:typeof detection=="function"?fails(detection):!!detection};var normalize=isForced.normalize=function(string){return String(string).replace(replacement,".").toLowerCase()};var data=isForced.data={};var NATIVE=isForced.NATIVE="N";var POLYFILL=isForced.POLYFILL="P";module.exports=isForced},{"../internals/fails":69}],92:[function(_dereq_,module,exports){module.exports=function(it){return typeof it==="object"?it!==null:typeof it==="function"}},{}],93:[function(_dereq_,module,exports){module.exports=false},{}],94:[function(_dereq_,module,exports){var isObject=_dereq_("../internals/is-object");var classof=_dereq_("../internals/classof-raw");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var MATCH=wellKnownSymbol("match");module.exports=function(it){var isRegExp;return isObject(it)&&((isRegExp=it[MATCH])!==undefined?!!isRegExp:classof(it)=="RegExp")}},{"../internals/classof-raw":46,"../internals/is-object":92,"../internals/well-known-symbol":166}],95:[function(_dereq_,module,exports){var anObject=_dereq_("../internals/an-object");var isArrayIteratorMethod=_dereq_("../internals/is-array-iterator-method");var toLength=_dereq_("../internals/to-length");var bind=_dereq_("../internals/function-bind-context");var getIteratorMethod=_dereq_("../internals/get-iterator-method");var callWithSafeIterationClosing=_dereq_("../internals/call-with-safe-iteration-closing");var Result=function(stopped,result){this.stopped=stopped;this.result=result};var iterate=module.exports=function(iterable,fn,that,AS_ENTRIES,IS_ITERATOR){var boundFunction=bind(fn,that,AS_ENTRIES?2:1);var iterator,iterFn,index,length,result,next,step;if(IS_ITERATOR){iterator=iterable}else{iterFn=getIteratorMethod(iterable);if(typeof iterFn!="function")throw TypeError("Target is not iterable");if(isArrayIteratorMethod(iterFn)){for(index=0,length=toLength(iterable.length);length>index;index++){result=AS_ENTRIES?boundFunction(anObject(step=iterable[index])[0],step[1]):boundFunction(iterable[index]);if(result&&result instanceof Result)return result}return new Result(false)}iterator=iterFn.call(iterable)}next=iterator.next;while(!(step=next.call(iterator)).done){result=callWithSafeIterationClosing(iterator,boundFunction,step.value,AS_ENTRIES);if(typeof result=="object"&&result&&result instanceof Result)return result}return new Result(false)};iterate.stop=function(result){return new Result(true,result)}},{"../internals/an-object":28,"../internals/call-with-safe-iteration-closing":44,"../internals/function-bind-context":72,"../internals/get-iterator-method":75,"../internals/is-array-iterator-method":89,"../internals/to-length":154}],96:[function(_dereq_,module,exports){"use strict";var getPrototypeOf=_dereq_("../internals/object-get-prototype-of");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var has=_dereq_("../internals/has");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var IS_PURE=_dereq_("../internals/is-pure");var ITERATOR=wellKnownSymbol("iterator");var BUGGY_SAFARI_ITERATORS=false;var returnThis=function(){return this};var IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator;if([].keys){arrayIterator=[].keys();if(!("next"in arrayIterator))BUGGY_SAFARI_ITERATORS=true;else{PrototypeOfArrayIteratorPrototype=getPrototypeOf(getPrototypeOf(arrayIterator));if(PrototypeOfArrayIteratorPrototype!==Object.prototype)IteratorPrototype=PrototypeOfArrayIteratorPrototype}}if(IteratorPrototype==undefined)IteratorPrototype={};if(!IS_PURE&&!has(IteratorPrototype,ITERATOR)){createNonEnumerableProperty(IteratorPrototype,ITERATOR,returnThis)}module.exports={IteratorPrototype:IteratorPrototype,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS}},{"../internals/create-non-enumerable-property":56,"../internals/has":78,"../internals/is-pure":93,"../internals/object-get-prototype-of":115,"../internals/well-known-symbol":166}],97:[function(_dereq_,module,exports){module.exports={}},{}],98:[function(_dereq_,module,exports){module.exports=Math.sign||function sign(x){return(x=+x)==0||x!=x?x:x<0?-1:1}},{}],99:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var getOwnPropertyDescriptor=_dereq_("../internals/object-get-own-property-descriptor").f;var classof=_dereq_("../internals/classof-raw");var macrotask=_dereq_("../internals/task").set;var IS_IOS=_dereq_("../internals/engine-is-ios");var MutationObserver=global.MutationObserver||global.WebKitMutationObserver;var process=global.process;var Promise=global.Promise;var IS_NODE=classof(process)=="process";var queueMicrotaskDescriptor=getOwnPropertyDescriptor(global,"queueMicrotask");var queueMicrotask=queueMicrotaskDescriptor&&queueMicrotaskDescriptor.value;var flush,head,last,notify,toggle,node,promise,then;if(!queueMicrotask){flush=function(){var parent,fn;if(IS_NODE&&(parent=process.domain))parent.exit();while(head){fn=head.fn;head=head.next;try{fn()}catch(error){if(head)notify();else last=undefined;throw error}}last=undefined;if(parent)parent.enter()};if(IS_NODE){notify=function(){process.nextTick(flush)}}else if(MutationObserver&&!IS_IOS){toggle=true;node=document.createTextNode("");new MutationObserver(flush).observe(node,{characterData:true});notify=function(){node.data=toggle=!toggle}}else if(Promise&&Promise.resolve){promise=Promise.resolve(undefined);then=promise.then;notify=function(){then.call(promise,flush)}}else{notify=function(){macrotask.call(global,flush)}}}module.exports=queueMicrotask||function(fn){var task={fn:fn,next:undefined};if(last)last.next=task;if(!head){head=task;notify()}last=task}},{"../internals/classof-raw":46,"../internals/engine-is-ios":64,"../internals/global":77,"../internals/object-get-own-property-descriptor":111,"../internals/task":148}],100:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");module.exports=global.Promise},{"../internals/global":77}],101:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");module.exports=!!Object.getOwnPropertySymbols&&!fails(function(){return!String(Symbol())})},{"../internals/fails":69}],102:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var IS_PURE=_dereq_("../internals/is-pure");var ITERATOR=wellKnownSymbol("iterator");module.exports=!fails(function(){var url=new URL("b?a=1&b=2&c=3","http://a");var searchParams=url.searchParams;var result="";url.pathname="c%20d";searchParams.forEach(function(value,key){searchParams["delete"]("b");result+=key+value});return IS_PURE&&!url.toJSON||!searchParams.sort||url.href!=="http://a/c%20d?a=1&c=3"||searchParams.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!searchParams[ITERATOR]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://тест").host!=="xn--e1aybc"||new URL("http://a#б").hash!=="#%D0%B1"||result!=="a1c3"||new URL("http://x",undefined).host!=="x"})},{"../internals/fails":69,"../internals/is-pure":93,"../internals/well-known-symbol":166}],103:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var inspectSource=_dereq_("../internals/inspect-source");var WeakMap=global.WeakMap;module.exports=typeof WeakMap==="function"&&/native code/.test(inspectSource(WeakMap))},{"../internals/global":77,"../internals/inspect-source":86}],104:[function(_dereq_,module,exports){"use strict";var aFunction=_dereq_("../internals/a-function");var PromiseCapability=function(C){var resolve,reject;this.promise=new C(function($$resolve,$$reject){if(resolve!==undefined||reject!==undefined)throw TypeError("Bad Promise constructor");resolve=$$resolve;reject=$$reject});this.resolve=aFunction(resolve);this.reject=aFunction(reject)};module.exports.f=function(C){return new PromiseCapability(C)}},{"../internals/a-function":23}],105:[function(_dereq_,module,exports){var isRegExp=_dereq_("../internals/is-regexp");module.exports=function(it){if(isRegExp(it)){throw TypeError("The method doesn't accept regular expressions")}return it}},{"../internals/is-regexp":94}],106:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var globalIsFinite=global.isFinite;module.exports=Number.isFinite||function isFinite(it){return typeof it=="number"&&globalIsFinite(it)}},{"../internals/global":77}],107:[function(_dereq_,module,exports){"use strict";var DESCRIPTORS=_dereq_("../internals/descriptors");var fails=_dereq_("../internals/fails");var objectKeys=_dereq_("../internals/object-keys");var getOwnPropertySymbolsModule=_dereq_("../internals/object-get-own-property-symbols");var propertyIsEnumerableModule=_dereq_("../internals/object-property-is-enumerable");var toObject=_dereq_("../internals/to-object");var IndexedObject=_dereq_("../internals/indexed-object");var nativeAssign=Object.assign;var defineProperty=Object.defineProperty;module.exports=!nativeAssign||fails(function(){if(DESCRIPTORS&&nativeAssign({b:1},nativeAssign(defineProperty({},"a",{enumerable:true,get:function(){defineProperty(this,"b",{value:3,enumerable:false})}}),{b:2})).b!==1)return true;var A={};var B={};var symbol=Symbol();var alphabet="abcdefghijklmnopqrst";A[symbol]=7;alphabet.split("").forEach(function(chr){B[chr]=chr});return nativeAssign({},A)[symbol]!=7||objectKeys(nativeAssign({},B)).join("")!=alphabet})?function assign(target,source){var T=toObject(target);var argumentsLength=arguments.length;var index=1;var getOwnPropertySymbols=getOwnPropertySymbolsModule.f;var propertyIsEnumerable=propertyIsEnumerableModule.f;while(argumentsLength>index){var S=IndexedObject(arguments[index++]);var keys=getOwnPropertySymbols?objectKeys(S).concat(getOwnPropertySymbols(S)):objectKeys(S);var length=keys.length;var j=0;var key;while(length>j){key=keys[j++];if(!DESCRIPTORS||propertyIsEnumerable.call(S,key))T[key]=S[key]}}return T}:nativeAssign},{"../internals/descriptors":61,"../internals/fails":69,"../internals/indexed-object":84,"../internals/object-get-own-property-symbols":114,"../internals/object-keys":117,"../internals/object-property-is-enumerable":118,"../internals/to-object":155}],108:[function(_dereq_,module,exports){var anObject=_dereq_("../internals/an-object");var defineProperties=_dereq_("../internals/object-define-properties");var enumBugKeys=_dereq_("../internals/enum-bug-keys");var hiddenKeys=_dereq_("../internals/hidden-keys");var html=_dereq_("../internals/html");var documentCreateElement=_dereq_("../internals/document-create-element");var sharedKey=_dereq_("../internals/shared-key");var GT=">";var LT="<";var PROTOTYPE="prototype";var SCRIPT="script";var IE_PROTO=sharedKey("IE_PROTO");var EmptyConstructor=function(){};var scriptTag=function(content){return LT+SCRIPT+GT+content+LT+"/"+SCRIPT+GT};var NullProtoObjectViaActiveX=function(activeXDocument){activeXDocument.write(scriptTag(""));activeXDocument.close();var temp=activeXDocument.parentWindow.Object;activeXDocument=null;return temp};var NullProtoObjectViaIFrame=function(){var iframe=documentCreateElement("iframe");var JS="java"+SCRIPT+":";var iframeDocument;iframe.style.display="none";html.appendChild(iframe);iframe.src=String(JS);iframeDocument=iframe.contentWindow.document;iframeDocument.open();iframeDocument.write(scriptTag("document.F=Object"));iframeDocument.close();return iframeDocument.F};var activeXDocument;var NullProtoObject=function(){try{activeXDocument=document.domain&&new ActiveXObject("htmlfile")}catch(error){}NullProtoObject=activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame();var length=enumBugKeys.length;while(length--)delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];return NullProtoObject()};hiddenKeys[IE_PROTO]=true;module.exports=Object.create||function create(O,Properties){var result;if(O!==null){EmptyConstructor[PROTOTYPE]=anObject(O);result=new EmptyConstructor;EmptyConstructor[PROTOTYPE]=null;result[IE_PROTO]=O}else result=NullProtoObject();return Properties===undefined?result:defineProperties(result,Properties)}},{"../internals/an-object":28,"../internals/document-create-element":62,"../internals/enum-bug-keys":67,"../internals/hidden-keys":79,"../internals/html":81,"../internals/object-define-properties":109,"../internals/shared-key":136}],109:[function(_dereq_,module,exports){var DESCRIPTORS=_dereq_("../internals/descriptors");var definePropertyModule=_dereq_("../internals/object-define-property");var anObject=_dereq_("../internals/an-object");var objectKeys=_dereq_("../internals/object-keys");module.exports=DESCRIPTORS?Object.defineProperties:function defineProperties(O,Properties){anObject(O);var keys=objectKeys(Properties);var length=keys.length;var index=0;var key;while(length>index)definePropertyModule.f(O,key=keys[index++],Properties[key]);return O}},{"../internals/an-object":28,"../internals/descriptors":61,"../internals/object-define-property":110,"../internals/object-keys":117}],110:[function(_dereq_,module,exports){var DESCRIPTORS=_dereq_("../internals/descriptors");var IE8_DOM_DEFINE=_dereq_("../internals/ie8-dom-define");var anObject=_dereq_("../internals/an-object");var toPrimitive=_dereq_("../internals/to-primitive");var nativeDefineProperty=Object.defineProperty;exports.f=DESCRIPTORS?nativeDefineProperty:function defineProperty(O,P,Attributes){anObject(O);P=toPrimitive(P,true);anObject(Attributes);if(IE8_DOM_DEFINE)try{return nativeDefineProperty(O,P,Attributes)}catch(error){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported");if("value"in Attributes)O[P]=Attributes.value;return O}},{"../internals/an-object":28,"../internals/descriptors":61,"../internals/ie8-dom-define":82,"../internals/to-primitive":158}],111:[function(_dereq_,module,exports){var DESCRIPTORS=_dereq_("../internals/descriptors");var propertyIsEnumerableModule=_dereq_("../internals/object-property-is-enumerable");var createPropertyDescriptor=_dereq_("../internals/create-property-descriptor");var toIndexedObject=_dereq_("../internals/to-indexed-object");var toPrimitive=_dereq_("../internals/to-primitive");var has=_dereq_("../internals/has");var IE8_DOM_DEFINE=_dereq_("../internals/ie8-dom-define");var nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;exports.f=DESCRIPTORS?nativeGetOwnPropertyDescriptor:function getOwnPropertyDescriptor(O,P){O=toIndexedObject(O);P=toPrimitive(P,true);if(IE8_DOM_DEFINE)try{return nativeGetOwnPropertyDescriptor(O,P)}catch(error){}if(has(O,P))return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O,P),O[P])}},{"../internals/create-property-descriptor":57,"../internals/descriptors":61,"../internals/has":78,"../internals/ie8-dom-define":82,"../internals/object-property-is-enumerable":118,"../internals/to-indexed-object":152,"../internals/to-primitive":158}],112:[function(_dereq_,module,exports){var toIndexedObject=_dereq_("../internals/to-indexed-object");var nativeGetOwnPropertyNames=_dereq_("../internals/object-get-own-property-names").f;var toString={}.toString;var windowNames=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var getWindowNames=function(it){try{return nativeGetOwnPropertyNames(it)}catch(error){return windowNames.slice()}};module.exports.f=function getOwnPropertyNames(it){return windowNames&&toString.call(it)=="[object Window]"?getWindowNames(it):nativeGetOwnPropertyNames(toIndexedObject(it))}},{"../internals/object-get-own-property-names":113,"../internals/to-indexed-object":152}],113:[function(_dereq_,module,exports){var internalObjectKeys=_dereq_("../internals/object-keys-internal");var enumBugKeys=_dereq_("../internals/enum-bug-keys");var hiddenKeys=enumBugKeys.concat("length","prototype");exports.f=Object.getOwnPropertyNames||function getOwnPropertyNames(O){return internalObjectKeys(O,hiddenKeys)}},{"../internals/enum-bug-keys":67,"../internals/object-keys-internal":116}],114:[function(_dereq_,module,exports){exports.f=Object.getOwnPropertySymbols},{}],115:[function(_dereq_,module,exports){var has=_dereq_("../internals/has");var toObject=_dereq_("../internals/to-object");var sharedKey=_dereq_("../internals/shared-key");var CORRECT_PROTOTYPE_GETTER=_dereq_("../internals/correct-prototype-getter");var IE_PROTO=sharedKey("IE_PROTO");var ObjectPrototype=Object.prototype;module.exports=CORRECT_PROTOTYPE_GETTER?Object.getPrototypeOf:function(O){O=toObject(O);if(has(O,IE_PROTO))return O[IE_PROTO];if(typeof O.constructor=="function"&&O instanceof O.constructor){return O.constructor.prototype}return O instanceof Object?ObjectPrototype:null}},{"../internals/correct-prototype-getter":53,"../internals/has":78,"../internals/shared-key":136,"../internals/to-object":155}],116:[function(_dereq_,module,exports){var has=_dereq_("../internals/has");var toIndexedObject=_dereq_("../internals/to-indexed-object");var indexOf=_dereq_("../internals/array-includes").indexOf;var hiddenKeys=_dereq_("../internals/hidden-keys");module.exports=function(object,names){var O=toIndexedObject(object);var i=0;var result=[];var key;for(key in O)!has(hiddenKeys,key)&&has(O,key)&&result.push(key);while(names.length>i)if(has(O,key=names[i++])){~indexOf(result,key)||result.push(key)}return result}},{"../internals/array-includes":36,"../internals/has":78,"../internals/hidden-keys":79,"../internals/to-indexed-object":152}],117:[function(_dereq_,module,exports){var internalObjectKeys=_dereq_("../internals/object-keys-internal");var enumBugKeys=_dereq_("../internals/enum-bug-keys");module.exports=Object.keys||function keys(O){return internalObjectKeys(O,enumBugKeys)}},{"../internals/enum-bug-keys":67,"../internals/object-keys-internal":116}],118:[function(_dereq_,module,exports){"use strict";var nativePropertyIsEnumerable={}.propertyIsEnumerable;var getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;var NASHORN_BUG=getOwnPropertyDescriptor&&!nativePropertyIsEnumerable.call({1:2},1);exports.f=NASHORN_BUG?function propertyIsEnumerable(V){var descriptor=getOwnPropertyDescriptor(this,V);return!!descriptor&&descriptor.enumerable}:nativePropertyIsEnumerable},{}],119:[function(_dereq_,module,exports){var anObject=_dereq_("../internals/an-object");var aPossiblePrototype=_dereq_("../internals/a-possible-prototype");module.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var CORRECT_SETTER=false;var test={};var setter;try{setter=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;setter.call(test,[]);CORRECT_SETTER=test instanceof Array}catch(error){}return function setPrototypeOf(O,proto){anObject(O);aPossiblePrototype(proto);if(CORRECT_SETTER)setter.call(O,proto);else O.__proto__=proto;return O}}():undefined)},{"../internals/a-possible-prototype":24,"../internals/an-object":28}],120:[function(_dereq_,module,exports){"use strict";var TO_STRING_TAG_SUPPORT=_dereq_("../internals/to-string-tag-support");var classof=_dereq_("../internals/classof");module.exports=TO_STRING_TAG_SUPPORT?{}.toString:function toString(){return"[object "+classof(this)+"]"}},{"../internals/classof":47,"../internals/to-string-tag-support":159}],121:[function(_dereq_,module,exports){var getBuiltIn=_dereq_("../internals/get-built-in");var getOwnPropertyNamesModule=_dereq_("../internals/object-get-own-property-names");var getOwnPropertySymbolsModule=_dereq_("../internals/object-get-own-property-symbols");var anObject=_dereq_("../internals/an-object");module.exports=getBuiltIn("Reflect","ownKeys")||function ownKeys(it){var keys=getOwnPropertyNamesModule.f(anObject(it));var getOwnPropertySymbols=getOwnPropertySymbolsModule.f;return getOwnPropertySymbols?keys.concat(getOwnPropertySymbols(it)):keys}},{"../internals/an-object":28,"../internals/get-built-in":74,"../internals/object-get-own-property-names":113,"../internals/object-get-own-property-symbols":114}],122:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");module.exports=global},{"../internals/global":77}],123:[function(_dereq_,module,exports){module.exports=function(exec){try{return{error:false,value:exec()}}catch(error){return{error:true,value:error}}}},{}],124:[function(_dereq_,module,exports){var anObject=_dereq_("../internals/an-object");var isObject=_dereq_("../internals/is-object");var newPromiseCapability=_dereq_("../internals/new-promise-capability");module.exports=function(C,x){anObject(C);if(isObject(x)&&x.constructor===C)return x;var promiseCapability=newPromiseCapability.f(C);var resolve=promiseCapability.resolve;resolve(x);return promiseCapability.promise}},{"../internals/an-object":28,"../internals/is-object":92,"../internals/new-promise-capability":104}],125:[function(_dereq_,module,exports){var redefine=_dereq_("../internals/redefine");module.exports=function(target,src,options){for(var key in src)redefine(target,key,src[key],options);return target}},{"../internals/redefine":126}],126:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var has=_dereq_("../internals/has");var setGlobal=_dereq_("../internals/set-global");var inspectSource=_dereq_("../internals/inspect-source");var InternalStateModule=_dereq_("../internals/internal-state");var getInternalState=InternalStateModule.get;var enforceInternalState=InternalStateModule.enforce;var TEMPLATE=String(String).split("String");(module.exports=function(O,key,value,options){var unsafe=options?!!options.unsafe:false;var simple=options?!!options.enumerable:false;var noTargetGet=options?!!options.noTargetGet:false;if(typeof value=="function"){if(typeof key=="string"&&!has(value,"name"))createNonEnumerableProperty(value,"name",key);enforceInternalState(value).source=TEMPLATE.join(typeof key=="string"?key:"")}if(O===global){if(simple)O[key]=value;else setGlobal(key,value);return}else if(!unsafe){delete O[key]}else if(!noTargetGet&&O[key]){simple=true}if(simple)O[key]=value;else createNonEnumerableProperty(O,key,value)})(Function.prototype,"toString",function toString(){return typeof this=="function"&&getInternalState(this).source||inspectSource(this)})},{"../internals/create-non-enumerable-property":56,"../internals/global":77,"../internals/has":78,"../internals/inspect-source":86,"../internals/internal-state":88,"../internals/set-global":133}],127:[function(_dereq_,module,exports){var classof=_dereq_("./classof-raw");var regexpExec=_dereq_("./regexp-exec");module.exports=function(R,S){var exec=R.exec;if(typeof exec==="function"){var result=exec.call(R,S);if(typeof result!=="object"){throw TypeError("RegExp exec method returned something other than an Object or null")}return result}if(classof(R)!=="RegExp"){throw TypeError("RegExp#exec called on incompatible receiver")}return regexpExec.call(R,S)}},{"./classof-raw":46,"./regexp-exec":128}],128:[function(_dereq_,module,exports){"use strict";var regexpFlags=_dereq_("./regexp-flags");var stickyHelpers=_dereq_("./regexp-sticky-helpers");var nativeExec=RegExp.prototype.exec;var nativeReplace=String.prototype.replace;var patchedExec=nativeExec;var UPDATES_LAST_INDEX_WRONG=function(){var re1=/a/;var re2=/b*/g;nativeExec.call(re1,"a");nativeExec.call(re2,"a");return re1.lastIndex!==0||re2.lastIndex!==0}();var UNSUPPORTED_Y=stickyHelpers.UNSUPPORTED_Y||stickyHelpers.BROKEN_CARET;var NPCG_INCLUDED=/()??/.exec("")[1]!==undefined;var PATCH=UPDATES_LAST_INDEX_WRONG||NPCG_INCLUDED||UNSUPPORTED_Y;if(PATCH){patchedExec=function exec(str){var re=this;var lastIndex,reCopy,match,i;var sticky=UNSUPPORTED_Y&&re.sticky;var flags=regexpFlags.call(re);var source=re.source;var charsAdded=0;var strCopy=str;if(sticky){flags=flags.replace("y","");if(flags.indexOf("g")===-1){flags+="g"}strCopy=String(str).slice(re.lastIndex);if(re.lastIndex>0&&(!re.multiline||re.multiline&&str[re.lastIndex-1]!=="\n")){source="(?: "+source+")";strCopy=" "+strCopy;charsAdded++}reCopy=new RegExp("^(?:"+source+")",flags)}if(NPCG_INCLUDED){reCopy=new RegExp("^"+source+"$(?!\\s)",flags)}if(UPDATES_LAST_INDEX_WRONG)lastIndex=re.lastIndex;match=nativeExec.call(sticky?reCopy:re,strCopy);if(sticky){if(match){match.input=match.input.slice(charsAdded);match[0]=match[0].slice(charsAdded);match.index=re.lastIndex;re.lastIndex+=match[0].length}else re.lastIndex=0}else if(UPDATES_LAST_INDEX_WRONG&&match){re.lastIndex=re.global?match.index+match[0].length:lastIndex}if(NPCG_INCLUDED&&match&&match.length>1){nativeReplace.call(match[0],reCopy,function(){for(i=1;i<arguments.length-2;i++){if(arguments[i]===undefined)match[i]=undefined}})}return match}}module.exports=patchedExec},{"./regexp-flags":129,"./regexp-sticky-helpers":130}],129:[function(_dereq_,module,exports){"use strict";var anObject=_dereq_("../internals/an-object");module.exports=function(){var that=anObject(this);var result="";if(that.global)result+="g";if(that.ignoreCase)result+="i";if(that.multiline)result+="m";if(that.dotAll)result+="s";if(that.unicode)result+="u";if(that.sticky)result+="y";return result}},{"../internals/an-object":28}],130:[function(_dereq_,module,exports){"use strict";var fails=_dereq_("./fails");function RE(s,f){return RegExp(s,f)}exports.UNSUPPORTED_Y=fails(function(){var re=RE("a","y");re.lastIndex=2;return re.exec("abcd")!=null});exports.BROKEN_CARET=fails(function(){var re=RE("^r","gy");re.lastIndex=2;return re.exec("str")!=null})},{"./fails":69}],131:[function(_dereq_,module,exports){module.exports=function(it){if(it==undefined)throw TypeError("Can't call method on "+it);return it}},{}],132:[function(_dereq_,module,exports){module.exports=Object.is||function is(x,y){return x===y?x!==0||1/x===1/y:x!=x&&y!=y}},{}],133:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");module.exports=function(key,value){try{createNonEnumerableProperty(global,key,value)}catch(error){global[key]=value}return value}},{"../internals/create-non-enumerable-property":56,"../internals/global":77}],134:[function(_dereq_,module,exports){"use strict";var getBuiltIn=_dereq_("../internals/get-built-in");var definePropertyModule=_dereq_("../internals/object-define-property");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var DESCRIPTORS=_dereq_("../internals/descriptors");var SPECIES=wellKnownSymbol("species");module.exports=function(CONSTRUCTOR_NAME){var Constructor=getBuiltIn(CONSTRUCTOR_NAME);var defineProperty=definePropertyModule.f;if(DESCRIPTORS&&Constructor&&!Constructor[SPECIES]){defineProperty(Constructor,SPECIES,{configurable:true,get:function(){return this}})}}},{"../internals/descriptors":61,"../internals/get-built-in":74,"../internals/object-define-property":110,"../internals/well-known-symbol":166}],135:[function(_dereq_,module,exports){var defineProperty=_dereq_("../internals/object-define-property").f;var has=_dereq_("../internals/has");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var TO_STRING_TAG=wellKnownSymbol("toStringTag");module.exports=function(it,TAG,STATIC){if(it&&!has(it=STATIC?it:it.prototype,TO_STRING_TAG)){defineProperty(it,TO_STRING_TAG,{configurable:true,value:TAG})}}},{"../internals/has":78,"../internals/object-define-property":110,"../internals/well-known-symbol":166}],136:[function(_dereq_,module,exports){var shared=_dereq_("../internals/shared");var uid=_dereq_("../internals/uid");var keys=shared("keys");module.exports=function(key){return keys[key]||(keys[key]=uid(key))}},{"../internals/shared":138,"../internals/uid":163}],137:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var setGlobal=_dereq_("../internals/set-global");var SHARED="__core-js_shared__";var store=global[SHARED]||setGlobal(SHARED,{});module.exports=store},{"../internals/global":77,"../internals/set-global":133}],138:[function(_dereq_,module,exports){var IS_PURE=_dereq_("../internals/is-pure");var store=_dereq_("../internals/shared-store");(module.exports=function(key,value){return store[key]||(store[key]=value!==undefined?value:{})})("versions",[]).push({version:"3.6.5",mode:IS_PURE?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},{"../internals/is-pure":93,"../internals/shared-store":137}],139:[function(_dereq_,module,exports){var anObject=_dereq_("../internals/an-object");var aFunction=_dereq_("../internals/a-function");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var SPECIES=wellKnownSymbol("species");module.exports=function(O,defaultConstructor){var C=anObject(O).constructor;var S;return C===undefined||(S=anObject(C)[SPECIES])==undefined?defaultConstructor:aFunction(S)}},{"../internals/a-function":23,"../internals/an-object":28,"../internals/well-known-symbol":166}],140:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");module.exports=function(METHOD_NAME){return fails(function(){var test=""[METHOD_NAME]('"');return test!==test.toLowerCase()||test.split('"').length>3})}},{"../internals/fails":69}],141:[function(_dereq_,module,exports){var toInteger=_dereq_("../internals/to-integer");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var createMethod=function(CONVERT_TO_STRING){return function($this,pos){var S=String(requireObjectCoercible($this));var position=toInteger(pos);var size=S.length;var first,second;if(position<0||position>=size)return CONVERT_TO_STRING?"":undefined;first=S.charCodeAt(position);return first<55296||first>56319||position+1===size||(second=S.charCodeAt(position+1))<56320||second>57343?CONVERT_TO_STRING?S.charAt(position):first:CONVERT_TO_STRING?S.slice(position,position+2):(first-55296<<10)+(second-56320)+65536}};module.exports={codeAt:createMethod(false),charAt:createMethod(true)}},{"../internals/require-object-coercible":131,"../internals/to-integer":153}],142:[function(_dereq_,module,exports){var userAgent=_dereq_("../internals/engine-user-agent");module.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(userAgent)},{"../internals/engine-user-agent":65}],143:[function(_dereq_,module,exports){var toLength=_dereq_("../internals/to-length");var repeat=_dereq_("../internals/string-repeat");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var ceil=Math.ceil;var createMethod=function(IS_END){return function($this,maxLength,fillString){var S=String(requireObjectCoercible($this));var stringLength=S.length;var fillStr=fillString===undefined?" ":String(fillString);var intMaxLength=toLength(maxLength);var fillLen,stringFiller;if(intMaxLength<=stringLength||fillStr=="")return S;fillLen=intMaxLength-stringLength;stringFiller=repeat.call(fillStr,ceil(fillLen/fillStr.length));if(stringFiller.length>fillLen)stringFiller=stringFiller.slice(0,fillLen);return IS_END?S+stringFiller:stringFiller+S}};module.exports={start:createMethod(false),end:createMethod(true)}},{"../internals/require-object-coercible":131,"../internals/string-repeat":145,"../internals/to-length":154}],144:[function(_dereq_,module,exports){"use strict";var maxInt=2147483647;var base=36;var tMin=1;var tMax=26;var skew=38;var damp=700;var initialBias=72;var initialN=128;var delimiter="-";var regexNonASCII=/[^\0-\u007E]/;var regexSeparators=/[.\u3002\uFF0E\uFF61]/g;var OVERFLOW_ERROR="Overflow: input needs wider integers to process";var baseMinusTMin=base-tMin;var floor=Math.floor;var stringFromCharCode=String.fromCharCode;var ucs2decode=function(string){var output=[];var counter=0;var length=string.length;while(counter<length){var value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){var extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output};var digitToBasic=function(digit){return digit+22+75*(digit<26)};var adapt=function(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin)}return floor(k+(baseMinusTMin+1)*delta/(delta+skew))};var encode=function(input){var output=[];input=ucs2decode(input);var inputLength=input.length;var n=initialN;var delta=0;var bias=initialBias;var i,currentValue;for(i=0;i<input.length;i++){currentValue=input[i];if(currentValue<128){output.push(stringFromCharCode(currentValue))}}var basicLength=output.length;var handledCPCount=basicLength;if(basicLength){output.push(delimiter)}while(handledCPCount<inputLength){var m=maxInt;for(i=0;i<input.length;i++){currentValue=input[i];if(currentValue>=n&&currentValue<m){m=currentValue}}var handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){throw RangeError(OVERFLOW_ERROR)}delta+=(m-n)*handledCPCountPlusOne;n=m;for(i=0;i<input.length;i++){currentValue=input[i];if(currentValue<n&&++delta>maxInt){throw RangeError(OVERFLOW_ERROR)}if(currentValue==n){var q=delta;for(var k=base;;k+=base){var t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t)break;var qMinusT=q-t;var baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}++delta;++n}return output.join("")};module.exports=function(input){var encoded=[];var labels=input.toLowerCase().replace(regexSeparators,".").split(".");var i,label;for(i=0;i<labels.length;i++){label=labels[i];encoded.push(regexNonASCII.test(label)?"xn--"+encode(label):label)}return encoded.join(".")}},{}],145:[function(_dereq_,module,exports){"use strict";var toInteger=_dereq_("../internals/to-integer");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");module.exports="".repeat||function repeat(count){var str=String(requireObjectCoercible(this));var result="";var n=toInteger(count);if(n<0||n==Infinity)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(str+=str))if(n&1)result+=str;return result}},{"../internals/require-object-coercible":131,"../internals/to-integer":153}],146:[function(_dereq_,module,exports){var fails=_dereq_("../internals/fails");var whitespaces=_dereq_("../internals/whitespaces");var non="​᠎";module.exports=function(METHOD_NAME){return fails(function(){return!!whitespaces[METHOD_NAME]()||non[METHOD_NAME]()!=non||whitespaces[METHOD_NAME].name!==METHOD_NAME})}},{"../internals/fails":69,"../internals/whitespaces":167}],147:[function(_dereq_,module,exports){var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var whitespaces=_dereq_("../internals/whitespaces");var whitespace="["+whitespaces+"]";var ltrim=RegExp("^"+whitespace+whitespace+"*");var rtrim=RegExp(whitespace+whitespace+"*$");var createMethod=function(TYPE){return function($this){var string=String(requireObjectCoercible($this));if(TYPE&1)string=string.replace(ltrim,"");if(TYPE&2)string=string.replace(rtrim,"");return string}};module.exports={start:createMethod(1),end:createMethod(2),trim:createMethod(3)}},{"../internals/require-object-coercible":131,"../internals/whitespaces":167}],148:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var fails=_dereq_("../internals/fails");var classof=_dereq_("../internals/classof-raw");var bind=_dereq_("../internals/function-bind-context");var html=_dereq_("../internals/html");var createElement=_dereq_("../internals/document-create-element");var IS_IOS=_dereq_("../internals/engine-is-ios");var location=global.location;var set=global.setImmediate;var clear=global.clearImmediate;var process=global.process;var MessageChannel=global.MessageChannel;var Dispatch=global.Dispatch;var counter=0;var queue={};var ONREADYSTATECHANGE="onreadystatechange";var defer,channel,port;var run=function(id){if(queue.hasOwnProperty(id)){var fn=queue[id];delete queue[id];fn()}};var runner=function(id){return function(){run(id)}};var listener=function(event){run(event.data)};var post=function(id){global.postMessage(id+"",location.protocol+"//"+location.host)};if(!set||!clear){set=function setImmediate(fn){var args=[];var i=1;while(arguments.length>i)args.push(arguments[i++]);queue[++counter]=function(){(typeof fn=="function"?fn:Function(fn)).apply(undefined,args)};defer(counter);return counter};clear=function clearImmediate(id){delete queue[id]};if(classof(process)=="process"){defer=function(id){process.nextTick(runner(id))}}else if(Dispatch&&Dispatch.now){defer=function(id){Dispatch.now(runner(id))}}else if(MessageChannel&&!IS_IOS){channel=new MessageChannel;port=channel.port2;channel.port1.onmessage=listener;defer=bind(port.postMessage,port,1)}else if(global.addEventListener&&typeof postMessage=="function"&&!global.importScripts&&!fails(post)&&location.protocol!=="file:"){defer=post;global.addEventListener("message",listener,false)}else if(ONREADYSTATECHANGE in createElement("script")){defer=function(id){html.appendChild(createElement("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this);run(id)}}}else{defer=function(id){setTimeout(runner(id),0)}}}module.exports={set:set,clear:clear}},{"../internals/classof-raw":46,"../internals/document-create-element":62,"../internals/engine-is-ios":64,"../internals/fails":69,"../internals/function-bind-context":72,"../internals/global":77,"../internals/html":81}],149:[function(_dereq_,module,exports){var classof=_dereq_("../internals/classof-raw");module.exports=function(value){if(typeof value!="number"&&classof(value)!="Number"){throw TypeError("Incorrect invocation")}return+value}},{"../internals/classof-raw":46}],150:[function(_dereq_,module,exports){var toInteger=_dereq_("../internals/to-integer");var max=Math.max;var min=Math.min;module.exports=function(index,length){var integer=toInteger(index);return integer<0?max(integer+length,0):min(integer,length)}},{"../internals/to-integer":153}],151:[function(_dereq_,module,exports){var toInteger=_dereq_("../internals/to-integer");var toLength=_dereq_("../internals/to-length");module.exports=function(it){if(it===undefined)return 0;var number=toInteger(it);var length=toLength(number);if(number!==length)throw RangeError("Wrong length or index");return length}},{"../internals/to-integer":153,"../internals/to-length":154}],152:[function(_dereq_,module,exports){var IndexedObject=_dereq_("../internals/indexed-object");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");module.exports=function(it){return IndexedObject(requireObjectCoercible(it))}},{"../internals/indexed-object":84,"../internals/require-object-coercible":131}],153:[function(_dereq_,module,exports){var ceil=Math.ceil;var floor=Math.floor;module.exports=function(argument){return isNaN(argument=+argument)?0:(argument>0?floor:ceil)(argument)}},{}],154:[function(_dereq_,module,exports){var toInteger=_dereq_("../internals/to-integer");var min=Math.min;module.exports=function(argument){return argument>0?min(toInteger(argument),9007199254740991):0}},{"../internals/to-integer":153}],155:[function(_dereq_,module,exports){var requireObjectCoercible=_dereq_("../internals/require-object-coercible");module.exports=function(argument){return Object(requireObjectCoercible(argument))}},{"../internals/require-object-coercible":131}],156:[function(_dereq_,module,exports){var toPositiveInteger=_dereq_("../internals/to-positive-integer");module.exports=function(it,BYTES){var offset=toPositiveInteger(it);if(offset%BYTES)throw RangeError("Wrong offset");return offset}},{"../internals/to-positive-integer":157}],157:[function(_dereq_,module,exports){var toInteger=_dereq_("../internals/to-integer");module.exports=function(it){var result=toInteger(it);if(result<0)throw RangeError("The argument can't be less than 0");return result}},{"../internals/to-integer":153}],158:[function(_dereq_,module,exports){var isObject=_dereq_("../internals/is-object");module.exports=function(input,PREFERRED_STRING){if(!isObject(input))return input;var fn,val;if(PREFERRED_STRING&&typeof(fn=input.toString)=="function"&&!isObject(val=fn.call(input)))return val;if(typeof(fn=input.valueOf)=="function"&&!isObject(val=fn.call(input)))return val;if(!PREFERRED_STRING&&typeof(fn=input.toString)=="function"&&!isObject(val=fn.call(input)))return val;throw TypeError("Can't convert object to primitive value")}},{"../internals/is-object":92}],159:[function(_dereq_,module,exports){var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var TO_STRING_TAG=wellKnownSymbol("toStringTag");var test={};test[TO_STRING_TAG]="z";module.exports=String(test)==="[object z]"},{"../internals/well-known-symbol":166}],160:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var global=_dereq_("../internals/global");var DESCRIPTORS=_dereq_("../internals/descriptors");var TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS=_dereq_("../internals/typed-array-constructors-require-wrappers");var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var ArrayBufferModule=_dereq_("../internals/array-buffer");var anInstance=_dereq_("../internals/an-instance");var createPropertyDescriptor=_dereq_("../internals/create-property-descriptor");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var toLength=_dereq_("../internals/to-length");var toIndex=_dereq_("../internals/to-index");var toOffset=_dereq_("../internals/to-offset");var toPrimitive=_dereq_("../internals/to-primitive");var has=_dereq_("../internals/has");var classof=_dereq_("../internals/classof");var isObject=_dereq_("../internals/is-object");var create=_dereq_("../internals/object-create");var setPrototypeOf=_dereq_("../internals/object-set-prototype-of");var getOwnPropertyNames=_dereq_("../internals/object-get-own-property-names").f;var typedArrayFrom=_dereq_("../internals/typed-array-from");var forEach=_dereq_("../internals/array-iteration").forEach;var setSpecies=_dereq_("../internals/set-species");var definePropertyModule=_dereq_("../internals/object-define-property");var getOwnPropertyDescriptorModule=_dereq_("../internals/object-get-own-property-descriptor");var InternalStateModule=_dereq_("../internals/internal-state");var inheritIfRequired=_dereq_("../internals/inherit-if-required");var getInternalState=InternalStateModule.get;var setInternalState=InternalStateModule.set;var nativeDefineProperty=definePropertyModule.f;var nativeGetOwnPropertyDescriptor=getOwnPropertyDescriptorModule.f;var round=Math.round;var RangeError=global.RangeError;var ArrayBuffer=ArrayBufferModule.ArrayBuffer;var DataView=ArrayBufferModule.DataView;var NATIVE_ARRAY_BUFFER_VIEWS=ArrayBufferViewCore.NATIVE_ARRAY_BUFFER_VIEWS;var TYPED_ARRAY_TAG=ArrayBufferViewCore.TYPED_ARRAY_TAG;var TypedArray=ArrayBufferViewCore.TypedArray;var TypedArrayPrototype=ArrayBufferViewCore.TypedArrayPrototype;var aTypedArrayConstructor=ArrayBufferViewCore.aTypedArrayConstructor;var isTypedArray=ArrayBufferViewCore.isTypedArray;var BYTES_PER_ELEMENT="BYTES_PER_ELEMENT";var WRONG_LENGTH="Wrong length";var fromList=function(C,list){var index=0;var length=list.length;var result=new(aTypedArrayConstructor(C))(length);while(length>index)result[index]=list[index++];return result};var addGetter=function(it,key){nativeDefineProperty(it,key,{get:function(){return getInternalState(this)[key]}})};var isArrayBuffer=function(it){var klass;return it instanceof ArrayBuffer||(klass=classof(it))=="ArrayBuffer"||klass=="SharedArrayBuffer"};var isTypedArrayIndex=function(target,key){return isTypedArray(target)&&typeof key!="symbol"&&key in target&&String(+key)==String(key)};var wrappedGetOwnPropertyDescriptor=function getOwnPropertyDescriptor(target,key){return isTypedArrayIndex(target,key=toPrimitive(key,true))?createPropertyDescriptor(2,target[key]):nativeGetOwnPropertyDescriptor(target,key)};var wrappedDefineProperty=function defineProperty(target,key,descriptor){if(isTypedArrayIndex(target,key=toPrimitive(key,true))&&isObject(descriptor)&&has(descriptor,"value")&&!has(descriptor,"get")&&!has(descriptor,"set")&&!descriptor.configurable&&(!has(descriptor,"writable")||descriptor.writable)&&(!has(descriptor,"enumerable")||descriptor.enumerable)){target[key]=descriptor.value;return target}return nativeDefineProperty(target,key,descriptor)};if(DESCRIPTORS){if(!NATIVE_ARRAY_BUFFER_VIEWS){getOwnPropertyDescriptorModule.f=wrappedGetOwnPropertyDescriptor;definePropertyModule.f=wrappedDefineProperty;addGetter(TypedArrayPrototype,"buffer");addGetter(TypedArrayPrototype,"byteOffset");addGetter(TypedArrayPrototype,"byteLength");addGetter(TypedArrayPrototype,"length")}$({target:"Object",stat:true,forced:!NATIVE_ARRAY_BUFFER_VIEWS},{getOwnPropertyDescriptor:wrappedGetOwnPropertyDescriptor,defineProperty:wrappedDefineProperty});module.exports=function(TYPE,wrapper,CLAMPED){var BYTES=TYPE.match(/\d+$/)[0]/8;var CONSTRUCTOR_NAME=TYPE+(CLAMPED?"Clamped":"")+"Array";var GETTER="get"+TYPE;var SETTER="set"+TYPE;var NativeTypedArrayConstructor=global[CONSTRUCTOR_NAME];var TypedArrayConstructor=NativeTypedArrayConstructor;var TypedArrayConstructorPrototype=TypedArrayConstructor&&TypedArrayConstructor.prototype;var exported={};var getter=function(that,index){var data=getInternalState(that);return data.view[GETTER](index*BYTES+data.byteOffset,true)};var setter=function(that,index,value){var data=getInternalState(that);if(CLAMPED)value=(value=round(value))<0?0:value>255?255:value&255;data.view[SETTER](index*BYTES+data.byteOffset,value,true)};var addElement=function(that,index){nativeDefineProperty(that,index,{get:function(){return getter(this,index)},set:function(value){return setter(this,index,value)},enumerable:true})};if(!NATIVE_ARRAY_BUFFER_VIEWS){TypedArrayConstructor=wrapper(function(that,data,offset,$length){anInstance(that,TypedArrayConstructor,CONSTRUCTOR_NAME);var index=0;var byteOffset=0;var buffer,byteLength,length;if(!isObject(data)){length=toIndex(data);byteLength=length*BYTES;buffer=new ArrayBuffer(byteLength)}else if(isArrayBuffer(data)){buffer=data;byteOffset=toOffset(offset,BYTES);var $len=data.byteLength;if($length===undefined){if($len%BYTES)throw RangeError(WRONG_LENGTH);byteLength=$len-byteOffset;if(byteLength<0)throw RangeError(WRONG_LENGTH)}else{byteLength=toLength($length)*BYTES;if(byteLength+byteOffset>$len)throw RangeError(WRONG_LENGTH)}length=byteLength/BYTES}else if(isTypedArray(data)){return fromList(TypedArrayConstructor,data)}else{return typedArrayFrom.call(TypedArrayConstructor,data)}setInternalState(that,{buffer:buffer,byteOffset:byteOffset,byteLength:byteLength,length:length,view:new DataView(buffer)});while(index<length)addElement(that,index++)});if(setPrototypeOf)setPrototypeOf(TypedArrayConstructor,TypedArray);TypedArrayConstructorPrototype=TypedArrayConstructor.prototype=create(TypedArrayPrototype)}else if(TYPED_ARRAYS_CONSTRUCTORS_REQUIRES_WRAPPERS){TypedArrayConstructor=wrapper(function(dummy,data,typedArrayOffset,$length){anInstance(dummy,TypedArrayConstructor,CONSTRUCTOR_NAME);return inheritIfRequired(function(){if(!isObject(data))return new NativeTypedArrayConstructor(toIndex(data));if(isArrayBuffer(data))return $length!==undefined?new NativeTypedArrayConstructor(data,toOffset(typedArrayOffset,BYTES),$length):typedArrayOffset!==undefined?new NativeTypedArrayConstructor(data,toOffset(typedArrayOffset,BYTES)):new NativeTypedArrayConstructor(data);if(isTypedArray(data))return fromList(TypedArrayConstructor,data);return typedArrayFrom.call(TypedArrayConstructor,data)}(),dummy,TypedArrayConstructor)});if(setPrototypeOf)setPrototypeOf(TypedArrayConstructor,TypedArray);forEach(getOwnPropertyNames(NativeTypedArrayConstructor),function(key){if(!(key in TypedArrayConstructor)){createNonEnumerableProperty(TypedArrayConstructor,key,NativeTypedArrayConstructor[key])}});TypedArrayConstructor.prototype=TypedArrayConstructorPrototype}if(TypedArrayConstructorPrototype.constructor!==TypedArrayConstructor){createNonEnumerableProperty(TypedArrayConstructorPrototype,"constructor",TypedArrayConstructor)}if(TYPED_ARRAY_TAG){createNonEnumerableProperty(TypedArrayConstructorPrototype,TYPED_ARRAY_TAG,CONSTRUCTOR_NAME)}exported[CONSTRUCTOR_NAME]=TypedArrayConstructor;$({global:true,forced:TypedArrayConstructor!=NativeTypedArrayConstructor,sham:!NATIVE_ARRAY_BUFFER_VIEWS},exported);if(!(BYTES_PER_ELEMENT in TypedArrayConstructor)){createNonEnumerableProperty(TypedArrayConstructor,BYTES_PER_ELEMENT,BYTES)}if(!(BYTES_PER_ELEMENT in TypedArrayConstructorPrototype)){createNonEnumerableProperty(TypedArrayConstructorPrototype,BYTES_PER_ELEMENT,BYTES)}setSpecies(CONSTRUCTOR_NAME)}}else module.exports=function(){}},{"../internals/an-instance":27,"../internals/array-buffer":31,"../internals/array-buffer-view-core":30,"../internals/array-iteration":37,"../internals/classof":47,"../internals/create-non-enumerable-property":56,"../internals/create-property-descriptor":57,"../internals/descriptors":61,"../internals/export":68,"../internals/global":77,"../internals/has":78,"../internals/inherit-if-required":85,"../internals/internal-state":88,"../internals/is-object":92,"../internals/object-create":108,"../internals/object-define-property":110,"../internals/object-get-own-property-descriptor":111,"../internals/object-get-own-property-names":113,"../internals/object-set-prototype-of":119,"../internals/set-species":134,"../internals/to-index":151,"../internals/to-length":154,"../internals/to-offset":156,"../internals/to-primitive":158,"../internals/typed-array-constructors-require-wrappers":161,"../internals/typed-array-from":162}],161:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var fails=_dereq_("../internals/fails");var checkCorrectnessOfIteration=_dereq_("../internals/check-correctness-of-iteration");var NATIVE_ARRAY_BUFFER_VIEWS=_dereq_("../internals/array-buffer-view-core").NATIVE_ARRAY_BUFFER_VIEWS;var ArrayBuffer=global.ArrayBuffer;var Int8Array=global.Int8Array;module.exports=!NATIVE_ARRAY_BUFFER_VIEWS||!fails(function(){Int8Array(1)})||!fails(function(){new Int8Array(-1)})||!checkCorrectnessOfIteration(function(iterable){new Int8Array;new Int8Array(null);new Int8Array(1.5);new Int8Array(iterable)},true)||fails(function(){return new Int8Array(new ArrayBuffer(2),1,undefined).length!==1})},{"../internals/array-buffer-view-core":30,"../internals/check-correctness-of-iteration":45,"../internals/fails":69,"../internals/global":77}],162:[function(_dereq_,module,exports){var toObject=_dereq_("../internals/to-object");var toLength=_dereq_("../internals/to-length");var getIteratorMethod=_dereq_("../internals/get-iterator-method");var isArrayIteratorMethod=_dereq_("../internals/is-array-iterator-method");var bind=_dereq_("../internals/function-bind-context");var aTypedArrayConstructor=_dereq_("../internals/array-buffer-view-core").aTypedArrayConstructor;module.exports=function from(source){var O=toObject(source);var argumentsLength=arguments.length;var mapfn=argumentsLength>1?arguments[1]:undefined;var mapping=mapfn!==undefined;var iteratorMethod=getIteratorMethod(O);var i,length,result,step,iterator,next;if(iteratorMethod!=undefined&&!isArrayIteratorMethod(iteratorMethod)){iterator=iteratorMethod.call(O);next=iterator.next;O=[];while(!(step=next.call(iterator)).done){O.push(step.value)}}if(mapping&&argumentsLength>2){mapfn=bind(mapfn,arguments[2],2)}length=toLength(O.length);result=new(aTypedArrayConstructor(this))(length);for(i=0;length>i;i++){result[i]=mapping?mapfn(O[i],i):O[i]}return result}},{"../internals/array-buffer-view-core":30,"../internals/function-bind-context":72,"../internals/get-iterator-method":75,"../internals/is-array-iterator-method":89,"../internals/to-length":154,"../internals/to-object":155}],163:[function(_dereq_,module,exports){var id=0;var postfix=Math.random();module.exports=function(key){return"Symbol("+String(key===undefined?"":key)+")_"+(++id+postfix).toString(36)}},{}],164:[function(_dereq_,module,exports){var NATIVE_SYMBOL=_dereq_("../internals/native-symbol");module.exports=NATIVE_SYMBOL&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/native-symbol":101}],165:[function(_dereq_,module,exports){var wellKnownSymbol=_dereq_("../internals/well-known-symbol");exports.f=wellKnownSymbol},{"../internals/well-known-symbol":166}],166:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var shared=_dereq_("../internals/shared");var has=_dereq_("../internals/has");var uid=_dereq_("../internals/uid");var NATIVE_SYMBOL=_dereq_("../internals/native-symbol");var USE_SYMBOL_AS_UID=_dereq_("../internals/use-symbol-as-uid");var WellKnownSymbolsStore=shared("wks");var Symbol=global.Symbol;var createWellKnownSymbol=USE_SYMBOL_AS_UID?Symbol:Symbol&&Symbol.withoutSetter||uid;module.exports=function(name){if(!has(WellKnownSymbolsStore,name)){if(NATIVE_SYMBOL&&has(Symbol,name))WellKnownSymbolsStore[name]=Symbol[name];else WellKnownSymbolsStore[name]=createWellKnownSymbol("Symbol."+name)}return WellKnownSymbolsStore[name]}},{"../internals/global":77,"../internals/has":78,"../internals/native-symbol":101,"../internals/shared":138,"../internals/uid":163,"../internals/use-symbol-as-uid":164}],167:[function(_dereq_,module,exports){module.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},{}],168:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var global=_dereq_("../internals/global");var arrayBufferModule=_dereq_("../internals/array-buffer");var setSpecies=_dereq_("../internals/set-species");var ARRAY_BUFFER="ArrayBuffer";var ArrayBuffer=arrayBufferModule[ARRAY_BUFFER];var NativeArrayBuffer=global[ARRAY_BUFFER];$({global:true,forced:NativeArrayBuffer!==ArrayBuffer},{ArrayBuffer:ArrayBuffer});setSpecies(ARRAY_BUFFER)},{"../internals/array-buffer":31,"../internals/export":68,"../internals/global":77,"../internals/set-species":134}],169:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var fails=_dereq_("../internals/fails");var isArray=_dereq_("../internals/is-array");var isObject=_dereq_("../internals/is-object");var toObject=_dereq_("../internals/to-object");var toLength=_dereq_("../internals/to-length");var createProperty=_dereq_("../internals/create-property");var arraySpeciesCreate=_dereq_("../internals/array-species-create");var arrayMethodHasSpeciesSupport=_dereq_("../internals/array-method-has-species-support");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var V8_VERSION=_dereq_("../internals/engine-v8-version");var IS_CONCAT_SPREADABLE=wellKnownSymbol("isConcatSpreadable");var MAX_SAFE_INTEGER=9007199254740991;var MAXIMUM_ALLOWED_INDEX_EXCEEDED="Maximum allowed index exceeded";var IS_CONCAT_SPREADABLE_SUPPORT=V8_VERSION>=51||!fails(function(){var array=[];array[IS_CONCAT_SPREADABLE]=false;return array.concat()[0]!==array});var SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("concat");var isConcatSpreadable=function(O){if(!isObject(O))return false;var spreadable=O[IS_CONCAT_SPREADABLE];return spreadable!==undefined?!!spreadable:isArray(O)};var FORCED=!IS_CONCAT_SPREADABLE_SUPPORT||!SPECIES_SUPPORT;$({target:"Array",proto:true,forced:FORCED},{concat:function concat(arg){var O=toObject(this);var A=arraySpeciesCreate(O,0);var n=0;var i,k,length,len,E;for(i=-1,length=arguments.length;i<length;i++){E=i===-1?O:arguments[i];if(isConcatSpreadable(E)){len=toLength(E.length);if(n+len>MAX_SAFE_INTEGER)throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);for(k=0;k<len;k++,n++)if(k in E)createProperty(A,n,E[k])}else{if(n>=MAX_SAFE_INTEGER)throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);createProperty(A,n++,E)}}A.length=n;return A}})},{"../internals/array-method-has-species-support":39,"../internals/array-species-create":43,"../internals/create-property":58,"../internals/engine-v8-version":66,"../internals/export":68,"../internals/fails":69,"../internals/is-array":90,"../internals/is-object":92,"../internals/to-length":154,"../internals/to-object":155,"../internals/well-known-symbol":166}],170:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var copyWithin=_dereq_("../internals/array-copy-within");var addToUnscopables=_dereq_("../internals/add-to-unscopables");$({target:"Array",proto:true},{copyWithin:copyWithin});addToUnscopables("copyWithin")},{"../internals/add-to-unscopables":25,"../internals/array-copy-within":32,"../internals/export":68}],171:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var $every=_dereq_("../internals/array-iteration").every;var arrayMethodIsStrict=_dereq_("../internals/array-method-is-strict");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var STRICT_METHOD=arrayMethodIsStrict("every");var USES_TO_LENGTH=arrayMethodUsesToLength("every");$({target:"Array",proto:true,forced:!STRICT_METHOD||!USES_TO_LENGTH},{every:function every(callbackfn){return $every(this,callbackfn,arguments.length>1?arguments[1]:undefined)}})},{"../internals/array-iteration":37,"../internals/array-method-is-strict":40,"../internals/array-method-uses-to-length":41,"../internals/export":68}],172:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var fill=_dereq_("../internals/array-fill");var addToUnscopables=_dereq_("../internals/add-to-unscopables");$({target:"Array",proto:true},{fill:fill});addToUnscopables("fill")},{"../internals/add-to-unscopables":25,"../internals/array-fill":33,"../internals/export":68}],173:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var $filter=_dereq_("../internals/array-iteration").filter;var arrayMethodHasSpeciesSupport=_dereq_("../internals/array-method-has-species-support");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("filter");var USES_TO_LENGTH=arrayMethodUsesToLength("filter");$({target:"Array",proto:true,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH},{filter:function filter(callbackfn){return $filter(this,callbackfn,arguments.length>1?arguments[1]:undefined)}})},{"../internals/array-iteration":37,"../internals/array-method-has-species-support":39,"../internals/array-method-uses-to-length":41,"../internals/export":68}],174:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var $findIndex=_dereq_("../internals/array-iteration").findIndex;var addToUnscopables=_dereq_("../internals/add-to-unscopables");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var FIND_INDEX="findIndex";var SKIPS_HOLES=true;var USES_TO_LENGTH=arrayMethodUsesToLength(FIND_INDEX);if(FIND_INDEX in[])Array(1)[FIND_INDEX](function(){SKIPS_HOLES=false});$({target:"Array",proto:true,forced:SKIPS_HOLES||!USES_TO_LENGTH},{findIndex:function findIndex(callbackfn){return $findIndex(this,callbackfn,arguments.length>1?arguments[1]:undefined)}});addToUnscopables(FIND_INDEX)},{"../internals/add-to-unscopables":25,"../internals/array-iteration":37,"../internals/array-method-uses-to-length":41,"../internals/export":68}],175:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var forEach=_dereq_("../internals/array-for-each");$({target:"Array",proto:true,forced:[].forEach!=forEach},{forEach:forEach})},{"../internals/array-for-each":34,"../internals/export":68}],176:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var from=_dereq_("../internals/array-from");var checkCorrectnessOfIteration=_dereq_("../internals/check-correctness-of-iteration");var INCORRECT_ITERATION=!checkCorrectnessOfIteration(function(iterable){Array.from(iterable)});$({target:"Array",stat:true,forced:INCORRECT_ITERATION},{from:from})},{"../internals/array-from":35,"../internals/check-correctness-of-iteration":45,"../internals/export":68}],177:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var $includes=_dereq_("../internals/array-includes").includes;var addToUnscopables=_dereq_("../internals/add-to-unscopables");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var USES_TO_LENGTH=arrayMethodUsesToLength("indexOf",{ACCESSORS:true,1:0});$({target:"Array",proto:true,forced:!USES_TO_LENGTH},{includes:function includes(el){return $includes(this,el,arguments.length>1?arguments[1]:undefined)}});addToUnscopables("includes")},{"../internals/add-to-unscopables":25,"../internals/array-includes":36,"../internals/array-method-uses-to-length":41,"../internals/export":68}],178:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var $indexOf=_dereq_("../internals/array-includes").indexOf;var arrayMethodIsStrict=_dereq_("../internals/array-method-is-strict");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var nativeIndexOf=[].indexOf;var NEGATIVE_ZERO=!!nativeIndexOf&&1/[1].indexOf(1,-0)<0;var STRICT_METHOD=arrayMethodIsStrict("indexOf");var USES_TO_LENGTH=arrayMethodUsesToLength("indexOf",{ACCESSORS:true,1:0});$({target:"Array",proto:true,forced:NEGATIVE_ZERO||!STRICT_METHOD||!USES_TO_LENGTH},{indexOf:function indexOf(searchElement){return NEGATIVE_ZERO?nativeIndexOf.apply(this,arguments)||0:$indexOf(this,searchElement,arguments.length>1?arguments[1]:undefined)}})},{"../internals/array-includes":36,"../internals/array-method-is-strict":40,"../internals/array-method-uses-to-length":41,"../internals/export":68}],179:[function(_dereq_,module,exports){"use strict";var toIndexedObject=_dereq_("../internals/to-indexed-object");var addToUnscopables=_dereq_("../internals/add-to-unscopables");var Iterators=_dereq_("../internals/iterators");var InternalStateModule=_dereq_("../internals/internal-state");var defineIterator=_dereq_("../internals/define-iterator");var ARRAY_ITERATOR="Array Iterator";var setInternalState=InternalStateModule.set;var getInternalState=InternalStateModule.getterFor(ARRAY_ITERATOR);module.exports=defineIterator(Array,"Array",function(iterated,kind){setInternalState(this,{type:ARRAY_ITERATOR,target:toIndexedObject(iterated),index:0,kind:kind})},function(){var state=getInternalState(this);var target=state.target;var kind=state.kind;var index=state.index++;if(!target||index>=target.length){state.target=undefined;return{value:undefined,done:true}}if(kind=="keys")return{value:index,done:false};if(kind=="values")return{value:target[index],done:false};return{value:[index,target[index]],done:false}},"values");Iterators.Arguments=Iterators.Array;addToUnscopables("keys");addToUnscopables("values");addToUnscopables("entries")},{"../internals/add-to-unscopables":25,"../internals/define-iterator":59,"../internals/internal-state":88,"../internals/iterators":97,"../internals/to-indexed-object":152}],180:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var IndexedObject=_dereq_("../internals/indexed-object");var toIndexedObject=_dereq_("../internals/to-indexed-object");var arrayMethodIsStrict=_dereq_("../internals/array-method-is-strict");var nativeJoin=[].join;var ES3_STRINGS=IndexedObject!=Object;var STRICT_METHOD=arrayMethodIsStrict("join",",");$({target:"Array",proto:true,forced:ES3_STRINGS||!STRICT_METHOD},{join:function join(separator){return nativeJoin.call(toIndexedObject(this),separator===undefined?",":separator)}})},{"../internals/array-method-is-strict":40,"../internals/export":68,"../internals/indexed-object":84,"../internals/to-indexed-object":152}],181:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var lastIndexOf=_dereq_("../internals/array-last-index-of");$({target:"Array",proto:true,forced:lastIndexOf!==[].lastIndexOf},{lastIndexOf:lastIndexOf})},{"../internals/array-last-index-of":38,"../internals/export":68}],182:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var $map=_dereq_("../internals/array-iteration").map;var arrayMethodHasSpeciesSupport=_dereq_("../internals/array-method-has-species-support");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("map");var USES_TO_LENGTH=arrayMethodUsesToLength("map");$({target:"Array",proto:true,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH},{map:function map(callbackfn){return $map(this,callbackfn,arguments.length>1?arguments[1]:undefined)}})},{"../internals/array-iteration":37,"../internals/array-method-has-species-support":39,"../internals/array-method-uses-to-length":41,"../internals/export":68}],183:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var isObject=_dereq_("../internals/is-object");var isArray=_dereq_("../internals/is-array");var toAbsoluteIndex=_dereq_("../internals/to-absolute-index");var toLength=_dereq_("../internals/to-length");var toIndexedObject=_dereq_("../internals/to-indexed-object");var createProperty=_dereq_("../internals/create-property");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var arrayMethodHasSpeciesSupport=_dereq_("../internals/array-method-has-species-support");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("slice");var USES_TO_LENGTH=arrayMethodUsesToLength("slice",{ACCESSORS:true,0:0,1:2});var SPECIES=wellKnownSymbol("species");var nativeSlice=[].slice;var max=Math.max;$({target:"Array",proto:true,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH},{slice:function slice(start,end){var O=toIndexedObject(this);var length=toLength(O.length);var k=toAbsoluteIndex(start,length);var fin=toAbsoluteIndex(end===undefined?length:end,length);var Constructor,result,n;if(isArray(O)){Constructor=O.constructor;if(typeof Constructor=="function"&&(Constructor===Array||isArray(Constructor.prototype))){Constructor=undefined}else if(isObject(Constructor)){Constructor=Constructor[SPECIES];if(Constructor===null)Constructor=undefined}if(Constructor===Array||Constructor===undefined){return nativeSlice.call(O,k,fin)}}result=new(Constructor===undefined?Array:Constructor)(max(fin-k,0));for(n=0;k<fin;k++,n++)if(k in O)createProperty(result,n,O[k]);result.length=n;return result}})},{"../internals/array-method-has-species-support":39,"../internals/array-method-uses-to-length":41,"../internals/create-property":58,"../internals/export":68,"../internals/is-array":90,"../internals/is-object":92,"../internals/to-absolute-index":150,"../internals/to-indexed-object":152,"../internals/to-length":154,"../internals/well-known-symbol":166}],184:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var $some=_dereq_("../internals/array-iteration").some;var arrayMethodIsStrict=_dereq_("../internals/array-method-is-strict");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var STRICT_METHOD=arrayMethodIsStrict("some");var USES_TO_LENGTH=arrayMethodUsesToLength("some");$({target:"Array",proto:true,forced:!STRICT_METHOD||!USES_TO_LENGTH},{some:function some(callbackfn){return $some(this,callbackfn,arguments.length>1?arguments[1]:undefined)}})},{"../internals/array-iteration":37,"../internals/array-method-is-strict":40,"../internals/array-method-uses-to-length":41,"../internals/export":68}],185:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var toAbsoluteIndex=_dereq_("../internals/to-absolute-index");var toInteger=_dereq_("../internals/to-integer");var toLength=_dereq_("../internals/to-length");var toObject=_dereq_("../internals/to-object");var arraySpeciesCreate=_dereq_("../internals/array-species-create");var createProperty=_dereq_("../internals/create-property");var arrayMethodHasSpeciesSupport=_dereq_("../internals/array-method-has-species-support");var arrayMethodUsesToLength=_dereq_("../internals/array-method-uses-to-length");var HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("splice");var USES_TO_LENGTH=arrayMethodUsesToLength("splice",{ACCESSORS:true,0:0,1:2});var max=Math.max;var min=Math.min;var MAX_SAFE_INTEGER=9007199254740991;var MAXIMUM_ALLOWED_LENGTH_EXCEEDED="Maximum allowed length exceeded";$({target:"Array",proto:true,forced:!HAS_SPECIES_SUPPORT||!USES_TO_LENGTH},{splice:function splice(start,deleteCount){var O=toObject(this);var len=toLength(O.length);var actualStart=toAbsoluteIndex(start,len);var argumentsLength=arguments.length;var insertCount,actualDeleteCount,A,k,from,to;if(argumentsLength===0){insertCount=actualDeleteCount=0}else if(argumentsLength===1){insertCount=0;actualDeleteCount=len-actualStart}else{insertCount=argumentsLength-2;actualDeleteCount=min(max(toInteger(deleteCount),0),len-actualStart)}if(len+insertCount-actualDeleteCount>MAX_SAFE_INTEGER){throw TypeError(MAXIMUM_ALLOWED_LENGTH_EXCEEDED)}A=arraySpeciesCreate(O,actualDeleteCount);for(k=0;k<actualDeleteCount;k++){from=actualStart+k;if(from in O)createProperty(A,k,O[from])}A.length=actualDeleteCount;if(insertCount<actualDeleteCount){for(k=actualStart;k<len-actualDeleteCount;k++){from=k+actualDeleteCount;to=k+insertCount;if(from in O)O[to]=O[from];else delete O[to]}for(k=len;k>len-actualDeleteCount+insertCount;k--)delete O[k-1]}else if(insertCount>actualDeleteCount){for(k=len-actualDeleteCount;k>actualStart;k--){from=k+actualDeleteCount-1;to=k+insertCount-1;if(from in O)O[to]=O[from];else delete O[to]}}for(k=0;k<insertCount;k++){O[k+actualStart]=arguments[k+2]}O.length=len-actualDeleteCount+insertCount;return A}})},{"../internals/array-method-has-species-support":39,"../internals/array-method-uses-to-length":41,"../internals/array-species-create":43,"../internals/create-property":58,"../internals/export":68,"../internals/to-absolute-index":150,"../internals/to-integer":153,"../internals/to-length":154,"../internals/to-object":155}],186:[function(_dereq_,module,exports){var DESCRIPTORS=_dereq_("../internals/descriptors");var defineProperty=_dereq_("../internals/object-define-property").f;var FunctionPrototype=Function.prototype;var FunctionPrototypeToString=FunctionPrototype.toString;var nameRE=/^\s*function ([^ (]*)/;var NAME="name";if(DESCRIPTORS&&!(NAME in FunctionPrototype)){defineProperty(FunctionPrototype,NAME,{configurable:true,get:function(){try{return FunctionPrototypeToString.call(this).match(nameRE)[1]}catch(error){return""}}})}},{"../internals/descriptors":61,"../internals/object-define-property":110}],187:[function(_dereq_,module,exports){"use strict";var collection=_dereq_("../internals/collection");var collectionStrong=_dereq_("../internals/collection-strong");module.exports=collection("Map",function(init){return function Map(){return init(this,arguments.length?arguments[0]:undefined)}},collectionStrong)},{"../internals/collection":50,"../internals/collection-strong":48}],188:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var $hypot=Math.hypot;var abs=Math.abs;var sqrt=Math.sqrt;var BUGGY=!!$hypot&&$hypot(Infinity,NaN)!==Infinity;$({target:"Math",stat:true,forced:BUGGY},{hypot:function hypot(value1,value2){var sum=0;var i=0;var aLen=arguments.length;var larg=0;var arg,div;while(i<aLen){arg=abs(arguments[i++]);if(larg<arg){div=larg/arg;sum=sum*div*div+1;larg=arg}else if(arg>0){div=arg/larg;sum+=div*div}else sum+=arg}return larg===Infinity?Infinity:larg*sqrt(sum)}})},{"../internals/export":68}],189:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var log=Math.log;var LN2=Math.LN2;$({target:"Math",stat:true},{log2:function log2(x){return log(x)/LN2}})},{"../internals/export":68}],190:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var sign=_dereq_("../internals/math-sign");$({target:"Math",stat:true},{sign:sign})},{"../internals/export":68,"../internals/math-sign":98}],191:[function(_dereq_,module,exports){"use strict";var DESCRIPTORS=_dereq_("../internals/descriptors");var global=_dereq_("../internals/global");var isForced=_dereq_("../internals/is-forced");var redefine=_dereq_("../internals/redefine");var has=_dereq_("../internals/has");var classof=_dereq_("../internals/classof-raw");var inheritIfRequired=_dereq_("../internals/inherit-if-required");var toPrimitive=_dereq_("../internals/to-primitive");var fails=_dereq_("../internals/fails");var create=_dereq_("../internals/object-create");var getOwnPropertyNames=_dereq_("../internals/object-get-own-property-names").f;var getOwnPropertyDescriptor=_dereq_("../internals/object-get-own-property-descriptor").f;var defineProperty=_dereq_("../internals/object-define-property").f;var trim=_dereq_("../internals/string-trim").trim;var NUMBER="Number";var NativeNumber=global[NUMBER];var NumberPrototype=NativeNumber.prototype;var BROKEN_CLASSOF=classof(create(NumberPrototype))==NUMBER;var toNumber=function(argument){var it=toPrimitive(argument,false);var first,third,radix,maxCode,digits,length,index,code;if(typeof it=="string"&&it.length>2){it=trim(it);first=it.charCodeAt(0);if(first===43||first===45){third=it.charCodeAt(2);if(third===88||third===120)return NaN}else if(first===48){switch(it.charCodeAt(1)){case 66:case 98:radix=2;maxCode=49;break;case 79:case 111:radix=8;maxCode=55;break;default:return+it}digits=it.slice(2);length=digits.length;for(index=0;index<length;index++){code=digits.charCodeAt(index);if(code<48||code>maxCode)return NaN}return parseInt(digits,radix)}}return+it};if(isForced(NUMBER,!NativeNumber(" 0o1")||!NativeNumber("0b1")||NativeNumber("+0x1"))){var NumberWrapper=function Number(value){var it=arguments.length<1?0:value;var dummy=this;return dummy instanceof NumberWrapper&&(BROKEN_CLASSOF?fails(function(){NumberPrototype.valueOf.call(dummy)}):classof(dummy)!=NUMBER)?inheritIfRequired(new NativeNumber(toNumber(it)),dummy,NumberWrapper):toNumber(it)};for(var keys=DESCRIPTORS?getOwnPropertyNames(NativeNumber):("MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,"+"EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,"+"MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger").split(","),j=0,key;keys.length>j;j++){if(has(NativeNumber,key=keys[j])&&!has(NumberWrapper,key)){defineProperty(NumberWrapper,key,getOwnPropertyDescriptor(NativeNumber,key))}}NumberWrapper.prototype=NumberPrototype;NumberPrototype.constructor=NumberWrapper;redefine(global,NUMBER,NumberWrapper)}},{"../internals/classof-raw":46,"../internals/descriptors":61,"../internals/fails":69,"../internals/global":77,"../internals/has":78,"../internals/inherit-if-required":85,"../internals/is-forced":91,"../internals/object-create":108,"../internals/object-define-property":110,"../internals/object-get-own-property-descriptor":111,"../internals/object-get-own-property-names":113,"../internals/redefine":126,"../internals/string-trim":147,"../internals/to-primitive":158}],192:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var numberIsFinite=_dereq_("../internals/number-is-finite");$({target:"Number",stat:true},{isFinite:numberIsFinite})},{"../internals/export":68,"../internals/number-is-finite":106}],193:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var toInteger=_dereq_("../internals/to-integer");var thisNumberValue=_dereq_("../internals/this-number-value");var repeat=_dereq_("../internals/string-repeat");var fails=_dereq_("../internals/fails");var nativeToFixed=1..toFixed;var floor=Math.floor;var pow=function(x,n,acc){return n===0?acc:n%2===1?pow(x,n-1,acc*x):pow(x*x,n/2,acc)};var log=function(x){var n=0;var x2=x;while(x2>=4096){n+=12;x2/=4096}while(x2>=2){n+=1;x2/=2}return n};var FORCED=nativeToFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128")||!fails(function(){nativeToFixed.call({})});$({target:"Number",proto:true,forced:FORCED},{toFixed:function toFixed(fractionDigits){var number=thisNumberValue(this);var fractDigits=toInteger(fractionDigits);var data=[0,0,0,0,0,0];var sign="";var result="0";var e,z,j,k;var multiply=function(n,c){var index=-1;var c2=c;while(++index<6){c2+=n*data[index];data[index]=c2%1e7;c2=floor(c2/1e7)}};var divide=function(n){var index=6;var c=0;while(--index>=0){c+=data[index];data[index]=floor(c/n);c=c%n*1e7}};var dataToString=function(){var index=6;var s="";while(--index>=0){if(s!==""||index===0||data[index]!==0){var t=String(data[index]);s=s===""?t:s+repeat.call("0",7-t.length)+t}}return s};if(fractDigits<0||fractDigits>20)throw RangeError("Incorrect fraction digits");if(number!=number)return"NaN";if(number<=-1e21||number>=1e21)return String(number);if(number<0){sign="-";number=-number}if(number>1e-21){e=log(number*pow(2,69,1))-69;z=e<0?number*pow(2,-e,1):number/pow(2,e,1);z*=4503599627370496;e=52-e;if(e>0){multiply(0,z);j=fractDigits;while(j>=7){multiply(1e7,0);j-=7}multiply(pow(10,j,1),0);j=e-1;while(j>=23){divide(1<<23);j-=23}divide(1<<j);multiply(1,1);divide(2);result=dataToString()}else{multiply(0,z);multiply(1<<-e,0);result=dataToString()+repeat.call("0",fractDigits)}}if(fractDigits>0){k=result.length;result=sign+(k<=fractDigits?"0."+repeat.call("0",fractDigits-k)+result:result.slice(0,k-fractDigits)+"."+result.slice(k-fractDigits))}else{result=sign+result}return result}})},{"../internals/export":68,"../internals/fails":69,"../internals/string-repeat":145,"../internals/this-number-value":149,"../internals/to-integer":153}],194:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var assign=_dereq_("../internals/object-assign");$({target:"Object",stat:true,forced:Object.assign!==assign},{assign:assign})},{"../internals/export":68,"../internals/object-assign":107}],195:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var iterate=_dereq_("../internals/iterate");var createProperty=_dereq_("../internals/create-property");$({target:"Object",stat:true},{fromEntries:function fromEntries(iterable){var obj={};iterate(iterable,function(k,v){createProperty(obj,k,v)},undefined,true);return obj}})},{"../internals/create-property":58,"../internals/export":68,"../internals/iterate":95}],196:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var fails=_dereq_("../internals/fails");var toIndexedObject=_dereq_("../internals/to-indexed-object");var nativeGetOwnPropertyDescriptor=_dereq_("../internals/object-get-own-property-descriptor").f;var DESCRIPTORS=_dereq_("../internals/descriptors");var FAILS_ON_PRIMITIVES=fails(function(){nativeGetOwnPropertyDescriptor(1)});var FORCED=!DESCRIPTORS||FAILS_ON_PRIMITIVES;$({target:"Object",stat:true,forced:FORCED,sham:!DESCRIPTORS},{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(it,key){return nativeGetOwnPropertyDescriptor(toIndexedObject(it),key)}})},{"../internals/descriptors":61,"../internals/export":68,"../internals/fails":69,"../internals/object-get-own-property-descriptor":111,"../internals/to-indexed-object":152}],197:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var fails=_dereq_("../internals/fails");var nativeGetOwnPropertyNames=_dereq_("../internals/object-get-own-property-names-external").f;var FAILS_ON_PRIMITIVES=fails(function(){return!Object.getOwnPropertyNames(1)});$({target:"Object",stat:true,forced:FAILS_ON_PRIMITIVES},{getOwnPropertyNames:nativeGetOwnPropertyNames})},{"../internals/export":68,"../internals/fails":69,"../internals/object-get-own-property-names-external":112}],198:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var fails=_dereq_("../internals/fails");var toObject=_dereq_("../internals/to-object");var nativeGetPrototypeOf=_dereq_("../internals/object-get-prototype-of");var CORRECT_PROTOTYPE_GETTER=_dereq_("../internals/correct-prototype-getter");var FAILS_ON_PRIMITIVES=fails(function(){nativeGetPrototypeOf(1)});$({target:"Object",stat:true,forced:FAILS_ON_PRIMITIVES,sham:!CORRECT_PROTOTYPE_GETTER},{getPrototypeOf:function getPrototypeOf(it){return nativeGetPrototypeOf(toObject(it))}})},{"../internals/correct-prototype-getter":53,"../internals/export":68,"../internals/fails":69,"../internals/object-get-prototype-of":115,"../internals/to-object":155}],199:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var toObject=_dereq_("../internals/to-object");var nativeKeys=_dereq_("../internals/object-keys");var fails=_dereq_("../internals/fails");var FAILS_ON_PRIMITIVES=fails(function(){nativeKeys(1)});$({target:"Object",stat:true,forced:FAILS_ON_PRIMITIVES},{keys:function keys(it){return nativeKeys(toObject(it))}})},{"../internals/export":68,"../internals/fails":69,"../internals/object-keys":117,"../internals/to-object":155}],200:[function(_dereq_,module,exports){var TO_STRING_TAG_SUPPORT=_dereq_("../internals/to-string-tag-support");var redefine=_dereq_("../internals/redefine");var toString=_dereq_("../internals/object-to-string");if(!TO_STRING_TAG_SUPPORT){redefine(Object.prototype,"toString",toString,{unsafe:true})}},{"../internals/object-to-string":120,"../internals/redefine":126,"../internals/to-string-tag-support":159}],201:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var IS_PURE=_dereq_("../internals/is-pure");var global=_dereq_("../internals/global");var getBuiltIn=_dereq_("../internals/get-built-in");var NativePromise=_dereq_("../internals/native-promise-constructor");var redefine=_dereq_("../internals/redefine");var redefineAll=_dereq_("../internals/redefine-all");var setToStringTag=_dereq_("../internals/set-to-string-tag");var setSpecies=_dereq_("../internals/set-species");var isObject=_dereq_("../internals/is-object");var aFunction=_dereq_("../internals/a-function");var anInstance=_dereq_("../internals/an-instance");var classof=_dereq_("../internals/classof-raw");var inspectSource=_dereq_("../internals/inspect-source");var iterate=_dereq_("../internals/iterate");var checkCorrectnessOfIteration=_dereq_("../internals/check-correctness-of-iteration");var speciesConstructor=_dereq_("../internals/species-constructor");var task=_dereq_("../internals/task").set;var microtask=_dereq_("../internals/microtask");var promiseResolve=_dereq_("../internals/promise-resolve");var hostReportErrors=_dereq_("../internals/host-report-errors");var newPromiseCapabilityModule=_dereq_("../internals/new-promise-capability");var perform=_dereq_("../internals/perform");var InternalStateModule=_dereq_("../internals/internal-state");var isForced=_dereq_("../internals/is-forced");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var V8_VERSION=_dereq_("../internals/engine-v8-version");var SPECIES=wellKnownSymbol("species");var PROMISE="Promise";var getInternalState=InternalStateModule.get;var setInternalState=InternalStateModule.set;var getInternalPromiseState=InternalStateModule.getterFor(PROMISE);var PromiseConstructor=NativePromise;var TypeError=global.TypeError;var document=global.document;var process=global.process;var $fetch=getBuiltIn("fetch");var newPromiseCapability=newPromiseCapabilityModule.f;var newGenericPromiseCapability=newPromiseCapability;var IS_NODE=classof(process)=="process";var DISPATCH_EVENT=!!(document&&document.createEvent&&global.dispatchEvent);var UNHANDLED_REJECTION="unhandledrejection";var REJECTION_HANDLED="rejectionhandled";var PENDING=0;var FULFILLED=1;var REJECTED=2;var HANDLED=1;var UNHANDLED=2;var Internal,OwnPromiseCapability,PromiseWrapper,nativeThen;var FORCED=isForced(PROMISE,function(){var GLOBAL_CORE_JS_PROMISE=inspectSource(PromiseConstructor)!==String(PromiseConstructor);if(!GLOBAL_CORE_JS_PROMISE){if(V8_VERSION===66)return true;if(!IS_NODE&&typeof PromiseRejectionEvent!="function")return true}if(IS_PURE&&!PromiseConstructor.prototype["finally"])return true;if(V8_VERSION>=51&&/native code/.test(PromiseConstructor))return false;var promise=PromiseConstructor.resolve(1);var FakePromise=function(exec){exec(function(){},function(){})};var constructor=promise.constructor={};constructor[SPECIES]=FakePromise;return!(promise.then(function(){})instanceof FakePromise)});var INCORRECT_ITERATION=FORCED||!checkCorrectnessOfIteration(function(iterable){PromiseConstructor.all(iterable)["catch"](function(){})});var isThenable=function(it){var then;return isObject(it)&&typeof(then=it.then)=="function"?then:false};var notify=function(promise,state,isReject){if(state.notified)return;state.notified=true;var chain=state.reactions;microtask(function(){var value=state.value;var ok=state.state==FULFILLED;var index=0;while(chain.length>index){var reaction=chain[index++];var handler=ok?reaction.ok:reaction.fail;var resolve=reaction.resolve;var reject=reaction.reject;var domain=reaction.domain;var result,then,exited;try{if(handler){if(!ok){if(state.rejection===UNHANDLED)onHandleUnhandled(promise,state);state.rejection=HANDLED}if(handler===true)result=value;else{if(domain)domain.enter();result=handler(value);if(domain){domain.exit();exited=true}}if(result===reaction.promise){reject(TypeError("Promise-chain cycle"))}else if(then=isThenable(result)){then.call(result,resolve,reject)}else resolve(result)}else reject(value)}catch(error){if(domain&&!exited)domain.exit();reject(error)}}state.reactions=[];state.notified=false;if(isReject&&!state.rejection)onUnhandled(promise,state)})};var dispatchEvent=function(name,promise,reason){var event,handler;if(DISPATCH_EVENT){event=document.createEvent("Event");event.promise=promise;event.reason=reason;event.initEvent(name,false,true);global.dispatchEvent(event)}else event={promise:promise,reason:reason};if(handler=global["on"+name])handler(event);else if(name===UNHANDLED_REJECTION)hostReportErrors("Unhandled promise rejection",reason)};var onUnhandled=function(promise,state){task.call(global,function(){var value=state.value;var IS_UNHANDLED=isUnhandled(state);var result;if(IS_UNHANDLED){result=perform(function(){if(IS_NODE){process.emit("unhandledRejection",value,promise)}else dispatchEvent(UNHANDLED_REJECTION,promise,value)});state.rejection=IS_NODE||isUnhandled(state)?UNHANDLED:HANDLED;if(result.error)throw result.value}})};var isUnhandled=function(state){return state.rejection!==HANDLED&&!state.parent};var onHandleUnhandled=function(promise,state){task.call(global,function(){if(IS_NODE){process.emit("rejectionHandled",promise)}else dispatchEvent(REJECTION_HANDLED,promise,state.value)})};var bind=function(fn,promise,state,unwrap){return function(value){fn(promise,state,value,unwrap)}};var internalReject=function(promise,state,value,unwrap){if(state.done)return;state.done=true;if(unwrap)state=unwrap;state.value=value;state.state=REJECTED;notify(promise,state,true)};var internalResolve=function(promise,state,value,unwrap){if(state.done)return;state.done=true;if(unwrap)state=unwrap;try{if(promise===value)throw TypeError("Promise can't be resolved itself");var then=isThenable(value);if(then){microtask(function(){var wrapper={done:false};try{then.call(value,bind(internalResolve,promise,wrapper,state),bind(internalReject,promise,wrapper,state))}catch(error){internalReject(promise,wrapper,error,state)}})}else{state.value=value;state.state=FULFILLED;notify(promise,state,false)}}catch(error){internalReject(promise,{done:false},error,state)}};if(FORCED){PromiseConstructor=function Promise(executor){anInstance(this,PromiseConstructor,PROMISE);aFunction(executor);Internal.call(this);var state=getInternalState(this);try{executor(bind(internalResolve,this,state),bind(internalReject,this,state))}catch(error){internalReject(this,state,error)}};Internal=function Promise(executor){setInternalState(this,{type:PROMISE,done:false,notified:false,parent:false,reactions:[],rejection:false,state:PENDING,value:undefined})};Internal.prototype=redefineAll(PromiseConstructor.prototype,{then:function then(onFulfilled,onRejected){var state=getInternalPromiseState(this);var reaction=newPromiseCapability(speciesConstructor(this,PromiseConstructor));reaction.ok=typeof onFulfilled=="function"?onFulfilled:true;reaction.fail=typeof onRejected=="function"&&onRejected;reaction.domain=IS_NODE?process.domain:undefined;state.parent=true;state.reactions.push(reaction);if(state.state!=PENDING)notify(this,state,false);return reaction.promise},catch:function(onRejected){return this.then(undefined,onRejected)}});OwnPromiseCapability=function(){var promise=new Internal;var state=getInternalState(promise);this.promise=promise;this.resolve=bind(internalResolve,promise,state);this.reject=bind(internalReject,promise,state)};newPromiseCapabilityModule.f=newPromiseCapability=function(C){return C===PromiseConstructor||C===PromiseWrapper?new OwnPromiseCapability(C):newGenericPromiseCapability(C)};if(!IS_PURE&&typeof NativePromise=="function"){nativeThen=NativePromise.prototype.then;redefine(NativePromise.prototype,"then",function then(onFulfilled,onRejected){var that=this;return new PromiseConstructor(function(resolve,reject){nativeThen.call(that,resolve,reject)}).then(onFulfilled,onRejected)},{unsafe:true});if(typeof $fetch=="function")$({global:true,enumerable:true,forced:true},{fetch:function fetch(input){return promiseResolve(PromiseConstructor,$fetch.apply(global,arguments))}})}}$({global:true,wrap:true,forced:FORCED},{Promise:PromiseConstructor});setToStringTag(PromiseConstructor,PROMISE,false,true);setSpecies(PROMISE);PromiseWrapper=getBuiltIn(PROMISE);$({target:PROMISE,stat:true,forced:FORCED},{reject:function reject(r){var capability=newPromiseCapability(this);capability.reject.call(undefined,r);return capability.promise}});$({target:PROMISE,stat:true,forced:IS_PURE||FORCED},{resolve:function resolve(x){return promiseResolve(IS_PURE&&this===PromiseWrapper?PromiseConstructor:this,x)}});$({target:PROMISE,stat:true,forced:INCORRECT_ITERATION},{all:function all(iterable){var C=this;var capability=newPromiseCapability(C);var resolve=capability.resolve;var reject=capability.reject;var result=perform(function(){var $promiseResolve=aFunction(C.resolve);var values=[];var counter=0;var remaining=1;iterate(iterable,function(promise){var index=counter++;var alreadyCalled=false;values.push(undefined);remaining++;$promiseResolve.call(C,promise).then(function(value){if(alreadyCalled)return;alreadyCalled=true;values[index]=value;--remaining||resolve(values)},reject)});--remaining||resolve(values)});if(result.error)reject(result.value);return capability.promise},race:function race(iterable){var C=this;var capability=newPromiseCapability(C);var reject=capability.reject;var result=perform(function(){var $promiseResolve=aFunction(C.resolve);iterate(iterable,function(promise){$promiseResolve.call(C,promise).then(capability.resolve,reject)})});if(result.error)reject(result.value);return capability.promise}})},{"../internals/a-function":23,"../internals/an-instance":27,"../internals/check-correctness-of-iteration":45,"../internals/classof-raw":46,"../internals/engine-v8-version":66,"../internals/export":68,"../internals/get-built-in":74,"../internals/global":77,"../internals/host-report-errors":80,"../internals/inspect-source":86,"../internals/internal-state":88,"../internals/is-forced":91,"../internals/is-object":92,"../internals/is-pure":93,"../internals/iterate":95,"../internals/microtask":99,"../internals/native-promise-constructor":100,"../internals/new-promise-capability":104,"../internals/perform":123,"../internals/promise-resolve":124,"../internals/redefine":126,"../internals/redefine-all":125,"../internals/set-species":134,"../internals/set-to-string-tag":135,"../internals/species-constructor":139,"../internals/task":148,"../internals/well-known-symbol":166}],202:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var getBuiltIn=_dereq_("../internals/get-built-in");var aFunction=_dereq_("../internals/a-function");var anObject=_dereq_("../internals/an-object");var isObject=_dereq_("../internals/is-object");var create=_dereq_("../internals/object-create");var bind=_dereq_("../internals/function-bind");var fails=_dereq_("../internals/fails");var nativeConstruct=getBuiltIn("Reflect","construct");var NEW_TARGET_BUG=fails(function(){function F(){}return!(nativeConstruct(function(){},[],F)instanceof F)});var ARGS_BUG=!fails(function(){nativeConstruct(function(){})});var FORCED=NEW_TARGET_BUG||ARGS_BUG;$({target:"Reflect",stat:true,forced:FORCED,sham:FORCED},{construct:function construct(Target,args){aFunction(Target);anObject(args);var newTarget=arguments.length<3?Target:aFunction(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return nativeConstruct(Target,args,newTarget);if(Target==newTarget){switch(args.length){case 0:return new Target;case 1:return new Target(args[0]);case 2:return new Target(args[0],args[1]);case 3:return new Target(args[0],args[1],args[2]);case 4:return new Target(args[0],args[1],args[2],args[3])}var $args=[null];$args.push.apply($args,args);return new(bind.apply(Target,$args))}var proto=newTarget.prototype;var instance=create(isObject(proto)?proto:Object.prototype);var result=Function.apply.call(Target,instance,args);return isObject(result)?result:instance}})},{"../internals/a-function":23,"../internals/an-object":28,"../internals/export":68,"../internals/fails":69,"../internals/function-bind":73,"../internals/get-built-in":74,"../internals/is-object":92,"../internals/object-create":108}],203:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var isObject=_dereq_("../internals/is-object");var anObject=_dereq_("../internals/an-object");var has=_dereq_("../internals/has");var getOwnPropertyDescriptorModule=_dereq_("../internals/object-get-own-property-descriptor");var getPrototypeOf=_dereq_("../internals/object-get-prototype-of");function get(target,propertyKey){var receiver=arguments.length<3?target:arguments[2];var descriptor,prototype;if(anObject(target)===receiver)return target[propertyKey];if(descriptor=getOwnPropertyDescriptorModule.f(target,propertyKey))return has(descriptor,"value")?descriptor.value:descriptor.get===undefined?undefined:descriptor.get.call(receiver);if(isObject(prototype=getPrototypeOf(target)))return get(prototype,propertyKey,receiver)}$({target:"Reflect",stat:true},{get:get})},{"../internals/an-object":28,"../internals/export":68,"../internals/has":78,"../internals/is-object":92,"../internals/object-get-own-property-descriptor":111,"../internals/object-get-prototype-of":115}],204:[function(_dereq_,module,exports){var DESCRIPTORS=_dereq_("../internals/descriptors");var global=_dereq_("../internals/global");var isForced=_dereq_("../internals/is-forced");var inheritIfRequired=_dereq_("../internals/inherit-if-required");var defineProperty=_dereq_("../internals/object-define-property").f;var getOwnPropertyNames=_dereq_("../internals/object-get-own-property-names").f;var isRegExp=_dereq_("../internals/is-regexp");var getFlags=_dereq_("../internals/regexp-flags");var stickyHelpers=_dereq_("../internals/regexp-sticky-helpers");var redefine=_dereq_("../internals/redefine");var fails=_dereq_("../internals/fails");var setInternalState=_dereq_("../internals/internal-state").set;var setSpecies=_dereq_("../internals/set-species");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var MATCH=wellKnownSymbol("match");var NativeRegExp=global.RegExp;var RegExpPrototype=NativeRegExp.prototype;var re1=/a/g;var re2=/a/g;var CORRECT_NEW=new NativeRegExp(re1)!==re1;var UNSUPPORTED_Y=stickyHelpers.UNSUPPORTED_Y;var FORCED=DESCRIPTORS&&isForced("RegExp",!CORRECT_NEW||UNSUPPORTED_Y||fails(function(){re2[MATCH]=false;return NativeRegExp(re1)!=re1||NativeRegExp(re2)==re2||NativeRegExp(re1,"i")!="/a/i"}));if(FORCED){var RegExpWrapper=function RegExp(pattern,flags){var thisIsRegExp=this instanceof RegExpWrapper;var patternIsRegExp=isRegExp(pattern);var flagsAreUndefined=flags===undefined;var sticky;if(!thisIsRegExp&&patternIsRegExp&&pattern.constructor===RegExpWrapper&&flagsAreUndefined){return pattern}if(CORRECT_NEW){if(patternIsRegExp&&!flagsAreUndefined)pattern=pattern.source}else if(pattern instanceof RegExpWrapper){if(flagsAreUndefined)flags=getFlags.call(pattern);pattern=pattern.source}if(UNSUPPORTED_Y){sticky=!!flags&&flags.indexOf("y")>-1;if(sticky)flags=flags.replace(/y/g,"")}var result=inheritIfRequired(CORRECT_NEW?new NativeRegExp(pattern,flags):NativeRegExp(pattern,flags),thisIsRegExp?this:RegExpPrototype,RegExpWrapper);if(UNSUPPORTED_Y&&sticky)setInternalState(result,{sticky:sticky});return result};var proxy=function(key){key in RegExpWrapper||defineProperty(RegExpWrapper,key,{configurable:true,get:function(){return NativeRegExp[key]},set:function(it){NativeRegExp[key]=it}})};var keys=getOwnPropertyNames(NativeRegExp);var index=0;while(keys.length>index)proxy(keys[index++]);RegExpPrototype.constructor=RegExpWrapper;RegExpWrapper.prototype=RegExpPrototype;redefine(global,"RegExp",RegExpWrapper)}setSpecies("RegExp")},{"../internals/descriptors":61,"../internals/fails":69,"../internals/global":77,"../internals/inherit-if-required":85,"../internals/internal-state":88,"../internals/is-forced":91,"../internals/is-regexp":94,"../internals/object-define-property":110,"../internals/object-get-own-property-names":113,"../internals/redefine":126,"../internals/regexp-flags":129,"../internals/regexp-sticky-helpers":130,"../internals/set-species":134,"../internals/well-known-symbol":166}],205:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var exec=_dereq_("../internals/regexp-exec");$({target:"RegExp",proto:true,forced:/./.exec!==exec},{exec:exec})},{"../internals/export":68,"../internals/regexp-exec":128}],206:[function(_dereq_,module,exports){"use strict";var redefine=_dereq_("../internals/redefine");var anObject=_dereq_("../internals/an-object");var fails=_dereq_("../internals/fails");var flags=_dereq_("../internals/regexp-flags");var TO_STRING="toString";var RegExpPrototype=RegExp.prototype;var nativeToString=RegExpPrototype[TO_STRING];var NOT_GENERIC=fails(function(){return nativeToString.call({source:"a",flags:"b"})!="/a/b"});var INCORRECT_NAME=nativeToString.name!=TO_STRING;if(NOT_GENERIC||INCORRECT_NAME){redefine(RegExp.prototype,TO_STRING,function toString(){var R=anObject(this);var p=String(R.source);var rf=R.flags;var f=String(rf===undefined&&R instanceof RegExp&&!("flags"in RegExpPrototype)?flags.call(R):rf);return"/"+p+"/"+f},{unsafe:true})}},{"../internals/an-object":28,"../internals/fails":69,"../internals/redefine":126,"../internals/regexp-flags":129}],207:[function(_dereq_,module,exports){"use strict";var collection=_dereq_("../internals/collection");var collectionStrong=_dereq_("../internals/collection-strong");module.exports=collection("Set",function(init){return function Set(){return init(this,arguments.length?arguments[0]:undefined)}},collectionStrong)},{"../internals/collection":50,"../internals/collection-strong":48}],208:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var getOwnPropertyDescriptor=_dereq_("../internals/object-get-own-property-descriptor").f;var toLength=_dereq_("../internals/to-length");var notARegExp=_dereq_("../internals/not-a-regexp");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var correctIsRegExpLogic=_dereq_("../internals/correct-is-regexp-logic");var IS_PURE=_dereq_("../internals/is-pure");var nativeEndsWith="".endsWith;var min=Math.min;var CORRECT_IS_REGEXP_LOGIC=correctIsRegExpLogic("endsWith");var MDN_POLYFILL_BUG=!IS_PURE&&!CORRECT_IS_REGEXP_LOGIC&&!!function(){var descriptor=getOwnPropertyDescriptor(String.prototype,"endsWith");return descriptor&&!descriptor.writable}();$({target:"String",proto:true,forced:!MDN_POLYFILL_BUG&&!CORRECT_IS_REGEXP_LOGIC},{endsWith:function endsWith(searchString){var that=String(requireObjectCoercible(this));notARegExp(searchString);var endPosition=arguments.length>1?arguments[1]:undefined;var len=toLength(that.length);var end=endPosition===undefined?len:min(toLength(endPosition),len);var search=String(searchString);return nativeEndsWith?nativeEndsWith.call(that,search,end):that.slice(end-search.length,end)===search}})},{"../internals/correct-is-regexp-logic":52,"../internals/export":68,"../internals/is-pure":93,"../internals/not-a-regexp":105,"../internals/object-get-own-property-descriptor":111,"../internals/require-object-coercible":131,"../internals/to-length":154}],209:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var notARegExp=_dereq_("../internals/not-a-regexp");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var correctIsRegExpLogic=_dereq_("../internals/correct-is-regexp-logic");$({target:"String",proto:true,forced:!correctIsRegExpLogic("includes")},{includes:function includes(searchString){return!!~String(requireObjectCoercible(this)).indexOf(notARegExp(searchString),arguments.length>1?arguments[1]:undefined)}})},{"../internals/correct-is-regexp-logic":52,"../internals/export":68,"../internals/not-a-regexp":105,"../internals/require-object-coercible":131}],210:[function(_dereq_,module,exports){"use strict";var charAt=_dereq_("../internals/string-multibyte").charAt;var InternalStateModule=_dereq_("../internals/internal-state");var defineIterator=_dereq_("../internals/define-iterator");var STRING_ITERATOR="String Iterator";var setInternalState=InternalStateModule.set;var getInternalState=InternalStateModule.getterFor(STRING_ITERATOR);defineIterator(String,"String",function(iterated){setInternalState(this,{type:STRING_ITERATOR,string:String(iterated),index:0})},function next(){var state=getInternalState(this);var string=state.string;var index=state.index;var point;if(index>=string.length)return{value:undefined,done:true};point=charAt(string,index);state.index+=point.length;return{value:point,done:false}})},{"../internals/define-iterator":59,"../internals/internal-state":88,"../internals/string-multibyte":141}],211:[function(_dereq_,module,exports){"use strict";var fixRegExpWellKnownSymbolLogic=_dereq_("../internals/fix-regexp-well-known-symbol-logic");var anObject=_dereq_("../internals/an-object");var toLength=_dereq_("../internals/to-length");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var advanceStringIndex=_dereq_("../internals/advance-string-index");var regExpExec=_dereq_("../internals/regexp-exec-abstract");fixRegExpWellKnownSymbolLogic("match",1,function(MATCH,nativeMatch,maybeCallNative){return[function match(regexp){var O=requireObjectCoercible(this);var matcher=regexp==undefined?undefined:regexp[MATCH];return matcher!==undefined?matcher.call(regexp,O):new RegExp(regexp)[MATCH](String(O))},function(regexp){var res=maybeCallNative(nativeMatch,regexp,this);if(res.done)return res.value;var rx=anObject(regexp);var S=String(this);if(!rx.global)return regExpExec(rx,S);var fullUnicode=rx.unicode;rx.lastIndex=0;var A=[];var n=0;var result;while((result=regExpExec(rx,S))!==null){var matchStr=String(result[0]);A[n]=matchStr;if(matchStr==="")rx.lastIndex=advanceStringIndex(S,toLength(rx.lastIndex),fullUnicode);n++}return n===0?null:A}]})},{"../internals/advance-string-index":26,"../internals/an-object":28,"../internals/fix-regexp-well-known-symbol-logic":70,"../internals/regexp-exec-abstract":127,"../internals/require-object-coercible":131,"../internals/to-length":154}],212:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var $padStart=_dereq_("../internals/string-pad").start;var WEBKIT_BUG=_dereq_("../internals/string-pad-webkit-bug");$({target:"String",proto:true,forced:WEBKIT_BUG},{padStart:function padStart(maxLength){return $padStart(this,maxLength,arguments.length>1?arguments[1]:undefined)}})},{"../internals/export":68,"../internals/string-pad":143,"../internals/string-pad-webkit-bug":142}],213:[function(_dereq_,module,exports){var $=_dereq_("../internals/export");var repeat=_dereq_("../internals/string-repeat");$({target:"String",proto:true},{repeat:repeat})},{"../internals/export":68,"../internals/string-repeat":145}],214:[function(_dereq_,module,exports){"use strict";var fixRegExpWellKnownSymbolLogic=_dereq_("../internals/fix-regexp-well-known-symbol-logic");var anObject=_dereq_("../internals/an-object");var toObject=_dereq_("../internals/to-object");var toLength=_dereq_("../internals/to-length");var toInteger=_dereq_("../internals/to-integer");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var advanceStringIndex=_dereq_("../internals/advance-string-index");var regExpExec=_dereq_("../internals/regexp-exec-abstract");var max=Math.max;var min=Math.min;var floor=Math.floor;var SUBSTITUTION_SYMBOLS=/\$([$&'`]|\d\d?|<[^>]*>)/g;var SUBSTITUTION_SYMBOLS_NO_NAMED=/\$([$&'`]|\d\d?)/g;var maybeToString=function(it){return it===undefined?it:String(it)};fixRegExpWellKnownSymbolLogic("replace",2,function(REPLACE,nativeReplace,maybeCallNative,reason){var REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE=reason.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE;var REPLACE_KEEPS_$0=reason.REPLACE_KEEPS_$0;var UNSAFE_SUBSTITUTE=REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE?"$":"$0";return[function replace(searchValue,replaceValue){var O=requireObjectCoercible(this);var replacer=searchValue==undefined?undefined:searchValue[REPLACE];return replacer!==undefined?replacer.call(searchValue,O,replaceValue):nativeReplace.call(String(O),searchValue,replaceValue)},function(regexp,replaceValue){if(!REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE&&REPLACE_KEEPS_$0||typeof replaceValue==="string"&&replaceValue.indexOf(UNSAFE_SUBSTITUTE)===-1){var res=maybeCallNative(nativeReplace,regexp,this,replaceValue);if(res.done)return res.value}var rx=anObject(regexp);var S=String(this);var functionalReplace=typeof replaceValue==="function";if(!functionalReplace)replaceValue=String(replaceValue);var global=rx.global;if(global){var fullUnicode=rx.unicode;rx.lastIndex=0}var results=[];while(true){var result=regExpExec(rx,S);if(result===null)break;results.push(result);if(!global)break;var matchStr=String(result[0]);if(matchStr==="")rx.lastIndex=advanceStringIndex(S,toLength(rx.lastIndex),fullUnicode)}var accumulatedResult="";var nextSourcePosition=0;for(var i=0;i<results.length;i++){result=results[i];var matched=String(result[0]);var position=max(min(toInteger(result.index),S.length),0);var captures=[];for(var j=1;j<result.length;j++)captures.push(maybeToString(result[j]));var namedCaptures=result.groups;if(functionalReplace){var replacerArgs=[matched].concat(captures,position,S);if(namedCaptures!==undefined)replacerArgs.push(namedCaptures);var replacement=String(replaceValue.apply(undefined,replacerArgs))}else{replacement=getSubstitution(matched,S,position,captures,namedCaptures,replaceValue)}if(position>=nextSourcePosition){accumulatedResult+=S.slice(nextSourcePosition,position)+replacement;nextSourcePosition=position+matched.length}}return accumulatedResult+S.slice(nextSourcePosition)}];function getSubstitution(matched,str,position,captures,namedCaptures,replacement){var tailPos=position+matched.length;var m=captures.length;var symbols=SUBSTITUTION_SYMBOLS_NO_NAMED;if(namedCaptures!==undefined){namedCaptures=toObject(namedCaptures);symbols=SUBSTITUTION_SYMBOLS}return nativeReplace.call(replacement,symbols,function(match,ch){var capture;switch(ch.charAt(0)){case"$":return"$";case"&":return matched;case"`":return str.slice(0,position);case"'":return str.slice(tailPos);case"<":capture=namedCaptures[ch.slice(1,-1)];break;default:var n=+ch;if(n===0)return match;if(n>m){var f=floor(n/10);if(f===0)return match;if(f<=m)return captures[f-1]===undefined?ch.charAt(1):captures[f-1]+ch.charAt(1);return match}capture=captures[n-1]}return capture===undefined?"":capture})}})},{"../internals/advance-string-index":26,"../internals/an-object":28,"../internals/fix-regexp-well-known-symbol-logic":70,"../internals/regexp-exec-abstract":127,"../internals/require-object-coercible":131,"../internals/to-integer":153,"../internals/to-length":154,"../internals/to-object":155}],215:[function(_dereq_,module,exports){"use strict";var fixRegExpWellKnownSymbolLogic=_dereq_("../internals/fix-regexp-well-known-symbol-logic");var anObject=_dereq_("../internals/an-object");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var sameValue=_dereq_("../internals/same-value");var regExpExec=_dereq_("../internals/regexp-exec-abstract");fixRegExpWellKnownSymbolLogic("search",1,function(SEARCH,nativeSearch,maybeCallNative){return[function search(regexp){var O=requireObjectCoercible(this);var searcher=regexp==undefined?undefined:regexp[SEARCH];return searcher!==undefined?searcher.call(regexp,O):new RegExp(regexp)[SEARCH](String(O))},function(regexp){var res=maybeCallNative(nativeSearch,regexp,this);if(res.done)return res.value;var rx=anObject(regexp);var S=String(this);var previousLastIndex=rx.lastIndex;if(!sameValue(previousLastIndex,0))rx.lastIndex=0;var result=regExpExec(rx,S);if(!sameValue(rx.lastIndex,previousLastIndex))rx.lastIndex=previousLastIndex;return result===null?-1:result.index}]})},{"../internals/an-object":28,"../internals/fix-regexp-well-known-symbol-logic":70,"../internals/regexp-exec-abstract":127,"../internals/require-object-coercible":131,"../internals/same-value":132}],216:[function(_dereq_,module,exports){"use strict";var fixRegExpWellKnownSymbolLogic=_dereq_("../internals/fix-regexp-well-known-symbol-logic");var isRegExp=_dereq_("../internals/is-regexp");var anObject=_dereq_("../internals/an-object");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var speciesConstructor=_dereq_("../internals/species-constructor");var advanceStringIndex=_dereq_("../internals/advance-string-index");var toLength=_dereq_("../internals/to-length");var callRegExpExec=_dereq_("../internals/regexp-exec-abstract");var regexpExec=_dereq_("../internals/regexp-exec");var fails=_dereq_("../internals/fails");var arrayPush=[].push;var min=Math.min;var MAX_UINT32=4294967295;var SUPPORTS_Y=!fails(function(){return!RegExp(MAX_UINT32,"y")});fixRegExpWellKnownSymbolLogic("split",2,function(SPLIT,nativeSplit,maybeCallNative){var internalSplit;if("abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length){internalSplit=function(separator,limit){var string=String(requireObjectCoercible(this));var lim=limit===undefined?MAX_UINT32:limit>>>0;if(lim===0)return[];if(separator===undefined)return[string];if(!isRegExp(separator)){return nativeSplit.call(string,separator,lim)}var output=[];var flags=(separator.ignoreCase?"i":"")+(separator.multiline?"m":"")+(separator.unicode?"u":"")+(separator.sticky?"y":"");var lastLastIndex=0;var separatorCopy=new RegExp(separator.source,flags+"g");var match,lastIndex,lastLength;while(match=regexpExec.call(separatorCopy,string)){lastIndex=separatorCopy.lastIndex;if(lastIndex>lastLastIndex){output.push(string.slice(lastLastIndex,match.index));if(match.length>1&&match.index<string.length)arrayPush.apply(output,match.slice(1));lastLength=match[0].length;lastLastIndex=lastIndex;if(output.length>=lim)break}if(separatorCopy.lastIndex===match.index)separatorCopy.lastIndex++}if(lastLastIndex===string.length){if(lastLength||!separatorCopy.test(""))output.push("")}else output.push(string.slice(lastLastIndex));return output.length>lim?output.slice(0,lim):output}}else if("0".split(undefined,0).length){internalSplit=function(separator,limit){return separator===undefined&&limit===0?[]:nativeSplit.call(this,separator,limit)}}else internalSplit=nativeSplit;return[function split(separator,limit){var O=requireObjectCoercible(this);var splitter=separator==undefined?undefined:separator[SPLIT];return splitter!==undefined?splitter.call(separator,O,limit):internalSplit.call(String(O),separator,limit)},function(regexp,limit){var res=maybeCallNative(internalSplit,regexp,this,limit,internalSplit!==nativeSplit);if(res.done)return res.value;var rx=anObject(regexp);var S=String(this);var C=speciesConstructor(rx,RegExp);var unicodeMatching=rx.unicode;var flags=(rx.ignoreCase?"i":"")+(rx.multiline?"m":"")+(rx.unicode?"u":"")+(SUPPORTS_Y?"y":"g");var splitter=new C(SUPPORTS_Y?rx:"^(?:"+rx.source+")",flags);var lim=limit===undefined?MAX_UINT32:limit>>>0;if(lim===0)return[];if(S.length===0)return callRegExpExec(splitter,S)===null?[S]:[];var p=0;var q=0;var A=[];while(q<S.length){splitter.lastIndex=SUPPORTS_Y?q:0;var z=callRegExpExec(splitter,SUPPORTS_Y?S:S.slice(q));var e;if(z===null||(e=min(toLength(splitter.lastIndex+(SUPPORTS_Y?0:q)),S.length))===p){q=advanceStringIndex(S,q,unicodeMatching)}else{A.push(S.slice(p,q));if(A.length===lim)return A;for(var i=1;i<=z.length-1;i++){A.push(z[i]);if(A.length===lim)return A}q=p=e}}A.push(S.slice(p));return A}]},!SUPPORTS_Y)},{"../internals/advance-string-index":26,"../internals/an-object":28,"../internals/fails":69,"../internals/fix-regexp-well-known-symbol-logic":70,"../internals/is-regexp":94,"../internals/regexp-exec":128,"../internals/regexp-exec-abstract":127,"../internals/require-object-coercible":131,"../internals/species-constructor":139,"../internals/to-length":154}],217:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var getOwnPropertyDescriptor=_dereq_("../internals/object-get-own-property-descriptor").f;var toLength=_dereq_("../internals/to-length");var notARegExp=_dereq_("../internals/not-a-regexp");var requireObjectCoercible=_dereq_("../internals/require-object-coercible");var correctIsRegExpLogic=_dereq_("../internals/correct-is-regexp-logic");var IS_PURE=_dereq_("../internals/is-pure");var nativeStartsWith="".startsWith;var min=Math.min;var CORRECT_IS_REGEXP_LOGIC=correctIsRegExpLogic("startsWith");var MDN_POLYFILL_BUG=!IS_PURE&&!CORRECT_IS_REGEXP_LOGIC&&!!function(){var descriptor=getOwnPropertyDescriptor(String.prototype,"startsWith");return descriptor&&!descriptor.writable}();$({target:"String",proto:true,forced:!MDN_POLYFILL_BUG&&!CORRECT_IS_REGEXP_LOGIC},{startsWith:function startsWith(searchString){var that=String(requireObjectCoercible(this));notARegExp(searchString);var index=toLength(min(arguments.length>1?arguments[1]:undefined,that.length));var search=String(searchString);return nativeStartsWith?nativeStartsWith.call(that,search,index):that.slice(index,index+search.length)===search}})},{"../internals/correct-is-regexp-logic":52,"../internals/export":68,"../internals/is-pure":93,"../internals/not-a-regexp":105,"../internals/object-get-own-property-descriptor":111,"../internals/require-object-coercible":131,"../internals/to-length":154}],218:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var createHTML=_dereq_("../internals/create-html");var forcedStringHTMLMethod=_dereq_("../internals/string-html-forced");$({target:"String",proto:true,forced:forcedStringHTMLMethod("sub")},{sub:function sub(){return createHTML(this,"sub","","")}})},{"../internals/create-html":54,"../internals/export":68,"../internals/string-html-forced":140}],219:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var $trim=_dereq_("../internals/string-trim").trim;var forcedStringTrimMethod=_dereq_("../internals/string-trim-forced");$({target:"String",proto:true,forced:forcedStringTrimMethod("trim")},{trim:function trim(){return $trim(this)}})},{"../internals/export":68,"../internals/string-trim":147,"../internals/string-trim-forced":146}],220:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var DESCRIPTORS=_dereq_("../internals/descriptors");var global=_dereq_("../internals/global");var has=_dereq_("../internals/has");var isObject=_dereq_("../internals/is-object");var defineProperty=_dereq_("../internals/object-define-property").f;var copyConstructorProperties=_dereq_("../internals/copy-constructor-properties");var NativeSymbol=global.Symbol;if(DESCRIPTORS&&typeof NativeSymbol=="function"&&(!("description"in NativeSymbol.prototype)||NativeSymbol().description!==undefined)){var EmptyStringDescriptionStore={};var SymbolWrapper=function Symbol(){var description=arguments.length<1||arguments[0]===undefined?undefined:String(arguments[0]);var result=this instanceof SymbolWrapper?new NativeSymbol(description):description===undefined?NativeSymbol():NativeSymbol(description);if(description==="")EmptyStringDescriptionStore[result]=true;return result};copyConstructorProperties(SymbolWrapper,NativeSymbol);var symbolPrototype=SymbolWrapper.prototype=NativeSymbol.prototype;symbolPrototype.constructor=SymbolWrapper;var symbolToString=symbolPrototype.toString;var native=String(NativeSymbol("test"))=="Symbol(test)";var regexp=/^Symbol\((.*)\)[^)]+$/;defineProperty(symbolPrototype,"description",{configurable:true,get:function description(){var symbol=isObject(this)?this.valueOf():this;var string=symbolToString.call(symbol);if(has(EmptyStringDescriptionStore,symbol))return"";var desc=native?string.slice(7,-1):string.replace(regexp,"$1");return desc===""?undefined:desc}});$({global:true,forced:true},{Symbol:SymbolWrapper})}},{"../internals/copy-constructor-properties":51,"../internals/descriptors":61,"../internals/export":68,"../internals/global":77,"../internals/has":78,"../internals/is-object":92,"../internals/object-define-property":110}],221:[function(_dereq_,module,exports){var defineWellKnownSymbol=_dereq_("../internals/define-well-known-symbol");defineWellKnownSymbol("iterator")},{"../internals/define-well-known-symbol":60}],222:[function(_dereq_,module,exports){"use strict";var $=_dereq_("../internals/export");var global=_dereq_("../internals/global");var getBuiltIn=_dereq_("../internals/get-built-in");var IS_PURE=_dereq_("../internals/is-pure");var DESCRIPTORS=_dereq_("../internals/descriptors");var NATIVE_SYMBOL=_dereq_("../internals/native-symbol");var USE_SYMBOL_AS_UID=_dereq_("../internals/use-symbol-as-uid");var fails=_dereq_("../internals/fails");var has=_dereq_("../internals/has");var isArray=_dereq_("../internals/is-array");var isObject=_dereq_("../internals/is-object");var anObject=_dereq_("../internals/an-object");var toObject=_dereq_("../internals/to-object");var toIndexedObject=_dereq_("../internals/to-indexed-object");var toPrimitive=_dereq_("../internals/to-primitive");var createPropertyDescriptor=_dereq_("../internals/create-property-descriptor");var nativeObjectCreate=_dereq_("../internals/object-create");var objectKeys=_dereq_("../internals/object-keys");var getOwnPropertyNamesModule=_dereq_("../internals/object-get-own-property-names");var getOwnPropertyNamesExternal=_dereq_("../internals/object-get-own-property-names-external");var getOwnPropertySymbolsModule=_dereq_("../internals/object-get-own-property-symbols");var getOwnPropertyDescriptorModule=_dereq_("../internals/object-get-own-property-descriptor");var definePropertyModule=_dereq_("../internals/object-define-property");var propertyIsEnumerableModule=_dereq_("../internals/object-property-is-enumerable");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var redefine=_dereq_("../internals/redefine");var shared=_dereq_("../internals/shared");var sharedKey=_dereq_("../internals/shared-key");var hiddenKeys=_dereq_("../internals/hidden-keys");var uid=_dereq_("../internals/uid");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var wrappedWellKnownSymbolModule=_dereq_("../internals/well-known-symbol-wrapped");var defineWellKnownSymbol=_dereq_("../internals/define-well-known-symbol");var setToStringTag=_dereq_("../internals/set-to-string-tag");var InternalStateModule=_dereq_("../internals/internal-state");var $forEach=_dereq_("../internals/array-iteration").forEach;var HIDDEN=sharedKey("hidden");var SYMBOL="Symbol";var PROTOTYPE="prototype";var TO_PRIMITIVE=wellKnownSymbol("toPrimitive");var setInternalState=InternalStateModule.set;var getInternalState=InternalStateModule.getterFor(SYMBOL);var ObjectPrototype=Object[PROTOTYPE];var $Symbol=global.Symbol;var $stringify=getBuiltIn("JSON","stringify");var nativeGetOwnPropertyDescriptor=getOwnPropertyDescriptorModule.f;var nativeDefineProperty=definePropertyModule.f;var nativeGetOwnPropertyNames=getOwnPropertyNamesExternal.f;var nativePropertyIsEnumerable=propertyIsEnumerableModule.f;var AllSymbols=shared("symbols");var ObjectPrototypeSymbols=shared("op-symbols");var StringToSymbolRegistry=shared("string-to-symbol-registry");var SymbolToStringRegistry=shared("symbol-to-string-registry");var WellKnownSymbolsStore=shared("wks");var QObject=global.QObject;var USE_SETTER=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild;var setSymbolDescriptor=DESCRIPTORS&&fails(function(){return nativeObjectCreate(nativeDefineProperty({},"a",{get:function(){return nativeDefineProperty(this,"a",{value:7}).a}})).a!=7})?function(O,P,Attributes){var ObjectPrototypeDescriptor=nativeGetOwnPropertyDescriptor(ObjectPrototype,P);if(ObjectPrototypeDescriptor)delete ObjectPrototype[P];nativeDefineProperty(O,P,Attributes);if(ObjectPrototypeDescriptor&&O!==ObjectPrototype){nativeDefineProperty(ObjectPrototype,P,ObjectPrototypeDescriptor)}}:nativeDefineProperty;var wrap=function(tag,description){var symbol=AllSymbols[tag]=nativeObjectCreate($Symbol[PROTOTYPE]);setInternalState(symbol,{type:SYMBOL,tag:tag,description:description});if(!DESCRIPTORS)symbol.description=description;return symbol};var isSymbol=USE_SYMBOL_AS_UID?function(it){return typeof it=="symbol"}:function(it){return Object(it)instanceof $Symbol};var $defineProperty=function defineProperty(O,P,Attributes){if(O===ObjectPrototype)$defineProperty(ObjectPrototypeSymbols,P,Attributes);anObject(O);var key=toPrimitive(P,true);anObject(Attributes);if(has(AllSymbols,key)){if(!Attributes.enumerable){if(!has(O,HIDDEN))nativeDefineProperty(O,HIDDEN,createPropertyDescriptor(1,{}));O[HIDDEN][key]=true}else{if(has(O,HIDDEN)&&O[HIDDEN][key])O[HIDDEN][key]=false;Attributes=nativeObjectCreate(Attributes,{enumerable:createPropertyDescriptor(0,false)})}return setSymbolDescriptor(O,key,Attributes)}return nativeDefineProperty(O,key,Attributes)};var $defineProperties=function defineProperties(O,Properties){anObject(O);var properties=toIndexedObject(Properties);var keys=objectKeys(properties).concat($getOwnPropertySymbols(properties));$forEach(keys,function(key){if(!DESCRIPTORS||$propertyIsEnumerable.call(properties,key))$defineProperty(O,key,properties[key])});return O};var $create=function create(O,Properties){return Properties===undefined?nativeObjectCreate(O):$defineProperties(nativeObjectCreate(O),Properties)};var $propertyIsEnumerable=function propertyIsEnumerable(V){var P=toPrimitive(V,true);var enumerable=nativePropertyIsEnumerable.call(this,P);if(this===ObjectPrototype&&has(AllSymbols,P)&&!has(ObjectPrototypeSymbols,P))return false;return enumerable||!has(this,P)||!has(AllSymbols,P)||has(this,HIDDEN)&&this[HIDDEN][P]?enumerable:true};var $getOwnPropertyDescriptor=function getOwnPropertyDescriptor(O,P){var it=toIndexedObject(O);var key=toPrimitive(P,true);if(it===ObjectPrototype&&has(AllSymbols,key)&&!has(ObjectPrototypeSymbols,key))return;var descriptor=nativeGetOwnPropertyDescriptor(it,key);if(descriptor&&has(AllSymbols,key)&&!(has(it,HIDDEN)&&it[HIDDEN][key])){descriptor.enumerable=true}return descriptor};var $getOwnPropertyNames=function getOwnPropertyNames(O){var names=nativeGetOwnPropertyNames(toIndexedObject(O));var result=[];$forEach(names,function(key){if(!has(AllSymbols,key)&&!has(hiddenKeys,key))result.push(key)});return result};var $getOwnPropertySymbols=function getOwnPropertySymbols(O){var IS_OBJECT_PROTOTYPE=O===ObjectPrototype;var names=nativeGetOwnPropertyNames(IS_OBJECT_PROTOTYPE?ObjectPrototypeSymbols:toIndexedObject(O));var result=[];$forEach(names,function(key){if(has(AllSymbols,key)&&(!IS_OBJECT_PROTOTYPE||has(ObjectPrototype,key))){result.push(AllSymbols[key])}});return result};if(!NATIVE_SYMBOL){$Symbol=function Symbol(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor");var description=!arguments.length||arguments[0]===undefined?undefined:String(arguments[0]);var tag=uid(description);var setter=function(value){if(this===ObjectPrototype)setter.call(ObjectPrototypeSymbols,value);if(has(this,HIDDEN)&&has(this[HIDDEN],tag))this[HIDDEN][tag]=false;setSymbolDescriptor(this,tag,createPropertyDescriptor(1,value))};if(DESCRIPTORS&&USE_SETTER)setSymbolDescriptor(ObjectPrototype,tag,{configurable:true,set:setter});return wrap(tag,description)};redefine($Symbol[PROTOTYPE],"toString",function toString(){return getInternalState(this).tag});redefine($Symbol,"withoutSetter",function(description){return wrap(uid(description),description)});propertyIsEnumerableModule.f=$propertyIsEnumerable;definePropertyModule.f=$defineProperty;getOwnPropertyDescriptorModule.f=$getOwnPropertyDescriptor;getOwnPropertyNamesModule.f=getOwnPropertyNamesExternal.f=$getOwnPropertyNames;getOwnPropertySymbolsModule.f=$getOwnPropertySymbols;wrappedWellKnownSymbolModule.f=function(name){return wrap(wellKnownSymbol(name),name)};if(DESCRIPTORS){nativeDefineProperty($Symbol[PROTOTYPE],"description",{configurable:true,get:function description(){return getInternalState(this).description}});if(!IS_PURE){redefine(ObjectPrototype,"propertyIsEnumerable",$propertyIsEnumerable,{unsafe:true})}}}$({global:true,wrap:true,forced:!NATIVE_SYMBOL,sham:!NATIVE_SYMBOL},{Symbol:$Symbol});$forEach(objectKeys(WellKnownSymbolsStore),function(name){defineWellKnownSymbol(name)});$({target:SYMBOL,stat:true,forced:!NATIVE_SYMBOL},{for:function(key){var string=String(key);if(has(StringToSymbolRegistry,string))return StringToSymbolRegistry[string];var symbol=$Symbol(string);StringToSymbolRegistry[string]=symbol;SymbolToStringRegistry[symbol]=string;return symbol},keyFor:function keyFor(sym){if(!isSymbol(sym))throw TypeError(sym+" is not a symbol");if(has(SymbolToStringRegistry,sym))return SymbolToStringRegistry[sym]},useSetter:function(){USE_SETTER=true},useSimple:function(){USE_SETTER=false}});$({target:"Object",stat:true,forced:!NATIVE_SYMBOL,sham:!DESCRIPTORS},{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor});$({target:"Object",stat:true,forced:!NATIVE_SYMBOL},{getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols});$({target:"Object",stat:true,forced:fails(function(){getOwnPropertySymbolsModule.f(1)})},{getOwnPropertySymbols:function getOwnPropertySymbols(it){return getOwnPropertySymbolsModule.f(toObject(it))}});if($stringify){var FORCED_JSON_STRINGIFY=!NATIVE_SYMBOL||fails(function(){var symbol=$Symbol();return $stringify([symbol])!="[null]"||$stringify({a:symbol})!="{}"||$stringify(Object(symbol))!="{}"});$({target:"JSON",stat:true,forced:FORCED_JSON_STRINGIFY},{stringify:function stringify(it,replacer,space){var args=[it];var index=1;var $replacer;while(arguments.length>index)args.push(arguments[index++]);$replacer=replacer;if(!isObject(replacer)&&it===undefined||isSymbol(it))return;if(!isArray(replacer))replacer=function(key,value){if(typeof $replacer=="function")value=$replacer.call(this,key,value);if(!isSymbol(value))return value};args[1]=replacer;return $stringify.apply(null,args)}})}if(!$Symbol[PROTOTYPE][TO_PRIMITIVE]){createNonEnumerableProperty($Symbol[PROTOTYPE],TO_PRIMITIVE,$Symbol[PROTOTYPE].valueOf)}setToStringTag($Symbol,SYMBOL);hiddenKeys[HIDDEN]=true},{"../internals/an-object":28,"../internals/array-iteration":37,"../internals/create-non-enumerable-property":56,"../internals/create-property-descriptor":57,"../internals/define-well-known-symbol":60,"../internals/descriptors":61,"../internals/export":68,"../internals/fails":69,"../internals/get-built-in":74,"../internals/global":77,"../internals/has":78,"../internals/hidden-keys":79,"../internals/internal-state":88,"../internals/is-array":90,"../internals/is-object":92,"../internals/is-pure":93,"../internals/native-symbol":101,"../internals/object-create":108,"../internals/object-define-property":110,"../internals/object-get-own-property-descriptor":111,"../internals/object-get-own-property-names":113,"../internals/object-get-own-property-names-external":112,"../internals/object-get-own-property-symbols":114,"../internals/object-keys":117,"../internals/object-property-is-enumerable":118,"../internals/redefine":126,"../internals/set-to-string-tag":135,"../internals/shared":138,"../internals/shared-key":136,"../internals/to-indexed-object":152,"../internals/to-object":155,"../internals/to-primitive":158,"../internals/uid":163,"../internals/use-symbol-as-uid":164,"../internals/well-known-symbol":166,"../internals/well-known-symbol-wrapped":165}],223:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $copyWithin=_dereq_("../internals/array-copy-within");var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("copyWithin",function copyWithin(target,start){return $copyWithin.call(aTypedArray(this),target,start,arguments.length>2?arguments[2]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-copy-within":32}],224:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $every=_dereq_("../internals/array-iteration").every;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("every",function every(callbackfn){return $every(aTypedArray(this),callbackfn,arguments.length>1?arguments[1]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-iteration":37}],225:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $fill=_dereq_("../internals/array-fill");var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("fill",function fill(value){return $fill.apply(aTypedArray(this),arguments)})},{"../internals/array-buffer-view-core":30,"../internals/array-fill":33}],226:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $filter=_dereq_("../internals/array-iteration").filter;var speciesConstructor=_dereq_("../internals/species-constructor");var aTypedArray=ArrayBufferViewCore.aTypedArray;var aTypedArrayConstructor=ArrayBufferViewCore.aTypedArrayConstructor;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("filter",function filter(callbackfn){var list=$filter(aTypedArray(this),callbackfn,arguments.length>1?arguments[1]:undefined);var C=speciesConstructor(this,this.constructor);var index=0;var length=list.length;var result=new(aTypedArrayConstructor(C))(length);while(length>index)result[index]=list[index++];return result})},{"../internals/array-buffer-view-core":30,"../internals/array-iteration":37,"../internals/species-constructor":139}],227:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $findIndex=_dereq_("../internals/array-iteration").findIndex;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("findIndex",function findIndex(predicate){return $findIndex(aTypedArray(this),predicate,arguments.length>1?arguments[1]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-iteration":37}],228:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $find=_dereq_("../internals/array-iteration").find;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("find",function find(predicate){return $find(aTypedArray(this),predicate,arguments.length>1?arguments[1]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-iteration":37}],229:[function(_dereq_,module,exports){var createTypedArrayConstructor=_dereq_("../internals/typed-array-constructor");createTypedArrayConstructor("Float32",function(init){return function Float32Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},{"../internals/typed-array-constructor":160}],230:[function(_dereq_,module,exports){var createTypedArrayConstructor=_dereq_("../internals/typed-array-constructor");createTypedArrayConstructor("Float64",function(init){return function Float64Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},{"../internals/typed-array-constructor":160}],231:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $forEach=_dereq_("../internals/array-iteration").forEach;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("forEach",function forEach(callbackfn){$forEach(aTypedArray(this),callbackfn,arguments.length>1?arguments[1]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-iteration":37}],232:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $includes=_dereq_("../internals/array-includes").includes;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("includes",function includes(searchElement){return $includes(aTypedArray(this),searchElement,arguments.length>1?arguments[1]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-includes":36}],233:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $indexOf=_dereq_("../internals/array-includes").indexOf;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("indexOf",function indexOf(searchElement){return $indexOf(aTypedArray(this),searchElement,arguments.length>1?arguments[1]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-includes":36}],234:[function(_dereq_,module,exports){var createTypedArrayConstructor=_dereq_("../internals/typed-array-constructor");createTypedArrayConstructor("Int16",function(init){return function Int16Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},{"../internals/typed-array-constructor":160}],235:[function(_dereq_,module,exports){var createTypedArrayConstructor=_dereq_("../internals/typed-array-constructor");createTypedArrayConstructor("Int32",function(init){return function Int32Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},{"../internals/typed-array-constructor":160}],236:[function(_dereq_,module,exports){"use strict";var global=_dereq_("../internals/global");var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var ArrayIterators=_dereq_("../modules/es.array.iterator");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var ITERATOR=wellKnownSymbol("iterator");var Uint8Array=global.Uint8Array;var arrayValues=ArrayIterators.values;var arrayKeys=ArrayIterators.keys;var arrayEntries=ArrayIterators.entries;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;var nativeTypedArrayIterator=Uint8Array&&Uint8Array.prototype[ITERATOR];var CORRECT_ITER_NAME=!!nativeTypedArrayIterator&&(nativeTypedArrayIterator.name=="values"||nativeTypedArrayIterator.name==undefined);var typedArrayValues=function values(){return arrayValues.call(aTypedArray(this))};exportTypedArrayMethod("entries",function entries(){return arrayEntries.call(aTypedArray(this))});exportTypedArrayMethod("keys",function keys(){return arrayKeys.call(aTypedArray(this))});exportTypedArrayMethod("values",typedArrayValues,!CORRECT_ITER_NAME);exportTypedArrayMethod(ITERATOR,typedArrayValues,!CORRECT_ITER_NAME)},{"../internals/array-buffer-view-core":30,"../internals/global":77,"../internals/well-known-symbol":166,"../modules/es.array.iterator":179}],237:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;var $join=[].join;exportTypedArrayMethod("join",function join(separator){return $join.apply(aTypedArray(this),arguments)})},{"../internals/array-buffer-view-core":30}],238:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $lastIndexOf=_dereq_("../internals/array-last-index-of");var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("lastIndexOf",function lastIndexOf(searchElement){return $lastIndexOf.apply(aTypedArray(this),arguments)})},{"../internals/array-buffer-view-core":30,"../internals/array-last-index-of":38}],239:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $map=_dereq_("../internals/array-iteration").map;var speciesConstructor=_dereq_("../internals/species-constructor");var aTypedArray=ArrayBufferViewCore.aTypedArray;var aTypedArrayConstructor=ArrayBufferViewCore.aTypedArrayConstructor;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("map",function map(mapfn){return $map(aTypedArray(this),mapfn,arguments.length>1?arguments[1]:undefined,function(O,length){return new(aTypedArrayConstructor(speciesConstructor(O,O.constructor)))(length)})})},{"../internals/array-buffer-view-core":30,"../internals/array-iteration":37,"../internals/species-constructor":139}],240:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $reduceRight=_dereq_("../internals/array-reduce").right;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("reduceRight",function reduceRight(callbackfn){return $reduceRight(aTypedArray(this),callbackfn,arguments.length,arguments.length>1?arguments[1]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-reduce":42}],241:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $reduce=_dereq_("../internals/array-reduce").left;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("reduce",function reduce(callbackfn){return $reduce(aTypedArray(this),callbackfn,arguments.length,arguments.length>1?arguments[1]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-reduce":42}],242:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;var floor=Math.floor;exportTypedArrayMethod("reverse",function reverse(){var that=this;var length=aTypedArray(that).length;var middle=floor(length/2);var index=0;var value;while(index<middle){value=that[index];that[index++]=that[--length];that[length]=value}return that})},{"../internals/array-buffer-view-core":30}],243:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var toLength=_dereq_("../internals/to-length");var toOffset=_dereq_("../internals/to-offset");var toObject=_dereq_("../internals/to-object");var fails=_dereq_("../internals/fails");var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;var FORCED=fails(function(){new Int8Array(1).set({})});exportTypedArrayMethod("set",function set(arrayLike){aTypedArray(this);var offset=toOffset(arguments.length>1?arguments[1]:undefined,1);var length=this.length;var src=toObject(arrayLike);var len=toLength(src.length);var index=0;if(len+offset>length)throw RangeError("Wrong length");while(index<len)this[offset+index]=src[index++]},FORCED)},{"../internals/array-buffer-view-core":30,"../internals/fails":69,"../internals/to-length":154,"../internals/to-object":155,"../internals/to-offset":156}],244:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var speciesConstructor=_dereq_("../internals/species-constructor");var fails=_dereq_("../internals/fails");var aTypedArray=ArrayBufferViewCore.aTypedArray;var aTypedArrayConstructor=ArrayBufferViewCore.aTypedArrayConstructor;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;var $slice=[].slice;var FORCED=fails(function(){new Int8Array(1).slice()});exportTypedArrayMethod("slice",function slice(start,end){var list=$slice.call(aTypedArray(this),start,end);var C=speciesConstructor(this,this.constructor);var index=0;var length=list.length;var result=new(aTypedArrayConstructor(C))(length);while(length>index)result[index]=list[index++];return result},FORCED)},{"../internals/array-buffer-view-core":30,"../internals/fails":69,"../internals/species-constructor":139}],245:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var $some=_dereq_("../internals/array-iteration").some;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("some",function some(callbackfn){return $some(aTypedArray(this),callbackfn,arguments.length>1?arguments[1]:undefined)})},{"../internals/array-buffer-view-core":30,"../internals/array-iteration":37}],246:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;var $sort=[].sort;exportTypedArrayMethod("sort",function sort(comparefn){return $sort.call(aTypedArray(this),comparefn)})},{"../internals/array-buffer-view-core":30}],247:[function(_dereq_,module,exports){"use strict";var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var toLength=_dereq_("../internals/to-length");var toAbsoluteIndex=_dereq_("../internals/to-absolute-index");var speciesConstructor=_dereq_("../internals/species-constructor");var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;exportTypedArrayMethod("subarray",function subarray(begin,end){var O=aTypedArray(this);var length=O.length;var beginIndex=toAbsoluteIndex(begin,length);return new(speciesConstructor(O,O.constructor))(O.buffer,O.byteOffset+beginIndex*O.BYTES_PER_ELEMENT,toLength((end===undefined?length:toAbsoluteIndex(end,length))-beginIndex))})},{"../internals/array-buffer-view-core":30,"../internals/species-constructor":139,"../internals/to-absolute-index":150,"../internals/to-length":154}],248:[function(_dereq_,module,exports){"use strict";var global=_dereq_("../internals/global");var ArrayBufferViewCore=_dereq_("../internals/array-buffer-view-core");var fails=_dereq_("../internals/fails");var Int8Array=global.Int8Array;var aTypedArray=ArrayBufferViewCore.aTypedArray;var exportTypedArrayMethod=ArrayBufferViewCore.exportTypedArrayMethod;var $toLocaleString=[].toLocaleString;var $slice=[].slice;var TO_LOCALE_STRING_BUG=!!Int8Array&&fails(function(){$toLocaleString.call(new Int8Array(1))});var FORCED=fails(function(){return[1,2].toLocaleString()!=new Int8Array([1,2]).toLocaleString()})||!fails(function(){Int8Array.prototype.toLocaleString.call([1,2])});exportTypedArrayMethod("toLocaleString",function toLocaleString(){return $toLocaleString.apply(TO_LOCALE_STRING_BUG?$slice.call(aTypedArray(this)):aTypedArray(this),arguments)},FORCED)},{"../internals/array-buffer-view-core":30,"../internals/fails":69,"../internals/global":77}],249:[function(_dereq_,module,exports){"use strict";var exportTypedArrayMethod=_dereq_("../internals/array-buffer-view-core").exportTypedArrayMethod;var fails=_dereq_("../internals/fails");var global=_dereq_("../internals/global");var Uint8Array=global.Uint8Array;var Uint8ArrayPrototype=Uint8Array&&Uint8Array.prototype||{};var arrayToString=[].toString;var arrayJoin=[].join;if(fails(function(){arrayToString.call({})})){arrayToString=function toString(){return arrayJoin.call(this)}}var IS_NOT_ARRAY_METHOD=Uint8ArrayPrototype.toString!=arrayToString;exportTypedArrayMethod("toString",arrayToString,IS_NOT_ARRAY_METHOD)},{"../internals/array-buffer-view-core":30,"../internals/fails":69,"../internals/global":77}],250:[function(_dereq_,module,exports){var createTypedArrayConstructor=_dereq_("../internals/typed-array-constructor");createTypedArrayConstructor("Uint16",function(init){return function Uint16Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},{"../internals/typed-array-constructor":160}],251:[function(_dereq_,module,exports){var createTypedArrayConstructor=_dereq_("../internals/typed-array-constructor");createTypedArrayConstructor("Uint32",function(init){return function Uint32Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},{"../internals/typed-array-constructor":160}],252:[function(_dereq_,module,exports){var createTypedArrayConstructor=_dereq_("../internals/typed-array-constructor");createTypedArrayConstructor("Uint8",function(init){return function Uint8Array(data,byteOffset,length){return init(this,data,byteOffset,length)}})},{"../internals/typed-array-constructor":160}],253:[function(_dereq_,module,exports){var createTypedArrayConstructor=_dereq_("../internals/typed-array-constructor");createTypedArrayConstructor("Uint8",function(init){return function Uint8ClampedArray(data,byteOffset,length){return init(this,data,byteOffset,length)}},true)},{"../internals/typed-array-constructor":160}],254:[function(_dereq_,module,exports){"use strict";var global=_dereq_("../internals/global");var redefineAll=_dereq_("../internals/redefine-all");var InternalMetadataModule=_dereq_("../internals/internal-metadata");var collection=_dereq_("../internals/collection");var collectionWeak=_dereq_("../internals/collection-weak");var isObject=_dereq_("../internals/is-object");var enforceIternalState=_dereq_("../internals/internal-state").enforce;var NATIVE_WEAK_MAP=_dereq_("../internals/native-weak-map");var IS_IE11=!global.ActiveXObject&&"ActiveXObject"in global;var isExtensible=Object.isExtensible;var InternalWeakMap;var wrapper=function(init){return function WeakMap(){return init(this,arguments.length?arguments[0]:undefined)}};var $WeakMap=module.exports=collection("WeakMap",wrapper,collectionWeak);if(NATIVE_WEAK_MAP&&IS_IE11){InternalWeakMap=collectionWeak.getConstructor(wrapper,"WeakMap",true);InternalMetadataModule.REQUIRED=true;var WeakMapPrototype=$WeakMap.prototype;var nativeDelete=WeakMapPrototype["delete"];var nativeHas=WeakMapPrototype.has;var nativeGet=WeakMapPrototype.get;var nativeSet=WeakMapPrototype.set;redefineAll(WeakMapPrototype,{delete:function(key){if(isObject(key)&&!isExtensible(key)){var state=enforceIternalState(this);if(!state.frozen)state.frozen=new InternalWeakMap;return nativeDelete.call(this,key)||state.frozen["delete"](key)}return nativeDelete.call(this,key)},has:function has(key){if(isObject(key)&&!isExtensible(key)){var state=enforceIternalState(this);if(!state.frozen)state.frozen=new InternalWeakMap;return nativeHas.call(this,key)||state.frozen.has(key)}return nativeHas.call(this,key)},get:function get(key){if(isObject(key)&&!isExtensible(key)){var state=enforceIternalState(this);if(!state.frozen)state.frozen=new InternalWeakMap;return nativeHas.call(this,key)?nativeGet.call(this,key):state.frozen.get(key)}return nativeGet.call(this,key)},set:function set(key,value){if(isObject(key)&&!isExtensible(key)){var state=enforceIternalState(this);if(!state.frozen)state.frozen=new InternalWeakMap;nativeHas.call(this,key)?nativeSet.call(this,key,value):state.frozen.set(key,value)}else nativeSet.call(this,key,value);return this}})}},{"../internals/collection":50,"../internals/collection-weak":49,"../internals/global":77,"../internals/internal-metadata":87,"../internals/internal-state":88,"../internals/is-object":92,"../internals/native-weak-map":103,"../internals/redefine-all":125}],255:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var DOMIterables=_dereq_("../internals/dom-iterables");var forEach=_dereq_("../internals/array-for-each");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");for(var COLLECTION_NAME in DOMIterables){var Collection=global[COLLECTION_NAME];var CollectionPrototype=Collection&&Collection.prototype;if(CollectionPrototype&&CollectionPrototype.forEach!==forEach)try{createNonEnumerableProperty(CollectionPrototype,"forEach",forEach)}catch(error){CollectionPrototype.forEach=forEach}}},{"../internals/array-for-each":34,"../internals/create-non-enumerable-property":56,"../internals/dom-iterables":63,"../internals/global":77}],256:[function(_dereq_,module,exports){var global=_dereq_("../internals/global");var DOMIterables=_dereq_("../internals/dom-iterables");var ArrayIteratorMethods=_dereq_("../modules/es.array.iterator");var createNonEnumerableProperty=_dereq_("../internals/create-non-enumerable-property");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var ITERATOR=wellKnownSymbol("iterator");var TO_STRING_TAG=wellKnownSymbol("toStringTag");var ArrayValues=ArrayIteratorMethods.values;for(var COLLECTION_NAME in DOMIterables){var Collection=global[COLLECTION_NAME];var CollectionPrototype=Collection&&Collection.prototype;if(CollectionPrototype){if(CollectionPrototype[ITERATOR]!==ArrayValues)try{createNonEnumerableProperty(CollectionPrototype,ITERATOR,ArrayValues)}catch(error){CollectionPrototype[ITERATOR]=ArrayValues}if(!CollectionPrototype[TO_STRING_TAG]){createNonEnumerableProperty(CollectionPrototype,TO_STRING_TAG,COLLECTION_NAME)}if(DOMIterables[COLLECTION_NAME])for(var METHOD_NAME in ArrayIteratorMethods){if(CollectionPrototype[METHOD_NAME]!==ArrayIteratorMethods[METHOD_NAME])try{createNonEnumerableProperty(CollectionPrototype,METHOD_NAME,ArrayIteratorMethods[METHOD_NAME])}catch(error){CollectionPrototype[METHOD_NAME]=ArrayIteratorMethods[METHOD_NAME]}}}}},{"../internals/create-non-enumerable-property":56,"../internals/dom-iterables":63,"../internals/global":77,"../internals/well-known-symbol":166,"../modules/es.array.iterator":179}],257:[function(_dereq_,module,exports){"use strict";_dereq_("../modules/es.array.iterator");var $=_dereq_("../internals/export");var getBuiltIn=_dereq_("../internals/get-built-in");var USE_NATIVE_URL=_dereq_("../internals/native-url");var redefine=_dereq_("../internals/redefine");var redefineAll=_dereq_("../internals/redefine-all");var setToStringTag=_dereq_("../internals/set-to-string-tag");var createIteratorConstructor=_dereq_("../internals/create-iterator-constructor");var InternalStateModule=_dereq_("../internals/internal-state");var anInstance=_dereq_("../internals/an-instance");var hasOwn=_dereq_("../internals/has");var bind=_dereq_("../internals/function-bind-context");var classof=_dereq_("../internals/classof");var anObject=_dereq_("../internals/an-object");var isObject=_dereq_("../internals/is-object");var create=_dereq_("../internals/object-create");var createPropertyDescriptor=_dereq_("../internals/create-property-descriptor");var getIterator=_dereq_("../internals/get-iterator");var getIteratorMethod=_dereq_("../internals/get-iterator-method");var wellKnownSymbol=_dereq_("../internals/well-known-symbol");var $fetch=getBuiltIn("fetch");var Headers=getBuiltIn("Headers");var ITERATOR=wellKnownSymbol("iterator");var URL_SEARCH_PARAMS="URLSearchParams";var URL_SEARCH_PARAMS_ITERATOR=URL_SEARCH_PARAMS+"Iterator";var setInternalState=InternalStateModule.set;var getInternalParamsState=InternalStateModule.getterFor(URL_SEARCH_PARAMS);var getInternalIteratorState=InternalStateModule.getterFor(URL_SEARCH_PARAMS_ITERATOR);var plus=/\+/g;var sequences=Array(4);var percentSequence=function(bytes){return sequences[bytes-1]||(sequences[bytes-1]=RegExp("((?:%[\\da-f]{2}){"+bytes+"})","gi"))};var percentDecode=function(sequence){try{return decodeURIComponent(sequence)}catch(error){return sequence}};var deserialize=function(it){var result=it.replace(plus," ");var bytes=4;try{return decodeURIComponent(result)}catch(error){while(bytes){result=result.replace(percentSequence(bytes--),percentDecode)}return result}};var find=/[!'()~]|%20/g;var replace={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"};var replacer=function(match){return replace[match]};var serialize=function(it){return encodeURIComponent(it).replace(find,replacer)};var parseSearchParams=function(result,query){if(query){var attributes=query.split("&");var index=0;var attribute,entry;while(index<attributes.length){attribute=attributes[index++];if(attribute.length){entry=attribute.split("=");result.push({key:deserialize(entry.shift()),value:deserialize(entry.join("="))})}}}};var updateSearchParams=function(query){this.entries.length=0;parseSearchParams(this.entries,query)};var validateArgumentsLength=function(passed,required){if(passed<required)throw TypeError("Not enough arguments")};var URLSearchParamsIterator=createIteratorConstructor(function Iterator(params,kind){setInternalState(this,{type:URL_SEARCH_PARAMS_ITERATOR,iterator:getIterator(getInternalParamsState(params).entries),kind:kind})},"Iterator",function next(){var state=getInternalIteratorState(this);var kind=state.kind;var step=state.iterator.next();var entry=step.value;if(!step.done){step.value=kind==="keys"?entry.key:kind==="values"?entry.value:[entry.key,entry.value]}return step});var URLSearchParamsConstructor=function URLSearchParams(){anInstance(this,URLSearchParamsConstructor,URL_SEARCH_PARAMS);var init=arguments.length>0?arguments[0]:undefined;var that=this;var entries=[];var iteratorMethod,iterator,next,step,entryIterator,entryNext,first,second,key;setInternalState(that,{type:URL_SEARCH_PARAMS,entries:entries,updateURL:function(){},updateSearchParams:updateSearchParams});if(init!==undefined){if(isObject(init)){iteratorMethod=getIteratorMethod(init);if(typeof iteratorMethod==="function"){iterator=iteratorMethod.call(init);next=iterator.next;while(!(step=next.call(iterator)).done){entryIterator=getIterator(anObject(step.value));entryNext=entryIterator.next;if((first=entryNext.call(entryIterator)).done||(second=entryNext.call(entryIterator)).done||!entryNext.call(entryIterator).done)throw TypeError("Expected sequence with length 2");entries.push({key:first.value+"",value:second.value+""})}}else for(key in init)if(hasOwn(init,key))entries.push({key:key,value:init[key]+""})}else{parseSearchParams(entries,typeof init==="string"?init.charAt(0)==="?"?init.slice(1):init:init+"")}}};var URLSearchParamsPrototype=URLSearchParamsConstructor.prototype;redefineAll(URLSearchParamsPrototype,{append:function append(name,value){validateArgumentsLength(arguments.length,2);var state=getInternalParamsState(this);state.entries.push({key:name+"",value:value+""});state.updateURL()},delete:function(name){validateArgumentsLength(arguments.length,1);var state=getInternalParamsState(this);var entries=state.entries;var key=name+"";var index=0;while(index<entries.length){if(entries[index].key===key)entries.splice(index,1);else index++}state.updateURL()},get:function get(name){validateArgumentsLength(arguments.length,1);var entries=getInternalParamsState(this).entries;var key=name+"";var index=0;for(;index<entries.length;index++){if(entries[index].key===key)return entries[index].value}return null},getAll:function getAll(name){validateArgumentsLength(arguments.length,1);var entries=getInternalParamsState(this).entries;var key=name+"";var result=[];var index=0;for(;index<entries.length;index++){if(entries[index].key===key)result.push(entries[index].value)}return result},has:function has(name){validateArgumentsLength(arguments.length,1);var entries=getInternalParamsState(this).entries;var key=name+"";var index=0;while(index<entries.length){if(entries[index++].key===key)return true}return false},set:function set(name,value){validateArgumentsLength(arguments.length,1);var state=getInternalParamsState(this);var entries=state.entries;var found=false;var key=name+"";var val=value+"";var index=0;var entry;for(;index<entries.length;index++){entry=entries[index];if(entry.key===key){if(found)entries.splice(index--,1);else{found=true;entry.value=val}}}if(!found)entries.push({key:key,value:val});state.updateURL()},sort:function sort(){var state=getInternalParamsState(this);var entries=state.entries;var slice=entries.slice();var entry,entriesIndex,sliceIndex;entries.length=0;for(sliceIndex=0;sliceIndex<slice.length;sliceIndex++){entry=slice[sliceIndex];for(entriesIndex=0;entriesIndex<sliceIndex;entriesIndex++){if(entries[entriesIndex].key>entry.key){entries.splice(entriesIndex,0,entry);break}}if(entriesIndex===sliceIndex)entries.push(entry)}state.updateURL()},forEach:function forEach(callback){var entries=getInternalParamsState(this).entries;var boundFunction=bind(callback,arguments.length>1?arguments[1]:undefined,3);var index=0;var entry;while(index<entries.length){entry=entries[index++];boundFunction(entry.value,entry.key,this)}},keys:function keys(){return new URLSearchParamsIterator(this,"keys")},values:function values(){return new URLSearchParamsIterator(this,"values")},entries:function entries(){return new URLSearchParamsIterator(this,"entries")}},{enumerable:true});redefine(URLSearchParamsPrototype,ITERATOR,URLSearchParamsPrototype.entries);redefine(URLSearchParamsPrototype,"toString",function toString(){var entries=getInternalParamsState(this).entries;var result=[];var index=0;var entry;while(index<entries.length){entry=entries[index++];result.push(serialize(entry.key)+"="+serialize(entry.value))}return result.join("&")},{enumerable:true});setToStringTag(URLSearchParamsConstructor,URL_SEARCH_PARAMS);$({global:true,forced:!USE_NATIVE_URL},{URLSearchParams:URLSearchParamsConstructor});if(!USE_NATIVE_URL&&typeof $fetch=="function"&&typeof Headers=="function"){$({global:true,enumerable:true,forced:true},{fetch:function fetch(input){var args=[input];var init,body,headers;if(arguments.length>1){init=arguments[1];if(isObject(init)){body=init.body;if(classof(body)===URL_SEARCH_PARAMS){headers=init.headers?new Headers(init.headers):new Headers;if(!headers.has("content-type")){headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8")}init=create(init,{body:createPropertyDescriptor(0,String(body)),headers:createPropertyDescriptor(0,headers)})}}args.push(init)}return $fetch.apply(this,args)}})}module.exports={URLSearchParams:URLSearchParamsConstructor,getState:getInternalParamsState}},{"../internals/an-instance":27,"../internals/an-object":28,"../internals/classof":47,"../internals/create-iterator-constructor":55,"../internals/create-property-descriptor":57,"../internals/export":68,"../internals/function-bind-context":72,"../internals/get-built-in":74,"../internals/get-iterator":76,"../internals/get-iterator-method":75,"../internals/has":78,"../internals/internal-state":88,"../internals/is-object":92,"../internals/native-url":102,"../internals/object-create":108,"../internals/redefine":126,"../internals/redefine-all":125,"../internals/set-to-string-tag":135,"../internals/well-known-symbol":166,"../modules/es.array.iterator":179}],258:[function(_dereq_,module,exports){"use strict";_dereq_("../modules/es.string.iterator");var $=_dereq_("../internals/export");var DESCRIPTORS=_dereq_("../internals/descriptors");var USE_NATIVE_URL=_dereq_("../internals/native-url");var global=_dereq_("../internals/global");var defineProperties=_dereq_("../internals/object-define-properties");var redefine=_dereq_("../internals/redefine");var anInstance=_dereq_("../internals/an-instance");var has=_dereq_("../internals/has");var assign=_dereq_("../internals/object-assign");var arrayFrom=_dereq_("../internals/array-from");var codeAt=_dereq_("../internals/string-multibyte").codeAt;var toASCII=_dereq_("../internals/string-punycode-to-ascii");var setToStringTag=_dereq_("../internals/set-to-string-tag");var URLSearchParamsModule=_dereq_("../modules/web.url-search-params");var InternalStateModule=_dereq_("../internals/internal-state");var NativeURL=global.URL;var URLSearchParams=URLSearchParamsModule.URLSearchParams;var getInternalSearchParamsState=URLSearchParamsModule.getState;var setInternalState=InternalStateModule.set;var getInternalURLState=InternalStateModule.getterFor("URL");var floor=Math.floor;var pow=Math.pow;var INVALID_AUTHORITY="Invalid authority";var INVALID_SCHEME="Invalid scheme";var INVALID_HOST="Invalid host";var INVALID_PORT="Invalid port";var ALPHA=/[A-Za-z]/;var ALPHANUMERIC=/[\d+-.A-Za-z]/;var DIGIT=/\d/;var HEX_START=/^(0x|0X)/;var OCT=/^[0-7]+$/;var DEC=/^\d+$/;var HEX=/^[\dA-Fa-f]+$/;var FORBIDDEN_HOST_CODE_POINT=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/;var FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/;var LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g;var TAB_AND_NEW_LINE=/[\u0009\u000A\u000D]/g;var EOF;var parseHost=function(url,input){var result,codePoints,index;if(input.charAt(0)=="["){if(input.charAt(input.length-1)!="]")return INVALID_HOST;result=parseIPv6(input.slice(1,-1));if(!result)return INVALID_HOST;url.host=result}else if(!isSpecial(url)){if(FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT.test(input))return INVALID_HOST;result="";codePoints=arrayFrom(input);for(index=0;index<codePoints.length;index++){result+=percentEncode(codePoints[index],C0ControlPercentEncodeSet)}url.host=result}else{input=toASCII(input);if(FORBIDDEN_HOST_CODE_POINT.test(input))return INVALID_HOST;result=parseIPv4(input);if(result===null)return INVALID_HOST;url.host=result}};var parseIPv4=function(input){var parts=input.split(".");var partsLength,numbers,index,part,radix,number,ipv4;if(parts.length&&parts[parts.length-1]==""){parts.pop()}partsLength=parts.length;if(partsLength>4)return input;numbers=[];for(index=0;index<partsLength;index++){part=parts[index];if(part=="")return input;radix=10;if(part.length>1&&part.charAt(0)=="0"){radix=HEX_START.test(part)?16:8;part=part.slice(radix==8?1:2)}if(part===""){number=0}else{if(!(radix==10?DEC:radix==8?OCT:HEX).test(part))return input;number=parseInt(part,radix)}numbers.push(number)}for(index=0;index<partsLength;index++){number=numbers[index];if(index==partsLength-1){if(number>=pow(256,5-partsLength))return null}else if(number>255)return null}ipv4=numbers.pop();for(index=0;index<numbers.length;index++){ipv4+=numbers[index]*pow(256,3-index)}return ipv4};var parseIPv6=function(input){var address=[0,0,0,0,0,0,0,0];var pieceIndex=0;var compress=null;var pointer=0;var value,length,numbersSeen,ipv4Piece,number,swaps,swap;var char=function(){return input.charAt(pointer)};if(char()==":"){if(input.charAt(1)!=":")return;pointer+=2;pieceIndex++;compress=pieceIndex}while(char()){if(pieceIndex==8)return;if(char()==":"){if(compress!==null)return;pointer++;pieceIndex++;compress=pieceIndex;continue}value=length=0;while(length<4&&HEX.test(char())){value=value*16+parseInt(char(),16);pointer++;length++}if(char()=="."){if(length==0)return;pointer-=length;if(pieceIndex>6)return;numbersSeen=0;while(char()){ipv4Piece=null;if(numbersSeen>0){if(char()=="."&&numbersSeen<4)pointer++;else return}if(!DIGIT.test(char()))return;while(DIGIT.test(char())){number=parseInt(char(),10);if(ipv4Piece===null)ipv4Piece=number;else if(ipv4Piece==0)return;else ipv4Piece=ipv4Piece*10+number;if(ipv4Piece>255)return;pointer++}address[pieceIndex]=address[pieceIndex]*256+ipv4Piece;numbersSeen++;if(numbersSeen==2||numbersSeen==4)pieceIndex++}if(numbersSeen!=4)return;break}else if(char()==":"){pointer++;if(!char())return}else if(char())return;address[pieceIndex++]=value}if(compress!==null){swaps=pieceIndex-compress;pieceIndex=7;while(pieceIndex!=0&&swaps>0){swap=address[pieceIndex];address[pieceIndex--]=address[compress+swaps-1];address[compress+--swaps]=swap}}else if(pieceIndex!=8)return;return address};var findLongestZeroSequence=function(ipv6){var maxIndex=null;var maxLength=1;var currStart=null;var currLength=0;var index=0;for(;index<8;index++){if(ipv6[index]!==0){if(currLength>maxLength){maxIndex=currStart;maxLength=currLength}currStart=null;currLength=0}else{if(currStart===null)currStart=index;++currLength}}if(currLength>maxLength){maxIndex=currStart;maxLength=currLength}return maxIndex};var serializeHost=function(host){var result,index,compress,ignore0;if(typeof host=="number"){result=[];for(index=0;index<4;index++){result.unshift(host%256);host=floor(host/256)}return result.join(".")}else if(typeof host=="object"){result="";compress=findLongestZeroSequence(host);for(index=0;index<8;index++){if(ignore0&&host[index]===0)continue;if(ignore0)ignore0=false;if(compress===index){result+=index?":":"::";ignore0=true}else{result+=host[index].toString(16);if(index<7)result+=":"}}return"["+result+"]"}return host};var C0ControlPercentEncodeSet={};var fragmentPercentEncodeSet=assign({},C0ControlPercentEncodeSet,{" ":1,'"':1,"<":1,">":1,"`":1});var pathPercentEncodeSet=assign({},fragmentPercentEncodeSet,{"#":1,"?":1,"{":1,"}":1});var userinfoPercentEncodeSet=assign({},pathPercentEncodeSet,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1});var percentEncode=function(char,set){var code=codeAt(char,0);return code>32&&code<127&&!has(set,char)?char:encodeURIComponent(char)};var specialSchemes={ftp:21,file:null,http:80,https:443,ws:80,wss:443};var isSpecial=function(url){return has(specialSchemes,url.scheme)};var includesCredentials=function(url){return url.username!=""||url.password!=""};var cannotHaveUsernamePasswordPort=function(url){return!url.host||url.cannotBeABaseURL||url.scheme=="file"};var isWindowsDriveLetter=function(string,normalized){var second;return string.length==2&&ALPHA.test(string.charAt(0))&&((second=string.charAt(1))==":"||!normalized&&second=="|")};var startsWithWindowsDriveLetter=function(string){var third;return string.length>1&&isWindowsDriveLetter(string.slice(0,2))&&(string.length==2||(third=string.charAt(2))==="/"||third==="\\"||third==="?"||third==="#")};var shortenURLsPath=function(url){var path=url.path;var pathSize=path.length;if(pathSize&&(url.scheme!="file"||pathSize!=1||!isWindowsDriveLetter(path[0],true))){path.pop()}};var isSingleDot=function(segment){return segment==="."||segment.toLowerCase()==="%2e"};var isDoubleDot=function(segment){segment=segment.toLowerCase();return segment===".."||segment==="%2e."||segment===".%2e"||segment==="%2e%2e"};var SCHEME_START={};var SCHEME={};var NO_SCHEME={};var SPECIAL_RELATIVE_OR_AUTHORITY={};var PATH_OR_AUTHORITY={};var RELATIVE={};var RELATIVE_SLASH={};var SPECIAL_AUTHORITY_SLASHES={};var SPECIAL_AUTHORITY_IGNORE_SLASHES={};var AUTHORITY={};var HOST={};var HOSTNAME={};var PORT={};var FILE={};var FILE_SLASH={};var FILE_HOST={};var PATH_START={};var PATH={};var CANNOT_BE_A_BASE_URL_PATH={};var QUERY={};var FRAGMENT={};var parseURL=function(url,input,stateOverride,base){var state=stateOverride||SCHEME_START;var pointer=0;var buffer="";var seenAt=false;var seenBracket=false;var seenPasswordToken=false;var codePoints,char,bufferCodePoints,failure;if(!stateOverride){url.scheme="";url.username="";url.password="";url.host=null;url.port=null;url.path=[];url.query=null;url.fragment=null;url.cannotBeABaseURL=false;input=input.replace(LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE,"")}input=input.replace(TAB_AND_NEW_LINE,"");codePoints=arrayFrom(input);while(pointer<=codePoints.length){char=codePoints[pointer];switch(state){case SCHEME_START:if(char&&ALPHA.test(char)){buffer+=char.toLowerCase();state=SCHEME}else if(!stateOverride){state=NO_SCHEME;continue}else return INVALID_SCHEME;break;case SCHEME:if(char&&(ALPHANUMERIC.test(char)||char=="+"||char=="-"||char==".")){buffer+=char.toLowerCase()}else if(char==":"){if(stateOverride&&(isSpecial(url)!=has(specialSchemes,buffer)||buffer=="file"&&(includesCredentials(url)||url.port!==null)||url.scheme=="file"&&!url.host))return;url.scheme=buffer;if(stateOverride){if(isSpecial(url)&&specialSchemes[url.scheme]==url.port)url.port=null;return}buffer="";if(url.scheme=="file"){state=FILE}else if(isSpecial(url)&&base&&base.scheme==url.scheme){state=SPECIAL_RELATIVE_OR_AUTHORITY}else if(isSpecial(url)){state=SPECIAL_AUTHORITY_SLASHES}else if(codePoints[pointer+1]=="/"){state=PATH_OR_AUTHORITY;pointer++}else{url.cannotBeABaseURL=true;url.path.push("");state=CANNOT_BE_A_BASE_URL_PATH}}else if(!stateOverride){buffer="";state=NO_SCHEME;pointer=0;continue}else return INVALID_SCHEME;break;case NO_SCHEME:if(!base||base.cannotBeABaseURL&&char!="#")return INVALID_SCHEME;if(base.cannotBeABaseURL&&char=="#"){url.scheme=base.scheme;url.path=base.path.slice();url.query=base.query;url.fragment="";url.cannotBeABaseURL=true;state=FRAGMENT;break}state=base.scheme=="file"?FILE:RELATIVE;continue;case SPECIAL_RELATIVE_OR_AUTHORITY:if(char=="/"&&codePoints[pointer+1]=="/"){state=SPECIAL_AUTHORITY_IGNORE_SLASHES;pointer++}else{state=RELATIVE;continue}break;case PATH_OR_AUTHORITY:if(char=="/"){state=AUTHORITY;break}else{state=PATH;continue}case RELATIVE:url.scheme=base.scheme;if(char==EOF){url.username=base.username;url.password=base.password;url.host=base.host;url.port=base.port;url.path=base.path.slice();url.query=base.query}else if(char=="/"||char=="\\"&&isSpecial(url)){state=RELATIVE_SLASH}else if(char=="?"){url.username=base.username;url.password=base.password;url.host=base.host;url.port=base.port;url.path=base.path.slice();url.query="";state=QUERY}else if(char=="#"){url.username=base.username;url.password=base.password;url.host=base.host;url.port=base.port;url.path=base.path.slice();url.query=base.query;url.fragment="";state=FRAGMENT}else{url.username=base.username;url.password=base.password;url.host=base.host;url.port=base.port;url.path=base.path.slice();url.path.pop();state=PATH;continue}break;case RELATIVE_SLASH:if(isSpecial(url)&&(char=="/"||char=="\\")){state=SPECIAL_AUTHORITY_IGNORE_SLASHES}else if(char=="/"){state=AUTHORITY}else{url.username=base.username;url.password=base.password;url.host=base.host;url.port=base.port;state=PATH;continue}break;case SPECIAL_AUTHORITY_SLASHES:state=SPECIAL_AUTHORITY_IGNORE_SLASHES;if(char!="/"||buffer.charAt(pointer+1)!="/")continue;pointer++;break;case SPECIAL_AUTHORITY_IGNORE_SLASHES:if(char!="/"&&char!="\\"){state=AUTHORITY;continue}break;case AUTHORITY:if(char=="@"){if(seenAt)buffer="%40"+buffer;seenAt=true;bufferCodePoints=arrayFrom(buffer);for(var i=0;i<bufferCodePoints.length;i++){var codePoint=bufferCodePoints[i];if(codePoint==":"&&!seenPasswordToken){seenPasswordToken=true;continue}var encodedCodePoints=percentEncode(codePoint,userinfoPercentEncodeSet);if(seenPasswordToken)url.password+=encodedCodePoints;else url.username+=encodedCodePoints}buffer=""}else if(char==EOF||char=="/"||char=="?"||char=="#"||char=="\\"&&isSpecial(url)){if(seenAt&&buffer=="")return INVALID_AUTHORITY;pointer-=arrayFrom(buffer).length+1;buffer="";state=HOST}else buffer+=char;break;case HOST:case HOSTNAME:if(stateOverride&&url.scheme=="file"){state=FILE_HOST;continue}else if(char==":"&&!seenBracket){if(buffer=="")return INVALID_HOST;failure=parseHost(url,buffer);if(failure)return failure;buffer="";state=PORT;if(stateOverride==HOSTNAME)return}else if(char==EOF||char=="/"||char=="?"||char=="#"||char=="\\"&&isSpecial(url)){if(isSpecial(url)&&buffer=="")return INVALID_HOST;if(stateOverride&&buffer==""&&(includesCredentials(url)||url.port!==null))return;failure=parseHost(url,buffer);if(failure)return failure;buffer="";state=PATH_START;if(stateOverride)return;continue}else{if(char=="[")seenBracket=true;else if(char=="]")seenBracket=false;buffer+=char}break;case PORT:if(DIGIT.test(char)){buffer+=char}else if(char==EOF||char=="/"||char=="?"||char=="#"||char=="\\"&&isSpecial(url)||stateOverride){if(buffer!=""){var port=parseInt(buffer,10);if(port>65535)return INVALID_PORT;url.port=isSpecial(url)&&port===specialSchemes[url.scheme]?null:port;buffer=""}if(stateOverride)return;state=PATH_START;continue}else return INVALID_PORT;break;case FILE:url.scheme="file";if(char=="/"||char=="\\")state=FILE_SLASH;else if(base&&base.scheme=="file"){if(char==EOF){url.host=base.host;url.path=base.path.slice();url.query=base.query}else if(char=="?"){url.host=base.host;url.path=base.path.slice();url.query="";state=QUERY}else if(char=="#"){url.host=base.host;url.path=base.path.slice();url.query=base.query;url.fragment="";state=FRAGMENT}else{if(!startsWithWindowsDriveLetter(codePoints.slice(pointer).join(""))){url.host=base.host;url.path=base.path.slice();shortenURLsPath(url)}state=PATH;continue}}else{state=PATH;continue}break;case FILE_SLASH:if(char=="/"||char=="\\"){state=FILE_HOST;break}if(base&&base.scheme=="file"&&!startsWithWindowsDriveLetter(codePoints.slice(pointer).join(""))){if(isWindowsDriveLetter(base.path[0],true))url.path.push(base.path[0]);else url.host=base.host}state=PATH;continue;case FILE_HOST:if(char==EOF||char=="/"||char=="\\"||char=="?"||char=="#"){if(!stateOverride&&isWindowsDriveLetter(buffer)){state=PATH}else if(buffer==""){url.host="";if(stateOverride)return;state=PATH_START}else{failure=parseHost(url,buffer);if(failure)return failure;if(url.host=="localhost")url.host="";if(stateOverride)return;buffer="";state=PATH_START}continue}else buffer+=char;break;case PATH_START:if(isSpecial(url)){state=PATH;if(char!="/"&&char!="\\")continue}else if(!stateOverride&&char=="?"){url.query="";state=QUERY}else if(!stateOverride&&char=="#"){url.fragment="";state=FRAGMENT}else if(char!=EOF){state=PATH;if(char!="/")continue}break;case PATH:if(char==EOF||char=="/"||char=="\\"&&isSpecial(url)||!stateOverride&&(char=="?"||char=="#")){if(isDoubleDot(buffer)){shortenURLsPath(url);if(char!="/"&&!(char=="\\"&&isSpecial(url))){url.path.push("")}}else if(isSingleDot(buffer)){if(char!="/"&&!(char=="\\"&&isSpecial(url))){url.path.push("")}}else{if(url.scheme=="file"&&!url.path.length&&isWindowsDriveLetter(buffer)){if(url.host)url.host="";buffer=buffer.charAt(0)+":"}url.path.push(buffer)}buffer="";if(url.scheme=="file"&&(char==EOF||char=="?"||char=="#")){while(url.path.length>1&&url.path[0]===""){url.path.shift()}}if(char=="?"){url.query="";state=QUERY}else if(char=="#"){url.fragment="";state=FRAGMENT}}else{buffer+=percentEncode(char,pathPercentEncodeSet)}break;case CANNOT_BE_A_BASE_URL_PATH:if(char=="?"){url.query="";state=QUERY}else if(char=="#"){url.fragment="";state=FRAGMENT}else if(char!=EOF){url.path[0]+=percentEncode(char,C0ControlPercentEncodeSet)}break;case QUERY:if(!stateOverride&&char=="#"){url.fragment="";state=FRAGMENT}else if(char!=EOF){if(char=="'"&&isSpecial(url))url.query+="%27";else if(char=="#")url.query+="%23";else url.query+=percentEncode(char,C0ControlPercentEncodeSet)}break;case FRAGMENT:if(char!=EOF)url.fragment+=percentEncode(char,fragmentPercentEncodeSet);break}pointer++}};var URLConstructor=function URL(url){var that=anInstance(this,URLConstructor,"URL");var base=arguments.length>1?arguments[1]:undefined;var urlString=String(url);var state=setInternalState(that,{type:"URL"});var baseState,failure;if(base!==undefined){if(base instanceof URLConstructor)baseState=getInternalURLState(base);else{failure=parseURL(baseState={},String(base));if(failure)throw TypeError(failure)}}failure=parseURL(state,urlString,null,baseState);if(failure)throw TypeError(failure);var searchParams=state.searchParams=new URLSearchParams;var searchParamsState=getInternalSearchParamsState(searchParams);searchParamsState.updateSearchParams(state.query);searchParamsState.updateURL=function(){state.query=String(searchParams)||null};if(!DESCRIPTORS){that.href=serializeURL.call(that);that.origin=getOrigin.call(that);that.protocol=getProtocol.call(that);that.username=getUsername.call(that);that.password=getPassword.call(that);that.host=getHost.call(that);that.hostname=getHostname.call(that);that.port=getPort.call(that);that.pathname=getPathname.call(that);that.search=getSearch.call(that);that.searchParams=getSearchParams.call(that);that.hash=getHash.call(that)}};var URLPrototype=URLConstructor.prototype;var serializeURL=function(){var url=getInternalURLState(this);var scheme=url.scheme;var username=url.username;var password=url.password;var host=url.host;var port=url.port;var path=url.path;var query=url.query;var fragment=url.fragment;var output=scheme+":";if(host!==null){output+="//";if(includesCredentials(url)){output+=username+(password?":"+password:"")+"@"}output+=serializeHost(host);if(port!==null)output+=":"+port}else if(scheme=="file")output+="//";output+=url.cannotBeABaseURL?path[0]:path.length?"/"+path.join("/"):"";if(query!==null)output+="?"+query;if(fragment!==null)output+="#"+fragment;return output};var getOrigin=function(){var url=getInternalURLState(this);var scheme=url.scheme;var port=url.port;if(scheme=="blob")try{return new URL(scheme.path[0]).origin}catch(error){return"null"}if(scheme=="file"||!isSpecial(url))return"null";return scheme+"://"+serializeHost(url.host)+(port!==null?":"+port:"")};var getProtocol=function(){return getInternalURLState(this).scheme+":"};var getUsername=function(){return getInternalURLState(this).username};var getPassword=function(){return getInternalURLState(this).password};var getHost=function(){var url=getInternalURLState(this);var host=url.host;var port=url.port;return host===null?"":port===null?serializeHost(host):serializeHost(host)+":"+port};var getHostname=function(){var host=getInternalURLState(this).host;return host===null?"":serializeHost(host)};var getPort=function(){var port=getInternalURLState(this).port;return port===null?"":String(port)};var getPathname=function(){var url=getInternalURLState(this);var path=url.path;return url.cannotBeABaseURL?path[0]:path.length?"/"+path.join("/"):""};var getSearch=function(){var query=getInternalURLState(this).query;return query?"?"+query:""};var getSearchParams=function(){return getInternalURLState(this).searchParams};var getHash=function(){var fragment=getInternalURLState(this).fragment;return fragment?"#"+fragment:""};var accessorDescriptor=function(getter,setter){return{get:getter,set:setter,configurable:true,enumerable:true}};if(DESCRIPTORS){defineProperties(URLPrototype,{href:accessorDescriptor(serializeURL,function(href){var url=getInternalURLState(this);var urlString=String(href);var failure=parseURL(url,urlString);if(failure)throw TypeError(failure);getInternalSearchParamsState(url.searchParams).updateSearchParams(url.query)}),origin:accessorDescriptor(getOrigin),protocol:accessorDescriptor(getProtocol,function(protocol){var url=getInternalURLState(this);parseURL(url,String(protocol)+":",SCHEME_START)}),username:accessorDescriptor(getUsername,function(username){var url=getInternalURLState(this);var codePoints=arrayFrom(String(username));if(cannotHaveUsernamePasswordPort(url))return;url.username="";for(var i=0;i<codePoints.length;i++){url.username+=percentEncode(codePoints[i],userinfoPercentEncodeSet)}}),password:accessorDescriptor(getPassword,function(password){var url=getInternalURLState(this);var codePoints=arrayFrom(String(password));if(cannotHaveUsernamePasswordPort(url))return;url.password="";for(var i=0;i<codePoints.length;i++){url.password+=percentEncode(codePoints[i],userinfoPercentEncodeSet)}}),host:accessorDescriptor(getHost,function(host){var url=getInternalURLState(this);if(url.cannotBeABaseURL)return;parseURL(url,String(host),HOST)}),hostname:accessorDescriptor(getHostname,function(hostname){var url=getInternalURLState(this);if(url.cannotBeABaseURL)return;parseURL(url,String(hostname),HOSTNAME)}),port:accessorDescriptor(getPort,function(port){var url=getInternalURLState(this);if(cannotHaveUsernamePasswordPort(url))return;port=String(port);if(port=="")url.port=null;else parseURL(url,port,PORT)}),pathname:accessorDescriptor(getPathname,function(pathname){var url=getInternalURLState(this);if(url.cannotBeABaseURL)return;url.path=[];parseURL(url,pathname+"",PATH_START)}),search:accessorDescriptor(getSearch,function(search){var url=getInternalURLState(this);search=String(search);if(search==""){url.query=null}else{if("?"==search.charAt(0))search=search.slice(1);url.query="";parseURL(url,search,QUERY)}getInternalSearchParamsState(url.searchParams).updateSearchParams(url.query)}),searchParams:accessorDescriptor(getSearchParams),hash:accessorDescriptor(getHash,function(hash){var url=getInternalURLState(this);hash=String(hash);if(hash==""){url.fragment=null;return}if("#"==hash.charAt(0))hash=hash.slice(1);url.fragment="";parseURL(url,hash,FRAGMENT)})})}redefine(URLPrototype,"toJSON",function toJSON(){return serializeURL.call(this)},{enumerable:true});redefine(URLPrototype,"toString",function toString(){return serializeURL.call(this)},{enumerable:true});if(NativeURL){var nativeCreateObjectURL=NativeURL.createObjectURL;var nativeRevokeObjectURL=NativeURL.revokeObjectURL;if(nativeCreateObjectURL)redefine(URLConstructor,"createObjectURL",function createObjectURL(blob){return nativeCreateObjectURL.apply(NativeURL,arguments)});if(nativeRevokeObjectURL)redefine(URLConstructor,"revokeObjectURL",function revokeObjectURL(url){return nativeRevokeObjectURL.apply(NativeURL,arguments)})}setToStringTag(URLConstructor,"URL");$({global:true,forced:!USE_NATIVE_URL,sham:!DESCRIPTORS},{URL:URLConstructor})},{"../internals/an-instance":27,"../internals/array-from":35,"../internals/descriptors":61,"../internals/export":68,"../internals/global":77,"../internals/has":78,"../internals/internal-state":88,"../internals/native-url":102,"../internals/object-assign":107,"../internals/object-define-properties":109,"../internals/redefine":126,"../internals/set-to-string-tag":135,"../internals/string-multibyte":141,"../internals/string-punycode-to-ascii":144,"../modules/es.string.iterator":210,"../modules/web.url-search-params":257}],259:[function(_dereq_,module,exports){"use strict";module.exports=_dereq_("./").polyfill()},{"./":260}],260:[function(_dereq_,module,exports){(function(process,global){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.ES6Promise=factory()})(this,function(){"use strict";function objectOrFunction(x){var type=typeof x;return x!==null&&(type==="object"||type==="function")}function isFunction(x){return typeof x==="function"}var _isArray=void 0;if(Array.isArray){_isArray=Array.isArray}else{_isArray=function(x){return Object.prototype.toString.call(x)==="[object Array]"}}var isArray=_isArray;var len=0;var vertxNext=void 0;var customSchedulerFn=void 0;var asap=function asap(callback,arg){queue[len]=callback;queue[len+1]=arg;len+=2;if(len===2){if(customSchedulerFn){customSchedulerFn(flush)}else{scheduleFlush()}}};function setScheduler(scheduleFn){customSchedulerFn=scheduleFn}function setAsap(asapFn){asap=asapFn}var browserWindow=typeof window!=="undefined"?window:undefined;var browserGlobal=browserWindow||{};var BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver;var isNode=typeof self==="undefined"&&typeof process!=="undefined"&&{}.toString.call(process)==="[object process]";var isWorker=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function useNextTick(){return function(){return process.nextTick(flush)}}function useVertxTimer(){if(typeof vertxNext!=="undefined"){return function(){vertxNext(flush)}}return useSetTimeout()}function useMutationObserver(){var iterations=0;var observer=new BrowserMutationObserver(flush);var node=document.createTextNode("");observer.observe(node,{characterData:true});return function(){node.data=iterations=++iterations%2}}function useMessageChannel(){var channel=new MessageChannel;channel.port1.onmessage=flush;return function(){return channel.port2.postMessage(0)}}function useSetTimeout(){var globalSetTimeout=setTimeout;return function(){return globalSetTimeout(flush,1)}}var queue=new Array(1e3);function flush(){for(var i=0;i<len;i+=2){var callback=queue[i];var arg=queue[i+1];callback(arg);queue[i]=undefined;queue[i+1]=undefined}len=0}function attemptVertx(){try{var vertx=Function("return this")().require("vertx");vertxNext=vertx.runOnLoop||vertx.runOnContext;return useVertxTimer()}catch(e){return useSetTimeout()}}var scheduleFlush=void 0;if(isNode){scheduleFlush=useNextTick()}else if(BrowserMutationObserver){scheduleFlush=useMutationObserver()}else if(isWorker){scheduleFlush=useMessageChannel()}else if(browserWindow===undefined&&typeof _dereq_==="function"){scheduleFlush=attemptVertx()}else{scheduleFlush=useSetTimeout()}function then(onFulfillment,onRejection){var parent=this;var child=new this.constructor(noop);if(child[PROMISE_ID]===undefined){makePromise(child)}var _state=parent._state;if(_state){var callback=arguments[_state-1];asap(function(){return invokeCallback(_state,child,callback,parent._result)})}else{subscribe(parent,child,onFulfillment,onRejection)}return child}function resolve$1(object){var Constructor=this;if(object&&typeof object==="object"&&object.constructor===Constructor){return object}var promise=new Constructor(noop);resolve(promise,object);return promise}var PROMISE_ID=Math.random().toString(36).substring(2);function noop(){}var PENDING=void 0;var FULFILLED=1;var REJECTED=2;function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself")}function cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function tryThen(then$$1,value,fulfillmentHandler,rejectionHandler){try{then$$1.call(value,fulfillmentHandler,rejectionHandler)}catch(e){return e}}function handleForeignThenable(promise,thenable,then$$1){asap(function(promise){var sealed=false;var error=tryThen(then$$1,thenable,function(value){if(sealed){return}sealed=true;if(thenable!==value){resolve(promise,value)}else{fulfill(promise,value)}},function(reason){if(sealed){return}sealed=true;reject(promise,reason)},"Settle: "+(promise._label||" unknown promise"));if(!sealed&&error){sealed=true;reject(promise,error)}},promise)}function handleOwnThenable(promise,thenable){if(thenable._state===FULFILLED){fulfill(promise,thenable._result)}else if(thenable._state===REJECTED){reject(promise,thenable._result)}else{subscribe(thenable,undefined,function(value){return resolve(promise,value)},function(reason){return reject(promise,reason)})}}function handleMaybeThenable(promise,maybeThenable,then$$1){if(maybeThenable.constructor===promise.constructor&&then$$1===then&&maybeThenable.constructor.resolve===resolve$1){handleOwnThenable(promise,maybeThenable)}else{if(then$$1===undefined){fulfill(promise,maybeThenable)}else if(isFunction(then$$1)){handleForeignThenable(promise,maybeThenable,then$$1)}else{fulfill(promise,maybeThenable)}}}function resolve(promise,value){if(promise===value){reject(promise,selfFulfillment())}else if(objectOrFunction(value)){var then$$1=void 0;try{then$$1=value.then}catch(error){reject(promise,error);return}handleMaybeThenable(promise,value,then$$1)}else{fulfill(promise,value)}}function publishRejection(promise){if(promise._onerror){promise._onerror(promise._result)}publish(promise)}function fulfill(promise,value){if(promise._state!==PENDING){return}promise._result=value;promise._state=FULFILLED;if(promise._subscribers.length!==0){asap(publish,promise)}}function reject(promise,reason){if(promise._state!==PENDING){return}promise._state=REJECTED;promise._result=reason;asap(publishRejection,promise)}function subscribe(parent,child,onFulfillment,onRejection){var _subscribers=parent._subscribers;var length=_subscribers.length;parent._onerror=null;_subscribers[length]=child;_subscribers[length+FULFILLED]=onFulfillment;_subscribers[length+REJECTED]=onRejection;if(length===0&&parent._state){asap(publish,parent)}}function publish(promise){var subscribers=promise._subscribers;var settled=promise._state;if(subscribers.length===0){return}var child=void 0,callback=void 0,detail=promise._result;for(var i=0;i<subscribers.length;i+=3){child=subscribers[i];callback=subscribers[i+settled];if(child){invokeCallback(settled,child,callback,detail)}else{callback(detail)}}promise._subscribers.length=0}function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value=void 0,error=void 0,succeeded=true;if(hasCallback){try{value=callback(detail)}catch(e){succeeded=false;error=e}if(promise===value){reject(promise,cannotReturnOwn());return}}else{value=detail}if(promise._state!==PENDING){}else if(hasCallback&&succeeded){resolve(promise,value)}else if(succeeded===false){reject(promise,error)}else if(settled===FULFILLED){fulfill(promise,value)}else if(settled===REJECTED){reject(promise,value)}}function initializePromise(promise,resolver){try{resolver(function resolvePromise(value){resolve(promise,value)},function rejectPromise(reason){reject(promise,reason)})}catch(e){reject(promise,e)}}var id=0;function nextId(){return id++}function makePromise(promise){promise[PROMISE_ID]=id++;promise._state=undefined;promise._result=undefined;promise._subscribers=[]}function validationError(){return new Error("Array Methods must be provided an Array")}var Enumerator=function(){function Enumerator(Constructor,input){this._instanceConstructor=Constructor;this.promise=new Constructor(noop);if(!this.promise[PROMISE_ID]){makePromise(this.promise)}if(isArray(input)){this.length=input.length;this._remaining=input.length;this._result=new Array(this.length);if(this.length===0){fulfill(this.promise,this._result)}else{this.length=this.length||0;this._enumerate(input);if(this._remaining===0){fulfill(this.promise,this._result)}}}else{reject(this.promise,validationError())}}Enumerator.prototype._enumerate=function _enumerate(input){for(var i=0;this._state===PENDING&&i<input.length;i++){this._eachEntry(input[i],i)}};Enumerator.prototype._eachEntry=function _eachEntry(entry,i){var c=this._instanceConstructor;var resolve$$1=c.resolve;if(resolve$$1===resolve$1){var _then=void 0;var error=void 0;var didError=false;try{_then=entry.then}catch(e){didError=true;error=e}if(_then===then&&entry._state!==PENDING){this._settledAt(entry._state,i,entry._result)}else if(typeof _then!=="function"){this._remaining--;this._result[i]=entry}else if(c===Promise$1){var promise=new c(noop);if(didError){reject(promise,error)}else{handleMaybeThenable(promise,entry,_then)}this._willSettleAt(promise,i)}else{this._willSettleAt(new c(function(resolve$$1){return resolve$$1(entry)}),i)}}else{this._willSettleAt(resolve$$1(entry),i)}};Enumerator.prototype._settledAt=function _settledAt(state,i,value){var promise=this.promise;if(promise._state===PENDING){this._remaining--;if(state===REJECTED){reject(promise,value)}else{this._result[i]=value}}if(this._remaining===0){fulfill(promise,this._result)}};Enumerator.prototype._willSettleAt=function _willSettleAt(promise,i){var enumerator=this;subscribe(promise,undefined,function(value){return enumerator._settledAt(FULFILLED,i,value)},function(reason){return enumerator._settledAt(REJECTED,i,reason)})};return Enumerator}();function all(entries){return new Enumerator(this,entries).promise}function race(entries){var Constructor=this;if(!isArray(entries)){return new Constructor(function(_,reject){return reject(new TypeError("You must pass an array to race."))})}else{return new Constructor(function(resolve,reject){var length=entries.length;for(var i=0;i<length;i++){Constructor.resolve(entries[i]).then(resolve,reject)}})}}function reject$1(reason){var Constructor=this;var promise=new Constructor(noop);reject(promise,reason);return promise}function needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Promise$1=function(){function Promise(resolver){this[PROMISE_ID]=nextId();this._result=this._state=undefined;this._subscribers=[];if(noop!==resolver){typeof resolver!=="function"&&needsResolver();this instanceof Promise?initializePromise(this,resolver):needsNew()}}Promise.prototype.catch=function _catch(onRejection){return this.then(null,onRejection)};Promise.prototype.finally=function _finally(callback){var promise=this;var constructor=promise.constructor;if(isFunction(callback)){return promise.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){throw reason})})}return promise.then(callback,callback)};return Promise}();Promise$1.prototype.then=then;Promise$1.all=all;Promise$1.race=race;Promise$1.resolve=resolve$1;Promise$1.reject=reject$1;Promise$1._setScheduler=setScheduler;Promise$1._setAsap=setAsap;Promise$1._asap=asap;function polyfill(){var local=void 0;if(typeof global!=="undefined"){local=global}else if(typeof self!=="undefined"){local=self}else{try{local=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var P=local.Promise;if(P){var promiseToString=null;try{promiseToString=Object.prototype.toString.call(P.resolve())}catch(e){}if(promiseToString==="[object Promise]"&&!P.cast){return}}local.Promise=Promise$1}Promise$1.polyfill=polyfill;Promise$1.Promise=Promise$1;return Promise$1})}).call(this,_dereq_("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:273}],261:[function(_dereq_,module,exports){(function(global,factory){if(typeof define==="function"&&define.amd){define(["exports","module"],factory)}else if(typeof exports!=="undefined"&&typeof module!=="undefined"){factory(exports,module)}else{var mod={exports:{}};factory(mod.exports,mod);global.fetchJsonp=mod.exports}})(this,function(exports,module){"use strict";var defaultOptions={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function generateCallbackFunction(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function clearFunction(functionName){try{delete window[functionName]}catch(e){window[functionName]=undefined}}function removeScript(scriptId){var script=document.getElementById(scriptId);if(script){document.getElementsByTagName("head")[0].removeChild(script)}}function fetchJsonp(_url){var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];var url=_url;var timeout=options.timeout||defaultOptions.timeout;var jsonpCallback=options.jsonpCallback||defaultOptions.jsonpCallback;var timeoutId=undefined;return new Promise(function(resolve,reject){var callbackFunction=options.jsonpCallbackFunction||generateCallbackFunction();var scriptId=jsonpCallback+"_"+callbackFunction;window[callbackFunction]=function(response){resolve({ok:true,json:function json(){return Promise.resolve(response)}});if(timeoutId)clearTimeout(timeoutId);removeScript(scriptId);clearFunction(callbackFunction)};url+=url.indexOf("?")===-1?"?":"&";var jsonpScript=document.createElement("script");jsonpScript.setAttribute("src",""+url+jsonpCallback+"="+callbackFunction);if(options.charset){jsonpScript.setAttribute("charset",options.charset)}jsonpScript.id=scriptId;document.getElementsByTagName("head")[0].appendChild(jsonpScript);timeoutId=setTimeout(function(){reject(new Error("JSONP request to "+_url+" timed out"));clearFunction(callbackFunction);removeScript(scriptId);window[callbackFunction]=function(){clearFunction(callbackFunction)}},timeout);jsonpScript.onerror=function(){reject(new Error("JSONP request to "+_url+" failed"));clearFunction(callbackFunction);removeScript(scriptId);if(timeoutId)clearTimeout(timeoutId)}})}module.exports=fetchJsonp})},{}],262:[function(_dereq_,module,exports){var saveAs=saveAs||function(view){"use strict";if(typeof view==="undefined"||typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,click=function(node){var event=new MouseEvent("click");node.dispatchEvent(event)},is_safari=/constructor/i.test(view.HTMLElement)||view.safari,is_chrome_ios=/CriOS\/[\d]+/.test(navigator.userAgent),throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},force_saveable_type="application/octet-stream",arbitrary_revoke_timeout=1e3*40,revoke=function(file){var revoker=function(){if(typeof file==="string"){get_URL().revokeObjectURL(file)}else{file.remove()}};setTimeout(revoker,arbitrary_revoke_timeout)},dispatch=function(filesaver,event_types,event){event_types=[].concat(event_types);var i=event_types.length;while(i--){var listener=filesaver["on"+event_types[i]];if(typeof listener==="function"){try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}}},auto_bom=function(blob){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)){return new Blob([String.fromCharCode(65279),blob],{type:blob.type})}return blob},FileSaver=function(blob,name,no_auto_bom){if(!no_auto_bom){blob=auto_bom(blob)}var filesaver=this,type=blob.type,force=type===force_saveable_type,object_url,dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "))},fs_error=function(){if((is_chrome_ios||force&&is_safari)&&view.FileReader){var reader=new FileReader;reader.onloadend=function(){var url=is_chrome_ios?reader.result:reader.result.replace(/^data:[^;]*;/,"data:attachment/file;");var popup=view.open(url,"_blank");if(!popup)view.location.href=url;url=undefined;filesaver.readyState=filesaver.DONE;dispatch_all()};reader.readAsDataURL(blob);filesaver.readyState=filesaver.INIT;return}if(!object_url){object_url=get_URL().createObjectURL(blob)}if(force){view.location.href=object_url}else{var opened=view.open(object_url,"_blank");if(!opened){view.location.href=object_url}}filesaver.readyState=filesaver.DONE;dispatch_all();revoke(object_url)};filesaver.readyState=filesaver.INIT;if(can_use_save_link){object_url=get_URL().createObjectURL(blob);setTimeout(function(){save_link.href=object_url;save_link.download=name;click(save_link);dispatch_all();revoke(object_url);filesaver.readyState=filesaver.DONE});return}fs_error()},FS_proto=FileSaver.prototype,saveAs=function(blob,name,no_auto_bom){return new FileSaver(blob,name||blob.name||"download",no_auto_bom)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(blob,name,no_auto_bom){name=name||blob.name||"download";if(!no_auto_bom){blob=auto_bom(blob)}return navigator.msSaveOrOpenBlob(blob,name)}}FS_proto.abort=function(){};FS_proto.readyState=FS_proto.INIT=0;FS_proto.WRITING=1;FS_proto.DONE=2;FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null;return saveAs}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module.exports){module.exports.saveAs=saveAs}else if(typeof define!=="undefined"&&define!==null&&define.amd!==null){define("FileSaver.js",function(){return saveAs})}},{}],263:[function(_dereq_,module,exports){var __defProp=Object.defineProperty;var __markAsModule=target=>__defProp(target,"__esModule",{value:true});var __export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:true})};__markAsModule(exports);__export(exports,{GIFEncoder:()=>GIFEncoder,applyPalette:()=>applyPalette,default:()=>src_default,nearestColor:()=>nearestColor,nearestColorIndex:()=>nearestColorIndex,nearestColorIndexWithDistance:()=>nearestColorIndexWithDistance,prequantize:()=>prequantize,quantize:()=>quantize,snapColorsToPalette:()=>snapColorsToPalette});var constants_default={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function createStream(initialCapacity=256){let cursor=0;let contents=new Uint8Array(initialCapacity);return{get buffer(){return contents.buffer},reset(){cursor=0},bytesView(){return contents.subarray(0,cursor)},bytes(){return contents.slice(0,cursor)},writeByte(byte){expand(cursor+1);contents[cursor]=byte;cursor++},writeBytes(data,offset=0,byteLength=data.length){expand(cursor+byteLength);for(let i=0;i<byteLength;i++){contents[cursor++]=data[i+offset]}},writeBytesView(data,offset=0,byteLength=data.byteLength){expand(cursor+byteLength);contents.set(data.subarray(offset,offset+byteLength),cursor);cursor+=byteLength}};function expand(newCapacity){var prevCapacity=contents.length;if(prevCapacity>=newCapacity)return;var CAPACITY_DOUBLING_MAX=1024*1024;newCapacity=Math.max(newCapacity,prevCapacity*(prevCapacity<CAPACITY_DOUBLING_MAX?2:1.125)>>>0);if(prevCapacity!=0)newCapacity=Math.max(newCapacity,256);const oldContents=contents;contents=new Uint8Array(newCapacity);if(cursor>0)contents.set(oldContents.subarray(0,cursor),0)}}var BITS=12;var DEFAULT_HSIZE=5003;var MASKS=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function lzwEncode(width,height,pixels,colorDepth,outStream=createStream(512),accum=new Uint8Array(256),htab=new Int32Array(DEFAULT_HSIZE),codetab=new Int32Array(DEFAULT_HSIZE)){const hsize=htab.length;const initCodeSize=Math.max(2,colorDepth);accum.fill(0);codetab.fill(0);htab.fill(-1);let cur_accum=0;let cur_bits=0;const init_bits=initCodeSize+1;const g_init_bits=init_bits;let clear_flg=false;let n_bits=g_init_bits;let maxcode=(1<<n_bits)-1;const ClearCode=1<<init_bits-1;const EOFCode=ClearCode+1;let free_ent=ClearCode+2;let a_count=0;let ent=pixels[0];let hshift=0;for(let fcode=hsize;fcode<65536;fcode*=2){++hshift}hshift=8-hshift;outStream.writeByte(initCodeSize);output(ClearCode);const length=pixels.length;for(let idx=1;idx<length;idx++){next_block:{const c=pixels[idx];const fcode=(c<<BITS)+ent;let i=c<<hshift^ent;if(htab[i]===fcode){ent=codetab[i];break next_block}const disp=i===0?1:hsize-i;while(htab[i]>=0){i-=disp;if(i<0)i+=hsize;if(htab[i]===fcode){ent=codetab[i];break next_block}}output(ent);ent=c;if(free_ent<1<<BITS){codetab[i]=free_ent++;htab[i]=fcode}else{htab.fill(-1);free_ent=ClearCode+2;clear_flg=true;output(ClearCode)}}}output(ent);output(EOFCode);outStream.writeByte(0);return outStream.bytesView();function output(code){cur_accum&=MASKS[cur_bits];if(cur_bits>0)cur_accum|=code<<cur_bits;else cur_accum=code;cur_bits+=n_bits;while(cur_bits>=8){accum[a_count++]=cur_accum&255;if(a_count>=254){outStream.writeByte(a_count);outStream.writeBytesView(accum,0,a_count);a_count=0}cur_accum>>=8;cur_bits-=8}if(free_ent>maxcode||clear_flg){if(clear_flg){n_bits=g_init_bits;maxcode=(1<<n_bits)-1;clear_flg=false}else{++n_bits;maxcode=n_bits===BITS?1<<n_bits:(1<<n_bits)-1}}if(code==EOFCode){while(cur_bits>0){accum[a_count++]=cur_accum&255;if(a_count>=254){outStream.writeByte(a_count);outStream.writeBytesView(accum,0,a_count);a_count=0}cur_accum>>=8;cur_bits-=8}if(a_count>0){outStream.writeByte(a_count);outStream.writeBytesView(accum,0,a_count);a_count=0}}}}var lzwEncode_default=lzwEncode;function rgb888_to_rgb565(r,g,b){return r<<8&63488|g<<2&992|b>>3}function rgba8888_to_rgba4444(r,g,b,a){return r>>4|g&240|(b&240)<<4|(a&240)<<8}function rgb888_to_rgb444(r,g,b){return r>>4<<8|g&240|b>>4}function clamp(value,min,max){return value<min?min:value>max?max:value}function sqr(value){return value*value}function find_nn(bins,idx,hasAlpha){var nn=0;var err=1e100;const bin1=bins[idx];const n1=bin1.cnt;const wa=bin1.ac;const wr=bin1.rc;const wg=bin1.gc;const wb=bin1.bc;for(var i=bin1.fw;i!=0;i=bins[i].fw){const bin=bins[i];const n2=bin.cnt;const nerr2=n1*n2/(n1+n2);if(nerr2>=err)continue;var nerr=0;if(hasAlpha){nerr+=nerr2*sqr(bin.ac-wa);if(nerr>=err)continue}nerr+=nerr2*sqr(bin.rc-wr);if(nerr>=err)continue;nerr+=nerr2*sqr(bin.gc-wg);if(nerr>=err)continue;nerr+=nerr2*sqr(bin.bc-wb);if(nerr>=err)continue;err=nerr;nn=i}bin1.err=err;bin1.nn=nn}function create_bin(){return{ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0}}function create_bin_list(data,format){const bincount=format==="rgb444"?4096:65536;const bins=new Array(bincount);const size=data.length;if(format==="rgba4444"){for(let i=0;i<size;++i){const color=data[i];const a=color>>24&255;const b=color>>16&255;const g=color>>8&255;const r=color&255;const index=rgba8888_to_rgba4444(r,g,b,a);let bin=index in bins?bins[index]:bins[index]=create_bin();bin.rc+=r;bin.gc+=g;bin.bc+=b;bin.ac+=a;bin.cnt++}}else if(format==="rgb444"){for(let i=0;i<size;++i){const color=data[i];const b=color>>16&255;const g=color>>8&255;const r=color&255;const index=rgb888_to_rgb444(r,g,b);let bin=index in bins?bins[index]:bins[index]=create_bin();bin.rc+=r;bin.gc+=g;bin.bc+=b;bin.cnt++}}else{for(let i=0;i<size;++i){const color=data[i];const b=color>>16&255;const g=color>>8&255;const r=color&255;const index=rgb888_to_rgb565(r,g,b);let bin=index in bins?bins[index]:bins[index]=create_bin();bin.rc+=r;bin.gc+=g;bin.bc+=b;bin.cnt++}}return bins}function quantize(rgba,maxColors,opts={}){const{format="rgb565",clearAlpha=true,clearAlphaColor=0,clearAlphaThreshold=0,oneBitAlpha=false}=opts;if(!rgba||!rgba.buffer){throw new Error("quantize() expected RGBA Uint8Array data")}if(!(rgba instanceof Uint8Array)&&!(rgba instanceof Uint8ClampedArray)){throw new Error("quantize() expected RGBA Uint8Array data")}const data=new Uint32Array(rgba.buffer);let useSqrt=opts.useSqrt!==false;const hasAlpha=format==="rgba4444";const bins=create_bin_list(data,format);const bincount=bins.length;const bincountMinusOne=bincount-1;const heap=new Uint32Array(bincount+1);var maxbins=0;for(var i=0;i<bincount;++i){const bin=bins[i];if(bin!=null){var d=1/bin.cnt;if(hasAlpha)bin.ac*=d;bin.rc*=d;bin.gc*=d;bin.bc*=d;bins[maxbins++]=bin}}if(sqr(maxColors)/maxbins<.022){useSqrt=false}var i=0;for(;i<maxbins-1;++i){bins[i].fw=i+1;bins[i+1].bk=i;if(useSqrt)bins[i].cnt=Math.sqrt(bins[i].cnt)}if(useSqrt)bins[i].cnt=Math.sqrt(bins[i].cnt);var h,l,l2;for(i=0;i<maxbins;++i){find_nn(bins,i,false);var err=bins[i].err;for(l=++heap[0];l>1;l=l2){l2=l>>1;if(bins[h=heap[l2]].err<=err)break;heap[l]=h}heap[l]=i}var extbins=maxbins-maxColors;for(i=0;i<extbins;){var tb;for(;;){var b1=heap[1];tb=bins[b1];if(tb.tm>=tb.mtm&&bins[tb.nn].mtm<=tb.tm)break;if(tb.mtm==bincountMinusOne)b1=heap[1]=heap[heap[0]--];else{find_nn(bins,b1,false);tb.tm=i}var err=bins[b1].err;for(l=1;(l2=l+l)<=heap[0];l=l2){if(l2<heap[0]&&bins[heap[l2]].err>bins[heap[l2+1]].err)l2++;if(err<=bins[h=heap[l2]].err)break;heap[l]=h}heap[l]=b1}var nb=bins[tb.nn];var n1=tb.cnt;var n2=nb.cnt;var d=1/(n1+n2);if(hasAlpha)tb.ac=d*(n1*tb.ac+n2*nb.ac);tb.rc=d*(n1*tb.rc+n2*nb.rc);tb.gc=d*(n1*tb.gc+n2*nb.gc);tb.bc=d*(n1*tb.bc+n2*nb.bc);tb.cnt+=nb.cnt;tb.mtm=++i;bins[nb.bk].fw=nb.fw;bins[nb.fw].bk=nb.bk;nb.mtm=bincountMinusOne}let palette=[];var k=0;for(i=0;;++k){let r=clamp(Math.round(bins[i].rc),0,255);let g=clamp(Math.round(bins[i].gc),0,255);let b=clamp(Math.round(bins[i].bc),0,255);let a=255;if(hasAlpha){a=clamp(Math.round(bins[i].ac),0,255);if(oneBitAlpha){const threshold=typeof oneBitAlpha==="number"?oneBitAlpha:127;a=a<=threshold?0:255}if(clearAlpha&&a<=clearAlphaThreshold){r=g=b=clearAlphaColor;a=0}}const color=hasAlpha?[r,g,b,a]:[r,g,b];const exists=existsInPalette(palette,color);if(!exists)palette.push(color);if((i=bins[i].fw)==0)break}return palette}function existsInPalette(palette,color){for(let i=0;i<palette.length;i++){const p=palette[i];let matchesRGB=p[0]===color[0]&&p[1]===color[1]&&p[2]===color[2];let matchesAlpha=p.length>=4&&color.length>=4?p[3]===color[3]:true;if(matchesRGB&&matchesAlpha)return true}return false}function euclideanDistanceSquared(a,b){var sum=0;var n;for(n=0;n<a.length;n++){const dx=a[n]-b[n];sum+=dx*dx}return sum}function roundStep(byte,step){return step>1?Math.round(byte/step)*step:byte}function prequantize(rgba,{roundRGB=5,roundAlpha=10,oneBitAlpha=null}={}){const data=new Uint32Array(rgba.buffer);for(let i=0;i<data.length;i++){const color=data[i];let a=color>>24&255;let b=color>>16&255;let g=color>>8&255;let r=color&255;a=roundStep(a,roundAlpha);if(oneBitAlpha){const threshold=typeof oneBitAlpha==="number"?oneBitAlpha:127;a=a<=threshold?0:255}r=roundStep(r,roundRGB);g=roundStep(g,roundRGB);b=roundStep(b,roundRGB);data[i]=a<<24|b<<16|g<<8|r<<0}}function applyPalette(rgba,palette,format="rgb565"){if(!rgba||!rgba.buffer){throw new Error("quantize() expected RGBA Uint8Array data")}if(!(rgba instanceof Uint8Array)&&!(rgba instanceof Uint8ClampedArray)){throw new Error("quantize() expected RGBA Uint8Array data")}if(palette.length>256){throw new Error("applyPalette() only works with 256 colors or less")}const data=new Uint32Array(rgba.buffer);const length=data.length;const bincount=format==="rgb444"?4096:65536;const index=new Uint8Array(length);const cache=new Array(bincount);const hasAlpha=format==="rgba4444";if(format==="rgba4444"){for(let i=0;i<length;i++){const color=data[i];const a=color>>24&255;const b=color>>16&255;const g=color>>8&255;const r=color&255;const key=rgba8888_to_rgba4444(r,g,b,a);const idx=key in cache?cache[key]:cache[key]=nearestColorIndexRGBA(r,g,b,a,palette);index[i]=idx}}else{const rgb888_to_key=format==="rgb444"?rgb888_to_rgb444:rgb888_to_rgb565;for(let i=0;i<length;i++){const color=data[i];const b=color>>16&255;const g=color>>8&255;const r=color&255;const key=rgb888_to_key(r,g,b);const idx=key in cache?cache[key]:cache[key]=nearestColorIndexRGB(r,g,b,palette);index[i]=idx}}return index}function nearestColorIndexRGBA(r,g,b,a,palette){let k=0;let mindist=1e100;for(let i=0;i<palette.length;i++){const px2=palette[i];const a2=px2[3];let curdist=sqr2(a2-a);if(curdist>mindist)continue;const r2=px2[0];curdist+=sqr2(r2-r);if(curdist>mindist)continue;const g2=px2[1];curdist+=sqr2(g2-g);if(curdist>mindist)continue;const b2=px2[2];curdist+=sqr2(b2-b);if(curdist>mindist)continue;mindist=curdist;k=i}return k}function nearestColorIndexRGB(r,g,b,palette){let k=0;let mindist=1e100;for(let i=0;i<palette.length;i++){const px2=palette[i];const r2=px2[0];let curdist=sqr2(r2-r);if(curdist>mindist)continue;const g2=px2[1];curdist+=sqr2(g2-g);if(curdist>mindist)continue;const b2=px2[2];curdist+=sqr2(b2-b);if(curdist>mindist)continue;mindist=curdist;k=i}return k}function snapColorsToPalette(palette,knownColors,threshold=5){if(!palette.length||!knownColors.length)return;const paletteRGB=palette.map(p=>p.slice(0,3));const thresholdSq=threshold*threshold;const dim=palette[0].length;for(let i=0;i<knownColors.length;i++){let color=knownColors[i];if(color.length<dim){color=[color[0],color[1],color[2],255]}else if(color.length>dim){color=color.slice(0,3)}else{color=color.slice()}const r=nearestColorIndexWithDistance(paletteRGB,color.slice(0,3),euclideanDistanceSquared);const idx=r[0];const distanceSq=r[1];if(distanceSq>0&&distanceSq<=thresholdSq){palette[idx]=color}}}function sqr2(a){return a*a}function nearestColorIndex(colors,pixel,distanceFn=euclideanDistanceSquared){let minDist=Infinity;let minDistIndex=-1;for(let j=0;j<colors.length;j++){const paletteColor=colors[j];const dist=distanceFn(pixel,paletteColor);if(dist<minDist){minDist=dist;minDistIndex=j}}return minDistIndex}function nearestColorIndexWithDistance(colors,pixel,distanceFn=euclideanDistanceSquared){let minDist=Infinity;let minDistIndex=-1;for(let j=0;j<colors.length;j++){const paletteColor=colors[j];const dist=distanceFn(pixel,paletteColor);if(dist<minDist){minDist=dist;minDistIndex=j}}return[minDistIndex,minDist]}function nearestColor(colors,pixel,distanceFn=euclideanDistanceSquared){return colors[nearestColorIndex(colors,pixel,distanceFn)]}function GIFEncoder(opt={}){const{initialCapacity=4096,auto=true}=opt;const stream=createStream(initialCapacity);const HSIZE=5003;const accum=new Uint8Array(256);const htab=new Int32Array(HSIZE);const codetab=new Int32Array(HSIZE);let hasInit=false;return{reset(){stream.reset();hasInit=false},finish(){stream.writeByte(constants_default.trailer)},bytes(){return stream.bytes()},bytesView(){return stream.bytesView()},get buffer(){return stream.buffer},get stream(){return stream},writeHeader:writeHeader,writeFrame(index,width,height,opts={}){const{transparent=false,transparentIndex=0,delay=0,palette=null,repeat=0,colorDepth=8,dispose=-1}=opts;let first=false;if(auto){if(!hasInit){first=true;writeHeader();hasInit=true}}else{first=Boolean(opts.first)}width=Math.max(0,Math.floor(width));height=Math.max(0,Math.floor(height));if(first){if(!palette){throw new Error("First frame must include a { palette } option")}encodeLogicalScreenDescriptor(stream,width,height,palette,colorDepth);encodeColorTable(stream,palette);if(repeat>=0){encodeNetscapeExt(stream,repeat)}}const delayTime=Math.round(delay/10);encodeGraphicControlExt(stream,dispose,delayTime,transparent,transparentIndex);const useLocalColorTable=Boolean(palette)&&!first;encodeImageDescriptor(stream,width,height,useLocalColorTable?palette:null);if(useLocalColorTable)encodeColorTable(stream,palette);encodePixels(stream,index,width,height,colorDepth,accum,htab,codetab)}};function writeHeader(){writeUTFBytes(stream,"GIF89a")}}function encodeGraphicControlExt(stream,dispose,delay,transparent,transparentIndex){stream.writeByte(33);stream.writeByte(249);stream.writeByte(4);if(transparentIndex<0){transparentIndex=0;transparent=false}var transp,disp;if(!transparent){transp=0;disp=0}else{transp=1;disp=2}if(dispose>=0){disp=dispose&7}disp<<=2;const userInput=0;stream.writeByte(0|disp|userInput|transp);writeUInt16(stream,delay);stream.writeByte(transparentIndex||0);stream.writeByte(0)}function encodeLogicalScreenDescriptor(stream,width,height,palette,colorDepth=8){const globalColorTableFlag=1;const sortFlag=0;const globalColorTableSize=colorTableSize(palette.length)-1;const fields=globalColorTableFlag<<7|colorDepth-1<<4|sortFlag<<3|globalColorTableSize;const backgroundColorIndex=0;const pixelAspectRatio=0;writeUInt16(stream,width);writeUInt16(stream,height);stream.writeBytes([fields,backgroundColorIndex,pixelAspectRatio])}function encodeNetscapeExt(stream,repeat){stream.writeByte(33);stream.writeByte(255);stream.writeByte(11);writeUTFBytes(stream,"NETSCAPE2.0");stream.writeByte(3);stream.writeByte(1);writeUInt16(stream,repeat);stream.writeByte(0)}function encodeColorTable(stream,palette){const colorTableLength=1<<colorTableSize(palette.length);for(let i=0;i<colorTableLength;i++){let color=[0,0,0];if(i<palette.length){color=palette[i]}stream.writeByte(color[0]);stream.writeByte(color[1]);stream.writeByte(color[2])}}function encodeImageDescriptor(stream,width,height,localPalette){stream.writeByte(44);writeUInt16(stream,0);writeUInt16(stream,0);writeUInt16(stream,width);writeUInt16(stream,height);if(localPalette){const interlace=0;const sorted=0;const palSize=colorTableSize(localPalette.length)-1;stream.writeByte(128|interlace|sorted|0|palSize)}else{stream.writeByte(0)}}function encodePixels(stream,index,width,height,colorDepth=8,accum,htab,codetab){lzwEncode_default(width,height,index,colorDepth,stream,accum,htab,codetab)}function writeUInt16(stream,short){stream.writeByte(short&255);stream.writeByte(short>>8&255)}function writeUTFBytes(stream,text){for(var i=0;i<text.length;i++){stream.writeByte(text.charCodeAt(i))}}function colorTableSize(length){return Math.max(Math.ceil(Math.log2(length)),1)}var src_default=GIFEncoder},{}],264:[function(_dereq_,module,exports){"use strict";function _interopDefault(ex){return ex&&typeof ex==="object"&&"default"in ex?ex["default"]:ex}var _classCallCheck=_interopDefault(_dereq_("@babel/runtime/helpers/classCallCheck"));var _createClass=_interopDefault(_dereq_("@babel/runtime/helpers/createClass"));var arr=[];var each=arr.forEach;var slice=arr.slice;function defaults(obj){each.call(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]===undefined)obj[prop]=source[prop]}}});return obj}var cookie={create:function create(name,value,minutes,domain){var expires;if(minutes){var date=new Date;date.setTime(date.getTime()+minutes*60*1e3);expires="; expires="+date.toGMTString()}else expires="";domain=domain?"domain="+domain+";":"";document.cookie=name+"="+value+expires+";"+domain+"path=/"},read:function read(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)===0)return c.substring(nameEQ.length,c.length)}return null},remove:function remove(name){this.create(name,"",-1)}};var cookie$1={name:"cookie",lookup:function lookup(options){var found;if(options.lookupCookie&&typeof document!=="undefined"){var c=cookie.read(options.lookupCookie);if(c)found=c}return found},cacheUserLanguage:function cacheUserLanguage(lng,options){if(options.lookupCookie&&typeof document!=="undefined"){cookie.create(options.lookupCookie,lng,options.cookieMinutes,options.cookieDomain)}}};var querystring={name:"querystring",lookup:function lookup(options){var found;if(typeof window!=="undefined"){var query=window.location.search.substring(1);var params=query.split("&");for(var i=0;i<params.length;i++){var pos=params[i].indexOf("=");if(pos>0){var key=params[i].substring(0,pos);if(key===options.lookupQuerystring){found=params[i].substring(pos+1)}}}}return found}};var hasLocalStorageSupport;try{hasLocalStorageSupport=window!=="undefined"&&window.localStorage!==null;var testKey="i18next.translate.boo";window.localStorage.setItem(testKey,"foo");window.localStorage.removeItem(testKey)}catch(e){hasLocalStorageSupport=false}var localStorage={name:"localStorage",lookup:function lookup(options){var found;if(options.lookupLocalStorage&&hasLocalStorageSupport){var lng=window.localStorage.getItem(options.lookupLocalStorage);if(lng)found=lng}return found},cacheUserLanguage:function cacheUserLanguage(lng,options){if(options.lookupLocalStorage&&hasLocalStorageSupport){window.localStorage.setItem(options.lookupLocalStorage,lng)}}};var navigator$1={name:"navigator",lookup:function lookup(options){var found=[];if(typeof navigator!=="undefined"){if(navigator.languages){for(var i=0;i<navigator.languages.length;i++){found.push(navigator.languages[i])}}if(navigator.userLanguage){found.push(navigator.userLanguage)}if(navigator.language){found.push(navigator.language)}}return found.length>0?found:undefined}};var htmlTag={name:"htmlTag",lookup:function lookup(options){var found;var htmlTag=options.htmlTag||(typeof document!=="undefined"?document.documentElement:null);if(htmlTag&&typeof htmlTag.getAttribute==="function"){found=htmlTag.getAttribute("lang")}return found}};var path={name:"path",lookup:function lookup(options){var found;if(typeof window!=="undefined"){var language=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(language instanceof Array){if(typeof options.lookupFromPathIndex==="number"){if(typeof language[options.lookupFromPathIndex]!=="string"){return undefined}found=language[options.lookupFromPathIndex].replace("/","")}else{found=language[0].replace("/","")}}}return found}};var subdomain={name:"subdomain",lookup:function lookup(options){var found;if(typeof window!=="undefined"){var language=window.location.href.match(/(?:http[s]*\:\/\/)*(.*?)\.(?=[^\/]*\..{2,5})/gi);if(language instanceof Array){if(typeof options.lookupFromSubdomainIndex==="number"){found=language[options.lookupFromSubdomainIndex].replace("http://","").replace("https://","").replace(".","")}else{found=language[0].replace("http://","").replace("https://","").replace(".","")}}}return found}};function getDefaults(){return{order:["querystring","cookie","localStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],checkWhitelist:true}}var Browser=function(){function Browser(services){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Browser);this.type="languageDetector";this.detectors={};this.init(services,options)}_createClass(Browser,[{key:"init",value:function init(services){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i18nOptions=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};this.services=services;this.options=defaults(options,this.options||{},getDefaults());if(this.options.lookupFromUrlIndex)this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex;this.i18nOptions=i18nOptions;this.addDetector(cookie$1);this.addDetector(querystring);this.addDetector(localStorage);this.addDetector(navigator$1);this.addDetector(htmlTag);this.addDetector(path);this.addDetector(subdomain)}},{key:"addDetector",value:function addDetector(detector){this.detectors[detector.name]=detector}},{key:"detect",value:function detect(detectionOrder){var _this=this;if(!detectionOrder)detectionOrder=this.options.order;var detected=[];detectionOrder.forEach(function(detectorName){if(_this.detectors[detectorName]){var lookup=_this.detectors[detectorName].lookup(_this.options);if(lookup&&typeof lookup==="string")lookup=[lookup];if(lookup)detected=detected.concat(lookup)}});var found;detected.forEach(function(lng){if(found)return;var cleanedLng=_this.services.languageUtils.formatLanguageCode(lng);if(!_this.options.checkWhitelist||_this.services.languageUtils.isWhitelisted(cleanedLng))found=cleanedLng});if(!found){var fallbacks=this.i18nOptions.fallbackLng;if(typeof fallbacks==="string")fallbacks=[fallbacks];if(!fallbacks)fallbacks=[];if(Object.prototype.toString.apply(fallbacks)==="[object Array]"){found=fallbacks[0]}else{found=fallbacks[0]||fallbacks["default"]&&fallbacks["default"][0]}}return found}},{key:"cacheUserLanguage",value:function cacheUserLanguage(lng,caches){var _this2=this;if(!caches)caches=this.options.caches;if(!caches)return;if(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(lng)>-1)return;caches.forEach(function(cacheName){if(_this2.detectors[cacheName])_this2.detectors[cacheName].cacheUserLanguage(lng,_this2.options)})}}]);return Browser}();Browser.type="languageDetector";module.exports=Browser},{"@babel/runtime/helpers/classCallCheck":265,"@babel/runtime/helpers/createClass":266}],265:[function(_dereq_,module,exports){arguments[4][5][0].apply(exports,arguments)},{dup:5}],266:[function(_dereq_,module,exports){arguments[4][6][0].apply(exports,arguments)},{dup:6}],267:[function(_dereq_,module,exports){"use strict";function _interopDefault(ex){return ex&&typeof ex==="object"&&"default"in ex?ex["default"]:ex}var _typeof=_interopDefault(_dereq_("@babel/runtime/helpers/typeof"));var _objectSpread=_interopDefault(_dereq_("@babel/runtime/helpers/objectSpread"));var _classCallCheck=_interopDefault(_dereq_("@babel/runtime/helpers/classCallCheck"));var _createClass=_interopDefault(_dereq_("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn=_interopDefault(_dereq_("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf=_interopDefault(_dereq_("@babel/runtime/helpers/getPrototypeOf"));var _assertThisInitialized=_interopDefault(_dereq_("@babel/runtime/helpers/assertThisInitialized"));var _inherits=_interopDefault(_dereq_("@babel/runtime/helpers/inherits"));var _toConsumableArray=_interopDefault(_dereq_("@babel/runtime/helpers/toConsumableArray"));var _slicedToArray=_interopDefault(_dereq_("@babel/runtime/helpers/slicedToArray"));var consoleLogger={type:"logger",log:function log(args){this.output("log",args)},warn:function warn(args){this.output("warn",args)},error:function error(args){this.output("error",args)},output:function output(type,args){var _console;if(console&&console[type])(_console=console)[type].apply(_console,_toConsumableArray(args))}};var Logger=function(){function Logger(concreteLogger){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Logger);this.init(concreteLogger,options)}_createClass(Logger,[{key:"init",value:function init(concreteLogger){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.prefix=options.prefix||"i18next:";this.logger=concreteLogger||consoleLogger;this.options=options;this.debug=options.debug}},{key:"setDebug",value:function setDebug(bool){this.debug=bool}},{key:"log",value:function log(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return this.forward(args,"log","",true)}},{key:"warn",value:function warn(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}return this.forward(args,"warn","",true)}},{key:"error",value:function error(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}return this.forward(args,"error","")}},{key:"deprecate",value:function deprecate(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}return this.forward(args,"warn","WARNING DEPRECATED: ",true)}},{key:"forward",value:function forward(args,lvl,prefix,debugOnly){if(debugOnly&&!this.debug)return null;if(typeof args[0]==="string")args[0]="".concat(prefix).concat(this.prefix," ").concat(args[0]);return this.logger[lvl](args)}},{key:"create",value:function create(moduleName){return new Logger(this.logger,_objectSpread({},{prefix:"".concat(this.prefix,":").concat(moduleName,":")},this.options))}}]);return Logger}();var baseLogger=new Logger;var EventEmitter=function(){function EventEmitter(){_classCallCheck(this,EventEmitter);this.observers={}}_createClass(EventEmitter,[{key:"on",value:function on(events,listener){var _this=this;events.split(" ").forEach(function(event){_this.observers[event]=_this.observers[event]||[];_this.observers[event].push(listener)});return this}},{key:"off",value:function off(event,listener){if(!this.observers[event])return;if(!listener){delete this.observers[event];return}this.observers[event]=this.observers[event].filter(function(l){return l!==listener})}},{key:"emit",value:function emit(event){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}if(this.observers[event]){var cloned=[].concat(this.observers[event]);cloned.forEach(function(observer){observer.apply(void 0,args)})}if(this.observers["*"]){var _cloned=[].concat(this.observers["*"]);_cloned.forEach(function(observer){observer.apply(observer,[event].concat(args))})}}}]);return EventEmitter}();function defer(){var res;var rej;var promise=new Promise(function(resolve,reject){res=resolve;rej=reject});promise.resolve=res;promise.reject=rej;return promise}function makeString(object){if(object==null)return"";return""+object}function copy(a,s,t){a.forEach(function(m){if(s[m])t[m]=s[m]})}function getLastOfPath(object,path,Empty){function cleanKey(key){return key&&key.indexOf("###")>-1?key.replace(/###/g,"."):key}function canNotTraverseDeeper(){return!object||typeof object==="string"}var stack=typeof path!=="string"?[].concat(path):path.split(".");while(stack.length>1){if(canNotTraverseDeeper())return{};var key=cleanKey(stack.shift());if(!object[key]&&Empty)object[key]=new Empty;object=object[key]}if(canNotTraverseDeeper())return{};return{obj:object,k:cleanKey(stack.shift())}}function setPath(object,path,newValue){var _getLastOfPath=getLastOfPath(object,path,Object),obj=_getLastOfPath.obj,k=_getLastOfPath.k;obj[k]=newValue}function pushPath(object,path,newValue,concat){var _getLastOfPath2=getLastOfPath(object,path,Object),obj=_getLastOfPath2.obj,k=_getLastOfPath2.k;obj[k]=obj[k]||[];if(concat)obj[k]=obj[k].concat(newValue);if(!concat)obj[k].push(newValue)}function getPath(object,path){var _getLastOfPath3=getLastOfPath(object,path),obj=_getLastOfPath3.obj,k=_getLastOfPath3.k;if(!obj)return undefined;return obj[k]}function getPathWithDefaults(data,defaultData,key){var value=getPath(data,key);if(value!==undefined){return value}return getPath(defaultData,key)}function deepExtend(target,source,overwrite){for(var prop in source){if(prop in target){if(typeof target[prop]==="string"||target[prop]instanceof String||typeof source[prop]==="string"||source[prop]instanceof String){if(overwrite)target[prop]=source[prop]}else{deepExtend(target[prop],source[prop],overwrite)}}else{target[prop]=source[prop]}}return target}function regexEscape(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escape(data){if(typeof data==="string"){return data.replace(/[&<>"'\/]/g,function(s){return _entityMap[s]})}return data}var ResourceStore=function(_EventEmitter){_inherits(ResourceStore,_EventEmitter);function ResourceStore(data){var _this;var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{ns:["translation"],defaultNS:"translation"};_classCallCheck(this,ResourceStore);_this=_possibleConstructorReturn(this,_getPrototypeOf(ResourceStore).call(this));EventEmitter.call(_assertThisInitialized(_this));_this.data=data||{};_this.options=options;if(_this.options.keySeparator===undefined){_this.options.keySeparator="."}return _this}_createClass(ResourceStore,[{key:"addNamespaces",value:function addNamespaces(ns){if(this.options.ns.indexOf(ns)<0){this.options.ns.push(ns)}}},{key:"removeNamespaces",value:function removeNamespaces(ns){var index=this.options.ns.indexOf(ns);if(index>-1){this.options.ns.splice(index,1)}}},{key:"getResource",value:function getResource(lng,ns,key){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var keySeparator=options.keySeparator!==undefined?options.keySeparator:this.options.keySeparator;var path=[lng,ns];if(key&&typeof key!=="string")path=path.concat(key);if(key&&typeof key==="string")path=path.concat(keySeparator?key.split(keySeparator):key);if(lng.indexOf(".")>-1){path=lng.split(".")}return getPath(this.data,path)}},{key:"addResource",value:function addResource(lng,ns,key,value){var options=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{silent:false};var keySeparator=this.options.keySeparator;if(keySeparator===undefined)keySeparator=".";var path=[lng,ns];if(key)path=path.concat(keySeparator?key.split(keySeparator):key);if(lng.indexOf(".")>-1){path=lng.split(".");value=ns;ns=path[1]}this.addNamespaces(ns);setPath(this.data,path,value);if(!options.silent)this.emit("added",lng,ns,key,value)}},{key:"addResources",value:function addResources(lng,ns,resources){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{silent:false};for(var m in resources){if(typeof resources[m]==="string"||Object.prototype.toString.apply(resources[m])==="[object Array]")this.addResource(lng,ns,m,resources[m],{silent:true})}if(!options.silent)this.emit("added",lng,ns,resources)}},{key:"addResourceBundle",value:function addResourceBundle(lng,ns,resources,deep,overwrite){var options=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{silent:false};var path=[lng,ns];if(lng.indexOf(".")>-1){path=lng.split(".");deep=resources;resources=ns;ns=path[1]}this.addNamespaces(ns);var pack=getPath(this.data,path)||{};if(deep){deepExtend(pack,resources,overwrite)}else{pack=_objectSpread({},pack,resources)}setPath(this.data,path,pack);if(!options.silent)this.emit("added",lng,ns,resources)}},{key:"removeResourceBundle",value:function removeResourceBundle(lng,ns){if(this.hasResourceBundle(lng,ns)){delete this.data[lng][ns]}this.removeNamespaces(ns);this.emit("removed",lng,ns)}},{key:"hasResourceBundle",value:function hasResourceBundle(lng,ns){return this.getResource(lng,ns)!==undefined}},{key:"getResourceBundle",value:function getResourceBundle(lng,ns){if(!ns)ns=this.options.defaultNS;if(this.options.compatibilityAPI==="v1")return _objectSpread({},{},this.getResource(lng,ns));return this.getResource(lng,ns)}},{key:"getDataByLanguage",value:function getDataByLanguage(lng){return this.data[lng]}},{key:"toJSON",value:function toJSON(){return this.data}}]);return ResourceStore}(EventEmitter);var postProcessor={processors:{},addPostProcessor:function addPostProcessor(module){this.processors[module.name]=module},handle:function handle(processors,value,key,options,translator){var _this=this;processors.forEach(function(processor){if(_this.processors[processor])value=_this.processors[processor].process(value,key,options,translator)});return value}};var checkedLoadedFor={};var Translator=function(_EventEmitter){_inherits(Translator,_EventEmitter);function Translator(services){var _this;var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Translator);_this=_possibleConstructorReturn(this,_getPrototypeOf(Translator).call(this));EventEmitter.call(_assertThisInitialized(_this));copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],services,_assertThisInitialized(_this));_this.options=options;if(_this.options.keySeparator===undefined){_this.options.keySeparator="."}_this.logger=baseLogger.create("translator");return _this}_createClass(Translator,[{key:"changeLanguage",value:function changeLanguage(lng){if(lng)this.language=lng}},{key:"exists",value:function exists(key){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{interpolation:{}};var resolved=this.resolve(key,options);return resolved&&resolved.res!==undefined}},{key:"extractFromKey",value:function extractFromKey(key,options){var nsSeparator=options.nsSeparator||this.options.nsSeparator;if(nsSeparator===undefined)nsSeparator=":";var keySeparator=options.keySeparator!==undefined?options.keySeparator:this.options.keySeparator;var namespaces=options.ns||this.options.defaultNS;if(nsSeparator&&key.indexOf(nsSeparator)>-1){var parts=key.split(nsSeparator);if(nsSeparator!==keySeparator||nsSeparator===keySeparator&&this.options.ns.indexOf(parts[0])>-1)namespaces=parts.shift();key=parts.join(keySeparator)}if(typeof namespaces==="string")namespaces=[namespaces];return{key:key,namespaces:namespaces}}},{key:"translate",value:function translate(keys,options){var _this2=this;if(_typeof(options)!=="object"&&this.options.overloadTranslationOptionHandler){options=this.options.overloadTranslationOptionHandler(arguments)}if(!options)options={};if(keys===undefined||keys===null)return"";if(!Array.isArray(keys))keys=[String(keys)];var keySeparator=options.keySeparator!==undefined?options.keySeparator:this.options.keySeparator;var _this$extractFromKey=this.extractFromKey(keys[keys.length-1],options),key=_this$extractFromKey.key,namespaces=_this$extractFromKey.namespaces;var namespace=namespaces[namespaces.length-1];var lng=options.lng||this.language;var appendNamespaceToCIMode=options.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(lng&&lng.toLowerCase()==="cimode"){if(appendNamespaceToCIMode){var nsSeparator=options.nsSeparator||this.options.nsSeparator;return namespace+nsSeparator+key}return key}var resolved=this.resolve(keys,options);var res=resolved&&resolved.res;var resUsedKey=resolved&&resolved.usedKey||key;var resExactUsedKey=resolved&&resolved.exactUsedKey||key;var resType=Object.prototype.toString.apply(res);var noObject=["[object Number]","[object Function]","[object RegExp]"];var joinArrays=options.joinArrays!==undefined?options.joinArrays:this.options.joinArrays;var handleAsObjectInI18nFormat=!this.i18nFormat||this.i18nFormat.handleAsObject;var handleAsObject=typeof res!=="string"&&typeof res!=="boolean"&&typeof res!=="number";if(handleAsObjectInI18nFormat&&res&&handleAsObject&&noObject.indexOf(resType)<0&&!(typeof joinArrays==="string"&&resType==="[object Array]")){if(!options.returnObjects&&!this.options.returnObjects){this.logger.warn("accessing an object - but returnObjects options is not enabled!");return this.options.returnedObjectHandler?this.options.returnedObjectHandler(resUsedKey,res,options):"key '".concat(key," (").concat(this.language,")' returned an object instead of string.")}if(keySeparator){var resTypeIsArray=resType==="[object Array]";var copy$$1=resTypeIsArray?[]:{};var newKeyToUse=resTypeIsArray?resExactUsedKey:resUsedKey;for(var m in res){if(Object.prototype.hasOwnProperty.call(res,m)){var deepKey="".concat(newKeyToUse).concat(keySeparator).concat(m);copy$$1[m]=this.translate(deepKey,_objectSpread({},options,{joinArrays:false,ns:namespaces}));if(copy$$1[m]===deepKey)copy$$1[m]=res[m]}}res=copy$$1}}else if(handleAsObjectInI18nFormat&&typeof joinArrays==="string"&&resType==="[object Array]"){res=res.join(joinArrays);if(res)res=this.extendTranslation(res,keys,options)}else{var usedDefault=false;var usedKey=false;if(!this.isValidLookup(res)&&options.defaultValue!==undefined){usedDefault=true;if(options.count!==undefined){var suffix=this.pluralResolver.getSuffix(lng,options.count);res=options["defaultValue".concat(suffix)]}if(!res)res=options.defaultValue}if(!this.isValidLookup(res)){usedKey=true;res=key}var updateMissing=options.defaultValue&&options.defaultValue!==res&&this.options.updateMissing;if(usedKey||usedDefault||updateMissing){this.logger.log(updateMissing?"updateKey":"missingKey",lng,namespace,key,updateMissing?options.defaultValue:res);var lngs=[];var fallbackLngs=this.languageUtils.getFallbackCodes(this.options.fallbackLng,options.lng||this.language);if(this.options.saveMissingTo==="fallback"&&fallbackLngs&&fallbackLngs[0]){for(var i=0;i<fallbackLngs.length;i++){lngs.push(fallbackLngs[i])}}else if(this.options.saveMissingTo==="all"){lngs=this.languageUtils.toResolveHierarchy(options.lng||this.language)}else{lngs.push(options.lng||this.language)}var send=function send(l,k){if(_this2.options.missingKeyHandler){_this2.options.missingKeyHandler(l,namespace,k,updateMissing?options.defaultValue:res,updateMissing,options)}else if(_this2.backendConnector&&_this2.backendConnector.saveMissing){_this2.backendConnector.saveMissing(l,namespace,k,updateMissing?options.defaultValue:res,updateMissing,options)}_this2.emit("missingKey",l,namespace,k,res)};if(this.options.saveMissing){var needsPluralHandling=options.count!==undefined&&typeof options.count!=="string";if(this.options.saveMissingPlurals&&needsPluralHandling){lngs.forEach(function(l){var plurals=_this2.pluralResolver.getPluralFormsOfKey(l,key);plurals.forEach(function(p){return send([l],p)})})}else{send(lngs,key)}}}res=this.extendTranslation(res,keys,options,resolved);if(usedKey&&res===key&&this.options.appendNamespaceToMissingKey)res="".concat(namespace,":").concat(key);if(usedKey&&this.options.parseMissingKeyHandler)res=this.options.parseMissingKeyHandler(res)}return res}},{key:"extendTranslation",value:function extendTranslation(res,key,options,resolved){var _this3=this;if(this.i18nFormat&&this.i18nFormat.parse){res=this.i18nFormat.parse(res,options,resolved.usedLng,resolved.usedNS,resolved.usedKey,{resolved:resolved})}else if(!options.skipInterpolation){if(options.interpolation)this.interpolator.init(_objectSpread({},options,{interpolation:_objectSpread({},this.options.interpolation,options.interpolation)}));var data=options.replace&&typeof options.replace!=="string"?options.replace:options;if(this.options.interpolation.defaultVariables)data=_objectSpread({},this.options.interpolation.defaultVariables,data);res=this.interpolator.interpolate(res,data,options.lng||this.language,options);if(options.nest!==false)res=this.interpolator.nest(res,function(){return _this3.translate.apply(_this3,arguments)},options);if(options.interpolation)this.interpolator.reset()}var postProcess=options.postProcess||this.options.postProcess;var postProcessorNames=typeof postProcess==="string"?[postProcess]:postProcess;if(res!==undefined&&res!==null&&postProcessorNames&&postProcessorNames.length&&options.applyPostProcessor!==false){res=postProcessor.handle(postProcessorNames,res,key,this.options&&this.options.postProcessPassResolved?_objectSpread({i18nResolved:resolved},options):options,this)}return res}},{key:"resolve",value:function resolve(keys){var _this4=this;var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var found;var usedKey;var exactUsedKey;var usedLng;var usedNS;if(typeof keys==="string")keys=[keys];keys.forEach(function(k){if(_this4.isValidLookup(found))return;var extracted=_this4.extractFromKey(k,options);var key=extracted.key;usedKey=key;var namespaces=extracted.namespaces;if(_this4.options.fallbackNS)namespaces=namespaces.concat(_this4.options.fallbackNS);var needsPluralHandling=options.count!==undefined&&typeof options.count!=="string";var needsContextHandling=options.context!==undefined&&typeof options.context==="string"&&options.context!=="";var codes=options.lngs?options.lngs:_this4.languageUtils.toResolveHierarchy(options.lng||_this4.language,options.fallbackLng);namespaces.forEach(function(ns){if(_this4.isValidLookup(found))return;usedNS=ns;if(!checkedLoadedFor["".concat(codes[0],"-").concat(ns)]&&_this4.utils&&_this4.utils.hasLoadedNamespace&&!_this4.utils.hasLoadedNamespace(usedNS)){checkedLoadedFor["".concat(codes[0],"-").concat(ns)]=true;_this4.logger.warn('key "'.concat(usedKey,'" for namespace "').concat(usedNS,'" for languages "').concat(codes.join(", "),"\" won't get resolved as namespace was not yet loaded"),"This means something IS WRONG in your application setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}codes.forEach(function(code){if(_this4.isValidLookup(found))return;usedLng=code;var finalKey=key;var finalKeys=[finalKey];if(_this4.i18nFormat&&_this4.i18nFormat.addLookupKeys){_this4.i18nFormat.addLookupKeys(finalKeys,key,code,ns,options)}else{var pluralSuffix;if(needsPluralHandling)pluralSuffix=_this4.pluralResolver.getSuffix(code,options.count);if(needsPluralHandling&&needsContextHandling)finalKeys.push(finalKey+pluralSuffix);if(needsContextHandling)finalKeys.push(finalKey+="".concat(_this4.options.contextSeparator).concat(options.context));if(needsPluralHandling)finalKeys.push(finalKey+=pluralSuffix)}var possibleKey;while(possibleKey=finalKeys.pop()){if(!_this4.isValidLookup(found)){exactUsedKey=possibleKey;found=_this4.getResource(code,ns,possibleKey,options)}}})})});return{res:found,usedKey:usedKey,exactUsedKey:exactUsedKey,usedLng:usedLng,usedNS:usedNS}}},{key:"isValidLookup",value:function isValidLookup(res){return res!==undefined&&!(!this.options.returnNull&&res===null)&&!(!this.options.returnEmptyString&&res==="")}},{key:"getResource",value:function getResource(code,ns,key){var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(this.i18nFormat&&this.i18nFormat.getResource)return this.i18nFormat.getResource(code,ns,key,options);return this.resourceStore.getResource(code,ns,key,options)}}]);return Translator}(EventEmitter);function capitalize(string){return string.charAt(0).toUpperCase()+string.slice(1)}var LanguageUtil=function(){function LanguageUtil(options){_classCallCheck(this,LanguageUtil);this.options=options;this.whitelist=this.options.whitelist||false;this.logger=baseLogger.create("languageUtils")}_createClass(LanguageUtil,[{key:"getScriptPartFromCode",value:function getScriptPartFromCode(code){if(!code||code.indexOf("-")<0)return null;var p=code.split("-");if(p.length===2)return null;p.pop();return this.formatLanguageCode(p.join("-"))}},{key:"getLanguagePartFromCode",value:function getLanguagePartFromCode(code){if(!code||code.indexOf("-")<0)return code;var p=code.split("-");return this.formatLanguageCode(p[0])}},{key:"formatLanguageCode",value:function formatLanguageCode(code){if(typeof code==="string"&&code.indexOf("-")>-1){var specialCases=["hans","hant","latn","cyrl","cans","mong","arab"];var p=code.split("-");if(this.options.lowerCaseLng){p=p.map(function(part){return part.toLowerCase()})}else if(p.length===2){p[0]=p[0].toLowerCase();p[1]=p[1].toUpperCase();if(specialCases.indexOf(p[1].toLowerCase())>-1)p[1]=capitalize(p[1].toLowerCase())}else if(p.length===3){p[0]=p[0].toLowerCase();if(p[1].length===2)p[1]=p[1].toUpperCase();if(p[0]!=="sgn"&&p[2].length===2)p[2]=p[2].toUpperCase();if(specialCases.indexOf(p[1].toLowerCase())>-1)p[1]=capitalize(p[1].toLowerCase());if(specialCases.indexOf(p[2].toLowerCase())>-1)p[2]=capitalize(p[2].toLowerCase())}return p.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?code.toLowerCase():code}},{key:"isWhitelisted",value:function isWhitelisted(code){if(this.options.load==="languageOnly"||this.options.nonExplicitWhitelist){code=this.getLanguagePartFromCode(code)}return!this.whitelist||!this.whitelist.length||this.whitelist.indexOf(code)>-1}},{key:"getFallbackCodes",value:function getFallbackCodes(fallbacks,code){if(!fallbacks)return[];if(typeof fallbacks==="string")fallbacks=[fallbacks];if(Object.prototype.toString.apply(fallbacks)==="[object Array]")return fallbacks;if(!code)return fallbacks["default"]||[];var found=fallbacks[code];if(!found)found=fallbacks[this.getScriptPartFromCode(code)];if(!found)found=fallbacks[this.formatLanguageCode(code)];if(!found)found=fallbacks["default"];return found||[]}},{key:"toResolveHierarchy",value:function toResolveHierarchy(code,fallbackCode){var _this=this;var fallbackCodes=this.getFallbackCodes(fallbackCode||this.options.fallbackLng||[],code);var codes=[];var addCode=function addCode(c){if(!c)return;if(_this.isWhitelisted(c)){codes.push(c)}else{_this.logger.warn("rejecting non-whitelisted language code: ".concat(c))}};if(typeof code==="string"&&code.indexOf("-")>-1){if(this.options.load!=="languageOnly")addCode(this.formatLanguageCode(code));if(this.options.load!=="languageOnly"&&this.options.load!=="currentOnly")addCode(this.getScriptPartFromCode(code));if(this.options.load!=="currentOnly")addCode(this.getLanguagePartFromCode(code))}else if(typeof code==="string"){addCode(this.formatLanguageCode(code))}fallbackCodes.forEach(function(fc){if(codes.indexOf(fc)<0)addCode(_this.formatLanguageCode(fc))});return codes}}]);return LanguageUtil}();var sets=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he"],nr:[1,2,20,21],fc:22}];var _rulesPluralsTypes={1:function _(n){return Number(n>1)},2:function _(n){return Number(n!=1)},3:function _(n){return 0},4:function _(n){return Number(n%10==1&&n%100!=11?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2)},5:function _(n){return Number(n===0?0:n==1?1:n==2?2:n%100>=3&&n%100<=10?3:n%100>=11?4:5)},6:function _(n){return Number(n==1?0:n>=2&&n<=4?1:2)},7:function _(n){return Number(n==1?0:n%10>=2&&n%10<=4&&(n%100<10||n%100>=20)?1:2)},8:function _(n){return Number(n==1?0:n==2?1:n!=8&&n!=11?2:3)},9:function _(n){return Number(n>=2)},10:function _(n){return Number(n==1?0:n==2?1:n<7?2:n<11?3:4)},11:function _(n){return Number(n==1||n==11?0:n==2||n==12?1:n>2&&n<20?2:3)},12:function _(n){return Number(n%10!=1||n%100==11)},13:function _(n){return Number(n!==0)},14:function _(n){return Number(n==1?0:n==2?1:n==3?2:3)},15:function _(n){return Number(n%10==1&&n%100!=11?0:n%10>=2&&(n%100<10||n%100>=20)?1:2)},16:function _(n){return Number(n%10==1&&n%100!=11?0:n!==0?1:2)},17:function _(n){return Number(n==1||n%10==1?0:1)},18:function _(n){return Number(n==0?0:n==1?1:2)},19:function _(n){return Number(n==1?0:n===0||n%100>1&&n%100<11?1:n%100>10&&n%100<20?2:3)},20:function _(n){return Number(n==1?0:n===0||n%100>0&&n%100<20?1:2)},21:function _(n){return Number(n%100==1?1:n%100==2?2:n%100==3||n%100==4?3:0)},22:function _(n){return Number(n===1?0:n===2?1:(n<0||n>10)&&n%10==0?2:3)}};function createRules(){var rules={};sets.forEach(function(set){set.lngs.forEach(function(l){rules[l]={numbers:set.nr,plurals:_rulesPluralsTypes[set.fc]}})});return rules}var PluralResolver=function(){function PluralResolver(languageUtils){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,PluralResolver);this.languageUtils=languageUtils;this.options=options;this.logger=baseLogger.create("pluralResolver");this.rules=createRules()}_createClass(PluralResolver,[{key:"addRule",value:function addRule(lng,obj){this.rules[lng]=obj}},{key:"getRule",value:function getRule(code){return this.rules[code]||this.rules[this.languageUtils.getLanguagePartFromCode(code)]}},{key:"needsPlural",value:function needsPlural(code){var rule=this.getRule(code);return rule&&rule.numbers.length>1}},{key:"getPluralFormsOfKey",value:function getPluralFormsOfKey(code,key){var _this=this;var ret=[];var rule=this.getRule(code);if(!rule)return ret;rule.numbers.forEach(function(n){var suffix=_this.getSuffix(code,n);ret.push("".concat(key).concat(suffix))});return ret}},{key:"getSuffix",value:function getSuffix(code,count){var _this2=this;var rule=this.getRule(code);if(rule){var idx=rule.noAbs?rule.plurals(count):rule.plurals(Math.abs(count));var suffix=rule.numbers[idx];if(this.options.simplifyPluralSuffix&&rule.numbers.length===2&&rule.numbers[0]===1){if(suffix===2){suffix="plural"}else if(suffix===1){suffix=""}}var returnSuffix=function returnSuffix(){return _this2.options.prepend&&suffix.toString()?_this2.options.prepend+suffix.toString():suffix.toString()};if(this.options.compatibilityJSON==="v1"){if(suffix===1)return"";if(typeof suffix==="number")return"_plural_".concat(suffix.toString());return returnSuffix()}else if(this.options.compatibilityJSON==="v2"){return returnSuffix()}else if(this.options.simplifyPluralSuffix&&rule.numbers.length===2&&rule.numbers[0]===1){return returnSuffix()}return this.options.prepend&&idx.toString()?this.options.prepend+idx.toString():idx.toString()}this.logger.warn("no plural rule found for: ".concat(code));return""}}]);return PluralResolver}();var Interpolator=function(){function Interpolator(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,Interpolator);this.logger=baseLogger.create("interpolator");this.options=options;this.format=options.interpolation&&options.interpolation.format||function(value){return value};this.init(options)}_createClass(Interpolator,[{key:"init",value:function init(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(!options.interpolation)options.interpolation={escapeValue:true};var iOpts=options.interpolation;this.escape=iOpts.escape!==undefined?iOpts.escape:escape;this.escapeValue=iOpts.escapeValue!==undefined?iOpts.escapeValue:true;this.useRawValueToEscape=iOpts.useRawValueToEscape!==undefined?iOpts.useRawValueToEscape:false;this.prefix=iOpts.prefix?regexEscape(iOpts.prefix):iOpts.prefixEscaped||"{{";this.suffix=iOpts.suffix?regexEscape(iOpts.suffix):iOpts.suffixEscaped||"}}";this.formatSeparator=iOpts.formatSeparator?iOpts.formatSeparator:iOpts.formatSeparator||",";this.unescapePrefix=iOpts.unescapeSuffix?"":iOpts.unescapePrefix||"-";this.unescapeSuffix=this.unescapePrefix?"":iOpts.unescapeSuffix||"";this.nestingPrefix=iOpts.nestingPrefix?regexEscape(iOpts.nestingPrefix):iOpts.nestingPrefixEscaped||regexEscape("$t(");this.nestingSuffix=iOpts.nestingSuffix?regexEscape(iOpts.nestingSuffix):iOpts.nestingSuffixEscaped||regexEscape(")");this.maxReplaces=iOpts.maxReplaces?iOpts.maxReplaces:1e3;this.resetRegExp()}},{key:"reset",value:function reset(){if(this.options)this.init(this.options)}},{key:"resetRegExp",value:function resetRegExp(){var regexpStr="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(regexpStr,"g");var regexpUnescapeStr="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(regexpUnescapeStr,"g");var nestingRegexpStr="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(nestingRegexpStr,"g")}},{key:"interpolate",value:function interpolate(str,data,lng,options){var _this=this;var match;var value;var replaces;var defaultData=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function regexSafe(val){return val.replace(/\$/g,"$$$$")}var handleFormat=function handleFormat(key){if(key.indexOf(_this.formatSeparator)<0){return getPathWithDefaults(data,defaultData,key)}var p=key.split(_this.formatSeparator);var k=p.shift().trim();var f=p.join(_this.formatSeparator).trim();return _this.format(getPathWithDefaults(data,defaultData,k),f,lng)};this.resetRegExp();var missingInterpolationHandler=options&&options.missingInterpolationHandler||this.options.missingInterpolationHandler;replaces=0;while(match=this.regexpUnescape.exec(str)){value=handleFormat(match[1].trim());if(value===undefined){if(typeof missingInterpolationHandler==="function"){var temp=missingInterpolationHandler(str,match,options);value=typeof temp==="string"?temp:""}else{this.logger.warn("missed to pass in variable ".concat(match[1]," for interpolating ").concat(str));value=""}}else if(typeof value!=="string"&&!this.useRawValueToEscape){value=makeString(value)}str=str.replace(match[0],regexSafe(value));this.regexpUnescape.lastIndex=0;replaces++;if(replaces>=this.maxReplaces){break}}replaces=0;while(match=this.regexp.exec(str)){value=handleFormat(match[1].trim());if(value===undefined){if(typeof missingInterpolationHandler==="function"){var _temp=missingInterpolationHandler(str,match,options);value=typeof _temp==="string"?_temp:""}else{this.logger.warn("missed to pass in variable ".concat(match[1]," for interpolating ").concat(str));value=""}}else if(typeof value!=="string"&&!this.useRawValueToEscape){value=makeString(value)}value=this.escapeValue?regexSafe(this.escape(value)):regexSafe(value);str=str.replace(match[0],value);this.regexp.lastIndex=0;replaces++;if(replaces>=this.maxReplaces){break}}return str}},{key:"nest",value:function nest(str,fc){var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var match;var value;var clonedOptions=_objectSpread({},options);clonedOptions.applyPostProcessor=false;delete clonedOptions.defaultValue;function handleHasOptions(key,inheritedOptions){if(key.indexOf(",")<0)return key;var p=key.split(",");key=p.shift();var optionsString=p.join(",");optionsString=this.interpolate(optionsString,clonedOptions);optionsString=optionsString.replace(/'/g,'"');try{clonedOptions=JSON.parse(optionsString);if(inheritedOptions)clonedOptions=_objectSpread({},inheritedOptions,clonedOptions)}catch(e){this.logger.error("failed parsing options string in nesting for key ".concat(key),e)}delete clonedOptions.defaultValue;return key}while(match=this.nestingRegexp.exec(str)){value=fc(handleHasOptions.call(this,match[1].trim(),clonedOptions),clonedOptions);if(value&&match[0]===str&&typeof value!=="string")return value;if(typeof value!=="string")value=makeString(value);if(!value){this.logger.warn("missed to resolve ".concat(match[1]," for nesting ").concat(str));value=""}str=str.replace(match[0],value);this.regexp.lastIndex=0}return str}}]);return Interpolator}();function remove(arr,what){var found=arr.indexOf(what);while(found!==-1){arr.splice(found,1);found=arr.indexOf(what)}}var Connector=function(_EventEmitter){_inherits(Connector,_EventEmitter);function Connector(backend,store,services){var _this;var options=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck(this,Connector);_this=_possibleConstructorReturn(this,_getPrototypeOf(Connector).call(this));EventEmitter.call(_assertThisInitialized(_this));_this.backend=backend;_this.store=store;_this.services=services;_this.languageUtils=services.languageUtils;_this.options=options;_this.logger=baseLogger.create("backendConnector");_this.state={};_this.queue=[];if(_this.backend&&_this.backend.init){_this.backend.init(services,options.backend,options)}return _this}_createClass(Connector,[{key:"queueLoad",value:function queueLoad(languages,namespaces,options,callback){var _this2=this;var toLoad=[];var pending=[];var toLoadLanguages=[];var toLoadNamespaces=[];languages.forEach(function(lng){var hasAllNamespaces=true;namespaces.forEach(function(ns){var name="".concat(lng,"|").concat(ns);if(!options.reload&&_this2.store.hasResourceBundle(lng,ns)){_this2.state[name]=2}else if(_this2.state[name]<0);else if(_this2.state[name]===1){if(pending.indexOf(name)<0)pending.push(name)}else{_this2.state[name]=1;hasAllNamespaces=false;if(pending.indexOf(name)<0)pending.push(name);if(toLoad.indexOf(name)<0)toLoad.push(name);if(toLoadNamespaces.indexOf(ns)<0)toLoadNamespaces.push(ns)}});if(!hasAllNamespaces)toLoadLanguages.push(lng)});if(toLoad.length||pending.length){this.queue.push({pending:pending,loaded:{},errors:[],callback:callback})}return{toLoad:toLoad,pending:pending,toLoadLanguages:toLoadLanguages,toLoadNamespaces:toLoadNamespaces}}},{key:"loaded",value:function loaded(name,err,data){var _name$split=name.split("|"),_name$split2=_slicedToArray(_name$split,2),lng=_name$split2[0],ns=_name$split2[1];if(err)this.emit("failedLoading",lng,ns,err);if(data){this.store.addResourceBundle(lng,ns,data)}this.state[name]=err?-1:2;var loaded={};this.queue.forEach(function(q){pushPath(q.loaded,[lng],ns);remove(q.pending,name);if(err)q.errors.push(err);if(q.pending.length===0&&!q.done){Object.keys(q.loaded).forEach(function(l){if(!loaded[l])loaded[l]=[];if(q.loaded[l].length){q.loaded[l].forEach(function(ns){if(loaded[l].indexOf(ns)<0)loaded[l].push(ns)})}});q.done=true;if(q.errors.length){q.callback(q.errors)}else{q.callback()}}});this.emit("loaded",loaded);this.queue=this.queue.filter(function(q){return!q.done})}},{key:"read",value:function read(lng,ns,fcName){var _this3=this;var tried=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var wait=arguments.length>4&&arguments[4]!==undefined?arguments[4]:250;var callback=arguments.length>5?arguments[5]:undefined;if(!lng.length)return callback(null,{});return this.backend[fcName](lng,ns,function(err,data){if(err&&data&&tried<5){setTimeout(function(){_this3.read.call(_this3,lng,ns,fcName,tried+1,wait*2,callback)},wait);return}callback(err,data)})}},{key:"prepareLoading",value:function prepareLoading(languages,namespaces){var _this4=this;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var callback=arguments.length>3?arguments[3]:undefined;if(!this.backend){this.logger.warn("No backend was added via i18next.use. Will not load resources.");return callback&&callback()}if(typeof languages==="string")languages=this.languageUtils.toResolveHierarchy(languages);if(typeof namespaces==="string")namespaces=[namespaces];var toLoad=this.queueLoad(languages,namespaces,options,callback);if(!toLoad.toLoad.length){if(!toLoad.pending.length)callback();return null}toLoad.toLoad.forEach(function(name){_this4.loadOne(name)})}},{key:"load",value:function load(languages,namespaces,callback){this.prepareLoading(languages,namespaces,{},callback)}},{key:"reload",value:function reload(languages,namespaces,callback){this.prepareLoading(languages,namespaces,{reload:true},callback)}},{key:"loadOne",value:function loadOne(name){var _this5=this;var prefix=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var _name$split3=name.split("|"),_name$split4=_slicedToArray(_name$split3,2),lng=_name$split4[0],ns=_name$split4[1];this.read(lng,ns,"read",null,null,function(err,data){if(err)_this5.logger.warn("".concat(prefix,"loading namespace ").concat(ns," for language ").concat(lng," failed"),err);if(!err&&data)_this5.logger.log("".concat(prefix,"loaded namespace ").concat(ns," for language ").concat(lng),data);_this5.loaded(name,err,data)})}},{key:"saveMissing",value:function saveMissing(languages,namespace,key,fallbackValue,isUpdate){var options=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(namespace)){this.logger.warn('did not save key "'.concat(key,'" for namespace "').concat(namespace,'" as the namespace was not yet loaded'),"This means something IS WRONG in your application setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(key===undefined||key===null||key==="")return;if(this.backend&&this.backend.create){this.backend.create(languages,namespace,key,fallbackValue,null,_objectSpread({},options,{isUpdate:isUpdate}))}if(!languages||!languages[0])return;this.store.addResource(languages[0],namespace,key,fallbackValue)}}]);return Connector}(EventEmitter);function get(){return{debug:false,initImmediate:true,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:false,whitelist:false,nonExplicitWhitelist:false,load:"all",preload:false,simplifyPluralSuffix:true,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:false,saveMissing:false,updateMissing:false,saveMissingTo:"fallback",saveMissingPlurals:true,missingKeyHandler:false,missingInterpolationHandler:false,postProcess:false,postProcessPassResolved:false,returnNull:true,returnEmptyString:true,returnObjects:false,joinArrays:false,returnedObjectHandler:false,parseMissingKeyHandler:false,appendNamespaceToMissingKey:false,appendNamespaceToCIMode:false,overloadTranslationOptionHandler:function handle(args){var ret={};if(_typeof(args[1])==="object")ret=args[1];if(typeof args[1]==="string")ret.defaultValue=args[1];if(typeof args[2]==="string")ret.tDescription=args[2];if(_typeof(args[2])==="object"||_typeof(args[3])==="object"){var options=args[3]||args[2];Object.keys(options).forEach(function(key){ret[key]=options[key]})}return ret},interpolation:{escapeValue:true,format:function format(value,_format,lng){return value},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",maxReplaces:1e3}}}function transformOptions(options){if(typeof options.ns==="string")options.ns=[options.ns];if(typeof options.fallbackLng==="string")options.fallbackLng=[options.fallbackLng];if(typeof options.fallbackNS==="string")options.fallbackNS=[options.fallbackNS];if(options.whitelist&&options.whitelist.indexOf("cimode")<0){options.whitelist=options.whitelist.concat(["cimode"])}return options}function noop(){}var I18n=function(_EventEmitter){_inherits(I18n,_EventEmitter);function I18n(){var _this;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var callback=arguments.length>1?arguments[1]:undefined;_classCallCheck(this,I18n);_this=_possibleConstructorReturn(this,_getPrototypeOf(I18n).call(this));EventEmitter.call(_assertThisInitialized(_this));_this.options=transformOptions(options);_this.services={};_this.logger=baseLogger;_this.modules={external:[]};if(callback&&!_this.isInitialized&&!options.isClone){if(!_this.options.initImmediate){_this.init(options,callback);return _possibleConstructorReturn(_this,_assertThisInitialized(_this))}setTimeout(function(){_this.init(options,callback)},0)}return _this}_createClass(I18n,[{key:"init",value:function init(){var _this2=this;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var callback=arguments.length>1?arguments[1]:undefined;if(typeof options==="function"){callback=options;options={}}this.options=_objectSpread({},get(),this.options,transformOptions(options));this.format=this.options.interpolation.format;if(!callback)callback=noop;function createClassOnDemand(ClassOrObject){if(!ClassOrObject)return null;if(typeof ClassOrObject==="function")return new ClassOrObject;return ClassOrObject}if(!this.options.isClone){if(this.modules.logger){baseLogger.init(createClassOnDemand(this.modules.logger),this.options)}else{baseLogger.init(null,this.options)}var lu=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);var s=this.services;s.logger=baseLogger;s.resourceStore=this.store;s.languageUtils=lu;s.pluralResolver=new PluralResolver(lu,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix});s.interpolator=new Interpolator(this.options);s.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)};s.backendConnector=new Connector(createClassOnDemand(this.modules.backend),s.resourceStore,s,this.options);s.backendConnector.on("*",function(event){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}_this2.emit.apply(_this2,[event].concat(args))});if(this.modules.languageDetector){s.languageDetector=createClassOnDemand(this.modules.languageDetector);s.languageDetector.init(s,this.options.detection,this.options)}if(this.modules.i18nFormat){s.i18nFormat=createClassOnDemand(this.modules.i18nFormat);if(s.i18nFormat.init)s.i18nFormat.init(this)}this.translator=new Translator(this.services,this.options);this.translator.on("*",function(event){for(var _len2=arguments.length,args=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){args[_key2-1]=arguments[_key2]}_this2.emit.apply(_this2,[event].concat(args))});this.modules.external.forEach(function(m){if(m.init)m.init(_this2)})}var storeApi=["getResource","addResource","addResources","addResourceBundle","removeResourceBundle","hasResourceBundle","getResourceBundle","getDataByLanguage"];storeApi.forEach(function(fcName){_this2[fcName]=function(){var _this2$store;return(_this2$store=_this2.store)[fcName].apply(_this2$store,arguments)}});var deferred=defer();var load=function load(){_this2.changeLanguage(_this2.options.lng,function(err,t){_this2.isInitialized=true;_this2.logger.log("initialized",_this2.options);_this2.emit("initialized",_this2.options);deferred.resolve(t);callback(err,t)})};if(this.options.resources||!this.options.initImmediate){load()}else{setTimeout(load,0)}return deferred}},{key:"loadResources",value:function loadResources(language){var _this3=this;var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:noop;var usedCallback=callback;var usedLng=typeof language==="string"?language:this.language;if(typeof language==="function")usedCallback=language;if(!this.options.resources||this.options.partialBundledLanguages){if(usedLng&&usedLng.toLowerCase()==="cimode")return usedCallback();var toLoad=[];var append=function append(lng){if(!lng)return;var lngs=_this3.services.languageUtils.toResolveHierarchy(lng);lngs.forEach(function(l){if(toLoad.indexOf(l)<0)toLoad.push(l)})};if(!usedLng){var fallbacks=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);fallbacks.forEach(function(l){return append(l)})}else{append(usedLng)}if(this.options.preload){this.options.preload.forEach(function(l){return append(l)})}this.services.backendConnector.load(toLoad,this.options.ns,usedCallback)}else{usedCallback(null)}}},{key:"reloadResources",value:function reloadResources(lngs,ns,callback){var deferred=defer();if(!lngs)lngs=this.languages;if(!ns)ns=this.options.ns;if(!callback)callback=noop;this.services.backendConnector.reload(lngs,ns,function(err){deferred.resolve();callback(err)});return deferred}},{key:"use",value:function use(module){if(module.type==="backend"){this.modules.backend=module}if(module.type==="logger"||module.log&&module.warn&&module.error){this.modules.logger=module}if(module.type==="languageDetector"){this.modules.languageDetector=module}if(module.type==="i18nFormat"){this.modules.i18nFormat=module}if(module.type==="postProcessor"){postProcessor.addPostProcessor(module)}if(module.type==="3rdParty"){this.modules.external.push(module)}return this}},{key:"changeLanguage",value:function changeLanguage(lng,callback){var _this4=this;this.isLanguageChangingTo=lng;var deferred=defer();this.emit("languageChanging",lng);var done=function done(err,l){if(l){_this4.language=l;_this4.languages=_this4.services.languageUtils.toResolveHierarchy(l);_this4.translator.changeLanguage(l);_this4.isLanguageChangingTo=undefined;_this4.emit("languageChanged",l);_this4.logger.log("languageChanged",l)}else{_this4.isLanguageChangingTo=undefined}deferred.resolve(function(){return _this4.t.apply(_this4,arguments)});if(callback)callback(err,function(){return _this4.t.apply(_this4,arguments)})};var setLng=function setLng(l){if(l){if(!_this4.language){_this4.language=l;_this4.languages=_this4.services.languageUtils.toResolveHierarchy(l)}if(!_this4.translator.language)_this4.translator.changeLanguage(l);if(_this4.services.languageDetector)_this4.services.languageDetector.cacheUserLanguage(l)}_this4.loadResources(l,function(err){done(err,l)})};if(!lng&&this.services.languageDetector&&!this.services.languageDetector.async){setLng(this.services.languageDetector.detect())}else if(!lng&&this.services.languageDetector&&this.services.languageDetector.async){this.services.languageDetector.detect(setLng)}else{setLng(lng)}return deferred}},{key:"getFixedT",value:function getFixedT(lng,ns){var _this5=this;var fixedT=function fixedT(key,opts){var options;if(_typeof(opts)!=="object"){for(var _len3=arguments.length,rest=new Array(_len3>2?_len3-2:0),_key3=2;_key3<_len3;_key3++){rest[_key3-2]=arguments[_key3]}options=_this5.options.overloadTranslationOptionHandler([key,opts].concat(rest))}else{options=_objectSpread({},opts)}options.lng=options.lng||fixedT.lng;options.lngs=options.lngs||fixedT.lngs;options.ns=options.ns||fixedT.ns;return _this5.t(key,options)};if(typeof lng==="string"){fixedT.lng=lng}else{fixedT.lngs=lng}fixedT.ns=ns;return fixedT}},{key:"t",value:function t(){var _this$translator;return this.translator&&(_this$translator=this.translator).translate.apply(_this$translator,arguments)}},{key:"exists",value:function exists(){var _this$translator2;return this.translator&&(_this$translator2=this.translator).exists.apply(_this$translator2,arguments)}},{key:"setDefaultNamespace",value:function setDefaultNamespace(ns){this.options.defaultNS=ns}},{key:"hasLoadedNamespace",value:function hasLoadedNamespace(ns){var _this6=this;if(!this.isInitialized){this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages);return false}if(!this.languages||!this.languages.length){this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages);return false}var lng=this.languages[0];var fallbackLng=this.options?this.options.fallbackLng:false;var lastLng=this.languages[this.languages.length-1];if(lng.toLowerCase()==="cimode")return true;var loadNotPending=function loadNotPending(l,n){var loadState=_this6.services.backendConnector.state["".concat(l,"|").concat(n)];return loadState===-1||loadState===2};if(this.hasResourceBundle(lng,ns))return true;if(!this.services.backendConnector.backend)return true;if(loadNotPending(lng,ns)&&(!fallbackLng||loadNotPending(lastLng,ns)))return true;return false}},{key:"loadNamespaces",value:function loadNamespaces(ns,callback){var _this7=this;var deferred=defer();if(!this.options.ns){callback&&callback();return Promise.resolve()}if(typeof ns==="string")ns=[ns];ns.forEach(function(n){if(_this7.options.ns.indexOf(n)<0)_this7.options.ns.push(n)});this.loadResources(function(err){deferred.resolve();if(callback)callback(err)});return deferred}},{key:"loadLanguages",value:function loadLanguages(lngs,callback){var deferred=defer();if(typeof lngs==="string")lngs=[lngs];var preloaded=this.options.preload||[];var newLngs=lngs.filter(function(lng){return preloaded.indexOf(lng)<0});if(!newLngs.length){if(callback)callback();return Promise.resolve()}this.options.preload=preloaded.concat(newLngs);this.loadResources(function(err){deferred.resolve();if(callback)callback(err)});return deferred}},{key:"dir",value:function dir(lng){if(!lng)lng=this.languages&&this.languages.length>0?this.languages[0]:this.language;if(!lng)return"rtl";var rtlLngs=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"];return rtlLngs.indexOf(this.services.languageUtils.getLanguagePartFromCode(lng))>=0?"rtl":"ltr"}},{key:"createInstance",value:function createInstance(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var callback=arguments.length>1?arguments[1]:undefined;return new I18n(options,callback)}},{key:"cloneInstance",value:function cloneInstance(){var _this8=this;var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var callback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:noop;var mergedOptions=_objectSpread({},this.options,options,{isClone:true});var clone=new I18n(mergedOptions);var membersToCopy=["store","services","language"];membersToCopy.forEach(function(m){clone[m]=_this8[m]});clone.translator=new Translator(clone.services,clone.options);clone.translator.on("*",function(event){for(var _len4=arguments.length,args=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++){args[_key4-1]=arguments[_key4]}clone.emit.apply(clone,[event].concat(args))});clone.init(mergedOptions,callback);clone.translator.options=clone.options;return clone}}]);return I18n}(EventEmitter);var i18next=new I18n;module.exports=i18next},{"@babel/runtime/helpers/assertThisInitialized":4,"@babel/runtime/helpers/classCallCheck":5,"@babel/runtime/helpers/createClass":6,"@babel/runtime/helpers/getPrototypeOf":8,"@babel/runtime/helpers/inherits":9,"@babel/runtime/helpers/objectSpread":14,"@babel/runtime/helpers/possibleConstructorReturn":15,"@babel/runtime/helpers/slicedToArray":17,"@babel/runtime/helpers/toConsumableArray":18,"@babel/runtime/helpers/typeof":19}],268:[function(_dereq_,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],269:[function(_dereq_,module,exports){"use strict";var n;function t(a,b){return a.b===b.b&&a.a===b.a}function u(a,b){return a.b<b.b||a.b===b.b&&a.a<=b.a}function v(a,b,c){var d=b.b-a.b,e=c.b-b.b;return 0<d+e?d<e?b.a-a.a+d/(d+e)*(a.a-c.a):b.a-c.a+e/(d+e)*(c.a-a.a):0}function x(a,b,c){var d=b.b-a.b,e=c.b-b.b;return 0<d+e?(b.a-c.a)*d+(b.a-a.a)*e:0}function z(a,b){return a.a<b.a||a.a===b.a&&a.b<=b.b}function aa(a,b,c){var d=b.a-a.a,e=c.a-b.a;return 0<d+e?d<e?b.b-a.b+d/(d+e)*(a.b-c.b):b.b-c.b+e/(d+e)*(c.b-a.b):0}function ba(a,b,c){var d=b.a-a.a,e=c.a-b.a;return 0<d+e?(b.b-c.b)*d+(b.b-a.b)*e:0}function ca(a){return u(a.b.a,a.a)}function da(a){return u(a.a,a.b.a)}function A(a,b,c,d){a=0>a?0:a;c=0>c?0:c;return a<=c?0===c?(b+d)/2:b+a/(a+c)*(d-b):d+c/(a+c)*(b-d)}function ea(a){var b=B(a.b);C(b,a.c);C(b.b,a.c);D(b,a.a);return b}function E(a,b){var c=!1,d=!1;a!==b&&(b.a!==a.a&&(d=!0,F(b.a,a.a)),b.d!==a.d&&(c=!0,G(b.d,a.d)),H(b,a),d||(C(b,a.a),a.a.c=a),c||(D(b,a.d),a.d.a=a))}function I(a){var b=a.b,c=!1;a.d!==a.b.d&&(c=!0,G(a.d,a.b.d));a.c===a?F(a.a,null):(a.b.d.a=J(a),a.a.c=a.c,H(a,J(a)),c||D(a,a.d));b.c===b?(F(b.a,null),G(b.d,null)):(a.d.a=J(b),b.a.c=b.c,H(b,J(b)));fa(a)}function K(a){var b=B(a),c=b.b;H(b,a.e);b.a=a.b.a;C(c,b.a);b.d=c.d=a.d;b=b.b;H(a.b,J(a.b));H(a.b,b);a.b.a=b.a;b.b.a.c=b.b;b.b.d=a.b.d;b.f=a.f;b.b.f=a.b.f;return b}function L(a,b){var c=!1,d=B(a),e=d.b;b.d!==a.d&&(c=!0,G(b.d,a.d));H(d,a.e);H(e,b);d.a=a.b.a;e.a=b.a;d.d=e.d=a.d;a.d.a=e;c||D(d,a.d);return d}function B(a){var b=new M,c=new M,d=a.b.h;c.h=d;d.b.h=b;b.h=a;a.b.h=c;b.b=c;b.c=b;b.e=c;c.b=b;c.c=c;return c.e=b}function H(a,b){var c=a.c,d=b.c;c.b.e=b;d.b.e=a;a.c=d;b.c=c}function C(a,b){var c=b.f,d=new N(b,c);c.e=d;b.f=d;c=d.c=a;do{c.a=d,c=c.c}while(c!==a)}function D(a,b){var c=b.d,d=new ga(b,c);c.b=d;b.d=d;d.a=a;d.c=b.c;c=a;do{c.d=d,c=c.e}while(c!==a)}function fa(a){var b=a.h;a=a.b.h;b.b.h=a;a.b.h=b}function F(a,b){var c=a.c,d=c;do{d.a=b,d=d.c}while(d!==c);c=a.f;d=a.e;d.f=c;c.e=d}function G(a,b){var c=a.a,d=c;do{d.d=b,d=d.e}while(d!==c);c=a.d;d=a.b;d.d=c;c.b=d}function ha(a){var b=0;Math.abs(a[1])>Math.abs(a[0])&&(b=1);Math.abs(a[2])>Math.abs(a[b])&&(b=2);return b}var O=4*1e150;function P(a,b){a.f+=b.f;a.b.f+=b.b.f}function ia(a,b,c){a=a.a;b=b.a;c=c.a;if(b.b.a===a)return c.b.a===a?u(b.a,c.a)?0>=x(c.b.a,b.a,c.a):0<=x(b.b.a,c.a,b.a):0>=x(c.b.a,a,c.a);if(c.b.a===a)return 0<=x(b.b.a,a,b.a);b=v(b.b.a,a,b.a);a=v(c.b.a,a,c.a);return b>=a}function Q(a){a.a.i=null;var b=a.e;b.a.c=b.c;b.c.a=b.a;a.e=null}function ja(a,b){I(a.a);a.c=!1;a.a=b;b.i=a}function ka(a){var b=a.a.a;do{a=R(a)}while(a.a.a===b);a.c&&(b=L(S(a).a.b,a.a.e),ja(a,b),a=R(a));return a}function la(a,b,c){var d=new ma;d.a=c;d.e=na(a.f,b.e,d);return c.i=d}function oa(a,b){switch(a.s){case 100130:return 0!==(b&1);case 100131:return 0!==b;case 100132:return 0<b;case 100133:return 0>b;case 100134:return 2<=b||-2>=b}return!1}function pa(a){var b=a.a,c=b.d;c.c=a.d;c.a=b;Q(a)}function T(a,b,c){a=b;for(b=b.a;a!==c;){a.c=!1;var d=S(a),e=d.a;if(e.a!==b.a){if(!d.c){pa(a);break}e=L(b.c.b,e.b);ja(d,e)}b.c!==e&&(E(J(e),e),E(b,e));pa(a);b=d.a;a=d}return b}function U(a,b,c,d,e,f){var g=!0;do{la(a,b,c.b),c=c.c}while(c!==d);for(null===e&&(e=S(b).a.b.c);;){d=S(b);c=d.a.b;if(c.a!==e.a)break;c.c!==e&&(E(J(c),c),E(J(e),c));d.f=b.f-c.f;d.d=oa(a,d.f);b.b=!0;!g&&qa(a,b)&&(P(c,e),Q(b),I(e));g=!1;b=d;e=c}b.b=!0;f&&ra(a,b)}function sa(a,b,c,d,e){var f=[b.g[0],b.g[1],b.g[2]];b.d=null;b.d=a.o?a.o(f,c,d,a.c)||null:null;null===b.d&&(e?a.n||(V(a,100156),a.n=!0):b.d=c[0])}function ta(a,b,c){var d=[null,null,null,null];d[0]=b.a.d;d[1]=c.a.d;sa(a,b.a,d,[.5,.5,0,0],!1);E(b,c)}function ua(a,b,c,d,e){var f=Math.abs(b.b-a.b)+Math.abs(b.a-a.a),g=Math.abs(c.b-a.b)+Math.abs(c.a-a.a),h=e+1;d[e]=.5*g/(f+g);d[h]=.5*f/(f+g);a.g[0]+=d[e]*b.g[0]+d[h]*c.g[0];a.g[1]+=d[e]*b.g[1]+d[h]*c.g[1];a.g[2]+=d[e]*b.g[2]+d[h]*c.g[2]}function qa(a,b){var c=S(b),d=b.a,e=c.a;if(u(d.a,e.a)){if(0<x(e.b.a,d.a,e.a))return!1;if(!t(d.a,e.a))K(e.b),E(d,J(e)),b.b=c.b=!0;else if(d.a!==e.a){var c=a.e,f=d.a.h;if(0<=f){var c=c.b,g=c.d,h=c.e,k=c.c,l=k[f];g[l]=g[c.a];k[g[l]]=l;l<=--c.a&&(1>=l?W(c,l):u(h[g[l>>1]],h[g[l]])?W(c,l):va(c,l));h[f]=null;k[f]=c.b;c.b=f}else for(c.c[-(f+1)]=null;0<c.a&&null===c.c[c.d[c.a-1]];)--c.a;ta(a,J(e),d)}}else{if(0>x(d.b.a,e.a,d.a))return!1;R(b).b=b.b=!0;K(d.b);E(J(e),d)}return!0}function wa(a,b){var c=S(b),d=b.a,e=c.a,f=d.a,g=e.a,h=d.b.a,k=e.b.a,l=new N;x(h,a.a,f);x(k,a.a,g);if(f===g||Math.min(f.a,h.a)>Math.max(g.a,k.a))return!1;if(u(f,g)){if(0<x(k,f,g))return!1}else if(0>x(h,g,f))return!1;var r=h,p=f,q=k,y=g,m,w;u(r,p)||(m=r,r=p,p=m);u(q,y)||(m=q,q=y,y=m);u(r,q)||(m=r,r=q,q=m,m=p,p=y,y=m);u(q,p)?u(p,y)?(m=v(r,q,p),w=v(q,p,y),0>m+w&&(m=-m,w=-w),l.b=A(m,q.b,w,p.b)):(m=x(r,q,p),w=-x(r,y,p),0>m+w&&(m=-m,w=-w),l.b=A(m,q.b,w,y.b)):l.b=(q.b+p.b)/2;z(r,p)||(m=r,r=p,p=m);z(q,y)||(m=q,q=y,y=m);z(r,q)||(m=r,r=q,q=m,m=p,p=y,y=m);z(q,p)?z(p,y)?(m=aa(r,q,p),w=aa(q,p,y),0>m+w&&(m=-m,w=-w),l.a=A(m,q.a,w,p.a)):(m=ba(r,q,p),w=-ba(r,y,p),0>m+w&&(m=-m,w=-w),l.a=A(m,q.a,w,y.a)):l.a=(q.a+p.a)/2;u(l,a.a)&&(l.b=a.a.b,l.a=a.a.a);r=u(f,g)?f:g;u(r,l)&&(l.b=r.b,l.a=r.a);if(t(l,f)||t(l,g))return qa(a,b),!1;if(!t(h,a.a)&&0<=x(h,a.a,l)||!t(k,a.a)&&0>=x(k,a.a,l)){if(k===a.a)return K(d.b),E(e.b,d),b=ka(b),d=S(b).a,T(a,S(b),c),U(a,b,J(d),d,d,!0),!0;if(h===a.a){K(e.b);E(d.e,J(e));f=c=b;g=f.a.b.a;do{f=R(f)}while(f.a.b.a===g);b=f;f=S(b).a.b.c;c.a=J(e);e=T(a,c,null);U(a,b,e.c,d.b.c,f,!0);return!0}0<=x(h,a.a,l)&&(R(b).b=b.b=!0,K(d.b),d.a.b=a.a.b,d.a.a=a.a.a);0>=x(k,a.a,l)&&(b.b=c.b=!0,K(e.b),e.a.b=a.a.b,e.a.a=a.a.a);return!1}K(d.b);K(e.b);E(J(e),d);d.a.b=l.b;d.a.a=l.a;d.a.h=xa(a.e,d.a);d=d.a;e=[0,0,0,0];l=[f.d,h.d,g.d,k.d];d.g[0]=d.g[1]=d.g[2]=0;ua(d,f,h,e,0);ua(d,g,k,e,2);sa(a,d,l,e,!0);R(b).b=b.b=c.b=!0;return!1}function ra(a,b){for(var c=S(b);;){for(;c.b;)b=c,c=S(c);if(!b.b&&(c=b,b=R(b),null===b||!b.b))break;b.b=!1;var d=b.a,e=c.a,f;if(f=d.b.a!==e.b.a)a:{f=b;var g=S(f),h=f.a,k=g.a,l=void 0;if(u(h.b.a,k.b.a)){if(0>x(h.b.a,k.b.a,h.a)){f=!1;break a}R(f).b=f.b=!0;l=K(h);E(k.b,l);l.d.c=f.d}else{if(0<x(k.b.a,h.b.a,k.a)){f=!1;break a}f.b=g.b=!0;l=K(k);E(h.e,k.b);l.b.d.c=f.d}f=!0}f&&(c.c?(Q(c),I(e),c=S(b),e=c.a):b.c&&(Q(b),I(d),b=R(c),d=b.a));if(d.a!==e.a)if(d.b.a===e.b.a||b.c||c.c||d.b.a!==a.a&&e.b.a!==a.a)qa(a,b);else if(wa(a,b))break;d.a===e.a&&d.b.a===e.b.a&&(P(e,d),Q(b),I(d),b=R(c))}}function ya(a,b){a.a=b;for(var c=b.c;null===c.i;)if(c=c.c,c===b.c){var c=a,d=b,e=new ma;e.a=d.c.b;var f=c.f,g=f.a;do{g=g.a}while(null!==g.b&&!f.c(f.b,e,g.b));var f=g.b,h=S(f),e=f.a,g=h.a;if(0===x(e.b.a,d,e.a))e=f.a,t(e.a,d)||t(e.b.a,d)||(K(e.b),f.c&&(I(e.c),f.c=!1),E(d.c,e),ya(c,d));else{var k=u(g.b.a,e.b.a)?f:h,h=void 0;f.d||k.c?(k===f?h=L(d.c.b,e.e):h=L(g.b.c.b,d.c).b,k.c?ja(k,h):(e=c,f=la(c,f,h),f.f=R(f).f+f.a.f,f.d=oa(e,f.f)),ya(c,d)):U(c,f,d.c,d.c,null,!0)}return}c=ka(c.i);e=S(c);f=e.a;e=T(a,e,null);if(e.c===f){var f=e,e=f.c,g=S(c),h=c.a,k=g.a,l=!1;h.b.a!==k.b.a&&wa(a,c);t(h.a,a.a)&&(E(J(e),h),c=ka(c),e=S(c).a,T(a,S(c),g),l=!0);t(k.a,a.a)&&(E(f,J(k)),f=T(a,g,null),l=!0);l?U(a,c,f.c,e,e,!0):(u(k.a,h.a)?d=J(k):d=h,d=L(f.c.b,d),U(a,c,d,d.c,d.c,!1),d.b.i.c=!0,ra(a,c))}else U(a,c,e.c,f,f,!0)}function za(a,b){var c=new ma,d=ea(a.b);d.a.b=O;d.a.a=b;d.b.a.b=-O;d.b.a.a=b;a.a=d.b.a;c.a=d;c.f=0;c.d=!1;c.c=!1;c.h=!0;c.b=!1;d=a.f;d=na(d,d.a,c);c.e=d}function Aa(a){this.a=new Ba;this.b=a;this.c=ia}function na(a,b,c){do{b=b.c}while(null!==b.b&&!a.c(a.b,b.b,c));a=new Ba(c,b.a,b);b.a.c=a;return b.a=a}function Ba(a,b,c){this.b=a||null;this.a=b||this;this.c=c||this}function X(){this.d=Y;this.p=this.b=this.q=null;this.j=[0,0,0];this.s=100130;this.n=!1;this.o=this.a=this.e=this.f=null;this.m=!1;this.c=this.r=this.i=this.k=this.l=this.h=null}var Y=0;n=X.prototype;n.x=function(){Z(this,Y)};n.B=function(a,b){switch(a){case 100142:return;case 100140:switch(b){case 100130:case 100131:case 100132:case 100133:case 100134:this.s=b;return}break;case 100141:this.m=!!b;return;default:V(this,100900);return}V(this,100901)};n.y=function(a){switch(a){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:V(this,100900)}return!1};n.A=function(a,b,c){this.j[0]=a;this.j[1]=b;this.j[2]=c};n.z=function(a,b){var c=b?b:null;switch(a){case 100100:case 100106:this.h=c;break;case 100104:case 100110:this.l=c;break;case 100101:case 100107:this.k=c;break;case 100102:case 100108:this.i=c;break;case 100103:case 100109:this.p=c;break;case 100105:case 100111:this.o=c;break;case 100112:this.r=c;break;default:V(this,100900)}};n.C=function(a,b){var c=!1,d=[0,0,0];Z(this,2);for(var e=0;3>e;++e){var f=a[e];-1e150>f&&(f=-1e150,c=!0);1e150<f&&(f=1e150,c=!0);d[e]=f}c&&V(this,100155);c=this.q;null===c?(c=ea(this.b),E(c,c.b)):(K(c),c=c.e);c.a.d=b;c.a.g[0]=d[0];c.a.g[1]=d[1];c.a.g[2]=d[2];c.f=1;c.b.f=-1;this.q=c};n.u=function(a){Z(this,Y);this.d=1;this.b=new Ca;this.c=a};n.t=function(){Z(this,1);this.d=2;this.q=null};n.v=function(){Z(this,2);this.d=1};n.w=function(){Z(this,1);this.d=Y;var a=this.j[0],b=this.j[1],c=this.j[2],d=!1,e=[a,b,c];if(0===a&&0===b&&0===c){for(var b=[-2*1e150,-2*1e150,-2*1e150],f=[2*1e150,2*1e150,2*1e150],c=[],g=[],d=this.b.c,a=d.e;a!==d;a=a.e)for(var h=0;3>h;++h){var k=a.g[h];k<f[h]&&(f[h]=k,g[h]=a);k>b[h]&&(b[h]=k,c[h]=a)}a=0;b[1]-f[1]>b[0]-f[0]&&(a=1);b[2]-f[2]>b[a]-f[a]&&(a=2);if(f[a]>=b[a])e[0]=0,e[1]=0,e[2]=1;else{b=0;f=g[a];c=c[a];g=[0,0,0];f=[f.g[0]-c.g[0],f.g[1]-c.g[1],f.g[2]-c.g[2]];h=[0,0,0];for(a=d.e;a!==d;a=a.e)h[0]=a.g[0]-c.g[0],h[1]=a.g[1]-c.g[1],h[2]=a.g[2]-c.g[2],g[0]=f[1]*h[2]-f[2]*h[1],g[1]=f[2]*h[0]-f[0]*h[2],g[2]=f[0]*h[1]-f[1]*h[0],k=g[0]*g[0]+g[1]*g[1]+g[2]*g[2],k>b&&(b=k,e[0]=g[0],e[1]=g[1],e[2]=g[2]);0>=b&&(e[0]=e[1]=e[2]=0,e[ha(f)]=1)}d=!0}g=ha(e);a=this.b.c;b=(g+1)%3;c=(g+2)%3;g=0<e[g]?1:-1;for(e=a.e;e!==a;e=e.e)e.b=e.g[b],e.a=g*e.g[c];if(d){e=0;d=this.b.a;for(a=d.b;a!==d;a=a.b)if(b=a.a,!(0>=b.f)){do{e+=(b.a.b-b.b.a.b)*(b.a.a+b.b.a.a),b=b.e}while(b!==a.a)}if(0>e)for(e=this.b.c,d=e.e;d!==e;d=d.e)d.a=-d.a}this.n=!1;e=this.b.b;for(a=e.h;a!==e;a=d)if(d=a.h,b=a.e,t(a.a,a.b.a)&&a.e.e!==a&&(ta(this,b,a),I(a),a=b,b=a.e),b.e===a){if(b!==a){if(b===d||b===d.b)d=d.h;I(b)}if(a===d||a===d.b)d=d.h;I(a)}this.e=e=new Da;d=this.b.c;for(a=d.e;a!==d;a=a.e)a.h=xa(e,a);Ea(e);this.f=new Aa(this);za(this,-O);for(za(this,O);null!==(e=Fa(this.e));){for(;;){a:if(a=this.e,0===a.a)d=Ga(a.b);else if(d=a.c[a.d[a.a-1]],0!==a.b.a&&(a=Ga(a.b),u(a,d))){d=a;break a}if(null===d||!t(d,e))break;d=Fa(this.e);ta(this,e.c,d.c)}ya(this,e)}this.a=this.f.a.a.b.a.a;for(e=0;null!==(d=this.f.a.a.b);)d.h||++e,Q(d);this.f=null;e=this.e;e.b=null;e.d=null;this.e=e.c=null;e=this.b;for(a=e.a.b;a!==e.a;a=d)d=a.b,a=a.a,a.e.e===a&&(P(a.c,a),I(a));if(!this.n){e=this.b;if(this.m)for(a=e.b.h;a!==e.b;a=d)d=a.h,a.b.d.c!==a.d.c?a.f=a.d.c?1:-1:I(a);else for(a=e.a.b;a!==e.a;a=d)if(d=a.b,a.c){for(a=a.a;u(a.b.a,a.a);a=a.c.b);for(;u(a.a,a.b.a);a=a.e);b=a.c.b;for(c=void 0;a.e!==b;)if(u(a.b.a,b.a)){for(;b.e!==a&&(ca(b.e)||0>=x(b.a,b.b.a,b.e.b.a));)c=L(b.e,b),b=c.b;b=b.c.b}else{for(;b.e!==a&&(da(a.c.b)||0<=x(a.b.a,a.a,a.c.b.a));)c=L(a,a.c.b),a=c.b;a=a.e}for(;b.e.e!==a;)c=L(b.e,b),b=c.b}if(this.h||this.i||this.k||this.l)if(this.m)for(e=this.b,d=e.a.b;d!==e.a;d=d.b){if(d.c){this.h&&this.h(2,this.c);a=d.a;do{this.k&&this.k(a.a.d,this.c),a=a.e}while(a!==d.a);this.i&&this.i(this.c)}}else{e=this.b;d=!!this.l;a=!1;b=-1;for(c=e.a.d;c!==e.a;c=c.d)if(c.c){a||(this.h&&this.h(4,this.c),a=!0);g=c.a;do{d&&(f=g.b.d.c?0:1,b!==f&&(b=f,this.l&&this.l(!!b,this.c))),this.k&&this.k(g.a.d,this.c),g=g.e}while(g!==c.a)}a&&this.i&&this.i(this.c)}if(this.r){e=this.b;for(a=e.a.b;a!==e.a;a=d)if(d=a.b,!a.c){b=a.a;c=b.e;g=void 0;do{g=c,c=g.e,g.d=null,null===g.b.d&&(g.c===g?F(g.a,null):(g.a.c=g.c,H(g,J(g))),f=g.b,f.c===f?F(f.a,null):(f.a.c=f.c,H(f,J(f))),fa(g))}while(g!==b);b=a.d;a=a.b;a.d=b;b.b=a}this.r(this.b);this.c=this.b=null;return}}this.b=this.c=null};function Z(a,b){if(a.d!==b)for(;a.d!==b;)if(a.d<b)switch(a.d){case Y:V(a,100151);a.u(null);break;case 1:V(a,100152),a.t()}else switch(a.d){case 2:V(a,100154);a.v();break;case 1:V(a,100153),a.w()}}function V(a,b){a.p&&a.p(b,a.c)}function ga(a,b){this.b=a||this;this.d=b||this;this.a=null;this.c=!1}function M(){this.h=this;this.i=this.d=this.a=this.e=this.c=this.b=null;this.f=0}function J(a){return a.b.e}function Ca(){this.c=new N;this.a=new ga;this.b=new M;this.d=new M;this.b.b=this.d;this.d.b=this.b}function N(a,b){this.e=a||this;this.f=b||this;this.d=this.c=null;this.g=[0,0,0];this.h=this.a=this.b=0}function Da(){this.c=[];this.d=null;this.a=0;this.e=!1;this.b=new Ha}function Ea(a){a.d=[];for(var b=0;b<a.a;b++)a.d[b]=b;a.d.sort(function(a){return function(b,e){return u(a[b],a[e])?1:-1}}(a.c));a.e=!0;Ia(a.b)}function xa(a,b){if(a.e){var c=a.b,d=++c.a;2*d>c.f&&(c.f*=2,c.c=Ja(c.c,c.f+1));var e;0===c.b?e=d:(e=c.b,c.b=c.c[c.b]);c.e[e]=b;c.c[e]=d;c.d[d]=e;c.h&&va(c,d);return e}c=a.a++;a.c[c]=b;return-(c+1)}function Fa(a){if(0===a.a)return Ka(a.b);var b=a.c[a.d[a.a-1]];if(0!==a.b.a&&u(Ga(a.b),b))return Ka(a.b);do{--a.a}while(0<a.a&&null===a.c[a.d[a.a-1]]);return b}function Ha(){this.d=Ja([0],33);this.e=[null,null];this.c=[0,0];this.a=0;this.f=32;this.b=0;this.h=!1;this.d[1]=1}function Ja(a,b){for(var c=Array(b),d=0;d<a.length;d++)c[d]=a[d];for(;d<b;d++)c[d]=0;return c}function Ia(a){for(var b=a.a;1<=b;--b)W(a,b);a.h=!0}function Ga(a){return a.e[a.d[1]]}function Ka(a){var b=a.d,c=a.e,d=a.c,e=b[1],f=c[e];0<a.a&&(b[1]=b[a.a],d[b[1]]=1,c[e]=null,d[e]=a.b,a.b=e,0<--a.a&&W(a,1));return f}function W(a,b){for(var c=a.d,d=a.e,e=a.c,f=b,g=c[f];;){var h=f<<1;h<a.a&&u(d[c[h+1]],d[c[h]])&&(h+=1);var k=c[h];if(h>a.a||u(d[g],d[k])){c[f]=g;e[g]=f;break}c[f]=k;e[k]=f;f=h}}function va(a,b){for(var c=a.d,d=a.e,e=a.c,f=b,g=c[f];;){var h=f>>1,k=c[h];if(0===h||u(d[k],d[g])){c[f]=g;e[g]=f;break}c[f]=k;e[k]=f;f=h}}function ma(){this.e=this.a=null;this.f=0;this.c=this.b=this.h=this.d=!1}function S(a){return a.e.c.b}function R(a){return a.e.a.b}this.libtess={GluTesselator:X,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}};X.prototype.gluDeleteTess=X.prototype.x;X.prototype.gluTessProperty=X.prototype.B;X.prototype.gluGetTessProperty=X.prototype.y;X.prototype.gluTessNormal=X.prototype.A;X.prototype.gluTessCallback=X.prototype.z;X.prototype.gluTessVertex=X.prototype.C;X.prototype.gluTessBeginPolygon=X.prototype.u;X.prototype.gluTessBeginContour=X.prototype.t;X.prototype.gluTessEndContour=X.prototype.v;X.prototype.gluTessEndPolygon=X.prototype.w;if(typeof module!=="undefined"){module.exports=this.libtess}},{}],270:[function(_dereq_,module,exports){"use strict";function GifWriter(buf,width,height,gopts){var p=0;var gopts=gopts===undefined?{}:gopts;var loop_count=gopts.loop===undefined?null:gopts.loop;var global_palette=gopts.palette===undefined?null:gopts.palette;if(width<=0||height<=0||width>65535||height>65535)throw new Error("Width/Height invalid.");function check_palette_and_num_colors(palette){var num_colors=palette.length;if(num_colors<2||num_colors>256||num_colors&num_colors-1){throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.")}return num_colors}buf[p++]=71;buf[p++]=73;buf[p++]=70;buf[p++]=56;buf[p++]=57;buf[p++]=97;var gp_num_colors_pow2=0;var background=0;if(global_palette!==null){var gp_num_colors=check_palette_and_num_colors(global_palette);while(gp_num_colors>>=1)++gp_num_colors_pow2;gp_num_colors=1<<gp_num_colors_pow2;--gp_num_colors_pow2;if(gopts.background!==undefined){background=gopts.background;if(background>=gp_num_colors)throw new Error("Background index out of range.");if(background===0)throw new Error("Background index explicitly passed as 0.")}}buf[p++]=width&255;buf[p++]=width>>8&255;buf[p++]=height&255;buf[p++]=height>>8&255;buf[p++]=(global_palette!==null?128:0)|gp_num_colors_pow2;buf[p++]=background;buf[p++]=0;if(global_palette!==null){for(var i=0,il=global_palette.length;i<il;++i){var rgb=global_palette[i];buf[p++]=rgb>>16&255;buf[p++]=rgb>>8&255;buf[p++]=rgb&255}}if(loop_count!==null){if(loop_count<0||loop_count>65535)throw new Error("Loop count invalid.");buf[p++]=33;buf[p++]=255;buf[p++]=11;buf[p++]=78;buf[p++]=69;buf[p++]=84;buf[p++]=83;buf[p++]=67;buf[p++]=65;buf[p++]=80;buf[p++]=69;buf[p++]=50;buf[p++]=46;buf[p++]=48;buf[p++]=3;buf[p++]=1;buf[p++]=loop_count&255;buf[p++]=loop_count>>8&255;buf[p++]=0}var ended=false;this.addFrame=function(x,y,w,h,indexed_pixels,opts){if(ended===true){--p;ended=false}opts=opts===undefined?{}:opts;if(x<0||y<0||x>65535||y>65535)throw new Error("x/y invalid.");if(w<=0||h<=0||w>65535||h>65535)throw new Error("Width/Height invalid.");if(indexed_pixels.length<w*h)throw new Error("Not enough pixels for the frame size.");var using_local_palette=true;var palette=opts.palette;if(palette===undefined||palette===null){using_local_palette=false;palette=global_palette}if(palette===undefined||palette===null)throw new Error("Must supply either a local or global palette.");var num_colors=check_palette_and_num_colors(palette);var min_code_size=0;while(num_colors>>=1)++min_code_size;num_colors=1<<min_code_size;var delay=opts.delay===undefined?0:opts.delay;var disposal=opts.disposal===undefined?0:opts.disposal;if(disposal<0||disposal>3)throw new Error("Disposal out of range.");var use_transparency=false;var transparent_index=0;if(opts.transparent!==undefined&&opts.transparent!==null){use_transparency=true;transparent_index=opts.transparent;if(transparent_index<0||transparent_index>=num_colors)throw new Error("Transparent color index.")}if(disposal!==0||use_transparency||delay!==0){buf[p++]=33;buf[p++]=249;buf[p++]=4;buf[p++]=disposal<<2|(use_transparency===true?1:0);buf[p++]=delay&255;buf[p++]=delay>>8&255;buf[p++]=transparent_index;buf[p++]=0}buf[p++]=44;buf[p++]=x&255;buf[p++]=x>>8&255;buf[p++]=y&255;buf[p++]=y>>8&255;buf[p++]=w&255;buf[p++]=w>>8&255;buf[p++]=h&255;buf[p++]=h>>8&255;buf[p++]=using_local_palette===true?128|min_code_size-1:0;if(using_local_palette===true){for(var i=0,il=palette.length;i<il;++i){var rgb=palette[i];buf[p++]=rgb>>16&255;buf[p++]=rgb>>8&255;buf[p++]=rgb&255}}p=GifWriterOutputLZWCodeStream(buf,p,min_code_size<2?2:min_code_size,indexed_pixels);return p};this.end=function(){if(ended===false){buf[p++]=59;ended=true}return p};this.getOutputBuffer=function(){return buf};this.setOutputBuffer=function(v){buf=v};this.getOutputBufferPosition=function(){return p};this.setOutputBufferPosition=function(v){p=v}}function GifWriterOutputLZWCodeStream(buf,p,min_code_size,index_stream){buf[p++]=min_code_size;var cur_subblock=p++;var clear_code=1<<min_code_size;var code_mask=clear_code-1;var eoi_code=clear_code+1;var next_code=eoi_code+1;var cur_code_size=min_code_size+1;var cur_shift=0;var cur=0;function emit_bytes_to_buffer(bit_block_size){while(cur_shift>=bit_block_size){buf[p++]=cur&255;cur>>=8;cur_shift-=8;if(p===cur_subblock+256){buf[cur_subblock]=255;cur_subblock=p++}}}function emit_code(c){cur|=c<<cur_shift;cur_shift+=cur_code_size;emit_bytes_to_buffer(8)}var ib_code=index_stream[0]&code_mask;var code_table={};emit_code(clear_code);for(var i=1,il=index_stream.length;i<il;++i){var k=index_stream[i]&code_mask;var cur_key=ib_code<<8|k;var cur_code=code_table[cur_key];if(cur_code===undefined){cur|=ib_code<<cur_shift;cur_shift+=cur_code_size;while(cur_shift>=8){buf[p++]=cur&255;cur>>=8;cur_shift-=8;if(p===cur_subblock+256){buf[cur_subblock]=255;cur_subblock=p++}}if(next_code===4096){emit_code(clear_code);next_code=eoi_code+1;cur_code_size=min_code_size+1;code_table={}}else{if(next_code>=1<<cur_code_size)++cur_code_size;code_table[cur_key]=next_code++}ib_code=k}else{ib_code=cur_code}}emit_code(ib_code);emit_code(eoi_code);emit_bytes_to_buffer(1);if(cur_subblock+1===p){buf[cur_subblock]=0}else{buf[cur_subblock]=p-cur_subblock-1;buf[p++]=0}return p}function GifReader(buf){var p=0;if(buf[p++]!==71||buf[p++]!==73||buf[p++]!==70||buf[p++]!==56||(buf[p++]+1&253)!==56||buf[p++]!==97){throw new Error("Invalid GIF 87a/89a header.")}var width=buf[p++]|buf[p++]<<8;var height=buf[p++]|buf[p++]<<8;var pf0=buf[p++];var global_palette_flag=pf0>>7;var num_global_colors_pow2=pf0&7;var num_global_colors=1<<num_global_colors_pow2+1;var background=buf[p++];buf[p++];var global_palette_offset=null;var global_palette_size=null;if(global_palette_flag){global_palette_offset=p;global_palette_size=num_global_colors;p+=num_global_colors*3}var no_eof=true;var frames=[];var delay=0;var transparent_index=null;var disposal=0;var loop_count=null;this.width=width;this.height=height;while(no_eof&&p<buf.length){switch(buf[p++]){case 33:switch(buf[p++]){case 255:if(buf[p]!==11||buf[p+1]==78&&buf[p+2]==69&&buf[p+3]==84&&buf[p+4]==83&&buf[p+5]==67&&buf[p+6]==65&&buf[p+7]==80&&buf[p+8]==69&&buf[p+9]==50&&buf[p+10]==46&&buf[p+11]==48&&buf[p+12]==3&&buf[p+13]==1&&buf[p+16]==0){p+=14;loop_count=buf[p++]|buf[p++]<<8;p++}else{p+=12;while(true){var block_size=buf[p++];if(!(block_size>=0))throw Error("Invalid block size");if(block_size===0)break;p+=block_size}}break;case 249:if(buf[p++]!==4||buf[p+4]!==0)throw new Error("Invalid graphics extension block.");var pf1=buf[p++];delay=buf[p++]|buf[p++]<<8;transparent_index=buf[p++];if((pf1&1)===0)transparent_index=null;disposal=pf1>>2&7;p++;break;case 254:while(true){var block_size=buf[p++];if(!(block_size>=0))throw Error("Invalid block size");if(block_size===0)break;p+=block_size}break;default:throw new Error("Unknown graphic control label: 0x"+buf[p-1].toString(16))}break;case 44:var x=buf[p++]|buf[p++]<<8;var y=buf[p++]|buf[p++]<<8;var w=buf[p++]|buf[p++]<<8;var h=buf[p++]|buf[p++]<<8;var pf2=buf[p++];var local_palette_flag=pf2>>7;var interlace_flag=pf2>>6&1;var num_local_colors_pow2=pf2&7;var num_local_colors=1<<num_local_colors_pow2+1;var palette_offset=global_palette_offset;var palette_size=global_palette_size;var has_local_palette=false;if(local_palette_flag){var has_local_palette=true;palette_offset=p;palette_size=num_local_colors;p+=num_local_colors*3}var data_offset=p;p++;while(true){var block_size=buf[p++];if(!(block_size>=0))throw Error("Invalid block size");if(block_size===0)break;p+=block_size}frames.push({x:x,y:y,width:w,height:h,has_local_palette:has_local_palette,palette_offset:palette_offset,palette_size:palette_size,data_offset:data_offset,data_length:p-data_offset,transparent_index:transparent_index,interlaced:!!interlace_flag,delay:delay,disposal:disposal});break;case 59:no_eof=false;break;default:throw new Error("Unknown gif block: 0x"+buf[p-1].toString(16));break}}this.numFrames=function(){return frames.length};this.loopCount=function(){return loop_count};this.frameInfo=function(frame_num){if(frame_num<0||frame_num>=frames.length)throw new Error("Frame index out of range.");return frames[frame_num]};this.decodeAndBlitFrameBGRA=function(frame_num,pixels){var frame=this.frameInfo(frame_num);var num_pixels=frame.width*frame.height;var index_stream=new Uint8Array(num_pixels);GifReaderLZWOutputIndexStream(buf,frame.data_offset,index_stream,num_pixels);var palette_offset=frame.palette_offset;var trans=frame.transparent_index;if(trans===null)trans=256;var framewidth=frame.width;var framestride=width-framewidth;var xleft=framewidth;var opbeg=(frame.y*width+frame.x)*4;var opend=((frame.y+frame.height)*width+frame.x)*4;var op=opbeg;var scanstride=framestride*4;if(frame.interlaced===true){scanstride+=width*4*7}var interlaceskip=8;for(var i=0,il=index_stream.length;i<il;++i){var index=index_stream[i];if(xleft===0){op+=scanstride;xleft=framewidth;if(op>=opend){scanstride=framestride*4+width*4*(interlaceskip-1);op=opbeg+(framewidth+framestride)*(interlaceskip<<1);interlaceskip>>=1}}if(index===trans){op+=4}else{var r=buf[palette_offset+index*3];var g=buf[palette_offset+index*3+1];var b=buf[palette_offset+index*3+2];pixels[op++]=b;pixels[op++]=g;pixels[op++]=r;pixels[op++]=255}--xleft}};this.decodeAndBlitFrameRGBA=function(frame_num,pixels){var frame=this.frameInfo(frame_num);var num_pixels=frame.width*frame.height;var index_stream=new Uint8Array(num_pixels);GifReaderLZWOutputIndexStream(buf,frame.data_offset,index_stream,num_pixels);var palette_offset=frame.palette_offset;var trans=frame.transparent_index;if(trans===null)trans=256;var framewidth=frame.width;var framestride=width-framewidth;var xleft=framewidth;var opbeg=(frame.y*width+frame.x)*4;var opend=((frame.y+frame.height)*width+frame.x)*4;var op=opbeg;var scanstride=framestride*4;if(frame.interlaced===true){scanstride+=width*4*7}var interlaceskip=8;for(var i=0,il=index_stream.length;i<il;++i){var index=index_stream[i];if(xleft===0){op+=scanstride;xleft=framewidth;if(op>=opend){scanstride=framestride*4+width*4*(interlaceskip-1);op=opbeg+(framewidth+framestride)*(interlaceskip<<1);interlaceskip>>=1}}if(index===trans){op+=4}else{var r=buf[palette_offset+index*3];var g=buf[palette_offset+index*3+1];var b=buf[palette_offset+index*3+2];pixels[op++]=r;pixels[op++]=g;pixels[op++]=b;pixels[op++]=255}--xleft}}}function GifReaderLZWOutputIndexStream(code_stream,p,output,output_length){var min_code_size=code_stream[p++];var clear_code=1<<min_code_size;var eoi_code=clear_code+1;var next_code=eoi_code+1;var cur_code_size=min_code_size+1;var code_mask=(1<<cur_code_size)-1;var cur_shift=0;var cur=0;var op=0;var subblock_size=code_stream[p++];var code_table=new Int32Array(4096);var prev_code=null;while(true){while(cur_shift<16){if(subblock_size===0)break;cur|=code_stream[p++]<<cur_shift;cur_shift+=8;if(subblock_size===1){subblock_size=code_stream[p++]}else{--subblock_size}}if(cur_shift<cur_code_size)break;var code=cur&code_mask;cur>>=cur_code_size;cur_shift-=cur_code_size;if(code===clear_code){next_code=eoi_code+1;cur_code_size=min_code_size+1;code_mask=(1<<cur_code_size)-1;prev_code=null;continue}else if(code===eoi_code){break}var chase_code=code<next_code?code:prev_code;var chase_length=0;var chase=chase_code;while(chase>clear_code){chase=code_table[chase]>>8;++chase_length}var k=chase;var op_end=op+chase_length+(chase_code!==code?1:0);if(op_end>output_length){console.log("Warning, gif stream longer than expected.");return}output[op++]=k;op+=chase_length;var b=op;if(chase_code!==code)output[op++]=k;chase=chase_code;while(chase_length--){chase=code_table[chase];output[--b]=chase&255;chase>>=8}if(prev_code!==null&&next_code<4096){code_table[next_code++]=prev_code<<8|k;if(next_code>=code_mask+1&&cur_code_size<12){++cur_code_size;code_mask=code_mask<<1|1}}prev_code=code}if(op!==output_length){console.log("Warning, gif stream shorter than expected.")}return output}try{exports.GifWriter=GifWriter;exports.GifReader=GifReader}catch(e){}},{}],271:[function(_dereq_,module,exports){(function(Buffer){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(exports):typeof define==="function"&&define.amd?define(["exports"],factory):factory(global.opentype={})})(this,function(exports){"use strict";if(!String.prototype.codePointAt){(function(){var defineProperty=function(){try{var object={};var $defineProperty=Object.defineProperty;var result=$defineProperty(object,object,object)&&$defineProperty}catch(error){}return result}();var codePointAt=function(position){if(this==null){throw TypeError()}var string=String(this);var size=string.length;var index=position?Number(position):0;if(index!=index){index=0}if(index<0||index>=size){return undefined}var first=string.charCodeAt(index);var second;if(first>=55296&&first<=56319&&size>index+1){second=string.charCodeAt(index+1);if(second>=56320&&second<=57343){return(first-55296)*1024+second-56320+65536}}return first};if(defineProperty){defineProperty(String.prototype,"codePointAt",{value:codePointAt,configurable:true,writable:true})}else{String.prototype.codePointAt=codePointAt}})()}var TINF_OK=0;var TINF_DATA_ERROR=-3;function Tree(){this.table=new Uint16Array(16);this.trans=new Uint16Array(288)}function Data(source,dest){this.source=source;this.sourceIndex=0;this.tag=0;this.bitcount=0;this.dest=dest;this.destLen=0;this.ltree=new Tree;this.dtree=new Tree}var sltree=new Tree;var sdtree=new Tree;var length_bits=new Uint8Array(30);var length_base=new Uint16Array(30);var dist_bits=new Uint8Array(30);var dist_base=new Uint16Array(30);var clcidx=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);var code_tree=new Tree;var lengths=new Uint8Array(288+32);function tinf_build_bits_base(bits,base,delta,first){var i,sum;for(i=0;i<delta;++i){bits[i]=0}for(i=0;i<30-delta;++i){bits[i+delta]=i/delta|0}for(sum=first,i=0;i<30;++i){base[i]=sum;sum+=1<<bits[i]}}function tinf_build_fixed_trees(lt,dt){var i;for(i=0;i<7;++i){lt.table[i]=0}lt.table[7]=24;lt.table[8]=152;lt.table[9]=112;for(i=0;i<24;++i){lt.trans[i]=256+i}for(i=0;i<144;++i){lt.trans[24+i]=i}for(i=0;i<8;++i){lt.trans[24+144+i]=280+i}for(i=0;i<112;++i){lt.trans[24+144+8+i]=144+i}for(i=0;i<5;++i){dt.table[i]=0}dt.table[5]=32;for(i=0;i<32;++i){dt.trans[i]=i}}var offs=new Uint16Array(16);function tinf_build_tree(t,lengths,off,num){var i,sum;for(i=0;i<16;++i){t.table[i]=0}for(i=0;i<num;++i){t.table[lengths[off+i]]++}t.table[0]=0;for(sum=0,i=0;i<16;++i){offs[i]=sum;sum+=t.table[i]}for(i=0;i<num;++i){if(lengths[off+i]){t.trans[offs[lengths[off+i]]++]=i}}}function tinf_getbit(d){if(!d.bitcount--){d.tag=d.source[d.sourceIndex++];d.bitcount=7}var bit=d.tag&1;d.tag>>>=1;return bit}function tinf_read_bits(d,num,base){if(!num){return base}while(d.bitcount<24){d.tag|=d.source[d.sourceIndex++]<<d.bitcount;d.bitcount+=8}var val=d.tag&65535>>>16-num;d.tag>>>=num;d.bitcount-=num;return val+base}function tinf_decode_symbol(d,t){while(d.bitcount<24){d.tag|=d.source[d.sourceIndex++]<<d.bitcount;d.bitcount+=8}var sum=0,cur=0,len=0;var tag=d.tag;do{cur=2*cur+(tag&1);tag>>>=1;++len;sum+=t.table[len];cur-=t.table[len]}while(cur>=0);d.tag=tag;d.bitcount-=len;return t.trans[sum+cur]}function tinf_decode_trees(d,lt,dt){var hlit,hdist,hclen;var i,num,length;hlit=tinf_read_bits(d,5,257);hdist=tinf_read_bits(d,5,1);hclen=tinf_read_bits(d,4,4);for(i=0;i<19;++i){lengths[i]=0}for(i=0;i<hclen;++i){var clen=tinf_read_bits(d,3,0);lengths[clcidx[i]]=clen}tinf_build_tree(code_tree,lengths,0,19);for(num=0;num<hlit+hdist;){var sym=tinf_decode_symbol(d,code_tree);switch(sym){case 16:var prev=lengths[num-1];for(length=tinf_read_bits(d,2,3);length;--length){lengths[num++]=prev}break;case 17:for(length=tinf_read_bits(d,3,3);length;--length){lengths[num++]=0}break;case 18:for(length=tinf_read_bits(d,7,11);length;--length){lengths[num++]=0}break;default:lengths[num++]=sym;break}}tinf_build_tree(lt,lengths,0,hlit);tinf_build_tree(dt,lengths,hlit,hdist)}function tinf_inflate_block_data(d,lt,dt){while(1){var sym=tinf_decode_symbol(d,lt);if(sym===256){return TINF_OK}if(sym<256){d.dest[d.destLen++]=sym}else{var length,dist,offs;var i;sym-=257;length=tinf_read_bits(d,length_bits[sym],length_base[sym]);dist=tinf_decode_symbol(d,dt);offs=d.destLen-tinf_read_bits(d,dist_bits[dist],dist_base[dist]);for(i=offs;i<offs+length;++i){d.dest[d.destLen++]=d.dest[i]}}}}function tinf_inflate_uncompressed_block(d){var length,invlength;var i;while(d.bitcount>8){d.sourceIndex--;d.bitcount-=8}length=d.source[d.sourceIndex+1];length=256*length+d.source[d.sourceIndex];invlength=d.source[d.sourceIndex+3];invlength=256*invlength+d.source[d.sourceIndex+2];if(length!==(~invlength&65535)){return TINF_DATA_ERROR}d.sourceIndex+=4;for(i=length;i;--i){d.dest[d.destLen++]=d.source[d.sourceIndex++]}d.bitcount=0;return TINF_OK}function tinf_uncompress(source,dest){var d=new Data(source,dest);var bfinal,btype,res;do{bfinal=tinf_getbit(d);btype=tinf_read_bits(d,2,0);switch(btype){case 0:res=tinf_inflate_uncompressed_block(d);break;case 1:res=tinf_inflate_block_data(d,sltree,sdtree);break;case 2:tinf_decode_trees(d,d.ltree,d.dtree);res=tinf_inflate_block_data(d,d.ltree,d.dtree);break;default:res=TINF_DATA_ERROR}if(res!==TINF_OK){throw new Error("Data error")}}while(!bfinal);if(d.destLen<d.dest.length){if(typeof d.dest.slice==="function"){return d.dest.slice(0,d.destLen)}else{return d.dest.subarray(0,d.destLen)}}return d.dest}tinf_build_fixed_trees(sltree,sdtree);tinf_build_bits_base(length_bits,length_base,4,3);tinf_build_bits_base(dist_bits,dist_base,2,1);length_bits[28]=0;length_base[28]=258;var tinyInflate=tinf_uncompress;function derive(v0,v1,v2,v3,t){return Math.pow(1-t,3)*v0+3*Math.pow(1-t,2)*t*v1+3*(1-t)*Math.pow(t,2)*v2+Math.pow(t,3)*v3}function BoundingBox(){this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN}BoundingBox.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)};BoundingBox.prototype.addPoint=function(x,y){if(typeof x==="number"){if(isNaN(this.x1)||isNaN(this.x2)){this.x1=x;this.x2=x}if(x<this.x1){this.x1=x}if(x>this.x2){this.x2=x}}if(typeof y==="number"){if(isNaN(this.y1)||isNaN(this.y2)){this.y1=y;this.y2=y}if(y<this.y1){this.y1=y}if(y>this.y2){this.y2=y}}};BoundingBox.prototype.addX=function(x){this.addPoint(x,null)};BoundingBox.prototype.addY=function(y){this.addPoint(null,y)};BoundingBox.prototype.addBezier=function(x0,y0,x1,y1,x2,y2,x,y){var this$1=this;var p0=[x0,y0];var p1=[x1,y1];var p2=[x2,y2];var p3=[x,y];this.addPoint(x0,y0);this.addPoint(x,y);for(var i=0;i<=1;i++){var b=6*p0[i]-12*p1[i]+6*p2[i];var a=-3*p0[i]+9*p1[i]-9*p2[i]+3*p3[i];var c=3*p1[i]-3*p0[i];if(a===0){if(b===0){continue}var t=-c/b;if(0<t&&t<1){if(i===0){this$1.addX(derive(p0[i],p1[i],p2[i],p3[i],t))}if(i===1){this$1.addY(derive(p0[i],p1[i],p2[i],p3[i],t))}}continue}var b2ac=Math.pow(b,2)-4*c*a;if(b2ac<0){continue}var t1=(-b+Math.sqrt(b2ac))/(2*a);if(0<t1&&t1<1){if(i===0){this$1.addX(derive(p0[i],p1[i],p2[i],p3[i],t1))}if(i===1){this$1.addY(derive(p0[i],p1[i],p2[i],p3[i],t1))}}var t2=(-b-Math.sqrt(b2ac))/(2*a);if(0<t2&&t2<1){if(i===0){this$1.addX(derive(p0[i],p1[i],p2[i],p3[i],t2))}if(i===1){this$1.addY(derive(p0[i],p1[i],p2[i],p3[i],t2))}}}};BoundingBox.prototype.addQuad=function(x0,y0,x1,y1,x,y){var cp1x=x0+2/3*(x1-x0);var cp1y=y0+2/3*(y1-y0);var cp2x=cp1x+1/3*(x-x0);var cp2y=cp1y+1/3*(y-y0);this.addBezier(x0,y0,cp1x,cp1y,cp2x,cp2y,x,y)};function Path(){this.commands=[];this.fill="black";this.stroke=null;this.strokeWidth=1}Path.prototype.moveTo=function(x,y){this.commands.push({type:"M",x:x,y:y})};Path.prototype.lineTo=function(x,y){this.commands.push({type:"L",x:x,y:y})};Path.prototype.curveTo=Path.prototype.bezierCurveTo=function(x1,y1,x2,y2,x,y){this.commands.push({type:"C",x1:x1,y1:y1,x2:x2,y2:y2,x:x,y:y})};Path.prototype.quadTo=Path.prototype.quadraticCurveTo=function(x1,y1,x,y){this.commands.push({type:"Q",x1:x1,y1:y1,x:x,y:y})};Path.prototype.close=Path.prototype.closePath=function(){this.commands.push({type:"Z"})};Path.prototype.extend=function(pathOrCommands){if(pathOrCommands.commands){pathOrCommands=pathOrCommands.commands}else if(pathOrCommands instanceof BoundingBox){var box=pathOrCommands;this.moveTo(box.x1,box.y1);this.lineTo(box.x2,box.y1);this.lineTo(box.x2,box.y2);this.lineTo(box.x1,box.y2);this.close();return}Array.prototype.push.apply(this.commands,pathOrCommands)};Path.prototype.getBoundingBox=function(){var this$1=this;var box=new BoundingBox;var startX=0;var startY=0;var prevX=0;var prevY=0;for(var i=0;i<this.commands.length;i++){var cmd=this$1.commands[i];switch(cmd.type){case"M":box.addPoint(cmd.x,cmd.y);startX=prevX=cmd.x;startY=prevY=cmd.y;break;case"L":box.addPoint(cmd.x,cmd.y);prevX=cmd.x;prevY=cmd.y;break;case"Q":box.addQuad(prevX,prevY,cmd.x1,cmd.y1,cmd.x,cmd.y);prevX=cmd.x;prevY=cmd.y;break;case"C":box.addBezier(prevX,prevY,cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y);prevX=cmd.x;prevY=cmd.y;break;case"Z":prevX=startX;prevY=startY;break;default:throw new Error("Unexpected path command "+cmd.type)}}if(box.isEmpty()){box.addPoint(0,0)}return box};Path.prototype.draw=function(ctx){var this$1=this;ctx.beginPath();for(var i=0;i<this.commands.length;i+=1){var cmd=this$1.commands[i];if(cmd.type==="M"){ctx.moveTo(cmd.x,cmd.y)}else if(cmd.type==="L"){ctx.lineTo(cmd.x,cmd.y)}else if(cmd.type==="C"){ctx.bezierCurveTo(cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y)}else if(cmd.type==="Q"){ctx.quadraticCurveTo(cmd.x1,cmd.y1,cmd.x,cmd.y)}else if(cmd.type==="Z"){ctx.closePath()}}if(this.fill){ctx.fillStyle=this.fill;ctx.fill()}if(this.stroke){ctx.strokeStyle=this.stroke;ctx.lineWidth=this.strokeWidth;ctx.stroke()}};Path.prototype.toPathData=function(decimalPlaces){var this$1=this;decimalPlaces=decimalPlaces!==undefined?decimalPlaces:2;function floatToString(v){if(Math.round(v)===v){return""+Math.round(v)}else{return v.toFixed(decimalPlaces)}}function packValues(){var arguments$1=arguments;var s="";for(var i=0;i<arguments.length;i+=1){var v=arguments$1[i];if(v>=0&&i>0){s+=" "}s+=floatToString(v)}return s}var d="";for(var i=0;i<this.commands.length;i+=1){var cmd=this$1.commands[i];if(cmd.type==="M"){d+="M"+packValues(cmd.x,cmd.y)}else if(cmd.type==="L"){d+="L"+packValues(cmd.x,cmd.y)}else if(cmd.type==="C"){d+="C"+packValues(cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y)}else if(cmd.type==="Q"){d+="Q"+packValues(cmd.x1,cmd.y1,cmd.x,cmd.y)}else if(cmd.type==="Z"){d+="Z"}}return d};Path.prototype.toSVG=function(decimalPlaces){var svg='<path d="';svg+=this.toPathData(decimalPlaces);svg+='"';if(this.fill&&this.fill!=="black"){if(this.fill===null){svg+=' fill="none"'}else{svg+=' fill="'+this.fill+'"'}}if(this.stroke){svg+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'}svg+="/>";return svg};Path.prototype.toDOMElement=function(decimalPlaces){var temporaryPath=this.toPathData(decimalPlaces);var newPath=document.createElementNS("http://www.w3.org/2000/svg","path");newPath.setAttribute("d",temporaryPath);return newPath};function fail(message){throw new Error(message)}function argument(predicate,message){if(!predicate){fail(message)}}var check={fail:fail,argument:argument,assert:argument};var LIMIT16=32768;var LIMIT32=2147483648;var decode={};var encode={};var sizeOf={};function constant(v){return function(){return v}}encode.BYTE=function(v){check.argument(v>=0&&v<=255,"Byte value should be between 0 and 255.");return[v]};sizeOf.BYTE=constant(1);encode.CHAR=function(v){return[v.charCodeAt(0)]};sizeOf.CHAR=constant(1);encode.CHARARRAY=function(v){var b=[];for(var i=0;i<v.length;i+=1){b[i]=v.charCodeAt(i)}return b};sizeOf.CHARARRAY=function(v){return v.length};encode.USHORT=function(v){return[v>>8&255,v&255]};sizeOf.USHORT=constant(2);encode.SHORT=function(v){if(v>=LIMIT16){v=-(2*LIMIT16-v)}return[v>>8&255,v&255]};sizeOf.SHORT=constant(2);encode.UINT24=function(v){return[v>>16&255,v>>8&255,v&255]};sizeOf.UINT24=constant(3);encode.ULONG=function(v){return[v>>24&255,v>>16&255,v>>8&255,v&255]};sizeOf.ULONG=constant(4);encode.LONG=function(v){if(v>=LIMIT32){v=-(2*LIMIT32-v)}return[v>>24&255,v>>16&255,v>>8&255,v&255]};sizeOf.LONG=constant(4);encode.FIXED=encode.ULONG;sizeOf.FIXED=sizeOf.ULONG;encode.FWORD=encode.SHORT;sizeOf.FWORD=sizeOf.SHORT;encode.UFWORD=encode.USHORT;sizeOf.UFWORD=sizeOf.USHORT;encode.LONGDATETIME=function(v){return[0,0,0,0,v>>24&255,v>>16&255,v>>8&255,v&255]};sizeOf.LONGDATETIME=constant(8);encode.TAG=function(v){check.argument(v.length===4,"Tag should be exactly 4 ASCII characters.");return[v.charCodeAt(0),v.charCodeAt(1),v.charCodeAt(2),v.charCodeAt(3)]};sizeOf.TAG=constant(4);encode.Card8=encode.BYTE;sizeOf.Card8=sizeOf.BYTE;encode.Card16=encode.USHORT;sizeOf.Card16=sizeOf.USHORT;encode.OffSize=encode.BYTE;sizeOf.OffSize=sizeOf.BYTE;encode.SID=encode.USHORT;sizeOf.SID=sizeOf.USHORT;encode.NUMBER=function(v){if(v>=-107&&v<=107){return[v+139]}else if(v>=108&&v<=1131){v=v-108;return[(v>>8)+247,v&255]}else if(v>=-1131&&v<=-108){v=-v-108;return[(v>>8)+251,v&255]}else if(v>=-32768&&v<=32767){return encode.NUMBER16(v)}else{return encode.NUMBER32(v)}};sizeOf.NUMBER=function(v){return encode.NUMBER(v).length};encode.NUMBER16=function(v){return[28,v>>8&255,v&255]};sizeOf.NUMBER16=constant(3);encode.NUMBER32=function(v){return[29,v>>24&255,v>>16&255,v>>8&255,v&255]};sizeOf.NUMBER32=constant(5);encode.REAL=function(v){var value=v.toString();var m=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(value);if(m){var epsilon=parseFloat("1e"+((m[2]?+m[2]:0)+m[1].length));value=(Math.round(v*epsilon)/epsilon).toString()}var nibbles="";for(var i=0,ii=value.length;i<ii;i+=1){var c=value[i];if(c==="e"){nibbles+=value[++i]==="-"?"c":"b"}else if(c==="."){nibbles+="a"}else if(c==="-"){nibbles+="e"}else{nibbles+=c}}nibbles+=nibbles.length&1?"f":"ff";var out=[30];for(var i$1=0,ii$1=nibbles.length;i$1<ii$1;i$1+=2){out.push(parseInt(nibbles.substr(i$1,2),16))}return out};sizeOf.REAL=function(v){return encode.REAL(v).length};encode.NAME=encode.CHARARRAY;sizeOf.NAME=sizeOf.CHARARRAY;encode.STRING=encode.CHARARRAY;sizeOf.STRING=sizeOf.CHARARRAY;decode.UTF8=function(data,offset,numBytes){var codePoints=[];var numChars=numBytes;for(var j=0;j<numChars;j++,offset+=1){codePoints[j]=data.getUint8(offset)}return String.fromCharCode.apply(null,codePoints)};decode.UTF16=function(data,offset,numBytes){var codePoints=[];var numChars=numBytes/2;for(var j=0;j<numChars;j++,offset+=2){codePoints[j]=data.getUint16(offset)}return String.fromCharCode.apply(null,codePoints)};encode.UTF16=function(v){var b=[];for(var i=0;i<v.length;i+=1){var codepoint=v.charCodeAt(i);b[b.length]=codepoint>>8&255;b[b.length]=codepoint&255}return b};sizeOf.UTF16=function(v){return v.length*2};var eightBitMacEncodings={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø"+"¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњ"+"јЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæø"+"ṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩ"+"άΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø"+"¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗ"+"ᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅ"+"ņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø"+"¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș"+"¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø"+"¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};decode.MACSTRING=function(dataView,offset,dataLength,encoding){var table=eightBitMacEncodings[encoding];if(table===undefined){return undefined}var result="";for(var i=0;i<dataLength;i++){var c=dataView.getUint8(offset+i);if(c<=127){result+=String.fromCharCode(c)}else{result+=table[c&127]}}return result};var macEncodingTableCache=typeof WeakMap==="function"&&new WeakMap;var macEncodingCacheKeys;var getMacEncodingTable=function(encoding){if(!macEncodingCacheKeys){macEncodingCacheKeys={};for(var e in eightBitMacEncodings){macEncodingCacheKeys[e]=new String(e)}}var cacheKey=macEncodingCacheKeys[encoding];if(cacheKey===undefined){return undefined}if(macEncodingTableCache){var cachedTable=macEncodingTableCache.get(cacheKey);if(cachedTable!==undefined){return cachedTable}}var decodingTable=eightBitMacEncodings[encoding];if(decodingTable===undefined){return undefined}var encodingTable={};for(var i=0;i<decodingTable.length;i++){encodingTable[decodingTable.charCodeAt(i)]=i+128}if(macEncodingTableCache){macEncodingTableCache.set(cacheKey,encodingTable)}return encodingTable};encode.MACSTRING=function(str,encoding){var table=getMacEncodingTable(encoding);if(table===undefined){return undefined}var result=[];for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c>=128){c=table[c];if(c===undefined){return undefined}}result[i]=c}return result};sizeOf.MACSTRING=function(str,encoding){var b=encode.MACSTRING(str,encoding);if(b!==undefined){return b.length}else{return 0}};function isByteEncodable(value){return value>=-128&&value<=127}function encodeVarDeltaRunAsZeroes(deltas,pos,result){var runLength=0;var numDeltas=deltas.length;while(pos<numDeltas&&runLength<64&&deltas[pos]===0){++pos;++runLength}result.push(128|runLength-1);return pos}function encodeVarDeltaRunAsBytes(deltas,offset,result){var runLength=0;var numDeltas=deltas.length;var pos=offset;while(pos<numDeltas&&runLength<64){var value=deltas[pos];if(!isByteEncodable(value)){break}if(value===0&&pos+1<numDeltas&&deltas[pos+1]===0){break}++pos;++runLength}result.push(runLength-1);for(var i=offset;i<pos;++i){result.push(deltas[i]+256&255)}return pos}function encodeVarDeltaRunAsWords(deltas,offset,result){var runLength=0;var numDeltas=deltas.length;var pos=offset;while(pos<numDeltas&&runLength<64){var value=deltas[pos];if(value===0){break}if(isByteEncodable(value)&&pos+1<numDeltas&&isByteEncodable(deltas[pos+1])){break}++pos;++runLength}result.push(64|runLength-1);for(var i=offset;i<pos;++i){var val=deltas[i];result.push(val+65536>>8&255,val+256&255)}return pos}encode.VARDELTAS=function(deltas){var pos=0;var result=[];while(pos<deltas.length){var value=deltas[pos];if(value===0){pos=encodeVarDeltaRunAsZeroes(deltas,pos,result)}else if(value>=-128&&value<=127){pos=encodeVarDeltaRunAsBytes(deltas,pos,result)}else{pos=encodeVarDeltaRunAsWords(deltas,pos,result)}}return result};encode.INDEX=function(l){var offset=1;var offsets=[offset];var data=[];for(var i=0;i<l.length;i+=1){var v=encode.OBJECT(l[i]);Array.prototype.push.apply(data,v);offset+=v.length;offsets.push(offset)}if(data.length===0){return[0,0]}var encodedOffsets=[];var offSize=1+Math.floor(Math.log(offset)/Math.log(2))/8|0;var offsetEncoder=[undefined,encode.BYTE,encode.USHORT,encode.UINT24,encode.ULONG][offSize];for(var i$1=0;i$1<offsets.length;i$1+=1){var encodedOffset=offsetEncoder(offsets[i$1]);Array.prototype.push.apply(encodedOffsets,encodedOffset)}return Array.prototype.concat(encode.Card16(l.length),encode.OffSize(offSize),encodedOffsets,data)};sizeOf.INDEX=function(v){return encode.INDEX(v).length};encode.DICT=function(m){var d=[];var keys=Object.keys(m);var length=keys.length;for(var i=0;i<length;i+=1){var k=parseInt(keys[i],0);var v=m[k];d=d.concat(encode.OPERAND(v.value,v.type));d=d.concat(encode.OPERATOR(k))}return d};sizeOf.DICT=function(m){return encode.DICT(m).length};encode.OPERATOR=function(v){if(v<1200){return[v]}else{return[12,v-1200]}};encode.OPERAND=function(v,type){var d=[];if(Array.isArray(type)){for(var i=0;i<type.length;i+=1){check.argument(v.length===type.length,"Not enough arguments given for type"+type);d=d.concat(encode.OPERAND(v[i],type[i]))}}else{if(type==="SID"){d=d.concat(encode.NUMBER(v))}else if(type==="offset"){d=d.concat(encode.NUMBER32(v))}else if(type==="number"){d=d.concat(encode.NUMBER(v))}else if(type==="real"){d=d.concat(encode.REAL(v))}else{throw new Error("Unknown operand type "+type)}}return d};encode.OP=encode.BYTE;sizeOf.OP=sizeOf.BYTE;var wmm=typeof WeakMap==="function"&&new WeakMap;encode.CHARSTRING=function(ops){if(wmm){var cachedValue=wmm.get(ops);if(cachedValue!==undefined){return cachedValue}}var d=[];var length=ops.length;for(var i=0;i<length;i+=1){var op=ops[i];d=d.concat(encode[op.type](op.value))}if(wmm){wmm.set(ops,d)}return d};sizeOf.CHARSTRING=function(ops){return encode.CHARSTRING(ops).length};encode.OBJECT=function(v){var encodingFunction=encode[v.type];check.argument(encodingFunction!==undefined,"No encoding function for type "+v.type);return encodingFunction(v.value)};sizeOf.OBJECT=function(v){var sizeOfFunction=sizeOf[v.type];check.argument(sizeOfFunction!==undefined,"No sizeOf function for type "+v.type);return sizeOfFunction(v.value)};encode.TABLE=function(table){var d=[];var length=table.fields.length;var subtables=[];var subtableOffsets=[];for(var i=0;i<length;i+=1){var field=table.fields[i];var encodingFunction=encode[field.type];check.argument(encodingFunction!==undefined,"No encoding function for field type "+field.type+" ("+field.name+")");var value=table[field.name];if(value===undefined){value=field.value}var bytes=encodingFunction(value);if(field.type==="TABLE"){subtableOffsets.push(d.length);d=d.concat([0,0]);subtables.push(bytes)}else{d=d.concat(bytes)}}for(var i$1=0;i$1<subtables.length;i$1+=1){var o=subtableOffsets[i$1];var offset=d.length;check.argument(offset<65536,"Table "+table.tableName+" too big.");d[o]=offset>>8;d[o+1]=offset&255;d=d.concat(subtables[i$1])}return d};sizeOf.TABLE=function(table){var numBytes=0;var length=table.fields.length;for(var i=0;i<length;i+=1){var field=table.fields[i];var sizeOfFunction=sizeOf[field.type];check.argument(sizeOfFunction!==undefined,"No sizeOf function for field type "+field.type+" ("+field.name+")");var value=table[field.name];if(value===undefined){value=field.value}numBytes+=sizeOfFunction(value);if(field.type==="TABLE"){numBytes+=2}}return numBytes};encode.RECORD=encode.TABLE;sizeOf.RECORD=sizeOf.TABLE;encode.LITERAL=function(v){return v};sizeOf.LITERAL=function(v){return v.length};function Table(tableName,fields,options){var this$1=this;for(var i=0;i<fields.length;i+=1){var field=fields[i];this$1[field.name]=field.value}this.tableName=tableName;this.fields=fields;if(options){var optionKeys=Object.keys(options);for(var i$1=0;i$1<optionKeys.length;i$1+=1){var k=optionKeys[i$1];var v=options[k];if(this$1[k]!==undefined){this$1[k]=v}}}}Table.prototype.encode=function(){return encode.TABLE(this)};Table.prototype.sizeOf=function(){return sizeOf.TABLE(this)};function ushortList(itemName,list,count){if(count===undefined){count=list.length}var fields=new Array(list.length+1);fields[0]={name:itemName+"Count",type:"USHORT",value:count};for(var i=0;i<list.length;i++){fields[i+1]={name:itemName+i,type:"USHORT",value:list[i]}}return fields}function tableList(itemName,records,itemCallback){var count=records.length;var fields=new Array(count+1);fields[0]={name:itemName+"Count",type:"USHORT",value:count};for(var i=0;i<count;i++){fields[i+1]={name:itemName+i,type:"TABLE",value:itemCallback(records[i],i)}}return fields}function recordList(itemName,records,itemCallback){var count=records.length;var fields=[];fields[0]={name:itemName+"Count",type:"USHORT",value:count};for(var i=0;i<count;i++){fields=fields.concat(itemCallback(records[i],i))}return fields}function Coverage(coverageTable){if(coverageTable.format===1){Table.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(ushortList("glyph",coverageTable.glyphs)))}else{check.assert(false,"Can't create coverage table format 2 yet.")}}Coverage.prototype=Object.create(Table.prototype);Coverage.prototype.constructor=Coverage;function ScriptList(scriptListTable){Table.call(this,"scriptListTable",recordList("scriptRecord",scriptListTable,function(scriptRecord,i){var script=scriptRecord.script;var defaultLangSys=script.defaultLangSys;check.assert(!!defaultLangSys,"Unable to write GSUB: script "+scriptRecord.tag+" has no default language system.");return[{name:"scriptTag"+i,type:"TAG",value:scriptRecord.tag},{name:"script"+i,type:"TABLE",value:new Table("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Table("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:defaultLangSys.reqFeatureIndex}].concat(ushortList("featureIndex",defaultLangSys.featureIndexes)))}].concat(recordList("langSys",script.langSysRecords,function(langSysRecord,i){var langSys=langSysRecord.langSys;return[{name:"langSysTag"+i,type:"TAG",value:langSysRecord.tag},{name:"langSys"+i,type:"TABLE",value:new Table("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:langSys.reqFeatureIndex}].concat(ushortList("featureIndex",langSys.featureIndexes)))}]})))}]}))}ScriptList.prototype=Object.create(Table.prototype);ScriptList.prototype.constructor=ScriptList;function FeatureList(featureListTable){Table.call(this,"featureListTable",recordList("featureRecord",featureListTable,function(featureRecord,i){var feature=featureRecord.feature;return[{name:"featureTag"+i,type:"TAG",value:featureRecord.tag},{name:"feature"+i,type:"TABLE",value:new Table("featureTable",[{name:"featureParams",type:"USHORT",value:feature.featureParams}].concat(ushortList("lookupListIndex",feature.lookupListIndexes)))}]}))}FeatureList.prototype=Object.create(Table.prototype);FeatureList.prototype.constructor=FeatureList;function LookupList(lookupListTable,subtableMakers){Table.call(this,"lookupListTable",tableList("lookup",lookupListTable,function(lookupTable){var subtableCallback=subtableMakers[lookupTable.lookupType];check.assert(!!subtableCallback,"Unable to write GSUB lookup type "+lookupTable.lookupType+" tables.");return new Table("lookupTable",[{name:"lookupType",type:"USHORT",value:lookupTable.lookupType},{name:"lookupFlag",type:"USHORT",value:lookupTable.lookupFlag}].concat(tableList("subtable",lookupTable.subtables,subtableCallback)))}))}LookupList.prototype=Object.create(Table.prototype);LookupList.prototype.constructor=LookupList;var table={Table:Table,Record:Table,Coverage:Coverage,ScriptList:ScriptList,FeatureList:FeatureList,LookupList:LookupList,ushortList:ushortList,tableList:tableList,recordList:recordList};function getByte(dataView,offset){return dataView.getUint8(offset)}function getUShort(dataView,offset){return dataView.getUint16(offset,false)}function getShort(dataView,offset){return dataView.getInt16(offset,false)}function getULong(dataView,offset){return dataView.getUint32(offset,false)}function getFixed(dataView,offset){var decimal=dataView.getInt16(offset,false);var fraction=dataView.getUint16(offset+2,false);return decimal+fraction/65535}function getTag(dataView,offset){var tag="";for(var i=offset;i<offset+4;i+=1){tag+=String.fromCharCode(dataView.getInt8(i))}return tag}function getOffset(dataView,offset,offSize){var v=0;for(var i=0;i<offSize;i+=1){v<<=8;v+=dataView.getUint8(offset+i)}return v}function getBytes(dataView,startOffset,endOffset){var bytes=[];for(var i=startOffset;i<endOffset;i+=1){bytes.push(dataView.getUint8(i))}return bytes}function bytesToString(bytes){var s="";for(var i=0;i<bytes.length;i+=1){s+=String.fromCharCode(bytes[i])}return s}var typeOffsets={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function Parser(data,offset){this.data=data;this.offset=offset;this.relativeOffset=0}Parser.prototype.parseByte=function(){var v=this.data.getUint8(this.offset+this.relativeOffset);this.relativeOffset+=1;return v};Parser.prototype.parseChar=function(){var v=this.data.getInt8(this.offset+this.relativeOffset);this.relativeOffset+=1;return v};Parser.prototype.parseCard8=Parser.prototype.parseByte;Parser.prototype.parseUShort=function(){var v=this.data.getUint16(this.offset+this.relativeOffset);this.relativeOffset+=2;return v};Parser.prototype.parseCard16=Parser.prototype.parseUShort;Parser.prototype.parseSID=Parser.prototype.parseUShort;Parser.prototype.parseOffset16=Parser.prototype.parseUShort;Parser.prototype.parseShort=function(){var v=this.data.getInt16(this.offset+this.relativeOffset);this.relativeOffset+=2;return v};Parser.prototype.parseF2Dot14=function(){var v=this.data.getInt16(this.offset+this.relativeOffset)/16384;this.relativeOffset+=2;return v};Parser.prototype.parseULong=function(){var v=getULong(this.data,this.offset+this.relativeOffset);this.relativeOffset+=4;return v};Parser.prototype.parseOffset32=Parser.prototype.parseULong;Parser.prototype.parseFixed=function(){var v=getFixed(this.data,this.offset+this.relativeOffset);this.relativeOffset+=4;return v};Parser.prototype.parseString=function(length){var dataView=this.data;var offset=this.offset+this.relativeOffset;var string="";this.relativeOffset+=length;for(var i=0;i<length;i++){string+=String.fromCharCode(dataView.getUint8(offset+i))}return string};Parser.prototype.parseTag=function(){return this.parseString(4)};Parser.prototype.parseLongDateTime=function(){var v=getULong(this.data,this.offset+this.relativeOffset+4);v-=2082844800;this.relativeOffset+=8;return v};Parser.prototype.parseVersion=function(minorBase){var major=getUShort(this.data,this.offset+this.relativeOffset);var minor=getUShort(this.data,this.offset+this.relativeOffset+2);this.relativeOffset+=4;if(minorBase===undefined){minorBase=4096}return major+minor/minorBase/10};Parser.prototype.skip=function(type,amount){if(amount===undefined){amount=1}this.relativeOffset+=typeOffsets[type]*amount};Parser.prototype.parseULongList=function(count){if(count===undefined){count=this.parseULong()}var offsets=new Array(count);var dataView=this.data;var offset=this.offset+this.relativeOffset;for(var i=0;i<count;i++){offsets[i]=dataView.getUint32(offset);offset+=4}this.relativeOffset+=count*4;return offsets};Parser.prototype.parseOffset16List=Parser.prototype.parseUShortList=function(count){if(count===undefined){count=this.parseUShort()}var offsets=new Array(count);var dataView=this.data;var offset=this.offset+this.relativeOffset;for(var i=0;i<count;i++){offsets[i]=dataView.getUint16(offset);offset+=2}this.relativeOffset+=count*2;return offsets};Parser.prototype.parseShortList=function(count){var list=new Array(count);var dataView=this.data;var offset=this.offset+this.relativeOffset;for(var i=0;i<count;i++){list[i]=dataView.getInt16(offset);offset+=2}this.relativeOffset+=count*2;return list};Parser.prototype.parseByteList=function(count){var list=new Array(count);var dataView=this.data;var offset=this.offset+this.relativeOffset;for(var i=0;i<count;i++){list[i]=dataView.getUint8(offset++)}this.relativeOffset+=count;return list};Parser.prototype.parseList=function(count,itemCallback){var this$1=this;if(!itemCallback){itemCallback=count;count=this.parseUShort()}var list=new Array(count);for(var i=0;i<count;i++){list[i]=itemCallback.call(this$1)}return list};Parser.prototype.parseList32=function(count,itemCallback){var this$1=this;if(!itemCallback){itemCallback=count;count=this.parseULong()}var list=new Array(count);for(var i=0;i<count;i++){list[i]=itemCallback.call(this$1)}return list};Parser.prototype.parseRecordList=function(count,recordDescription){var this$1=this;if(!recordDescription){recordDescription=count;count=this.parseUShort()}var records=new Array(count);var fields=Object.keys(recordDescription);for(var i=0;i<count;i++){var rec={};for(var j=0;j<fields.length;j++){var fieldName=fields[j];var fieldType=recordDescription[fieldName];rec[fieldName]=fieldType.call(this$1)}records[i]=rec}return records};Parser.prototype.parseRecordList32=function(count,recordDescription){var this$1=this;if(!recordDescription){recordDescription=count;count=this.parseULong()}var records=new Array(count);var fields=Object.keys(recordDescription);for(var i=0;i<count;i++){var rec={};for(var j=0;j<fields.length;j++){var fieldName=fields[j];var fieldType=recordDescription[fieldName];rec[fieldName]=fieldType.call(this$1)}records[i]=rec}return records};Parser.prototype.parseStruct=function(description){var this$1=this;if(typeof description==="function"){return description.call(this)}else{var fields=Object.keys(description);var struct={};for(var j=0;j<fields.length;j++){var fieldName=fields[j];var fieldType=description[fieldName];struct[fieldName]=fieldType.call(this$1)}return struct}};Parser.prototype.parseValueRecord=function(valueFormat){if(valueFormat===undefined){valueFormat=this.parseUShort()}if(valueFormat===0){return}var valueRecord={};if(valueFormat&1){valueRecord.xPlacement=this.parseShort()}if(valueFormat&2){valueRecord.yPlacement=this.parseShort()}if(valueFormat&4){valueRecord.xAdvance=this.parseShort()}if(valueFormat&8){valueRecord.yAdvance=this.parseShort()}if(valueFormat&16){valueRecord.xPlaDevice=undefined;this.parseShort()}if(valueFormat&32){valueRecord.yPlaDevice=undefined;this.parseShort()}if(valueFormat&64){valueRecord.xAdvDevice=undefined;this.parseShort()}if(valueFormat&128){valueRecord.yAdvDevice=undefined;this.parseShort()}return valueRecord};Parser.prototype.parseValueRecordList=function(){var this$1=this;var valueFormat=this.parseUShort();var valueCount=this.parseUShort();var values=new Array(valueCount);for(var i=0;i<valueCount;i++){values[i]=this$1.parseValueRecord(valueFormat)}return values};Parser.prototype.parsePointer=function(description){var structOffset=this.parseOffset16();if(structOffset>0){return new Parser(this.data,this.offset+structOffset).parseStruct(description)}return undefined};Parser.prototype.parsePointer32=function(description){var structOffset=this.parseOffset32();if(structOffset>0){return new Parser(this.data,this.offset+structOffset).parseStruct(description)}return undefined};Parser.prototype.parseListOfLists=function(itemCallback){var this$1=this;var offsets=this.parseOffset16List();var count=offsets.length;var relativeOffset=this.relativeOffset;var list=new Array(count);for(var i=0;i<count;i++){var start=offsets[i];if(start===0){list[i]=undefined;continue}this$1.relativeOffset=start;if(itemCallback){var subOffsets=this$1.parseOffset16List();var subList=new Array(subOffsets.length);for(var j=0;j<subOffsets.length;j++){this$1.relativeOffset=start+subOffsets[j];subList[j]=itemCallback.call(this$1)}list[i]=subList}else{list[i]=this$1.parseUShortList()}}this.relativeOffset=relativeOffset;return list};Parser.prototype.parseCoverage=function(){var this$1=this;var startOffset=this.offset+this.relativeOffset;var format=this.parseUShort();var count=this.parseUShort();if(format===1){return{format:1,glyphs:this.parseUShortList(count)}}else if(format===2){var ranges=new Array(count);for(var i=0;i<count;i++){ranges[i]={start:this$1.parseUShort(),end:this$1.parseUShort(),index:this$1.parseUShort()}}return{format:2,ranges:ranges}}throw new Error("0x"+startOffset.toString(16)+": Coverage format must be 1 or 2.")};Parser.prototype.parseClassDef=function(){var startOffset=this.offset+this.relativeOffset;var format=this.parseUShort();if(format===1){return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()}}else if(format===2){return{format:2,ranges:this.parseRecordList({start:Parser.uShort,end:Parser.uShort,classId:Parser.uShort})}}throw new Error("0x"+startOffset.toString(16)+": ClassDef format must be 1 or 2.")};Parser.list=function(count,itemCallback){return function(){return this.parseList(count,itemCallback)}};Parser.list32=function(count,itemCallback){return function(){return this.parseList32(count,itemCallback)}};Parser.recordList=function(count,recordDescription){return function(){return this.parseRecordList(count,recordDescription)}};Parser.recordList32=function(count,recordDescription){return function(){return this.parseRecordList32(count,recordDescription)}};Parser.pointer=function(description){return function(){return this.parsePointer(description)}};Parser.pointer32=function(description){return function(){return this.parsePointer32(description)}};Parser.tag=Parser.prototype.parseTag;Parser.byte=Parser.prototype.parseByte;Parser.uShort=Parser.offset16=Parser.prototype.parseUShort;Parser.uShortList=Parser.prototype.parseUShortList;Parser.uLong=Parser.offset32=Parser.prototype.parseULong;Parser.uLongList=Parser.prototype.parseULongList;Parser.struct=Parser.prototype.parseStruct;Parser.coverage=Parser.prototype.parseCoverage;Parser.classDef=Parser.prototype.parseClassDef;var langSysTable={reserved:Parser.uShort,reqFeatureIndex:Parser.uShort,featureIndexes:Parser.uShortList};Parser.prototype.parseScriptList=function(){return this.parsePointer(Parser.recordList({tag:Parser.tag,script:Parser.pointer({defaultLangSys:Parser.pointer(langSysTable),langSysRecords:Parser.recordList({tag:Parser.tag,langSys:Parser.pointer(langSysTable)})})}))||[]};Parser.prototype.parseFeatureList=function(){return this.parsePointer(Parser.recordList({tag:Parser.tag,feature:Parser.pointer({featureParams:Parser.offset16,lookupListIndexes:Parser.uShortList})}))||[]};Parser.prototype.parseLookupList=function(lookupTableParsers){return this.parsePointer(Parser.list(Parser.pointer(function(){var lookupType=this.parseUShort();check.argument(1<=lookupType&&lookupType<=9,"GPOS/GSUB lookup type "+lookupType+" unknown.");var lookupFlag=this.parseUShort();var useMarkFilteringSet=lookupFlag&16;return{lookupType:lookupType,lookupFlag:lookupFlag,subtables:this.parseList(Parser.pointer(lookupTableParsers[lookupType])),markFilteringSet:useMarkFilteringSet?this.parseUShort():undefined}})))||[]};Parser.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var majorVersion=this.parseUShort();var minorVersion=this.parseUShort();check.argument(majorVersion===1&&minorVersion<1,"GPOS/GSUB feature variations table unknown.");var featureVariations=this.parseRecordList32({conditionSetOffset:Parser.offset32,featureTableSubstitutionOffset:Parser.offset32});return featureVariations})||[]};var parse={getByte:getByte,getCard8:getByte,getUShort:getUShort,getCard16:getUShort,getShort:getShort,getULong:getULong,getFixed:getFixed,getTag:getTag,getOffset:getOffset,getBytes:getBytes,bytesToString:bytesToString,Parser:Parser};function parseCmapTableFormat12(cmap,p){p.parseUShort();cmap.length=p.parseULong();cmap.language=p.parseULong();var groupCount;cmap.groupCount=groupCount=p.parseULong();cmap.glyphIndexMap={};for(var i=0;i<groupCount;i+=1){var startCharCode=p.parseULong();var endCharCode=p.parseULong();var startGlyphId=p.parseULong();for(var c=startCharCode;c<=endCharCode;c+=1){cmap.glyphIndexMap[c]=startGlyphId;startGlyphId++}}}function parseCmapTableFormat4(cmap,p,data,start,offset){cmap.length=p.parseUShort();cmap.language=p.parseUShort();var segCount;cmap.segCount=segCount=p.parseUShort()>>1;p.skip("uShort",3);cmap.glyphIndexMap={};var endCountParser=new parse.Parser(data,start+offset+14);var startCountParser=new parse.Parser(data,start+offset+16+segCount*2);var idDeltaParser=new parse.Parser(data,start+offset+16+segCount*4);var idRangeOffsetParser=new parse.Parser(data,start+offset+16+segCount*6);var glyphIndexOffset=start+offset+16+segCount*8;for(var i=0;i<segCount-1;i+=1){var glyphIndex=void 0;var endCount=endCountParser.parseUShort();var startCount=startCountParser.parseUShort();var idDelta=idDeltaParser.parseShort();var idRangeOffset=idRangeOffsetParser.parseUShort();for(var c=startCount;c<=endCount;c+=1){if(idRangeOffset!==0){glyphIndexOffset=idRangeOffsetParser.offset+idRangeOffsetParser.relativeOffset-2;glyphIndexOffset+=idRangeOffset;glyphIndexOffset+=(c-startCount)*2;glyphIndex=parse.getUShort(data,glyphIndexOffset);if(glyphIndex!==0){glyphIndex=glyphIndex+idDelta&65535}}else{glyphIndex=c+idDelta&65535}cmap.glyphIndexMap[c]=glyphIndex}}}function parseCmapTable(data,start){var cmap={};cmap.version=parse.getUShort(data,start);check.argument(cmap.version===0,"cmap table version should be 0.");cmap.numTables=parse.getUShort(data,start+2);var offset=-1;for(var i=cmap.numTables-1;i>=0;i-=1){var platformId=parse.getUShort(data,start+4+i*8);var encodingId=parse.getUShort(data,start+4+i*8+2);if(platformId===3&&(encodingId===0||encodingId===1||encodingId===10)||platformId===0&&(encodingId===0||encodingId===1||encodingId===2||encodingId===3||encodingId===4)){offset=parse.getULong(data,start+4+i*8+4);break}}if(offset===-1){throw new Error("No valid cmap sub-tables found.")}var p=new parse.Parser(data,start+offset);cmap.format=p.parseUShort();if(cmap.format===12){parseCmapTableFormat12(cmap,p)}else if(cmap.format===4){parseCmapTableFormat4(cmap,p,data,start,offset)}else{throw new Error("Only format 4 and 12 cmap tables are supported (found format "+cmap.format+").")}return cmap}function addSegment(t,code,glyphIndex){t.segments.push({end:code,start:code,delta:-(code-glyphIndex),offset:0,glyphIndex:glyphIndex})}function addTerminatorSegment(t){t.segments.push({end:65535,start:65535,delta:1,offset:0})}function makeCmapTable(glyphs){var isPlan0Only=true;var i;for(i=glyphs.length-1;i>0;i-=1){var g=glyphs.get(i);if(g.unicode>65535){console.log("Adding CMAP format 12 (needed!)");isPlan0Only=false;break}}var cmapTable=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:isPlan0Only?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:isPlan0Only?12:12+8}];if(!isPlan0Only){cmapTable=cmapTable.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])}cmapTable=cmapTable.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var t=new table.Table("cmap",cmapTable);t.segments=[];for(i=0;i<glyphs.length;i+=1){var glyph=glyphs.get(i);for(var j=0;j<glyph.unicodes.length;j+=1){addSegment(t,glyph.unicodes[j],i)}t.segments=t.segments.sort(function(a,b){return a.start-b.start})}addTerminatorSegment(t);var segCount=t.segments.length;var segCountToRemove=0;var endCounts=[];var startCounts=[];var idDeltas=[];var idRangeOffsets=[];var glyphIds=[];var cmap12Groups=[];for(i=0;i<segCount;i+=1){var segment=t.segments[i];if(segment.end<=65535&&segment.start<=65535){endCounts=endCounts.concat({name:"end_"+i,type:"USHORT",value:segment.end});startCounts=startCounts.concat({name:"start_"+i,type:"USHORT",value:segment.start});idDeltas=idDeltas.concat({name:"idDelta_"+i,type:"SHORT",value:segment.delta});idRangeOffsets=idRangeOffsets.concat({name:"idRangeOffset_"+i,type:"USHORT",value:segment.offset});if(segment.glyphId!==undefined){glyphIds=glyphIds.concat({name:"glyph_"+i,type:"USHORT",value:segment.glyphId})}}else{segCountToRemove+=1}if(!isPlan0Only&&segment.glyphIndex!==undefined){cmap12Groups=cmap12Groups.concat({name:"cmap12Start_"+i,type:"ULONG",value:segment.start});cmap12Groups=cmap12Groups.concat({name:"cmap12End_"+i,type:"ULONG",value:segment.end});cmap12Groups=cmap12Groups.concat({name:"cmap12Glyph_"+i,type:"ULONG",value:segment.glyphIndex})}}t.segCountX2=(segCount-segCountToRemove)*2;t.searchRange=Math.pow(2,Math.floor(Math.log(segCount-segCountToRemove)/Math.log(2)))*2;t.entrySelector=Math.log(t.searchRange/2)/Math.log(2);t.rangeShift=t.segCountX2-t.searchRange;t.fields=t.fields.concat(endCounts);t.fields.push({name:"reservedPad",type:"USHORT",value:0});t.fields=t.fields.concat(startCounts);t.fields=t.fields.concat(idDeltas);t.fields=t.fields.concat(idRangeOffsets);t.fields=t.fields.concat(glyphIds);t.cmap4Length=14+endCounts.length*2+2+startCounts.length*2+idDeltas.length*2+idRangeOffsets.length*2+glyphIds.length*2;if(!isPlan0Only){var cmap12Length=16+cmap12Groups.length*4;t.cmap12Offset=12+2*2+4+t.cmap4Length;t.fields=t.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:cmap12Length},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:cmap12Groups.length/3}]);t.fields=t.fields.concat(cmap12Groups)}return t}var cmap={parse:parseCmapTable,make:makeCmapTable};var cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"];var cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"];var cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"];var standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function DefaultEncoding(font){this.font=font}DefaultEncoding.prototype.charToGlyphIndex=function(c){var code=c.codePointAt(0);var glyphs=this.font.glyphs;if(glyphs){for(var i=0;i<glyphs.length;i+=1){var glyph=glyphs.get(i);for(var j=0;j<glyph.unicodes.length;j+=1){if(glyph.unicodes[j]===code){return i}}}}return null};function CmapEncoding(cmap){this.cmap=cmap}CmapEncoding.prototype.charToGlyphIndex=function(c){return this.cmap.glyphIndexMap[c.codePointAt(0)]||0};function CffEncoding(encoding,charset){this.encoding=encoding;this.charset=charset}CffEncoding.prototype.charToGlyphIndex=function(s){var code=s.codePointAt(0);var charName=this.encoding[code];return this.charset.indexOf(charName)};function GlyphNames(post){var this$1=this;switch(post.version){case 1:this.names=standardNames.slice();break;case 2:this.names=new Array(post.numberOfGlyphs);for(var i=0;i<post.numberOfGlyphs;i++){if(post.glyphNameIndex[i]<standardNames.length){this$1.names[i]=standardNames[post.glyphNameIndex[i]]}else{this$1.names[i]=post.names[post.glyphNameIndex[i]-standardNames.length]}}break;case 2.5:this.names=new Array(post.numberOfGlyphs);for(var i$1=0;i$1<post.numberOfGlyphs;i$1++){this$1.names[i$1]=standardNames[i$1+post.glyphNameIndex[i$1]]}break;case 3:this.names=[];break;default:this.names=[];break}}GlyphNames.prototype.nameToGlyphIndex=function(name){return this.names.indexOf(name)};GlyphNames.prototype.glyphIndexToName=function(gid){return this.names[gid]};function addGlyphNames(font){var glyph;var glyphIndexMap=font.tables.cmap.glyphIndexMap;var charCodes=Object.keys(glyphIndexMap);for(var i=0;i<charCodes.length;i+=1){var c=charCodes[i];var glyphIndex=glyphIndexMap[c];glyph=font.glyphs.get(glyphIndex);glyph.addUnicode(parseInt(c))}for(var i$1=0;i$1<font.glyphs.length;i$1+=1){glyph=font.glyphs.get(i$1);if(font.cffEncoding){if(font.isCIDFont){glyph.name="gid"+i$1}else{glyph.name=font.cffEncoding.charset[i$1]}}else if(font.glyphNames.names){glyph.name=font.glyphNames.glyphIndexToName(i$1)}}}function line(ctx,x1,y1,x2,y2){ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke()}var draw={line:line};function getPathDefinition(glyph,path){var _path=path||new Path;return{configurable:true,get:function(){if(typeof _path==="function"){_path=_path()}return _path},set:function(p){_path=p}}}function Glyph(options){this.bindConstructorValues(options)}Glyph.prototype.bindConstructorValues=function(options){this.index=options.index||0;this.name=options.name||null;this.unicode=options.unicode||undefined;this.unicodes=options.unicodes||options.unicode!==undefined?[options.unicode]:[];if(options.xMin){this.xMin=options.xMin}if(options.yMin){this.yMin=options.yMin}if(options.xMax){this.xMax=options.xMax}if(options.yMax){this.yMax=options.yMax}if(options.advanceWidth){this.advanceWidth=options.advanceWidth}Object.defineProperty(this,"path",getPathDefinition(this,options.path))};Glyph.prototype.addUnicode=function(unicode){if(this.unicodes.length===0){this.unicode=unicode}this.unicodes.push(unicode)};Glyph.prototype.getBoundingBox=function(){return this.path.getBoundingBox()};Glyph.prototype.getPath=function(x,y,fontSize,options,font){x=x!==undefined?x:0;y=y!==undefined?y:0;fontSize=fontSize!==undefined?fontSize:72;var commands;var hPoints;if(!options){options={}}var xScale=options.xScale;var yScale=options.yScale;if(options.hinting&&font&&font.hinting){hPoints=this.path&&font.hinting.exec(this,fontSize)}if(hPoints){commands=font.hinting.getCommands(hPoints);x=Math.round(x);y=Math.round(y);xScale=yScale=1}else{commands=this.path.commands;var scale=1/this.path.unitsPerEm*fontSize;if(xScale===undefined){xScale=scale}if(yScale===undefined){yScale=scale}}var p=new Path;for(var i=0;i<commands.length;i+=1){var cmd=commands[i];if(cmd.type==="M"){p.moveTo(x+cmd.x*xScale,y+-cmd.y*yScale)}else if(cmd.type==="L"){p.lineTo(x+cmd.x*xScale,y+-cmd.y*yScale)}else if(cmd.type==="Q"){p.quadraticCurveTo(x+cmd.x1*xScale,y+-cmd.y1*yScale,x+cmd.x*xScale,y+-cmd.y*yScale)}else if(cmd.type==="C"){p.curveTo(x+cmd.x1*xScale,y+-cmd.y1*yScale,x+cmd.x2*xScale,y+-cmd.y2*yScale,x+cmd.x*xScale,y+-cmd.y*yScale)}else if(cmd.type==="Z"){p.closePath()}}return p};Glyph.prototype.getContours=function(){var this$1=this;if(this.points===undefined){return[]}var contours=[];var currentContour=[];for(var i=0;i<this.points.length;i+=1){var pt=this$1.points[i];currentContour.push(pt);if(pt.lastPointOfContour){contours.push(currentContour);currentContour=[]}}check.argument(currentContour.length===0,"There are still points left in the current contour.");return contours};Glyph.prototype.getMetrics=function(){var commands=this.path.commands;var xCoords=[];var yCoords=[];for(var i=0;i<commands.length;i+=1){var cmd=commands[i];if(cmd.type!=="Z"){xCoords.push(cmd.x);yCoords.push(cmd.y)}if(cmd.type==="Q"||cmd.type==="C"){xCoords.push(cmd.x1);yCoords.push(cmd.y1)}if(cmd.type==="C"){xCoords.push(cmd.x2);yCoords.push(cmd.y2)}}var metrics={xMin:Math.min.apply(null,xCoords),yMin:Math.min.apply(null,yCoords),xMax:Math.max.apply(null,xCoords),yMax:Math.max.apply(null,yCoords),leftSideBearing:this.leftSideBearing};if(!isFinite(metrics.xMin)){metrics.xMin=0}if(!isFinite(metrics.xMax)){metrics.xMax=this.advanceWidth}if(!isFinite(metrics.yMin)){metrics.yMin=0}if(!isFinite(metrics.yMax)){metrics.yMax=0}metrics.rightSideBearing=this.advanceWidth-metrics.leftSideBearing-(metrics.xMax-metrics.xMin);return metrics};Glyph.prototype.draw=function(ctx,x,y,fontSize,options){this.getPath(x,y,fontSize,options).draw(ctx)};Glyph.prototype.drawPoints=function(ctx,x,y,fontSize){function drawCircles(l,x,y,scale){var PI_SQ=Math.PI*2;ctx.beginPath();for(var j=0;j<l.length;j+=1){ctx.moveTo(x+l[j].x*scale,y+l[j].y*scale);ctx.arc(x+l[j].x*scale,y+l[j].y*scale,2,0,PI_SQ,false)}ctx.closePath();ctx.fill()}x=x!==undefined?x:0;y=y!==undefined?y:0;fontSize=fontSize!==undefined?fontSize:24;var scale=1/this.path.unitsPerEm*fontSize;var blueCircles=[];var redCircles=[];var path=this.path;for(var i=0;i<path.commands.length;i+=1){var cmd=path.commands[i];if(cmd.x!==undefined){blueCircles.push({x:cmd.x,y:-cmd.y})}if(cmd.x1!==undefined){redCircles.push({x:cmd.x1,y:-cmd.y1})}if(cmd.x2!==undefined){redCircles.push({x:cmd.x2,y:-cmd.y2})}}ctx.fillStyle="blue";drawCircles(blueCircles,x,y,scale);ctx.fillStyle="red";drawCircles(redCircles,x,y,scale)};Glyph.prototype.drawMetrics=function(ctx,x,y,fontSize){var scale;x=x!==undefined?x:0;y=y!==undefined?y:0;fontSize=fontSize!==undefined?fontSize:24;scale=1/this.path.unitsPerEm*fontSize;ctx.lineWidth=1;ctx.strokeStyle="black";draw.line(ctx,x,-1e4,x,1e4);draw.line(ctx,-1e4,y,1e4,y);var xMin=this.xMin||0;var yMin=this.yMin||0;var xMax=this.xMax||0;var yMax=this.yMax||0;var advanceWidth=this.advanceWidth||0;ctx.strokeStyle="blue";draw.line(ctx,x+xMin*scale,-1e4,x+xMin*scale,1e4);draw.line(ctx,x+xMax*scale,-1e4,x+xMax*scale,1e4);draw.line(ctx,-1e4,y+-yMin*scale,1e4,y+-yMin*scale);draw.line(ctx,-1e4,y+-yMax*scale,1e4,y+-yMax*scale);ctx.strokeStyle="green";draw.line(ctx,x+advanceWidth*scale,-1e4,x+advanceWidth*scale,1e4)};function defineDependentProperty(glyph,externalName,internalName){Object.defineProperty(glyph,externalName,{get:function(){glyph.path;return glyph[internalName]},set:function(newValue){glyph[internalName]=newValue},enumerable:true,configurable:true})}function GlyphSet(font,glyphs){var this$1=this;this.font=font;this.glyphs={};if(Array.isArray(glyphs)){for(var i=0;i<glyphs.length;i++){this$1.glyphs[i]=glyphs[i]}}this.length=glyphs&&glyphs.length||0}GlyphSet.prototype.get=function(index){if(typeof this.glyphs[index]==="function"){this.glyphs[index]=this.glyphs[index]()}return this.glyphs[index]};GlyphSet.prototype.push=function(index,loader){this.glyphs[index]=loader;this.length++};function glyphLoader(font,index){return new Glyph({index:index,font:font})}function ttfGlyphLoader(font,index,parseGlyph,data,position,buildPath){return function(){var glyph=new Glyph({index:index,font:font});glyph.path=function(){parseGlyph(glyph,data,position);var path=buildPath(font.glyphs,glyph);path.unitsPerEm=font.unitsPerEm;return path};defineDependentProperty(glyph,"xMin","_xMin");defineDependentProperty(glyph,"xMax","_xMax");defineDependentProperty(glyph,"yMin","_yMin");defineDependentProperty(glyph,"yMax","_yMax");return glyph}}function cffGlyphLoader(font,index,parseCFFCharstring,charstring){return function(){var glyph=new Glyph({index:index,font:font});glyph.path=function(){var path=parseCFFCharstring(font,glyph,charstring);path.unitsPerEm=font.unitsPerEm;return path};return glyph}}var glyphset={GlyphSet:GlyphSet,glyphLoader:glyphLoader,ttfGlyphLoader:ttfGlyphLoader,cffGlyphLoader:cffGlyphLoader};function equals(a,b){if(a===b){return true}else if(Array.isArray(a)&&Array.isArray(b)){if(a.length!==b.length){return false}for(var i=0;i<a.length;i+=1){if(!equals(a[i],b[i])){return false}}return true}else{return false}}function calcCFFSubroutineBias(subrs){var bias;if(subrs.length<1240){bias=107}else if(subrs.length<33900){bias=1131}else{bias=32768}return bias}function parseCFFIndex(data,start,conversionFn){var offsets=[];var objects=[];var count=parse.getCard16(data,start);var objectOffset;var endOffset;if(count!==0){var offsetSize=parse.getByte(data,start+2);objectOffset=start+(count+1)*offsetSize+2;var pos=start+3;for(var i=0;i<count+1;i+=1){offsets.push(parse.getOffset(data,pos,offsetSize));pos+=offsetSize}endOffset=objectOffset+offsets[count]}else{endOffset=start+2}for(var i$1=0;i$1<offsets.length-1;i$1+=1){var value=parse.getBytes(data,objectOffset+offsets[i$1],objectOffset+offsets[i$1+1]);if(conversionFn){value=conversionFn(value)}objects.push(value)}return{objects:objects,startOffset:start,endOffset:endOffset}}function parseFloatOperand(parser){var s="";var eof=15;var lookup=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];while(true){var b=parser.parseByte();var n1=b>>4;var n2=b&15;if(n1===eof){break}s+=lookup[n1];if(n2===eof){break}s+=lookup[n2]}return parseFloat(s)}function parseOperand(parser,b0){var b1;var b2;var b3;var b4;if(b0===28){b1=parser.parseByte();b2=parser.parseByte();return b1<<8|b2}if(b0===29){b1=parser.parseByte();b2=parser.parseByte();b3=parser.parseByte();b4=parser.parseByte();return b1<<24|b2<<16|b3<<8|b4}if(b0===30){return parseFloatOperand(parser)}if(b0>=32&&b0<=246){return b0-139}if(b0>=247&&b0<=250){b1=parser.parseByte();return(b0-247)*256+b1+108}if(b0>=251&&b0<=254){b1=parser.parseByte();return-(b0-251)*256-b1-108}throw new Error("Invalid b0 "+b0)}function entriesToObject(entries){var o={};for(var i=0;i<entries.length;i+=1){var key=entries[i][0];var values=entries[i][1];var value=void 0;if(values.length===1){value=values[0]}else{value=values}if(o.hasOwnProperty(key)&&!isNaN(o[key])){throw new Error("Object "+o+" already has key "+key)}o[key]=value}return o}function parseCFFDict(data,start,size){start=start!==undefined?start:0;var parser=new parse.Parser(data,start);var entries=[];var operands=[];size=size!==undefined?size:data.length;while(parser.relativeOffset<size){var op=parser.parseByte();if(op<=21){if(op===12){op=1200+parser.parseByte()}entries.push([op,operands]);operands=[]}else{operands.push(parseOperand(parser,op))}}return entriesToObject(entries)}function getCFFString(strings,index){if(index<=390){index=cffStandardStrings[index]}else{index=strings[index-391]}return index}function interpretDict(dict,meta,strings){var newDict={};var value;for(var i=0;i<meta.length;i+=1){var m=meta[i];if(Array.isArray(m.type)){var values=[];values.length=m.type.length;for(var j=0;j<m.type.length;j++){value=dict[m.op]!==undefined?dict[m.op][j]:undefined;if(value===undefined){value=m.value!==undefined&&m.value[j]!==undefined?m.value[j]:null}if(m.type[j]==="SID"){value=getCFFString(strings,value)}values[j]=value}newDict[m.name]=values}else{value=dict[m.op];if(value===undefined){value=m.value!==undefined?m.value:null}if(m.type==="SID"){value=getCFFString(strings,value)}newDict[m.name]=value}}return newDict}function parseCFFHeader(data,start){var header={};header.formatMajor=parse.getCard8(data,start);header.formatMinor=parse.getCard8(data,start+1);header.size=parse.getCard8(data,start+2);header.offsetSize=parse.getCard8(data,start+3);header.startOffset=start;header.endOffset=start+4;return header}var TOP_DICT_META=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}];var PRIVATE_DICT_META=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function parseCFFTopDict(data,strings){var dict=parseCFFDict(data,0,data.byteLength);return interpretDict(dict,TOP_DICT_META,strings)}function parseCFFPrivateDict(data,start,size,strings){var dict=parseCFFDict(data,start,size);return interpretDict(dict,PRIVATE_DICT_META,strings)}function gatherCFFTopDicts(data,start,cffIndex,strings){var topDictArray=[];for(var iTopDict=0;iTopDict<cffIndex.length;iTopDict+=1){var topDictData=new DataView(new Uint8Array(cffIndex[iTopDict]).buffer);var topDict=parseCFFTopDict(topDictData,strings);topDict._subrs=[];topDict._subrsBias=0;var privateSize=topDict.private[0];var privateOffset=topDict.private[1];if(privateSize!==0&&privateOffset!==0){var privateDict=parseCFFPrivateDict(data,privateOffset+start,privateSize,strings);topDict._defaultWidthX=privateDict.defaultWidthX;topDict._nominalWidthX=privateDict.nominalWidthX;if(privateDict.subrs!==0){var subrOffset=privateOffset+privateDict.subrs;var subrIndex=parseCFFIndex(data,subrOffset+start);topDict._subrs=subrIndex.objects;topDict._subrsBias=calcCFFSubroutineBias(topDict._subrs)}topDict._privateDict=privateDict}topDictArray.push(topDict)}return topDictArray}function parseCFFCharset(data,start,nGlyphs,strings){var sid;var count;var parser=new parse.Parser(data,start);nGlyphs-=1;var charset=[".notdef"];var format=parser.parseCard8();if(format===0){for(var i=0;i<nGlyphs;i+=1){sid=parser.parseSID();charset.push(getCFFString(strings,sid))}}else if(format===1){while(charset.length<=nGlyphs){sid=parser.parseSID();count=parser.parseCard8();for(var i$1=0;i$1<=count;i$1+=1){charset.push(getCFFString(strings,sid));sid+=1}}}else if(format===2){while(charset.length<=nGlyphs){sid=parser.parseSID();count=parser.parseCard16();for(var i$2=0;i$2<=count;i$2+=1){charset.push(getCFFString(strings,sid));sid+=1}}}else{throw new Error("Unknown charset format "+format)}return charset}function parseCFFEncoding(data,start,charset){var code;var enc={};var parser=new parse.Parser(data,start);var format=parser.parseCard8();if(format===0){var nCodes=parser.parseCard8();for(var i=0;i<nCodes;i+=1){code=parser.parseCard8();enc[code]=i}}else if(format===1){var nRanges=parser.parseCard8();code=1;for(var i$1=0;i$1<nRanges;i$1+=1){var first=parser.parseCard8();var nLeft=parser.parseCard8();for(var j=first;j<=first+nLeft;j+=1){enc[j]=code;code+=1}}}else{throw new Error("Unknown encoding format "+format)}return new CffEncoding(enc,charset)}function parseCFFCharstring(font,glyph,code){var c1x;var c1y;var c2x;var c2y;var p=new Path;var stack=[];var nStems=0;var haveWidth=false;var open=false;var x=0;var y=0;var subrs;var subrsBias;var defaultWidthX;var nominalWidthX;if(font.isCIDFont){var fdIndex=font.tables.cff.topDict._fdSelect[glyph.index];var fdDict=font.tables.cff.topDict._fdArray[fdIndex];subrs=fdDict._subrs;subrsBias=fdDict._subrsBias;defaultWidthX=fdDict._defaultWidthX;nominalWidthX=fdDict._nominalWidthX}else{subrs=font.tables.cff.topDict._subrs;subrsBias=font.tables.cff.topDict._subrsBias;defaultWidthX=font.tables.cff.topDict._defaultWidthX;nominalWidthX=font.tables.cff.topDict._nominalWidthX}var width=defaultWidthX;function newContour(x,y){if(open){p.closePath()}p.moveTo(x,y);open=true}function parseStems(){var hasWidthArg;hasWidthArg=stack.length%2!==0;if(hasWidthArg&&!haveWidth){width=stack.shift()+nominalWidthX}nStems+=stack.length>>1;stack.length=0;haveWidth=true}function parse$$1(code){var b1;var b2;var b3;var b4;var codeIndex;var subrCode;var jpx;var jpy;var c3x;var c3y;var c4x;var c4y;var i=0;while(i<code.length){var v=code[i];i+=1;switch(v){case 1:parseStems();break;case 3:parseStems();break;case 4:if(stack.length>1&&!haveWidth){width=stack.shift()+nominalWidthX;haveWidth=true}y+=stack.pop();newContour(x,y);break;case 5:while(stack.length>0){x+=stack.shift();y+=stack.shift();p.lineTo(x,y)}break;case 6:while(stack.length>0){x+=stack.shift();p.lineTo(x,y);if(stack.length===0){break}y+=stack.shift();p.lineTo(x,y)}break;case 7:while(stack.length>0){y+=stack.shift();p.lineTo(x,y);if(stack.length===0){break}x+=stack.shift();p.lineTo(x,y)}break;case 8:while(stack.length>0){c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,x,y)}break;case 10:codeIndex=stack.pop()+subrsBias;subrCode=subrs[codeIndex];if(subrCode){parse$$1(subrCode)}break;case 11:return;case 12:v=code[i];i+=1;switch(v){case 35:c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();jpx=c2x+stack.shift();jpy=c2y+stack.shift();c3x=jpx+stack.shift();c3y=jpy+stack.shift();c4x=c3x+stack.shift();c4y=c3y+stack.shift();x=c4x+stack.shift();y=c4y+stack.shift();stack.shift();p.curveTo(c1x,c1y,c2x,c2y,jpx,jpy);p.curveTo(c3x,c3y,c4x,c4y,x,y);break;case 34:c1x=x+stack.shift();c1y=y;c2x=c1x+stack.shift();c2y=c1y+stack.shift();jpx=c2x+stack.shift();jpy=c2y;c3x=jpx+stack.shift();c3y=c2y;c4x=c3x+stack.shift();c4y=y;x=c4x+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,jpx,jpy);p.curveTo(c3x,c3y,c4x,c4y,x,y);break;case 36:c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();jpx=c2x+stack.shift();jpy=c2y;c3x=jpx+stack.shift();c3y=c2y;c4x=c3x+stack.shift();c4y=c3y+stack.shift();x=c4x+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,jpx,jpy);p.curveTo(c3x,c3y,c4x,c4y,x,y);break;case 37:c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();jpx=c2x+stack.shift();jpy=c2y+stack.shift();c3x=jpx+stack.shift();c3y=jpy+stack.shift();c4x=c3x+stack.shift();c4y=c3y+stack.shift();if(Math.abs(c4x-x)>Math.abs(c4y-y)){x=c4x+stack.shift()}else{y=c4y+stack.shift()}p.curveTo(c1x,c1y,c2x,c2y,jpx,jpy);p.curveTo(c3x,c3y,c4x,c4y,x,y);break;default:console.log("Glyph "+glyph.index+": unknown operator "+1200+v);stack.length=0}break;case 14:if(stack.length>0&&!haveWidth){width=stack.shift()+nominalWidthX;haveWidth=true}if(open){p.closePath();open=false}break;case 18:parseStems();break;case 19:case 20:parseStems();i+=nStems+7>>3;break;case 21:if(stack.length>2&&!haveWidth){width=stack.shift()+nominalWidthX;haveWidth=true}y+=stack.pop();x+=stack.pop();newContour(x,y);break;case 22:if(stack.length>1&&!haveWidth){width=stack.shift()+nominalWidthX;haveWidth=true}x+=stack.pop();newContour(x,y);break;case 23:parseStems();break;case 24:while(stack.length>2){c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,x,y)}x+=stack.shift();y+=stack.shift();p.lineTo(x,y);break;case 25:while(stack.length>6){x+=stack.shift();y+=stack.shift();p.lineTo(x,y)}c1x=x+stack.shift();c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,x,y);break;case 26:if(stack.length%2){x+=stack.shift()}while(stack.length>0){c1x=x;c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x;y=c2y+stack.shift();p.curveTo(c1x,c1y,c2x,c2y,x,y)}break;case 27:if(stack.length%2){y+=stack.shift()}while(stack.length>0){c1x=x+stack.shift();c1y=y;c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y;p.curveTo(c1x,c1y,c2x,c2y,x,y)}break;case 28:b1=code[i];b2=code[i+1];stack.push((b1<<24|b2<<16)>>16);i+=2;break;case 29:codeIndex=stack.pop()+font.gsubrsBias;subrCode=font.gsubrs[codeIndex];if(subrCode){parse$$1(subrCode)}break;case 30:while(stack.length>0){c1x=x;c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+(stack.length===1?stack.shift():0);p.curveTo(c1x,c1y,c2x,c2y,x,y);if(stack.length===0){break}c1x=x+stack.shift();c1y=y;c2x=c1x+stack.shift();c2y=c1y+stack.shift();y=c2y+stack.shift();x=c2x+(stack.length===1?stack.shift():0);p.curveTo(c1x,c1y,c2x,c2y,x,y)}break;case 31:while(stack.length>0){c1x=x+stack.shift();c1y=y;c2x=c1x+stack.shift();c2y=c1y+stack.shift();y=c2y+stack.shift();x=c2x+(stack.length===1?stack.shift():0);p.curveTo(c1x,c1y,c2x,c2y,x,y);if(stack.length===0){break}c1x=x;c1y=y+stack.shift();c2x=c1x+stack.shift();c2y=c1y+stack.shift();x=c2x+stack.shift();y=c2y+(stack.length===1?stack.shift():0);p.curveTo(c1x,c1y,c2x,c2y,x,y)}break;default:if(v<32){console.log("Glyph "+glyph.index+": unknown operator "+v)}else if(v<247){stack.push(v-139)}else if(v<251){b1=code[i];i+=1;stack.push((v-247)*256+b1+108)}else if(v<255){b1=code[i];i+=1;stack.push(-(v-251)*256-b1-108)}else{b1=code[i];b2=code[i+1];b3=code[i+2];b4=code[i+3];i+=4;stack.push((b1<<24|b2<<16|b3<<8|b4)/65536)}}}}parse$$1(code);glyph.advanceWidth=width;return p}function parseCFFFDSelect(data,start,nGlyphs,fdArrayCount){var fdSelect=[];var fdIndex;var parser=new parse.Parser(data,start);var format=parser.parseCard8();if(format===0){for(var iGid=0;iGid<nGlyphs;iGid++){fdIndex=parser.parseCard8();if(fdIndex>=fdArrayCount){throw new Error("CFF table CID Font FDSelect has bad FD index value "+fdIndex+" (FD count "+fdArrayCount+")")}fdSelect.push(fdIndex)}}else if(format===3){var nRanges=parser.parseCard16();var first=parser.parseCard16();if(first!==0){throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+first)}var next;for(var iRange=0;iRange<nRanges;iRange++){fdIndex=parser.parseCard8();next=parser.parseCard16();if(fdIndex>=fdArrayCount){throw new Error("CFF table CID Font FDSelect has bad FD index value "+fdIndex+" (FD count "+fdArrayCount+")")}if(next>nGlyphs){throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+next)}for(;first<next;first++){fdSelect.push(fdIndex)}first=next}if(next!==nGlyphs){throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+next)}}else{throw new Error("CFF Table CID Font FDSelect table has unsupported format "+format)}return fdSelect}function parseCFFTable(data,start,font){font.tables.cff={};var header=parseCFFHeader(data,start);var nameIndex=parseCFFIndex(data,header.endOffset,parse.bytesToString);var topDictIndex=parseCFFIndex(data,nameIndex.endOffset);var stringIndex=parseCFFIndex(data,topDictIndex.endOffset,parse.bytesToString);var globalSubrIndex=parseCFFIndex(data,stringIndex.endOffset);font.gsubrs=globalSubrIndex.objects;font.gsubrsBias=calcCFFSubroutineBias(font.gsubrs);var topDictArray=gatherCFFTopDicts(data,start,topDictIndex.objects,stringIndex.objects);if(topDictArray.length!==1){throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+topDictArray.length)}var topDict=topDictArray[0];font.tables.cff.topDict=topDict;if(topDict._privateDict){font.defaultWidthX=topDict._privateDict.defaultWidthX;font.nominalWidthX=topDict._privateDict.nominalWidthX}if(topDict.ros[0]!==undefined&&topDict.ros[1]!==undefined){font.isCIDFont=true}if(font.isCIDFont){var fdArrayOffset=topDict.fdArray;var fdSelectOffset=topDict.fdSelect;if(fdArrayOffset===0||fdSelectOffset===0){throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing")}fdArrayOffset+=start;var fdArrayIndex=parseCFFIndex(data,fdArrayOffset);var fdArray=gatherCFFTopDicts(data,start,fdArrayIndex.objects,stringIndex.objects);topDict._fdArray=fdArray;fdSelectOffset+=start;topDict._fdSelect=parseCFFFDSelect(data,fdSelectOffset,font.numGlyphs,fdArray.length)}var privateDictOffset=start+topDict.private[1];var privateDict=parseCFFPrivateDict(data,privateDictOffset,topDict.private[0],stringIndex.objects);font.defaultWidthX=privateDict.defaultWidthX;font.nominalWidthX=privateDict.nominalWidthX;if(privateDict.subrs!==0){var subrOffset=privateDictOffset+privateDict.subrs;var subrIndex=parseCFFIndex(data,subrOffset);font.subrs=subrIndex.objects;font.subrsBias=calcCFFSubroutineBias(font.subrs)}else{font.subrs=[];font.subrsBias=0}var charStringsIndex=parseCFFIndex(data,start+topDict.charStrings);font.nGlyphs=charStringsIndex.objects.length;var charset=parseCFFCharset(data,start+topDict.charset,font.nGlyphs,stringIndex.objects);if(topDict.encoding===0){font.cffEncoding=new CffEncoding(cffStandardEncoding,charset)}else if(topDict.encoding===1){font.cffEncoding=new CffEncoding(cffExpertEncoding,charset)}else{font.cffEncoding=parseCFFEncoding(data,start+topDict.encoding,charset)}font.encoding=font.encoding||font.cffEncoding;font.glyphs=new glyphset.GlyphSet(font);for(var i=0;i<font.nGlyphs;i+=1){var charString=charStringsIndex.objects[i];font.glyphs.push(i,glyphset.cffGlyphLoader(font,i,parseCFFCharstring,charString))}}function encodeString(s,strings){var sid;var i=cffStandardStrings.indexOf(s);if(i>=0){sid=i}i=strings.indexOf(s);if(i>=0){sid=i+cffStandardStrings.length}else{sid=cffStandardStrings.length+strings.length;strings.push(s)}return sid}function makeHeader(){return new table.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function makeNameIndex(fontNames){var t=new table.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var i=0;i<fontNames.length;i+=1){t.names.push({name:"name_"+i,type:"NAME",value:fontNames[i]})}return t}function makeDict(meta,attrs,strings){var m={};for(var i=0;i<meta.length;i+=1){var entry=meta[i];var value=attrs[entry.name];if(value!==undefined&&!equals(value,entry.value)){if(entry.type==="SID"){value=encodeString(value,strings)}m[entry.op]={name:entry.name,type:entry.type,value:value}}}return m}function makeTopDict(attrs,strings){var t=new table.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);t.dict=makeDict(TOP_DICT_META,attrs,strings);return t}function makeTopDictIndex(topDict){var t=new table.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);t.topDicts=[{name:"topDict_0",type:"TABLE",value:topDict}];return t}function makeStringIndex(strings){var t=new table.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var i=0;i<strings.length;i+=1){t.strings.push({name:"string_"+i,type:"STRING",value:strings[i]})}return t}function makeGlobalSubrIndex(){return new table.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function makeCharsets(glyphNames,strings){var t=new table.Record("Charsets",[{name:"format",type:"Card8",value:0}]);for(var i=0;i<glyphNames.length;i+=1){var glyphName=glyphNames[i];var glyphSID=encodeString(glyphName,strings);t.fields.push({name:"glyph_"+i,type:"SID",value:glyphSID})}return t}function glyphToOps(glyph){var ops=[];var path=glyph.path;ops.push({name:"width",type:"NUMBER",value:glyph.advanceWidth});var x=0;var y=0;for(var i=0;i<path.commands.length;i+=1){var dx=void 0;var dy=void 0;var cmd=path.commands[i];if(cmd.type==="Q"){var _13=1/3;var _23=2/3;cmd={type:"C",x:cmd.x,y:cmd.y,x1:_13*x+_23*cmd.x1,y1:_13*y+_23*cmd.y1,x2:_13*cmd.x+_23*cmd.x1,y2:_13*cmd.y+_23*cmd.y1}}if(cmd.type==="M"){dx=Math.round(cmd.x-x);dy=Math.round(cmd.y-y);ops.push({name:"dx",type:"NUMBER",value:dx});ops.push({name:"dy",type:"NUMBER",value:dy});ops.push({name:"rmoveto",type:"OP",value:21});x=Math.round(cmd.x);y=Math.round(cmd.y)}else if(cmd.type==="L"){dx=Math.round(cmd.x-x);dy=Math.round(cmd.y-y);ops.push({name:"dx",type:"NUMBER",value:dx});ops.push({name:"dy",type:"NUMBER",value:dy});ops.push({name:"rlineto",type:"OP",value:5});x=Math.round(cmd.x);y=Math.round(cmd.y)}else if(cmd.type==="C"){var dx1=Math.round(cmd.x1-x);var dy1=Math.round(cmd.y1-y);var dx2=Math.round(cmd.x2-cmd.x1);var dy2=Math.round(cmd.y2-cmd.y1);dx=Math.round(cmd.x-cmd.x2);dy=Math.round(cmd.y-cmd.y2);ops.push({name:"dx1",type:"NUMBER",value:dx1});ops.push({name:"dy1",type:"NUMBER",value:dy1});ops.push({name:"dx2",type:"NUMBER",value:dx2});ops.push({name:"dy2",type:"NUMBER",value:dy2});ops.push({name:"dx",type:"NUMBER",value:dx});ops.push({name:"dy",type:"NUMBER",value:dy});ops.push({name:"rrcurveto",type:"OP",value:8});x=Math.round(cmd.x);y=Math.round(cmd.y)}}ops.push({name:"endchar",type:"OP",value:14});return ops}function makeCharStringsIndex(glyphs){var t=new table.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]);for(var i=0;i<glyphs.length;i+=1){var glyph=glyphs.get(i);var ops=glyphToOps(glyph);t.charStrings.push({name:glyph.name,type:"CHARSTRING",value:ops})}return t}function makePrivateDict(attrs,strings){var t=new table.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);t.dict=makeDict(PRIVATE_DICT_META,attrs,strings);return t}function makeCFFTable(glyphs,options){var t=new table.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]);var fontScale=1/options.unitsPerEm;var attrs={version:options.version,fullName:options.fullName,familyName:options.familyName,weight:options.weightName,fontBBox:options.fontBBox||[0,0,0,0],fontMatrix:[fontScale,0,0,fontScale,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]};var privateAttrs={};var glyphNames=[];var glyph;for(var i=1;i<glyphs.length;i+=1){glyph=glyphs.get(i);glyphNames.push(glyph.name)}var strings=[];t.header=makeHeader();t.nameIndex=makeNameIndex([options.postScriptName]);var topDict=makeTopDict(attrs,strings);t.topDictIndex=makeTopDictIndex(topDict);t.globalSubrIndex=makeGlobalSubrIndex();t.charsets=makeCharsets(glyphNames,strings);t.charStringsIndex=makeCharStringsIndex(glyphs);t.privateDict=makePrivateDict(privateAttrs,strings);t.stringIndex=makeStringIndex(strings);var startOffset=t.header.sizeOf()+t.nameIndex.sizeOf()+t.topDictIndex.sizeOf()+t.stringIndex.sizeOf()+t.globalSubrIndex.sizeOf();attrs.charset=startOffset;attrs.encoding=0;attrs.charStrings=attrs.charset+t.charsets.sizeOf();attrs.private[1]=attrs.charStrings+t.charStringsIndex.sizeOf();topDict=makeTopDict(attrs,strings);t.topDictIndex=makeTopDictIndex(topDict);return t}var cff={parse:parseCFFTable,make:makeCFFTable};function parseHeadTable(data,start){var head={};var p=new parse.Parser(data,start);head.version=p.parseVersion();head.fontRevision=Math.round(p.parseFixed()*1e3)/1e3;head.checkSumAdjustment=p.parseULong();head.magicNumber=p.parseULong();check.argument(head.magicNumber===1594834165,"Font header has wrong magic number.");head.flags=p.parseUShort();head.unitsPerEm=p.parseUShort();head.created=p.parseLongDateTime();head.modified=p.parseLongDateTime();head.xMin=p.parseShort();head.yMin=p.parseShort();head.xMax=p.parseShort();head.yMax=p.parseShort();head.macStyle=p.parseUShort();head.lowestRecPPEM=p.parseUShort();head.fontDirectionHint=p.parseShort();head.indexToLocFormat=p.parseShort();head.glyphDataFormat=p.parseShort();return head}function makeHeadTable(options){var timestamp=Math.round((new Date).getTime()/1e3)+2082844800;var createdTimestamp=timestamp;if(options.createdTimestamp){createdTimestamp=options.createdTimestamp+2082844800}return new table.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:createdTimestamp},{name:"modified",type:"LONGDATETIME",value:timestamp},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],options)}var head={parse:parseHeadTable,make:makeHeadTable};function parseHheaTable(data,start){var hhea={};var p=new parse.Parser(data,start);hhea.version=p.parseVersion();hhea.ascender=p.parseShort();hhea.descender=p.parseShort();hhea.lineGap=p.parseShort();hhea.advanceWidthMax=p.parseUShort();hhea.minLeftSideBearing=p.parseShort();hhea.minRightSideBearing=p.parseShort();hhea.xMaxExtent=p.parseShort();hhea.caretSlopeRise=p.parseShort();hhea.caretSlopeRun=p.parseShort();hhea.caretOffset=p.parseShort();p.relativeOffset+=8;hhea.metricDataFormat=p.parseShort();hhea.numberOfHMetrics=p.parseUShort();return hhea}function makeHheaTable(options){return new table.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],options)}var hhea={parse:parseHheaTable,make:makeHheaTable};function parseHmtxTable(data,start,numMetrics,numGlyphs,glyphs){var advanceWidth;var leftSideBearing;var p=new parse.Parser(data,start);for(var i=0;i<numGlyphs;i+=1){if(i<numMetrics){advanceWidth=p.parseUShort();leftSideBearing=p.parseShort()}var glyph=glyphs.get(i);glyph.advanceWidth=advanceWidth;glyph.leftSideBearing=leftSideBearing}}function makeHmtxTable(glyphs){var t=new table.Table("hmtx",[]);for(var i=0;i<glyphs.length;i+=1){var glyph=glyphs.get(i);var advanceWidth=glyph.advanceWidth||0;var leftSideBearing=glyph.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+i,type:"USHORT",value:advanceWidth});t.fields.push({name:"leftSideBearing_"+i,type:"SHORT",value:leftSideBearing})}return t}var hmtx={parse:parseHmtxTable,make:makeHmtxTable};function makeLtagTable(tags){var result=new table.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:tags.length}]);var stringPool="";var stringPoolOffset=12+tags.length*4;for(var i=0;i<tags.length;++i){var pos=stringPool.indexOf(tags[i]);if(pos<0){pos=stringPool.length;stringPool+=tags[i]}result.fields.push({name:"offset "+i,type:"USHORT",value:stringPoolOffset+pos});result.fields.push({name:"length "+i,type:"USHORT",value:tags[i].length})}result.fields.push({name:"stringPool",type:"CHARARRAY",value:stringPool});return result}function parseLtagTable(data,start){var p=new parse.Parser(data,start);var tableVersion=p.parseULong();check.argument(tableVersion===1,"Unsupported ltag table version.");p.skip("uLong",1);var numTags=p.parseULong();var tags=[];for(var i=0;i<numTags;i++){var tag="";var offset=start+p.parseUShort();var length=p.parseUShort();for(var j=offset;j<offset+length;++j){tag+=String.fromCharCode(data.getInt8(j))}tags.push(tag)}return tags}var ltag={make:makeLtagTable,parse:parseLtagTable};function parseMaxpTable(data,start){var maxp={};var p=new parse.Parser(data,start);maxp.version=p.parseVersion();maxp.numGlyphs=p.parseUShort();if(maxp.version===1){maxp.maxPoints=p.parseUShort();maxp.maxContours=p.parseUShort();maxp.maxCompositePoints=p.parseUShort();maxp.maxCompositeContours=p.parseUShort();maxp.maxZones=p.parseUShort();maxp.maxTwilightPoints=p.parseUShort();maxp.maxStorage=p.parseUShort();maxp.maxFunctionDefs=p.parseUShort();maxp.maxInstructionDefs=p.parseUShort();maxp.maxStackElements=p.parseUShort();maxp.maxSizeOfInstructions=p.parseUShort();maxp.maxComponentElements=p.parseUShort();maxp.maxComponentDepth=p.parseUShort()}return maxp}function makeMaxpTable(numGlyphs){return new table.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:numGlyphs}])}var maxp={parse:parseMaxpTable,make:makeMaxpTable};var nameTableNames=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"];var macLanguages={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"};var macLanguageToScript={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0};var windowsLanguages={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function getLanguageCode(platformID,languageID,ltag){switch(platformID){case 0:if(languageID===65535){return"und"}else if(ltag){return ltag[languageID]}break;case 1:return macLanguages[languageID];case 3:return windowsLanguages[languageID]}return undefined}var utf16="utf-16";var macScriptEncodings={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"};var macLanguageEncodings={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function getEncoding(platformID,encodingID,languageID){switch(platformID){case 0:return utf16;case 1:return macLanguageEncodings[languageID]||macScriptEncodings[encodingID];case 3:if(encodingID===1||encodingID===10){return utf16}break}return undefined}function parseNameTable(data,start,ltag){var name={};var p=new parse.Parser(data,start);var format=p.parseUShort();var count=p.parseUShort();var stringOffset=p.offset+p.parseUShort();for(var i=0;i<count;i++){var platformID=p.parseUShort();var encodingID=p.parseUShort();var languageID=p.parseUShort();var nameID=p.parseUShort();var property=nameTableNames[nameID]||nameID;var byteLength=p.parseUShort();var offset=p.parseUShort();var language=getLanguageCode(platformID,languageID,ltag);var encoding=getEncoding(platformID,encodingID,languageID);if(encoding!==undefined&&language!==undefined){var text=void 0;if(encoding===utf16){text=decode.UTF16(data,stringOffset+offset,byteLength)}else{text=decode.MACSTRING(data,stringOffset+offset,byteLength,encoding)}if(text){var translations=name[property];if(translations===undefined){translations=name[property]={}}translations[language]=text}}}var langTagCount=0;if(format===1){langTagCount=p.parseUShort()}return name}function reverseDict(dict){var result={};for(var key in dict){result[dict[key]]=parseInt(key)}return result}function makeNameRecord(platformID,encodingID,languageID,nameID,length,offset){return new table.Record("NameRecord",[{name:"platformID",type:"USHORT",value:platformID},{name:"encodingID",type:"USHORT",value:encodingID},{name:"languageID",type:"USHORT",value:languageID},{name:"nameID",type:"USHORT",value:nameID},{name:"length",type:"USHORT",value:length},{name:"offset",type:"USHORT",value:offset}])}function findSubArray(needle,haystack){var needleLength=needle.length;var limit=haystack.length-needleLength+1;loop:for(var pos=0;pos<limit;pos++){for(;pos<limit;pos++){for(var k=0;k<needleLength;k++){if(haystack[pos+k]!==needle[k]){continue loop}}return pos}}return-1}function addStringToPool(s,pool){var offset=findSubArray(s,pool);if(offset<0){offset=pool.length;var i=0;var len=s.length;for(;i<len;++i){pool.push(s[i])}}return offset}function makeNameTable(names,ltag){var nameID;var nameIDs=[];var namesWithNumericKeys={};var nameTableIds=reverseDict(nameTableNames);for(var key in names){var id=nameTableIds[key];if(id===undefined){id=key}nameID=parseInt(id);if(isNaN(nameID)){throw new Error('Name table entry "'+key+'" does not exist, see nameTableNames for complete list.')}namesWithNumericKeys[nameID]=names[key];nameIDs.push(nameID)}var macLanguageIds=reverseDict(macLanguages);var windowsLanguageIds=reverseDict(windowsLanguages);var nameRecords=[];var stringPool=[];for(var i=0;i<nameIDs.length;i++){nameID=nameIDs[i];var translations=namesWithNumericKeys[nameID];for(var lang in translations){var text=translations[lang];var macPlatform=1;var macLanguage=macLanguageIds[lang];var macScript=macLanguageToScript[macLanguage];var macEncoding=getEncoding(macPlatform,macScript,macLanguage);var macName=encode.MACSTRING(text,macEncoding);if(macName===undefined){macPlatform=0;macLanguage=ltag.indexOf(lang);if(macLanguage<0){macLanguage=ltag.length;ltag.push(lang)}macScript=4;macName=encode.UTF16(text)}var macNameOffset=addStringToPool(macName,stringPool);nameRecords.push(makeNameRecord(macPlatform,macScript,macLanguage,nameID,macName.length,macNameOffset));var winLanguage=windowsLanguageIds[lang];if(winLanguage!==undefined){var winName=encode.UTF16(text);var winNameOffset=addStringToPool(winName,stringPool);nameRecords.push(makeNameRecord(3,1,winLanguage,nameID,winName.length,winNameOffset))}}}nameRecords.sort(function(a,b){return a.platformID-b.platformID||a.encodingID-b.encodingID||a.languageID-b.languageID||a.nameID-b.nameID});var t=new table.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:nameRecords.length},{name:"stringOffset",type:"USHORT",value:6+nameRecords.length*12}]);for(var r=0;r<nameRecords.length;r++){t.fields.push({name:"record_"+r,type:"RECORD",value:nameRecords[r]})}t.fields.push({name:"strings",type:"LITERAL",value:stringPool});return t}var _name={parse:parseNameTable,make:makeNameTable};var unicodeRanges=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function getUnicodeRange(unicode){for(var i=0;i<unicodeRanges.length;i+=1){var range=unicodeRanges[i];if(unicode>=range.begin&&unicode<range.end){return i}}return-1}function parseOS2Table(data,start){var os2={};var p=new parse.Parser(data,start);os2.version=p.parseUShort();os2.xAvgCharWidth=p.parseShort();os2.usWeightClass=p.parseUShort();os2.usWidthClass=p.parseUShort();os2.fsType=p.parseUShort();os2.ySubscriptXSize=p.parseShort();os2.ySubscriptYSize=p.parseShort();os2.ySubscriptXOffset=p.parseShort();os2.ySubscriptYOffset=p.parseShort();os2.ySuperscriptXSize=p.parseShort();os2.ySuperscriptYSize=p.parseShort();os2.ySuperscriptXOffset=p.parseShort();os2.ySuperscriptYOffset=p.parseShort();os2.yStrikeoutSize=p.parseShort();os2.yStrikeoutPosition=p.parseShort();os2.sFamilyClass=p.parseShort();os2.panose=[];for(var i=0;i<10;i++){os2.panose[i]=p.parseByte()}os2.ulUnicodeRange1=p.parseULong();os2.ulUnicodeRange2=p.parseULong();os2.ulUnicodeRange3=p.parseULong();os2.ulUnicodeRange4=p.parseULong();os2.achVendID=String.fromCharCode(p.parseByte(),p.parseByte(),p.parseByte(),p.parseByte());os2.fsSelection=p.parseUShort();os2.usFirstCharIndex=p.parseUShort();os2.usLastCharIndex=p.parseUShort();os2.sTypoAscender=p.parseShort();os2.sTypoDescender=p.parseShort();os2.sTypoLineGap=p.parseShort();os2.usWinAscent=p.parseUShort();os2.usWinDescent=p.parseUShort();if(os2.version>=1){os2.ulCodePageRange1=p.parseULong();os2.ulCodePageRange2=p.parseULong()}if(os2.version>=2){os2.sxHeight=p.parseShort();os2.sCapHeight=p.parseShort();os2.usDefaultChar=p.parseUShort();os2.usBreakChar=p.parseUShort();os2.usMaxContent=p.parseUShort()}return os2}function makeOS2Table(options){return new table.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],options)}var os2={parse:parseOS2Table,make:makeOS2Table,unicodeRanges:unicodeRanges,getUnicodeRange:getUnicodeRange};function parsePostTable(data,start){var post={};var p=new parse.Parser(data,start);post.version=p.parseVersion();post.italicAngle=p.parseFixed();post.underlinePosition=p.parseShort();post.underlineThickness=p.parseShort();post.isFixedPitch=p.parseULong();post.minMemType42=p.parseULong();post.maxMemType42=p.parseULong();post.minMemType1=p.parseULong();post.maxMemType1=p.parseULong();switch(post.version){case 1:post.names=standardNames.slice();break;case 2:post.numberOfGlyphs=p.parseUShort();post.glyphNameIndex=new Array(post.numberOfGlyphs);for(var i=0;i<post.numberOfGlyphs;i++){post.glyphNameIndex[i]=p.parseUShort()}post.names=[];for(var i$1=0;i$1<post.numberOfGlyphs;i$1++){if(post.glyphNameIndex[i$1]>=standardNames.length){var nameLength=p.parseChar();post.names.push(p.parseString(nameLength))}}break;case 2.5:post.numberOfGlyphs=p.parseUShort();post.offset=new Array(post.numberOfGlyphs);for(var i$2=0;i$2<post.numberOfGlyphs;i$2++){post.offset[i$2]=p.parseChar()}break}return post}function makePostTable(){return new table.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var post={parse:parsePostTable,make:makePostTable};var subtableParsers=new Array(9);subtableParsers[1]=function parseLookup1(){var start=this.offset+this.relativeOffset;var substFormat=this.parseUShort();if(substFormat===1){return{substFormat:1,coverage:this.parsePointer(Parser.coverage),deltaGlyphId:this.parseUShort()}}else if(substFormat===2){return{substFormat:2,coverage:this.parsePointer(Parser.coverage),substitute:this.parseOffset16List()}}check.assert(false,"0x"+start.toString(16)+": lookup type 1 format must be 1 or 2.")};subtableParsers[2]=function parseLookup2(){var substFormat=this.parseUShort();check.argument(substFormat===1,"GSUB Multiple Substitution Subtable identifier-format must be 1");return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),sequences:this.parseListOfLists()}};subtableParsers[3]=function parseLookup3(){var substFormat=this.parseUShort();check.argument(substFormat===1,"GSUB Alternate Substitution Subtable identifier-format must be 1");return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),alternateSets:this.parseListOfLists()}};subtableParsers[4]=function parseLookup4(){var substFormat=this.parseUShort();check.argument(substFormat===1,"GSUB ligature table identifier-format must be 1");return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var lookupRecordDesc={sequenceIndex:Parser.uShort,lookupListIndex:Parser.uShort};subtableParsers[5]=function parseLookup5(){var start=this.offset+this.relativeOffset;var substFormat=this.parseUShort();if(substFormat===1){return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),ruleSets:this.parseListOfLists(function(){var glyphCount=this.parseUShort();var substCount=this.parseUShort();return{input:this.parseUShortList(glyphCount-1),lookupRecords:this.parseRecordList(substCount,lookupRecordDesc)}})}}else if(substFormat===2){return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),classDef:this.parsePointer(Parser.classDef),classSets:this.parseListOfLists(function(){var glyphCount=this.parseUShort();var substCount=this.parseUShort();return{classes:this.parseUShortList(glyphCount-1),lookupRecords:this.parseRecordList(substCount,lookupRecordDesc)}})}}else if(substFormat===3){var glyphCount=this.parseUShort();var substCount=this.parseUShort();return{substFormat:substFormat,coverages:this.parseList(glyphCount,Parser.pointer(Parser.coverage)),lookupRecords:this.parseRecordList(substCount,lookupRecordDesc)}}check.assert(false,"0x"+start.toString(16)+": lookup type 5 format must be 1, 2 or 3.")};subtableParsers[6]=function parseLookup6(){var start=this.offset+this.relativeOffset;var substFormat=this.parseUShort();if(substFormat===1){return{substFormat:1,coverage:this.parsePointer(Parser.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)}})}}else if(substFormat===2){return{substFormat:2,coverage:this.parsePointer(Parser.coverage),backtrackClassDef:this.parsePointer(Parser.classDef),inputClassDef:this.parsePointer(Parser.classDef),lookaheadClassDef:this.parsePointer(Parser.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(lookupRecordDesc)}})}}else if(substFormat===3){return{substFormat:3,backtrackCoverage:this.parseList(Parser.pointer(Parser.coverage)),inputCoverage:this.parseList(Parser.pointer(Parser.coverage)),lookaheadCoverage:this.parseList(Parser.pointer(Parser.coverage)),lookupRecords:this.parseRecordList(lookupRecordDesc)}}check.assert(false,"0x"+start.toString(16)+": lookup type 6 format must be 1, 2 or 3.")};subtableParsers[7]=function parseLookup7(){var substFormat=this.parseUShort();check.argument(substFormat===1,"GSUB Extension Substitution subtable identifier-format must be 1");var extensionLookupType=this.parseUShort();var extensionParser=new Parser(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:extensionLookupType,extension:subtableParsers[extensionLookupType].call(extensionParser)}};subtableParsers[8]=function parseLookup8(){var substFormat=this.parseUShort();check.argument(substFormat===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1");return{substFormat:substFormat,coverage:this.parsePointer(Parser.coverage),backtrackCoverage:this.parseList(Parser.pointer(Parser.coverage)),lookaheadCoverage:this.parseList(Parser.pointer(Parser.coverage)),substitutes:this.parseUShortList()}};function parseGsubTable(data,start){start=start||0;var p=new Parser(data,start);var tableVersion=p.parseVersion(1);check.argument(tableVersion===1||tableVersion===1.1,"Unsupported GSUB table version.");if(tableVersion===1){return{version:tableVersion,scripts:p.parseScriptList(),features:p.parseFeatureList(),lookups:p.parseLookupList(subtableParsers)}}else{return{version:tableVersion,scripts:p.parseScriptList(),features:p.parseFeatureList(),lookups:p.parseLookupList(subtableParsers),variations:p.parseFeatureVariationsList()}}}var subtableMakers=new Array(9);subtableMakers[1]=function makeLookup1(subtable){if(subtable.substFormat===1){return new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(subtable.coverage)},{name:"deltaGlyphID",type:"USHORT",value:subtable.deltaGlyphId}])}else{return new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new table.Coverage(subtable.coverage)}].concat(table.ushortList("substitute",subtable.substitute)))}check.fail("Lookup type 1 substFormat must be 1 or 2.")};subtableMakers[3]=function makeLookup3(subtable){check.assert(subtable.substFormat===1,"Lookup type 3 substFormat must be 1.");return new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(subtable.coverage)}].concat(table.tableList("altSet",subtable.alternateSets,function(alternateSet){return new table.Table("alternateSetTable",table.ushortList("alternate",alternateSet))})))};subtableMakers[4]=function makeLookup4(subtable){check.assert(subtable.substFormat===1,"Lookup type 4 substFormat must be 1.");return new table.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new table.Coverage(subtable.coverage)}].concat(table.tableList("ligSet",subtable.ligatureSets,function(ligatureSet){return new table.Table("ligatureSetTable",table.tableList("ligature",ligatureSet,function(ligature){return new table.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:ligature.ligGlyph}].concat(table.ushortList("component",ligature.components,ligature.components.length+1)))}))})))};function makeGsubTable(gsub){return new table.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new table.ScriptList(gsub.scripts)},{name:"features",type:"TABLE",value:new table.FeatureList(gsub.features)},{name:"lookups",type:"TABLE",value:new table.LookupList(gsub.lookups,subtableMakers)}])}var gsub={parse:parseGsubTable,make:makeGsubTable};function parseMetaTable(data,start){var p=new parse.Parser(data,start);var tableVersion=p.parseULong();check.argument(tableVersion===1,"Unsupported META table version.");p.parseULong();p.parseULong();var numDataMaps=p.parseULong();var tags={};for(var i=0;i<numDataMaps;i++){var tag=p.parseTag();var dataOffset=p.parseULong();var dataLength=p.parseULong();var text=decode.UTF8(data,start+dataOffset,dataLength);tags[tag]=text}return tags}function makeMetaTable(tags){var numTags=Object.keys(tags).length;var stringPool="";var stringPoolOffset=16+numTags*12;var result=new table.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:stringPoolOffset},{name:"numTags",type:"ULONG",value:numTags}]);for(var tag in tags){var pos=stringPool.length;stringPool+=tags[tag];result.fields.push({name:"tag "+tag,type:"TAG",value:tag});result.fields.push({name:"offset "+tag,type:"ULONG",value:stringPoolOffset+pos});result.fields.push({name:"length "+tag,type:"ULONG",value:tags[tag].length})}result.fields.push({name:"stringPool",type:"CHARARRAY",value:stringPool});return result}var meta={parse:parseMetaTable,make:makeMetaTable};function log2(v){return Math.log(v)/Math.log(2)|0}function computeCheckSum(bytes){while(bytes.length%4!==0){bytes.push(0)}var sum=0;for(var i=0;i<bytes.length;i+=4){sum+=(bytes[i]<<24)+(bytes[i+1]<<16)+(bytes[i+2]<<8)+bytes[i+3]}sum%=Math.pow(2,32);return sum}function makeTableRecord(tag,checkSum,offset,length){return new table.Record("Table Record",[{name:"tag",type:"TAG",value:tag!==undefined?tag:""},{name:"checkSum",type:"ULONG",value:checkSum!==undefined?checkSum:0},{name:"offset",type:"ULONG",value:offset!==undefined?offset:0},{name:"length",type:"ULONG",value:length!==undefined?length:0}])}function makeSfntTable(tables){var sfnt=new table.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);sfnt.tables=tables;sfnt.numTables=tables.length;var highestPowerOf2=Math.pow(2,log2(sfnt.numTables));sfnt.searchRange=16*highestPowerOf2;sfnt.entrySelector=log2(highestPowerOf2);sfnt.rangeShift=sfnt.numTables*16-sfnt.searchRange;var recordFields=[];var tableFields=[];var offset=sfnt.sizeOf()+makeTableRecord().sizeOf()*sfnt.numTables;while(offset%4!==0){offset+=1;tableFields.push({name:"padding",type:"BYTE",value:0})}for(var i=0;i<tables.length;i+=1){var t=tables[i];check.argument(t.tableName.length===4,"Table name"+t.tableName+" is invalid.");var tableLength=t.sizeOf();var tableRecord=makeTableRecord(t.tableName,computeCheckSum(t.encode()),offset,tableLength);recordFields.push({name:tableRecord.tag+" Table Record",type:"RECORD",value:tableRecord});tableFields.push({name:t.tableName+" table",type:"RECORD",value:t});offset+=tableLength;check.argument(!isNaN(offset),"Something went wrong calculating the offset.");while(offset%4!==0){offset+=1;tableFields.push({name:"padding",type:"BYTE",value:0})}}recordFields.sort(function(r1,r2){if(r1.value.tag>r2.value.tag){return 1}else{return-1}});sfnt.fields=sfnt.fields.concat(recordFields);sfnt.fields=sfnt.fields.concat(tableFields);return sfnt}function metricsForChar(font,chars,notFoundMetrics){for(var i=0;i<chars.length;i+=1){var glyphIndex=font.charToGlyphIndex(chars[i]);if(glyphIndex>0){var glyph=font.glyphs.get(glyphIndex);return glyph.getMetrics()}}return notFoundMetrics}function average(vs){var sum=0;for(var i=0;i<vs.length;i+=1){sum+=vs[i]}return sum/vs.length}function fontToSfntTable(font){var xMins=[];var yMins=[];var xMaxs=[];var yMaxs=[];var advanceWidths=[];var leftSideBearings=[];var rightSideBearings=[];var firstCharIndex;var lastCharIndex=0;var ulUnicodeRange1=0;var ulUnicodeRange2=0;var ulUnicodeRange3=0;var ulUnicodeRange4=0;for(var i=0;i<font.glyphs.length;i+=1){var glyph=font.glyphs.get(i);var unicode=glyph.unicode|0;if(isNaN(glyph.advanceWidth)){throw new Error("Glyph "+glyph.name+" ("+i+"): advanceWidth is not a number.")}if(firstCharIndex>unicode||firstCharIndex===undefined){if(unicode>0){firstCharIndex=unicode}}if(lastCharIndex<unicode){lastCharIndex=unicode}var position=os2.getUnicodeRange(unicode);if(position<32){ulUnicodeRange1|=1<<position}else if(position<64){ulUnicodeRange2|=1<<position-32}else if(position<96){ulUnicodeRange3|=1<<position-64}else if(position<123){ulUnicodeRange4|=1<<position-96}else{throw new Error("Unicode ranges bits > 123 are reserved for internal usage")}if(glyph.name===".notdef"){continue}var metrics=glyph.getMetrics();xMins.push(metrics.xMin);yMins.push(metrics.yMin);xMaxs.push(metrics.xMax);yMaxs.push(metrics.yMax);leftSideBearings.push(metrics.leftSideBearing);rightSideBearings.push(metrics.rightSideBearing);advanceWidths.push(glyph.advanceWidth)}var globals={xMin:Math.min.apply(null,xMins),yMin:Math.min.apply(null,yMins),xMax:Math.max.apply(null,xMaxs),yMax:Math.max.apply(null,yMaxs),advanceWidthMax:Math.max.apply(null,advanceWidths),advanceWidthAvg:average(advanceWidths),minLeftSideBearing:Math.min.apply(null,leftSideBearings),maxLeftSideBearing:Math.max.apply(null,leftSideBearings),minRightSideBearing:Math.min.apply(null,rightSideBearings)};globals.ascender=font.ascender;globals.descender=font.descender;var headTable=head.make({flags:3,unitsPerEm:font.unitsPerEm,xMin:globals.xMin,yMin:globals.yMin,xMax:globals.xMax,yMax:globals.yMax,lowestRecPPEM:3,createdTimestamp:font.createdTimestamp});var hheaTable=hhea.make({ascender:globals.ascender,descender:globals.descender,advanceWidthMax:globals.advanceWidthMax,minLeftSideBearing:globals.minLeftSideBearing,minRightSideBearing:globals.minRightSideBearing,xMaxExtent:globals.maxLeftSideBearing+(globals.xMax-globals.xMin),numberOfHMetrics:font.glyphs.length});var maxpTable=maxp.make(font.glyphs.length);var os2Table=os2.make({xAvgCharWidth:Math.round(globals.advanceWidthAvg),usWeightClass:font.tables.os2.usWeightClass,usWidthClass:font.tables.os2.usWidthClass,usFirstCharIndex:firstCharIndex,usLastCharIndex:lastCharIndex,ulUnicodeRange1:ulUnicodeRange1,ulUnicodeRange2:ulUnicodeRange2,ulUnicodeRange3:ulUnicodeRange3,ulUnicodeRange4:ulUnicodeRange4,fsSelection:font.tables.os2.fsSelection,sTypoAscender:globals.ascender,sTypoDescender:globals.descender,sTypoLineGap:0,usWinAscent:globals.yMax,usWinDescent:Math.abs(globals.yMin),ulCodePageRange1:1,sxHeight:metricsForChar(font,"xyvw",{yMax:Math.round(globals.ascender/2)}).yMax,sCapHeight:metricsForChar(font,"HIKLEFJMNTZBDPRAGOQSUVWXY",globals).yMax,usDefaultChar:font.hasChar(" ")?32:0,usBreakChar:font.hasChar(" ")?32:0});var hmtxTable=hmtx.make(font.glyphs);var cmapTable=cmap.make(font.glyphs);var englishFamilyName=font.getEnglishName("fontFamily");var englishStyleName=font.getEnglishName("fontSubfamily");var englishFullName=englishFamilyName+" "+englishStyleName;var postScriptName=font.getEnglishName("postScriptName");if(!postScriptName){postScriptName=englishFamilyName.replace(/\s/g,"")+"-"+englishStyleName}var names={};for(var n in font.names){names[n]=font.names[n]}if(!names.uniqueID){names.uniqueID={en:font.getEnglishName("manufacturer")+":"+englishFullName}}if(!names.postScriptName){names.postScriptName={en:postScriptName}}if(!names.preferredFamily){names.preferredFamily=font.names.fontFamily}if(!names.preferredSubfamily){names.preferredSubfamily=font.names.fontSubfamily}var languageTags=[];var nameTable=_name.make(names,languageTags);var ltagTable=languageTags.length>0?ltag.make(languageTags):undefined;var postTable=post.make();var cffTable=cff.make(font.glyphs,{version:font.getEnglishName("version"),fullName:englishFullName,familyName:englishFamilyName,weightName:englishStyleName,postScriptName:postScriptName,unitsPerEm:font.unitsPerEm,fontBBox:[0,globals.yMin,globals.ascender,globals.advanceWidthMax]});var metaTable=font.metas&&Object.keys(font.metas).length>0?meta.make(font.metas):undefined;var tables=[headTable,hheaTable,maxpTable,os2Table,nameTable,cmapTable,postTable,cffTable,hmtxTable];if(ltagTable){tables.push(ltagTable)}if(font.tables.gsub){tables.push(gsub.make(font.tables.gsub))}if(metaTable){tables.push(metaTable)}var sfntTable=makeSfntTable(tables);var bytes=sfntTable.encode();var checkSum=computeCheckSum(bytes);var tableFields=sfntTable.fields;var checkSumAdjusted=false;for(var i$1=0;i$1<tableFields.length;i$1+=1){if(tableFields[i$1].name==="head table"){tableFields[i$1].value.checkSumAdjustment=2981146554-checkSum;checkSumAdjusted=true;break}}if(!checkSumAdjusted){throw new Error("Could not find head table with checkSum to adjust.")}return sfntTable}var sfnt={make:makeSfntTable,fontToTable:fontToSfntTable,computeCheckSum:computeCheckSum};function searchTag(arr,tag){var imin=0;var imax=arr.length-1;while(imin<=imax){var imid=imin+imax>>>1;var val=arr[imid].tag;if(val===tag){return imid}else if(val<tag){imin=imid+1}else{imax=imid-1}}return-imin-1}function binSearch(arr,value){var imin=0;var imax=arr.length-1;while(imin<=imax){var imid=imin+imax>>>1;var val=arr[imid];if(val===value){return imid}else if(val<value){imin=imid+1}else{imax=imid-1}}return-imin-1}function searchRange(ranges,value){var range;var imin=0;var imax=ranges.length-1;while(imin<=imax){var imid=imin+imax>>>1;range=ranges[imid];var start=range.start;if(start===value){return range}else if(start<value){imin=imid+1}else{imax=imid-1}}if(imin>0){range=ranges[imin-1];if(value>range.end){return 0}return range}}function Layout(font,tableName){this.font=font;this.tableName=tableName}Layout.prototype={searchTag:searchTag,binSearch:binSearch,getTable:function(create){var layout=this.font.tables[this.tableName];if(!layout&&create){layout=this.font.tables[this.tableName]=this.createDefaultTable()}return layout},getScriptNames:function(){var layout=this.getTable();if(!layout){return[]}return layout.scripts.map(function(script){return script.tag})},getDefaultScriptName:function(){var layout=this.getTable();if(!layout){return}var hasLatn=false;for(var i=0;i<layout.scripts.length;i++){var name=layout.scripts[i].tag;if(name==="DFLT"){return name}if(name==="latn"){hasLatn=true}}if(hasLatn){return"latn"}},getScriptTable:function(script,create){var layout=this.getTable(create);if(layout){script=script||"DFLT";var scripts=layout.scripts;var pos=searchTag(layout.scripts,script);if(pos>=0){return scripts[pos].script}else if(create){var scr={tag:script,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};scripts.splice(-1-pos,0,scr);return scr.script}}},getLangSysTable:function(script,language,create){var scriptTable=this.getScriptTable(script,create);if(scriptTable){if(!language||language==="dflt"||language==="DFLT"){return scriptTable.defaultLangSys}var pos=searchTag(scriptTable.langSysRecords,language);if(pos>=0){return scriptTable.langSysRecords[pos].langSys}else if(create){var langSysRecord={tag:language,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};scriptTable.langSysRecords.splice(-1-pos,0,langSysRecord);return langSysRecord.langSys}}},getFeatureTable:function(script,language,feature,create){var langSysTable=this.getLangSysTable(script,language,create);if(langSysTable){var featureRecord;var featIndexes=langSysTable.featureIndexes;var allFeatures=this.font.tables[this.tableName].features;for(var i=0;i<featIndexes.length;i++){featureRecord=allFeatures[featIndexes[i]];if(featureRecord.tag===feature){return featureRecord.feature}}if(create){var index=allFeatures.length;check.assert(index===0||feature>=allFeatures[index-1].tag,"Features must be added in alphabetical order.");featureRecord={tag:feature,feature:{params:0,lookupListIndexes:[]}};allFeatures.push(featureRecord);featIndexes.push(index);return featureRecord.feature}}},getLookupTables:function(script,language,feature,lookupType,create){var featureTable=this.getFeatureTable(script,language,feature,create);var tables=[];if(featureTable){var lookupTable;var lookupListIndexes=featureTable.lookupListIndexes;var allLookups=this.font.tables[this.tableName].lookups;for(var i=0;i<lookupListIndexes.length;i++){lookupTable=allLookups[lookupListIndexes[i]];if(lookupTable.lookupType===lookupType){tables.push(lookupTable)}}if(tables.length===0&&create){lookupTable={lookupType:lookupType,lookupFlag:0,subtables:[],markFilteringSet:undefined};var index=allLookups.length;allLookups.push(lookupTable);lookupListIndexes.push(index);return[lookupTable]}}return tables},getGlyphClass:function(classDefTable,glyphIndex){switch(classDefTable.format){case 1:if(classDefTable.startGlyph<=glyphIndex&&glyphIndex<classDefTable.startGlyph+classDefTable.classes.length){return classDefTable.classes[glyphIndex-classDefTable.startGlyph]}return 0;case 2:var range=searchRange(classDefTable.ranges,glyphIndex);return range?range.classId:0}},getCoverageIndex:function(coverageTable,glyphIndex){switch(coverageTable.format){case 1:var index=binSearch(coverageTable.glyphs,glyphIndex);return index>=0?index:-1;case 2:var range=searchRange(coverageTable.ranges,glyphIndex);return range?range.index+glyphIndex-range.start:-1}},expandCoverage:function(coverageTable){if(coverageTable.format===1){return coverageTable.glyphs}else{var glyphs=[];var ranges=coverageTable.ranges;for(var i=0;i<ranges.length;i++){var range=ranges[i];var start=range.start;var end=range.end;for(var j=start;j<=end;j++){glyphs.push(j)}}return glyphs}}};function Position(font){Layout.call(this,font,"gpos")}Position.prototype=Layout.prototype;Position.prototype.init=function(){var script=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(script)};Position.prototype.getKerningValue=function(kerningLookups,leftIndex,rightIndex){var this$1=this;for(var i=0;i<kerningLookups.length;i++){var subtables=kerningLookups[i].subtables;for(var j=0;j<subtables.length;j++){var subtable=subtables[j];var covIndex=this$1.getCoverageIndex(subtable.coverage,leftIndex);if(covIndex<0){continue}switch(subtable.posFormat){case 1:var pairSet=subtable.pairSets[covIndex];for(var k=0;k<pairSet.length;k++){var pair=pairSet[k];if(pair.secondGlyph===rightIndex){return pair.value1&&pair.value1.xAdvance||0}}break;case 2:var class1=this$1.getGlyphClass(subtable.classDef1,leftIndex);var class2=this$1.getGlyphClass(subtable.classDef2,rightIndex);var pair$1=subtable.classRecords[class1][class2];return pair$1.value1&&pair$1.value1.xAdvance||0}}}return 0};Position.prototype.getKerningTables=function(script,language){if(this.font.tables.gpos){return this.getLookupTables(script,language,"kern",2)}};function Substitution(font){Layout.call(this,font,"gsub")}function arraysEqual(ar1,ar2){var n=ar1.length;if(n!==ar2.length){return false}for(var i=0;i<n;i++){if(ar1[i]!==ar2[i]){return false}}return true}function getSubstFormat(lookupTable,format,defaultSubtable){var subtables=lookupTable.subtables;for(var i=0;i<subtables.length;i++){var subtable=subtables[i];if(subtable.substFormat===format){return subtable}}if(defaultSubtable){subtables.push(defaultSubtable);return defaultSubtable}return undefined}Substitution.prototype=Layout.prototype;Substitution.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}};Substitution.prototype.getSingle=function(feature,script,language){var this$1=this;var substitutions=[];var lookupTables=this.getLookupTables(script,language,feature,1);for(var idx=0;idx<lookupTables.length;idx++){var subtables=lookupTables[idx].subtables;for(var i=0;i<subtables.length;i++){var subtable=subtables[i];var glyphs=this$1.expandCoverage(subtable.coverage);var j=void 0;if(subtable.substFormat===1){var delta=subtable.deltaGlyphId;for(j=0;j<glyphs.length;j++){var glyph=glyphs[j];substitutions.push({sub:glyph,by:glyph+delta})}}else{var substitute=subtable.substitute;for(j=0;j<glyphs.length;j++){substitutions.push({sub:glyphs[j],by:substitute[j]})}}}}return substitutions};Substitution.prototype.getAlternates=function(feature,script,language){var this$1=this;var alternates=[];var lookupTables=this.getLookupTables(script,language,feature,3);for(var idx=0;idx<lookupTables.length;idx++){var subtables=lookupTables[idx].subtables;for(var i=0;i<subtables.length;i++){var subtable=subtables[i];var glyphs=this$1.expandCoverage(subtable.coverage);var alternateSets=subtable.alternateSets;for(var j=0;j<glyphs.length;j++){alternates.push({sub:glyphs[j],by:alternateSets[j]})}}}return alternates};Substitution.prototype.getLigatures=function(feature,script,language){var this$1=this;var ligatures=[];var lookupTables=this.getLookupTables(script,language,feature,4);for(var idx=0;idx<lookupTables.length;idx++){var subtables=lookupTables[idx].subtables;for(var i=0;i<subtables.length;i++){var subtable=subtables[i];var glyphs=this$1.expandCoverage(subtable.coverage);var ligatureSets=subtable.ligatureSets;for(var j=0;j<glyphs.length;j++){var startGlyph=glyphs[j];var ligSet=ligatureSets[j];for(var k=0;k<ligSet.length;k++){var lig=ligSet[k];ligatures.push({sub:[startGlyph].concat(lig.components),by:lig.ligGlyph})}}}}return ligatures};Substitution.prototype.addSingle=function(feature,substitution,script,language){var lookupTable=this.getLookupTables(script,language,feature,1,true)[0];var subtable=getSubstFormat(lookupTable,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});check.assert(subtable.coverage.format===1,"Ligature: unable to modify coverage table format "+subtable.coverage.format);var coverageGlyph=substitution.sub;var pos=this.binSearch(subtable.coverage.glyphs,coverageGlyph);if(pos<0){pos=-1-pos;subtable.coverage.glyphs.splice(pos,0,coverageGlyph);subtable.substitute.splice(pos,0,0)}subtable.substitute[pos]=substitution.by};Substitution.prototype.addAlternate=function(feature,substitution,script,language){var lookupTable=this.getLookupTables(script,language,feature,3,true)[0];var subtable=getSubstFormat(lookupTable,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});check.assert(subtable.coverage.format===1,"Ligature: unable to modify coverage table format "+subtable.coverage.format);var coverageGlyph=substitution.sub;var pos=this.binSearch(subtable.coverage.glyphs,coverageGlyph);if(pos<0){pos=-1-pos;subtable.coverage.glyphs.splice(pos,0,coverageGlyph);subtable.alternateSets.splice(pos,0,0)}subtable.alternateSets[pos]=substitution.by};Substitution.prototype.addLigature=function(feature,ligature,script,language){var lookupTable=this.getLookupTables(script,language,feature,4,true)[0];var subtable=lookupTable.subtables[0];if(!subtable){subtable={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]};lookupTable.subtables[0]=subtable}check.assert(subtable.coverage.format===1,"Ligature: unable to modify coverage table format "+subtable.coverage.format);var coverageGlyph=ligature.sub[0];var ligComponents=ligature.sub.slice(1);var ligatureTable={ligGlyph:ligature.by,components:ligComponents};var pos=this.binSearch(subtable.coverage.glyphs,coverageGlyph);if(pos>=0){var ligatureSet=subtable.ligatureSets[pos];for(var i=0;i<ligatureSet.length;i++){if(arraysEqual(ligatureSet[i].components,ligComponents)){return}}ligatureSet.push(ligatureTable)}else{pos=-1-pos;subtable.coverage.glyphs.splice(pos,0,coverageGlyph);subtable.ligatureSets.splice(pos,0,[ligatureTable])}};Substitution.prototype.getFeature=function(feature,script,language){if(/ss\d\d/.test(feature)){return this.getSingle(feature,script,language)}switch(feature){case"aalt":case"salt":return this.getSingle(feature,script,language).concat(this.getAlternates(feature,script,language));case"dlig":case"liga":case"rlig":return this.getLigatures(feature,script,language)}return undefined};Substitution.prototype.add=function(feature,sub,script,language){if(/ss\d\d/.test(feature)){return this.addSingle(feature,sub,script,language)}switch(feature){case"aalt":case"salt":if(typeof sub.by==="number"){return this.addSingle(feature,sub,script,language)}return this.addAlternate(feature,sub,script,language);case"dlig":case"liga":case"rlig":return this.addLigature(feature,sub,script,language)}return undefined};function isBrowser(){return typeof window!=="undefined"}function nodeBufferToArrayBuffer(buffer){var ab=new ArrayBuffer(buffer.length);var view=new Uint8Array(ab);for(var i=0;i<buffer.length;++i){view[i]=buffer[i]}return ab}function arrayBufferToNodeBuffer(ab){var buffer=new Buffer(ab.byteLength);var view=new Uint8Array(ab);for(var i=0;i<buffer.length;++i){buffer[i]=view[i]}return buffer}function checkArgument(expression,message){if(!expression){throw message}}function parseGlyphCoordinate(p,flag,previousValue,shortVectorBitMask,sameBitMask){var v;if((flag&shortVectorBitMask)>0){v=p.parseByte();if((flag&sameBitMask)===0){v=-v}v=previousValue+v}else{if((flag&sameBitMask)>0){v=previousValue}else{v=previousValue+p.parseShort()}}return v}function parseGlyph(glyph,data,start){var p=new parse.Parser(data,start);glyph.numberOfContours=p.parseShort();glyph._xMin=p.parseShort();glyph._yMin=p.parseShort();glyph._xMax=p.parseShort();glyph._yMax=p.parseShort();var flags;var flag;if(glyph.numberOfContours>0){var endPointIndices=glyph.endPointIndices=[];for(var i=0;i<glyph.numberOfContours;i+=1){endPointIndices.push(p.parseUShort())}glyph.instructionLength=p.parseUShort();glyph.instructions=[];for(var i$1=0;i$1<glyph.instructionLength;i$1+=1){glyph.instructions.push(p.parseByte())}var numberOfCoordinates=endPointIndices[endPointIndices.length-1]+1;flags=[];for(var i$2=0;i$2<numberOfCoordinates;i$2+=1){flag=p.parseByte();flags.push(flag);if((flag&8)>0){var repeatCount=p.parseByte();for(var j=0;j<repeatCount;j+=1){flags.push(flag);i$2+=1}}}check.argument(flags.length===numberOfCoordinates,"Bad flags.");if(endPointIndices.length>0){var points=[];var point;if(numberOfCoordinates>0){for(var i$3=0;i$3<numberOfCoordinates;i$3+=1){flag=flags[i$3];point={};point.onCurve=!!(flag&1);point.lastPointOfContour=endPointIndices.indexOf(i$3)>=0;points.push(point)}var px=0;for(var i$4=0;i$4<numberOfCoordinates;i$4+=1){flag=flags[i$4];point=points[i$4];point.x=parseGlyphCoordinate(p,flag,px,2,16);px=point.x}var py=0;for(var i$5=0;i$5<numberOfCoordinates;i$5+=1){flag=flags[i$5];point=points[i$5];point.y=parseGlyphCoordinate(p,flag,py,4,32);py=point.y}}glyph.points=points}else{glyph.points=[]}}else if(glyph.numberOfContours===0){glyph.points=[]}else{glyph.isComposite=true;glyph.points=[];glyph.components=[];var moreComponents=true;while(moreComponents){flags=p.parseUShort();var component={glyphIndex:p.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};if((flags&1)>0){if((flags&2)>0){component.dx=p.parseShort();component.dy=p.parseShort()}else{component.matchedPoints=[p.parseUShort(),p.parseUShort()]}}else{if((flags&2)>0){component.dx=p.parseChar();component.dy=p.parseChar()}else{component.matchedPoints=[p.parseByte(),p.parseByte()]}}if((flags&8)>0){component.xScale=component.yScale=p.parseF2Dot14()}else if((flags&64)>0){component.xScale=p.parseF2Dot14();component.yScale=p.parseF2Dot14()}else if((flags&128)>0){component.xScale=p.parseF2Dot14();component.scale01=p.parseF2Dot14();component.scale10=p.parseF2Dot14();component.yScale=p.parseF2Dot14()}glyph.components.push(component);moreComponents=!!(flags&32)}if(flags&256){glyph.instructionLength=p.parseUShort();glyph.instructions=[];for(var i$6=0;i$6<glyph.instructionLength;i$6+=1){glyph.instructions.push(p.parseByte())}}}}function transformPoints(points,transform){var newPoints=[];for(var i=0;i<points.length;i+=1){var pt=points[i];var newPt={x:transform.xScale*pt.x+transform.scale01*pt.y+transform.dx,y:transform.scale10*pt.x+transform.yScale*pt.y+transform.dy,onCurve:pt.onCurve,lastPointOfContour:pt.lastPointOfContour};newPoints.push(newPt)}return newPoints}function getContours(points){var contours=[];var currentContour=[];for(var i=0;i<points.length;i+=1){var pt=points[i];currentContour.push(pt);if(pt.lastPointOfContour){contours.push(currentContour);currentContour=[]}}check.argument(currentContour.length===0,"There are still points left in the current contour.");return contours}function getPath(points){var p=new Path;if(!points){return p}var contours=getContours(points);for(var contourIndex=0;contourIndex<contours.length;++contourIndex){var contour=contours[contourIndex];var prev=null;var curr=contour[contour.length-1];var next=contour[0];if(curr.onCurve){p.moveTo(curr.x,curr.y)}else{if(next.onCurve){p.moveTo(next.x,next.y)}else{var start={x:(curr.x+next.x)*.5,y:(curr.y+next.y)*.5};p.moveTo(start.x,start.y)}}for(var i=0;i<contour.length;++i){prev=curr;curr=next;next=contour[(i+1)%contour.length];if(curr.onCurve){p.lineTo(curr.x,curr.y)}else{var prev2=prev;var next2=next;if(!prev.onCurve){prev2={x:(curr.x+prev.x)*.5,y:(curr.y+prev.y)*.5}}if(!next.onCurve){next2={x:(curr.x+next.x)*.5,y:(curr.y+next.y)*.5}}p.quadraticCurveTo(curr.x,curr.y,next2.x,next2.y)}}p.closePath()}return p}function buildPath(glyphs,glyph){if(glyph.isComposite){for(var j=0;j<glyph.components.length;j+=1){var component=glyph.components[j];var componentGlyph=glyphs.get(component.glyphIndex);componentGlyph.getPath();if(componentGlyph.points){var transformedPoints=void 0;if(component.matchedPoints===undefined){transformedPoints=transformPoints(componentGlyph.points,component)}else{if(component.matchedPoints[0]>glyph.points.length-1||component.matchedPoints[1]>componentGlyph.points.length-1){throw Error("Matched points out of range in "+glyph.name)}var firstPt=glyph.points[component.matchedPoints[0]];var secondPt=componentGlyph.points[component.matchedPoints[1]];var transform={xScale:component.xScale,scale01:component.scale01,scale10:component.scale10,yScale:component.yScale,dx:0,dy:0};secondPt=transformPoints([secondPt],transform)[0];transform.dx=firstPt.x-secondPt.x;transform.dy=firstPt.y-secondPt.y;transformedPoints=transformPoints(componentGlyph.points,transform)}glyph.points=glyph.points.concat(transformedPoints)}}}return getPath(glyph.points)}function parseGlyfTable(data,start,loca,font){var glyphs=new glyphset.GlyphSet(font);for(var i=0;i<loca.length-1;i+=1){var offset=loca[i];var nextOffset=loca[i+1];if(offset!==nextOffset){glyphs.push(i,glyphset.ttfGlyphLoader(font,i,parseGlyph,data,start+offset,buildPath))}else{glyphs.push(i,glyphset.glyphLoader(font,i))}}return glyphs}var glyf={getPath:getPath,parse:parseGlyfTable};var instructionTable;var exec;var execGlyph;var execComponent;function Hinting(font){this.font=font;this.getCommands=function(hPoints){return glyf.getPath(hPoints).commands};this._fpgmState=this._prepState=undefined;this._errorState=0}function roundOff(v){return v}function roundToGrid(v){return Math.sign(v)*Math.round(Math.abs(v))}function roundToDoubleGrid(v){return Math.sign(v)*Math.round(Math.abs(v*2))/2}function roundToHalfGrid(v){return Math.sign(v)*(Math.round(Math.abs(v)+.5)-.5)}function roundUpToGrid(v){return Math.sign(v)*Math.ceil(Math.abs(v))}function roundDownToGrid(v){return Math.sign(v)*Math.floor(Math.abs(v))}var roundSuper=function(v){var period=this.srPeriod;var phase=this.srPhase;var threshold=this.srThreshold;var sign=1;if(v<0){v=-v;sign=-1}v+=threshold-phase;v=Math.trunc(v/period)*period;v+=phase;if(v<0){return phase*sign}return v*sign};var xUnitVector={x:1,y:0,axis:"x",distance:function(p1,p2,o1,o2){return(o1?p1.xo:p1.x)-(o2?p2.xo:p2.x)},interpolate:function(p,rp1,rp2,pv){var do1;var do2;var doa1;var doa2;var dm1;var dm2;var dt;if(!pv||pv===this){do1=p.xo-rp1.xo;do2=p.xo-rp2.xo;dm1=rp1.x-rp1.xo;dm2=rp2.x-rp2.xo;doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){p.x=p.xo+(dm1+dm2)/2;return}p.x=p.xo+(dm1*doa2+dm2*doa1)/dt;return}do1=pv.distance(p,rp1,true,true);do2=pv.distance(p,rp2,true,true);dm1=pv.distance(rp1,rp1,false,true);dm2=pv.distance(rp2,rp2,false,true);doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){xUnitVector.setRelative(p,p,(dm1+dm2)/2,pv,true);return}xUnitVector.setRelative(p,p,(dm1*doa2+dm2*doa1)/dt,pv,true)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(p,rp,d,pv,org){if(!pv||pv===this){p.x=(org?rp.xo:rp.x)+d;return}var rpx=org?rp.xo:rp.x;var rpy=org?rp.yo:rp.y;var rpdx=rpx+d*pv.x;var rpdy=rpy+d*pv.y;p.x=rpdx+(p.y-rpdy)/pv.normalSlope},slope:0,touch:function(p){p.xTouched=true},touched:function(p){return p.xTouched},untouch:function(p){p.xTouched=false}};var yUnitVector={x:0,y:1,axis:"y",distance:function(p1,p2,o1,o2){return(o1?p1.yo:p1.y)-(o2?p2.yo:p2.y)},interpolate:function(p,rp1,rp2,pv){var do1;var do2;var doa1;var doa2;var dm1;var dm2;var dt;if(!pv||pv===this){do1=p.yo-rp1.yo;do2=p.yo-rp2.yo;dm1=rp1.y-rp1.yo;dm2=rp2.y-rp2.yo;doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){p.y=p.yo+(dm1+dm2)/2;return}p.y=p.yo+(dm1*doa2+dm2*doa1)/dt;return}do1=pv.distance(p,rp1,true,true);do2=pv.distance(p,rp2,true,true);dm1=pv.distance(rp1,rp1,false,true);dm2=pv.distance(rp2,rp2,false,true);doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){yUnitVector.setRelative(p,p,(dm1+dm2)/2,pv,true);return}yUnitVector.setRelative(p,p,(dm1*doa2+dm2*doa1)/dt,pv,true)},normalSlope:0,setRelative:function(p,rp,d,pv,org){if(!pv||pv===this){p.y=(org?rp.yo:rp.y)+d;return}var rpx=org?rp.xo:rp.x;var rpy=org?rp.yo:rp.y;var rpdx=rpx+d*pv.x;var rpdy=rpy+d*pv.y;p.y=rpdy+pv.normalSlope*(p.x-rpdx)},slope:Number.POSITIVE_INFINITY,touch:function(p){p.yTouched=true},touched:function(p){return p.yTouched},untouch:function(p){p.yTouched=false}};Object.freeze(xUnitVector);Object.freeze(yUnitVector);function UnitVector(x,y){this.x=x;this.y=y;this.axis=undefined;this.slope=y/x;this.normalSlope=-x/y;Object.freeze(this)}UnitVector.prototype.distance=function(p1,p2,o1,o2){return this.x*xUnitVector.distance(p1,p2,o1,o2)+this.y*yUnitVector.distance(p1,p2,o1,o2)};UnitVector.prototype.interpolate=function(p,rp1,rp2,pv){var dm1;var dm2;var do1;var do2;var doa1;var doa2;var dt;do1=pv.distance(p,rp1,true,true);do2=pv.distance(p,rp2,true,true);dm1=pv.distance(rp1,rp1,false,true);dm2=pv.distance(rp2,rp2,false,true);doa1=Math.abs(do1);doa2=Math.abs(do2);dt=doa1+doa2;if(dt===0){this.setRelative(p,p,(dm1+dm2)/2,pv,true);return}this.setRelative(p,p,(dm1*doa2+dm2*doa1)/dt,pv,true)};UnitVector.prototype.setRelative=function(p,rp,d,pv,org){pv=pv||this;var rpx=org?rp.xo:rp.x;var rpy=org?rp.yo:rp.y;var rpdx=rpx+d*pv.x;var rpdy=rpy+d*pv.y;var pvns=pv.normalSlope;var fvs=this.slope;var px=p.x;var py=p.y;p.x=(fvs*px-pvns*rpdx+rpdy-py)/(fvs-pvns);p.y=fvs*(p.x-px)+py};UnitVector.prototype.touch=function(p){p.xTouched=true;p.yTouched=true};function getUnitVector(x,y){var d=Math.sqrt(x*x+y*y);x/=d;y/=d;if(x===1&&y===0){return xUnitVector}else if(x===0&&y===1){return yUnitVector}else{return new UnitVector(x,y)}}function HPoint(x,y,lastPointOfContour,onCurve){this.x=this.xo=Math.round(x*64)/64;this.y=this.yo=Math.round(y*64)/64;this.lastPointOfContour=lastPointOfContour;this.onCurve=onCurve;this.prevPointOnContour=undefined;this.nextPointOnContour=undefined;this.xTouched=false;this.yTouched=false;Object.preventExtensions(this)}HPoint.prototype.nextTouched=function(v){var p=this.nextPointOnContour;while(!v.touched(p)&&p!==this){p=p.nextPointOnContour}return p};HPoint.prototype.prevTouched=function(v){var p=this.prevPointOnContour;while(!v.touched(p)&&p!==this){p=p.prevPointOnContour}return p};var HPZero=Object.freeze(new HPoint(0,0));var defaultState={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:true};function State(env,prog){this.env=env;this.stack=[];this.prog=prog;switch(env){case"glyf":this.zp0=this.zp1=this.zp2=1;this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=xUnitVector;this.round=roundToGrid}}Hinting.prototype.exec=function(glyph,ppem){if(typeof ppem!=="number"){throw new Error("Point size is not a number!")}if(this._errorState>2){return}var font=this.font;var prepState=this._prepState;if(!prepState||prepState.ppem!==ppem){var fpgmState=this._fpgmState;if(!fpgmState){State.prototype=defaultState;fpgmState=this._fpgmState=new State("fpgm",font.tables.fpgm);fpgmState.funcs=[];fpgmState.font=font;if(exports.DEBUG){console.log("---EXEC FPGM---");fpgmState.step=-1}try{exec(fpgmState)}catch(e){console.log("Hinting error in FPGM:"+e);this._errorState=3;return}}State.prototype=fpgmState;prepState=this._prepState=new State("prep",font.tables.prep);prepState.ppem=ppem;var oCvt=font.tables.cvt;if(oCvt){var cvt=prepState.cvt=new Array(oCvt.length);var scale=ppem/font.unitsPerEm;for(var c=0;c<oCvt.length;c++){cvt[c]=oCvt[c]*scale}}else{prepState.cvt=[]}if(exports.DEBUG){console.log("---EXEC PREP---");prepState.step=-1}try{exec(prepState)}catch(e){if(this._errorState<2){console.log("Hinting error in PREP:"+e)}this._errorState=2}}if(this._errorState>1){return}try{return execGlyph(glyph,prepState)}catch(e){if(this._errorState<1){console.log("Hinting error:"+e);console.log("Note: further hinting errors are silenced")}this._errorState=1;return undefined}};execGlyph=function(glyph,prepState){var xScale=prepState.ppem/prepState.font.unitsPerEm;var yScale=xScale;var components=glyph.components;var contours;var gZone;var state;State.prototype=prepState;if(!components){state=new State("glyf",glyph.instructions);if(exports.DEBUG){console.log("---EXEC GLYPH---");state.step=-1}execComponent(glyph,state,xScale,yScale);gZone=state.gZone}else{var font=prepState.font;gZone=[];contours=[];for(var i=0;i<components.length;i++){var c=components[i];var cg=font.glyphs.get(c.glyphIndex);state=new State("glyf",cg.instructions);if(exports.DEBUG){console.log("---EXEC COMP "+i+"---");state.step=-1}execComponent(cg,state,xScale,yScale);var dx=Math.round(c.dx*xScale);var dy=Math.round(c.dy*yScale);var gz=state.gZone;var cc=state.contours;for(var pi=0;pi<gz.length;pi++){var p=gz[pi];p.xTouched=p.yTouched=false;p.xo=p.x=p.x+dx;p.yo=p.y=p.y+dy}var gLen=gZone.length;gZone.push.apply(gZone,gz);for(var j=0;j<cc.length;j++){contours.push(cc[j]+gLen)}}if(glyph.instructions&&!state.inhibitGridFit){state=new State("glyf",glyph.instructions);state.gZone=state.z0=state.z1=state.z2=gZone;state.contours=contours;gZone.push(new HPoint(0,0),new HPoint(Math.round(glyph.advanceWidth*xScale),0));if(exports.DEBUG){console.log("---EXEC COMPOSITE---");state.step=-1}exec(state);gZone.length-=2}}return gZone};execComponent=function(glyph,state,xScale,yScale){var points=glyph.points||[];var pLen=points.length;var gZone=state.gZone=state.z0=state.z1=state.z2=[];var contours=state.contours=[];var cp;for(var i=0;i<pLen;i++){cp=points[i];gZone[i]=new HPoint(cp.x*xScale,cp.y*yScale,cp.lastPointOfContour,cp.onCurve)}var sp;var np;for(var i$1=0;i$1<pLen;i$1++){cp=gZone[i$1];if(!sp){sp=cp;contours.push(i$1)}if(cp.lastPointOfContour){cp.nextPointOnContour=sp;sp.prevPointOnContour=cp;sp=undefined}else{np=gZone[i$1+1];cp.nextPointOnContour=np;np.prevPointOnContour=cp}}if(state.inhibitGridFit){return}if(exports.DEBUG){console.log("PROCESSING GLYPH",state.stack);for(var i$2=0;i$2<pLen;i$2++){console.log(i$2,gZone[i$2].x,gZone[i$2].y)}}gZone.push(new HPoint(0,0),new HPoint(Math.round(glyph.advanceWidth*xScale),0));exec(state);gZone.length-=2;if(exports.DEBUG){console.log("FINISHED GLYPH",state.stack);for(var i$3=0;i$3<pLen;i$3++){console.log(i$3,gZone[i$3].x,gZone[i$3].y)}}};exec=function(state){var prog=state.prog;if(!prog){return}var pLen=prog.length;var ins;for(state.ip=0;state.ip<pLen;state.ip++){if(exports.DEBUG){state.step++}ins=instructionTable[prog[state.ip]];if(!ins){throw new Error("unknown instruction: 0x"+Number(prog[state.ip]).toString(16))}ins(state)}};function initTZone(state){var tZone=state.tZone=new Array(state.gZone.length);for(var i=0;i<tZone.length;i++){tZone[i]=new HPoint(0,0)}}function skip(state,handleElse){var prog=state.prog;var ip=state.ip;var nesting=1;var ins;do{ins=prog[++ip];if(ins===88){nesting++}else if(ins===89){nesting--}else if(ins===64){ip+=prog[ip+1]+1}else if(ins===65){ip+=2*prog[ip+1]+1}else if(ins>=176&&ins<=183){ip+=ins-176+1}else if(ins>=184&&ins<=191){ip+=(ins-184+1)*2}else if(handleElse&&nesting===1&&ins===27){break}}while(nesting>0);state.ip=ip}function SVTCA(v,state){if(exports.DEBUG){console.log(state.step,"SVTCA["+v.axis+"]")}state.fv=state.pv=state.dpv=v}function SPVTCA(v,state){if(exports.DEBUG){console.log(state.step,"SPVTCA["+v.axis+"]")}state.pv=state.dpv=v}function SFVTCA(v,state){if(exports.DEBUG){console.log(state.step,"SFVTCA["+v.axis+"]")}state.fv=v}function SPVTL(a,state){var stack=state.stack;var p2i=stack.pop();var p1i=stack.pop();var p2=state.z2[p2i];var p1=state.z1[p1i];if(exports.DEBUG){console.log("SPVTL["+a+"]",p2i,p1i)}var dx;var dy;if(!a){dx=p1.x-p2.x;dy=p1.y-p2.y}else{dx=p2.y-p1.y;dy=p1.x-p2.x}state.pv=state.dpv=getUnitVector(dx,dy)}function SFVTL(a,state){var stack=state.stack;var p2i=stack.pop();var p1i=stack.pop();var p2=state.z2[p2i];var p1=state.z1[p1i];if(exports.DEBUG){console.log("SFVTL["+a+"]",p2i,p1i)}var dx;var dy;if(!a){dx=p1.x-p2.x;dy=p1.y-p2.y}else{dx=p2.y-p1.y;dy=p1.x-p2.x}state.fv=getUnitVector(dx,dy)}function SPVFS(state){var stack=state.stack;var y=stack.pop();var x=stack.pop();if(exports.DEBUG){console.log(state.step,"SPVFS[]",y,x)}state.pv=state.dpv=getUnitVector(x,y)}function SFVFS(state){var stack=state.stack;var y=stack.pop();var x=stack.pop();if(exports.DEBUG){console.log(state.step,"SPVFS[]",y,x)}state.fv=getUnitVector(x,y)}function GPV(state){var stack=state.stack;var pv=state.pv;if(exports.DEBUG){console.log(state.step,"GPV[]")}stack.push(pv.x*16384);stack.push(pv.y*16384)}function GFV(state){var stack=state.stack;var fv=state.fv;if(exports.DEBUG){console.log(state.step,"GFV[]")}stack.push(fv.x*16384);stack.push(fv.y*16384)}function SFVTPV(state){state.fv=state.pv;if(exports.DEBUG){console.log(state.step,"SFVTPV[]")}}function ISECT(state){var stack=state.stack;var pa0i=stack.pop();var pa1i=stack.pop();var pb0i=stack.pop();var pb1i=stack.pop();var pi=stack.pop();var z0=state.z0;var z1=state.z1;var pa0=z0[pa0i];var pa1=z0[pa1i];var pb0=z1[pb0i];var pb1=z1[pb1i];var p=state.z2[pi];if(exports.DEBUG){console.log("ISECT[], ",pa0i,pa1i,pb0i,pb1i,pi)}var x1=pa0.x;var y1=pa0.y;var x2=pa1.x;var y2=pa1.y;var x3=pb0.x;var y3=pb0.y;var x4=pb1.x;var y4=pb1.y;var div=(x1-x2)*(y3-y4)-(y1-y2)*(x3-x4);var f1=x1*y2-y1*x2;var f2=x3*y4-y3*x4;p.x=(f1*(x3-x4)-f2*(x1-x2))/div;p.y=(f1*(y3-y4)-f2*(y1-y2))/div}function SRP0(state){state.rp0=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SRP0[]",state.rp0)}}function SRP1(state){state.rp1=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SRP1[]",state.rp1)}}function SRP2(state){state.rp2=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SRP2[]",state.rp2)}}function SZP0(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SZP0[]",n)}state.zp0=n;switch(n){case 0:if(!state.tZone){initTZone(state)}state.z0=state.tZone;break;case 1:state.z0=state.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZP1(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SZP1[]",n)}state.zp1=n;switch(n){case 0:if(!state.tZone){initTZone(state)}state.z1=state.tZone;break;case 1:state.z1=state.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZP2(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SZP2[]",n)}state.zp2=n;switch(n){case 0:if(!state.tZone){initTZone(state)}state.z2=state.tZone;break;case 1:state.z2=state.gZone;break;default:throw new Error("Invalid zone pointer")}}function SZPS(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SZPS[]",n)}state.zp0=state.zp1=state.zp2=n;switch(n){case 0:if(!state.tZone){initTZone(state)}state.z0=state.z1=state.z2=state.tZone;break;case 1:state.z0=state.z1=state.z2=state.gZone;break;default:throw new Error("Invalid zone pointer")}}function SLOOP(state){state.loop=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SLOOP[]",state.loop)}}function RTG(state){if(exports.DEBUG){console.log(state.step,"RTG[]")}state.round=roundToGrid}function RTHG(state){if(exports.DEBUG){console.log(state.step,"RTHG[]")}state.round=roundToHalfGrid}function SMD(state){var d=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SMD[]",d)}state.minDis=d/64}function ELSE(state){if(exports.DEBUG){console.log(state.step,"ELSE[]")}skip(state,false)}function JMPR(state){var o=state.stack.pop();if(exports.DEBUG){console.log(state.step,"JMPR[]",o)}state.ip+=o-1}function SCVTCI(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SCVTCI[]",n)}state.cvCutIn=n/64}function DUP(state){var stack=state.stack;if(exports.DEBUG){console.log(state.step,"DUP[]")}stack.push(stack[stack.length-1])}function POP(state){if(exports.DEBUG){console.log(state.step,"POP[]")}state.stack.pop()}function CLEAR(state){if(exports.DEBUG){console.log(state.step,"CLEAR[]")}state.stack.length=0}function SWAP(state){var stack=state.stack;var a=stack.pop();var b=stack.pop();if(exports.DEBUG){console.log(state.step,"SWAP[]")}stack.push(a);stack.push(b)}function DEPTH(state){var stack=state.stack;if(exports.DEBUG){console.log(state.step,"DEPTH[]")}stack.push(stack.length)}function LOOPCALL(state){var stack=state.stack;var fn=stack.pop();var c=stack.pop();if(exports.DEBUG){console.log(state.step,"LOOPCALL[]",fn,c)}var cip=state.ip;var cprog=state.prog;state.prog=state.funcs[fn];for(var i=0;i<c;i++){exec(state);if(exports.DEBUG){console.log(++state.step,i+1<c?"next loopcall":"done loopcall",i)}}state.ip=cip;state.prog=cprog}function CALL(state){var fn=state.stack.pop();if(exports.DEBUG){console.log(state.step,"CALL[]",fn)}var cip=state.ip;var cprog=state.prog;state.prog=state.funcs[fn];exec(state);state.ip=cip;state.prog=cprog;if(exports.DEBUG){console.log(++state.step,"returning from",fn)}}function CINDEX(state){var stack=state.stack;var k=stack.pop();if(exports.DEBUG){console.log(state.step,"CINDEX[]",k)}stack.push(stack[stack.length-k])}function MINDEX(state){var stack=state.stack;var k=stack.pop();if(exports.DEBUG){console.log(state.step,"MINDEX[]",k)}stack.push(stack.splice(stack.length-k,1)[0])}function FDEF(state){if(state.env!=="fpgm"){throw new Error("FDEF not allowed here")}var stack=state.stack;var prog=state.prog;var ip=state.ip;var fn=stack.pop();var ipBegin=ip;if(exports.DEBUG){console.log(state.step,"FDEF[]",fn)}while(prog[++ip]!==45){}state.ip=ip;state.funcs[fn]=prog.slice(ipBegin+1,ip)}function MDAP(round,state){var pi=state.stack.pop();var p=state.z0[pi];var fv=state.fv;var pv=state.pv;if(exports.DEBUG){console.log(state.step,"MDAP["+round+"]",pi)}var d=pv.distance(p,HPZero);if(round){d=state.round(d)}fv.setRelative(p,HPZero,d,pv);fv.touch(p);state.rp0=state.rp1=pi}function IUP(v,state){var z2=state.z2;var pLen=z2.length-2;var cp;var pp;var np;if(exports.DEBUG){console.log(state.step,"IUP["+v.axis+"]")}for(var i=0;i<pLen;i++){cp=z2[i];if(v.touched(cp)){continue}pp=cp.prevTouched(v);if(pp===cp){continue}np=cp.nextTouched(v);if(pp===np){v.setRelative(cp,cp,v.distance(pp,pp,false,true),v,true)}v.interpolate(cp,pp,np,v)}}function SHP(a,state){var stack=state.stack;var rpi=a?state.rp1:state.rp2;var rp=(a?state.z0:state.z1)[rpi];var fv=state.fv;var pv=state.pv;var loop=state.loop;var z2=state.z2;while(loop--){var pi=stack.pop();var p=z2[pi];var d=pv.distance(rp,rp,false,true);fv.setRelative(p,p,d,pv);fv.touch(p);if(exports.DEBUG){console.log(state.step,(state.loop>1?"loop "+(state.loop-loop)+": ":"")+"SHP["+(a?"rp1":"rp2")+"]",pi)}}state.loop=1}function SHC(a,state){var stack=state.stack;var rpi=a?state.rp1:state.rp2;var rp=(a?state.z0:state.z1)[rpi];var fv=state.fv;var pv=state.pv;var ci=stack.pop();var sp=state.z2[state.contours[ci]];var p=sp;if(exports.DEBUG){console.log(state.step,"SHC["+a+"]",ci)}var d=pv.distance(rp,rp,false,true);do{if(p!==rp){fv.setRelative(p,p,d,pv)}p=p.nextPointOnContour}while(p!==sp)}function SHZ(a,state){var stack=state.stack;var rpi=a?state.rp1:state.rp2;var rp=(a?state.z0:state.z1)[rpi];var fv=state.fv;var pv=state.pv;var e=stack.pop();if(exports.DEBUG){console.log(state.step,"SHZ["+a+"]",e)}var z;switch(e){case 0:z=state.tZone;break;case 1:z=state.gZone;break;default:throw new Error("Invalid zone")}var p;var d=pv.distance(rp,rp,false,true);var pLen=z.length-2;for(var i=0;i<pLen;i++){p=z[i];fv.setRelative(p,p,d,pv)}}function SHPIX(state){var stack=state.stack;var loop=state.loop;var fv=state.fv;var d=stack.pop()/64;var z2=state.z2;while(loop--){var pi=stack.pop();var p=z2[pi];if(exports.DEBUG){console.log(state.step,(state.loop>1?"loop "+(state.loop-loop)+": ":"")+"SHPIX[]",pi,d)}fv.setRelative(p,p,d);fv.touch(p)}state.loop=1}function IP(state){var stack=state.stack;var rp1i=state.rp1;var rp2i=state.rp2;var loop=state.loop;var rp1=state.z0[rp1i];var rp2=state.z1[rp2i];var fv=state.fv;var pv=state.dpv;var z2=state.z2;while(loop--){var pi=stack.pop();var p=z2[pi];if(exports.DEBUG){console.log(state.step,(state.loop>1?"loop "+(state.loop-loop)+": ":"")+"IP[]",pi,rp1i,"<->",rp2i)}fv.interpolate(p,rp1,rp2,pv);fv.touch(p)}state.loop=1}function MSIRP(a,state){var stack=state.stack;var d=stack.pop()/64;var pi=stack.pop();var p=state.z1[pi];var rp0=state.z0[state.rp0];var fv=state.fv;var pv=state.pv;fv.setRelative(p,rp0,d,pv);fv.touch(p);if(exports.DEBUG){console.log(state.step,"MSIRP["+a+"]",d,pi)}state.rp1=state.rp0;state.rp2=pi;if(a){state.rp0=pi}}function ALIGNRP(state){var stack=state.stack;var rp0i=state.rp0;var rp0=state.z0[rp0i];var loop=state.loop;var fv=state.fv;var pv=state.pv;var z1=state.z1;while(loop--){var pi=stack.pop();var p=z1[pi];if(exports.DEBUG){console.log(state.step,(state.loop>1?"loop "+(state.loop-loop)+": ":"")+"ALIGNRP[]",pi)}fv.setRelative(p,rp0,0,pv);fv.touch(p)}state.loop=1}function RTDG(state){if(exports.DEBUG){console.log(state.step,"RTDG[]")}state.round=roundToDoubleGrid}function MIAP(round,state){var stack=state.stack;var n=stack.pop();var pi=stack.pop();var p=state.z0[pi];var fv=state.fv;var pv=state.pv;var cv=state.cvt[n];if(exports.DEBUG){console.log(state.step,"MIAP["+round+"]",n,"(",cv,")",pi)}var d=pv.distance(p,HPZero);if(round){if(Math.abs(d-cv)<state.cvCutIn){d=cv}d=state.round(d)}fv.setRelative(p,HPZero,d,pv);if(state.zp0===0){p.xo=p.x;p.yo=p.y}fv.touch(p);state.rp0=state.rp1=pi}function NPUSHB(state){var prog=state.prog;var ip=state.ip;var stack=state.stack;var n=prog[++ip];if(exports.DEBUG){console.log(state.step,"NPUSHB[]",n)}for(var i=0;i<n;i++){stack.push(prog[++ip])}state.ip=ip}function NPUSHW(state){var ip=state.ip;var prog=state.prog;var stack=state.stack;var n=prog[++ip];if(exports.DEBUG){console.log(state.step,"NPUSHW[]",n)}for(var i=0;i<n;i++){var w=prog[++ip]<<8|prog[++ip];if(w&32768){w=-((w^65535)+1)}stack.push(w)}state.ip=ip}function WS(state){var stack=state.stack;var store=state.store;if(!store){store=state.store=[]}var v=stack.pop();var l=stack.pop();if(exports.DEBUG){console.log(state.step,"WS",v,l)}store[l]=v}function RS(state){var stack=state.stack;var store=state.store;var l=stack.pop();if(exports.DEBUG){console.log(state.step,"RS",l)}var v=store&&store[l]||0;stack.push(v)}function WCVTP(state){var stack=state.stack;var v=stack.pop();var l=stack.pop();if(exports.DEBUG){console.log(state.step,"WCVTP",v,l)}state.cvt[l]=v/64}function RCVT(state){var stack=state.stack;var cvte=stack.pop();if(exports.DEBUG){console.log(state.step,"RCVT",cvte)}stack.push(state.cvt[cvte]*64)}function GC(a,state){var stack=state.stack;var pi=stack.pop();var p=state.z2[pi];if(exports.DEBUG){console.log(state.step,"GC["+a+"]",pi)}stack.push(state.dpv.distance(p,HPZero,a,false)*64)}function MD(a,state){var stack=state.stack;var pi2=stack.pop();var pi1=stack.pop();var p2=state.z1[pi2];var p1=state.z0[pi1];var d=state.dpv.distance(p1,p2,a,a);if(exports.DEBUG){console.log(state.step,"MD["+a+"]",pi2,pi1,"->",d)}state.stack.push(Math.round(d*64))}function MPPEM(state){if(exports.DEBUG){console.log(state.step,"MPPEM[]")}state.stack.push(state.ppem)}function FLIPON(state){if(exports.DEBUG){console.log(state.step,"FLIPON[]")}state.autoFlip=true}function LT(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"LT[]",e2,e1)}stack.push(e1<e2?1:0)}function LTEQ(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"LTEQ[]",e2,e1)}stack.push(e1<=e2?1:0)}function GT(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"GT[]",e2,e1)}stack.push(e1>e2?1:0)}function GTEQ(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"GTEQ[]",e2,e1)}stack.push(e1>=e2?1:0)}function EQ(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"EQ[]",e2,e1)}stack.push(e2===e1?1:0)}function NEQ(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"NEQ[]",e2,e1)}stack.push(e2!==e1?1:0)}function ODD(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,"ODD[]",n)}stack.push(Math.trunc(n)%2?1:0)}function EVEN(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,"EVEN[]",n)}stack.push(Math.trunc(n)%2?0:1)}function IF(state){var test=state.stack.pop();if(exports.DEBUG){console.log(state.step,"IF[]",test)}if(!test){skip(state,true);if(exports.DEBUG){console.log(state.step,"EIF[]")}}}function EIF(state){if(exports.DEBUG){console.log(state.step,"EIF[]")}}function AND(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"AND[]",e2,e1)}stack.push(e2&&e1?1:0)}function OR(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"OR[]",e2,e1)}stack.push(e2||e1?1:0)}function NOT(state){var stack=state.stack;var e=stack.pop();if(exports.DEBUG){console.log(state.step,"NOT[]",e)}stack.push(e?0:1)}function DELTAP123(b,state){var stack=state.stack;var n=stack.pop();var fv=state.fv;var pv=state.pv;var ppem=state.ppem;var base=state.deltaBase+(b-1)*16;var ds=state.deltaShift;var z0=state.z0;if(exports.DEBUG){console.log(state.step,"DELTAP["+b+"]",n,stack)}for(var i=0;i<n;i++){var pi=stack.pop();var arg=stack.pop();var appem=base+((arg&240)>>4);if(appem!==ppem){continue}var mag=(arg&15)-8;if(mag>=0){mag++}if(exports.DEBUG){console.log(state.step,"DELTAPFIX",pi,"by",mag*ds)}var p=z0[pi];fv.setRelative(p,p,mag*ds,pv)}}function SDB(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,"SDB[]",n)}state.deltaBase=n}function SDS(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,"SDS[]",n)}state.deltaShift=Math.pow(.5,n)}function ADD(state){var stack=state.stack;var n2=stack.pop();var n1=stack.pop();if(exports.DEBUG){console.log(state.step,"ADD[]",n2,n1)}stack.push(n1+n2)}function SUB(state){var stack=state.stack;var n2=stack.pop();var n1=stack.pop();if(exports.DEBUG){console.log(state.step,"SUB[]",n2,n1)}stack.push(n1-n2)}function DIV(state){var stack=state.stack;var n2=stack.pop();var n1=stack.pop();if(exports.DEBUG){console.log(state.step,"DIV[]",n2,n1)}stack.push(n1*64/n2)}function MUL(state){var stack=state.stack;var n2=stack.pop();var n1=stack.pop();if(exports.DEBUG){console.log(state.step,"MUL[]",n2,n1)}stack.push(n1*n2/64)}function ABS(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,"ABS[]",n)}stack.push(Math.abs(n))}function NEG(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,"NEG[]",n)}stack.push(-n)}function FLOOR(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,"FLOOR[]",n)}stack.push(Math.floor(n/64)*64)}function CEILING(state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,"CEILING[]",n)}stack.push(Math.ceil(n/64)*64)}function ROUND(dt,state){var stack=state.stack;var n=stack.pop();if(exports.DEBUG){console.log(state.step,"ROUND[]")}stack.push(state.round(n/64)*64)}function WCVTF(state){var stack=state.stack;var v=stack.pop();var l=stack.pop();if(exports.DEBUG){console.log(state.step,"WCVTF[]",v,l)}state.cvt[l]=v*state.ppem/state.font.unitsPerEm}function DELTAC123(b,state){var stack=state.stack;var n=stack.pop();var ppem=state.ppem;var base=state.deltaBase+(b-1)*16;var ds=state.deltaShift;if(exports.DEBUG){console.log(state.step,"DELTAC["+b+"]",n,stack)}for(var i=0;i<n;i++){var c=stack.pop();var arg=stack.pop();var appem=base+((arg&240)>>4);if(appem!==ppem){continue}var mag=(arg&15)-8;if(mag>=0){mag++}var delta=mag*ds;if(exports.DEBUG){console.log(state.step,"DELTACFIX",c,"by",delta)}state.cvt[c]+=delta}}function SROUND(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SROUND[]",n)}state.round=roundSuper;var period;switch(n&192){case 0:period=.5;break;case 64:period=1;break;case 128:period=2;break;default:throw new Error("invalid SROUND value")}state.srPeriod=period;switch(n&48){case 0:state.srPhase=0;break;case 16:state.srPhase=.25*period;break;case 32:state.srPhase=.5*period;break;case 48:state.srPhase=.75*period;break;default:throw new Error("invalid SROUND value")}n&=15;if(n===0){state.srThreshold=0}else{state.srThreshold=(n/8-.5)*period}}function S45ROUND(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,"S45ROUND[]",n)}state.round=roundSuper;var period;switch(n&192){case 0:period=Math.sqrt(2)/2;break;case 64:period=Math.sqrt(2);break;case 128:period=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}state.srPeriod=period;switch(n&48){case 0:state.srPhase=0;break;case 16:state.srPhase=.25*period;break;case 32:state.srPhase=.5*period;break;case 48:state.srPhase=.75*period;break;default:throw new Error("invalid S45ROUND value")}n&=15;if(n===0){state.srThreshold=0}else{state.srThreshold=(n/8-.5)*period}}function ROFF(state){if(exports.DEBUG){console.log(state.step,"ROFF[]")}state.round=roundOff}function RUTG(state){if(exports.DEBUG){console.log(state.step,"RUTG[]")}state.round=roundUpToGrid}function RDTG(state){if(exports.DEBUG){console.log(state.step,"RDTG[]")}state.round=roundDownToGrid}function SCANCTRL(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SCANCTRL[]",n)}}function SDPVTL(a,state){var stack=state.stack;var p2i=stack.pop();var p1i=stack.pop();var p2=state.z2[p2i];var p1=state.z1[p1i];if(exports.DEBUG){console.log(state.step,"SDPVTL["+a+"]",p2i,p1i)}var dx;var dy;if(!a){dx=p1.x-p2.x;dy=p1.y-p2.y}else{dx=p2.y-p1.y;dy=p1.x-p2.x}state.dpv=getUnitVector(dx,dy)}function GETINFO(state){var stack=state.stack;var sel=stack.pop();var r=0;if(exports.DEBUG){console.log(state.step,"GETINFO[]",sel)}if(sel&1){r=35}if(sel&32){r|=4096}stack.push(r)}function ROLL(state){var stack=state.stack;var a=stack.pop();var b=stack.pop();var c=stack.pop();if(exports.DEBUG){console.log(state.step,"ROLL[]")}stack.push(b);stack.push(a);stack.push(c)}function MAX(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"MAX[]",e2,e1)}stack.push(Math.max(e1,e2))}function MIN(state){var stack=state.stack;var e2=stack.pop();var e1=stack.pop();if(exports.DEBUG){console.log(state.step,"MIN[]",e2,e1)}stack.push(Math.min(e1,e2))}function SCANTYPE(state){var n=state.stack.pop();if(exports.DEBUG){console.log(state.step,"SCANTYPE[]",n)}}function INSTCTRL(state){var s=state.stack.pop();var v=state.stack.pop();if(exports.DEBUG){console.log(state.step,"INSTCTRL[]",s,v)}switch(s){case 1:state.inhibitGridFit=!!v;return;case 2:state.ignoreCvt=!!v;return;default:throw new Error("invalid INSTCTRL[] selector")}}function PUSHB(n,state){var stack=state.stack;var prog=state.prog;var ip=state.ip;if(exports.DEBUG){console.log(state.step,"PUSHB["+n+"]")}for(var i=0;i<n;i++){stack.push(prog[++ip])}state.ip=ip}function PUSHW(n,state){var ip=state.ip;var prog=state.prog;var stack=state.stack;if(exports.DEBUG){console.log(state.ip,"PUSHW["+n+"]")}for(var i=0;i<n;i++){var w=prog[++ip]<<8|prog[++ip];if(w&32768){w=-((w^65535)+1)}stack.push(w)}state.ip=ip}function MDRP_MIRP(indirect,setRp0,keepD,ro,dt,state){var stack=state.stack;var cvte=indirect&&stack.pop();var pi=stack.pop();var rp0i=state.rp0;var rp=state.z0[rp0i];var p=state.z1[pi];var md=state.minDis;var fv=state.fv;var pv=state.dpv;var od;var d;var sign;var cv;d=od=pv.distance(p,rp,true,true);sign=d>=0?1:-1;d=Math.abs(d);if(indirect){cv=state.cvt[cvte];if(ro&&Math.abs(d-cv)<state.cvCutIn){d=cv}}if(keepD&&d<md){d=md}if(ro){d=state.round(d)}fv.setRelative(p,rp,sign*d,pv);fv.touch(p);if(exports.DEBUG){console.log(state.step,(indirect?"MIRP[":"MDRP[")+(setRp0?"M":"m")+(keepD?">":"_")+(ro?"R":"_")+(dt===0?"Gr":dt===1?"Bl":dt===2?"Wh":"")+"]",indirect?cvte+"("+state.cvt[cvte]+","+cv+")":"",pi,"(d =",od,"->",sign*d,")")}state.rp1=state.rp0;state.rp2=pi;if(setRp0){state.rp0=pi}}instructionTable=[SVTCA.bind(undefined,yUnitVector),SVTCA.bind(undefined,xUnitVector),SPVTCA.bind(undefined,yUnitVector),SPVTCA.bind(undefined,xUnitVector),SFVTCA.bind(undefined,yUnitVector),SFVTCA.bind(undefined,xUnitVector),SPVTL.bind(undefined,0),SPVTL.bind(undefined,1),SFVTL.bind(undefined,0),SFVTL.bind(undefined,1),SPVFS,SFVFS,GPV,GFV,SFVTPV,ISECT,SRP0,SRP1,SRP2,SZP0,SZP1,SZP2,SZPS,SLOOP,RTG,RTHG,SMD,ELSE,JMPR,SCVTCI,undefined,undefined,DUP,POP,CLEAR,SWAP,DEPTH,CINDEX,MINDEX,undefined,undefined,undefined,LOOPCALL,CALL,FDEF,undefined,MDAP.bind(undefined,0),MDAP.bind(undefined,1),IUP.bind(undefined,yUnitVector),IUP.bind(undefined,xUnitVector),SHP.bind(undefined,0),SHP.bind(undefined,1),SHC.bind(undefined,0),SHC.bind(undefined,1),SHZ.bind(undefined,0),SHZ.bind(undefined,1),SHPIX,IP,MSIRP.bind(undefined,0),MSIRP.bind(undefined,1),ALIGNRP,RTDG,MIAP.bind(undefined,0),MIAP.bind(undefined,1),NPUSHB,NPUSHW,WS,RS,WCVTP,RCVT,GC.bind(undefined,0),GC.bind(undefined,1),undefined,MD.bind(undefined,0),MD.bind(undefined,1),MPPEM,undefined,FLIPON,undefined,undefined,LT,LTEQ,GT,GTEQ,EQ,NEQ,ODD,EVEN,IF,EIF,AND,OR,NOT,DELTAP123.bind(undefined,1),SDB,SDS,ADD,SUB,DIV,MUL,ABS,NEG,FLOOR,CEILING,ROUND.bind(undefined,0),ROUND.bind(undefined,1),ROUND.bind(undefined,2),ROUND.bind(undefined,3),undefined,undefined,undefined,undefined,WCVTF,DELTAP123.bind(undefined,2),DELTAP123.bind(undefined,3),DELTAC123.bind(undefined,1),DELTAC123.bind(undefined,2),DELTAC123.bind(undefined,3),SROUND,S45ROUND,undefined,undefined,ROFF,undefined,RUTG,RDTG,POP,POP,undefined,undefined,undefined,undefined,undefined,SCANCTRL,SDPVTL.bind(undefined,0),SDPVTL.bind(undefined,1),GETINFO,undefined,ROLL,MAX,MIN,SCANTYPE,INSTCTRL,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,PUSHB.bind(undefined,1),PUSHB.bind(undefined,2),PUSHB.bind(undefined,3),PUSHB.bind(undefined,4),PUSHB.bind(undefined,5),PUSHB.bind(undefined,6),PUSHB.bind(undefined,7),PUSHB.bind(undefined,8),PUSHW.bind(undefined,1),PUSHW.bind(undefined,2),PUSHW.bind(undefined,3),PUSHW.bind(undefined,4),PUSHW.bind(undefined,5),PUSHW.bind(undefined,6),PUSHW.bind(undefined,7),PUSHW.bind(undefined,8),MDRP_MIRP.bind(undefined,0,0,0,0,0),MDRP_MIRP.bind(undefined,0,0,0,0,1),MDRP_MIRP.bind(undefined,0,0,0,0,2),MDRP_MIRP.bind(undefined,0,0,0,0,3),MDRP_MIRP.bind(undefined,0,0,0,1,0),MDRP_MIRP.bind(undefined,0,0,0,1,1),MDRP_MIRP.bind(undefined,0,0,0,1,2),MDRP_MIRP.bind(undefined,0,0,0,1,3),MDRP_MIRP.bind(undefined,0,0,1,0,0),MDRP_MIRP.bind(undefined,0,0,1,0,1),MDRP_MIRP.bind(undefined,0,0,1,0,2),MDRP_MIRP.bind(undefined,0,0,1,0,3),MDRP_MIRP.bind(undefined,0,0,1,1,0),MDRP_MIRP.bind(undefined,0,0,1,1,1),MDRP_MIRP.bind(undefined,0,0,1,1,2),MDRP_MIRP.bind(undefined,0,0,1,1,3),MDRP_MIRP.bind(undefined,0,1,0,0,0),MDRP_MIRP.bind(undefined,0,1,0,0,1),MDRP_MIRP.bind(undefined,0,1,0,0,2),MDRP_MIRP.bind(undefined,0,1,0,0,3),MDRP_MIRP.bind(undefined,0,1,0,1,0),MDRP_MIRP.bind(undefined,0,1,0,1,1),MDRP_MIRP.bind(undefined,0,1,0,1,2),MDRP_MIRP.bind(undefined,0,1,0,1,3),MDRP_MIRP.bind(undefined,0,1,1,0,0),MDRP_MIRP.bind(undefined,0,1,1,0,1),MDRP_MIRP.bind(undefined,0,1,1,0,2),MDRP_MIRP.bind(undefined,0,1,1,0,3),MDRP_MIRP.bind(undefined,0,1,1,1,0),MDRP_MIRP.bind(undefined,0,1,1,1,1),MDRP_MIRP.bind(undefined,0,1,1,1,2),MDRP_MIRP.bind(undefined,0,1,1,1,3),MDRP_MIRP.bind(undefined,1,0,0,0,0),MDRP_MIRP.bind(undefined,1,0,0,0,1),MDRP_MIRP.bind(undefined,1,0,0,0,2),MDRP_MIRP.bind(undefined,1,0,0,0,3),MDRP_MIRP.bind(undefined,1,0,0,1,0),MDRP_MIRP.bind(undefined,1,0,0,1,1),MDRP_MIRP.bind(undefined,1,0,0,1,2),MDRP_MIRP.bind(undefined,1,0,0,1,3),MDRP_MIRP.bind(undefined,1,0,1,0,0),MDRP_MIRP.bind(undefined,1,0,1,0,1),MDRP_MIRP.bind(undefined,1,0,1,0,2),MDRP_MIRP.bind(undefined,1,0,1,0,3),MDRP_MIRP.bind(undefined,1,0,1,1,0),MDRP_MIRP.bind(undefined,1,0,1,1,1),MDRP_MIRP.bind(undefined,1,0,1,1,2),MDRP_MIRP.bind(undefined,1,0,1,1,3),MDRP_MIRP.bind(undefined,1,1,0,0,0),MDRP_MIRP.bind(undefined,1,1,0,0,1),MDRP_MIRP.bind(undefined,1,1,0,0,2),MDRP_MIRP.bind(undefined,1,1,0,0,3),MDRP_MIRP.bind(undefined,1,1,0,1,0),MDRP_MIRP.bind(undefined,1,1,0,1,1),MDRP_MIRP.bind(undefined,1,1,0,1,2),MDRP_MIRP.bind(undefined,1,1,0,1,3),MDRP_MIRP.bind(undefined,1,1,1,0,0),MDRP_MIRP.bind(undefined,1,1,1,0,1),MDRP_MIRP.bind(undefined,1,1,1,0,2),MDRP_MIRP.bind(undefined,1,1,1,0,3),MDRP_MIRP.bind(undefined,1,1,1,1,0),MDRP_MIRP.bind(undefined,1,1,1,1,1),MDRP_MIRP.bind(undefined,1,1,1,1,2),MDRP_MIRP.bind(undefined,1,1,1,1,3)];var arrayFromString=Array.from||function(s){return s.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]?|[^\uD800-\uDFFF]|./g)||[]};function Font(options){options=options||{};if(!options.empty){checkArgument(options.familyName,"When creating a new Font object, familyName is required.");checkArgument(options.styleName,"When creating a new Font object, styleName is required.");checkArgument(options.unitsPerEm,"When creating a new Font object, unitsPerEm is required.");checkArgument(options.ascender,"When creating a new Font object, ascender is required.");checkArgument(options.descender,"When creating a new Font object, descender is required.");checkArgument(options.descender<0,"Descender should be negative (e.g. -512).");this.names={fontFamily:{en:options.familyName||" "},fontSubfamily:{en:options.styleName||" "},fullName:{en:options.fullName||options.familyName+" "+options.styleName},postScriptName:{en:options.postScriptName||(options.familyName+options.styleName).replace(/\s/g,"")},designer:{en:options.designer||" "},designerURL:{en:options.designerURL||" "},manufacturer:{en:options.manufacturer||" "},manufacturerURL:{en:options.manufacturerURL||" "},license:{en:options.license||" "},licenseURL:{en:options.licenseURL||" "},version:{en:options.version||"Version 0.1"},description:{en:options.description||" "},copyright:{en:options.copyright||" "},trademark:{en:options.trademark||" "}};this.unitsPerEm=options.unitsPerEm||1e3;this.ascender=options.ascender;this.descender=options.descender;this.createdTimestamp=options.createdTimestamp;this.tables={os2:{usWeightClass:options.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:options.widthClass||this.usWidthClasses.MEDIUM,fsSelection:options.fsSelection||this.fsSelectionValues.REGULAR}}}this.supported=true;this.glyphs=new glyphset.GlyphSet(this,options.glyphs||[]);this.encoding=new DefaultEncoding(this);this.position=new Position(this);this.substitution=new Substitution(this);this.tables=this.tables||{};Object.defineProperty(this,"hinting",{get:function(){if(this._hinting){return this._hinting}if(this.outlinesFormat==="truetype"){return this._hinting=new Hinting(this)}}})}Font.prototype.hasChar=function(c){return this.encoding.charToGlyphIndex(c)!==null};Font.prototype.charToGlyphIndex=function(s){return this.encoding.charToGlyphIndex(s)};Font.prototype.charToGlyph=function(c){var glyphIndex=this.charToGlyphIndex(c);var glyph=this.glyphs.get(glyphIndex);if(!glyph){glyph=this.glyphs.get(0)}return glyph};Font.prototype.stringToGlyphs=function(s,options){var this$1=this;options=options||this.defaultRenderOptions;var chars=arrayFromString(s);var indexes=[];for(var i=0;i<chars.length;i+=1){var c=chars[i];indexes.push(this$1.charToGlyphIndex(c))}var length=indexes.length;if(options.features){var script=options.script||this.substitution.getDefaultScriptName();var manyToOne=[];if(options.features.liga){manyToOne=manyToOne.concat(this.substitution.getFeature("liga",script,options.language))}if(options.features.rlig){manyToOne=manyToOne.concat(this.substitution.getFeature("rlig",script,options.language))}for(var i$1=0;i$1<length;i$1+=1){for(var j=0;j<manyToOne.length;j++){var ligature=manyToOne[j];var components=ligature.sub;var compCount=components.length;var k=0;while(k<compCount&&components[k]===indexes[i$1+k]){k++}if(k===compCount){indexes.splice(i$1,compCount,ligature.by);length=length-compCount+1}}}}var glyphs=new Array(length);var notdef=this.glyphs.get(0);for(var i$2=0;i$2<length;i$2+=1){glyphs[i$2]=this$1.glyphs.get(indexes[i$2])||notdef}return glyphs};Font.prototype.nameToGlyphIndex=function(name){return this.glyphNames.nameToGlyphIndex(name)};Font.prototype.nameToGlyph=function(name){var glyphIndex=this.nameToGlyphIndex(name);var glyph=this.glyphs.get(glyphIndex);if(!glyph){glyph=this.glyphs.get(0)}return glyph};Font.prototype.glyphIndexToName=function(gid){if(!this.glyphNames.glyphIndexToName){return""}return this.glyphNames.glyphIndexToName(gid)};Font.prototype.getKerningValue=function(leftGlyph,rightGlyph){leftGlyph=leftGlyph.index||leftGlyph;rightGlyph=rightGlyph.index||rightGlyph;var gposKerning=this.position.defaultKerningTables;if(gposKerning){return this.position.getKerningValue(gposKerning,leftGlyph,rightGlyph)}return this.kerningPairs[leftGlyph+","+rightGlyph]||0};Font.prototype.defaultRenderOptions={kerning:true,features:{liga:true,rlig:true}};Font.prototype.forEachGlyph=function(text,x,y,fontSize,options,callback){var this$1=this;x=x!==undefined?x:0;y=y!==undefined?y:0;fontSize=fontSize!==undefined?fontSize:72;options=options||this.defaultRenderOptions;var fontScale=1/this.unitsPerEm*fontSize;var glyphs=this.stringToGlyphs(text,options);var kerningLookups;if(options.kerning){var script=options.script||this.position.getDefaultScriptName();kerningLookups=this.position.getKerningTables(script,options.language)}for(var i=0;i<glyphs.length;i+=1){var glyph=glyphs[i];callback.call(this$1,glyph,x,y,fontSize,options);if(glyph.advanceWidth){x+=glyph.advanceWidth*fontScale}if(options.kerning&&i<glyphs.length-1){var kerningValue=kerningLookups?this$1.position.getKerningValue(kerningLookups,glyph.index,glyphs[i+1].index):this$1.getKerningValue(glyph,glyphs[i+1]);x+=kerningValue*fontScale}if(options.letterSpacing){x+=options.letterSpacing*fontSize}else if(options.tracking){x+=options.tracking/1e3*fontSize}}return x};Font.prototype.getPath=function(text,x,y,fontSize,options){var fullPath=new Path;this.forEachGlyph(text,x,y,fontSize,options,function(glyph,gX,gY,gFontSize){var glyphPath=glyph.getPath(gX,gY,gFontSize,options,this);fullPath.extend(glyphPath)});return fullPath};Font.prototype.getPaths=function(text,x,y,fontSize,options){var glyphPaths=[];this.forEachGlyph(text,x,y,fontSize,options,function(glyph,gX,gY,gFontSize){var glyphPath=glyph.getPath(gX,gY,gFontSize,options,this);glyphPaths.push(glyphPath)});return glyphPaths};Font.prototype.getAdvanceWidth=function(text,fontSize,options){return this.forEachGlyph(text,0,0,fontSize,options,function(){})};Font.prototype.draw=function(ctx,text,x,y,fontSize,options){this.getPath(text,x,y,fontSize,options).draw(ctx)};Font.prototype.drawPoints=function(ctx,text,x,y,fontSize,options){this.forEachGlyph(text,x,y,fontSize,options,function(glyph,gX,gY,gFontSize){glyph.drawPoints(ctx,gX,gY,gFontSize)})};Font.prototype.drawMetrics=function(ctx,text,x,y,fontSize,options){this.forEachGlyph(text,x,y,fontSize,options,function(glyph,gX,gY,gFontSize){glyph.drawMetrics(ctx,gX,gY,gFontSize)})};Font.prototype.getEnglishName=function(name){var translations=this.names[name];if(translations){return translations.en}};Font.prototype.validate=function(){var _this=this;function assert(predicate,message){}function assertNamePresent(name){var englishName=_this.getEnglishName(name);assert(englishName&&englishName.trim().length>0,"No English "+name+" specified.")}assertNamePresent("fontFamily");assertNamePresent("weightName");assertNamePresent("manufacturer");assertNamePresent("copyright");assertNamePresent("version");assert(this.unitsPerEm>0,"No unitsPerEm specified.")};Font.prototype.toTables=function(){return sfnt.fontToTable(this)};Font.prototype.toBuffer=function(){console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead.");return this.toArrayBuffer()};Font.prototype.toArrayBuffer=function(){var sfntTable=this.toTables();var bytes=sfntTable.encode();var buffer=new ArrayBuffer(bytes.length);var intArray=new Uint8Array(buffer);for(var i=0;i<bytes.length;i++){intArray[i]=bytes[i]}return buffer};Font.prototype.download=function(fileName){var familyName=this.getEnglishName("fontFamily");var styleName=this.getEnglishName("fontSubfamily");fileName=fileName||familyName.replace(/\s/g,"")+"-"+styleName+".otf";var arrayBuffer=this.toArrayBuffer();if(isBrowser()){window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;window.requestFileSystem(window.TEMPORARY,arrayBuffer.byteLength,function(fs){fs.root.getFile(fileName,{create:true},function(fileEntry){fileEntry.createWriter(function(writer){var dataView=new DataView(arrayBuffer);var blob=new Blob([dataView],{type:"font/opentype"});writer.write(blob);writer.addEventListener("writeend",function(){location.href=fileEntry.toURL()},false)})})},function(err){throw new Error(err.name+": "+err.message)})}else{var fs=_dereq_("fs");var buffer=arrayBufferToNodeBuffer(arrayBuffer);fs.writeFileSync(fileName,buffer)}};Font.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512};Font.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9};Font.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};function addName(name,names){var nameString=JSON.stringify(name);var nameID=256;for(var nameKey in names){var n=parseInt(nameKey);if(!n||n<256){continue}if(JSON.stringify(names[nameKey])===nameString){return n}if(nameID<=n){nameID=n+1}}names[nameID]=name;return nameID}function makeFvarAxis(n,axis,names){var nameID=addName(axis.name,names);return[{name:"tag_"+n,type:"TAG",value:axis.tag},{name:"minValue_"+n,type:"FIXED",value:axis.minValue<<16},{name:"defaultValue_"+n,type:"FIXED",value:axis.defaultValue<<16},{name:"maxValue_"+n,type:"FIXED",value:axis.maxValue<<16},{name:"flags_"+n,type:"USHORT",value:0},{name:"nameID_"+n,type:"USHORT",value:nameID}]}function parseFvarAxis(data,start,names){var axis={};var p=new parse.Parser(data,start);axis.tag=p.parseTag();axis.minValue=p.parseFixed();axis.defaultValue=p.parseFixed();axis.maxValue=p.parseFixed();p.skip("uShort",1);axis.name=names[p.parseUShort()]||{};return axis}function makeFvarInstance(n,inst,axes,names){var nameID=addName(inst.name,names);var fields=[{name:"nameID_"+n,type:"USHORT",value:nameID},{name:"flags_"+n,type:"USHORT",value:0}];for(var i=0;i<axes.length;++i){var axisTag=axes[i].tag;fields.push({name:"axis_"+n+" "+axisTag,type:"FIXED",value:inst.coordinates[axisTag]<<16})}return fields}function parseFvarInstance(data,start,axes,names){var inst={};var p=new parse.Parser(data,start);inst.name=names[p.parseUShort()]||{};p.skip("uShort",1);inst.coordinates={};for(var i=0;i<axes.length;++i){inst.coordinates[axes[i].tag]=p.parseFixed()}return inst}function makeFvarTable(fvar,names){var result=new table.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:fvar.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:fvar.instances.length},{name:"instanceSize",type:"USHORT",value:4+fvar.axes.length*4}]);result.offsetToData=result.sizeOf();for(var i=0;i<fvar.axes.length;i++){result.fields=result.fields.concat(makeFvarAxis(i,fvar.axes[i],names))}for(var j=0;j<fvar.instances.length;j++){result.fields=result.fields.concat(makeFvarInstance(j,fvar.instances[j],fvar.axes,names))}return result}function parseFvarTable(data,start,names){var p=new parse.Parser(data,start);var tableVersion=p.parseULong();check.argument(tableVersion===65536,"Unsupported fvar table version.");var offsetToData=p.parseOffset16();p.skip("uShort",1);var axisCount=p.parseUShort();var axisSize=p.parseUShort();var instanceCount=p.parseUShort();var instanceSize=p.parseUShort();var axes=[];for(var i=0;i<axisCount;i++){axes.push(parseFvarAxis(data,start+offsetToData+i*axisSize,names))}var instances=[];var instanceStart=start+offsetToData+axisCount*axisSize;for(var j=0;j<instanceCount;j++){instances.push(parseFvarInstance(data,instanceStart+j*instanceSize,axes,names))}return{axes:axes,instances:instances}}var fvar={make:makeFvarTable,parse:parseFvarTable};var subtableParsers$1=new Array(10);subtableParsers$1[1]=function parseLookup1(){var start=this.offset+this.relativeOffset;var posformat=this.parseUShort();if(posformat===1){return{posFormat:1,coverage:this.parsePointer(Parser.coverage),value:this.parseValueRecord()}}else if(posformat===2){return{posFormat:2,coverage:this.parsePointer(Parser.coverage),values:this.parseValueRecordList()}}check.assert(false,"0x"+start.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")};subtableParsers$1[2]=function parseLookup2(){var start=this.offset+this.relativeOffset;var posFormat=this.parseUShort();check.assert(posFormat===1||posFormat===2,"0x"+start.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var coverage=this.parsePointer(Parser.coverage);var valueFormat1=this.parseUShort();var valueFormat2=this.parseUShort();if(posFormat===1){return{posFormat:posFormat,coverage:coverage,valueFormat1:valueFormat1,valueFormat2:valueFormat2,pairSets:this.parseList(Parser.pointer(Parser.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(valueFormat1),value2:this.parseValueRecord(valueFormat2)}})))}}else if(posFormat===2){var classDef1=this.parsePointer(Parser.classDef);var classDef2=this.parsePointer(Parser.classDef);var class1Count=this.parseUShort();var class2Count=this.parseUShort();return{posFormat:posFormat,coverage:coverage,valueFormat1:valueFormat1,valueFormat2:valueFormat2,classDef1:classDef1,classDef2:classDef2,class1Count:class1Count,class2Count:class2Count,classRecords:this.parseList(class1Count,Parser.list(class2Count,function(){return{value1:this.parseValueRecord(valueFormat1),value2:this.parseValueRecord(valueFormat2)}}))}}};subtableParsers$1[3]=function parseLookup3(){return{error:"GPOS Lookup 3 not supported"}};subtableParsers$1[4]=function parseLookup4(){return{error:"GPOS Lookup 4 not supported"}};subtableParsers$1[5]=function parseLookup5(){return{error:"GPOS Lookup 5 not supported"}};subtableParsers$1[6]=function parseLookup6(){return{error:"GPOS Lookup 6 not supported"}};subtableParsers$1[7]=function parseLookup7(){return{error:"GPOS Lookup 7 not supported"}};subtableParsers$1[8]=function parseLookup8(){return{error:"GPOS Lookup 8 not supported"}};subtableParsers$1[9]=function parseLookup9(){return{error:"GPOS Lookup 9 not supported"}};function parseGposTable(data,start){start=start||0;var p=new Parser(data,start);var tableVersion=p.parseVersion(1);check.argument(tableVersion===1||tableVersion===1.1,"Unsupported GPOS table version "+tableVersion);if(tableVersion===1){return{version:tableVersion,scripts:p.parseScriptList(),features:p.parseFeatureList(),lookups:p.parseLookupList(subtableParsers$1)}}else{return{version:tableVersion,scripts:p.parseScriptList(),features:p.parseFeatureList(),lookups:p.parseLookupList(subtableParsers$1),variations:p.parseFeatureVariationsList()}}}var subtableMakers$1=new Array(10);function makeGposTable(gpos){return new table.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new table.ScriptList(gpos.scripts)},{name:"features",type:"TABLE",value:new table.FeatureList(gpos.features)},{name:"lookups",type:"TABLE",value:new table.LookupList(gpos.lookups,subtableMakers$1)}])}var gpos={parse:parseGposTable,make:makeGposTable};function parseWindowsKernTable(p){var pairs={};p.skip("uShort");var subtableVersion=p.parseUShort();check.argument(subtableVersion===0,"Unsupported kern sub-table version.");p.skip("uShort",2);var nPairs=p.parseUShort();p.skip("uShort",3);for(var i=0;i<nPairs;i+=1){var leftIndex=p.parseUShort();var rightIndex=p.parseUShort();var value=p.parseShort();pairs[leftIndex+","+rightIndex]=value}return pairs}function parseMacKernTable(p){var pairs={};p.skip("uShort");var nTables=p.parseULong();if(nTables>1){console.warn("Only the first kern subtable is supported.")}p.skip("uLong");var coverage=p.parseUShort();var subtableVersion=coverage&255;p.skip("uShort");if(subtableVersion===0){var nPairs=p.parseUShort();p.skip("uShort",3);for(var i=0;i<nPairs;i+=1){var leftIndex=p.parseUShort();var rightIndex=p.parseUShort();var value=p.parseShort();pairs[leftIndex+","+rightIndex]=value}}return pairs}function parseKernTable(data,start){var p=new parse.Parser(data,start);var tableVersion=p.parseUShort();if(tableVersion===0){return parseWindowsKernTable(p)}else if(tableVersion===1){return parseMacKernTable(p)}else{throw new Error("Unsupported kern table version ("+tableVersion+").")}}var kern={parse:parseKernTable};function parseLocaTable(data,start,numGlyphs,shortVersion){var p=new parse.Parser(data,start);var parseFn=shortVersion?p.parseUShort:p.parseULong;var glyphOffsets=[];for(var i=0;i<numGlyphs+1;i+=1){var glyphOffset=parseFn.call(p);if(shortVersion){glyphOffset*=2}glyphOffsets.push(glyphOffset)}return glyphOffsets}var loca={parse:parseLocaTable};function loadFromFile(path,callback){var fs=_dereq_("fs");fs.readFile(path,function(err,buffer){if(err){return callback(err.message)}callback(null,nodeBufferToArrayBuffer(buffer))})}function loadFromUrl(url,callback){var request=new XMLHttpRequest;request.open("get",url,true);request.responseType="arraybuffer";request.onload=function(){if(request.response){return callback(null,request.response)}else{return callback("Font could not be loaded: "+request.statusText)}};request.onerror=function(){callback("Font could not be loaded")};request.send()}function parseOpenTypeTableEntries(data,numTables){var tableEntries=[];var p=12;for(var i=0;i<numTables;i+=1){var tag=parse.getTag(data,p);var checksum=parse.getULong(data,p+4);var offset=parse.getULong(data,p+8);var length=parse.getULong(data,p+12);tableEntries.push({tag:tag,checksum:checksum,offset:offset,length:length,compression:false});p+=16}return tableEntries}function parseWOFFTableEntries(data,numTables){var tableEntries=[];var p=44;for(var i=0;i<numTables;i+=1){var tag=parse.getTag(data,p);var offset=parse.getULong(data,p+4);var compLength=parse.getULong(data,p+8);var origLength=parse.getULong(data,p+12);var compression=void 0;if(compLength<origLength){compression="WOFF"}else{compression=false}tableEntries.push({tag:tag,offset:offset,compression:compression,compressedLength:compLength,length:origLength});p+=20}return tableEntries}function uncompressTable(data,tableEntry){if(tableEntry.compression==="WOFF"){var inBuffer=new Uint8Array(data.buffer,tableEntry.offset+2,tableEntry.compressedLength-2);var outBuffer=new Uint8Array(tableEntry.length);tinyInflate(inBuffer,outBuffer);if(outBuffer.byteLength!==tableEntry.length){throw new Error("Decompression error: "+tableEntry.tag+" decompressed length doesn't match recorded length")}var view=new DataView(outBuffer.buffer,0);return{data:view,offset:0}}else{return{data:data,offset:tableEntry.offset}}}function parseBuffer(buffer){var indexToLocFormat;var ltagTable;var font=new Font({empty:true});var data=new DataView(buffer,0);var numTables;var tableEntries=[];var signature=parse.getTag(data,0);if(signature===String.fromCharCode(0,1,0,0)||signature==="true"||signature==="typ1"){font.outlinesFormat="truetype";numTables=parse.getUShort(data,4);tableEntries=parseOpenTypeTableEntries(data,numTables)}else if(signature==="OTTO"){font.outlinesFormat="cff";numTables=parse.getUShort(data,4);tableEntries=parseOpenTypeTableEntries(data,numTables)}else if(signature==="wOFF"){var flavor=parse.getTag(data,4);if(flavor===String.fromCharCode(0,1,0,0)){font.outlinesFormat="truetype"}else if(flavor==="OTTO"){font.outlinesFormat="cff"}else{throw new Error("Unsupported OpenType flavor "+signature)}numTables=parse.getUShort(data,12);tableEntries=parseWOFFTableEntries(data,numTables)}else{throw new Error("Unsupported OpenType signature "+signature)}var cffTableEntry;var fvarTableEntry;var glyfTableEntry;var gposTableEntry;var gsubTableEntry;var hmtxTableEntry;var kernTableEntry;var locaTableEntry;var nameTableEntry;var metaTableEntry;var p;for(var i=0;i<numTables;i+=1){var tableEntry=tableEntries[i];var table=void 0;switch(tableEntry.tag){case"cmap":table=uncompressTable(data,tableEntry);font.tables.cmap=cmap.parse(table.data,table.offset);font.encoding=new CmapEncoding(font.tables.cmap);break;case"cvt ":table=uncompressTable(data,tableEntry);p=new parse.Parser(table.data,table.offset);font.tables.cvt=p.parseShortList(tableEntry.length/2);break;case"fvar":fvarTableEntry=tableEntry;break;case"fpgm":table=uncompressTable(data,tableEntry);p=new parse.Parser(table.data,table.offset);font.tables.fpgm=p.parseByteList(tableEntry.length);break;case"head":table=uncompressTable(data,tableEntry);font.tables.head=head.parse(table.data,table.offset);font.unitsPerEm=font.tables.head.unitsPerEm;indexToLocFormat=font.tables.head.indexToLocFormat;break;case"hhea":table=uncompressTable(data,tableEntry);font.tables.hhea=hhea.parse(table.data,table.offset);font.ascender=font.tables.hhea.ascender;font.descender=font.tables.hhea.descender;font.numberOfHMetrics=font.tables.hhea.numberOfHMetrics;break;case"hmtx":hmtxTableEntry=tableEntry;break;case"ltag":table=uncompressTable(data,tableEntry);ltagTable=ltag.parse(table.data,table.offset);break;case"maxp":table=uncompressTable(data,tableEntry);font.tables.maxp=maxp.parse(table.data,table.offset);font.numGlyphs=font.tables.maxp.numGlyphs;break;case"name":nameTableEntry=tableEntry;break;case"OS/2":table=uncompressTable(data,tableEntry);font.tables.os2=os2.parse(table.data,table.offset);break;case"post":table=uncompressTable(data,tableEntry);font.tables.post=post.parse(table.data,table.offset);font.glyphNames=new GlyphNames(font.tables.post);break;case"prep":table=uncompressTable(data,tableEntry);p=new parse.Parser(table.data,table.offset);font.tables.prep=p.parseByteList(tableEntry.length);break;case"glyf":glyfTableEntry=tableEntry;break;case"loca":locaTableEntry=tableEntry;break;case"CFF ":cffTableEntry=tableEntry;break;case"kern":kernTableEntry=tableEntry;break;case"GPOS":gposTableEntry=tableEntry;break;case"GSUB":gsubTableEntry=tableEntry;break;case"meta":metaTableEntry=tableEntry;break}}var nameTable=uncompressTable(data,nameTableEntry);font.tables.name=_name.parse(nameTable.data,nameTable.offset,ltagTable);font.names=font.tables.name;if(glyfTableEntry&&locaTableEntry){var shortVersion=indexToLocFormat===0;var locaTable=uncompressTable(data,locaTableEntry);var locaOffsets=loca.parse(locaTable.data,locaTable.offset,font.numGlyphs,shortVersion);var glyfTable=uncompressTable(data,glyfTableEntry);font.glyphs=glyf.parse(glyfTable.data,glyfTable.offset,locaOffsets,font)}else if(cffTableEntry){var cffTable=uncompressTable(data,cffTableEntry);cff.parse(cffTable.data,cffTable.offset,font)}else{throw new Error("Font doesn't contain TrueType or CFF outlines.")}var hmtxTable=uncompressTable(data,hmtxTableEntry);hmtx.parse(hmtxTable.data,hmtxTable.offset,font.numberOfHMetrics,font.numGlyphs,font.glyphs);addGlyphNames(font);if(kernTableEntry){var kernTable=uncompressTable(data,kernTableEntry);font.kerningPairs=kern.parse(kernTable.data,kernTable.offset)}else{font.kerningPairs={}}if(gposTableEntry){var gposTable=uncompressTable(data,gposTableEntry);font.tables.gpos=gpos.parse(gposTable.data,gposTable.offset);font.position.init()}if(gsubTableEntry){var gsubTable=uncompressTable(data,gsubTableEntry);font.tables.gsub=gsub.parse(gsubTable.data,gsubTable.offset)}if(fvarTableEntry){var fvarTable=uncompressTable(data,fvarTableEntry);font.tables.fvar=fvar.parse(fvarTable.data,fvarTable.offset,font.names)}if(metaTableEntry){var metaTable=uncompressTable(data,metaTableEntry);font.tables.meta=meta.parse(metaTable.data,metaTable.offset);font.metas=font.tables.meta}return font}function load(url,callback){var isNode$$1=typeof window==="undefined";var loadFn=isNode$$1?loadFromFile:loadFromUrl;loadFn(url,function(err,arrayBuffer){if(err){return callback(err)}var font;try{font=parseBuffer(arrayBuffer)}catch(e){return callback(e,null)}return callback(null,font)})}function loadSync(url){var fs=_dereq_("fs");var buffer=fs.readFileSync(url);return parseBuffer(nodeBufferToArrayBuffer(buffer))}exports.Font=Font;exports.Glyph=Glyph;exports.Path=Path;exports.BoundingBox=BoundingBox;exports._parse=parse;exports.parse=parseBuffer;exports.load=load;exports.loadSync=loadSync;Object.defineProperty(exports,"__esModule",{value:true})})}).call(this,_dereq_("buffer").Buffer)},{buffer:22,fs:21}],272:[function(_dereq_,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash=substr(path,-1)==="/";path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.isAbsolute=function(path){return path.charAt(0)==="/"};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if(typeof p!=="string"){throw new TypeError("Arguments to path.join must be strings")}return p}).join("/"))};exports.relative=function(from,to){from=exports.resolve(from).substr(1);to=exports.resolve(to).substr(1);function trim(arr){var start=0;for(;start<arr.length;start++){if(arr[start]!=="")break}var end=arr.length-1;for(;end>=0;end--){if(arr[end]!=="")break}if(start>end)return[];return arr.slice(start,end-start+1)}var fromParts=trim(from.split("/"));var toParts=trim(to.split("/"));var length=Math.min(fromParts.length,toParts.length);var samePartsLength=length;for(var i=0;i<length;i++){if(fromParts[i]!==toParts[i]){samePartsLength=i;break}}var outputParts=[];for(var i=samePartsLength;i<fromParts.length;i++){outputParts.push("..")}outputParts=outputParts.concat(toParts.slice(samePartsLength));return outputParts.join("/")};exports.sep="/";exports.delimiter=":";exports.dirname=function(path){if(typeof path!=="string")path=path+"";if(path.length===0)return".";var code=path.charCodeAt(0);var hasRoot=code===47;var end=-1;var matchedSlash=true;for(var i=path.length-1;i>=1;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){end=i;break}}else{matchedSlash=false}}if(end===-1)return hasRoot?"/":".";if(hasRoot&&end===1){return"/"}return path.slice(0,end)};function basename(path){if(typeof path!=="string")path=path+"";var start=0;var end=-1;var matchedSlash=true;var i;for(i=path.length-1;i>=0;--i){if(path.charCodeAt(i)===47){if(!matchedSlash){start=i+1;break}}else if(end===-1){matchedSlash=false;end=i+1}}if(end===-1)return"";return path.slice(start,end)}exports.basename=function(path,ext){var f=basename(path);if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){if(typeof path!=="string")path=path+"";var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var preDotState=0;for(var i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){return""}return path.slice(startDot,end)};function filter(xs,f){if(xs.filter)return xs.filter(f);var res=[];for(var i=0;i<xs.length;i++){if(f(xs[i],i,xs))res.push(xs[i])}return res}var substr="ab".substr(-1)==="b"?function(str,start,len){return str.substr(start,len)}:function(str,start,len){if(start<0)start=str.length+start;return str.substr(start,len)}}).call(this,_dereq_("_process"))},{_process:273}],273:[function(_dereq_,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],274:[function(_dereq_,module,exports){var runtime=function(exports){"use strict";var Op=Object.prototype;var hasOwn=Op.hasOwnProperty;var undefined;var $Symbol=typeof Symbol==="function"?Symbol:{};var iteratorSymbol=$Symbol.iterator||"@@iterator";var asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator";var toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator;var generator=Object.create(protoGenerator.prototype);var context=new Context(tryLocsList||[]);generator._invoke=makeInvokeMethod(innerFn,self,context);return generator}exports.wrap=wrap;function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}var GenStateSuspendedStart="suspendedStart";var GenStateSuspendedYield="suspendedYield";var GenStateExecuting="executing";var GenStateCompleted="completed";var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};IteratorPrototype[iteratorSymbol]=function(){return this};var getProto=Object.getPrototypeOf;var NativeIteratorPrototype=getProto&&getProto(getProto(values([])));if(NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)){IteratorPrototype=NativeIteratorPrototype}var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);GeneratorFunction.prototype=Gp.constructor=GeneratorFunctionPrototype;GeneratorFunctionPrototype.constructor=GeneratorFunction;GeneratorFunctionPrototype[toStringTagSymbol]=GeneratorFunction.displayName="GeneratorFunction";function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){prototype[method]=function(arg){return this._invoke(method,arg)}})}exports.isGeneratorFunction=function(genFun){var ctor=typeof genFun==="function"&&genFun.constructor;return ctor?ctor===GeneratorFunction||(ctor.displayName||ctor.name)==="GeneratorFunction":false};exports.mark=function(genFun){if(Object.setPrototypeOf){Object.setPrototypeOf(genFun,GeneratorFunctionPrototype)}else{genFun.__proto__=GeneratorFunctionPrototype;if(!(toStringTagSymbol in genFun)){genFun[toStringTagSymbol]="GeneratorFunction"}}genFun.prototype=Object.create(Gp);return genFun};exports.awrap=function(arg){return{__await:arg}};function AsyncIterator(generator){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(record.type==="throw"){reject(record.arg)}else{var result=record.arg;var value=result.value;if(value&&typeof value==="object"&&hasOwn.call(value,"__await")){return Promise.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject)},function(err){invoke("throw",err,resolve,reject)})}return Promise.resolve(value).then(function(unwrapped){result.value=unwrapped;resolve(result)},function(error){return invoke("throw",error,resolve,reject)})}}var previousPromise;function enqueue(method,arg){function callInvokeWithMethodAndArg(){return new Promise(function(resolve,reject){invoke(method,arg,resolve,reject)})}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}this._invoke=enqueue}defineIteratorMethods(AsyncIterator.prototype);AsyncIterator.prototype[asyncIteratorSymbol]=function(){return this};exports.AsyncIterator=AsyncIterator;exports.async=function(innerFn,outerFn,self,tryLocsList){var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList));return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next()})};function makeInvokeMethod(innerFn,self,context){var state=GenStateSuspendedStart;return function invoke(method,arg){if(state===GenStateExecuting){throw new Error("Generator is already running")}if(state===GenStateCompleted){if(method==="throw"){throw arg}return doneResult()}context.method=method;context.arg=arg;while(true){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if(context.method==="next"){context.sent=context._sent=context.arg}else if(context.method==="throw"){if(state===GenStateSuspendedStart){state=GenStateCompleted;throw context.arg}context.dispatchException(context.arg)}else if(context.method==="return"){context.abrupt("return",context.arg)}state=GenStateExecuting;var record=tryCatch(innerFn,self,context);if(record.type==="normal"){state=context.done?GenStateCompleted:GenStateSuspendedYield;if(record.arg===ContinueSentinel){continue}return{value:record.arg,done:context.done}}else if(record.type==="throw"){state=GenStateCompleted;context.method="throw";context.arg=record.arg}}}}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(method===undefined){context.delegate=null;if(context.method==="throw"){if(delegate.iterator["return"]){context.method="return";context.arg=undefined;maybeInvokeDelegate(delegate,context);if(context.method==="throw"){return ContinueSentinel}}context.method="throw";context.arg=new TypeError("The iterator does not provide a 'throw' method")}return ContinueSentinel}var record=tryCatch(method,delegate.iterator,context.arg);if(record.type==="throw"){context.method="throw";context.arg=record.arg;context.delegate=null;return ContinueSentinel}var info=record.arg;if(!info){context.method="throw";context.arg=new TypeError("iterator result is not an object");context.delegate=null;return ContinueSentinel}if(info.done){context[delegate.resultName]=info.value;context.next=delegate.nextLoc;if(context.method!=="return"){context.method="next";context.arg=undefined}}else{return info}context.delegate=null;return ContinueSentinel}defineIteratorMethods(Gp);Gp[toStringTagSymbol]="Generator";Gp[iteratorSymbol]=function(){return this};Gp.toString=function(){return"[object Generator]"};function pushTryEntry(locs){var entry={tryLoc:locs[0]};if(1 in locs){entry.catchLoc=locs[1]}if(2 in locs){entry.finallyLoc=locs[2];entry.afterLoc=locs[3]}this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal";delete record.arg;entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}];tryLocsList.forEach(pushTryEntry,this);this.reset(true)}exports.keys=function(object){var keys=[];for(var key in object){keys.push(key)}keys.reverse();return function next(){while(keys.length){var key=keys.pop();if(key in object){next.value=key;next.done=false;return next}}next.done=true;return next}};function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod){return iteratorMethod.call(iterable)}if(typeof iterable.next==="function"){return iterable}if(!isNaN(iterable.length)){var i=-1,next=function next(){while(++i<iterable.length){if(hasOwn.call(iterable,i)){next.value=iterable[i];next.done=false;return next}}next.value=undefined;next.done=true;return next};return next.next=next}}return{next:doneResult}}exports.values=values;function doneResult(){return{value:undefined,done:true}}Context.prototype={constructor:Context,reset:function(skipTempReset){this.prev=0;this.next=0;this.sent=this._sent=undefined;this.done=false;this.delegate=null;this.method="next";this.arg=undefined;this.tryEntries.forEach(resetTryEntry);if(!skipTempReset){for(var name in this){if(name.charAt(0)==="t"&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))){this[name]=undefined}}}},stop:function(){this.done=true;var rootEntry=this.tryEntries[0];var rootRecord=rootEntry.completion;if(rootRecord.type==="throw"){throw rootRecord.arg}return this.rval},dispatchException:function(exception){if(this.done){throw exception}var context=this;function handle(loc,caught){record.type="throw";record.arg=exception;context.next=loc;if(caught){context.method="next";context.arg=undefined}return!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];var record=entry.completion;if(entry.tryLoc==="root"){return handle("end")}if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc");var hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}else if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else if(hasCatch){if(this.prev<entry.catchLoc){return handle(entry.catchLoc,true)}}else if(hasFinally){if(this.prev<entry.finallyLoc){return handle(entry.finallyLoc)}}else{throw new Error("try statement without catch or finally")}}}},abrupt:function(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}if(finallyEntry&&(type==="break"||type==="continue")&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc){finallyEntry=null}var record=finallyEntry?finallyEntry.completion:{};record.type=type;record.arg=arg;if(finallyEntry){this.method="next";this.next=finallyEntry.finallyLoc;return ContinueSentinel}return this.complete(record)},complete:function(record,afterLoc){if(record.type==="throw"){throw record.arg}if(record.type==="break"||record.type==="continue"){this.next=record.arg}else if(record.type==="return"){this.rval=this.arg=record.arg;this.method="return";this.next="end"}else if(record.type==="normal"&&afterLoc){this.next=afterLoc}return ContinueSentinel},finish:function(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc){this.complete(entry.completion,entry.afterLoc);resetTryEntry(entry);return ContinueSentinel}}},catch:function(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(record.type==="throw"){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function(iterable,resultName,nextLoc){this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc};if(this.method==="next"){this.arg=undefined}return ContinueSentinel}};return exports}(typeof module==="object"?module.exports:{});try{regeneratorRuntime=runtime}catch(accidentalStrictMode){Function("r","regeneratorRuntime = r")(runtime)}},{}],275:[function(_dereq_,module,exports){(function(self){"use strict";if(self.fetch){return}var support={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{new Blob;return true}catch(e){return false}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(support.arrayBuffer){var viewClasses=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"];var isDataView=function(obj){return obj&&DataView.prototype.isPrototypeOf(obj)};var isArrayBufferView=ArrayBuffer.isView||function(obj){return obj&&viewClasses.indexOf(Object.prototype.toString.call(obj))>-1}}function normalizeName(name){if(typeof name!=="string"){name=String(name)}if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name)){throw new TypeError("Invalid character in header field name")}return name.toLowerCase()}function normalizeValue(value){if(typeof value!=="string"){value=String(value)}return value}function iteratorFor(items){var iterator={next:function(){var value=items.shift();return{done:value===undefined,value:value}}};if(support.iterable){iterator[Symbol.iterator]=function(){return iterator}}return iterator}function Headers(headers){this.map={};if(headers instanceof Headers){headers.forEach(function(value,name){this.append(name,value)},this)}else if(Array.isArray(headers)){headers.forEach(function(header){this.append(header[0],header[1])},this)}else if(headers){Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name])},this)}}Headers.prototype.append=function(name,value){name=normalizeName(name);value=normalizeValue(value);var oldValue=this.map[name];this.map[name]=oldValue?oldValue+","+value:value};Headers.prototype["delete"]=function(name){delete this.map[normalizeName(name)]};Headers.prototype.get=function(name){name=normalizeName(name);return this.has(name)?this.map[name]:null};Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))};Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=normalizeValue(value)};Headers.prototype.forEach=function(callback,thisArg){for(var name in this.map){if(this.map.hasOwnProperty(name)){callback.call(thisArg,this.map[name],name,this)}}};Headers.prototype.keys=function(){var items=[];this.forEach(function(value,name){items.push(name)});return iteratorFor(items)};Headers.prototype.values=function(){var items=[];this.forEach(function(value){items.push(value)});return iteratorFor(items)};Headers.prototype.entries=function(){var items=[];this.forEach(function(value,name){items.push([name,value])});return iteratorFor(items)};if(support.iterable){Headers.prototype[Symbol.iterator]=Headers.prototype.entries}function consumed(body){if(body.bodyUsed){return Promise.reject(new TypeError("Already read"))}body.bodyUsed=true}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)};reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader;var promise=fileReaderReady(reader);reader.readAsArrayBuffer(blob);return promise}function readBlobAsText(blob){var reader=new FileReader;var promise=fileReaderReady(reader);reader.readAsText(blob);return promise}function readArrayBufferAsText(buf){var view=new Uint8Array(buf);var chars=new Array(view.length);for(var i=0;i<view.length;i++){chars[i]=String.fromCharCode(view[i])}return chars.join("")}function bufferClone(buf){if(buf.slice){return buf.slice(0)}else{var view=new Uint8Array(buf.byteLength);view.set(new Uint8Array(buf));return view.buffer}}function Body(){this.bodyUsed=false;this._initBody=function(body){this._bodyInit=body;if(!body){this._bodyText=""}else if(typeof body==="string"){this._bodyText=body}else if(support.blob&&Blob.prototype.isPrototypeOf(body)){this._bodyBlob=body}else if(support.formData&&FormData.prototype.isPrototypeOf(body)){this._bodyFormData=body}else if(support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)){this._bodyText=body.toString()}else if(support.arrayBuffer&&support.blob&&isDataView(body)){this._bodyArrayBuffer=bufferClone(body.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else if(support.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(body)||isArrayBufferView(body))){this._bodyArrayBuffer=bufferClone(body)}else{throw new Error("unsupported BodyInit type")}if(!this.headers.get("content-type")){if(typeof body==="string"){this.headers.set("content-type","text/plain;charset=UTF-8")}else if(this._bodyBlob&&this._bodyBlob.type){this.headers.set("content-type",this._bodyBlob.type)}else if(support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)){this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8")}}};if(support.blob){this.blob=function(){var rejected=consumed(this);if(rejected){return rejected}if(this._bodyBlob){return Promise.resolve(this._bodyBlob)}else if(this._bodyArrayBuffer){return Promise.resolve(new Blob([this._bodyArrayBuffer]))}else if(this._bodyFormData){throw new Error("could not read FormData body as blob")}else{return Promise.resolve(new Blob([this._bodyText]))}};this.arrayBuffer=function(){if(this._bodyArrayBuffer){return consumed(this)||Promise.resolve(this._bodyArrayBuffer)}else{return this.blob().then(readBlobAsArrayBuffer)}}}this.text=function(){var rejected=consumed(this);if(rejected){return rejected}if(this._bodyBlob){return readBlobAsText(this._bodyBlob)}else if(this._bodyArrayBuffer){return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))}else if(this._bodyFormData){throw new Error("could not read FormData body as text")}else{return Promise.resolve(this._bodyText)}};if(support.formData){this.formData=function(){return this.text().then(decode)}}this.json=function(){return this.text().then(JSON.parse)};return this}var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function normalizeMethod(method){var upcased=method.toUpperCase();return methods.indexOf(upcased)>-1?upcased:method}function Request(input,options){options=options||{};var body=options.body;if(input instanceof Request){if(input.bodyUsed){throw new TypeError("Already read")}this.url=input.url;this.credentials=input.credentials;if(!options.headers){this.headers=new Headers(input.headers)}this.method=input.method;this.mode=input.mode;if(!body&&input._bodyInit!=null){body=input._bodyInit;input.bodyUsed=true}}else{this.url=String(input)}this.credentials=options.credentials||this.credentials||"omit";if(options.headers||!this.headers){this.headers=new Headers(options.headers)}this.method=normalizeMethod(options.method||this.method||"GET");this.mode=options.mode||this.mode||null;this.referrer=null;if((this.method==="GET"||this.method==="HEAD")&&body){throw new TypeError("Body not allowed for GET or HEAD requests")}this._initBody(body)}Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})};function decode(body){var form=new FormData;body.trim().split("&").forEach(function(bytes){if(bytes){var split=bytes.split("=");var name=split.shift().replace(/\+/g," ");var value=split.join("=").replace(/\+/g," ");form.append(decodeURIComponent(name),decodeURIComponent(value))}});return form}function parseHeaders(rawHeaders){var headers=new Headers;var preProcessedHeaders=rawHeaders.replace(/\r?\n[\t ]+/g," ");preProcessedHeaders.split(/\r?\n/).forEach(function(line){var parts=line.split(":");var key=parts.shift().trim();if(key){var value=parts.join(":").trim();headers.append(key,value)}});return headers}Body.call(Request.prototype);function Response(bodyInit,options){if(!options){options={}}this.type="default";this.status=options.status===undefined?200:options.status;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in options?options.statusText:"OK";this.headers=new Headers(options.headers);this.url=options.url||"";this._initBody(bodyInit)}Body.call(Response.prototype);Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})};Response.error=function(){var response=new Response(null,{status:0,statusText:""});response.type="error";return response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(redirectStatuses.indexOf(status)===-1){throw new RangeError("Invalid status code")}return new Response(null,{status:status,headers:{location:url}})};self.Headers=Headers;self.Request=Request;self.Response=Response;self.fetch=function(input,init){return new Promise(function(resolve,reject){var request=new Request(input,init);var xhr=new XMLHttpRequest;xhr.onload=function(){var options={status:xhr.status,statusText:xhr.statusText,headers:parseHeaders(xhr.getAllResponseHeaders()||"")};options.url="responseURL"in xhr?xhr.responseURL:options.headers.get("X-Request-URL");var body="response"in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))};xhr.onerror=function(){reject(new TypeError("Network request failed"))};xhr.ontimeout=function(){reject(new TypeError("Network request failed"))};xhr.open(request.method,request.url,true);if(request.credentials==="include"){xhr.withCredentials=true}else if(request.credentials==="omit"){xhr.withCredentials=false}if("responseType"in xhr&&support.blob){xhr.responseType="blob"}request.headers.forEach(function(value,name){xhr.setRequestHeader(name,value)});xhr.send(typeof request._bodyInit==="undefined"?null:request._bodyInit)})};self.fetch.polyfill=true})(typeof self!=="undefined"?self:this)},{}],276:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.split");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var _color_conversion=_interopRequireDefault(_dereq_("../color/color_conversion"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var originalHSB;var colorExceptions=[{h:0,s:0,b:.8275,name:"gray"},{h:0,s:0,b:.8627,name:"gray"},{h:0,s:0,b:.7529,name:"gray"},{h:.0167,s:.1176,b:1,name:"light pink"}];var colorLookUp=[{h:0,s:0,b:0,name:"black"},{h:0,s:0,b:.5,name:"gray"},{h:0,s:0,b:1,name:"white"},{h:0,s:.5,b:.5,name:"dark maroon"},{h:0,s:.5,b:1,name:"salmon pink"},{h:0,s:1,b:0,name:"black"},{h:0,s:1,b:.5,name:"dark red"},{h:0,s:1,b:1,name:"red"},{h:5,s:0,b:1,name:"very light peach"},{h:5,s:.5,b:.5,name:"brown"},{h:5,s:.5,b:1,name:"peach"},{h:5,s:1,b:.5,name:"brick red"},{h:5,s:1,b:1,name:"crimson"},{h:10,s:0,b:1,name:"light peach"},{h:10,s:.5,b:.5,name:"brown"},{h:10,s:.5,b:1,name:"light orange"},{h:10,s:1,b:.5,name:"brown"},{h:10,s:1,b:1,name:"orange"},{h:15,s:0,b:1,name:"very light yellow"},{h:15,s:.5,b:.5,name:"olive green"},{h:15,s:.5,b:1,name:"light yellow"},{h:15,s:1,b:0,name:"dark olive green"},{h:15,s:1,b:.5,name:"olive green"},{h:15,s:1,b:1,name:"yellow"},{h:20,s:0,b:1,name:"very light yellow"},{h:20,s:.5,b:.5,name:"olive green"},{h:20,s:.5,b:1,name:"light yellow green"},{h:20,s:1,b:0,name:"dark olive green"},{h:20,s:1,b:.5,name:"dark yellow green"},{h:20,s:1,b:1,name:"yellow green"},{h:25,s:.5,b:.5,name:"dark yellow green"},{h:25,s:.5,b:1,name:"light green"},{h:25,s:1,b:.5,name:"dark green"},{h:25,s:1,b:1,name:"green"},{h:30,s:.5,b:1,name:"light green"},{h:30,s:1,b:.5,name:"dark green"},{h:30,s:1,b:1,name:"green"},{h:35,s:0,b:.5,name:"light green"},{h:35,s:0,b:1,name:"very light green"},{h:35,s:.5,b:.5,name:"dark green"},{h:35,s:.5,b:1,name:"light green"},{h:35,s:1,b:0,name:"very dark green"},{h:35,s:1,b:.5,name:"dark green"},{h:35,s:1,b:1,name:"green"},{h:40,s:0,b:1,name:"very light green"},{h:40,s:.5,b:.5,name:"dark green"},{h:40,s:.5,b:1,name:"light green"},{h:40,s:1,b:.5,name:"dark green"},{h:40,s:1,b:1,name:"green"},{h:45,s:.5,b:1,name:"light turquoise"},{h:45,s:1,b:.5,name:"dark turquoise"},{h:45,s:1,b:1,name:"turquoise"},{h:50,s:0,b:1,name:"light sky blue"},{h:50,s:.5,b:.5,name:"dark cyan"},{h:50,s:.5,b:1,name:"light cyan"},{h:50,s:1,b:.5,name:"dark cyan"},{h:50,s:1,b:1,name:"cyan"},{h:55,s:0,b:1,name:"light sky blue"},{h:55,s:.5,b:1,name:"light sky blue"},{h:55,s:1,b:.5,name:"dark blue"},{h:55,s:1,b:1,name:"sky blue"},{h:60,s:0,b:.5,name:"gray"},{h:60,s:0,b:1,name:"very light blue"},{h:60,s:.5,b:.5,name:"blue"},{h:60,s:.5,b:1,name:"light blue"},{h:60,s:1,b:.5,name:"navy blue"},{h:60,s:1,b:1,name:"blue"},{h:65,s:0,b:1,name:"lavender"},{h:65,s:.5,b:.5,name:"navy blue"},{h:65,s:.5,b:1,name:"light purple"},{h:65,s:1,b:.5,name:"dark navy blue"},{h:65,s:1,b:1,name:"blue"},{h:70,s:0,b:1,name:"lavender"},{h:70,s:.5,b:.5,name:"navy blue"},{h:70,s:.5,b:1,name:"lavender blue"},{h:70,s:1,b:.5,name:"dark navy blue"},{h:70,s:1,b:1,name:"blue"},{h:75,s:.5,b:1,name:"lavender"},{h:75,s:1,b:.5,name:"dark purple"},{h:75,s:1,b:1,name:"purple"},{h:80,s:.5,b:1,name:"pinkish purple"},{h:80,s:1,b:.5,name:"dark purple"},{h:80,s:1,b:1,name:"purple"},{h:85,s:0,b:1,name:"light pink"},{h:85,s:.5,b:.5,name:"purple"},{h:85,s:.5,b:1,name:"light fuchsia"},{h:85,s:1,b:.5,name:"dark fuchsia"},{h:85,s:1,b:1,name:"fuchsia"},{h:90,s:.5,b:.5,name:"dark fuchsia"},{h:90,s:.5,b:1,name:"hot pink"},{h:90,s:1,b:.5,name:"dark fuchsia"},{h:90,s:1,b:1,name:"fuchsia"},{h:95,s:0,b:1,name:"pink"},{h:95,s:.5,b:1,name:"light pink"},{h:95,s:1,b:.5,name:"dark magenta"},{h:95,s:1,b:1,name:"magenta"}];function _calculateColor(hsb){var colortext;if(hsb[0]!==0){hsb[0]=Math.round(hsb[0]*100);var hue=hsb[0].toString().split("");var last=hue.length-1;hue[last]=parseInt(hue[last]);if(hue[last]<2.5){hue[last]=0}else if(hue[last]>=2.5&&hue[last]<7.5){hue[last]=5}if(hue.length===2){hue[0]=parseInt(hue[0]);if(hue[last]>=7.5){hue[last]=0;hue[0]=hue[0]+1}hsb[0]=hue[0]*10+hue[1]}else{if(hue[last]>=7.5){hsb[0]=10}else{hsb[0]=hue[last]}}}hsb[2]=hsb[2]/255;for(var i=hsb.length-1;i>=1;i--){if(hsb[i]<=.25){hsb[i]=0}else if(hsb[i]>.25&&hsb[i]<.75){hsb[i]=.5}else{hsb[i]=1}}if(hsb[0]===0&&hsb[1]===0&&hsb[2]===1){for(var _i=2;_i>=0;_i--){originalHSB[_i]=Math.round(originalHSB[_i]*1e4)/1e4}for(var e=0;e<colorExceptions.length;e++){if(colorExceptions[e].h===originalHSB[0]&&colorExceptions[e].s===originalHSB[1]&&colorExceptions[e].b===originalHSB[2]){colortext=colorExceptions[e].name;break}else{colortext="white"}}}else{for(var _i2=0;_i2<colorLookUp.length;_i2++){if(colorLookUp[_i2].h===hsb[0]&&colorLookUp[_i2].s===hsb[1]&&colorLookUp[_i2].b===hsb[2]){colortext=colorLookUp[_i2].name;break}}}return colortext}_main.default.prototype._rgbColorName=function(arg){var hsb=_color_conversion.default._rgbaToHSBA(arg);originalHSB=hsb;return _calculateColor([hsb[0],hsb[1],hsb[2]])};var _default=_main.default;exports.default=_default},{"../color/color_conversion":282,"../core/main":298,"core-js/modules/es.function.name":186,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.split":216}],277:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.ends-with");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.ends-with");_dereq_("core-js/modules/es.string.replace");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var descContainer="_Description";var fallbackDescId="_fallbackDesc";var fallbackTableId="_fallbackTable";var fallbackTableElId="_fte_";var labelContainer="_Label";var labelDescId="_labelDesc";var labelTableId="_labelTable";var labelTableElId="_lte_";_main.default.prototype.describe=function(text,display){_main.default._validateParameters("describe",arguments);if(typeof text!=="string"){return}var cnvId=this.canvas.id;text=_descriptionText(text);if(!this.dummyDOM){this.dummyDOM=document.getElementById(cnvId).parentNode}if(!this.descriptions){this.descriptions={}}if(this.descriptions.fallback){if(this.descriptions.fallback.innerHTML!==text){this.descriptions.fallback.innerHTML=text}}else{this._describeHTML("fallback",text)}if(display===this.LABEL){if(this.descriptions.label){if(this.descriptions.label.innerHTML!==text){this.descriptions.label.innerHTML=text}}else{this._describeHTML("label",text)}}};_main.default.prototype.describeElement=function(name,text,display){_main.default._validateParameters("describeElement",arguments);if(typeof text!=="string"||typeof name!=="string"){return}var cnvId=this.canvas.id;text=_descriptionText(text);var elementName=_elementName(name);name=name.replace(/[^a-zA-Z0-9]/g,"");var inner='<th scope="row">'.concat(elementName,"</th><td>").concat(text,"</td>");if(!this.dummyDOM){this.dummyDOM=document.getElementById(cnvId).parentNode}if(!this.descriptions){this.descriptions={fallbackElements:{}}}else if(!this.descriptions.fallbackElements){this.descriptions.fallbackElements={}}if(this.descriptions.fallbackElements[name]){if(this.descriptions.fallbackElements[name].innerHTML!==inner){this.descriptions.fallbackElements[name].innerHTML=inner}}else{this._describeElementHTML("fallback",name,inner)}if(display===this.LABEL){if(!this.descriptions.labelElements){this.descriptions.labelElements={}}if(this.descriptions.labelElements[name]){if(this.descriptions.labelElements[name].innerHTML!==inner){this.descriptions.labelElements[name].innerHTML=inner}}else{this._describeElementHTML("label",name,inner)}}};function _descriptionText(text){if(text==="label"||text==="fallback"){throw new Error("description should not be LABEL or FALLBACK")}if(!text.endsWith(".")&&!text.endsWith(";")&&!text.endsWith(",")&&!text.endsWith("?")&&!text.endsWith("!")){text=text+"."}return text}_main.default.prototype._describeHTML=function(type,text){var cnvId=this.canvas.id;if(type==="fallback"){if(!this.dummyDOM.querySelector("#".concat(cnvId+descContainer))){var html='<div id="'.concat(cnvId).concat(descContainer,'" role="region" aria-label="Canvas Description"><p id="').concat(cnvId).concat(fallbackDescId,'"></p></div>');if(!this.dummyDOM.querySelector("#".concat(cnvId,"accessibleOutput"))){this.dummyDOM.querySelector("#".concat(cnvId)).innerHTML=html}else{this.dummyDOM.querySelector("#".concat(cnvId,"accessibleOutput")).insertAdjacentHTML("beforebegin",html)}}else{this.dummyDOM.querySelector("#"+cnvId+fallbackTableId).insertAdjacentHTML("beforebegin",'<p id="'.concat(cnvId+fallbackDescId,'"></p>'))}this.descriptions.fallback=this.dummyDOM.querySelector("#".concat(cnvId).concat(fallbackDescId));this.descriptions.fallback.innerHTML=text;return}else if(type==="label"){if(!this.dummyDOM.querySelector("#".concat(cnvId+labelContainer))){var _html='<div id="'.concat(cnvId).concat(labelContainer,'" class="p5Label"><p id="').concat(cnvId).concat(labelDescId,'"></p></div>');if(!this.dummyDOM.querySelector("#".concat(cnvId,"accessibleOutputLabel"))){this.dummyDOM.querySelector("#"+cnvId).insertAdjacentHTML("afterend",_html)}else{this.dummyDOM.querySelector("#".concat(cnvId,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",_html)}}else if(this.dummyDOM.querySelector("#".concat(cnvId+labelTableId))){this.dummyDOM.querySelector("#".concat(cnvId+labelTableId)).insertAdjacentHTML("beforebegin",'<p id="'.concat(cnvId).concat(labelDescId,'"></p>'))}this.descriptions.label=this.dummyDOM.querySelector("#"+cnvId+labelDescId);this.descriptions.label.innerHTML=text;return}};function _elementName(name){if(name==="label"||name==="fallback"){throw new Error("element name should not be LABEL or FALLBACK")}if(name.endsWith(".")||name.endsWith(";")||name.endsWith(",")){name=name.replace(/.$/,":")}else if(!name.endsWith(":")){name=name+":"}return name}_main.default.prototype._describeElementHTML=function(type,name,text){var cnvId=this.canvas.id;if(type==="fallback"){if(!this.dummyDOM.querySelector("#".concat(cnvId+descContainer))){var html='<div id="'.concat(cnvId).concat(descContainer,'" role="region" aria-label="Canvas Description"><table id="').concat(cnvId).concat(fallbackTableId,'"><caption>Canvas elements and their descriptions</caption></table></div>');if(!this.dummyDOM.querySelector("#".concat(cnvId,"accessibleOutput"))){this.dummyDOM.querySelector("#"+cnvId).innerHTML=html}else{this.dummyDOM.querySelector("#".concat(cnvId,"accessibleOutput")).insertAdjacentHTML("beforebegin",html)}}else if(!this.dummyDOM.querySelector("#"+cnvId+fallbackTableId)){this.dummyDOM.querySelector("#"+cnvId+fallbackDescId).insertAdjacentHTML("afterend",'<table id="'.concat(cnvId).concat(fallbackTableId,'"><caption>Canvas elements and their descriptions</caption></table>'))}var tableRow=document.createElement("tr");tableRow.id=cnvId+fallbackTableElId+name;this.dummyDOM.querySelector("#"+cnvId+fallbackTableId).appendChild(tableRow);this.descriptions.fallbackElements[name]=this.dummyDOM.querySelector("#".concat(cnvId).concat(fallbackTableElId).concat(name));this.descriptions.fallbackElements[name].innerHTML=text;return}else if(type==="label"){if(!this.dummyDOM.querySelector("#".concat(cnvId+labelContainer))){var _html2='<div id="'.concat(cnvId).concat(labelContainer,'" class="p5Label"><table id="').concat(cnvId).concat(labelTableId,'"></table></div>');if(!this.dummyDOM.querySelector("#".concat(cnvId,"accessibleOutputLabel"))){this.dummyDOM.querySelector("#"+cnvId).insertAdjacentHTML("afterend",_html2)}else{this.dummyDOM.querySelector("#".concat(cnvId,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",_html2)}}else if(!this.dummyDOM.querySelector("#".concat(cnvId+labelTableId))){this.dummyDOM.querySelector("#"+cnvId+labelDescId).insertAdjacentHTML("afterend",'<table id="'.concat(cnvId+labelTableId,'"></table>'))}var _tableRow=document.createElement("tr");_tableRow.id=cnvId+labelTableElId+name;this.dummyDOM.querySelector("#"+cnvId+labelTableId).appendChild(_tableRow);this.descriptions.labelElements[name]=this.dummyDOM.querySelector("#".concat(cnvId).concat(labelTableElId).concat(name));this.descriptions.labelElements[name].innerHTML=text}};var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.ends-with":208,"core-js/modules/es.string.replace":214}],278:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.string.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype._updateGridOutput=function(idT){if(!this.dummyDOM.querySelector("#".concat(idT,"_summary"))){return}var current=this._accessibleOutputs[idT];var innerShapeDetails=_gridShapeDetails(idT,this.ingredients.shapes);var innerSummary=_gridSummary(innerShapeDetails.numShapes,this.ingredients.colors.background,this.width,this.height);var innerMap=_gridMap(idT,this.ingredients.shapes);if(innerSummary!==current.summary.innerHTML){current.summary.innerHTML=innerSummary}if(innerMap!==current.map.innerHTML){current.map.innerHTML=innerMap}if(innerShapeDetails.details!==current.shapeDetails.innerHTML){current.shapeDetails.innerHTML=innerShapeDetails.details}this._accessibleOutputs[idT]=current};function _gridMap(idT,ingredients){var shapeNumber=0;var table="";var cells=Array.from(Array(10),function(){return Array(10)});for(var x in ingredients){for(var y in ingredients[x]){var fill=void 0;if(x!=="line"){fill='<a href="#'.concat(idT,"shape").concat(shapeNumber,'">').concat(ingredients[x][y].color," ").concat(x,"</a>")}else{fill='<a href="#'.concat(idT,"shape").concat(shapeNumber,'">').concat(ingredients[x][y].color," ").concat(x," midpoint</a>")}if(!cells[ingredients[x][y].loc.locY][ingredients[x][y].loc.locX]){cells[ingredients[x][y].loc.locY][ingredients[x][y].loc.locX]=fill}else{cells[ingredients[x][y].loc.locY][ingredients[x][y].loc.locX]=cells[ingredients[x][y].loc.locY][ingredients[x][y].loc.locX]+"  "+fill}shapeNumber++}}for(var _r in cells){var row="<tr>";for(var c in cells[_r]){row=row+"<td>";if(cells[_r][c]!==undefined){row=row+cells[_r][c]}row=row+"</td>"}table=table+row+"</tr>"}return table}function _gridSummary(numShapes,background,width,height){var text="".concat(background," canvas, ").concat(width," by ").concat(height," pixels, contains ").concat(numShapes[0]);if(numShapes[0]===1){text="".concat(text," shape: ").concat(numShapes[1])}else{text="".concat(text," shapes: ").concat(numShapes[1])}return text}function _gridShapeDetails(idT,ingredients){var shapeDetails="";var shapes="";var totalShapes=0;for(var x in ingredients){var shapeNum=0;for(var y in ingredients[x]){var line='<li id="'.concat(idT,"shape").concat(totalShapes,'">').concat(ingredients[x][y].color," ").concat(x,",");if(x==="line"){line=line+" location = ".concat(ingredients[x][y].pos,", length = ").concat(ingredients[x][y].length," pixels")}else{line=line+" location = ".concat(ingredients[x][y].pos);if(x!=="point"){line=line+", area = ".concat(ingredients[x][y].area," %")}line=line+"</li>"}shapeDetails=shapeDetails+line;shapeNum++;totalShapes++}if(shapeNum>1){shapes="".concat(shapes," ").concat(shapeNum," ").concat(x,"s")}else{shapes="".concat(shapes," ").concat(shapeNum," ").concat(x)}}return{numShapes:[totalShapes,shapes],details:shapeDetails}}var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.from":176,"core-js/modules/es.array.map":182,"core-js/modules/es.string.iterator":210}],279:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.number.to-fixed");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.number.to-fixed");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}_main.default.prototype.textOutput=function(display){_main.default._validateParameters("textOutput",arguments);if(this._accessibleOutputs.text){return}else{this._accessibleOutputs.text=true;this._createOutput("textOutput","Fallback");if(display===this.LABEL){this._accessibleOutputs.textLabel=true;this._createOutput("textOutput","Label")}}};_main.default.prototype.gridOutput=function(display){_main.default._validateParameters("gridOutput",arguments);if(this._accessibleOutputs.grid){return}else{this._accessibleOutputs.grid=true;this._createOutput("gridOutput","Fallback");if(display===this.LABEL){this._accessibleOutputs.gridLabel=true;this._createOutput("gridOutput","Label")}}};_main.default.prototype._addAccsOutput=function(){if(!this._accessibleOutputs){this._accessibleOutputs={text:false,grid:false,textLabel:false,gridLabel:false}}return this._accessibleOutputs.grid||this._accessibleOutputs.text};_main.default.prototype._createOutput=function(type,display){var cnvId=this.canvas.id;if(!this.ingredients){this.ingredients={shapes:{},colors:{background:"white",fill:"white",stroke:"black"},pShapes:""}}if(!this.dummyDOM){this.dummyDOM=document.getElementById(cnvId).parentNode}var cIdT,container,inner;var query="";if(display==="Fallback"){cIdT=cnvId+type;container=cnvId+"accessibleOutput";if(!this.dummyDOM.querySelector("#".concat(container))){if(!this.dummyDOM.querySelector("#".concat(cnvId,"_Description"))){this.dummyDOM.querySelector("#".concat(cnvId)).innerHTML='<div id="'.concat(container,'" role="region" aria-label="Canvas Outputs"></div>')}else{this.dummyDOM.querySelector("#".concat(cnvId,"_Description")).insertAdjacentHTML("afterend",'<div id="'.concat(container,'" role="region" aria-label="Canvas Outputs"></div>'))}}}else if(display==="Label"){query=display;cIdT=cnvId+type+display;container=cnvId+"accessibleOutput"+display;if(!this.dummyDOM.querySelector("#".concat(container))){if(!this.dummyDOM.querySelector("#".concat(cnvId,"_Label"))){this.dummyDOM.querySelector("#".concat(cnvId)).insertAdjacentHTML("afterend",'<div id="'.concat(container,'"></div>'))}else{this.dummyDOM.querySelector("#".concat(cnvId,"_Label")).insertAdjacentHTML("afterend",'<div id="'.concat(container,'"></div>'))}}}this._accessibleOutputs[cIdT]={};if(type==="textOutput"){query="#".concat(cnvId,"gridOutput").concat(query);inner='<div id="'.concat(cIdT,'">Text Output<div id="').concat(cIdT,'Summary" aria-label="text output summary"><p id="').concat(cIdT,'_summary"></p><ul id="').concat(cIdT,'_list"></ul></div><table id="').concat(cIdT,'_shapeDetails" summary="text output shape details"></table></div>');if(this.dummyDOM.querySelector(query)){this.dummyDOM.querySelector(query).insertAdjacentHTML("beforebegin",inner)}else{this.dummyDOM.querySelector("#".concat(container)).innerHTML=inner}this._accessibleOutputs[cIdT].list=this.dummyDOM.querySelector("#".concat(cIdT,"_list"))}else if(type==="gridOutput"){query="#".concat(cnvId,"textOutput").concat(query);inner='<div id="'.concat(cIdT,'">Grid Output<p id="').concat(cIdT,'_summary" aria-label="grid output summary"><table id="').concat(cIdT,'_map" summary="grid output content"></table><ul id="').concat(cIdT,'_shapeDetails" aria-label="grid output shape details"></ul></div>');if(this.dummyDOM.querySelector(query)){this.dummyDOM.querySelector(query).insertAdjacentHTML("afterend",inner)}else{this.dummyDOM.querySelector("#".concat(container)).innerHTML=inner}this._accessibleOutputs[cIdT].map=this.dummyDOM.querySelector("#".concat(cIdT,"_map"))}this._accessibleOutputs[cIdT].shapeDetails=this.dummyDOM.querySelector("#".concat(cIdT,"_shapeDetails"));this._accessibleOutputs[cIdT].summary=this.dummyDOM.querySelector("#".concat(cIdT,"_summary"))};_main.default.prototype._updateAccsOutput=function(){var cnvId=this.canvas.id;if(JSON.stringify(this.ingredients.shapes)!==this.ingredients.pShapes){this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes);if(this._accessibleOutputs.text){this._updateTextOutput(cnvId+"textOutput")}if(this._accessibleOutputs.grid){this._updateGridOutput(cnvId+"gridOutput")}if(this._accessibleOutputs.textLabel){this._updateTextOutput(cnvId+"textOutputLabel")}if(this._accessibleOutputs.gridLabel){this._updateGridOutput(cnvId+"gridOutputLabel")}}};_main.default.prototype._accsBackground=function(args){this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes);this.ingredients.shapes={};if(this.ingredients.colors.backgroundRGBA!==args){this.ingredients.colors.backgroundRGBA=args;this.ingredients.colors.background=this._rgbColorName(args)}};_main.default.prototype._accsCanvasColors=function(f,args){if(f==="fill"){if(this.ingredients.colors.fillRGBA!==args){this.ingredients.colors.fillRGBA=args;this.ingredients.colors.fill=this._rgbColorName(args)}}else if(f==="stroke"){if(this.ingredients.colors.strokeRGBA!==args){this.ingredients.colors.strokeRGBA=args;this.ingredients.colors.stroke=this._rgbColorName(args)}}};_main.default.prototype._accsOutput=function(f,args){if(f==="ellipse"&&args[2]===args[3]){f="circle"}else if(f==="rectangle"&&args[2]===args[3]){f="square"}var include={};var add=true;var middle=_getMiddle(f,args);if(f==="line"){include.color=this.ingredients.colors.stroke;include.length=Math.round(this.dist(args[0],args[1],args[2],args[3]));var p1=this._getPos(args[0],[1]);var p2=this._getPos(args[2],[3]);include.loc=_canvasLocator(middle,this.width,this.height);if(p1===p2){include.pos="at ".concat(p1)}else{include.pos="from ".concat(p1," to ").concat(p2)}}else{if(f==="point"){include.color=this.ingredients.colors.stroke}else{include.color=this.ingredients.colors.fill;include.area=this._getArea(f,args)}include.pos=this._getPos.apply(this,_toConsumableArray(middle));include.loc=_canvasLocator(middle,this.width,this.height)}if(!this.ingredients.shapes[f]){this.ingredients.shapes[f]=[include]}else if(this.ingredients.shapes[f]!==[include]){for(var y in this.ingredients.shapes[f]){if(JSON.stringify(this.ingredients.shapes[f][y])===JSON.stringify(include)){add=false}}if(add===true){this.ingredients.shapes[f].push(include)}}};function _getMiddle(f,args){var x,y;if(f==="rectangle"||f==="ellipse"||f==="arc"||f==="circle"||f==="square"){x=Math.round(args[0]+args[2]/2);y=Math.round(args[1]+args[3]/2)}else if(f==="triangle"){x=(args[0]+args[2]+args[4])/3;y=(args[1]+args[3]+args[5])/3}else if(f==="quadrilateral"){x=(args[0]+args[2]+args[4]+args[6])/4;y=(args[1]+args[3]+args[5]+args[7])/4}else if(f==="line"){x=(args[0]+args[2])/2;y=(args[1]+args[3])/2}else{x=args[0];y=args[1]}return[x,y]}_main.default.prototype._getPos=function(x,y){var untransformedPosition=new DOMPointReadOnly(x,y);var currentTransform=this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform();var _untransformedPositio=untransformedPosition.matrixTransform(currentTransform),transformedX=_untransformedPositio.x,transformedY=_untransformedPositio.y;var canvasWidth=this.width,canvasHeight=this.height;if(transformedX<.4*canvasWidth){if(transformedY<.4*canvasHeight){return"top left"}else if(transformedY>.6*canvasHeight){return"bottom left"}else{return"mid left"}}else if(transformedX>.6*canvasWidth){if(transformedY<.4*canvasHeight){return"top right"}else if(transformedY>.6*canvasHeight){return"bottom right"}else{return"mid right"}}else{if(transformedY<.4*canvasHeight){return"top middle"}else if(transformedY>.6*canvasHeight){return"bottom middle"}else{return"middle"}}};function _canvasLocator(args,canvasWidth,canvasHeight){var noRows=10;var noCols=10;var locX=Math.floor(args[0]/canvasWidth*noRows);var locY=Math.floor(args[1]/canvasHeight*noCols);if(locX===noRows){locX=locX-1}if(locY===noCols){locY=locY-1}return{locX:locX,locY:locY}}_main.default.prototype._getArea=function(objectType,shapeArgs){var objectArea=0;if(objectType==="arc"){var arcSizeInRadians=((shapeArgs[5]-shapeArgs[4])%(Math.PI*2)+Math.PI*2)%(Math.PI*2);objectArea=arcSizeInRadians*shapeArgs[2]*shapeArgs[3]/8;if(shapeArgs[6]==="open"||shapeArgs[6]==="chord"){var Ax=shapeArgs[0];var Ay=shapeArgs[1];var Bx=shapeArgs[0]+shapeArgs[2]/2*Math.cos(shapeArgs[4]).toFixed(2);var By=shapeArgs[1]+shapeArgs[3]/2*Math.sin(shapeArgs[4]).toFixed(2);var Cx=shapeArgs[0]+shapeArgs[2]/2*Math.cos(shapeArgs[5]).toFixed(2);var Cy=shapeArgs[1]+shapeArgs[3]/2*Math.sin(shapeArgs[5]).toFixed(2);var areaOfExtraTriangle=Math.abs(Ax*(By-Cy)+Bx*(Cy-Ay)+Cx*(Ay-By))/2;if(arcSizeInRadians>Math.PI){objectArea=objectArea+areaOfExtraTriangle}else{objectArea=objectArea-areaOfExtraTriangle}}}else if(objectType==="ellipse"||objectType==="circle"){objectArea=3.14*shapeArgs[2]/2*shapeArgs[3]/2}else if(objectType==="line"){objectArea=0}else if(objectType==="point"){objectArea=0}else if(objectType==="quadrilateral"){objectArea=Math.abs((shapeArgs[6]+shapeArgs[0])*(shapeArgs[7]-shapeArgs[1])+(shapeArgs[0]+shapeArgs[2])*(shapeArgs[1]-shapeArgs[3])+(shapeArgs[2]+shapeArgs[4])*(shapeArgs[3]-shapeArgs[5])+(shapeArgs[4]+shapeArgs[6])*(shapeArgs[5]-shapeArgs[7]))/2}else if(objectType==="rectangle"||objectType==="square"){objectArea=shapeArgs[2]*shapeArgs[3]}else if(objectType==="triangle"){objectArea=Math.abs(shapeArgs[0]*(shapeArgs[3]-shapeArgs[5])+shapeArgs[2]*(shapeArgs[5]-shapeArgs[1])+shapeArgs[4]*(shapeArgs[1]-shapeArgs[3]))/2}var canvasWidth=this.width*this._pixelDensity;var canvasHeight=this.height*this._pixelDensity;var canvasCorners=[new DOMPoint(0,0),new DOMPoint(canvasWidth,0),new DOMPoint(canvasWidth,canvasHeight),new DOMPoint(0,canvasHeight)];var currentTransform=this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform();var invertedTransform=currentTransform.inverse();var tc=canvasCorners.map(function(corner){return corner.matrixTransform(invertedTransform)});var transformedCanvasArea=Math.abs((tc[3].x+tc[0].x)*(tc[3].y-tc[0].y)+(tc[0].x+tc[1].x)*(tc[0].y-tc[1].y)+(tc[1].x+tc[2].x)*(tc[1].y-tc[2].y)+(tc[2].x+tc[3].x)*(tc[2].y-tc[3].y))/2;var untransformedArea=Math.round(objectArea*100/transformedCanvasArea);return untransformedArea};var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.fill":172,"core-js/modules/es.array.from":176,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.map":182,"core-js/modules/es.number.to-fixed":193,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.iterator":256}],280:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.concat");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype._updateTextOutput=function(idT){if(!this.dummyDOM.querySelector("#".concat(idT,"_summary"))){return}var current=this._accessibleOutputs[idT];var innerList=_shapeList(idT,this.ingredients.shapes);var innerSummary=_textSummary(innerList.numShapes,this.ingredients.colors.background,this.width,this.height);var innerShapeDetails=_shapeDetails(idT,this.ingredients.shapes);if(innerSummary!==current.summary.innerHTML){current.summary.innerHTML=innerSummary}if(innerList.listShapes!==current.list.innerHTML){current.list.innerHTML=innerList.listShapes}if(innerShapeDetails!==current.shapeDetails.innerHTML){current.shapeDetails.innerHTML=innerShapeDetails}this._accessibleOutputs[idT]=current};function _textSummary(numShapes,background,width,height){var text="Your output is a, ".concat(width," by ").concat(height," pixels, ").concat(background," canvas containing the following");if(numShapes===1){text="".concat(text," shape:")}else{text="".concat(text," ").concat(numShapes," shapes:")}return text}function _shapeDetails(idT,ingredients){var shapeDetails="";var shapeNumber=0;for(var x in ingredients){for(var y in ingredients[x]){var row='<tr id="'.concat(idT,"shape").concat(shapeNumber,'"><th>').concat(ingredients[x][y].color," ").concat(x,"</th>");if(x==="line"){row=row+"<td>location = ".concat(ingredients[x][y].pos,"</td><td>length = ").concat(ingredients[x][y].length," pixels</td></tr>")}else{row=row+"<td>location = ".concat(ingredients[x][y].pos,"</td>");if(x!=="point"){row=row+"<td> area = ".concat(ingredients[x][y].area,"%</td>")}row=row+"</tr>"}shapeDetails=shapeDetails+row;shapeNumber++}}return shapeDetails}function _shapeList(idT,ingredients){var shapeList="";var shapeNumber=0;for(var x in ingredients){for(var y in ingredients[x]){var _line='<li><a href="#'.concat(idT,"shape").concat(shapeNumber,'">').concat(ingredients[x][y].color," ").concat(x,"</a>");if(x==="line"){_line=_line+", ".concat(ingredients[x][y].pos,", ").concat(ingredients[x][y].length," pixels long.</li>")}else{_line=_line+", at ".concat(ingredients[x][y].pos);if(x!=="point"){_line=_line+", covering ".concat(ingredients[x][y].area,"% of the canvas")}_line=_line+".</li>"}shapeList=shapeList+_line;shapeNumber++}}return{numShapes:shapeNumber,listShapes:shapeList}}var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.concat":169}],281:[function(_dereq_,module,exports){"use strict";var _main=_interopRequireDefault(_dereq_("./core/main"));_dereq_("./core/constants");_dereq_("./core/environment");_dereq_("./core/friendly_errors/stacktrace");_dereq_("./core/friendly_errors/validate_params");_dereq_("./core/friendly_errors/file_errors");_dereq_("./core/friendly_errors/fes_core");_dereq_("./core/friendly_errors/sketch_reader");_dereq_("./core/helpers");_dereq_("./core/legacy");_dereq_("./core/preload");_dereq_("./core/p5.Element");_dereq_("./core/p5.Graphics");_dereq_("./core/p5.Renderer");_dereq_("./core/p5.Renderer2D");_dereq_("./core/rendering");_dereq_("./core/shim");_dereq_("./core/structure");_dereq_("./core/transform");_dereq_("./core/shape/2d_primitives");_dereq_("./core/shape/attributes");_dereq_("./core/shape/curves");_dereq_("./core/shape/vertex");_dereq_("./accessibility/outputs");_dereq_("./accessibility/textOutput");_dereq_("./accessibility/gridOutput");_dereq_("./accessibility/color_namer");_dereq_("./color/color_conversion");_dereq_("./color/creating_reading");_dereq_("./color/p5.Color");_dereq_("./color/setting");_dereq_("./data/p5.TypedDict");_dereq_("./data/local_storage.js");_dereq_("./dom/dom");_dereq_("./accessibility/describe");_dereq_("./events/acceleration");_dereq_("./events/keyboard");_dereq_("./events/mouse");_dereq_("./events/touch");_dereq_("./image/filters");_dereq_("./image/image");_dereq_("./image/loading_displaying");_dereq_("./image/p5.Image");_dereq_("./image/pixels");_dereq_("./io/files");_dereq_("./io/p5.Table");_dereq_("./io/p5.TableRow");_dereq_("./io/p5.XML");_dereq_("./math/calculation");_dereq_("./math/math");_dereq_("./math/noise");_dereq_("./math/p5.Vector");_dereq_("./math/random");_dereq_("./math/trigonometry");_dereq_("./typography/attributes");_dereq_("./typography/loading_displaying");_dereq_("./typography/p5.Font");_dereq_("./utilities/array_functions");_dereq_("./utilities/conversion");_dereq_("./utilities/string_functions");_dereq_("./utilities/time_date");_dereq_("./webgl/3d_primitives");_dereq_("./webgl/interaction");_dereq_("./webgl/light");_dereq_("./webgl/loading");_dereq_("./webgl/material");_dereq_("./webgl/p5.Camera");_dereq_("./webgl/p5.DataArray");_dereq_("./webgl/p5.Geometry");_dereq_("./webgl/p5.Matrix");_dereq_("./webgl/p5.RendererGL.Immediate");_dereq_("./webgl/p5.RendererGL");_dereq_("./webgl/p5.RendererGL.Retained");_dereq_("./webgl/p5.Framebuffer");_dereq_("./webgl/p5.Shader");_dereq_("./webgl/p5.RenderBuffer");_dereq_("./webgl/p5.Texture");_dereq_("./webgl/text");_dereq_("./core/init");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}module.exports=_main.default},{"./accessibility/color_namer":276,"./accessibility/describe":277,"./accessibility/gridOutput":278,"./accessibility/outputs":279,"./accessibility/textOutput":280,"./color/color_conversion":282,"./color/creating_reading":283,"./color/p5.Color":284,"./color/setting":285,"./core/constants":286,"./core/environment":287,"./core/friendly_errors/fes_core":289,"./core/friendly_errors/file_errors":290,"./core/friendly_errors/sketch_reader":291,"./core/friendly_errors/stacktrace":292,"./core/friendly_errors/validate_params":293,"./core/helpers":294,"./core/init":295,"./core/legacy":297,"./core/main":298,"./core/p5.Element":299,"./core/p5.Graphics":300,"./core/p5.Renderer":301,"./core/p5.Renderer2D":302,"./core/preload":303,"./core/rendering":304,"./core/shape/2d_primitives":305,"./core/shape/attributes":306,"./core/shape/curves":307,"./core/shape/vertex":308,"./core/shim":309,"./core/structure":310,"./core/transform":311,"./data/local_storage.js":312,"./data/p5.TypedDict":313,"./dom/dom":314,"./events/acceleration":315,"./events/keyboard":316,"./events/mouse":317,"./events/touch":318,"./image/filters":319,"./image/image":320,"./image/loading_displaying":321,"./image/p5.Image":322,"./image/pixels":323,"./io/files":324,"./io/p5.Table":325,"./io/p5.TableRow":326,"./io/p5.XML":327,"./math/calculation":328,"./math/math":329,"./math/noise":330,"./math/p5.Vector":331,"./math/random":332,"./math/trigonometry":333,"./typography/attributes":334,"./typography/loading_displaying":335,"./typography/p5.Font":336,"./utilities/array_functions":337,"./utilities/conversion":338,"./utilities/string_functions":339,"./utilities/time_date":340,"./webgl/3d_primitives":341,"./webgl/interaction":343,"./webgl/light":344,"./webgl/loading":345,"./webgl/material":346,"./webgl/p5.Camera":347,"./webgl/p5.DataArray":348,"./webgl/p5.Framebuffer":349,"./webgl/p5.Geometry":350,"./webgl/p5.Matrix":351,"./webgl/p5.RenderBuffer":352,"./webgl/p5.RendererGL":355,"./webgl/p5.RendererGL.Immediate":353,"./webgl/p5.RendererGL.Retained":354,"./webgl/p5.Shader":356,"./webgl/p5.Texture":357,"./webgl/text":358}],282:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.ColorConversion={_hsbaToHSLA:function _hsbaToHSLA(hsba){var hue=hsba[0];var sat=hsba[1];var val=hsba[2];var li=(2-sat)*val/2;if(li!==0){if(li===1){sat=0}else if(li<.5){sat=sat/(2-sat)}else{sat=sat*val/(2-li*2)}}return[hue,sat,li,hsba[3]]},_hsbaToRGBA:function _hsbaToRGBA(hsba){var hue=hsba[0]*6;var sat=hsba[1];var val=hsba[2];var RGBA=[];if(sat===0){RGBA=[val,val,val,hsba[3]]}else{var sector=Math.floor(hue);var tint1=val*(1-sat);var tint2=val*(1-sat*(hue-sector));var tint3=val*(1-sat*(1+sector-hue));var red,green,blue;if(sector===1){red=tint2;green=val;blue=tint1}else if(sector===2){red=tint1;green=val;blue=tint3}else if(sector===3){red=tint1;green=tint2;blue=val}else if(sector===4){red=tint3;green=tint1;blue=val}else if(sector===5){red=val;green=tint1;blue=tint2}else{red=val;green=tint3;blue=tint1}RGBA=[red,green,blue,hsba[3]]}return RGBA},_hslaToHSBA:function _hslaToHSBA(hsla){var hue=hsla[0];var sat=hsla[1];var li=hsla[2];var val;if(li<.5){val=(1+sat)*li}else{val=li+sat-li*sat}sat=2*(val-li)/val;return[hue,sat,val,hsla[3]]},_hslaToRGBA:function _hslaToRGBA(hsla){var hue=hsla[0]*6;var sat=hsla[1];var li=hsla[2];var RGBA=[];if(sat===0){RGBA=[li,li,li,hsla[3]]}else{var val;if(li<.5){val=(1+sat)*li}else{val=li+sat-li*sat}var zest=2*li-val;var hzvToRGB=function hzvToRGB(hue,zest,val){if(hue<0){hue+=6}else if(hue>=6){hue-=6}if(hue<1){return zest+(val-zest)*hue}else if(hue<3){return val}else if(hue<4){return zest+(val-zest)*(4-hue)}else{return zest}};RGBA=[hzvToRGB(hue+2,zest,val),hzvToRGB(hue,zest,val),hzvToRGB(hue-2,zest,val),hsla[3]]}return RGBA},_rgbaToHSBA:function _rgbaToHSBA(rgba){var red=rgba[0];var green=rgba[1];var blue=rgba[2];var val=Math.max(red,green,blue);var chroma=val-Math.min(red,green,blue);var hue,sat;if(chroma===0){hue=0;sat=0}else{sat=chroma/val;if(red===val){hue=(green-blue)/chroma}else if(green===val){hue=2+(blue-red)/chroma}else if(blue===val){hue=4+(red-green)/chroma}if(hue<0){hue+=6}else if(hue>=6){hue-=6}}return[hue/6,sat,val,rgba[3]]},_rgbaToHSLA:function _rgbaToHSLA(rgba){var red=rgba[0];var green=rgba[1];var blue=rgba[2];var val=Math.max(red,green,blue);var min=Math.min(red,green,blue);var li=val+min;var chroma=val-min;var hue,sat;if(chroma===0){hue=0;sat=0}else{if(li<1){sat=chroma/li}else{sat=chroma/(2-li)}if(red===val){hue=(green-blue)/chroma}else if(green===val){hue=2+(blue-red)/chroma}else if(blue===val){hue=4+(red-green)/chroma}if(hue<0){hue+=6}else if(hue>=6){hue-=6}}return[hue/6,sat,li/2,rgba[3]]}};var _default=_main.default.ColorConversion;exports.default=_default},{"../core/main":298}],283:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.map");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));_dereq_("./p5.Color");_dereq_("../core/friendly_errors/validate_params");_dereq_("../core/friendly_errors/file_errors");_dereq_("../core/friendly_errors/fes_core");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.alpha=function(c){_main.default._validateParameters("alpha",arguments);return this.color(c)._getAlpha()};_main.default.prototype.blue=function(c){_main.default._validateParameters("blue",arguments);return this.color(c)._getBlue()};_main.default.prototype.brightness=function(c){_main.default._validateParameters("brightness",arguments);return this.color(c)._getBrightness()};_main.default.prototype.color=function(){_main.default._validateParameters("color",arguments);if(arguments[0]instanceof _main.default.Color){return arguments[0]}var args=arguments[0]instanceof Array?arguments[0]:arguments;return new _main.default.Color(this,args)};_main.default.prototype.green=function(c){_main.default._validateParameters("green",arguments);return this.color(c)._getGreen()};_main.default.prototype.hue=function(c){_main.default._validateParameters("hue",arguments);return this.color(c)._getHue()};_main.default.prototype.lerpColor=function(c1,c2,amt){_main.default._validateParameters("lerpColor",arguments);var mode=this._colorMode;var maxes=this._colorMaxes;var l0,l1,l2,l3;var fromArray,toArray;if(mode===constants.RGB){fromArray=c1.levels.map(function(level){return level/255});toArray=c2.levels.map(function(level){return level/255})}else if(mode===constants.HSB){c1._getBrightness();c2._getBrightness();fromArray=c1.hsba;toArray=c2.hsba}else if(mode===constants.HSL){c1._getLightness();c2._getLightness();fromArray=c1.hsla;toArray=c2.hsla}else{throw new Error("".concat(mode,"cannot be used for interpolation."))}amt=Math.max(Math.min(amt,1),0);if(typeof this.lerp==="undefined"){this.lerp=function(start,stop,amt){return amt*(stop-start)+start}}l0=this.lerp(fromArray[0],toArray[0],amt);l1=this.lerp(fromArray[1],toArray[1],amt);l2=this.lerp(fromArray[2],toArray[2],amt);l3=this.lerp(fromArray[3],toArray[3],amt);l0*=maxes[mode][0];l1*=maxes[mode][1];l2*=maxes[mode][2];l3*=maxes[mode][3];return this.color(l0,l1,l2,l3)};_main.default.prototype.lightness=function(c){_main.default._validateParameters("lightness",arguments);return this.color(c)._getLightness()};_main.default.prototype.red=function(c){_main.default._validateParameters("red",arguments);return this.color(c)._getRed()};_main.default.prototype.saturation=function(c){_main.default._validateParameters("saturation",arguments);return this.color(c)._getSaturation()};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/friendly_errors/fes_core":289,"../core/friendly_errors/file_errors":290,"../core/friendly_errors/validate_params":293,"../core/main":298,"./p5.Color":284,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.map":182,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],284:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.trim");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.trim");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));var _color_conversion=_interopRequireDefault(_dereq_("./color_conversion"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var namedColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var WHITESPACE=/\s*/;var INTEGER=/(\d{1,3})/;var DECIMAL=/((?:\d+(?:\.\d+)?)|(?:\.\d+))/;var PERCENT=new RegExp("".concat(DECIMAL.source,"%"));var colorPatterns={HEX3:/^#([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX4:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX6:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,HEX8:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,RGB:new RegExp(["^rgb\\(",INTEGER.source,",",INTEGER.source,",",INTEGER.source,"\\)$"].join(WHITESPACE.source),"i"),RGB_PERCENT:new RegExp(["^rgb\\(",PERCENT.source,",",PERCENT.source,",",PERCENT.source,"\\)$"].join(WHITESPACE.source),"i"),RGBA:new RegExp(["^rgba\\(",INTEGER.source,",",INTEGER.source,",",INTEGER.source,",",DECIMAL.source,"\\)$"].join(WHITESPACE.source),"i"),RGBA_PERCENT:new RegExp(["^rgba\\(",PERCENT.source,",",PERCENT.source,",",PERCENT.source,",",DECIMAL.source,"\\)$"].join(WHITESPACE.source),"i"),HSL:new RegExp(["^hsl\\(",INTEGER.source,",",PERCENT.source,",",PERCENT.source,"\\)$"].join(WHITESPACE.source),"i"),HSLA:new RegExp(["^hsla\\(",INTEGER.source,",",PERCENT.source,",",PERCENT.source,",",DECIMAL.source,"\\)$"].join(WHITESPACE.source),"i"),HSB:new RegExp(["^hsb\\(",INTEGER.source,",",PERCENT.source,",",PERCENT.source,"\\)$"].join(WHITESPACE.source),"i"),HSBA:new RegExp(["^hsba\\(",INTEGER.source,",",PERCENT.source,",",PERCENT.source,",",DECIMAL.source,"\\)$"].join(WHITESPACE.source),"i")};_main.default.Color=function(){function Color(pInst,vals){_classCallCheck(this,Color);this._storeModeAndMaxes(pInst._colorMode,pInst._colorMaxes);if(![constants.RGB,constants.HSL,constants.HSB].includes(this.mode)){throw new Error("".concat(this.mode," is an invalid colorMode."))}else{this._array=Color._parseInputs.apply(this,vals)}this._calculateLevels()}_createClass(Color,[{key:"toString",value:function toString(format){var a=this.levels;var f=this._array;var alpha=f[3];switch(format){case"#rrggbb":return"#".concat(a[0]<16?"0".concat(a[0].toString(16)):a[0].toString(16),a[1]<16?"0".concat(a[1].toString(16)):a[1].toString(16),a[2]<16?"0".concat(a[2].toString(16)):a[2].toString(16));case"#rrggbbaa":return"#".concat(a[0]<16?"0".concat(a[0].toString(16)):a[0].toString(16),a[1]<16?"0".concat(a[1].toString(16)):a[1].toString(16),a[2]<16?"0".concat(a[2].toString(16)):a[2].toString(16),a[3]<16?"0".concat(a[3].toString(16)):a[3].toString(16));case"#rgb":return"#".concat(Math.round(f[0]*15).toString(16),Math.round(f[1]*15).toString(16),Math.round(f[2]*15).toString(16));case"#rgba":return"#".concat(Math.round(f[0]*15).toString(16),Math.round(f[1]*15).toString(16),Math.round(f[2]*15).toString(16),Math.round(f[3]*15).toString(16));case"rgb":return"rgb(".concat(a[0],", ",a[1],", ",a[2],")");case"rgb%":return"rgb(".concat((100*f[0]).toPrecision(3),"%, ",(100*f[1]).toPrecision(3),"%, ",(100*f[2]).toPrecision(3),"%)");case"rgba%":return"rgba(".concat((100*f[0]).toPrecision(3),"%, ",(100*f[1]).toPrecision(3),"%, ",(100*f[2]).toPrecision(3),"%, ",(100*f[3]).toPrecision(3),"%)");case"hsb":case"hsv":if(!this.hsba)this.hsba=_color_conversion.default._rgbaToHSBA(this._array);return"hsb(".concat(this.hsba[0]*this.maxes[constants.HSB][0],", ",this.hsba[1]*this.maxes[constants.HSB][1],", ",this.hsba[2]*this.maxes[constants.HSB][2],")");case"hsb%":case"hsv%":if(!this.hsba)this.hsba=_color_conversion.default._rgbaToHSBA(this._array);return"hsb(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%)");case"hsba":case"hsva":if(!this.hsba)this.hsba=_color_conversion.default._rgbaToHSBA(this._array);return"hsba(".concat(this.hsba[0]*this.maxes[constants.HSB][0],", ",this.hsba[1]*this.maxes[constants.HSB][1],", ",this.hsba[2]*this.maxes[constants.HSB][2],", ",alpha,")");case"hsba%":case"hsva%":if(!this.hsba)this.hsba=_color_conversion.default._rgbaToHSBA(this._array);return"hsba(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%, ",(100*alpha).toPrecision(3),"%)");case"hsl":if(!this.hsla)this.hsla=_color_conversion.default._rgbaToHSLA(this._array);return"hsl(".concat(this.hsla[0]*this.maxes[constants.HSL][0],", ",this.hsla[1]*this.maxes[constants.HSL][1],", ",this.hsla[2]*this.maxes[constants.HSL][2],")");case"hsl%":if(!this.hsla)this.hsla=_color_conversion.default._rgbaToHSLA(this._array);return"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%)");case"hsla":if(!this.hsla)this.hsla=_color_conversion.default._rgbaToHSLA(this._array);return"hsla(".concat(this.hsla[0]*this.maxes[constants.HSL][0],", ",this.hsla[1]*this.maxes[constants.HSL][1],", ",this.hsla[2]*this.maxes[constants.HSL][2],", ",alpha,")");case"hsla%":if(!this.hsla)this.hsla=_color_conversion.default._rgbaToHSLA(this._array);return"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%, ",(100*alpha).toPrecision(3),"%)");case"rgba":default:return"rgba(".concat(a[0],",",a[1],",",a[2],",",alpha,")")}}},{key:"setRed",value:function setRed(new_red){this._array[0]=new_red/this.maxes[constants.RGB][0];this._calculateLevels()}},{key:"setGreen",value:function setGreen(new_green){this._array[1]=new_green/this.maxes[constants.RGB][1];this._calculateLevels()}},{key:"setBlue",value:function setBlue(new_blue){this._array[2]=new_blue/this.maxes[constants.RGB][2];this._calculateLevels()}},{key:"setAlpha",value:function setAlpha(new_alpha){this._array[3]=new_alpha/this.maxes[this.mode][3];this._calculateLevels()}},{key:"_calculateLevels",value:function _calculateLevels(){var array=this._array;var levels=this.levels=new Array(array.length);for(var i=array.length-1;i>=0;--i){levels[i]=Math.round(array[i]*255)}this.hsla=null;this.hsba=null}},{key:"_getAlpha",value:function _getAlpha(){return this._array[3]*this.maxes[this.mode][3]}},{key:"_storeModeAndMaxes",value:function _storeModeAndMaxes(new_mode,new_maxes){this.mode=new_mode;this.maxes=new_maxes}},{key:"_getMode",value:function _getMode(){return this.mode}},{key:"_getMaxes",value:function _getMaxes(){return this.maxes}},{key:"_getBlue",value:function _getBlue(){return this._array[2]*this.maxes[constants.RGB][2]}},{key:"_getBrightness",value:function _getBrightness(){if(!this.hsba){this.hsba=_color_conversion.default._rgbaToHSBA(this._array)}return this.hsba[2]*this.maxes[constants.HSB][2]}},{key:"_getGreen",value:function _getGreen(){return this._array[1]*this.maxes[constants.RGB][1]}},{key:"_getHue",value:function _getHue(){if(this.mode===constants.HSB){if(!this.hsba){this.hsba=_color_conversion.default._rgbaToHSBA(this._array)}return this.hsba[0]*this.maxes[constants.HSB][0]}else{if(!this.hsla){this.hsla=_color_conversion.default._rgbaToHSLA(this._array)}return this.hsla[0]*this.maxes[constants.HSL][0]}}},{key:"_getLightness",value:function _getLightness(){if(!this.hsla){this.hsla=_color_conversion.default._rgbaToHSLA(this._array)}return this.hsla[2]*this.maxes[constants.HSL][2]}},{key:"_getRed",value:function _getRed(){return this._array[0]*this.maxes[constants.RGB][0]}},{key:"_getSaturation",value:function _getSaturation(){if(this.mode===constants.HSB){if(!this.hsba){this.hsba=_color_conversion.default._rgbaToHSBA(this._array)}return this.hsba[1]*this.maxes[constants.HSB][1]}else{if(!this.hsla){this.hsla=_color_conversion.default._rgbaToHSLA(this._array)}return this.hsla[1]*this.maxes[constants.HSL][1]}}}],[{key:"_parseInputs",value:function _parseInputs(r,g,b,a){var numArgs=arguments.length;var mode=this.mode;var maxes=this.maxes[mode];var results=[];var i;if(numArgs>=3){results[0]=r/maxes[0];results[1]=g/maxes[1];results[2]=b/maxes[2];if(typeof a==="number"){results[3]=a/maxes[3]}else{results[3]=1}for(i=results.length-1;i>=0;--i){var result=results[i];if(result<0){results[i]=0}else if(result>1){results[i]=1}}if(mode===constants.HSL){return _color_conversion.default._hslaToRGBA(results)}else if(mode===constants.HSB){return _color_conversion.default._hsbaToRGBA(results)}else{return results}}else if(numArgs===1&&typeof r==="string"){var str=r.trim().toLowerCase();if(namedColors[str]){return Color._parseInputs.call(this,namedColors[str])}if(colorPatterns.HEX3.test(str)){results=colorPatterns.HEX3.exec(str).slice(1).map(function(color){return parseInt(color+color,16)/255});results[3]=1;return results}else if(colorPatterns.HEX6.test(str)){results=colorPatterns.HEX6.exec(str).slice(1).map(function(color){return parseInt(color,16)/255});results[3]=1;return results}else if(colorPatterns.HEX4.test(str)){results=colorPatterns.HEX4.exec(str).slice(1).map(function(color){return parseInt(color+color,16)/255});return results}else if(colorPatterns.HEX8.test(str)){results=colorPatterns.HEX8.exec(str).slice(1).map(function(color){return parseInt(color,16)/255});return results}else if(colorPatterns.RGB.test(str)){results=colorPatterns.RGB.exec(str).slice(1).map(function(color){return color/255});results[3]=1;return results}else if(colorPatterns.RGB_PERCENT.test(str)){results=colorPatterns.RGB_PERCENT.exec(str).slice(1).map(function(color){return parseFloat(color)/100});results[3]=1;return results}else if(colorPatterns.RGBA.test(str)){results=colorPatterns.RGBA.exec(str).slice(1).map(function(color,idx){if(idx===3){return parseFloat(color)}return color/255});return results}else if(colorPatterns.RGBA_PERCENT.test(str)){results=colorPatterns.RGBA_PERCENT.exec(str).slice(1).map(function(color,idx){if(idx===3){return parseFloat(color)}return parseFloat(color)/100});return results}if(colorPatterns.HSL.test(str)){results=colorPatterns.HSL.exec(str).slice(1).map(function(color,idx){if(idx===0){return parseInt(color,10)/360}return parseInt(color,10)/100});results[3]=1}else if(colorPatterns.HSLA.test(str)){results=colorPatterns.HSLA.exec(str).slice(1).map(function(color,idx){if(idx===0){return parseInt(color,10)/360}else if(idx===3){return parseFloat(color)}return parseInt(color,10)/100})}results=results.map(function(value){return Math.max(Math.min(value,1),0)});if(results.length){return _color_conversion.default._hslaToRGBA(results)}if(colorPatterns.HSB.test(str)){results=colorPatterns.HSB.exec(str).slice(1).map(function(color,idx){if(idx===0){return parseInt(color,10)/360}return parseInt(color,10)/100});results[3]=1}else if(colorPatterns.HSBA.test(str)){results=colorPatterns.HSBA.exec(str).slice(1).map(function(color,idx){if(idx===0){return parseInt(color,10)/360}else if(idx===3){return parseFloat(color)}return parseInt(color,10)/100})}if(results.length){for(i=results.length-1;i>=0;--i){results[i]=Math.max(Math.min(results[i],1),0)}return _color_conversion.default._hsbaToRGBA(results)}results=[1,1,1,1]}else if((numArgs===1||numArgs===2)&&typeof r==="number"){results[0]=r/maxes[2];results[1]=r/maxes[2];results[2]=r/maxes[2];if(typeof g==="number"){results[3]=g/maxes[3]}else{results[3]=1}results=results.map(function(value){return Math.max(Math.min(value,1),0)})}else{throw new Error("".concat(arguments,"is not a valid color representation."))}return results}}]);return Color}();var _default=_main.default.Color;exports.default=_default},{"../core/constants":286,"../core/main":298,"./color_conversion":282,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.join":180,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.constructor":204,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.trim":219,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],285:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.fill");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));_dereq_("./p5.Color");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.beginClip=function(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._renderer.beginClip(options)};_main.default.prototype.endClip=function(){this._renderer.endClip()};_main.default.prototype.clip=function(callback,options){this._renderer.beginClip(options);callback();this._renderer.endClip(options)};_main.default.prototype.background=function(){var _this$_renderer;(_this$_renderer=this._renderer).background.apply(_this$_renderer,arguments);return this};_main.default.prototype.clear=function(){var _r=(arguments.length<=0?undefined:arguments[0])||0;var _g=(arguments.length<=1?undefined:arguments[1])||0;var _b=(arguments.length<=2?undefined:arguments[2])||0;var _a=(arguments.length<=3?undefined:arguments[3])||0;this._renderer.clear(_r,_g,_b,_a);return this};_main.default.prototype.colorMode=function(mode,max1,max2,max3,maxA){_main.default._validateParameters("colorMode",arguments);if(mode===constants.RGB||mode===constants.HSB||mode===constants.HSL){this._colorMode=mode;var maxes=this._colorMaxes[mode];if(arguments.length===2){maxes[0]=max1;maxes[1]=max1;maxes[2]=max1;maxes[3]=max1}else if(arguments.length===4){maxes[0]=max1;maxes[1]=max2;maxes[2]=max3}else if(arguments.length===5){maxes[0]=max1;maxes[1]=max2;maxes[2]=max3;maxes[3]=maxA}}return this};_main.default.prototype.fill=function(){var _this$_renderer2;this._renderer._setProperty("_fillSet",true);this._renderer._setProperty("_doFill",true);(_this$_renderer2=this._renderer).fill.apply(_this$_renderer2,arguments);return this};_main.default.prototype.noFill=function(){this._renderer._setProperty("_doFill",false);return this};_main.default.prototype.noStroke=function(){this._renderer._setProperty("_doStroke",false);return this};_main.default.prototype.stroke=function(){var _this$_renderer3;this._renderer._setProperty("_strokeSet",true);this._renderer._setProperty("_doStroke",true);(_this$_renderer3=this._renderer).stroke.apply(_this$_renderer3,arguments);return this};_main.default.prototype.erase=function(){var opacityFill=arguments.length>0&&arguments[0]!==undefined?arguments[0]:255;var opacityStroke=arguments.length>1&&arguments[1]!==undefined?arguments[1]:255;this._renderer.erase(opacityFill,opacityStroke);return this};_main.default.prototype.noErase=function(){this._renderer.noErase();return this};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/main":298,"./p5.Color":284,"core-js/modules/es.array.fill":172,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],286:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.QUADRATIC=exports.LINEAR=exports._CTX_MIDDLE=exports._DEFAULT_LEADMULT=exports._DEFAULT_TEXT_FILL=exports.WORD=exports.CHAR=exports.BOLDITALIC=exports.BOLD=exports.ITALIC=exports.NORMAL=exports.BLUR=exports.ERODE=exports.DILATE=exports.POSTERIZE=exports.INVERT=exports.OPAQUE=exports.GRAY=exports.THRESHOLD=exports.BURN=exports.DODGE=exports.SOFT_LIGHT=exports.HARD_LIGHT=exports.OVERLAY=exports.REPLACE=exports.SCREEN=exports.MULTIPLY=exports.EXCLUSION=exports.SUBTRACT=exports.DIFFERENCE=exports.LIGHTEST=exports.DARKEST=exports.ADD=exports.REMOVE=exports.BLEND=exports.UP_ARROW=exports.TAB=exports.SHIFT=exports.RIGHT_ARROW=exports.RETURN=exports.OPTION=exports.LEFT_ARROW=exports.ESCAPE=exports.ENTER=exports.DOWN_ARROW=exports.DELETE=exports.CONTROL=exports.BACKSPACE=exports.ALT=exports.AUTO=exports.HSL=exports.HSB=exports.RGB=exports.MITER=exports.BEVEL=exports.ROUND=exports.SQUARE=exports.PROJECT=exports.PIE=exports.CHORD=exports.OPEN=exports.CLOSE=exports.TESS=exports.QUAD_STRIP=exports.QUADS=exports.TRIANGLE_STRIP=exports.TRIANGLE_FAN=exports.TRIANGLES=exports.LINE_LOOP=exports.LINE_STRIP=exports.LINES=exports.POINTS=exports.BASELINE=exports.BOTTOM=exports.TOP=exports.CENTER=exports.LEFT=exports.RIGHT=exports.RADIUS=exports.CORNERS=exports.CORNER=exports.RAD_TO_DEG=exports.DEG_TO_RAD=exports.RADIANS=exports.DEGREES=exports.TWO_PI=exports.TAU=exports.QUARTER_PI=exports.PI=exports.HALF_PI=exports.WAIT=exports.TEXT=exports.MOVE=exports.HAND=exports.CROSS=exports.ARROW=exports.WEBGL2=exports.WEBGL=exports.P2D=exports.VERSION=void 0;exports.RGBA=exports.HALF_FLOAT=exports.FLOAT=exports.UNSIGNED_INT=exports.UNSIGNED_BYTE=exports.COVER=exports.CONTAIN=exports.FALLBACK=exports.LABEL=exports.AXES=exports.GRID=exports._DEFAULT_FILL=exports._DEFAULT_STROKE=exports.PORTRAIT=exports.LANDSCAPE=exports.SMOOTH=exports.FLAT=exports.MIRROR=exports.CLAMP=exports.REPEAT=exports.NEAREST=exports.IMAGE=exports.IMMEDIATE=exports.TEXTURE=exports.FILL=exports.STROKE=exports.CURVE=exports.BEZIER=void 0;var _PI=Math.PI;var VERSION="1.9.0";exports.VERSION=VERSION;var P2D="p2d";exports.P2D=P2D;var WEBGL="webgl";exports.WEBGL=WEBGL;var WEBGL2="webgl2";exports.WEBGL2=WEBGL2;var ARROW="default";exports.ARROW=ARROW;var CROSS="crosshair";exports.CROSS=CROSS;var HAND="pointer";exports.HAND=HAND;var MOVE="move";exports.MOVE=MOVE;var TEXT="text";exports.TEXT=TEXT;var WAIT="wait";exports.WAIT=WAIT;var HALF_PI=_PI/2;exports.HALF_PI=HALF_PI;var PI=_PI;exports.PI=PI;var QUARTER_PI=_PI/4;exports.QUARTER_PI=QUARTER_PI;var TAU=_PI*2;exports.TAU=TAU;var TWO_PI=_PI*2;exports.TWO_PI=TWO_PI;var DEGREES="degrees";exports.DEGREES=DEGREES;var RADIANS="radians";exports.RADIANS=RADIANS;var DEG_TO_RAD=_PI/180;exports.DEG_TO_RAD=DEG_TO_RAD;var RAD_TO_DEG=180/_PI;exports.RAD_TO_DEG=RAD_TO_DEG;var CORNER="corner";exports.CORNER=CORNER;var CORNERS="corners";exports.CORNERS=CORNERS;var RADIUS="radius";exports.RADIUS=RADIUS;var RIGHT="right";exports.RIGHT=RIGHT;var LEFT="left";exports.LEFT=LEFT;var CENTER="center";exports.CENTER=CENTER;var TOP="top";exports.TOP=TOP;var BOTTOM="bottom";exports.BOTTOM=BOTTOM;var BASELINE="alphabetic";exports.BASELINE=BASELINE;var POINTS=0;exports.POINTS=POINTS;var LINES=1;exports.LINES=LINES;var LINE_STRIP=3;exports.LINE_STRIP=LINE_STRIP;var LINE_LOOP=2;exports.LINE_LOOP=LINE_LOOP;var TRIANGLES=4;exports.TRIANGLES=TRIANGLES;var TRIANGLE_FAN=6;exports.TRIANGLE_FAN=TRIANGLE_FAN;var TRIANGLE_STRIP=5;exports.TRIANGLE_STRIP=TRIANGLE_STRIP;var QUADS="quads";exports.QUADS=QUADS;var QUAD_STRIP="quad_strip";exports.QUAD_STRIP=QUAD_STRIP;var TESS="tess";exports.TESS=TESS;var CLOSE="close";exports.CLOSE=CLOSE;var OPEN="open";exports.OPEN=OPEN;var CHORD="chord";exports.CHORD=CHORD;var PIE="pie";exports.PIE=PIE;var PROJECT="square";exports.PROJECT=PROJECT;var SQUARE="butt";exports.SQUARE=SQUARE;var ROUND="round";exports.ROUND=ROUND;var BEVEL="bevel";exports.BEVEL=BEVEL;var MITER="miter";exports.MITER=MITER;var RGB="rgb";exports.RGB=RGB;var HSB="hsb";exports.HSB=HSB;var HSL="hsl";exports.HSL=HSL;var AUTO="auto";exports.AUTO=AUTO;var ALT=18;exports.ALT=ALT;var BACKSPACE=8;exports.BACKSPACE=BACKSPACE;var CONTROL=17;exports.CONTROL=CONTROL;var DELETE=46;exports.DELETE=DELETE;var DOWN_ARROW=40;exports.DOWN_ARROW=DOWN_ARROW;var ENTER=13;exports.ENTER=ENTER;var ESCAPE=27;exports.ESCAPE=ESCAPE;var LEFT_ARROW=37;exports.LEFT_ARROW=LEFT_ARROW;var OPTION=18;exports.OPTION=OPTION;var RETURN=13;exports.RETURN=RETURN;var RIGHT_ARROW=39;exports.RIGHT_ARROW=RIGHT_ARROW;var SHIFT=16;exports.SHIFT=SHIFT;var TAB=9;exports.TAB=TAB;var UP_ARROW=38;exports.UP_ARROW=UP_ARROW;var BLEND="source-over";exports.BLEND=BLEND;var REMOVE="destination-out";exports.REMOVE=REMOVE;var ADD="lighter";exports.ADD=ADD;var DARKEST="darken";exports.DARKEST=DARKEST;var LIGHTEST="lighten";exports.LIGHTEST=LIGHTEST;var DIFFERENCE="difference";exports.DIFFERENCE=DIFFERENCE;var SUBTRACT="subtract";exports.SUBTRACT=SUBTRACT;var EXCLUSION="exclusion";exports.EXCLUSION=EXCLUSION;var MULTIPLY="multiply";exports.MULTIPLY=MULTIPLY;var SCREEN="screen";exports.SCREEN=SCREEN;var REPLACE="copy";exports.REPLACE=REPLACE;var OVERLAY="overlay";exports.OVERLAY=OVERLAY;var HARD_LIGHT="hard-light";exports.HARD_LIGHT=HARD_LIGHT;var SOFT_LIGHT="soft-light";exports.SOFT_LIGHT=SOFT_LIGHT;var DODGE="color-dodge";exports.DODGE=DODGE;var BURN="color-burn";exports.BURN=BURN;var THRESHOLD="threshold";exports.THRESHOLD=THRESHOLD;var GRAY="gray";exports.GRAY=GRAY;var OPAQUE="opaque";exports.OPAQUE=OPAQUE;var INVERT="invert";exports.INVERT=INVERT;var POSTERIZE="posterize";exports.POSTERIZE=POSTERIZE;var DILATE="dilate";exports.DILATE=DILATE;var ERODE="erode";exports.ERODE=ERODE;var BLUR="blur";exports.BLUR=BLUR;var NORMAL="normal";exports.NORMAL=NORMAL;var ITALIC="italic";exports.ITALIC=ITALIC;var BOLD="bold";exports.BOLD=BOLD;var BOLDITALIC="bold italic";exports.BOLDITALIC=BOLDITALIC;var CHAR="CHAR";exports.CHAR=CHAR;var WORD="WORD";exports.WORD=WORD;var _DEFAULT_TEXT_FILL="#000000";exports._DEFAULT_TEXT_FILL=_DEFAULT_TEXT_FILL;var _DEFAULT_LEADMULT=1.25;exports._DEFAULT_LEADMULT=_DEFAULT_LEADMULT;var _CTX_MIDDLE="middle";exports._CTX_MIDDLE=_CTX_MIDDLE;var LINEAR="linear";exports.LINEAR=LINEAR;var QUADRATIC="quadratic";exports.QUADRATIC=QUADRATIC;var BEZIER="bezier";exports.BEZIER=BEZIER;var CURVE="curve";exports.CURVE=CURVE;var STROKE="stroke";exports.STROKE=STROKE;var FILL="fill";exports.FILL=FILL;var TEXTURE="texture";exports.TEXTURE=TEXTURE;var IMMEDIATE="immediate";exports.IMMEDIATE=IMMEDIATE;var IMAGE="image";exports.IMAGE=IMAGE;var NEAREST="nearest";exports.NEAREST=NEAREST;var REPEAT="repeat";exports.REPEAT=REPEAT;var CLAMP="clamp";exports.CLAMP=CLAMP;var MIRROR="mirror";exports.MIRROR=MIRROR;var FLAT="flat";exports.FLAT=FLAT;var SMOOTH="smooth";exports.SMOOTH=SMOOTH;var LANDSCAPE="landscape";exports.LANDSCAPE=LANDSCAPE;var PORTRAIT="portrait";exports.PORTRAIT=PORTRAIT;var _DEFAULT_STROKE="#000000";exports._DEFAULT_STROKE=_DEFAULT_STROKE;var _DEFAULT_FILL="#FFFFFF";exports._DEFAULT_FILL=_DEFAULT_FILL;var GRID="grid";exports.GRID=GRID;var AXES="axes";exports.AXES=AXES;var LABEL="label";exports.LABEL=LABEL;var FALLBACK="fallback";exports.FALLBACK=FALLBACK;var CONTAIN="contain";exports.CONTAIN=CONTAIN;var COVER="cover";exports.COVER=COVER;var UNSIGNED_BYTE="unsigned-byte";exports.UNSIGNED_BYTE=UNSIGNED_BYTE;var UNSIGNED_INT="unsigned-int";exports.UNSIGNED_INT=UNSIGNED_INT;var FLOAT="float";exports.FLOAT=FLOAT;var HALF_FLOAT="half-float";exports.HALF_FLOAT=HALF_FLOAT;var RGBA="rgba";exports.RGBA=RGBA},{}],287:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.search");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.search");_dereq_("core-js/modules/es.string.split");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("./main"));var C=_interopRequireWildcard(_dereq_("./constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var standardCursors=[C.ARROW,C.CROSS,C.HAND,C.MOVE,C.TEXT,C.WAIT];_main.default.prototype._frameRate=0;_main.default.prototype._lastFrameTime=window.performance.now();_main.default.prototype._targetFrameRate=60;var _windowPrint=window.print;var windowPrintDisabled=false;_main.default.prototype.print=function(){if(!arguments.length){if(!windowPrintDisabled){_windowPrint();if(window.confirm("You just tried to print the webpage. Do you want to prevent this from running again?")){windowPrintDisabled=true}}}else{var _console;(_console=console).log.apply(_console,arguments)}};_main.default.prototype.frameCount=0;_main.default.prototype.deltaTime=0;_main.default.prototype.focused=document.hasFocus();_main.default.prototype.cursor=function(type,x,y){var cursor="auto";var canvas=this._curElement.elt;if(standardCursors.includes(type)){cursor=type}else if(typeof type==="string"){var coords="";if(x&&y&&typeof x==="number"&&typeof y==="number"){coords="".concat(x," ").concat(y)}if(type.substring(0,7)==="http://"||type.substring(0,8)==="https://"){cursor="url(".concat(type,") ").concat(coords,", auto")}else if(/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(type)){cursor="url(".concat(type,") ").concat(coords,", auto")}else{cursor=type}}canvas.style.cursor=cursor};_main.default.prototype.frameRate=function(fps){_main.default._validateParameters("frameRate",arguments);if(typeof fps!=="number"||fps<0){return this._frameRate}else{this._setProperty("_targetFrameRate",fps);if(fps===0){this._setProperty("_frameRate",fps)}return this}};_main.default.prototype.getFrameRate=function(){return this.frameRate()};_main.default.prototype.setFrameRate=function(fps){return this.frameRate(fps)};_main.default.prototype.getTargetFrameRate=function(){return this._targetFrameRate};_main.default.prototype.noCursor=function(){this._curElement.elt.style.cursor="none"};_main.default.prototype.webglVersion=C.P2D;_main.default.prototype.displayWidth=screen.width;_main.default.prototype.displayHeight=screen.height;_main.default.prototype.windowWidth=getWindowWidth();_main.default.prototype.windowHeight=getWindowHeight();_main.default.prototype._onresize=function(e){this._setProperty("windowWidth",getWindowWidth());this._setProperty("windowHeight",getWindowHeight());var context=this._isGlobal?window:this;var executeDefault;if(typeof context.windowResized==="function"){executeDefault=context.windowResized(e);if(executeDefault!==undefined&&!executeDefault){e.preventDefault()}}};function getWindowWidth(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function getWindowHeight(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}_main.default.prototype.width=0;_main.default.prototype.height=0;_main.default.prototype.fullscreen=function(val){_main.default._validateParameters("fullscreen",arguments);if(typeof val==="undefined"){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement}else{if(val){launchFullscreen(document.documentElement)}else{exitFullscreen()}}};_main.default.prototype.pixelDensity=function(val){_main.default._validateParameters("pixelDensity",arguments);var returnValue;if(typeof val==="number"){if(val!==this._pixelDensity){this._pixelDensity=val}returnValue=this;this.resizeCanvas(this.width,this.height,true)}else{returnValue=this._pixelDensity}return returnValue};_main.default.prototype.displayDensity=function(){return window.devicePixelRatio};function launchFullscreen(element){var enabled=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled;if(!enabled){throw new Error("Fullscreen not enabled in this browser.")}if(element.requestFullscreen){element.requestFullscreen()}else if(element.mozRequestFullScreen){element.mozRequestFullScreen()}else if(element.webkitRequestFullscreen){element.webkitRequestFullscreen()}else if(element.msRequestFullscreen){element.msRequestFullscreen()}}function exitFullscreen(){if(document.exitFullscreen){document.exitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}}_main.default.prototype.getURL=function(){return location.href};_main.default.prototype.getURLPath=function(){return location.pathname.split("/").filter(function(v){return v!==""})};_main.default.prototype.getURLParams=function(){var re=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim;var m;var v={};while((m=re.exec(location.search))!=null){if(m.index===re.lastIndex){re.lastIndex++}v[m[1]]=m[2]}return v};var _default=_main.default;exports.default=_default},{"./constants":286,"./main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.filter":173,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.search":215,"core-js/modules/es.string.split":216,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],288:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var strings={ReferenceError:[{msg:"{{}} is not defined",type:"NOTDEFINED",browser:"all"},{msg:"Can't find variable: {{}}",type:"NOTDEFINED",browser:"Safari"},{msg:"Cannot access '{{.}}' before initialization",type:"CANNOTACCESS",browser:"Chrome"},{msg:"can't access lexical declaration '{{.}}' before initialization",type:"CANNOTACCESS",browser:"Firefox"}],SyntaxError:[{msg:"illegal character",type:"INVALIDTOKEN",browser:"Firefox"},{msg:"Invalid character",type:"INVALIDTOKEN",browser:"Safari"},{msg:"Invalid or unexpected token",type:"INVALIDTOKEN",browser:"Chrome"},{msg:"Unexpected token '{{.}}'",type:"UNEXPECTEDTOKEN",browser:"Chrome"},{msg:"expected {{.}}, got '{{.}}'",type:"UNEXPECTEDTOKEN",browser:"Chrome"},{msg:"Identifier '{{.}}' has already been declared",type:"REDECLAREDVARIABLE",browser:"Chrome"},{msg:"redeclaration of {} {{.}}",type:"REDECLAREDVARIABLE",browser:"Firefox"},{msg:"Missing initializer in const declaration",type:"MISSINGINITIALIZER",browser:"Chrome"},{msg:"missing = in const declaration",type:"MISSINGINITIALIZER",browser:"Firefox"},{msg:"Illegal return statement",type:"BADRETURNORYIELD",browser:"Chrome"},{msg:"return not in function",type:"BADRETURNORYIELD",browser:"Firefox"}],TypeError:[{msg:"{{.}} is not a function",type:"NOTFUNC",browser:"all"},{msg:"Cannot read {{.}} null",type:"READNULL",browser:"Chrome"},{msg:"{{.}} is null",type:"READNULL",browser:"Firefox"},{msg:"Cannot read {{.}} undefined",type:"READUDEFINED",browser:"Chrome"},{msg:"{{.}} is undefined",type:"READUDEFINED",browser:"Firefox"},{msg:"Assignment to constant variable",type:"CONSTASSIGN",browser:"Chrome"},{msg:"invalid assignment to const '{{.}}'",type:"CONSTASSIGN",browser:"Firefox"}]};var _default=strings;exports.default=_default},{}],289:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.get-own-property-names");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.starts-with");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.get-own-property-names");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.starts-with");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../main"));var _internationalization=_dereq_("../internationalization");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||Object.prototype.toString.call(arr)==="[object Arguments]")){return}var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}var typeColors=["#2D7BB6","#EE9900","#4DB200","#C83C00"];var misusedAtTopLevelCode=null;var defineMisusedAtTopLevelCode=null;var EDIT_DIST_THRESHOLD=2;var ENABLE_FES_STYLING=false;if(typeof IS_MINIFIED!=="undefined"){_main.default._friendlyError=_main.default._checkForUserDefinedFunctions=_main.default._fesErrorMonitor=function(){}}else{var doFriendlyWelcome=false;var errorTable=_dereq_("./browser_errors").default;var class2type={};var _toString=class2type.toString;var names=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"];for(var n=0;n<names.length;n++){class2type["[object ".concat(names[n],"]")]=names[n].toLowerCase()}var getType=function getType(obj){if(obj==null){return"".concat(obj)}return _typeof(obj)==="object"||typeof obj==="function"?class2type[_toString.call(obj)]||"object":_typeof(obj)};var entryPoints=["setup","draw","preload","deviceMoved","deviceTurned","deviceShaken","doubleClicked","mousePressed","mouseReleased","mouseMoved","mouseDragged","mouseClicked","mouseWheel","touchStarted","touchMoved","touchEnded","keyPressed","keyReleased","keyTyped","windowResized"];var friendlyWelcome=function friendlyWelcome(){var welcomeMessage=(0,_internationalization.translator)("fes.pre",{message:(0,_internationalization.translator)("fes.welcome")});console.log("    _ \n"+" /\\| |/\\ \n"+" \\ ` ' /  \n"+" / , . \\  \n"+" \\/|_|\\/ "+"\n\n"+welcomeMessage)};var mapToReference=function mapToReference(message,func){var msgWithReference="";if(func==null||func.substring(0,4)==="load"){msgWithReference=message}else{var methodParts=func.split(".");var referenceSection=methodParts.length>1?"".concat(methodParts[0],".").concat(methodParts[1]):"p5";var funcName=methodParts.length===1?func:methodParts.slice(2).join("/");funcName.startsWith("p5.")?msgWithReference="".concat(message," (http://p5js.org/reference/#/").concat(referenceSection,".").concat(funcName,")"):msgWithReference="".concat(message," (http://p5js.org/reference/#/").concat(referenceSection,"/").concat(funcName,")")}return msgWithReference};_main.default._report=function(message,func,color){var log=_main.default._fesLogger==null?console.log.bind(console):_main.default._fesLogger;if(doFriendlyWelcome){friendlyWelcome();doFriendlyWelcome=false}if("undefined"===getType(color)){color="#B40033"}else if(getType(color)==="number"){color=typeColors[color]}message=mapToReference(message,func);var style=["color: ".concat(color),"font-family: Arial","font-size: larger"];var prefixedMsg=(0,_internationalization.translator)("fes.pre",{message:message});if(ENABLE_FES_STYLING){log("%c"+prefixedMsg,style.join(";"))}else{log(prefixedMsg)}};_main.default._friendlyError=function(message,func,color){_main.default._report(message,func,color)};_main.default._friendlyAutoplayError=function(src){var message=(0,_internationalization.translator)("fes.autoplay",{src:src,url:"https://developer.mozilla.org/docs/Web/Media/Autoplay_guide"});console.log((0,_internationalization.translator)("fes.pre",{message:message}))};var computeEditDistance=function computeEditDistance(w1,w2){var l1=w1.length,l2=w2.length;if(l1===0)return w2;if(l2===0)return w1;var prev=[];var cur=[];for(var j=0;j<l2+1;j++){cur[j]=j}prev=cur;for(var i=1;i<l1+1;i++){cur=[];for(var _j=0;_j<l2+1;_j++){if(_j===0){cur[_j]=i}else{var a1=w1[i-1],a2=w2[_j-1];var temp=999999;var cost=a1.toLowerCase()===a2.toLowerCase()?0:1;temp=temp>cost+prev[_j-1]?cost+prev[_j-1]:temp;temp=temp>1+cur[_j-1]?1+cur[_j-1]:temp;temp=temp>1+prev[_j]?1+prev[_j]:temp;cur[_j]=temp}}prev=cur}return cur[l2]};var checkForUserDefinedFunctions=function checkForUserDefinedFunctions(context){if(_main.default.disableFriendlyErrors)return;var instanceMode=context instanceof _main.default;context=instanceMode?context:window;var fnNames=entryPoints;var fxns={};fnNames.forEach(function(symbol){fxns[symbol.toLowerCase()]=symbol});for(var _i=0,_Object$keys=Object.keys(context);_i<_Object$keys.length;_i++){var prop=_Object$keys[_i];var lowercase=prop.toLowerCase();if(fxns[lowercase]&&!context[fxns[lowercase]]&&typeof context[prop]==="function"){var msg=(0,_internationalization.translator)("fes.checkUserDefinedFns",{name:prop,actualName:fxns[lowercase]});_main.default._friendlyError(msg,fxns[lowercase])}}};var handleMisspelling=function handleMisspelling(errSym,error){if(!misusedAtTopLevelCode){defineMisusedAtTopLevelCode()}var distanceMap={};var min=999999;misusedAtTopLevelCode.forEach(function(symbol){var dist=computeEditDistance(errSym,symbol.name);if(distanceMap[dist])distanceMap[dist].push(symbol);else distanceMap[dist]=[symbol];if(dist<min)min=dist});if(min>Math.min(EDIT_DIST_THRESHOLD,errSym.length))return false;var matchedSymbols=distanceMap[min].filter(function(symbol){return symbol.name!==errSym});if(matchedSymbols.length!==0){var parsed=_main.default._getErrorStackParser().parse(error);var locationObj;if(parsed&&parsed[0]&&parsed[0].fileName&&parsed[0].lineNumber&&parsed[0].columnNumber){locationObj={location:"".concat(parsed[0].fileName,":").concat(parsed[0].lineNumber,":").concat(parsed[0].columnNumber),file:parsed[0].fileName.split("/").slice(-1),line:parsed[0].lineNumber}}var msg;if(matchedSymbols.length===1){msg=(0,_internationalization.translator)("fes.misspelling",{name:errSym,actualName:matchedSymbols[0].name,type:matchedSymbols[0].type,location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):"",count:matchedSymbols.length})}else{var suggestions=matchedSymbols.map(function(symbol){var message="▶️ "+symbol.name+(symbol.type==="function"?"()":"");return mapToReference(message,symbol.name)}).join("\n");msg=(0,_internationalization.translator)("fes.misspelling",{name:errSym,suggestions:suggestions,location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):"",count:matchedSymbols.length})}_main.default._friendlyError(msg,matchedSymbols.length===1?matchedSymbols[0].name:undefined);return true}return false};var printFriendlyStack=function printFriendlyStack(friendlyStack){var log=_main.default._fesLogger&&typeof _main.default._fesLogger==="function"?_main.default._fesLogger:console.log.bind(console);if(friendlyStack.length>1){var stacktraceMsg="";friendlyStack.forEach(function(frame,idx){var location="".concat(frame.fileName,":").concat(frame.lineNumber,":").concat(frame.columnNumber);var frameMsg,translationObj={func:frame.functionName,line:frame.lineNumber,location:location,file:frame.fileName.split("/").slice(-1)};if(idx===0){frameMsg=(0,_internationalization.translator)("fes.globalErrors.stackTop",translationObj)}else{frameMsg=(0,_internationalization.translator)("fes.globalErrors.stackSubseq",translationObj)}stacktraceMsg+=frameMsg});log(stacktraceMsg)}};var processStack=function processStack(error,stacktrace){if(!stacktrace)return[false,null];stacktrace.forEach(function(frame){frame.functionName=frame.functionName||""});var isInternal=false;var p5FileName,friendlyStack,currentEntryPoint;try{throw new Error}catch(testError){var testStacktrace=_main.default._getErrorStackParser().parse(testError);p5FileName=testStacktrace[0].fileName}for(var i=stacktrace.length-1;i>=0;i--){var splitted=stacktrace[i].functionName.split(".");if(entryPoints.includes(splitted[splitted.length-1])){friendlyStack=stacktrace.slice(0,i+1);currentEntryPoint=splitted[splitted.length-1];if(stacktrace[0].fileName===p5FileName){isInternal=true;break}break}}if(!friendlyStack)friendlyStack=stacktrace;if(isInternal){friendlyStack=friendlyStack.map(function(frame,index){frame.frameIndex=index;return frame}).filter(function(frame){return frame.fileName!==p5FileName});if(friendlyStack.length===0)return[true,null];var func=stacktrace[friendlyStack[0].frameIndex-1].functionName.split(".").slice(-1)[0];var locationObj;if(friendlyStack[0].fileName&&friendlyStack[0].lineNumber&&friendlyStack[0].columnNumber){locationObj={location:"".concat(friendlyStack[0].fileName,":").concat(friendlyStack[0].lineNumber,":").concat(friendlyStack[0].columnNumber),file:friendlyStack[0].fileName.split("/").slice(-1),line:friendlyStack[0].lineNumber};if(_main.default._fesLogCache[locationObj.location])return[true,null]}if(currentEntryPoint==="preload"&&_main.default.prototype._preloadMethods[func]==null){_main.default._friendlyError((0,_internationalization.translator)("fes.wrongPreload",{func:func,location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):"",error:error.message}),"preload")}else{_main.default._friendlyError((0,_internationalization.translator)("fes.libraryError",{func:func,location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):"",error:error.message}),func)}if(friendlyStack&&friendlyStack.length){printFriendlyStack(friendlyStack)}}return[isInternal,friendlyStack]};var fesErrorMonitor=function fesErrorMonitor(e){if(_main.default.disableFriendlyErrors)return;var error;if(e instanceof Error){error=e}else if(e instanceof ErrorEvent){error=e.error}else if(e instanceof PromiseRejectionEvent){error=e.reason;if(!(error instanceof Error))return}if(!error)return;var stacktrace=_main.default._getErrorStackParser().parse(error);var _processStack=processStack(error,stacktrace),_processStack2=_slicedToArray(_processStack,2),isInternal=_processStack2[0],friendlyStack=_processStack2[1];if(isInternal){return}var errList=errorTable[error.name];if(!errList)return;var matchedError;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=errList[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var obj=_step.value;var string=obj.msg;string=string.replace(new RegExp("{{}}","g"),"([a-zA-Z0-9_]+)");string=string.replace(new RegExp("{{.}}","g"),"(.+)");string=string.replace(new RegExp("{}","g"),"(?:[a-zA-Z0-9_]+)");var matched=error.message.match(string);if(matched){matchedError=Object.assign({},obj);matchedError.match=matched;break}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}if(!matchedError)return;var locationObj;if(stacktrace&&stacktrace[0].fileName&&stacktrace[0].lineNumber&&stacktrace[0].columnNumber){locationObj={location:"".concat(stacktrace[0].fileName,":").concat(stacktrace[0].lineNumber,":").concat(stacktrace[0].columnNumber),file:stacktrace[0].fileName.split("/").slice(-1),line:friendlyStack[0].lineNumber}}switch(error.name){case"SyntaxError":{switch(matchedError.type){case"INVALIDTOKEN":{var url="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Illegal_character#What_went_wrong";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.syntax.invalidToken",{url:url}));break}case"UNEXPECTEDTOKEN":{var _url="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Unexpected_token#What_went_wrong";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.syntax.unexpectedToken",{url:_url}));break}case"REDECLAREDVARIABLE":{var errSym=matchedError.match[1];var _url2="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Redeclared_parameter#what_went_wrong";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.syntax.redeclaredVariable",{symbol:errSym,url:_url2}));break}case"MISSINGINITIALIZER":{var _url3="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Missing_initializer_in_const#what_went_wrong";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.syntax.missingInitializer",{url:_url3}));break}case"BADRETURNORYIELD":{var _url4="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Bad_return_or_yield#what_went_wrong";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.syntax.badReturnOrYield",{url:_url4}));break}}break}case"ReferenceError":{switch(matchedError.type){case"NOTDEFINED":{var _errSym=matchedError.match[1];if(_errSym&&handleMisspelling(_errSym,error)){break}var _url5="https://p5js.org/examples/data-variable-scope.html";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.reference.notDefined",{url:_url5,symbol:_errSym,location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):""}));if(friendlyStack)printFriendlyStack(friendlyStack);break}case"CANNOTACCESS":{var _errSym2=matchedError.match[1];var _url6="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_lexical_declaration_before_init#what_went_wrong";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.reference.cannotAccess",{url:_url6,symbol:_errSym2,location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):""}));if(friendlyStack)printFriendlyStack(friendlyStack);break}}break}case"TypeError":{switch(matchedError.type){case"NOTFUNC":{var _errSym3=matchedError.match[1];var splitSym=_errSym3.split(".");var _url7="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Errors/Not_a_function#What_went_wrong";var translationObj={url:_url7,symbol:splitSym[splitSym.length-1],obj:splitSym.slice(0,splitSym.length-1).join("."),location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):""};if(splitSym.length>1){_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.type.notfuncObj",translationObj))}else{_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.type.notfunc",translationObj))}if(friendlyStack)printFriendlyStack(friendlyStack);break}case"READNULL":{var _errSym4=matchedError.match[1];var _url8="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_property#what_went_wrong";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.type.readFromNull",{url:_url8,symbol:_errSym4,location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):""}));if(friendlyStack)printFriendlyStack(friendlyStack);break}case"READUDEFINED":{var _errSym5=matchedError.match[1];var _url9="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Cant_access_property#what_went_wrong";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.type.readFromUndefined",{url:_url9,symbol:_errSym5,location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):""}));if(friendlyStack)printFriendlyStack(friendlyStack);break}case"CONSTASSIGN":{var _url10="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Invalid_const_assignment#what_went_wrong";_main.default._friendlyError((0,_internationalization.translator)("fes.globalErrors.type.constAssign",{url:_url10,location:locationObj?(0,_internationalization.translator)("fes.location",locationObj):""}));if(friendlyStack)printFriendlyStack(friendlyStack);break}}}}};_main.default._fesErrorMonitor=fesErrorMonitor;_main.default._checkForUserDefinedFunctions=checkForUserDefinedFunctions;_main.default._fesLogger=null;_main.default._fesLogCache={};window.addEventListener("load",checkForUserDefinedFunctions,false);window.addEventListener("error",_main.default._fesErrorMonitor,false);window.addEventListener("unhandledrejection",_main.default._fesErrorMonitor,false)}misusedAtTopLevelCode=null;var FAQ_URL="https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup";defineMisusedAtTopLevelCode=function defineMisusedAtTopLevelCode(){var uniqueNamesFound={};var getSymbols=function getSymbols(obj){return Object.getOwnPropertyNames(obj).filter(function(name){if(name[0]==="_"){return false}if(name in uniqueNamesFound){return false}uniqueNamesFound[name]=true;return true}).map(function(name){var type;if(typeof obj[name]==="function"){type="function"}else if(name===name.toUpperCase()){type="constant"}else{type="variable"}return{name:name,type:type}})};misusedAtTopLevelCode=[].concat(getSymbols(_main.default.prototype),getSymbols(_dereq_("../constants")));misusedAtTopLevelCode.sort(function(a,b){return b.name.length-a.name.length})};var helpForMisusedAtTopLevelCode=function helpForMisusedAtTopLevelCode(e,log){if(!log){log=console.log.bind(console)}if(!misusedAtTopLevelCode){defineMisusedAtTopLevelCode()}misusedAtTopLevelCode.some(function(symbol){if(e.message&&e.message.match("\\W?".concat(symbol.name,"\\W"))!==null){var symbolName=symbol.type==="function"?"".concat(symbol.name,"()"):symbol.name;if(typeof IS_MINIFIED!=="undefined"){log("Did you just try to use p5.js's ".concat(symbolName," ").concat(symbol.type,"? If so, you may want to move it into your sketch's setup() function.\n\nFor more details, see: ").concat(FAQ_URL))}else{log((0,_internationalization.translator)("fes.misusedTopLevel",{symbolName:symbolName,symbolType:symbol.type,url:FAQ_URL}))}return true}})};_main.default.prototype._helpForMisusedAtTopLevelCode=helpForMisusedAtTopLevelCode;if(document.readyState!=="complete"){window.addEventListener("error",helpForMisusedAtTopLevelCode,false);window.addEventListener("load",function(){window.removeEventListener("error",helpForMisusedAtTopLevelCode,false)})}var _default=_main.default;exports.default=_default},{"../constants":286,"../internationalization":296,"../main":298,"./browser_errors":288,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.filter":173,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.join":180,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.some":184,"core-js/modules/es.function.name":186,"core-js/modules/es.object.assign":194,"core-js/modules/es.object.get-own-property-names":197,"core-js/modules/es.object.keys":199,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.constructor":204,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.match":211,"core-js/modules/es.string.replace":214,"core-js/modules/es.string.split":216,"core-js/modules/es.string.starts-with":217,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.for-each":255,"core-js/modules/web.dom-collections.iterator":256}],290:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../main"));var _internationalization=_dereq_("../internationalization");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}if(typeof IS_MINIFIED!=="undefined"){_main.default._friendlyFileLoadError=function(){}}else{var fileLoadErrorCases=function fileLoadErrorCases(num,filePath){var suggestion=(0,_internationalization.translator)("fes.fileLoadError.suggestion",{filePath:filePath,url:"https://github.com/processing/p5.js/wiki/Local-server"});switch(num){case 0:return{message:(0,_internationalization.translator)("fes.fileLoadError.image",{suggestion:suggestion}),method:"loadImage"};case 1:return{message:(0,_internationalization.translator)("fes.fileLoadError.xml",{suggestion:suggestion}),method:"loadXML"};case 2:return{message:(0,_internationalization.translator)("fes.fileLoadError.table",{suggestion:suggestion}),method:"loadTable"};case 3:return{message:(0,_internationalization.translator)("fes.fileLoadError.strings",{suggestion:suggestion}),method:"loadStrings"};case 4:return{message:(0,_internationalization.translator)("fes.fileLoadError.font",{suggestion:suggestion}),method:"loadFont"};case 5:return{message:(0,_internationalization.translator)("fes.fileLoadError.json",{suggestion:suggestion}),method:"loadJSON"};case 6:return{message:(0,_internationalization.translator)("fes.fileLoadError.bytes",{suggestion:suggestion}),method:"loadBytes"};case 7:return{message:(0,_internationalization.translator)("fes.fileLoadError.large"),method:"loadX"};case 8:return{message:(0,_internationalization.translator)("fes.fileLoadError.gif"),method:"loadImage"}}};_main.default._friendlyFileLoadError=function(errorType,filePath){var _fileLoadErrorCases=fileLoadErrorCases(errorType,filePath),message=_fileLoadErrorCases.message,method=_fileLoadErrorCases.method;_main.default._friendlyError(message,method,3)}}var _default=_main.default;exports.default=_default},{"../internationalization":296,"../main":298}],291:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");_dereq_("core-js/modules/web.dom-collections.for-each");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../main"));var _internationalization=_dereq_("../internationalization");var constants=_interopRequireWildcard(_dereq_("../constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}if(typeof IS_MINIFIED!=="undefined"){_main.default._fesCodeReader=function(){}}else{var ignoreFunction=["setup","draw","preload","deviceMoved","deviceTurned","deviceShaken","doubleClicked","mousePressed","mouseReleased","mouseMoved","mouseDragged","mouseClicked","mouseWheel","touchStarted","touchMoved","touchEnded","keyPressed","keyReleased","keyTyped","windowResized","name","parent","toString","print","stop","onended"];var checkForConstsAndFuncs=function checkForConstsAndFuncs(variableArray){for(var i=0;i<variableArray.length;i++){if(constants[variableArray[i]]!==undefined){var url="https://p5js.org/reference/#/p5/".concat(variableArray[i]);_main.default._friendlyError((0,_internationalization.translator)("fes.sketchReaderErrors.reservedConst",{url:url,symbol:variableArray[i]}));return}}var p5Constructors={};for(var _i=0,_Object$keys=Object.keys(_main.default);_i<_Object$keys.length;_i++){var key=_Object$keys[_i];if(typeof _main.default[key]==="function"&&key[0]!==key[0].toLowerCase()){p5Constructors[key]=_main.default[key]}}for(var _i2=0;_i2<variableArray.length;_i2++){if(!ignoreFunction.includes(variableArray[_i2])){var keyArray=Object.keys(p5Constructors);var j=0;for(;j<keyArray.length;j++){if(p5Constructors[keyArray[j]].prototype[variableArray[_i2]]!==undefined){var _url="https://p5js.org/reference/#/p5/".concat(variableArray[_i2]);_main.default._friendlyError((0,_internationalization.translator)("fes.sketchReaderErrors.reservedFunc",{url:_url,symbol:variableArray[_i2]}));return}}}}};var optionalVarKeyword=/(?:(?:let|const|var)\s+)?/;var roundBracketedExpr=/(?:\([^)]*\))/;var squareBracketedExpr=/(?:\[[^\]]*\])/;var curlyBracketedExpr=/(?:\{[^}]*\})/;var bracketedExpr=new RegExp([roundBracketedExpr,squareBracketedExpr,curlyBracketedExpr].map(function(regex){return regex.source}).join("|"));var rightHandSide=new RegExp("(?:"+bracketedExpr.source+"|[^\\n,])+");var leftHandSide=/([\w$]+)/;var assignmentOperator=/\s*=\s*/;var singleAssignment=new RegExp(leftHandSide.source+assignmentOperator.source+rightHandSide.source);var listSeparator=/,\s*/;var oneOrMoreAssignments=new RegExp("(?:"+singleAssignment.source+listSeparator.source+")*"+singleAssignment.source);var assignmentStatement=new RegExp("^"+optionalVarKeyword.source+oneOrMoreAssignments.source);var letConstName=/(?:(?:let|const)\s+)([\w$]+)/;var extractVariables=function extractVariables(linesArray){var matches=[];linesArray.forEach(function(ele){var match=ele.match(assignmentStatement);if(!match)return;matches.push.apply(matches,_toConsumableArray(match.slice(1).filter(function(group){return group!==undefined})))});checkForConstsAndFuncs(matches)};var extractFuncVariables=function extractFuncVariables(linesArray){var matches=[];linesArray.forEach(function(ele){var m=ele.match(letConstName);if(m!==null)matches.push(ele.match(letConstName)[1])});checkForConstsAndFuncs(matches)};var codeToLines=function codeToLines(code){var arrayVariables=code.split("\n").map(function(line){return line.trim()}).filter(function(line){return line!==""&&!line.includes("//")&&(line.includes("let")||line.includes("const"))&&!line.includes("=>")&&!line.includes("function")});var arrayFunctions=code.split("\n").map(function(line){return line.trim()}).filter(function(line){return line!==""&&!line.includes("//")&&(line.includes("let")||line.includes("const"))&&(line.includes("=>")||line.includes("function"))});extractVariables(arrayVariables);extractFuncVariables(arrayFunctions)};var removeMultilineComments=function removeMultilineComments(code){var start=code.indexOf("/*");var end=code.indexOf("*/");while(start!==-1&&end!==-1){if(start===0){code=code.slice(end+2)}else code=code.slice(0,start)+code.slice(end+2);start=code.indexOf("/*");end=code.indexOf("*/")}return code};var globalConstFuncCheck=function globalConstFuncCheck(){var tempArray=Object.keys(constants);var element;for(var i=0;i<tempArray.length;i++){try{element=eval(tempArray[i])}catch(e){continue}if(constants[tempArray[i]]!==element){var url="https://p5js.org/reference/#/p5/".concat(tempArray[i]);_main.default._friendlyError((0,_internationalization.translator)("fes.sketchReaderErrors.reservedConst",{url:url,symbol:tempArray[i]}));return true}}var p5Constructors={};for(var _i3=0,_Object$keys2=Object.keys(_main.default);_i3<_Object$keys2.length;_i3++){var key=_Object$keys2[_i3];if(typeof _main.default[key]==="function"&&key[0]!==key[0].toLowerCase()){p5Constructors[key]=_main.default[key]}}var keyArray=Object.keys(p5Constructors);var classesWithGlobalFns=["Renderer","Renderer2D","RendererGL"];var functionArray=[];for(var _i4=0;_i4<classesWithGlobalFns.length;_i4++){functionArray.push.apply(functionArray,_toConsumableArray(Object.keys(p5Constructors[classesWithGlobalFns[_i4]].prototype)))}for(var _i5=0;_i5<functionArray.length;_i5++){if(!ignoreFunction.includes(functionArray[_i5])){try{element=eval(functionArray[_i5])}catch(e){continue}for(var k=0;k<keyArray.length;k++){if(p5Constructors[keyArray[k]].prototype[functionArray[_i5]]===undefined);else{if(p5Constructors[keyArray[k]].prototype[functionArray[_i5]]!==element){var _url2="https://p5js.org/reference/#/p5/".concat(functionArray[_i5]);_main.default._friendlyError((0,_internationalization.translator)("fes.sketchReaderErrors.reservedFunc",{url:_url2,symbol:functionArray[_i5]}));return true}}}}}};var fesCodeReader=function fesCodeReader(){var moveAhead=globalConstFuncCheck();if(moveAhead)return;var code="";try{code+=""+setup}catch(e){code+=""}try{code+="\n"+draw}catch(e){code+=""}if(code==="")return;code=removeMultilineComments(code);codeToLines(code)};_main.default._fesCodeReader=fesCodeReader;window.addEventListener("load",_main.default._fesCodeReader)}var _default=_main.default;exports.default=_default},{"../constants":286,"../internationalization":296,"../main":298,"core-js/modules/es.array.filter":173,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.from":176,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.join":180,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.keys":199,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.constructor":204,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.match":211,"core-js/modules/es.string.split":216,"core-js/modules/es.string.trim":219,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.for-each":255,"core-js/modules/web.dom-collections.iterator":256}],292:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ErrorStackParser(){var FIREFOX_SAFARI_STACK_REGEXP=/(^|@)\S+:\d+/;var CHROME_IE_STACK_REGEXP=/^\s*at .*(\S+:\d+|\(native\))/m;var SAFARI_NATIVE_CODE_REGEXP=/^(eval@)?(\[native code])?$/;return{parse:function ErrorStackParser$$parse(error){if(typeof error.stacktrace!=="undefined"||typeof error["opera#sourceloc"]!=="undefined"){return this.parseOpera(error)}else if(error.stack&&error.stack.match(CHROME_IE_STACK_REGEXP)){return this.parseV8OrIE(error)}else if(error.stack){return this.parseFFOrSafari(error)}else{}},extractLocation:function ErrorStackParser$$extractLocation(urlLike){if(urlLike.indexOf(":")===-1){return[urlLike]}var regExp=/(.+?)(?::(\d+))?(?::(\d+))?$/;var parts=regExp.exec(urlLike.replace(/[()]/g,""));return[parts[1],parts[2]||undefined,parts[3]||undefined]},parseV8OrIE:function ErrorStackParser$$parseV8OrIE(error){var filtered=error.stack.split("\n").filter(function(line){return!!line.match(CHROME_IE_STACK_REGEXP)},this);return filtered.map(function(line){if(line.indexOf("(eval ")>-1){line=line.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,"")}var sanitizedLine=line.replace(/^\s+/,"").replace(/\(eval code/g,"(");var location=sanitizedLine.match(/ (\((.+):(\d+):(\d+)\)$)/);sanitizedLine=location?sanitizedLine.replace(location[0],""):sanitizedLine;var tokens=sanitizedLine.split(/\s+/).slice(1);var locationParts=this.extractLocation(location?location[1]:tokens.pop());var functionName=tokens.join(" ")||undefined;var fileName=["eval","<anonymous>"].indexOf(locationParts[0])>-1?undefined:locationParts[0];return{functionName:functionName,fileName:fileName,lineNumber:locationParts[1],columnNumber:locationParts[2],source:line}},this)},parseFFOrSafari:function ErrorStackParser$$parseFFOrSafari(error){var filtered=error.stack.split("\n").filter(function(line){return!line.match(SAFARI_NATIVE_CODE_REGEXP)},this);return filtered.map(function(line){if(line.indexOf(" > eval")>-1){line=line.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")}if(line.indexOf("@")===-1&&line.indexOf(":")===-1){return{functionName:line}}else{var functionNameRegex=/((.*".+"[^@]*)?[^@]*)(?:@)/;var matches=line.match(functionNameRegex);var functionName=matches&&matches[1]?matches[1]:undefined;var locationParts=this.extractLocation(line.replace(functionNameRegex,""));return{functionName:functionName,fileName:locationParts[0],lineNumber:locationParts[1],columnNumber:locationParts[2],source:line}}},this)},parseOpera:function ErrorStackParser$$parseOpera(e){if(!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length){return this.parseOpera9(e)}else if(!e.stack){return this.parseOpera10(e)}else{return this.parseOpera11(e)}},parseOpera9:function ErrorStackParser$$parseOpera9(e){var lineRE=/Line (\d+).*script (?:in )?(\S+)/i;var lines=e.message.split("\n");var result=[];for(var i=2,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push({fileName:match[2],lineNumber:match[1],source:lines[i]})}}return result},parseOpera10:function ErrorStackParser$$parseOpera10(e){var lineRE=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var lines=e.stacktrace.split("\n");var result=[];for(var i=0,len=lines.length;i<len;i+=2){var match=lineRE.exec(lines[i]);if(match){result.push({functionName:match[3]||undefined,fileName:match[2],lineNumber:match[1],source:lines[i]})}}return result},parseOpera11:function ErrorStackParser$$parseOpera11(error){var filtered=error.stack.split("\n").filter(function(line){return!!line.match(FIREFOX_SAFARI_STACK_REGEXP)&&!line.match(/^Error created at/)},this);return filtered.map(function(line){var tokens=line.split("@");var locationParts=this.extractLocation(tokens.pop());var functionCall=tokens.shift()||"";var functionName=functionCall.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||undefined;var argsRaw;if(functionCall.match(/\(([^)]*)\)/)){argsRaw=functionCall.replace(/^[^(]+\(([^)]*)\)$/,"$1")}var args=argsRaw===undefined||argsRaw==="[arguments not available]"?undefined:argsRaw.split(",");return{functionName:functionName,args:args,fileName:locationParts[0],lineNumber:locationParts[1],columnNumber:locationParts[2],source:line}},this)}}}_main.default._getErrorStackParser=function getErrorStackParser(){return new ErrorStackParser};var _default=_main.default;exports.default=_default},{"../main":298,"core-js/modules/es.array.filter":173,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.join":180,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.match":211,"core-js/modules/es.string.replace":214,"core-js/modules/es.string.split":216}],293:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.last-index-of");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.map");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.set");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.last-index-of");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.set");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../main"));var constants=_interopRequireWildcard(_dereq_("../constants"));var _internationalization=_dereq_("../internationalization");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _createSuper(Derived){function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var Super=_getPrototypeOf(Derived),result;if(isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map:undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf(Wrapper,Class)};return _wrapNativeSuper(Class)}function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function _construct(Parent,args,Class){if(isNativeReflectConstruct()){_construct=Reflect.construct}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _isNativeFunction(fn){return Function.toString.call(fn).indexOf("[native code]")!==-1}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}if(typeof IS_MINIFIED!=="undefined"){_main.default._validateParameters=_main.default._clearValidateParamsCache=function(){}}else{var dataDoc=_dereq_("../../../docs/parameterData.json");var arrDoc=JSON.parse(JSON.stringify(dataDoc));var docCache={};var builtinTypes=new Set(["null","number","string","boolean","constant","function","any","integer"]);var basicTypes={number:true,boolean:true,string:true,function:true,undefined:true};var constantsReverseMap={};for(var key in constants){constantsReverseMap[constants[key]]=key}var p5Constructors={};var funcSpecificConstructors={};window.addEventListener("load",function(){for(var _i=0,_Object$keys=Object.keys(_main.default);_i<_Object$keys.length;_i++){var _key=_Object$keys[_i];if(typeof _main.default[_key]==="function"&&_key[0]!==_key[0].toLowerCase()){p5Constructors[_key]=_main.default[_key]}}});var argumentTree={};var addType=function addType(value,obj,func){var type=_typeof(value);if(basicTypes[type]){if(constantsReverseMap[value]){obj=obj[value]||(obj[value]={})}else{obj=obj[type]||(obj[type]={})}}else if(value===null){obj=obj["null"]||(obj["null"]={})}else{if(value.constructor&&value.constructor.name){obj=obj[value.constructor.name]||(obj[value.constructor.name]={});return obj}var p5C=funcSpecificConstructors[func];if(p5C===undefined){p5C=funcSpecificConstructors[func]={}}for(var _key2 in p5C){if(value instanceof p5C[_key2]){obj=obj[_key2]||(obj[_key2]={});return obj}}for(var _key3 in p5Constructors){if(value instanceof p5Constructors[_key3]){obj=obj[_key3]||(obj[_key3]={});p5C[_key3]=p5Constructors[_key3];return obj}}obj=obj[type]||(obj[type]={})}return obj};var buildArgTypeCache=function buildArgTypeCache(func,arr){var obj=argumentTree[func];if(obj===undefined){obj=argumentTree[func]={}}for(var i=0,len=arr.length;i<len;++i){var value=arr[i];if(value instanceof Array){obj=obj["as"]||(obj["as"]={});for(var j=0,lenA=value.length;j<lenA;++j){obj=addType(value[j],obj,func)}}else{obj=addType(value,obj,func)}}return obj};var lookupParamDoc=function lookupParamDoc(func){var ichDot=func.lastIndexOf(".");var funcName=func.slice(ichDot+1);var funcClass=func.slice(0,ichDot!==-1?ichDot:0)||"p5";var classitems=arrDoc;var queryResult=classitems[funcClass][funcName];var overloads=[];if(queryResult.hasOwnProperty("overloads")){for(var i=0;i<queryResult.overloads.length;i++){overloads.push({formats:queryResult.overloads[i].params})}}else{overloads.push({formats:queryResult.params||[]})}var mapConstants={};var maxParams=0;overloads.forEach(function(overload){var formats=overload.formats;if(maxParams<formats.length){maxParams=formats.length}var minParams=formats.length;while(minParams>0&&formats[minParams-1].optional){minParams--}overload.minParams=minParams;formats.forEach(function(format){format.types=format.type.split("|").map(function ct(type){if(type.slice(-2)==="[]"){return{name:type,array:ct(type.slice(0,-2))}}var lowerType=type.toLowerCase();if(lowerType==="constant"){var constant;if(mapConstants.hasOwnProperty(format.name)){constant=mapConstants[format.name]}else{var myRe=/either\s+(?:[A-Z0-9_]+\s*,?\s*(?:or)?\s*)+/g;var values={};var names=[];constant=mapConstants[format.name]={values:values,names:names};var myArray=myRe.exec(format.description);if(func==="endShape"&&format.name==="mode"){values[constants.CLOSE]=true;names.push("CLOSE")}else{var match=myArray[0];var reConst=/[A-Z0-9_]+/g;var matchConst;while((matchConst=reConst.exec(match))!==null){var name=matchConst[0];if(constants.hasOwnProperty(name)){values[constants[name]]=true;names.push(name)}}}}return{name:type,builtin:lowerType,names:constant.names,values:constant.values}}if(lowerType.slice(0,"function".length)==="function"){lowerType="function"}if(builtinTypes.has(lowerType)){return{name:type,builtin:lowerType}}var t=window;var typeParts=type.split(".");if(typeParts[0]==="p5"){t=_main.default;typeParts.shift()}typeParts.forEach(function(p){t=t&&t[p]});if(t){return{name:type,prototype:t}}return{name:type,type:lowerType}})})});return{overloads:overloads,maxParams:maxParams}};var isNumber=function isNumber(param){if(isNaN(parseFloat(param)))return false;switch(_typeof(param)){case"number":return true;case"string":return!isNaN(param);default:return false}};var testParamType=function testParamType(param,type){var isArray=param instanceof Array;var matches=true;if(type.array&&isArray){for(var i=0;i<param.length;i++){var error=testParamType(param[i],type.array);if(error)return error/2}}else if(type.prototype){matches=param instanceof type.prototype}else if(type.builtin){switch(type.builtin){case"number":matches=isNumber(param);break;case"integer":matches=isNumber(param)&&Number(param)===Math.floor(param);break;case"boolean":case"any":matches=true;break;case"array":matches=isArray;break;case"string":matches=typeof param==="string";break;case"constant":matches=type.values.hasOwnProperty(param);break;case"function":matches=param instanceof Function;break;case"null":matches=param===null;break}}else{matches=_typeof(param)===type.t}return matches?0:1};var testParamTypes=function testParamTypes(param,types){var minScore=9999;for(var i=0;minScore>0&&i<types.length;i++){var score=testParamType(param,types[i]);if(minScore>score)minScore=score}return minScore};var scoreOverload=function scoreOverload(args,argCount,overload,minScore){var score=0;var formats=overload.formats;var minParams=overload.minParams;if(argCount<minParams){score=(minParams-argCount)*2}else if(argCount>formats.length){score=(argCount-formats.length)*2}for(var p=0;score<=minScore&&p<formats.length;p++){var arg=args[p];var format=formats[p];if(arg==null){if(!format.optional||p<minParams||p<argCount){score+=1}}else{score+=testParamTypes(arg,format.types)}}return score};var getOverloadErrors=function getOverloadErrors(args,argCount,overload){var formats=overload.formats;var minParams=overload.minParams;if(argCount<minParams){return[{type:"TOO_FEW_ARGUMENTS",argCount:argCount,minParams:minParams}]}else if(argCount>formats.length){return[{type:"TOO_MANY_ARGUMENTS",argCount:argCount,maxParams:formats.length}]}var errorArray=[];for(var p=0;p<formats.length;p++){var arg=args[p];var format=formats[p];if(arg==null){if(!format.optional||p<minParams||p<argCount){errorArray.push({type:"EMPTY_VAR",position:p,format:format})}}else if(testParamTypes(arg,format.types)>0){errorArray.push({type:"WRONG_TYPE",position:p,format:format,arg:arg})}}return errorArray};_main.default.ValidationError=function(name){var err=function(_Error){_inherits(err,_Error);var _super=_createSuper(err);function err(message,func,type){var _this;_classCallCheck(this,err);_this=_super.call(this);_this.message=message;_this.func=func;_this.type=type;if("captureStackTrace"in Error)Error.captureStackTrace(_assertThisInitialized(_this),err);else _this.stack=(new Error).stack;return _this}return err}(_wrapNativeSuper(Error));err.prototype.name=name;return err}("ValidationError");_main.default._friendlyParamError=function(errorObj,func){var message;var translationObj;function formatType(){var format=errorObj.format;return format.types.map(function(type){return type.names?type.names.join("|"):type.name}).join("|")}switch(errorObj.type){case"EMPTY_VAR":{translationObj={func:func,formatType:formatType(),position:(0,_internationalization.translator)("fes.positions.p",{context:(errorObj.position+1).toString(),defaultValue:(errorObj.position+1).toString()}),url:"https://p5js.org/examples/data-variable-scope.html"};break}case"WRONG_TYPE":{var arg=errorObj.arg;var argType=arg instanceof Array?"array":arg===null?"null":arg===undefined?"undefined":typeof arg==="number"&&isNaN(arg)?"NaN":arg.name||_typeof(arg);translationObj={func:func,formatType:formatType(),argType:argType,position:(0,_internationalization.translator)("fes.positions.p",{context:(errorObj.position+1).toString(),defaultValue:(errorObj.position+1).toString()})};break}case"TOO_FEW_ARGUMENTS":{translationObj={func:func,minParams:errorObj.minParams,argCount:errorObj.argCount};break}case"TOO_MANY_ARGUMENTS":{translationObj={func:func,maxParams:errorObj.maxParams,argCount:errorObj.argCount};break}}if(translationObj){try{var myError=new Error;var parsed=_main.default._getErrorStackParser().parse(myError);if(parsed[3]&&parsed[3].functionName&&parsed[3].functionName.includes(".")&&_main.default.prototype[parsed[3].functionName.split(".").slice(-1)[0]]){return}if(_main.default._throwValidationErrors){throw new _main.default.ValidationError(message,func,errorObj.type)}if(parsed[3]&&parsed[3].fileName&&parsed[3].lineNumber&&parsed[3].columnNumber){var location="".concat(parsed[3].fileName,":").concat(parsed[3].lineNumber,":").concat(parsed[3].columnNumber);translationObj.location=(0,_internationalization.translator)("fes.location",{location:location,file:parsed[3].fileName.split("/").slice(-1),line:parsed[3].lineNumber});_main.default._fesLogCache[location]=true}}catch(err){if(err instanceof _main.default.ValidationError){throw err}}translationObj.context=errorObj.type;message=(0,_internationalization.translator)("fes.friendlyParamError.type",translationObj);_main.default._friendlyError("".concat(message),func,3)}};_main.default._clearValidateParamsCache=function clearValidateParamsCache(){for(var _i2=0,_Object$keys2=Object.keys(argumentTree);_i2<_Object$keys2.length;_i2++){var _key4=_Object$keys2[_i2];delete argumentTree[_key4]}};_main.default._getValidateParamsArgTree=function getValidateParamsArgTree(){return argumentTree};_main.default._validateParameters=function validateParameters(func,args){if(_main.default.disableFriendlyErrors){return}var obj=buildArgTypeCache(func,args);if(obj.seen){return}obj.seen=true;var docs=docCache[func]||(docCache[func]=lookupParamDoc(func));var overloads=docs.overloads;var argCount=args.length;var minScore=99999;var minOverload;for(var i=0;i<overloads.length;i++){var score=scoreOverload(args,argCount,overloads[i],minScore);if(score===0){return}else if(minScore>score){minScore=score;minOverload=i}}if(minScore>0){var errorArray=getOverloadErrors(args,argCount,overloads[minOverload]);for(var n=0;n<errorArray.length;n++){_main.default._friendlyParamError(errorArray[n],func)}}};_main.default.prototype._validateParameters=_main.default.validateParameters}var _default=_main.default;exports.default=_default},{"../../../docs/parameterData.json":1,"../constants":286,"../internationalization":296,"../main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.join":180,"core-js/modules/es.array.last-index-of":181,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.function.name":186,"core-js/modules/es.map":187,"core-js/modules/es.number.constructor":191,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.keys":199,"core-js/modules/es.object.to-string":200,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.set":207,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.split":216,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.for-each":255,"core-js/modules/web.dom-collections.iterator":256}],294:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var constants=_interopRequireWildcard(_dereq_("./constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function modeAdjust(a,b,c,d,mode){if(mode===constants.CORNER){return{x:a,y:b,w:c,h:d}}else if(mode===constants.CORNERS){return{x:a,y:b,w:c-a,h:d-b}}else if(mode===constants.RADIUS){return{x:a-c,y:b-d,w:2*c,h:2*d}}else if(mode===constants.CENTER){return{x:a-c*.5,y:b-d*.5,w:c,h:d}}}var _default={modeAdjust:modeAdjust};exports.default=_default},{"./constants":286,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],295:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");var _main=_interopRequireDefault(_dereq_("../core/main"));var _internationalization=_dereq_("./internationalization");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _globalInit=function _globalInit(){if(typeof window._setupDone!=="undefined"){console.warn("p5.js seems to have been imported multiple times. Please remove the duplicate import");return}if(!window.mocha){if((window.setup&&typeof window.setup==="function"||window.draw&&typeof window.draw==="function")&&!_main.default.instance){new _main.default}}};var waitForDocumentReady=function waitForDocumentReady(){return new Promise(function(resolve,reject){if(document.readyState==="complete"){resolve()}else{window.addEventListener("load",resolve,false)}})};var waitingForTranslator=typeof IS_MINIFIED==="undefined"?(0,_internationalization.initialize)():Promise.resolve();Promise.all([waitForDocumentReady(),waitingForTranslator]).then(_globalInit)},{"../core/main":298,"./internationalization":296,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.to-string":200,"core-js/modules/es.promise":201,"core-js/modules/es.string.iterator":210,"core-js/modules/web.dom-collections.iterator":256}],296:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.setTranslatorLanguage=exports.currentTranslatorLanguage=exports.availableTranslatorLanguages=exports.initialize=exports.translator=void 0;var _i18next=_interopRequireDefault(_dereq_("i18next"));var _i18nextBrowserLanguagedetector=_interopRequireDefault(_dereq_("i18next-browser-languagedetector"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var fallbackResources,languages;if(typeof IS_MINIFIED==="undefined"){var translationsModule=_dereq_("../../translations");fallbackResources=translationsModule.default;languages=translationsModule.languages;if(typeof P5_DEV_BUILD!=="undefined"){var completeResources=_dereq_("../../translations/dev");for(var _i=0,_Object$keys=Object.keys(completeResources);_i<_Object$keys.length;_i++){var language=_Object$keys[_i];var parts=language.split("_");var lng=parts.slice(0,parts.length-1).join("-");var ns=parts[parts.length-1];fallbackResources[lng]=fallbackResources[lng]||{};fallbackResources[lng][ns]=completeResources[language]}}}var FetchResources=function(){function FetchResources(services,options){_classCallCheck(this,FetchResources);this.init(services,options)}_createClass(FetchResources,[{key:"fetchWithTimeout",value:function fetchWithTimeout(url,options){var timeout=arguments.length>2&&arguments[2]!==undefined?arguments[2]:2e3;return Promise.race([fetch(url,options),new Promise(function(_,reject){return setTimeout(function(){return reject(new Error("timeout"))},timeout)})])}},{key:"init",value:function init(services){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this.services=services;this.options=options}},{key:"read",value:function read(language,namespace,callback){var loadPath=this.options.loadPath;if(language===this.options.fallback){callback(null,fallbackResources[language][namespace])}else if(languages.includes(language)){var url=this.services.interpolator.interpolate(loadPath,{lng:language,ns:namespace});this.loadUrl(url,callback)}else{callback("Not found",false)}}},{key:"loadUrl",value:function loadUrl(url,callback){this.fetchWithTimeout(url).then(function(response){var ok=response.ok;if(!ok){throw new Error("failed loading ".concat(url))}return response.json()},function(){throw new Error("failed loading ".concat(url))}).then(function(data){return callback(null,data)}).catch(callback)}}]);return FetchResources}();FetchResources.type="backend";var translator=function translator(key,values){console.debug("p5.js translator called before translations were loaded");_i18next.default.t(key,values)};exports.translator=translator;var initialize=function initialize(){var i18init=_i18next.default.use(_i18nextBrowserLanguagedetector.default).use(FetchResources).init({fallbackLng:"en",nestingPrefix:"$tr(",nestingSuffix:")",defaultNS:"translation",returnEmptyString:false,interpolation:{escapeValue:false},detection:{checkWhitelist:false,order:["querystring","navigator","htmlTag","path","subdomain"],caches:[]},backend:{fallback:"en",loadPath:"https://cdn.jsdelivr.net/npm/p5/translations/{{lng}}/{{ns}}.json"},partialBundledLanguages:true,resources:fallbackResources}).then(function(translateFn){exports.translator=translator=translateFn},function(e){return console.debug("Translations failed to load (".concat(e,")"))});return i18init};exports.initialize=initialize;var availableTranslatorLanguages=function availableTranslatorLanguages(){return _i18next.default.languages};exports.availableTranslatorLanguages=availableTranslatorLanguages;var currentTranslatorLanguage=function currentTranslatorLanguage(language){return _i18next.default.language};exports.currentTranslatorLanguage=currentTranslatorLanguage;var setTranslatorLanguage=function setTranslatorLanguage(language){return _i18next.default.changeLanguage(language||undefined,function(e){return console.debug("Translations failed to load (".concat(e,")"))})};exports.setTranslatorLanguage=setTranslatorLanguage},{"../../translations":360,"../../translations/dev":undefined,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.join":180,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.keys":199,"core-js/modules/es.object.to-string":200,"core-js/modules/es.promise":201,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.split":216,"core-js/modules/web.dom-collections.iterator":256,i18next:267,"i18next-browser-languagedetector":264}],297:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("./main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.pushStyle=function(){throw new Error("pushStyle() not used, see push()")};_main.default.prototype.popStyle=function(){throw new Error("popStyle() not used, see pop()")};_main.default.prototype.popMatrix=function(){throw new Error("popMatrix() not used, see pop()")};_main.default.prototype.pushMatrix=function(){throw new Error("pushMatrix() not used, see push()")};var _default=_main.default;exports.default=_default},{"./main":298}],298:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.get-own-property-names");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.object.get-own-property-names");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;_dereq_("./shim");var constants=_interopRequireWildcard(_dereq_("./constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var p5=function(){function p5(sketch,node){var _this=this;_classCallCheck(this,p5);this._setupDone=false;this._preloadDone=false;this._pixelDensity=Math.ceil(window.devicePixelRatio)||1;this._userNode=node;this._curElement=null;this._elements=[];this._glAttributes=null;this._requestAnimId=0;this._preloadCount=0;this._isGlobal=false;this._loop=true;this._startListener=null;this._initializeInstanceVariables();this._defaultCanvasSize={width:100,height:100};this._events={mousemove:null,mousedown:null,mouseup:null,dragend:null,dragover:null,click:null,dblclick:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,touchstart:null,touchmove:null,touchend:null,resize:null,blur:null};this._millisStart=-1;this._recording=false;this._lcg_random_state=null;this._gaussian_previous=false;this._events.wheel=null;this._loadingScreenId="p5_loading";this._registeredMethods={};var methods=Object.getOwnPropertyNames(p5.prototype._registeredMethods);var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=methods[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var prop=_step.value;this._registeredMethods[prop]=p5.prototype._registeredMethods[prop].slice()}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}if(window.DeviceOrientationEvent){this._events.deviceorientation=null}if(window.DeviceMotionEvent&&!window._isNodeWebkit){this._events.devicemotion=null}p5.prototype.callRegisteredHooksFor=function(hookName){var target=this||p5.prototype;var context=this._isGlobal?window:this;if(target._registeredMethods.hasOwnProperty(hookName)){var _methods=target._registeredMethods[hookName];var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=_methods[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var method=_step2.value;if(typeof method==="function"){method.call(context)}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}};this._start=function(){if(_this._userNode){if(typeof _this._userNode==="string"){_this._userNode=document.getElementById(_this._userNode)}}var context=_this._isGlobal?window:_this;if(context.preload){_this.callRegisteredHooksFor("beforePreload");var loadingScreen=document.getElementById(_this._loadingScreenId);if(!loadingScreen){loadingScreen=document.createElement("div");loadingScreen.innerHTML="Loading...";loadingScreen.style.position="absolute";loadingScreen.id=_this._loadingScreenId;var _node=_this._userNode||document.body;_node.appendChild(loadingScreen)}var _methods2=_this._preloadMethods;for(var method in _methods2){_methods2[method]=_methods2[method]||p5;var obj=_methods2[method];if(obj===p5.prototype||obj===p5){if(_this._isGlobal){window[method]=_this._wrapPreload(_this,method)}obj=_this}_this._registeredPreloadMethods[method]=obj[method];obj[method]=_this._wrapPreload(obj,method)}context.preload();_this._runIfPreloadsAreDone()}else{_this._setup();if(!_this._recording){_this._draw()}}};this._runIfPreloadsAreDone=function(){var context=this._isGlobal?window:this;if(context._preloadCount===0){var loadingScreen=document.getElementById(context._loadingScreenId);if(loadingScreen){loadingScreen.parentNode.removeChild(loadingScreen)}this.callRegisteredHooksFor("afterPreload");if(!this._setupDone){this._lastTargetFrameTime=window.performance.now();this._lastRealFrameTime=window.performance.now();context._setup();if(!this._recording){context._draw()}}}};this._decrementPreload=function(){var context=this._isGlobal?window:this;if(!context._preloadDone&&typeof context.preload==="function"){context._setProperty("_preloadCount",context._preloadCount-1);context._runIfPreloadsAreDone()}};this._wrapPreload=function(obj,fnName){var _this2=this;return function(){_this2._incrementPreload();for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _this2._registeredPreloadMethods[fnName].apply(obj,args)}};this._incrementPreload=function(){var context=this._isGlobal?window:this;if(context._preloadDone)return;context._setProperty("_preloadCount",context._preloadCount+1)};this._setup=function(){_this.callRegisteredHooksFor("beforeSetup");_this.createCanvas(_this._defaultCanvasSize.width,_this._defaultCanvasSize.height,"p2d");var context=_this._isGlobal?window:_this;if(typeof context.preload==="function"){for(var f in _this._preloadMethods){context[f]=_this._preloadMethods[f][f];if(context[f]&&_this){context[f]=context[f].bind(_this)}}}_this._millisStart=window.performance.now();context._preloadDone=true;if(typeof context.setup==="function"){context.setup()}var canvases=document.getElementsByTagName("canvas");var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=canvases[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var k=_step3.value;if(k.dataset.hidden==="true"){k.style.visibility="";delete k.dataset.hidden}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return!=null){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}_this._lastTargetFrameTime=window.performance.now();_this._lastRealFrameTime=window.performance.now();_this._setupDone=true;if(_this._accessibleOutputs.grid||_this._accessibleOutputs.text){_this._updateAccsOutput()}_this.callRegisteredHooksFor("afterSetup")};this._draw=function(){var now=window.performance.now();var time_since_last=now-_this._lastTargetFrameTime;var target_time_between_frames=1e3/_this._targetFrameRate;var epsilon=5;if(!_this._loop||time_since_last>=target_time_between_frames-epsilon){_this.deltaTime=now-_this._lastRealFrameTime;_this._setProperty("deltaTime",_this.deltaTime);_this._frameRate=1e3/_this.deltaTime;_this.redraw();_this._lastTargetFrameTime=Math.max(_this._lastTargetFrameTime+target_time_between_frames,now);_this._lastRealFrameTime=now;if(typeof _this._updateMouseCoords!=="undefined"){_this._updateMouseCoords();_this._setProperty("movedX",0);_this._setProperty("movedY",0)}}if(_this._loop){_this._requestAnimId=window.requestAnimationFrame(_this._draw)}};this._setProperty=function(prop,value){_this[prop]=value;if(_this._isGlobal){window[prop]=value}};this.remove=function(){if(_this._startListener){window.removeEventListener("load",_this._startListener,false)}var loadingScreen=document.getElementById(_this._loadingScreenId);if(loadingScreen){loadingScreen.parentNode.removeChild(loadingScreen);_this._incrementPreload()}if(_this._curElement){_this._loop=false;if(_this._requestAnimId){window.cancelAnimationFrame(_this._requestAnimId)}for(var ev in _this._events){window.removeEventListener(ev,_this._events[ev])}var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=_this._elements[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var e=_step4.value;if(e.elt&&e.elt.parentNode){e.elt.parentNode.removeChild(e.elt)}for(var elt_ev in e._events){e.elt.removeEventListener(elt_ev,e._events[elt_ev])}}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return!=null){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}var self=_this;_this._registeredMethods.remove.forEach(function(f){if(typeof f!=="undefined"){f.call(self)}})}if(_this._isGlobal){for(var p in p5.prototype){try{delete window[p]}catch(x){window[p]=undefined}}for(var p2 in _this){if(_this.hasOwnProperty(p2)){try{delete window[p2]}catch(x){window[p2]=undefined}}}p5.instance=null}};this._registeredMethods.init.forEach(function(f){if(typeof f!=="undefined"){f.call(this)}},this);this._setupPromisePreloads();var friendlyBindGlobal=this._createFriendlyGlobalFunctionBinder();if(!sketch){this._isGlobal=true;p5.instance=this;for(var p in p5.prototype){if(typeof p5.prototype[p]==="function"){var ev=p.substring(2);if(!this._events.hasOwnProperty(ev)){if(Math.hasOwnProperty(p)&&Math[p]===p5.prototype[p]){friendlyBindGlobal(p,p5.prototype[p])}else{friendlyBindGlobal(p,p5.prototype[p].bind(this))}}}else{friendlyBindGlobal(p,p5.prototype[p])}}for(var p2 in this){if(this.hasOwnProperty(p2)){friendlyBindGlobal(p2,this[p2])}}}else{sketch(this);p5._checkForUserDefinedFunctions(this)}for(var e in this._events){var f=this["_on".concat(e)];if(f){var m=f.bind(this);window.addEventListener(e,m,{passive:false});this._events[e]=m}}var focusHandler=function focusHandler(){_this._setProperty("focused",true)};var blurHandler=function blurHandler(){_this._setProperty("focused",false)};window.addEventListener("focus",focusHandler);window.addEventListener("blur",blurHandler);this.registerMethod("remove",function(){window.removeEventListener("focus",focusHandler);window.removeEventListener("blur",blurHandler)});if(document.readyState==="complete"){this._start()}else{this._startListener=this._start.bind(this);window.addEventListener("load",this._startListener,false)}}_createClass(p5,[{key:"_initializeInstanceVariables",value:function _initializeInstanceVariables(){this._accessibleOutputs={text:false,grid:false,textLabel:false,gridLabel:false};this._styles=[];this._bezierDetail=20;this._curveDetail=20;this._colorMode=constants.RGB;this._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]};this._downKeys={}}},{key:"registerPreloadMethod",value:function registerPreloadMethod(fnString,obj){if(!p5.prototype._preloadMethods.hasOwnProperty(fnString)){p5.prototype._preloadMethods[fnString]=obj}}},{key:"registerMethod",value:function registerMethod(name,m){var target=this||p5.prototype;if(!target._registeredMethods.hasOwnProperty(name)){target._registeredMethods[name]=[]}target._registeredMethods[name].push(m)}},{key:"unregisterMethod",value:function unregisterMethod(name,m){var target=this||p5.prototype;if(target._registeredMethods.hasOwnProperty(name)){var methods=target._registeredMethods[name];var indexesToRemove=[];for(var i=0;i<methods.length;i++){if(methods[i]===m){indexesToRemove.push(i)}}for(var _i=indexesToRemove.length-1;_i>=0;_i--){methods.splice(indexesToRemove[_i],1)}}}},{key:"_createFriendlyGlobalFunctionBinder",value:function _createFriendlyGlobalFunctionBinder(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var globalObject=options.globalObject||window;var log=options.log||console.log.bind(console);var propsToForciblyOverwrite={print:true};return function(prop,value){if(!p5.disableFriendlyErrors&&typeof IS_MINIFIED==="undefined"&&typeof value==="function"&&!(prop in p5.prototype._preloadMethods)){try{if(prop in globalObject&&!(prop in propsToForciblyOverwrite)){throw new Error('global "'.concat(prop,'" already exists'))}Object.defineProperty(globalObject,prop,{configurable:true,enumerable:true,get:function get(){return value},set:function set(newValue){Object.defineProperty(globalObject,prop,{configurable:true,enumerable:true,value:newValue,writable:true});log('You just changed the value of "'.concat(prop,"\", which was a p5 function. This could cause problems later if you're not careful."))}})}catch(e){var message='p5 had problems creating the global function "'.concat(prop,'", possibly because your code is already using that name as a variable. You may want to rename your variable to something else.');p5._friendlyError(message,prop);globalObject[prop]=value}}else{globalObject[prop]=value}}}}]);return p5}();p5.instance=null;p5.disableFriendlyErrors=false;for(var k in constants){p5.prototype[k]=constants[k]}p5.VERSION=constants.VERSION;p5.prototype._preloadMethods={loadJSON:p5.prototype,loadImage:p5.prototype,loadStrings:p5.prototype,loadXML:p5.prototype,loadBytes:p5.prototype,loadTable:p5.prototype,loadFont:p5.prototype,loadModel:p5.prototype,loadShader:p5.prototype};p5.prototype._registeredMethods={init:[],pre:[],post:[],remove:[]};p5.prototype._registeredPreloadMethods={};var _default=p5;exports.default=_default},{"./constants":286,"./shim":309,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.splice":185,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.get-own-property-names":197,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.for-each":255,"core-js/modules/web.dom-collections.iterator":256}],299:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("./main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.Element=function(){function _class(elt,pInst){_classCallCheck(this,_class);this.elt=elt;this._pInst=this._pixelsState=pInst;this._events={};this.width=this.elt.offsetWidth;this.height=this.elt.offsetHeight}_createClass(_class,[{key:"parent",value:function parent(p){if(typeof p==="undefined"){return this.elt.parentNode}if(typeof p==="string"){if(p[0]==="#"){p=p.substring(1)}p=document.getElementById(p)}else if(p instanceof _main.default.Element){p=p.elt}p.appendChild(this.elt);return this}},{key:"id",value:function id(_id){if(typeof _id==="undefined"){return this.elt.id}this.elt.id=_id;this.width=this.elt.offsetWidth;this.height=this.elt.offsetHeight;return this}},{key:"class",value:function _class(c){if(typeof c==="undefined"){return this.elt.className}this.elt.className=c;return this}},{key:"mousePressed",value:function mousePressed(fxn){var eventPrependedFxn=function eventPrependedFxn(event){this._pInst._setProperty("mouseIsPressed",true);this._pInst._setMouseButton(event);return fxn.call(this,event)};_main.default.Element._adjustListener("mousedown",eventPrependedFxn,this);return this}},{key:"doubleClicked",value:function doubleClicked(fxn){_main.default.Element._adjustListener("dblclick",fxn,this);return this}},{key:"mouseWheel",value:function mouseWheel(fxn){_main.default.Element._adjustListener("wheel",fxn,this);return this}},{key:"mouseReleased",value:function mouseReleased(fxn){_main.default.Element._adjustListener("mouseup",fxn,this);return this}},{key:"mouseClicked",value:function mouseClicked(fxn){_main.default.Element._adjustListener("click",fxn,this);return this}},{key:"mouseMoved",value:function mouseMoved(fxn){_main.default.Element._adjustListener("mousemove",fxn,this);return this}},{key:"mouseOver",value:function mouseOver(fxn){_main.default.Element._adjustListener("mouseover",fxn,this);return this}},{key:"mouseOut",value:function mouseOut(fxn){_main.default.Element._adjustListener("mouseout",fxn,this);return this}},{key:"touchStarted",value:function touchStarted(fxn){_main.default.Element._adjustListener("touchstart",fxn,this);return this}},{key:"touchMoved",value:function touchMoved(fxn){_main.default.Element._adjustListener("touchmove",fxn,this);return this}},{key:"touchEnded",value:function touchEnded(fxn){_main.default.Element._adjustListener("touchend",fxn,this);return this}},{key:"dragOver",value:function dragOver(fxn){_main.default.Element._adjustListener("dragover",fxn,this);return this}},{key:"dragLeave",value:function dragLeave(fxn){_main.default.Element._adjustListener("dragleave",fxn,this);return this}},{key:"_setProperty",value:function _setProperty(prop,value){this[prop]=value}}],[{key:"_adjustListener",value:function _adjustListener(ev,fxn,ctx){if(fxn===false){_main.default.Element._detachListener(ev,ctx)}else{_main.default.Element._attachListener(ev,fxn,ctx)}return this}},{key:"_attachListener",value:function _attachListener(ev,fxn,ctx){if(ctx._events[ev]){_main.default.Element._detachListener(ev,ctx)}var f=fxn.bind(ctx);ctx.elt.addEventListener(ev,f,false);ctx._events[ev]=f}},{key:"_detachListener",value:function _detachListener(ev,ctx){var f=ctx._events[ev];ctx.elt.removeEventListener(ev,f,false);ctx._events[ev]=null}}]);return _class}();var _default=_main.default.Element;exports.default=_default},{"./main":298}],300:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.object.get-prototype-of");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("./main"));var constants=_interopRequireWildcard(_dereq_("./constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var Super=_getPrototypeOf(Derived),result;if(isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}_main.default.Graphics=function(_p5$Element){_inherits(_class,_p5$Element);var _super=_createSuper(_class);function _class(w,h,renderer,pInst,canvas){var _this;_classCallCheck(this,_class);var canvasTemp;if(canvas){canvasTemp=canvas}else{canvasTemp=document.createElement("canvas")}_this=_super.call(this,canvasTemp,pInst);_this.canvas=canvasTemp;var r=renderer||constants.P2D;var node=pInst._userNode||document.body;if(!canvas){node.appendChild(_this.canvas)}for(var p in _main.default.prototype){if(!_this[p]){if(typeof _main.default.prototype[p]==="function"){_this[p]=_main.default.prototype[p].bind(_assertThisInitialized(_this))}else{_this[p]=_main.default.prototype[p]}}}_main.default.prototype._initializeInstanceVariables.apply(_assertThisInitialized(_this));_this.width=w;_this.height=h;_this._pixelDensity=pInst._pixelDensity;if(r===constants.WEBGL){_this._renderer=new _main.default.RendererGL(_this.canvas,_assertThisInitialized(_this),false)}else{_this._renderer=new _main.default.Renderer2D(_this.canvas,_assertThisInitialized(_this),false)}pInst._elements.push(_assertThisInitialized(_this));Object.defineProperty(_assertThisInitialized(_this),"deltaTime",{get:function get(){return this._pInst.deltaTime}});_this._renderer.resize(w,h);_this._renderer._applyDefaults();return _possibleConstructorReturn(_this,_assertThisInitialized(_this))}_createClass(_class,[{key:"reset",value:function reset(){this._renderer.resetMatrix();if(this._renderer.isP3D){this._renderer._update()}}},{key:"remove",value:function remove(){if(this.elt.parentNode){this.elt.parentNode.removeChild(this.elt)}var idx=this._pInst._elements.indexOf(this);if(idx!==-1){this._pInst._elements.splice(idx,1)}for(var elt_ev in this._events){this.elt.removeEventListener(elt_ev,this._events[elt_ev])}}},{key:"createFramebuffer",value:function createFramebuffer(options){return new _main.default.Framebuffer(this,options)}}]);return _class}(_main.default.Element);var _default=_main.default.Graphics;exports.default=_default},{"./constants":286,"./main":298,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.splice":185,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.to-string":200,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],301:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("./main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var Super=_getPrototypeOf(Derived),result;if(isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var Renderer=function(_p5$Element){_inherits(Renderer,_p5$Element);var _super=_createSuper(Renderer);function Renderer(elt,pInst,isMainCanvas){var _this;_classCallCheck(this,Renderer);_this=_super.call(this,elt,pInst);_this.canvas=elt;_this._pixelsState=pInst;if(isMainCanvas){_this._isMainCanvas=true;_this._pInst._setProperty("_curElement",_assertThisInitialized(_this));_this._pInst._setProperty("canvas",_this.canvas);_this._pInst._setProperty("width",_this.width);_this._pInst._setProperty("height",_this.height)}else{_this.canvas.style.display="none";_this._styles=[]}_this._clipping=false;_this._clipInvert=false;_this._textSize=12;_this._textLeading=15;_this._textFont="sans-serif";_this._textStyle=constants.NORMAL;_this._textAscent=null;_this._textDescent=null;_this._textAlign=constants.LEFT;_this._textBaseline=constants.BASELINE;_this._textWrap=constants.WORD;_this._rectMode=constants.CORNER;_this._ellipseMode=constants.CENTER;_this._curveTightness=0;_this._imageMode=constants.CORNER;_this._tint=null;_this._doStroke=true;_this._doFill=true;_this._strokeSet=false;_this._fillSet=false;_this._leadingSet=false;_this._pushPopDepth=0;return _this}_createClass(Renderer,[{key:"push",value:function push(){this._pushPopDepth++;return{properties:{_doStroke:this._doStroke,_strokeSet:this._strokeSet,_doFill:this._doFill,_fillSet:this._fillSet,_tint:this._tint,_imageMode:this._imageMode,_rectMode:this._rectMode,_ellipseMode:this._ellipseMode,_textFont:this._textFont,_textLeading:this._textLeading,_leadingSet:this._leadingSet,_textSize:this._textSize,_textAlign:this._textAlign,_textBaseline:this._textBaseline,_textStyle:this._textStyle,_textWrap:this._textWrap}}}},{key:"pop",value:function pop(style){this._pushPopDepth--;if(style.properties){Object.assign(this,style.properties)}}},{key:"beginClip",value:function beginClip(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(this._clipping){throw new Error("It looks like you're trying to clip while already in the middle of clipping. Did you forget to endClip()?")}this._clipping=true;this._clipInvert=options.invert}},{key:"endClip",value:function endClip(){if(!this._clipping){throw new Error("It looks like you've called endClip() without beginClip(). Did you forget to call beginClip() first?")}this._clipping=false}},{key:"resize",value:function resize(w,h){this.width=w;this.height=h;this.elt.width=w*this._pInst._pixelDensity;this.elt.height=h*this._pInst._pixelDensity;this.elt.style.width="".concat(w,"px");this.elt.style.height="".concat(h,"px");if(this._isMainCanvas){this._pInst._setProperty("width",this.width);this._pInst._setProperty("height",this.height)}}},{key:"get",value:function get(x,y,w,h){var pixelsState=this._pixelsState;var pd=pixelsState._pixelDensity;var canvas=this.canvas;if(typeof x==="undefined"&&typeof y==="undefined"){x=y=0;w=pixelsState.width;h=pixelsState.height}else{x*=pd;y*=pd;if(typeof w==="undefined"&&typeof h==="undefined"){if(x<0||y<0||x>=canvas.width||y>=canvas.height){return[0,0,0,0]}return this._getPixel(x,y)}}var region=new _main.default.Image(w*pd,h*pd);region.pixelDensity(pd);region.canvas.getContext("2d").drawImage(canvas,x,y,w*pd,h*pd,0,0,w*pd,h*pd);return region}},{key:"textLeading",value:function textLeading(l){if(typeof l==="number"){this._setProperty("_leadingSet",true);this._setProperty("_textLeading",l);return this._pInst}return this._textLeading}},{key:"textStyle",value:function textStyle(s){if(s){if(s===constants.NORMAL||s===constants.ITALIC||s===constants.BOLD||s===constants.BOLDITALIC){this._setProperty("_textStyle",s)}return this._applyTextProperties()}return this._textStyle}},{key:"textAscent",value:function textAscent(){if(this._textAscent===null){this._updateTextMetrics()}return this._textAscent}},{key:"textDescent",value:function textDescent(){if(this._textDescent===null){this._updateTextMetrics()}return this._textDescent}},{key:"textAlign",value:function textAlign(h,v){if(typeof h!=="undefined"){this._setProperty("_textAlign",h);if(typeof v!=="undefined"){this._setProperty("_textBaseline",v)}return this._applyTextProperties()}else{return{horizontal:this._textAlign,vertical:this._textBaseline}}}},{key:"textWrap",value:function textWrap(wrapStyle){this._setProperty("_textWrap",wrapStyle);return this._textWrap}},{key:"text",value:function text(str,x,y,maxWidth,maxHeight){var p=this._pInst;var textWrapStyle=this._textWrap;var lines;var line;var testLine;var testWidth;var words;var chars;var shiftedY;var finalMaxHeight=Number.MAX_VALUE;var finalMinHeight=y;if(!(this._doFill||this._doStroke)){return}if(typeof str==="undefined"){return}else if(typeof str!=="string"){str=str.toString()}str=str.replace(/(\t)/g,"  ");lines=str.split("\n");if(typeof maxWidth!=="undefined"){if(this._rectMode===constants.CENTER){x-=maxWidth/2}switch(this._textAlign){case constants.CENTER:x+=maxWidth/2;break;case constants.RIGHT:x+=maxWidth;break}if(typeof maxHeight!=="undefined"){if(this._rectMode===constants.CENTER){y-=maxHeight/2;finalMinHeight-=maxHeight/2}var originalY=y;var ascent=p.textAscent();switch(this._textBaseline){case constants.BOTTOM:shiftedY=y+maxHeight;y=Math.max(shiftedY,y);finalMinHeight+=ascent;break;case constants.CENTER:shiftedY=y+maxHeight/2;y=Math.max(shiftedY,y);finalMinHeight+=ascent/2;break}finalMaxHeight=y+maxHeight-ascent;if(this._textBaseline===constants.CENTER){finalMaxHeight=originalY+maxHeight-ascent/2}}else{if(this._textBaseline===constants.BOTTOM||this._textBaseline===constants.CENTER){var rectHeight=p.textSize()*this._textLeading;finalMinHeight=y-rectHeight/2;finalMaxHeight=y+rectHeight/2}}if(textWrapStyle===constants.WORD){var nlines=[];for(var lineIndex=0;lineIndex<lines.length;lineIndex++){line="";words=lines[lineIndex].split(" ");for(var wordIndex=0;wordIndex<words.length;wordIndex++){testLine="".concat(line+words[wordIndex])+" ";testWidth=this.textWidth(testLine);if(testWidth>maxWidth&&line.length>0){nlines.push(line);line="".concat(words[wordIndex])+" "}else{line=testLine}}nlines.push(line)}var offset=0;if(this._textBaseline===constants.CENTER){offset=(nlines.length-1)*p.textLeading()/2}else if(this._textBaseline===constants.BOTTOM){offset=(nlines.length-1)*p.textLeading()}for(var _lineIndex=0;_lineIndex<lines.length;_lineIndex++){line="";words=lines[_lineIndex].split(" ");for(var _wordIndex=0;_wordIndex<words.length;_wordIndex++){testLine="".concat(line+words[_wordIndex])+" ";testWidth=this.textWidth(testLine);if(testWidth>maxWidth&&line.length>0){this._renderText(p,line.trim(),x,y-offset,finalMaxHeight,finalMinHeight);line="".concat(words[_wordIndex])+" ";y+=p.textLeading()}else{line=testLine}}this._renderText(p,line.trim(),x,y-offset,finalMaxHeight,finalMinHeight);y+=p.textLeading()}}else{var _nlines=[];for(var _lineIndex2=0;_lineIndex2<lines.length;_lineIndex2++){line="";chars=lines[_lineIndex2].split("");for(var charIndex=0;charIndex<chars.length;charIndex++){testLine="".concat(line+chars[charIndex]);testWidth=this.textWidth(testLine);if(testWidth<=maxWidth){line+=chars[charIndex]}else if(testWidth>maxWidth&&line.length>0){_nlines.push(line);line="".concat(chars[charIndex])}}}_nlines.push(line);var _offset=0;if(this._textBaseline===constants.CENTER){_offset=(_nlines.length-1)*p.textLeading()/2}else if(this._textBaseline===constants.BOTTOM){_offset=(_nlines.length-1)*p.textLeading()}for(var _lineIndex3=0;_lineIndex3<lines.length;_lineIndex3++){line="";chars=lines[_lineIndex3].split("");for(var _charIndex=0;_charIndex<chars.length;_charIndex++){testLine="".concat(line+chars[_charIndex]);testWidth=this.textWidth(testLine);if(testWidth<=maxWidth){line+=chars[_charIndex]}else if(testWidth>maxWidth&&line.length>0){this._renderText(p,line.trim(),x,y-_offset,finalMaxHeight,finalMinHeight);y+=p.textLeading();line="".concat(chars[_charIndex])}}}this._renderText(p,line.trim(),x,y-_offset,finalMaxHeight,finalMinHeight);y+=p.textLeading()}}else{var _offset2=0;if(this._textBaseline===constants.CENTER){_offset2=(lines.length-1)*p.textLeading()/2}else if(this._textBaseline===constants.BOTTOM){_offset2=(lines.length-1)*p.textLeading()}for(var i=0;i<lines.length;i++){this._renderText(p,lines[i],x,y-_offset2,finalMaxHeight,finalMinHeight-_offset2);y+=p.textLeading()}}return p}},{key:"_applyDefaults",value:function _applyDefaults(){return this}},{key:"_isOpenType",value:function _isOpenType(){var f=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._textFont;return _typeof(f)==="object"&&f.font&&f.font.supported}},{key:"_updateTextMetrics",value:function _updateTextMetrics(){if(this._isOpenType()){this._setProperty("_textAscent",this._textFont._textAscent());this._setProperty("_textDescent",this._textFont._textDescent());return this}var text=document.createElement("span");text.style.fontFamily=this._textFont;text.style.fontSize="".concat(this._textSize,"px");text.innerHTML="ABCjgq|";var block=document.createElement("div");block.style.display="inline-block";block.style.width="1px";block.style.height="0px";var container=document.createElement("div");container.appendChild(text);container.appendChild(block);container.style.height="0px";container.style.overflow="hidden";document.body.appendChild(container);block.style.verticalAlign="baseline";var blockOffset=calculateOffset(block);var textOffset=calculateOffset(text);var ascent=blockOffset[1]-textOffset[1];block.style.verticalAlign="bottom";blockOffset=calculateOffset(block);textOffset=calculateOffset(text);var height=blockOffset[1]-textOffset[1];var descent=height-ascent;document.body.removeChild(container);this._setProperty("_textAscent",ascent);this._setProperty("_textDescent",descent);return this}}]);return Renderer}(_main.default.Element);function calculateOffset(object){var currentLeft=0,currentTop=0;if(object.offsetParent){do{currentLeft+=object.offsetLeft;currentTop+=object.offsetTop}while(object=object.offsetParent)}else{currentLeft+=object.offsetLeft;currentTop+=object.offsetTop}return[currentLeft,currentTop]}Renderer.prototype.textSize=function(s){if(typeof s==="number"){this._setProperty("_textSize",s);if(!this._leadingSet){this._setProperty("_textLeading",s*constants._DEFAULT_LEADMULT)}return this._applyTextProperties()}return this._textSize};_main.default.Renderer=Renderer;var _default=_main.default.Renderer;exports.default=_default},{"../core/constants":286,"./main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.number.constructor":191,"core-js/modules/es.object.assign":194,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.to-string":200,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.replace":214,"core-js/modules/es.string.split":216,"core-js/modules/es.string.trim":219,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],302:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.number.to-fixed");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.reflect.get");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.number.to-fixed");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("./main"));var constants=_interopRequireWildcard(_dereq_("./constants"));_dereq_("./p5.Renderer");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver)}return desc.value}}return _get(target,property,receiver||target)}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break}return object}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var Super=_getPrototypeOf(Derived),result;if(isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var styleEmpty="rgba(0,0,0,0)";var Renderer2D=function(_p5$Renderer){_inherits(Renderer2D,_p5$Renderer);var _super=_createSuper(Renderer2D);function Renderer2D(elt,pInst,isMainCanvas){var _this;_classCallCheck(this,Renderer2D);_this=_super.call(this,elt,pInst,isMainCanvas);_this.drawingContext=_this.canvas.getContext("2d");_this._pInst._setProperty("drawingContext",_this.drawingContext);return _this}_createClass(Renderer2D,[{key:"getFilterGraphicsLayer",value:function getFilterGraphicsLayer(){if(!this.filterGraphicsLayer){var pInst=this._pInst instanceof _main.default.Graphics?this._pInst._pInst:this._pInst;this.filterGraphicsLayer=new _main.default.Graphics(this.width,this.height,constants.WEBGL,pInst)}if(this.filterGraphicsLayer.width!==this.width||this.filterGraphicsLayer.height!==this.height){this.filterGraphicsLayer.resizeCanvas(this.width,this.height)}if(this.filterGraphicsLayer.pixelDensity()!==this._pInst.pixelDensity()){this.filterGraphicsLayer.pixelDensity(this._pInst.pixelDensity())}return this.filterGraphicsLayer}},{key:"_applyDefaults",value:function _applyDefaults(){this._cachedFillStyle=this._cachedStrokeStyle=undefined;this._cachedBlendMode=constants.BLEND;this._setFill(constants._DEFAULT_FILL);this._setStroke(constants._DEFAULT_STROKE);this.drawingContext.lineCap=constants.ROUND;this.drawingContext.font="normal 12px sans-serif"}},{key:"resize",value:function resize(w,h){_get(_getPrototypeOf(Renderer2D.prototype),"resize",this).call(this,w,h);this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity)}},{key:"background",value:function background(){this.drawingContext.save();this.resetMatrix();if((arguments.length<=0?undefined:arguments[0])instanceof _main.default.Image){if((arguments.length<=1?undefined:arguments[1])>=0){var img=arguments.length<=0?undefined:arguments[0];this.drawingContext.globalAlpha=(arguments.length<=1?undefined:arguments[1])/255;this._pInst.image(img,0,0,this.width,this.height)}else{this._pInst.image(arguments.length<=0?undefined:arguments[0],0,0,this.width,this.height)}}else{var _this$_pInst;var curFill=this._getFill();var color=(_this$_pInst=this._pInst).color.apply(_this$_pInst,arguments);if(this._pInst._addAccsOutput()){this._pInst._accsBackground(color.levels)}var newFill=color.toString();this._setFill(newFill);if(this._isErasing){this.blendMode(this._cachedBlendMode)}this.drawingContext.fillRect(0,0,this.width,this.height);this._setFill(curFill);if(this._isErasing){this._pInst.erase()}}this.drawingContext.restore()}},{key:"clear",value:function clear(){this.drawingContext.save();this.resetMatrix();this.drawingContext.clearRect(0,0,this.width,this.height);this.drawingContext.restore()}},{key:"fill",value:function fill(){var _this$_pInst2;var color=(_this$_pInst2=this._pInst).color.apply(_this$_pInst2,arguments);this._setFill(color.toString());if(this._pInst._addAccsOutput()){this._pInst._accsCanvasColors("fill",color.levels)}}},{key:"stroke",value:function stroke(){var _this$_pInst3;var color=(_this$_pInst3=this._pInst).color.apply(_this$_pInst3,arguments);this._setStroke(color.toString());if(this._pInst._addAccsOutput()){this._pInst._accsCanvasColors("stroke",color.levels)}}},{key:"erase",value:function erase(opacityFill,opacityStroke){if(!this._isErasing){this._cachedFillStyle=this.drawingContext.fillStyle;var newFill=this._pInst.color(255,opacityFill).toString();this.drawingContext.fillStyle=newFill;this._cachedStrokeStyle=this.drawingContext.strokeStyle;var newStroke=this._pInst.color(255,opacityStroke).toString();this.drawingContext.strokeStyle=newStroke;var tempBlendMode=this._cachedBlendMode;this.blendMode(constants.REMOVE);this._cachedBlendMode=tempBlendMode;this._isErasing=true}}},{key:"noErase",value:function noErase(){if(this._isErasing){this.drawingContext.fillStyle=this._cachedFillStyle;this.drawingContext.strokeStyle=this._cachedStrokeStyle;this.blendMode(this._cachedBlendMode);this._isErasing=false}}},{key:"beginClip",value:function beginClip(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_get(_getPrototypeOf(Renderer2D.prototype),"beginClip",this).call(this,options);this._cachedFillStyle=this.drawingContext.fillStyle;var newFill=this._pInst.color(255,0).toString();this.drawingContext.fillStyle=newFill;this._cachedStrokeStyle=this.drawingContext.strokeStyle;var newStroke=this._pInst.color(255,0).toString();this.drawingContext.strokeStyle=newStroke;var tempBlendMode=this._cachedBlendMode;this.blendMode(constants.BLEND);this._cachedBlendMode=tempBlendMode;this.drawingContext.beginPath();if(this._clipInvert){this.drawingContext.moveTo(-2*this.width,-2*this.height);this.drawingContext.lineTo(-2*this.width,2*this.height);this.drawingContext.lineTo(2*this.width,2*this.height);this.drawingContext.lineTo(2*this.width,-2*this.height);this.drawingContext.closePath()}}},{key:"endClip",value:function endClip(){this._doFillStrokeClose();this.drawingContext.clip();_get(_getPrototypeOf(Renderer2D.prototype),"endClip",this).call(this);this.drawingContext.fillStyle=this._cachedFillStyle;this.drawingContext.strokeStyle=this._cachedStrokeStyle;this.blendMode(this._cachedBlendMode)}},{key:"image",value:function image(img,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight){var cnv;if(img.gifProperties){img._animateGif(this._pInst)}try{if(_main.default.MediaElement&&img instanceof _main.default.MediaElement){img._ensureCanvas()}if(this._tint&&img.canvas){cnv=this._getTintedImageCanvas(img)}if(!cnv){cnv=img.canvas||img.elt}var s=1;if(img.width&&img.width>0){s=cnv.width/img.width}if(this._isErasing){this.blendMode(this._cachedBlendMode)}this.drawingContext.drawImage(cnv,s*sx,s*sy,s*sWidth,s*sHeight,dx,dy,dWidth,dHeight);if(this._isErasing){this._pInst.erase()}}catch(e){if(e.name!=="NS_ERROR_NOT_AVAILABLE"){throw e}}}},{key:"_getTintedImageCanvas",value:function _getTintedImageCanvas(img){if(!img.canvas){return img}if(!img.tintCanvas){img.tintCanvas=document.createElement("canvas")}if(img.tintCanvas.width!==img.canvas.width){img.tintCanvas.width=img.canvas.width}if(img.tintCanvas.height!==img.canvas.height){img.tintCanvas.height=img.canvas.height}var ctx=img.tintCanvas.getContext("2d");ctx.save();ctx.clearRect(0,0,img.canvas.width,img.canvas.height);if(this._tint[0]<255||this._tint[1]<255||this._tint[2]<255){ctx.drawImage(img.canvas,0,0);ctx.globalCompositeOperation="luminosity";ctx.drawImage(img.canvas,0,0);ctx.globalCompositeOperation="color";ctx.drawImage(img.canvas,0,0);ctx.globalCompositeOperation="multiply";ctx.fillStyle="rgb(".concat(this._tint.slice(0,3).join(", "),")");ctx.fillRect(0,0,img.canvas.width,img.canvas.height);ctx.globalCompositeOperation="destination-in";ctx.globalAlpha=this._tint[3]/255;ctx.drawImage(img.canvas,0,0)}else{ctx.globalAlpha=this._tint[3]/255;ctx.drawImage(img.canvas,0,0)}ctx.restore();return img.tintCanvas}},{key:"blendMode",value:function blendMode(mode){if(mode===constants.SUBTRACT){console.warn("blendMode(SUBTRACT) only works in WEBGL mode.")}else if(mode===constants.BLEND||mode===constants.REMOVE||mode===constants.DARKEST||mode===constants.LIGHTEST||mode===constants.DIFFERENCE||mode===constants.MULTIPLY||mode===constants.EXCLUSION||mode===constants.SCREEN||mode===constants.REPLACE||mode===constants.OVERLAY||mode===constants.HARD_LIGHT||mode===constants.SOFT_LIGHT||mode===constants.DODGE||mode===constants.BURN||mode===constants.ADD){this._cachedBlendMode=mode;this.drawingContext.globalCompositeOperation=mode}else{throw new Error("Mode ".concat(mode," not recognized."))}}},{key:"blend",value:function blend(){var currBlend=this.drawingContext.globalCompositeOperation;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}var blendMode=args[args.length-1];var copyArgs=Array.prototype.slice.call(args,0,args.length-1);this.drawingContext.globalCompositeOperation=blendMode;_main.default.prototype.copy.apply(this,copyArgs);this.drawingContext.globalCompositeOperation=currBlend}},{key:"_getPixel",value:function _getPixel(x,y){var imageData,index;imageData=this.drawingContext.getImageData(x,y,1,1).data;index=0;return[imageData[index+0],imageData[index+1],imageData[index+2],imageData[index+3]]}},{key:"loadPixels",value:function loadPixels(){var pixelsState=this._pixelsState;var pd=pixelsState._pixelDensity;var w=this.width*pd;var h=this.height*pd;var imageData=this.drawingContext.getImageData(0,0,w,h);pixelsState._setProperty("imageData",imageData);pixelsState._setProperty("pixels",imageData.data)}},{key:"set",value:function set(x,y,imgOrCol){x=Math.floor(x);y=Math.floor(y);var pixelsState=this._pixelsState;if(imgOrCol instanceof _main.default.Image){this.drawingContext.save();this.drawingContext.setTransform(1,0,0,1,0,0);this.drawingContext.scale(pixelsState._pixelDensity,pixelsState._pixelDensity);this.drawingContext.clearRect(x,y,imgOrCol.width,imgOrCol.height);this.drawingContext.drawImage(imgOrCol.canvas,x,y);this.drawingContext.restore()}else{var r=0,g=0,b=0,a=0;var idx=4*(y*pixelsState._pixelDensity*(this.width*pixelsState._pixelDensity)+x*pixelsState._pixelDensity);if(!pixelsState.imageData){pixelsState.loadPixels.call(pixelsState)}if(typeof imgOrCol==="number"){if(idx<pixelsState.pixels.length){r=imgOrCol;g=imgOrCol;b=imgOrCol;a=255}}else if(imgOrCol instanceof Array){if(imgOrCol.length<4){throw new Error("pixel array must be of the form [R, G, B, A]")}if(idx<pixelsState.pixels.length){r=imgOrCol[0];g=imgOrCol[1];b=imgOrCol[2];a=imgOrCol[3]}}else if(imgOrCol instanceof _main.default.Color){if(idx<pixelsState.pixels.length){r=imgOrCol.levels[0];g=imgOrCol.levels[1];b=imgOrCol.levels[2];a=imgOrCol.levels[3]}}for(var i=0;i<pixelsState._pixelDensity;i++){for(var j=0;j<pixelsState._pixelDensity;j++){idx=4*((y*pixelsState._pixelDensity+j)*this.width*pixelsState._pixelDensity+(x*pixelsState._pixelDensity+i));pixelsState.pixels[idx]=r;pixelsState.pixels[idx+1]=g;pixelsState.pixels[idx+2]=b;pixelsState.pixels[idx+3]=a}}}}},{key:"updatePixels",value:function updatePixels(x,y,w,h){var pixelsState=this._pixelsState;var pd=pixelsState._pixelDensity;if(x===undefined&&y===undefined&&w===undefined&&h===undefined){x=0;y=0;w=this.width;h=this.height}x*=pd;y*=pd;w*=pd;h*=pd;if(this.gifProperties){this.gifProperties.frames[this.gifProperties.displayIndex].image=pixelsState.imageData}this.drawingContext.putImageData(pixelsState.imageData,x,y,0,0,w,h)}},{key:"_acuteArcToBezier",value:function _acuteArcToBezier(start,size){var alpha=size/2,cos_alpha=Math.cos(alpha),sin_alpha=Math.sin(alpha),cot_alpha=1/Math.tan(alpha),phi=start+alpha,cos_phi=Math.cos(phi),sin_phi=Math.sin(phi),lambda=(4-cos_alpha)/3,mu=sin_alpha+(cos_alpha-lambda)*cot_alpha;return{ax:Math.cos(start).toFixed(7),ay:Math.sin(start).toFixed(7),bx:(lambda*cos_phi+mu*sin_phi).toFixed(7),by:(lambda*sin_phi-mu*cos_phi).toFixed(7),cx:(lambda*cos_phi-mu*sin_phi).toFixed(7),cy:(lambda*sin_phi+mu*cos_phi).toFixed(7),dx:Math.cos(start+size).toFixed(7),dy:Math.sin(start+size).toFixed(7)}}},{key:"arc",value:function arc(x,y,w,h,start,stop,mode){var ctx=this.drawingContext;var rx=w/2;var ry=h/2;var epsilon=1e-5;var arcToDraw=0;var curves=[];x+=rx;y+=ry;while(stop-start>=epsilon){arcToDraw=Math.min(stop-start,constants.HALF_PI);curves.push(this._acuteArcToBezier(start,arcToDraw));start+=arcToDraw}if(this._doFill){if(!this._clipping)ctx.beginPath();curves.forEach(function(curve,index){if(index===0){ctx.moveTo(x+curve.ax*rx,y+curve.ay*ry)}ctx.bezierCurveTo(x+curve.bx*rx,y+curve.by*ry,x+curve.cx*rx,y+curve.cy*ry,x+curve.dx*rx,y+curve.dy*ry)});if(mode===constants.PIE||mode==null){ctx.lineTo(x,y)}ctx.closePath();if(!this._clipping)ctx.fill()}if(this._doStroke){if(!this._clipping)ctx.beginPath();curves.forEach(function(curve,index){if(index===0){ctx.moveTo(x+curve.ax*rx,y+curve.ay*ry)}ctx.bezierCurveTo(x+curve.bx*rx,y+curve.by*ry,x+curve.cx*rx,y+curve.cy*ry,x+curve.dx*rx,y+curve.dy*ry)});if(mode===constants.PIE){ctx.lineTo(x,y);ctx.closePath()}else if(mode===constants.CHORD){ctx.closePath()}if(!this._clipping)ctx.stroke()}return this}},{key:"ellipse",value:function ellipse(args){var ctx=this.drawingContext;var doFill=this._doFill,doStroke=this._doStroke;var x=parseFloat(args[0]),y=parseFloat(args[1]),w=parseFloat(args[2]),h=parseFloat(args[3]);if(doFill&&!doStroke){if(this._getFill()===styleEmpty){return this}}else if(!doFill&&doStroke){if(this._getStroke()===styleEmpty){return this}}var kappa=.5522847498,ox=w/2*kappa,oy=h/2*kappa,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;if(!this._clipping)ctx.beginPath();ctx.moveTo(x,ym);ctx.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y);ctx.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym);ctx.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye);ctx.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym);if(!this._clipping&&doFill){ctx.fill()}if(!this._clipping&&doStroke){ctx.stroke()}}},{key:"line",value:function line(x1,y1,x2,y2){var ctx=this.drawingContext;if(!this._doStroke){return this}else if(this._getStroke()===styleEmpty){return this}if(!this._clipping)ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();return this}},{key:"point",value:function point(x,y){var ctx=this.drawingContext;if(!this._doStroke){return this}else if(this._getStroke()===styleEmpty){return this}var s=this._getStroke();var f=this._getFill();if(!this._clipping){this._setFill(s)}if(!this._clipping)ctx.beginPath();ctx.arc(x,y,ctx.lineWidth/2,0,constants.TWO_PI,false);if(!this._clipping){ctx.fill();this._setFill(f)}}},{key:"quad",value:function quad(x1,y1,x2,y2,x3,y3,x4,y4){var ctx=this.drawingContext;var doFill=this._doFill,doStroke=this._doStroke;if(doFill&&!doStroke){if(this._getFill()===styleEmpty){return this}}else if(!doFill&&doStroke){if(this._getStroke()===styleEmpty){return this}}if(!this._clipping)ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.lineTo(x3,y3);ctx.lineTo(x4,y4);ctx.closePath();if(!this._clipping&&doFill){ctx.fill()}if(!this._clipping&&doStroke){ctx.stroke()}return this}},{key:"rect",value:function rect(args){var x=args[0];var y=args[1];var w=args[2];var h=args[3];var tl=args[4];var tr=args[5];var br=args[6];var bl=args[7];var ctx=this.drawingContext;var doFill=this._doFill,doStroke=this._doStroke;if(doFill&&!doStroke){if(this._getFill()===styleEmpty){return this}}else if(!doFill&&doStroke){if(this._getStroke()===styleEmpty){return this}}if(!this._clipping)ctx.beginPath();if(typeof tl==="undefined"){ctx.rect(x,y,w,h)}else{if(typeof tr==="undefined"){tr=tl}if(typeof br==="undefined"){br=tr}if(typeof bl==="undefined"){bl=br}var absW=Math.abs(w);var absH=Math.abs(h);var hw=absW/2;var hh=absH/2;if(absW<2*tl){tl=hw}if(absH<2*tl){tl=hh}if(absW<2*tr){tr=hw}if(absH<2*tr){tr=hh}if(absW<2*br){br=hw}if(absH<2*br){br=hh}if(absW<2*bl){bl=hw}if(absH<2*bl){bl=hh}if(!this._clipping)ctx.beginPath();ctx.moveTo(x+tl,y);ctx.arcTo(x+w,y,x+w,y+h,tr);ctx.arcTo(x+w,y+h,x,y+h,br);ctx.arcTo(x,y+h,x,y,bl);ctx.arcTo(x,y,x+w,y,tl);ctx.closePath()}if(!this._clipping&&this._doFill){ctx.fill()}if(!this._clipping&&this._doStroke){ctx.stroke()}return this}},{key:"triangle",value:function triangle(args){var ctx=this.drawingContext;var doFill=this._doFill,doStroke=this._doStroke;var x1=args[0],y1=args[1];var x2=args[2],y2=args[3];var x3=args[4],y3=args[5];if(doFill&&!doStroke){if(this._getFill()===styleEmpty){return this}}else if(!doFill&&doStroke){if(this._getStroke()===styleEmpty){return this}}if(!this._clipping)ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.lineTo(x3,y3);ctx.closePath();if(!this._clipping&&doFill){ctx.fill()}if(!this._clipping&&doStroke){ctx.stroke()}}},{key:"endShape",value:function endShape(mode,vertices,isCurve,isBezier,isQuadratic,isContour,shapeKind){if(vertices.length===0){return this}if(!this._doStroke&&!this._doFill){return this}var closeShape=mode===constants.CLOSE;var v;if(closeShape&&!isContour){vertices.push(vertices[0])}var i,j;var numVerts=vertices.length;if(isCurve&&shapeKind===null){if(numVerts>3){var b=[],s=1-this._curveTightness;if(!this._clipping)this.drawingContext.beginPath();this.drawingContext.moveTo(vertices[1][0],vertices[1][1]);for(i=1;i+2<numVerts;i++){v=vertices[i];b[0]=[v[0],v[1]];b[1]=[v[0]+(s*vertices[i+1][0]-s*vertices[i-1][0])/6,v[1]+(s*vertices[i+1][1]-s*vertices[i-1][1])/6];b[2]=[vertices[i+1][0]+(s*vertices[i][0]-s*vertices[i+2][0])/6,vertices[i+1][1]+(s*vertices[i][1]-s*vertices[i+2][1])/6];b[3]=[vertices[i+1][0],vertices[i+1][1]];this.drawingContext.bezierCurveTo(b[1][0],b[1][1],b[2][0],b[2][1],b[3][0],b[3][1])}if(closeShape){this.drawingContext.lineTo(vertices[i+1][0],vertices[i+1][1])}this._doFillStrokeClose(closeShape)}}else if(isBezier&&shapeKind===null){if(!this._clipping)this.drawingContext.beginPath();for(i=0;i<numVerts;i++){if(vertices[i].isVert){if(vertices[i].moveTo){this.drawingContext.moveTo(vertices[i][0],vertices[i][1])}else{this.drawingContext.lineTo(vertices[i][0],vertices[i][1])}}else{this.drawingContext.bezierCurveTo(vertices[i][0],vertices[i][1],vertices[i][2],vertices[i][3],vertices[i][4],vertices[i][5])}}this._doFillStrokeClose(closeShape)}else if(isQuadratic&&shapeKind===null){if(!this._clipping)this.drawingContext.beginPath();for(i=0;i<numVerts;i++){if(vertices[i].isVert){if(vertices[i].moveTo){this.drawingContext.moveTo(vertices[i][0],vertices[i][1])}else{this.drawingContext.lineTo(vertices[i][0],vertices[i][1])}}else{this.drawingContext.quadraticCurveTo(vertices[i][0],vertices[i][1],vertices[i][2],vertices[i][3])}}this._doFillStrokeClose(closeShape)}else{if(shapeKind===constants.POINTS){for(i=0;i<numVerts;i++){v=vertices[i];if(this._doStroke){this._pInst.stroke(v[6])}this._pInst.point(v[0],v[1])}}else if(shapeKind===constants.LINES){for(i=0;i+1<numVerts;i+=2){v=vertices[i];if(this._doStroke){this._pInst.stroke(vertices[i+1][6])}this._pInst.line(v[0],v[1],vertices[i+1][0],vertices[i+1][1])}}else if(shapeKind===constants.TRIANGLES){for(i=0;i+2<numVerts;i+=3){v=vertices[i];if(!this._clipping)this.drawingContext.beginPath();this.drawingContext.moveTo(v[0],v[1]);this.drawingContext.lineTo(vertices[i+1][0],vertices[i+1][1]);this.drawingContext.lineTo(vertices[i+2][0],vertices[i+2][1]);this.drawingContext.closePath();if(!this._clipping&&this._doFill){this._pInst.fill(vertices[i+2][5]);this.drawingContext.fill()}if(!this._clipping&&this._doStroke){this._pInst.stroke(vertices[i+2][6]);this.drawingContext.stroke()}}}else if(shapeKind===constants.TRIANGLE_STRIP){for(i=0;i+1<numVerts;i++){v=vertices[i];if(!this._clipping)this.drawingContext.beginPath();this.drawingContext.moveTo(vertices[i+1][0],vertices[i+1][1]);this.drawingContext.lineTo(v[0],v[1]);if(!this._clipping&&this._doStroke){this._pInst.stroke(vertices[i+1][6])}if(!this._clipping&&this._doFill){this._pInst.fill(vertices[i+1][5])}if(i+2<numVerts){this.drawingContext.lineTo(vertices[i+2][0],vertices[i+2][1]);if(!this._clipping&&this._doStroke){this._pInst.stroke(vertices[i+2][6])}if(!this._clipping&&this._doFill){this._pInst.fill(vertices[i+2][5])}}this._doFillStrokeClose(closeShape)}}else if(shapeKind===constants.TRIANGLE_FAN){if(numVerts>2){if(!this._clipping)this.drawingContext.beginPath();for(i=2;i<numVerts;i++){v=vertices[i];this.drawingContext.moveTo(vertices[0][0],vertices[0][1]);this.drawingContext.lineTo(vertices[i-1][0],vertices[i-1][1]);this.drawingContext.lineTo(v[0],v[1]);this.drawingContext.lineTo(vertices[0][0],vertices[0][1]);if(i<numVerts-1){if(this._doFill&&v[5]!==vertices[i+1][5]||this._doStroke&&v[6]!==vertices[i+1][6]){if(!this._clipping&&this._doFill){this._pInst.fill(v[5]);this.drawingContext.fill();this._pInst.fill(vertices[i+1][5])}if(!this._clipping&&this._doStroke){this._pInst.stroke(v[6]);this.drawingContext.stroke();this._pInst.stroke(vertices[i+1][6])}this.drawingContext.closePath();if(!this._clipping)this.drawingContext.beginPath()}}}this._doFillStrokeClose(closeShape)}}else if(shapeKind===constants.QUADS){for(i=0;i+3<numVerts;i+=4){v=vertices[i];if(!this._clipping)this.drawingContext.beginPath();this.drawingContext.moveTo(v[0],v[1]);for(j=1;j<4;j++){this.drawingContext.lineTo(vertices[i+j][0],vertices[i+j][1])}this.drawingContext.lineTo(v[0],v[1]);if(!this._clipping&&this._doFill){this._pInst.fill(vertices[i+3][5])}if(!this._clipping&&this._doStroke){this._pInst.stroke(vertices[i+3][6])}this._doFillStrokeClose(closeShape)}}else if(shapeKind===constants.QUAD_STRIP){if(numVerts>3){for(i=0;i+1<numVerts;i+=2){v=vertices[i];if(!this._clipping)this.drawingContext.beginPath();if(i+3<numVerts){this.drawingContext.moveTo(vertices[i+2][0],vertices[i+2][1]);this.drawingContext.lineTo(v[0],v[1]);this.drawingContext.lineTo(vertices[i+1][0],vertices[i+1][1]);this.drawingContext.lineTo(vertices[i+3][0],vertices[i+3][1]);if(!this._clipping&&this._doFill){this._pInst.fill(vertices[i+3][5])}if(!this._clipping&&this._doStroke){this._pInst.stroke(vertices[i+3][6])}}else{this.drawingContext.moveTo(v[0],v[1]);this.drawingContext.lineTo(vertices[i+1][0],vertices[i+1][1])}this._doFillStrokeClose(closeShape)}}}else{if(!this._clipping)this.drawingContext.beginPath();this.drawingContext.moveTo(vertices[0][0],vertices[0][1]);for(i=1;i<numVerts;i++){v=vertices[i];if(v.isVert){if(v.moveTo){if(closeShape)this.drawingContext.closePath();this.drawingContext.moveTo(v[0],v[1])}else{this.drawingContext.lineTo(v[0],v[1])}}}this._doFillStrokeClose(closeShape)}}isCurve=false;isBezier=false;isQuadratic=false;isContour=false;if(closeShape){vertices.pop()}return this}},{key:"strokeCap",value:function strokeCap(cap){if(cap===constants.ROUND||cap===constants.SQUARE||cap===constants.PROJECT){this.drawingContext.lineCap=cap}return this}},{key:"strokeJoin",value:function strokeJoin(join){if(join===constants.ROUND||join===constants.BEVEL||join===constants.MITER){this.drawingContext.lineJoin=join}return this}},{key:"strokeWeight",value:function strokeWeight(w){if(typeof w==="undefined"||w===0){this.drawingContext.lineWidth=1e-4}else{this.drawingContext.lineWidth=w}return this}},{key:"_getFill",value:function _getFill(){if(!this._cachedFillStyle){this._cachedFillStyle=this.drawingContext.fillStyle}return this._cachedFillStyle}},{key:"_setFill",value:function _setFill(fillStyle){if(fillStyle!==this._cachedFillStyle){this.drawingContext.fillStyle=fillStyle;this._cachedFillStyle=fillStyle}}},{key:"_getStroke",value:function _getStroke(){if(!this._cachedStrokeStyle){this._cachedStrokeStyle=this.drawingContext.strokeStyle}return this._cachedStrokeStyle}},{key:"_setStroke",value:function _setStroke(strokeStyle){if(strokeStyle!==this._cachedStrokeStyle){this.drawingContext.strokeStyle=strokeStyle;this._cachedStrokeStyle=strokeStyle}}},{key:"bezier",value:function bezier(x1,y1,x2,y2,x3,y3,x4,y4){this._pInst.beginShape();this._pInst.vertex(x1,y1);this._pInst.bezierVertex(x2,y2,x3,y3,x4,y4);this._pInst.endShape();return this}},{key:"curve",value:function curve(x1,y1,x2,y2,x3,y3,x4,y4){this._pInst.beginShape();this._pInst.curveVertex(x1,y1);this._pInst.curveVertex(x2,y2);this._pInst.curveVertex(x3,y3);this._pInst.curveVertex(x4,y4);this._pInst.endShape();return this}},{key:"_doFillStrokeClose",value:function _doFillStrokeClose(closeShape){if(closeShape){this.drawingContext.closePath()}if(!this._clipping&&this._doFill){this.drawingContext.fill()}if(!this._clipping&&this._doStroke){this.drawingContext.stroke()}}},{key:"applyMatrix",value:function applyMatrix(a,b,c,d,e,f){this.drawingContext.transform(a,b,c,d,e,f)}},{key:"resetMatrix",value:function resetMatrix(){this.drawingContext.setTransform(1,0,0,1,0,0);this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity);return this}},{key:"rotate",value:function rotate(rad){this.drawingContext.rotate(rad)}},{key:"scale",value:function scale(x,y){this.drawingContext.scale(x,y);return this}},{key:"translate",value:function translate(x,y){if(x instanceof _main.default.Vector){y=x.y;x=x.x}this.drawingContext.translate(x,y);return this}},{key:"_renderText",value:function _renderText(p,line,x,y,maxY,minY){if(y<minY||y>=maxY){return}p.push();if(!this._isOpenType()){if(this._doStroke&&this._strokeSet){this.drawingContext.strokeText(line,x,y)}if(!this._clipping&&this._doFill){if(!this._fillSet){this._setFill(constants._DEFAULT_TEXT_FILL)}this.drawingContext.fillText(line,x,y)}}else{this._textFont._renderPath(line,x,y,{renderer:this})}p.pop();return p}},{key:"textWidth",value:function textWidth(s){if(this._isOpenType()){return this._textFont._textWidth(s,this._textSize)}return this.drawingContext.measureText(s).width}},{key:"_applyTextProperties",value:function _applyTextProperties(){var font;var p=this._pInst;this._setProperty("_textAscent",null);this._setProperty("_textDescent",null);font=this._textFont;if(this._isOpenType()){font=this._textFont.font.familyName;this._setProperty("_textStyle",this._textFont.font.styleName)}this.drawingContext.font="".concat(this._textStyle||"normal"," ").concat(this._textSize||12,"px ").concat(font||"sans-serif");this.drawingContext.textAlign=this._textAlign;if(this._textBaseline===constants.CENTER){this.drawingContext.textBaseline=constants._CTX_MIDDLE}else{this.drawingContext.textBaseline=this._textBaseline}return p}},{key:"push",value:function push(){this.drawingContext.save();return _get(_getPrototypeOf(Renderer2D.prototype),"push",this).call(this)}},{key:"pop",value:function pop(style){this.drawingContext.restore();this._cachedFillStyle=this.drawingContext.fillStyle;this._cachedStrokeStyle=this.drawingContext.strokeStyle;_get(_getPrototypeOf(Renderer2D.prototype),"pop",this).call(this,style)}}]);return Renderer2D}(_main.default.Renderer);Renderer2D.prototype.text=function(str,x,y,maxWidth,maxHeight){var baselineHacked;if(typeof maxWidth!=="undefined"){if(this.drawingContext.textBaseline===constants.BASELINE){baselineHacked=true;this.drawingContext.textBaseline=constants.TOP}}var p=_main.default.Renderer.prototype.text.apply(this,arguments);if(baselineHacked){this.drawingContext.textBaseline=constants.BASELINE}return p};_main.default.Renderer2D=Renderer2D;var _default=_main.default.Renderer2D;exports.default=_default},{"./constants":286,"./main":298,"./p5.Renderer":301,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.fill":172,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.join":180,"core-js/modules/es.array.slice":183,"core-js/modules/es.function.name":186,"core-js/modules/es.number.to-fixed":193,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.to-string":200,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.reflect.get":203,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],303:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");var _main=_interopRequireDefault(_dereq_("./main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype._promisePreloads=[];_main.default.prototype.registerPromisePreload=function(setup){_main.default.prototype._promisePreloads.push(setup)};var initialSetupRan=false;_main.default.prototype._setupPromisePreloads=function(){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this._promisePreloads[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var preloadSetup=_step.value;var thisValue=this;var method=preloadSetup.method,addCallbacks=preloadSetup.addCallbacks,legacyPreloadSetup=preloadSetup.legacyPreloadSetup;var target=preloadSetup.target||this;var sourceFunction=target[method].bind(target);if(target===_main.default.prototype){if(initialSetupRan){continue}thisValue=null;sourceFunction=target[method]}target[method]=this._wrapPromisePreload(thisValue,sourceFunction,addCallbacks);if(legacyPreloadSetup){var legacyMethod=legacyPreloadSetup.method;target[legacyMethod]=this._legacyPreloadGenerator(thisValue,legacyPreloadSetup,target[method])}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}initialSetupRan=true};_main.default.prototype._wrapPromisePreload=function(thisValue,fn,addCallbacks){var replacementFunction=function replacementFunction(){var _this=this;this._incrementPreload();var callback=null;var errorCallback=null;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}if(addCallbacks){for(var i=args.length-1;i>=0&&!errorCallback;i--){if(typeof args[i]!=="function"){break}errorCallback=callback;callback=args.pop()}}var promise=Promise.resolve(fn.apply(this,args));if(callback){promise.then(callback)}if(errorCallback){promise.catch(errorCallback)}promise.then(function(){return _this._decrementPreload()});return promise};if(thisValue){replacementFunction=replacementFunction.bind(thisValue)}return replacementFunction};var objectCreator=function objectCreator(){return{}};_main.default.prototype._legacyPreloadGenerator=function(thisValue,legacyPreloadSetup,fn){var baseValueGenerator=legacyPreloadSetup.createBaseObject||objectCreator;var returnedFunction=function returnedFunction(){var _this2=this;this._incrementPreload();for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}var returnValue=baseValueGenerator.apply(this,args);fn.apply(this,args).then(function(data){Object.assign(returnValue,data);_this2._decrementPreload()});return returnValue};if(thisValue){returnedFunction=returnedFunction.bind(thisValue)}return returnedFunction}},{"./main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.assign":194,"core-js/modules/es.object.to-string":200,"core-js/modules/es.promise":201,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.iterator":256}],304:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("./main"));var constants=_interopRequireWildcard(_dereq_("./constants"));_dereq_("./p5.Graphics");_dereq_("./p5.Renderer2D");_dereq_("../webgl/p5.RendererGL");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}var defaultId="defaultCanvas0";var defaultClass="p5Canvas";_main.default.prototype.createCanvas=function(w,h,renderer,canvas){_main.default._validateParameters("createCanvas",arguments);var r;if(arguments[2]instanceof HTMLCanvasElement){renderer=constants.P2D;canvas=arguments[2]}else{r=renderer||constants.P2D}var c;if(canvas){c=document.getElementById(defaultId);if(c){c.parentNode.removeChild(c)}c=canvas;this._defaultGraphicsCreated=false}else{if(r===constants.WEBGL){c=document.getElementById(defaultId);if(c){c.parentNode.removeChild(c);var thisRenderer=this._renderer;this._elements=this._elements.filter(function(e){return e!==thisRenderer})}c=document.createElement("canvas");c.id=defaultId;c.classList.add(defaultClass)}else{if(!this._defaultGraphicsCreated){if(canvas){c=canvas}else{c=document.createElement("canvas")}var i=0;while(document.getElementById("defaultCanvas".concat(i))){i++}defaultId="defaultCanvas".concat(i);c.id=defaultId;c.classList.add(defaultClass)}else{c=this.canvas}}if(!this._setupDone){c.dataset.hidden=true;c.style.visibility="hidden"}if(this._userNode){this._userNode.appendChild(c)}else{if(document.getElementsByTagName("main").length===0){var m=document.createElement("main");document.body.appendChild(m)}document.getElementsByTagName("main")[0].appendChild(c)}}if(r===constants.WEBGL){this._setProperty("_renderer",new _main.default.RendererGL(c,this,true));this._elements.push(this._renderer)}else{if(!this._defaultGraphicsCreated){this._setProperty("_renderer",new _main.default.Renderer2D(c,this,true));this._defaultGraphicsCreated=true;this._elements.push(this._renderer)}}this._renderer.resize(w,h);this._renderer._applyDefaults();return this._renderer};_main.default.prototype.resizeCanvas=function(w,h,noRedraw){_main.default._validateParameters("resizeCanvas",arguments);if(this._renderer){var props={};for(var key in this.drawingContext){var val=this.drawingContext[key];if(_typeof(val)!=="object"&&typeof val!=="function"){props[key]=val}}this.width=w;this.height=h;this._renderer.resize(w,h);for(var savedKey in props){try{this.drawingContext[savedKey]=props[savedKey]}catch(err){}}if(!noRedraw){this.redraw()}}if(this._addAccsOutput()){this._updateAccsOutput()}};_main.default.prototype.noCanvas=function(){if(this.canvas){this.canvas.parentNode.removeChild(this.canvas)}};_main.default.prototype.createGraphics=function(w,h){for(var _len=arguments.length,args=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){args[_key-2]=arguments[_key]}if(args[0]instanceof HTMLCanvasElement){args[1]=args[0];args[0]=constants.P2D}_main.default._validateParameters("createGraphics",arguments);return new _main.default.Graphics(w,h,args[0],this,args[1])};_main.default.prototype.createFramebuffer=function(options){return new _main.default.Framebuffer(this,options)};_main.default.prototype.blendMode=function(mode){_main.default._validateParameters("blendMode",arguments);if(mode===constants.NORMAL){console.warn("NORMAL has been deprecated for use in blendMode. defaulting to BLEND instead.");mode=constants.BLEND}this._renderer.blendMode(mode)};var _default=_main.default;exports.default=_default},{"../webgl/p5.RendererGL":355,"./constants":286,"./main":298,"./p5.Graphics":300,"./p5.Renderer2D":302,"core-js/modules/es.array.filter":173,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],305:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.slice");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../main"));var constants=_interopRequireWildcard(_dereq_("../constants"));var _helpers=_interopRequireDefault(_dereq_("../helpers"));_dereq_("../friendly_errors/fes_core");_dereq_("../friendly_errors/file_errors");_dereq_("../friendly_errors/validate_params");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}_main.default.prototype._normalizeArcAngles=function(start,stop,width,height,correctForScaling){var epsilon=1e-5;var separation;start=start-constants.TWO_PI*Math.floor(start/constants.TWO_PI);stop=stop-constants.TWO_PI*Math.floor(stop/constants.TWO_PI);separation=Math.min(Math.abs(start-stop),constants.TWO_PI-Math.abs(start-stop));if(correctForScaling){if(start<=constants.HALF_PI){start=Math.atan(width/height*Math.tan(start))}else if(start>constants.HALF_PI&&start<=3*constants.HALF_PI){start=Math.atan(width/height*Math.tan(start))+constants.PI}else{start=Math.atan(width/height*Math.tan(start))+constants.TWO_PI}if(stop<=constants.HALF_PI){stop=Math.atan(width/height*Math.tan(stop))}else if(stop>constants.HALF_PI&&stop<=3*constants.HALF_PI){stop=Math.atan(width/height*Math.tan(stop))+constants.PI}else{stop=Math.atan(width/height*Math.tan(stop))+constants.TWO_PI}}if(start>stop){stop+=constants.TWO_PI}return{start:start,stop:stop,correspondToSamePoint:separation<epsilon}};_main.default.prototype.arc=function(x,y,w,h,start,stop,mode,detail){_main.default._validateParameters("arc",arguments);if(!this._renderer._doStroke&&!this._renderer._doFill){return this}if(start===stop){return this}start=this._toRadians(start);stop=this._toRadians(stop);w=Math.abs(w);h=Math.abs(h);var vals=_helpers.default.modeAdjust(x,y,w,h,this._renderer._ellipseMode);var angles=this._normalizeArcAngles(start,stop,vals.w,vals.h,true);if(angles.correspondToSamePoint){this._renderer.ellipse([vals.x,vals.y,vals.w,vals.h,detail])}else{this._renderer.arc(vals.x,vals.y,vals.w,vals.h,angles.start,angles.stop,mode,detail);if(this._accessibleOutputs.grid||this._accessibleOutputs.text){this._accsOutput("arc",[vals.x,vals.y,vals.w,vals.h,angles.start,angles.stop,mode])}}return this};_main.default.prototype.ellipse=function(x,y,w,h,detailX){_main.default._validateParameters("ellipse",arguments);return this._renderEllipse.apply(this,arguments)};_main.default.prototype.circle=function(){_main.default._validateParameters("circle",arguments);var args=Array.prototype.slice.call(arguments,0,2);args.push(arguments[2]);args.push(arguments[2]);return this._renderEllipse.apply(this,_toConsumableArray(args))};_main.default.prototype._renderEllipse=function(x,y,w,h,detailX){if(!this._renderer._doStroke&&!this._renderer._doFill){return this}if(w<0){w=Math.abs(w)}if(typeof h==="undefined"){h=w}else if(h<0){h=Math.abs(h)}var vals=_helpers.default.modeAdjust(x,y,w,h,this._renderer._ellipseMode);this._renderer.ellipse([vals.x,vals.y,vals.w,vals.h,detailX]);if(this._accessibleOutputs.grid||this._accessibleOutputs.text){this._accsOutput("ellipse",[vals.x,vals.y,vals.w,vals.h])}return this};_main.default.prototype.line=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("line",args);if(this._renderer._doStroke){var _this$_renderer;(_this$_renderer=this._renderer).line.apply(_this$_renderer,args)}if(this._accessibleOutputs.grid||this._accessibleOutputs.text){this._accsOutput("line",args)}return this};_main.default.prototype.point=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default._validateParameters("point",args);if(this._renderer._doStroke){if(args.length===1&&args[0]instanceof _main.default.Vector){this._renderer.point.call(this._renderer,args[0].x,args[0].y,args[0].z)}else{var _this$_renderer2;(_this$_renderer2=this._renderer).point.apply(_this$_renderer2,args);if(this._accessibleOutputs.grid||this._accessibleOutputs.text){this._accsOutput("point",args)}}}return this};_main.default.prototype.quad=function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}_main.default._validateParameters("quad",args);if(this._renderer._doStroke||this._renderer._doFill){if(this._renderer.isP3D&&args.length<12){this._renderer.quad.call(this._renderer,args[0],args[1],0,args[2],args[3],0,args[4],args[5],0,args[6],args[7],0,args[8],args[9])}else{var _this$_renderer3;(_this$_renderer3=this._renderer).quad.apply(_this$_renderer3,args);if(this._accessibleOutputs.grid||this._accessibleOutputs.text){this._accsOutput("quadrilateral",args)}}}return this};_main.default.prototype.rect=function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}_main.default._validateParameters("rect",args);return this._renderRect.apply(this,args)};_main.default.prototype.square=function(x,y,s,tl,tr,br,bl){_main.default._validateParameters("square",arguments);return this._renderRect.call(this,x,y,s,s,tl,tr,br,bl)};_main.default.prototype._renderRect=function(){if(this._renderer._doStroke||this._renderer._doFill){if(arguments.length===3){arguments[3]=arguments[2]}var vals=_helpers.default.modeAdjust(arguments[0],arguments[1],arguments[2],arguments[3],this._renderer._rectMode);var args=[vals.x,vals.y,vals.w,vals.h];for(var i=4;i<arguments.length;i++){args[i]=arguments[i]}this._renderer.rect(args);if(this._accessibleOutputs.grid||this._accessibleOutputs.text){this._accsOutput("rectangle",[vals.x,vals.y,vals.w,vals.h])}}return this};_main.default.prototype.triangle=function(){for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}_main.default._validateParameters("triangle",args);if(this._renderer._doStroke||this._renderer._doFill){this._renderer.triangle(args)}if(this._accessibleOutputs.grid||this._accessibleOutputs.text){this._accsOutput("triangle",args)}return this};var _default=_main.default;exports.default=_default},{"../constants":286,"../friendly_errors/fes_core":289,"../friendly_errors/file_errors":290,"../friendly_errors/validate_params":293,"../helpers":294,"../main":298,"core-js/modules/es.array.from":176,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],306:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../main"));var constants=_interopRequireWildcard(_dereq_("../constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.ellipseMode=function(m){_main.default._validateParameters("ellipseMode",arguments);if(m===constants.CORNER||m===constants.CORNERS||m===constants.RADIUS||m===constants.CENTER){this._renderer._ellipseMode=m}return this};_main.default.prototype.noSmooth=function(){if(!this._renderer.isP3D){if("imageSmoothingEnabled"in this.drawingContext){this.drawingContext.imageSmoothingEnabled=false}}else{this.setAttributes("antialias",false)}return this};_main.default.prototype.rectMode=function(m){_main.default._validateParameters("rectMode",arguments);if(m===constants.CORNER||m===constants.CORNERS||m===constants.RADIUS||m===constants.CENTER){this._renderer._rectMode=m}return this};_main.default.prototype.smooth=function(){this.setAttributes("antialias",true);if(!this._renderer.isP3D){if("imageSmoothingEnabled"in this.drawingContext){this.drawingContext.imageSmoothingEnabled=true}}return this};_main.default.prototype.strokeCap=function(cap){_main.default._validateParameters("strokeCap",arguments);if(cap===constants.ROUND||cap===constants.SQUARE||cap===constants.PROJECT){this._renderer.strokeCap(cap)}return this};_main.default.prototype.strokeJoin=function(join){_main.default._validateParameters("strokeJoin",arguments);if(join===constants.ROUND||join===constants.BEVEL||join===constants.MITER){this._renderer.strokeJoin(join)}return this};_main.default.prototype.strokeWeight=function(w){_main.default._validateParameters("strokeWeight",arguments);this._renderer.strokeWeight(w);return this};var _default=_main.default;exports.default=_default},{"../constants":286,"../main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],307:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../main"));_dereq_("../friendly_errors/fes_core");_dereq_("../friendly_errors/file_errors");_dereq_("../friendly_errors/validate_params");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.bezier=function(){var _this$_renderer;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("bezier",args);if(!this._renderer._doStroke&&!this._renderer._doFill){return this}(_this$_renderer=this._renderer).bezier.apply(_this$_renderer,args);return this};_main.default.prototype.bezierDetail=function(d){_main.default._validateParameters("bezierDetail",arguments);this._bezierDetail=d;return this};_main.default.prototype.bezierPoint=function(a,b,c,d,t){_main.default._validateParameters("bezierPoint",arguments);var adjustedT=1-t;return Math.pow(adjustedT,3)*a+3*Math.pow(adjustedT,2)*t*b+3*adjustedT*Math.pow(t,2)*c+Math.pow(t,3)*d};_main.default.prototype.bezierTangent=function(a,b,c,d,t){_main.default._validateParameters("bezierTangent",arguments);var adjustedT=1-t;return 3*d*Math.pow(t,2)-3*c*Math.pow(t,2)+6*c*adjustedT*t-6*b*adjustedT*t+3*b*Math.pow(adjustedT,2)-3*a*Math.pow(adjustedT,2)};_main.default.prototype.curve=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default._validateParameters("curve",args);if(this._renderer._doStroke){var _this$_renderer2;(_this$_renderer2=this._renderer).curve.apply(_this$_renderer2,args)}return this};_main.default.prototype.curveDetail=function(d){_main.default._validateParameters("curveDetail",arguments);if(d<3){this._curveDetail=3}else{this._curveDetail=d}return this};_main.default.prototype.curveTightness=function(t){_main.default._validateParameters("curveTightness",arguments);this._renderer._curveTightness=t;return this};_main.default.prototype.curvePoint=function(a,b,c,d,t){_main.default._validateParameters("curvePoint",arguments);var s=this._renderer._curveTightness,t3=t*t*t,t2=t*t,f1=(s-1)/2*t3+(1-s)*t2+(s-1)/2*t,f2=(s+3)/2*t3+(-5-s)/2*t2+1,f3=(-3-s)/2*t3+(s+2)*t2+(1-s)/2*t,f4=(1-s)/2*t3+(s-1)/2*t2;return a*f1+b*f2+c*f3+d*f4};_main.default.prototype.curveTangent=function(a,b,c,d,t){_main.default._validateParameters("curveTangent",arguments);var s=this._renderer._curveTightness,tt3=t*t*3,t2=t*2,f1=(s-1)/2*tt3+(1-s)*t2+(s-1)/2,f2=(s+3)/2*tt3+(-5-s)/2*t2,f3=(-3-s)/2*tt3+(s+2)*t2+(1-s)/2,f4=(1-s)/2*tt3+(s-1)/2*t2;return a*f1+b*f2+c*f3+d*f4};var _default=_main.default;exports.default=_default},{"../friendly_errors/fes_core":289,"../friendly_errors/file_errors":290,"../friendly_errors/validate_params":293,"../main":298}],308:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.slice");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../main"));var constants=_interopRequireWildcard(_dereq_("../constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var shapeKind=null;var vertices=[];var contourVertices=[];var isBezier=false;var isCurve=false;var isQuadratic=false;var isContour=false;var isFirstContour=true;_main.default.prototype.beginContour=function(){if(this._renderer.isP3D){this._renderer.beginContour()}else{contourVertices=[];isContour=true}return this};_main.default.prototype.beginShape=function(kind){_main.default._validateParameters("beginShape",arguments);if(this._renderer.isP3D){var _this$_renderer;(_this$_renderer=this._renderer).beginShape.apply(_this$_renderer,arguments)}else{if(kind===constants.POINTS||kind===constants.LINES||kind===constants.TRIANGLES||kind===constants.TRIANGLE_FAN||kind===constants.TRIANGLE_STRIP||kind===constants.QUADS||kind===constants.QUAD_STRIP){shapeKind=kind}else{shapeKind=null}vertices=[];contourVertices=[]}return this};_main.default.prototype.bezierVertex=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("bezierVertex",args);if(this._renderer.isP3D){var _this$_renderer2;(_this$_renderer2=this._renderer).bezierVertex.apply(_this$_renderer2,args)}else{if(vertices.length===0){_main.default._friendlyError("vertex() must be used once before calling bezierVertex()","bezierVertex")}else{isBezier=true;var vert=[];for(var i=0;i<args.length;i++){vert[i]=args[i]}vert.isVert=false;if(isContour){contourVertices.push(vert)}else{vertices.push(vert)}}}return this};_main.default.prototype.curveVertex=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default._validateParameters("curveVertex",args);if(this._renderer.isP3D){var _this$_renderer3;(_this$_renderer3=this._renderer).curveVertex.apply(_this$_renderer3,args)}else{isCurve=true;this.vertex(args[0],args[1])}return this};_main.default.prototype.endContour=function(){if(this._renderer.isP3D){return this}var vert=contourVertices[0].slice();vert.isVert=contourVertices[0].isVert;vert.moveTo=false;contourVertices.push(vert);if(isFirstContour){vertices.push(vertices[0]);isFirstContour=false}for(var i=0;i<contourVertices.length;i++){vertices.push(contourVertices[i])}return this};_main.default.prototype.endShape=function(mode){var count=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;_main.default._validateParameters("endShape",arguments);if(count<1){console.log("🌸 p5.js says: You can not have less than one instance");count=1}if(this._renderer.isP3D){this._renderer.endShape(mode,isCurve,isBezier,isQuadratic,isContour,shapeKind,count)}else{if(count!==1){console.log("🌸 p5.js says: Instancing is only supported in WebGL2 mode")}if(vertices.length===0){return this}if(!this._renderer._doStroke&&!this._renderer._doFill){return this}var closeShape=mode===constants.CLOSE;if(closeShape&&!isContour){vertices.push(vertices[0])}this._renderer.endShape(mode,vertices,isCurve,isBezier,isQuadratic,isContour,shapeKind);isCurve=false;isBezier=false;isQuadratic=false;isContour=false;isFirstContour=true;if(closeShape){vertices.pop()}}return this};_main.default.prototype.quadraticVertex=function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}_main.default._validateParameters("quadraticVertex",args);if(this._renderer.isP3D){var _this$_renderer4;(_this$_renderer4=this._renderer).quadraticVertex.apply(_this$_renderer4,args)}else{if(this._contourInited){var pt={};pt.x=args[0];pt.y=args[1];pt.x3=args[2];pt.y3=args[3];pt.type=constants.QUADRATIC;this._contourVertices.push(pt);return this}if(vertices.length>0){isQuadratic=true;var vert=[];for(var i=0;i<args.length;i++){vert[i]=args[i]}vert.isVert=false;if(isContour){contourVertices.push(vert)}else{vertices.push(vert)}}else{_main.default._friendlyError("vertex() must be used once before calling quadraticVertex()","quadraticVertex")}}return this};_main.default.prototype.vertex=function(x,y,moveTo,u,v){if(this._renderer.isP3D){var _this$_renderer5;(_this$_renderer5=this._renderer).vertex.apply(_this$_renderer5,arguments)}else{var vert=[];vert.isVert=true;vert[0]=x;vert[1]=y;vert[2]=0;vert[3]=0;vert[4]=0;vert[5]=this._renderer._getFill();vert[6]=this._renderer._getStroke();if(moveTo){vert.moveTo=moveTo}if(isContour){if(contourVertices.length===0){vert.moveTo=true}contourVertices.push(vert)}else{vertices.push(vert)}}return this};_main.default.prototype.normal=function(x,y,z){var _this$_renderer6;this._assert3d("normal");_main.default._validateParameters("normal",arguments);(_this$_renderer6=this._renderer).normal.apply(_this$_renderer6,arguments);return this};var _default=_main.default;exports.default=_default},{"../constants":286,"../main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],309:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.uint8-clamped-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.uint8-clamped-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/web.dom-collections.iterator");function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){window.setTimeout(callback,1e3/60)}}();(function(){if(typeof Uint8ClampedArray!=="undefined"&&!Uint8ClampedArray.prototype.slice){Object.defineProperty(Uint8ClampedArray.prototype,"slice",{value:Array.prototype.slice,writable:true,configurable:true,enumerable:false})}})();(function(){if(!Object.assign){var keys=Object.keys;var defineProperty=Object.defineProperty;var canBeObject=function canBeObject(obj){return typeof obj!=="undefined"&&obj!==null};var hasSymbols=typeof Symbol==="function"&&_typeof(Symbol())==="symbol";var propIsEnumerable=Object.prototype.propertyIsEnumerable;var isEnumerableOn=function isEnumerableOn(obj){return function isEnumerable(prop){return propIsEnumerable.call(obj,prop)}};var assignShim=function assign(target,source1){if(!canBeObject(target)){throw new TypeError("target must be an object")}var objTarget=Object(target);var s,source,i,props;for(s=1;s<arguments.length;++s){source=Object(arguments[s]);props=keys(source);if(hasSymbols&&Object.getOwnPropertySymbols){var _props;(_props=props).push.apply(_props,_toConsumableArray(Object.getOwnPropertySymbols(source).filter(isEnumerableOn(source))))}for(i=0;i<props.length;++i){objTarget[props[i]]=source[props[i]]}}return objTarget};defineProperty(Object,"assign",{value:assignShim,configurable:true,enumerable:false,writable:true})}})()},{"core-js/modules/es.array.filter":173,"core-js/modules/es.array.from":176,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.assign":194,"core-js/modules/es.object.keys":199,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint8-clamped-array":253,"core-js/modules/web.dom-collections.iterator":256}],310:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.assign");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("./main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.noLoop=function(){this._loop=false};_main.default.prototype.loop=function(){if(!this._loop){this._loop=true;if(this._setupDone){this._draw()}}};_main.default.prototype.isLooping=function(){return this._loop};_main.default.prototype.push=function(){this._styles.push({props:{_colorMode:this._colorMode},renderer:this._renderer.push()})};_main.default.prototype.pop=function(){var style=this._styles.pop();if(style){this._renderer.pop(style.renderer);Object.assign(this,style.props)}else{console.warn("pop() was called without matching push()")}};_main.default.prototype.redraw=function(n){if(this._inUserDraw||!this._setupDone){return}var numberOfRedraws=parseInt(n);if(isNaN(numberOfRedraws)||numberOfRedraws<1){numberOfRedraws=1}var context=this._isGlobal?window:this;if(typeof context.draw==="function"){if(typeof context.setup==="undefined"){context.scale(context._pixelDensity,context._pixelDensity)}for(var idxRedraw=0;idxRedraw<numberOfRedraws;idxRedraw++){context.resetMatrix();if(this._accessibleOutputs.grid||this._accessibleOutputs.text){this._updateAccsOutput()}if(context._renderer.isP3D){context._renderer._update()}context._setProperty("frameCount",context.frameCount+1);this.callRegisteredHooksFor("pre");this._inUserDraw=true;try{context.draw()}finally{this._inUserDraw=false}this.callRegisteredHooksFor("post")}}};var _default=_main.default;exports.default=_default},{"./main":298,"core-js/modules/es.object.assign":194}],311:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("./main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}_main.default.prototype.applyMatrix=function(){var isTypedArray=(arguments.length<=0?undefined:arguments[0])instanceof Object.getPrototypeOf(Uint8Array);if(Array.isArray(arguments.length<=0?undefined:arguments[0])||isTypedArray){var _this$_renderer;(_this$_renderer=this._renderer).applyMatrix.apply(_this$_renderer,_toConsumableArray(arguments.length<=0?undefined:arguments[0]))}else{var _this$_renderer2;(_this$_renderer2=this._renderer).applyMatrix.apply(_this$_renderer2,arguments)}return this};_main.default.prototype.resetMatrix=function(){this._renderer.resetMatrix();return this};_main.default.prototype.rotate=function(angle,axis){_main.default._validateParameters("rotate",arguments);this._renderer.rotate(this._toRadians(angle),axis);return this};_main.default.prototype.rotateX=function(angle){this._assert3d("rotateX");_main.default._validateParameters("rotateX",arguments);this._renderer.rotateX(this._toRadians(angle));return this};_main.default.prototype.rotateY=function(angle){this._assert3d("rotateY");_main.default._validateParameters("rotateY",arguments);this._renderer.rotateY(this._toRadians(angle));return this};_main.default.prototype.rotateZ=function(angle){this._assert3d("rotateZ");_main.default._validateParameters("rotateZ",arguments);this._renderer.rotateZ(this._toRadians(angle));return this};_main.default.prototype.scale=function(x,y,z){_main.default._validateParameters("scale",arguments);if(x instanceof _main.default.Vector){var v=x;x=v.x;y=v.y;z=v.z}else if(x instanceof Array){var rg=x;x=rg[0];y=rg[1];z=rg[2]||1}if(isNaN(y)){y=z=x}else if(isNaN(z)){z=1}this._renderer.scale.call(this._renderer,x,y,z);return this};_main.default.prototype.shearX=function(angle){_main.default._validateParameters("shearX",arguments);var rad=this._toRadians(angle);this._renderer.applyMatrix(1,0,Math.tan(rad),1,0,0);return this};_main.default.prototype.shearY=function(angle){_main.default._validateParameters("shearY",arguments);var rad=this._toRadians(angle);this._renderer.applyMatrix(1,Math.tan(rad),0,1,0,0);return this};_main.default.prototype.translate=function(x,y,z){_main.default._validateParameters("translate",arguments);if(this._renderer.isP3D){this._renderer.translate(x,y,z)}else{this._renderer.translate(x,y)}return this};var _default=_main.default;exports.default=_default},{"./main":298,"core-js/modules/es.array.from":176,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint8-array":252,"core-js/modules/web.dom-collections.iterator":256}],312:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.ends-with");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.ends-with");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_main.default.prototype.storeItem=function(key,value){if(typeof key!=="string"){console.log("The argument that you passed to storeItem() - ".concat(key," is not a string."))}if(key.endsWith("p5TypeID")){console.log("The argument that you passed to storeItem() - ".concat(key," must not end with 'p5TypeID'."))}if(typeof value==="undefined"){console.log("You cannot store undefined variables using storeItem().")}var type=_typeof(value);switch(type){case"number":case"boolean":value=value.toString();break;case"object":if(value instanceof _main.default.Color){type="p5.Color"}else if(value instanceof _main.default.Vector){type="p5.Vector";var coord=[value.x,value.y,value.z];value=coord}value=JSON.stringify(value);break;case"string":default:break}localStorage.setItem(key,value);var typeKey="".concat(key,"p5TypeID");localStorage.setItem(typeKey,type)};_main.default.prototype.getItem=function(key){var value=localStorage.getItem(key);var type=localStorage.getItem("".concat(key,"p5TypeID"));if(typeof type==="undefined"){console.log("Unable to determine type of item stored under ".concat(key,"in local storage. Did you save the item with something other than setItem()?"))}else if(value!==null){switch(type){case"number":value=parseFloat(value);break;case"boolean":value=value==="true";break;case"object":value=JSON.parse(value);break;case"p5.Color":value=JSON.parse(value);value=this.color.apply(this,_toConsumableArray(value.levels));break;case"p5.Vector":value=JSON.parse(value);value=this.createVector.apply(this,_toConsumableArray(value));break;case"string":default:break}}return value};_main.default.prototype.clearStorage=function(){localStorage.clear()};_main.default.prototype.removeItem=function(key){if(typeof key!=="string"){console.log("The argument that you passed to removeItem() - ".concat(key," is not a string."))}localStorage.removeItem(key);localStorage.removeItem("".concat(key,"p5TypeID"))}},{"../core/main":298,"core-js/modules/es.array.from":176,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.ends-with":208,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.iterator":256}],313:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.object.keys");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var Super=_getPrototypeOf(Derived),result;if(isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.prototype.createStringDict=function(key,value){_main.default._validateParameters("createStringDict",arguments);return new _main.default.StringDict(key,value)};_main.default.prototype.createNumberDict=function(key,value){_main.default._validateParameters("createNumberDict",arguments);return new _main.default.NumberDict(key,value)};_main.default.TypedDict=function(){function TypedDict(key,value){_classCallCheck(this,TypedDict);if(key instanceof Object){this.data=key}else{this.data={};this.data[key]=value}return this}_createClass(TypedDict,[{key:"size",value:function size(){return Object.keys(this.data).length}},{key:"hasKey",value:function hasKey(key){return this.data.hasOwnProperty(key)}},{key:"get",value:function get(key){if(this.data.hasOwnProperty(key)){return this.data[key]}else{console.log("".concat(key," does not exist in this Dictionary"))}}},{key:"set",value:function set(key,value){if(this._validate(value)){this.data[key]=value}else{console.log("Those values dont work for this dictionary type.")}}},{key:"_addObj",value:function _addObj(obj){for(var key in obj){this.set(key,obj[key])}}},{key:"create",value:function create(key,value){if(key instanceof Object&&typeof value==="undefined"){this._addObj(key)}else if(typeof key!=="undefined"){this.set(key,value)}else{console.log("In order to create a new Dictionary entry you must pass "+"an object or a key, value pair")}}},{key:"clear",value:function clear(){this.data={}}},{key:"remove",value:function remove(key){if(this.data.hasOwnProperty(key)){delete this.data[key]}else{throw new Error("".concat(key," does not exist in this Dictionary"))}}},{key:"print",value:function print(){for(var item in this.data){console.log("key:".concat(item," value:").concat(this.data[item]))}}},{key:"saveTable",value:function saveTable(filename){var output="";for(var key in this.data){output+="".concat(key,",").concat(this.data[key],"\n")}var blob=new Blob([output],{type:"text/csv"});_main.default.prototype.downloadFile(blob,filename||"mycsv","csv")}},{key:"saveJSON",value:function saveJSON(filename,opt){_main.default.prototype.saveJSON(this.data,filename,opt)}},{key:"_validate",value:function _validate(value){return true}}]);return TypedDict}();_main.default.StringDict=function(_p5$TypedDict){_inherits(StringDict,_p5$TypedDict);var _super=_createSuper(StringDict);function StringDict(){_classCallCheck(this,StringDict);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _super.call.apply(_super,[this].concat(args))}_createClass(StringDict,[{key:"_validate",value:function _validate(value){return typeof value==="string"}}]);return StringDict}(_main.default.TypedDict);_main.default.NumberDict=function(_p5$TypedDict2){_inherits(NumberDict,_p5$TypedDict2);var _super2=_createSuper(NumberDict);function NumberDict(){_classCallCheck(this,NumberDict);for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}return _super2.call.apply(_super2,[this].concat(args))}_createClass(NumberDict,[{key:"_validate",value:function _validate(value){return typeof value==="number"}},{key:"add",value:function add(key,amount){if(this.data.hasOwnProperty(key)){this.data[key]+=amount}else{console.log("The key - ".concat(key," does not exist in this dictionary."))}}},{key:"sub",value:function sub(key,amount){this.add(key,-amount)}},{key:"mult",value:function mult(key,amount){if(this.data.hasOwnProperty(key)){this.data[key]*=amount}else{console.log("The key - ".concat(key," does not exist in this dictionary."))}}},{key:"div",value:function div(key,amount){if(this.data.hasOwnProperty(key)){this.data[key]/=amount}else{console.log("The key - ".concat(key," does not exist in this dictionary."))}}},{key:"_valueTest",value:function _valueTest(flip){if(Object.keys(this.data).length===0){throw new Error("Unable to search for a minimum or maximum value on an empty NumberDict")}else if(Object.keys(this.data).length===1){return this.data[Object.keys(this.data)[0]]}else{var result=this.data[Object.keys(this.data)[0]];for(var key in this.data){if(this.data[key]*flip<result*flip){result=this.data[key]}}return result}}},{key:"minValue",value:function minValue(){return this._valueTest(1)}},{key:"maxValue",value:function maxValue(){return this._valueTest(-1)}},{key:"_keyTest",value:function _keyTest(flip){if(Object.keys(this.data).length===0){throw new Error("Unable to use minValue on an empty NumberDict")}else if(Object.keys(this.data).length===1){return Object.keys(this.data)[0]}else{var result=Object.keys(this.data)[0];for(var i=1;i<Object.keys(this.data).length;i++){if(Object.keys(this.data)[i]*flip<result*flip){result=Object.keys(this.data)[i]}}return result}}},{key:"minKey",value:function minKey(){return this._keyTest(1)}},{key:"maxKey",value:function maxKey(){return this._keyTest(-1)}}]);return NumberDict}(_main.default.TypedDict);var _default=_main.default.TypedDict;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.keys":199,"core-js/modules/es.object.to-string":200,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.iterator":256}],314:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.every");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/web.url");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.every");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/web.url");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var Super=_getPrototypeOf(Derived),result;if(isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_main.default.prototype.select=function(e,p){_main.default._validateParameters("select",arguments);var container=this._getContainer(p);var res=container.querySelector(e);if(res){return this._wrapElement(res)}else{return null}};_main.default.prototype.selectAll=function(e,p){_main.default._validateParameters("selectAll",arguments);var arr=[];var container=this._getContainer(p);var res=container.querySelectorAll(e);if(res){for(var j=0;j<res.length;j++){var obj=this._wrapElement(res[j]);arr.push(obj)}}return arr};_main.default.prototype._getContainer=function(p){var container=document;if(typeof p==="string"){container=document.querySelector(p)||document}else if(p instanceof _main.default.Element){container=p.elt}else if(p instanceof HTMLElement){container=p}return container};_main.default.prototype._wrapElement=function(elt){var children=Array.prototype.slice.call(elt.children);if(elt.tagName==="INPUT"&&elt.type==="checkbox"){var converted=new _main.default.Element(elt,this);converted.checked=function(){if(arguments.length===0){return this.elt.checked}else if(arguments.length<=0?undefined:arguments[0]){this.elt.checked=true}else{this.elt.checked=false}return this};return converted}else if(elt.tagName==="VIDEO"||elt.tagName==="AUDIO"){return new _main.default.MediaElement(elt,this)}else if(elt.tagName==="SELECT"){return this.createSelect(new _main.default.Element(elt,this))}else if(children.length>0&&children.every(function(c){return c.tagName==="INPUT"||c.tagName==="LABEL"})){return this.createRadio(new _main.default.Element(elt,this))}else{return new _main.default.Element(elt,this)}};_main.default.prototype.removeElements=function(e){_main.default._validateParameters("removeElements",arguments);var isNotCanvasElement=function isNotCanvasElement(el){return!(el.elt instanceof HTMLCanvasElement)};var removeableElements=this._elements.filter(isNotCanvasElement);removeableElements.map(function(el){return el.remove()})};_main.default.Element.prototype.changed=function(fxn){_main.default.Element._adjustListener("change",fxn,this);return this};_main.default.Element.prototype.input=function(fxn){_main.default.Element._adjustListener("input",fxn,this);return this};function addElement(elt,pInst,media){var node=pInst._userNode?pInst._userNode:document.body;node.appendChild(elt);var c=media?new _main.default.MediaElement(elt,pInst):new _main.default.Element(elt,pInst);pInst._elements.push(c);return c}_main.default.prototype.createDiv=function(){var html=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var elt=document.createElement("div");elt.innerHTML=html;return addElement(elt,this)};_main.default.prototype.createP=function(){var html=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var elt=document.createElement("p");elt.innerHTML=html;return addElement(elt,this)};_main.default.prototype.createSpan=function(){var html=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var elt=document.createElement("span");elt.innerHTML=html;return addElement(elt,this)};_main.default.prototype.createImg=function(){_main.default._validateParameters("createImg",arguments);var elt=document.createElement("img");var args=arguments;var self;if(args.length>1&&typeof args[1]==="string"){elt.alt=args[1]}if(args.length>2&&typeof args[2]==="string"){elt.crossOrigin=args[2]}elt.src=args[0];self=addElement(elt,this);elt.addEventListener("load",function(){self.width=elt.offsetWidth||elt.width;self.height=elt.offsetHeight||elt.height;var last=args[args.length-1];if(typeof last==="function")last(self)});return self};_main.default.prototype.createA=function(href,html,target){_main.default._validateParameters("createA",arguments);var elt=document.createElement("a");elt.href=href;elt.innerHTML=html;if(target)elt.target=target;return addElement(elt,this)};_main.default.prototype.createSlider=function(min,max,value,step){_main.default._validateParameters("createSlider",arguments);var elt=document.createElement("input");elt.type="range";elt.min=min;elt.max=max;if(step===0){elt.step=1e-18}else if(step){elt.step=step}if(typeof value==="number")elt.value=value;return addElement(elt,this)};_main.default.prototype.createButton=function(label,value){_main.default._validateParameters("createButton",arguments);var elt=document.createElement("button");elt.innerHTML=label;if(value)elt.value=value;return addElement(elt,this)};_main.default.prototype.createCheckbox=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("createCheckbox",args);var elt=document.createElement("div");var checkbox=document.createElement("input");checkbox.type="checkbox";var label=document.createElement("label");label.appendChild(checkbox);elt.appendChild(label);var self=addElement(elt,this);self.checked=function(){var cb=self.elt.firstElementChild.getElementsByTagName("input")[0];if(cb){if(arguments.length===0){return cb.checked}else if(arguments.length<=0?undefined:arguments[0]){cb.checked=true}else{cb.checked=false}}return self};this.value=function(val){self.value=val;return this};if(args[0]){self.value(args[0]);var span=document.createElement("span");span.innerHTML=args[0];label.appendChild(span)}if(args[1]){checkbox.checked=true}return self};_main.default.prototype.createSelect=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default._validateParameters("createSelect",args);var self;var arg=args[0];if(arg instanceof _main.default.Element&&arg.elt instanceof HTMLSelectElement){self=arg;this.elt=arg.elt}else if(arg instanceof HTMLSelectElement){self=addElement(arg,this);this.elt=arg}else{var elt=document.createElement("select");if(arg&&typeof arg==="boolean"){elt.setAttribute("multiple","true")}self=addElement(elt,this);this.elt=elt}self.option=function(name,value){var index;if(name===undefined){return}for(var i=0;i<this.elt.length;i+=1){if(this.elt[i].textContent===name){index=i;break}}if(index!==undefined){if(value===false){this.elt.remove(index)}else{this.elt[index].value=value}}else{var opt=document.createElement("option");opt.textContent=name;opt.value=value===undefined?name:value;this.elt.appendChild(opt);this._pInst._elements.push(opt)}};self.selected=function(value){if(value!==undefined){for(var i=0;i<this.elt.length;i+=1){if(this.elt[i].value.toString()===value.toString()){this.elt.selectedIndex=i}}return this}else{if(this.elt.getAttribute("multiple")){var arr=[];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.elt.selectedOptions[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var selectedOption=_step.value;arr.push(selectedOption.value)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return arr}else{return this.elt.value}}};self.disable=function(value){if(typeof value==="string"){for(var i=0;i<this.elt.length;i++){if(this.elt[i].value.toString()===value){this.elt[i].disabled=true;this.elt[i].selected=false}}}else{this.elt.disabled=true}return this};self.enable=function(value){if(typeof value==="string"){for(var i=0;i<this.elt.length;i++){if(this.elt[i].value.toString()===value){this.elt[i].disabled=false;this.elt[i].selected=false}}}else{this.elt.disabled=false;for(var _i=0;_i<this.elt.length;_i++){this.elt[_i].disabled=false;this.elt[_i].selected=false}}return this};return self};_main.default.prototype.createRadio=function(){var self;var radioElement;var name;var arg0=arguments.length<=0?undefined:arguments[0];if(arg0 instanceof _main.default.Element&&(arg0.elt instanceof HTMLDivElement||arg0.elt instanceof HTMLSpanElement)){self=arg0;this.elt=arg0.elt}else if(arg0 instanceof HTMLDivElement||arg0 instanceof HTMLSpanElement){self=addElement(arg0,this);this.elt=arg0;radioElement=arg0;if(typeof(arguments.length<=1?undefined:arguments[1])==="string")name=arguments.length<=1?undefined:arguments[1]}else{if(typeof arg0==="string")name=arg0;radioElement=document.createElement("div");self=addElement(radioElement,this);this.elt=radioElement}self._name=name||"radioOption";var isRadioInput=function isRadioInput(el){return el instanceof HTMLInputElement&&el.type==="radio"};var isLabelElement=function isLabelElement(el){return el instanceof HTMLLabelElement};var isSpanElement=function isSpanElement(el){return el instanceof HTMLSpanElement};self._getOptionsArray=function(){return Array.from(this.elt.children).filter(function(el){return isRadioInput(el)||isLabelElement(el)&&isRadioInput(el.firstElementChild)}).map(function(el){return isRadioInput(el)?el:el.firstElementChild})};self.option=function(value,label){var optionEl;var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=self._getOptionsArray()[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var option=_step2.value;if(option.value===value){optionEl=option;break}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}if(optionEl===undefined){optionEl=document.createElement("input");optionEl.setAttribute("type","radio");optionEl.setAttribute("value",value)}optionEl.setAttribute("name",self._name);var labelElement;if(!isLabelElement(optionEl.parentElement)){labelElement=document.createElement("label");labelElement.insertAdjacentElement("afterbegin",optionEl)}else{labelElement=optionEl.parentElement}var spanElement;if(!isSpanElement(labelElement.lastElementChild)){spanElement=document.createElement("span");optionEl.insertAdjacentElement("afterend",spanElement)}else{spanElement=labelElement.lastElementChild}spanElement.innerHTML=label===undefined?value:label;this.elt.appendChild(labelElement);return optionEl};self.remove=function(value){var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=self._getOptionsArray()[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var optionEl=_step3.value;if(optionEl.value===value){if(isLabelElement(optionEl.parentElement)){optionEl.parentElement.remove()}else{optionEl.remove()}return}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return!=null){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}};self.value=function(){var result="";var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=self._getOptionsArray()[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var option=_step4.value;if(option.checked){result=option.value;break}}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return!=null){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}return result};self.selected=function(value){var result=null;if(value===undefined){var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=self._getOptionsArray()[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var option=_step5.value;if(option.checked){result=option;break}}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally{try{if(!_iteratorNormalCompletion5&&_iterator5.return!=null){_iterator5.return()}}finally{if(_didIteratorError5){throw _iteratorError5}}}}else{self._getOptionsArray().forEach(function(option){option.checked=false;option.removeAttribute("checked")});var _iteratorNormalCompletion6=true;var _didIteratorError6=false;var _iteratorError6=undefined;try{for(var _iterator6=self._getOptionsArray()[Symbol.iterator](),_step6;!(_iteratorNormalCompletion6=(_step6=_iterator6.next()).done);_iteratorNormalCompletion6=true){var _option=_step6.value;if(_option.value===value){_option.setAttribute("checked",true);_option.checked=true;result=_option}}}catch(err){_didIteratorError6=true;_iteratorError6=err}finally{try{if(!_iteratorNormalCompletion6&&_iterator6.return!=null){_iterator6.return()}}finally{if(_didIteratorError6){throw _iteratorError6}}}}return result};self.disable=function(){var shouldDisable=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var _iteratorNormalCompletion7=true;var _didIteratorError7=false;var _iteratorError7=undefined;try{for(var _iterator7=self._getOptionsArray()[Symbol.iterator](),_step7;!(_iteratorNormalCompletion7=(_step7=_iterator7.next()).done);_iteratorNormalCompletion7=true){var radioInput=_step7.value;radioInput.setAttribute("disabled",shouldDisable)}}catch(err){_didIteratorError7=true;_iteratorError7=err}finally{try{if(!_iteratorNormalCompletion7&&_iterator7.return!=null){_iterator7.return()}}finally{if(_didIteratorError7){throw _iteratorError7}}}};return self};_main.default.prototype.createColorPicker=function(value){_main.default._validateParameters("createColorPicker",arguments);var elt=document.createElement("input");var self;elt.type="color";if(value){if(value instanceof _main.default.Color){elt.value=value.toString("#rrggbb")}else{_main.default.prototype._colorMode="rgb";_main.default.prototype._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]};elt.value=_main.default.prototype.color(value).toString("#rrggbb")}}else{elt.value="#000000"}self=addElement(elt,this);self.color=function(){if(value){if(value.mode){_main.default.prototype._colorMode=value.mode}if(value.maxes){_main.default.prototype._colorMaxes=value.maxes}}return _main.default.prototype.color(this.elt.value)};return self};_main.default.prototype.createInput=function(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"text";_main.default._validateParameters("createInput",arguments);var elt=document.createElement("input");elt.setAttribute("value",value);elt.setAttribute("type",type);return addElement(elt,this)};_main.default.prototype.createFileInput=function(callback){var multiple=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;_main.default._validateParameters("createFileInput",arguments);var handleFileSelect=function handleFileSelect(event){var _iteratorNormalCompletion8=true;var _didIteratorError8=false;var _iteratorError8=undefined;try{for(var _iterator8=event.target.files[Symbol.iterator](),_step8;!(_iteratorNormalCompletion8=(_step8=_iterator8.next()).done);_iteratorNormalCompletion8=true){var file=_step8.value;_main.default.File._load(file,callback)}}catch(err){_didIteratorError8=true;_iteratorError8=err}finally{try{if(!_iteratorNormalCompletion8&&_iterator8.return!=null){_iterator8.return()}}finally{if(_didIteratorError8){throw _iteratorError8}}}};if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){console.log("The File APIs are not fully supported in this browser. Cannot create element.");return}var fileInput=document.createElement("input");fileInput.setAttribute("type","file");if(multiple)fileInput.setAttribute("multiple",true);fileInput.addEventListener("change",handleFileSelect,false);return addElement(fileInput,this)};function createMedia(pInst,type,src,callback){var elt=document.createElement(type);src=src||"";if(typeof src==="string"){src=[src]}var _iteratorNormalCompletion9=true;var _didIteratorError9=false;var _iteratorError9=undefined;try{for(var _iterator9=src[Symbol.iterator](),_step9;!(_iteratorNormalCompletion9=(_step9=_iterator9.next()).done);_iteratorNormalCompletion9=true){var mediaSource=_step9.value;var sourceEl=document.createElement("source");sourceEl.setAttribute("src",mediaSource);elt.appendChild(sourceEl)}}catch(err){_didIteratorError9=true;_iteratorError9=err}finally{try{if(!_iteratorNormalCompletion9&&_iterator9.return!=null){_iterator9.return()}}finally{if(_didIteratorError9){throw _iteratorError9}}}if(typeof callback==="function"){var callbackHandler=function callbackHandler(){callback();elt.removeEventListener("canplaythrough",callbackHandler)};elt.addEventListener("canplaythrough",callbackHandler)}var mediaEl=addElement(elt,pInst,true);mediaEl.loadedmetadata=false;elt.addEventListener("loadedmetadata",function(){mediaEl.width=elt.videoWidth;mediaEl.height=elt.videoHeight;if(mediaEl.elt.width===0)mediaEl.elt.width=elt.videoWidth;if(mediaEl.elt.height===0)mediaEl.elt.height=elt.videoHeight;if(mediaEl.presetPlaybackRate){mediaEl.elt.playbackRate=mediaEl.presetPlaybackRate;delete mediaEl.presetPlaybackRate}mediaEl.loadedmetadata=true});return mediaEl}_main.default.prototype.createVideo=function(src,callback){_main.default._validateParameters("createVideo",arguments);return createMedia(this,"video",src,callback)};_main.default.prototype.createAudio=function(src,callback){_main.default._validateParameters("createAudio",arguments);return createMedia(this,"audio",src,callback)};_main.default.prototype.VIDEO="video";_main.default.prototype.AUDIO="audio";if(navigator.mediaDevices===undefined){navigator.mediaDevices={}}if(navigator.mediaDevices.getUserMedia===undefined){navigator.mediaDevices.getUserMedia=function(constraints){var getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;if(!getUserMedia){return Promise.reject(new Error("getUserMedia is not implemented in this browser"))}return new Promise(function(resolve,reject){getUserMedia.call(navigator,constraints,resolve,reject)})}}_main.default.prototype.createCapture=function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}_main.default._validateParameters("createCapture",args);if(!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)){throw new DOMException("getUserMedia not supported in this browser")}var useVideo=true;var useAudio=true;var constraints;var callback;for(var _i2=0,_args=args;_i2<_args.length;_i2++){var arg=_args[_i2];if(arg===_main.default.prototype.VIDEO)useAudio=false;else if(arg===_main.default.prototype.AUDIO)useVideo=false;else if(_typeof(arg)==="object")constraints=arg;else if(typeof arg==="function")callback=arg}if(!constraints)constraints={video:useVideo,audio:useAudio};var domElement=document.createElement("video");domElement.setAttribute("playsinline","");navigator.mediaDevices.getUserMedia(constraints).then(function(stream){try{if("srcObject"in domElement){domElement.srcObject=stream}else{domElement.src=window.URL.createObjectURL(stream)}}catch(err){domElement.src=stream}},console.log);var videoEl=addElement(domElement,this,true);videoEl.loadedmetadata=false;domElement.addEventListener("loadedmetadata",function(){domElement.play();if(domElement.width){videoEl.width=domElement.width;videoEl.height=domElement.height}else{videoEl.width=videoEl.elt.width=domElement.videoWidth;videoEl.height=videoEl.elt.height=domElement.videoHeight}videoEl.loadedmetadata=true;if(callback)callback(domElement.srcObject)});return videoEl};_main.default.prototype.createElement=function(tag,content){_main.default._validateParameters("createElement",arguments);var elt=document.createElement(tag);if(typeof content!=="undefined"){elt.innerHTML=content}return addElement(elt,this)};_main.default.Element.prototype.addClass=function(c){if(this.elt.className){if(!this.hasClass(c)){this.elt.className=this.elt.className+" "+c}}else{this.elt.className=c}return this};_main.default.Element.prototype.removeClass=function(c){this.elt.classList.remove(c);return this};_main.default.Element.prototype.hasClass=function(c){return this.elt.classList.contains(c)};_main.default.Element.prototype.toggleClass=function(c){if(this.elt.classList.contains(c)){this.elt.classList.remove(c)}else{this.elt.classList.add(c)}return this};_main.default.Element.prototype.child=function(childNode){if(typeof childNode==="undefined"){return this.elt.childNodes}if(typeof childNode==="string"){if(childNode[0]==="#"){childNode=childNode.substring(1)}childNode=document.getElementById(childNode)}else if(childNode instanceof _main.default.Element){childNode=childNode.elt}if(childNode instanceof HTMLElement){this.elt.appendChild(childNode)}return this};_main.default.Element.prototype.center=function(align){var style=this.elt.style.display;var hidden=this.elt.style.display==="none";var parentHidden=this.parent().style.display==="none";var pos={x:this.elt.offsetLeft,y:this.elt.offsetTop};if(hidden)this.show();if(parentHidden)this.parent().show();this.elt.style.display="block";this.position(0,0);var wOffset=Math.abs(this.parent().offsetWidth-this.elt.offsetWidth);var hOffset=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight);if(align==="both"||align===undefined){this.position(wOffset/2+this.parent().offsetLeft,hOffset/2+this.parent().offsetTop)}else if(align==="horizontal"){this.position(wOffset/2+this.parent().offsetLeft,pos.y)}else if(align==="vertical"){this.position(pos.x,hOffset/2+this.parent().offsetTop)}this.style("display",style);if(hidden)this.hide();if(parentHidden)this.parent().hide();return this};_main.default.Element.prototype.html=function(){if(arguments.length===0){return this.elt.innerHTML}else if(arguments.length<=1?undefined:arguments[1]){this.elt.insertAdjacentHTML("beforeend",arguments.length<=0?undefined:arguments[0]);return this}else{this.elt.innerHTML=arguments.length<=0?undefined:arguments[0];return this}};_main.default.Element.prototype.position=function(){if(arguments.length===0){return{x:this.elt.offsetLeft,y:this.elt.offsetTop}}else{var positionType="absolute";if((arguments.length<=2?undefined:arguments[2])==="static"||(arguments.length<=2?undefined:arguments[2])==="fixed"||(arguments.length<=2?undefined:arguments[2])==="relative"||(arguments.length<=2?undefined:arguments[2])==="sticky"||(arguments.length<=2?undefined:arguments[2])==="initial"||(arguments.length<=2?undefined:arguments[2])==="inherit"){positionType=arguments.length<=2?undefined:arguments[2]}this.elt.style.position=positionType;this.elt.style.left=(arguments.length<=0?undefined:arguments[0])+"px";this.elt.style.top=(arguments.length<=1?undefined:arguments[1])+"px";this.x=arguments.length<=0?undefined:arguments[0];this.y=arguments.length<=1?undefined:arguments[1];return this}};_main.default.Element.prototype._translate=function(){this.elt.style.position="absolute";var transform="";if(this.elt.style.transform){transform=this.elt.style.transform.replace(/translate3d\(.*\)/g,"");transform=transform.replace(/translate[X-Z]?\(.*\)/g,"")}if(arguments.length===2){this.elt.style.transform="translate("+(arguments.length<=0?undefined:arguments[0])+"px, "+(arguments.length<=1?undefined:arguments[1])+"px)"}else if(arguments.length>2){this.elt.style.transform="translate3d("+(arguments.length<=0?undefined:arguments[0])+"px,"+(arguments.length<=1?undefined:arguments[1])+"px,"+(arguments.length<=2?undefined:arguments[2])+"px)";if(arguments.length===3){this.elt.parentElement.style.perspective="1000px"}else{this.elt.parentElement.style.perspective=(arguments.length<=3?undefined:arguments[3])+"px"}}this.elt.style.transform+=transform;return this};_main.default.Element.prototype._rotate=function(){var transform="";if(this.elt.style.transform){transform=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"");transform=transform.replace(/rotate[X-Z]?\(.*\)/g,"")}if(arguments.length===1){this.elt.style.transform="rotate("+(arguments.length<=0?undefined:arguments[0])+"deg)"}else if(arguments.length===2){this.elt.style.transform="rotate("+(arguments.length<=0?undefined:arguments[0])+"deg, "+(arguments.length<=1?undefined:arguments[1])+"deg)"}else if(arguments.length===3){this.elt.style.transform="rotateX("+(arguments.length<=0?undefined:arguments[0])+"deg)";this.elt.style.transform+="rotateY("+(arguments.length<=1?undefined:arguments[1])+"deg)";this.elt.style.transform+="rotateZ("+(arguments.length<=2?undefined:arguments[2])+"deg)"}this.elt.style.transform+=transform;return this};_main.default.Element.prototype.style=function(prop,val){var self=this;if(val instanceof _main.default.Color){val="rgba("+val.levels[0]+","+val.levels[1]+","+val.levels[2]+","+val.levels[3]/255+")"}if(typeof val==="undefined"){if(prop.indexOf(":")===-1){var styles=window.getComputedStyle(self.elt);var style=styles.getPropertyValue(prop);return style}else{var attrs=prop.split(";");for(var i=0;i<attrs.length;i++){var parts=attrs[i].split(":");if(parts[0]&&parts[1]){this.elt.style[parts[0].trim()]=parts[1].trim()}}}}else{this.elt.style[prop]=val;if(prop==="width"||prop==="height"||prop==="left"||prop==="top"){var _styles=window.getComputedStyle(self.elt);var styleVal=_styles.getPropertyValue(prop);var numVal=styleVal.replace(/[^\d.]/g,"");this[prop]=Math.round(parseFloat(numVal,10))}}return this};_main.default.Element.prototype.attribute=function(attr,value){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio")){if(typeof value==="undefined"){return this.elt.firstChild.getAttribute(attr)}else{for(var i=0;i<this.elt.childNodes.length;i++){this.elt.childNodes[i].setAttribute(attr,value)}}}else if(typeof value==="undefined"){return this.elt.getAttribute(attr)}else{this.elt.setAttribute(attr,value);return this}};_main.default.Element.prototype.removeAttribute=function(attr){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio")){for(var i=0;i<this.elt.childNodes.length;i++){this.elt.childNodes[i].removeAttribute(attr)}}this.elt.removeAttribute(attr);return this};_main.default.Element.prototype.value=function(){if(arguments.length>0){this.elt.value=arguments.length<=0?undefined:arguments[0];return this}else{if(this.elt.type==="range"){return parseFloat(this.elt.value)}else return this.elt.value}};_main.default.Element.prototype.show=function(){this.elt.style.display="block";return this};_main.default.Element.prototype.hide=function(){this.elt.style.display="none";return this};_main.default.Element.prototype.size=function(w,h){if(arguments.length===0){return{width:this.elt.offsetWidth,height:this.elt.offsetHeight}}else{var aW=w;var aH=h;var AUTO=_main.default.prototype.AUTO;if(aW!==AUTO||aH!==AUTO){if(aW===AUTO){aW=h*this.width/this.height}else if(aH===AUTO){aH=w*this.height/this.width}if(this.elt instanceof HTMLCanvasElement){var j={};var k=this.elt.getContext("2d");var prop;for(prop in k){j[prop]=k[prop]}this.elt.setAttribute("width",aW*this._pInst._pixelDensity);this.elt.setAttribute("height",aH*this._pInst._pixelDensity);this.elt.style.width=aW+"px";this.elt.style.height=aH+"px";this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity);for(prop in j){this.elt.getContext("2d")[prop]=j[prop]}}else{this.elt.style.width=aW+"px";this.elt.style.height=aH+"px";this.elt.width=aW;this.elt.height=aH}this.width=this.elt.offsetWidth;this.height=this.elt.offsetHeight;if(this._pInst&&this._pInst._curElement){if(this._pInst._curElement.elt===this.elt){this._pInst._setProperty("width",this.elt.offsetWidth);this._pInst._setProperty("height",this.elt.offsetHeight)}}}return this}};_main.default.Element.prototype.remove=function(){if(this instanceof _main.default.MediaElement){this.stop();var sources=this.elt.srcObject;if(sources!==null){var tracks=sources.getTracks();tracks.forEach(function(track){track.stop()})}}var index=this._pInst._elements.indexOf(this);if(index!==-1){this._pInst._elements.splice(index,1)}for(var ev in this._events){this.elt.removeEventListener(ev,this._events[ev])}if(this.elt&&this.elt.parentNode){this.elt.parentNode.removeChild(this.elt)}};_main.default.Element.prototype.drop=function(callback,fxn){if(window.File&&window.FileReader&&window.FileList&&window.Blob){if(!this._dragDisabled){this._dragDisabled=true;var preventDefault=function preventDefault(evt){evt.preventDefault()};this.elt.addEventListener("dragover",preventDefault);this.elt.addEventListener("dragleave",preventDefault)}_main.default.Element._attachListener("drop",function(evt){evt.preventDefault();if(typeof fxn==="function"){fxn.call(this,evt)}var files=evt.dataTransfer.files;var _iteratorNormalCompletion10=true;var _didIteratorError10=false;var _iteratorError10=undefined;try{for(var _iterator10=files[Symbol.iterator](),_step10;!(_iteratorNormalCompletion10=(_step10=_iterator10.next()).done);_iteratorNormalCompletion10=true){var f=_step10.value;_main.default.File._load(f,callback)}}catch(err){_didIteratorError10=true;_iteratorError10=err}finally{try{if(!_iteratorNormalCompletion10&&_iterator10.return!=null){_iterator10.return()}}finally{if(_didIteratorError10){throw _iteratorError10}}}},this)}else{console.log("The File APIs are not fully supported in this browser.")}return this};_main.default.Element.prototype.draggable=function(elmMove){var isTouch="ontouchstart"in window;var x=0,y=0,px=0,py=0,elmDrag,dragMouseDownEvt=isTouch?"touchstart":"mousedown",closeDragElementEvt=isTouch?"touchend":"mouseup",elementDragEvt=isTouch?"touchmove":"mousemove";if(elmMove===undefined){elmMove=this.elt;elmDrag=elmMove}else if(elmMove!==this.elt&&elmMove.elt!==this.elt){elmMove=elmMove.elt;elmDrag=this.elt}elmDrag.addEventListener(dragMouseDownEvt,dragMouseDown,false);elmDrag.style.cursor="move";function dragMouseDown(e){e=e||window.event;if(isTouch){var touches=e.changedTouches;px=parseInt(touches[0].clientX);py=parseInt(touches[0].clientY)}else{px=parseInt(e.clientX);py=parseInt(e.clientY)}document.addEventListener(closeDragElementEvt,closeDragElement,false);document.addEventListener(elementDragEvt,elementDrag,false);return false}function elementDrag(e){e=e||window.event;if(isTouch){var touches=e.changedTouches;x=px-parseInt(touches[0].clientX);y=py-parseInt(touches[0].clientY);px=parseInt(touches[0].clientX);py=parseInt(touches[0].clientY)}else{x=px-parseInt(e.clientX);y=py-parseInt(e.clientY);px=parseInt(e.clientX);py=parseInt(e.clientY)}elmMove.style.left=elmMove.offsetLeft-x+"px";elmMove.style.top=elmMove.offsetTop-y+"px"}function closeDragElement(){document.removeEventListener(closeDragElementEvt,closeDragElement,false);document.removeEventListener(elementDragEvt,elementDrag,false)}return this};var Cue=function Cue(callback,time,id,val){_classCallCheck(this,Cue);this.callback=callback;this.time=time;this.id=id;this.val=val};var MediaElement=function(_p5$Element){_inherits(MediaElement,_p5$Element);var _super=_createSuper(MediaElement);function MediaElement(elt,pInst){var _this;_classCallCheck(this,MediaElement);_this=_super.call(this,elt,pInst);var self=_assertThisInitialized(_this);_this.elt.crossOrigin="anonymous";_this._prevTime=0;_this._cueIDCounter=0;_this._cues=[];_this.pixels=[];_this._pixelsState=_assertThisInitialized(_this);_this._pixelDensity=1;_this._modified=false;_this._frameOnCanvas=-1;Object.defineProperty(self,"src",{get:function get(){var firstChildSrc=self.elt.children[0].src;var srcVal=self.elt.src===window.location.href?"":self.elt.src;var ret=firstChildSrc===window.location.href?srcVal:firstChildSrc;return ret},set:function set(newValue){for(var i=0;i<self.elt.children.length;i++){self.elt.removeChild(self.elt.children[i])}var source=document.createElement("source");source.src=newValue;elt.appendChild(source);self.elt.src=newValue;self.modified=true}});self._onended=function(){};self.elt.onended=function(){self._onended(self)};return _this}_createClass(MediaElement,[{key:"play",value:function play(){var _this2=this;if(this.elt.currentTime===this.elt.duration){this.elt.currentTime=0}var promise;if(this.elt.readyState>1){promise=this.elt.play()}else{this.elt.load();promise=this.elt.play()}if(promise&&promise.catch){promise.catch(function(e){if(e.name==="NotAllowedError"){if(typeof IS_MINIFIED==="undefined"){_main.default._friendlyAutoplayError(_this2.src)}else{console.error(e)}}else{console.error("Media play method encountered an unexpected error",e)}})}return this}},{key:"stop",value:function stop(){this.elt.pause();this.elt.currentTime=0;return this}},{key:"pause",value:function pause(){this.elt.pause();return this}},{key:"loop",value:function loop(){this.elt.setAttribute("loop",true);this.play();return this}},{key:"noLoop",value:function noLoop(){this.elt.removeAttribute("loop");return this}},{key:"_setupAutoplayFailDetection",value:function _setupAutoplayFailDetection(){var _this3=this;var timeout=setTimeout(function(){if(typeof IS_MINIFIED==="undefined"){_main.default._friendlyAutoplayError(_this3.src)}else{console.error(e)}},500);this.elt.addEventListener("play",function(){return clearTimeout(timeout)},{passive:true,once:true})}},{key:"autoplay",value:function autoplay(val){var _this4=this;var oldVal=this.elt.getAttribute("autoplay");this.elt.setAttribute("autoplay",val);if(val&&!oldVal){var setupAutoplayFailDetection=function setupAutoplayFailDetection(){return _this4._setupAutoplayFailDetection()};if(this.elt.readyState===4){setupAutoplayFailDetection()}else{this.elt.addEventListener("canplay",setupAutoplayFailDetection,{passive:true,once:true})}}return this}},{key:"volume",value:function volume(val){if(typeof val==="undefined"){return this.elt.volume}else{this.elt.volume=val}}},{key:"speed",value:function speed(val){if(typeof val==="undefined"){return this.presetPlaybackRate||this.elt.playbackRate}else{if(this.loadedmetadata){this.elt.playbackRate=val}else{this.presetPlaybackRate=val}}}},{key:"time",value:function time(val){if(typeof val==="undefined"){return this.elt.currentTime}else{this.elt.currentTime=val;return this}}},{key:"duration",value:function duration(){return this.elt.duration}},{key:"_ensureCanvas",value:function _ensureCanvas(){if(!this.canvas){this.canvas=document.createElement("canvas");this.drawingContext=this.canvas.getContext("2d");this.setModified(true)}var needsRedraw=this._frameOnCanvas!==this._pInst.frameCount;if(this.loadedmetadata&&needsRedraw){if(this.canvas.width!==this.elt.width){this.canvas.width=this.elt.width;this.canvas.height=this.elt.height;this.width=this.canvas.width;this.height=this.canvas.height}this.drawingContext.clearRect(0,0,this.canvas.width,this.canvas.height);this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height);this.setModified(true);this._frameOnCanvas=this._pInst.frameCount}}},{key:"loadPixels",value:function loadPixels(){this._ensureCanvas();for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}return _main.default.Renderer2D.prototype.loadPixels.apply(this,args)}},{key:"updatePixels",value:function updatePixels(x,y,w,h){if(this.loadedmetadata){this._ensureCanvas();_main.default.Renderer2D.prototype.updatePixels.call(this,x,y,w,h)}this.setModified(true);return this}},{key:"get",value:function get(){this._ensureCanvas();for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5]}return _main.default.Renderer2D.prototype.get.apply(this,args)}},{key:"_getPixel",value:function _getPixel(){this.loadPixels();for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++){args[_key6]=arguments[_key6]}return _main.default.Renderer2D.prototype._getPixel.apply(this,args)}},{key:"set",value:function set(x,y,imgOrCol){if(this.loadedmetadata){this._ensureCanvas();_main.default.Renderer2D.prototype.set.call(this,x,y,imgOrCol);this.setModified(true)}}},{key:"copy",value:function copy(){this._ensureCanvas();for(var _len7=arguments.length,args=new Array(_len7),_key7=0;_key7<_len7;_key7++){args[_key7]=arguments[_key7]}_main.default.prototype.copy.apply(this,args)}},{key:"mask",value:function mask(){this.loadPixels();this.setModified(true);for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++){args[_key8]=arguments[_key8]}_main.default.Image.prototype.mask.apply(this,args)}},{key:"isModified",value:function isModified(){return this._modified}},{key:"setModified",value:function setModified(value){this._modified=value}},{key:"onended",value:function onended(callback){this._onended=callback;return this}},{key:"connect",value:function connect(obj){var audioContext,mainOutput;if(typeof _main.default.prototype.getAudioContext==="function"){audioContext=_main.default.prototype.getAudioContext();mainOutput=_main.default.soundOut.input}else{try{audioContext=obj.context;mainOutput=audioContext.destination}catch(e){throw"connect() is meant to be used with Web Audio API or p5.sound.js"}}if(!this.audioSourceNode){this.audioSourceNode=audioContext.createMediaElementSource(this.elt);this.audioSourceNode.connect(mainOutput)}if(obj){if(obj.input){this.audioSourceNode.connect(obj.input)}else{this.audioSourceNode.connect(obj)}}else{this.audioSourceNode.connect(mainOutput)}}},{key:"disconnect",value:function disconnect(){if(this.audioSourceNode){this.audioSourceNode.disconnect()}else{throw"nothing to disconnect"}}},{key:"showControls",value:function showControls(){this.elt.style["text-align"]="inherit";this.elt.controls=true}},{key:"hideControls",value:function hideControls(){this.elt.controls=false}},{key:"addCue",value:function addCue(time,callback,val){var id=this._cueIDCounter++;var cue=new Cue(callback,time,id,val);this._cues.push(cue);if(!this.elt.ontimeupdate){this.elt.ontimeupdate=this._onTimeUpdate.bind(this)}return id}},{key:"removeCue",value:function removeCue(id){for(var i=0;i<this._cues.length;i++){if(this._cues[i].id===id){console.log(id);this._cues.splice(i,1)}}if(this._cues.length===0){this.elt.ontimeupdate=null}}},{key:"clearCues",value:function clearCues(){this._cues=[];this.elt.ontimeupdate=null}},{key:"_onTimeUpdate",value:function _onTimeUpdate(){var playbackTime=this.time();for(var i=0;i<this._cues.length;i++){var callbackTime=this._cues[i].time;var val=this._cues[i].val;if(this._prevTime<callbackTime&&callbackTime<=playbackTime){this._cues[i].callback(val)}}this._prevTime=playbackTime}}]);return MediaElement}(_main.default.Element);_main.default.MediaElement=MediaElement;var File=function(){function File(file,pInst){_classCallCheck(this,File);this.file=file;this._pInst=pInst;var typeList=file.type.split("/");this.type=typeList[0];this.subtype=typeList[1];this.name=file.name;this.size=file.size;this.data=undefined}_createClass(File,null,[{key:"_createLoader",value:function _createLoader(theFile,callback){var reader=new FileReader;reader.onload=function(e){var p5file=new _main.default.File(theFile);if(p5file.file.type==="application/json"){p5file.data=JSON.parse(e.target.result)}else if(p5file.file.type==="text/xml"){var parser=new DOMParser;var xml=parser.parseFromString(e.target.result,"text/xml");p5file.data=new _main.default.XML(xml.documentElement)}else{p5file.data=e.target.result}callback(p5file)};return reader}},{key:"_load",value:function _load(f,callback){if(/^text\//.test(f.type)||f.type==="application/json"){_main.default.File._createLoader(f,callback).readAsText(f)}else if(!/^(video|audio)\//.test(f.type)){_main.default.File._createLoader(f,callback).readAsDataURL(f)}else{var file=new _main.default.File(f);file.data=URL.createObjectURL(f);callback(file)}}}]);return File}();_main.default.File=File;var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.every":171,"core-js/modules/es.array.filter":173,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.from":176,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.splice":185,"core-js/modules/es.function.name":186,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.to-string":200,"core-js/modules/es.promise":201,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.replace":214,"core-js/modules/es.string.split":216,"core-js/modules/es.string.trim":219,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.for-each":255,"core-js/modules/web.dom-collections.iterator":256,"core-js/modules/web.url":258}],315:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.deviceOrientation=window.innerWidth/window.innerHeight>1?"landscape":"portrait";_main.default.prototype.accelerationX=0;_main.default.prototype.accelerationY=0;_main.default.prototype.accelerationZ=0;_main.default.prototype.pAccelerationX=0;_main.default.prototype.pAccelerationY=0;_main.default.prototype.pAccelerationZ=0;_main.default.prototype._updatePAccelerations=function(){this._setProperty("pAccelerationX",this.accelerationX);this._setProperty("pAccelerationY",this.accelerationY);this._setProperty("pAccelerationZ",this.accelerationZ)};_main.default.prototype.rotationX=0;_main.default.prototype.rotationY=0;_main.default.prototype.rotationZ=0;_main.default.prototype.pRotationX=0;_main.default.prototype.pRotationY=0;_main.default.prototype.pRotationZ=0;var startAngleX=0;var startAngleY=0;var startAngleZ=0;var rotateDirectionX="clockwise";var rotateDirectionY="clockwise";var rotateDirectionZ="clockwise";_main.default.prototype.pRotateDirectionX=undefined;_main.default.prototype.pRotateDirectionY=undefined;_main.default.prototype.pRotateDirectionZ=undefined;_main.default.prototype._updatePRotations=function(){this._setProperty("pRotationX",this.rotationX);this._setProperty("pRotationY",this.rotationY);this._setProperty("pRotationZ",this.rotationZ)};_main.default.prototype.turnAxis=undefined;var move_threshold=.5;var shake_threshold=30;_main.default.prototype.setMoveThreshold=function(val){_main.default._validateParameters("setMoveThreshold",arguments);move_threshold=val};_main.default.prototype.setShakeThreshold=function(val){_main.default._validateParameters("setShakeThreshold",arguments);shake_threshold=val};_main.default.prototype._ondeviceorientation=function(e){this._updatePRotations();if(this._angleMode===constants.radians){e.beta=e.beta*(_PI/180);e.gamma=e.gamma*(_PI/180);e.alpha=e.alpha*(_PI/180)}this._setProperty("rotationX",e.beta);this._setProperty("rotationY",e.gamma);this._setProperty("rotationZ",e.alpha);this._handleMotion()};_main.default.prototype._ondevicemotion=function(e){this._updatePAccelerations();this._setProperty("accelerationX",e.acceleration.x*2);this._setProperty("accelerationY",e.acceleration.y*2);this._setProperty("accelerationZ",e.acceleration.z*2);this._handleMotion()};_main.default.prototype._handleMotion=function(){if(window.orientation===90||window.orientation===-90){this._setProperty("deviceOrientation","landscape")}else if(window.orientation===0){this._setProperty("deviceOrientation","portrait")}else if(window.orientation===undefined){this._setProperty("deviceOrientation","undefined")}var context=this._isGlobal?window:this;if(typeof context.deviceMoved==="function"){if(Math.abs(this.accelerationX-this.pAccelerationX)>move_threshold||Math.abs(this.accelerationY-this.pAccelerationY)>move_threshold||Math.abs(this.accelerationZ-this.pAccelerationZ)>move_threshold){context.deviceMoved()}}if(typeof context.deviceTurned==="function"){var wRX=this.rotationX+180;var wPRX=this.pRotationX+180;var wSAX=startAngleX+180;if(wRX-wPRX>0&&wRX-wPRX<270||wRX-wPRX<-270){rotateDirectionX="clockwise"}else if(wRX-wPRX<0||wRX-wPRX>270){rotateDirectionX="counter-clockwise"}if(rotateDirectionX!==this.pRotateDirectionX){wSAX=wRX}if(Math.abs(wRX-wSAX)>90&&Math.abs(wRX-wSAX)<270){wSAX=wRX;this._setProperty("turnAxis","X");context.deviceTurned()}this.pRotateDirectionX=rotateDirectionX;startAngleX=wSAX-180;var wRY=this.rotationY+180;var wPRY=this.pRotationY+180;var wSAY=startAngleY+180;if(wRY-wPRY>0&&wRY-wPRY<270||wRY-wPRY<-270){rotateDirectionY="clockwise"}else if(wRY-wPRY<0||wRY-this.pRotationY>270){rotateDirectionY="counter-clockwise"}if(rotateDirectionY!==this.pRotateDirectionY){wSAY=wRY}if(Math.abs(wRY-wSAY)>90&&Math.abs(wRY-wSAY)<270){wSAY=wRY;this._setProperty("turnAxis","Y");context.deviceTurned()}this.pRotateDirectionY=rotateDirectionY;startAngleY=wSAY-180;if(this.rotationZ-this.pRotationZ>0&&this.rotationZ-this.pRotationZ<270||this.rotationZ-this.pRotationZ<-270){rotateDirectionZ="clockwise"}else if(this.rotationZ-this.pRotationZ<0||this.rotationZ-this.pRotationZ>270){rotateDirectionZ="counter-clockwise"}if(rotateDirectionZ!==this.pRotateDirectionZ){startAngleZ=this.rotationZ}if(Math.abs(this.rotationZ-startAngleZ)>90&&Math.abs(this.rotationZ-startAngleZ)<270){startAngleZ=this.rotationZ;this._setProperty("turnAxis","Z");context.deviceTurned()}this.pRotateDirectionZ=rotateDirectionZ;this._setProperty("turnAxis",undefined)}if(typeof context.deviceShaken==="function"){var accelerationChangeX;var accelerationChangeY;if(this.pAccelerationX!==null){accelerationChangeX=Math.abs(this.accelerationX-this.pAccelerationX);accelerationChangeY=Math.abs(this.accelerationY-this.pAccelerationY)}if(accelerationChangeX+accelerationChangeY>shake_threshold){context.deviceShaken()}}};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],316:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.isKeyPressed=false;_main.default.prototype.keyIsPressed=false;_main.default.prototype.key="";_main.default.prototype.keyCode=0;_main.default.prototype._onkeydown=function(e){if(this._downKeys[e.which]){return}this._setProperty("isKeyPressed",true);this._setProperty("keyIsPressed",true);this._setProperty("keyCode",e.which);this._downKeys[e.which]=true;this._setProperty("key",e.key||String.fromCharCode(e.which)||e.which);var context=this._isGlobal?window:this;if(typeof context.keyPressed==="function"&&!e.charCode){var executeDefault=context.keyPressed(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype._onkeyup=function(e){this._downKeys[e.which]=false;if(!this._areDownKeys()){this._setProperty("isKeyPressed",false);this._setProperty("keyIsPressed",false)}this._setProperty("_lastKeyCodeTyped",null);this._setProperty("key",e.key||String.fromCharCode(e.which)||e.which);this._setProperty("keyCode",e.which);var context=this._isGlobal?window:this;if(typeof context.keyReleased==="function"){var executeDefault=context.keyReleased(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype._onkeypress=function(e){if(e.which===this._lastKeyCodeTyped){return}this._setProperty("_lastKeyCodeTyped",e.which);this._setProperty("key",e.key||String.fromCharCode(e.which)||e.which);var context=this._isGlobal?window:this;if(typeof context.keyTyped==="function"){var executeDefault=context.keyTyped(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype._onblur=function(e){this._downKeys={}};_main.default.prototype.keyIsDown=function(code){_main.default._validateParameters("keyIsDown",arguments);return this._downKeys[code]||false};_main.default.prototype._areDownKeys=function(){for(var key in this._downKeys){if(this._downKeys.hasOwnProperty(key)&&this._downKeys[key]===true){return true}}return false};var _default=_main.default;exports.default=_default},{"../core/main":298}],317:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.string.includes");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.movedX=0;_main.default.prototype.movedY=0;_main.default.prototype._hasMouseInteracted=false;_main.default.prototype.mouseX=0;_main.default.prototype.mouseY=0;_main.default.prototype.pmouseX=0;_main.default.prototype.pmouseY=0;_main.default.prototype.winMouseX=0;_main.default.prototype.winMouseY=0;_main.default.prototype.pwinMouseX=0;_main.default.prototype.pwinMouseY=0;_main.default.prototype.mouseButton=0;_main.default.prototype.mouseIsPressed=false;_main.default.prototype._updateNextMouseCoords=function(e){if(this._curElement!==null&&(!e.touches||e.touches.length>0)){var mousePos=getMousePos(this._curElement.elt,this.width,this.height,e);this._setProperty("movedX",e.movementX);this._setProperty("movedY",e.movementY);this._setProperty("mouseX",mousePos.x);this._setProperty("mouseY",mousePos.y);this._setProperty("winMouseX",mousePos.winX);this._setProperty("winMouseY",mousePos.winY)}if(!this._hasMouseInteracted){this._updateMouseCoords();this._setProperty("_hasMouseInteracted",true)}};_main.default.prototype._updateMouseCoords=function(){this._setProperty("pmouseX",this.mouseX);this._setProperty("pmouseY",this.mouseY);this._setProperty("pwinMouseX",this.winMouseX);this._setProperty("pwinMouseY",this.winMouseY);this._setProperty("_pmouseWheelDeltaY",this._mouseWheelDeltaY)};function getMousePos(canvas,w,h,evt){if(evt&&!evt.clientX){if(evt.touches){evt=evt.touches[0]}else if(evt.changedTouches){evt=evt.changedTouches[0]}}var rect=canvas.getBoundingClientRect();var sx=canvas.scrollWidth/w||1;var sy=canvas.scrollHeight/h||1;return{x:(evt.clientX-rect.left)/sx,y:(evt.clientY-rect.top)/sy,winX:evt.clientX,winY:evt.clientY,id:evt.identifier}}_main.default.prototype._setMouseButton=function(e){if(e.button===1){this._setProperty("mouseButton",constants.CENTER)}else if(e.button===2){this._setProperty("mouseButton",constants.RIGHT)}else{this._setProperty("mouseButton",constants.LEFT)}};_main.default.prototype._onmousemove=function(e){var context=this._isGlobal?window:this;var executeDefault;this._updateNextMouseCoords(e);if(!this.mouseIsPressed){if(typeof context.mouseMoved==="function"){executeDefault=context.mouseMoved(e);if(executeDefault===false){e.preventDefault()}}}else{if(typeof context.mouseDragged==="function"){executeDefault=context.mouseDragged(e);if(executeDefault===false){e.preventDefault()}}else if(typeof context.touchMoved==="function"){executeDefault=context.touchMoved(e);if(executeDefault===false){e.preventDefault()}}}};_main.default.prototype._onmousedown=function(e){var context=this._isGlobal?window:this;var executeDefault;this._setProperty("mouseIsPressed",true);this._setMouseButton(e);this._updateNextMouseCoords(e);if(typeof context.mousePressed==="function"){executeDefault=context.mousePressed(e);if(executeDefault===false){e.preventDefault()}}else if(navigator.userAgent.toLowerCase().includes("safari")&&typeof context.touchStarted==="function"){executeDefault=context.touchStarted(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype._onmouseup=function(e){var context=this._isGlobal?window:this;var executeDefault;this._setProperty("mouseIsPressed",false);if(typeof context.mouseReleased==="function"){executeDefault=context.mouseReleased(e);if(executeDefault===false){e.preventDefault()}}else if(typeof context.touchEnded==="function"){executeDefault=context.touchEnded(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype._ondragend=_main.default.prototype._onmouseup;_main.default.prototype._ondragover=_main.default.prototype._onmousemove;_main.default.prototype._onclick=function(e){var context=this._isGlobal?window:this;if(typeof context.mouseClicked==="function"){var executeDefault=context.mouseClicked(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype._ondblclick=function(e){var context=this._isGlobal?window:this;if(typeof context.doubleClicked==="function"){var executeDefault=context.doubleClicked(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype._mouseWheelDeltaY=0;_main.default.prototype._pmouseWheelDeltaY=0;_main.default.prototype._onwheel=function(e){var context=this._isGlobal?window:this;this._setProperty("_mouseWheelDeltaY",e.deltaY);if(typeof context.mouseWheel==="function"){e.delta=e.deltaY;var executeDefault=context.mouseWheel(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype.requestPointerLock=function(){var canvas=this._curElement.elt;canvas.requestPointerLock=canvas.requestPointerLock||canvas.mozRequestPointerLock;if(!canvas.requestPointerLock){console.log("requestPointerLock is not implemented in this browser");return false}canvas.requestPointerLock();return true};_main.default.prototype.exitPointerLock=function(){document.exitPointerLock()};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/main":298,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],318:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.string.includes");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.touches=[];_main.default.prototype._updateTouchCoords=function(e){if(this._curElement!==null){var touches=[];for(var i=0;i<e.touches.length;i++){touches[i]=getTouchInfo(this._curElement.elt,this.width,this.height,e,i)}this._setProperty("touches",touches)}};function getTouchInfo(canvas,w,h,e){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var rect=canvas.getBoundingClientRect();var sx=canvas.scrollWidth/w||1;var sy=canvas.scrollHeight/h||1;var touch=e.touches[i]||e.changedTouches[i];return{x:(touch.clientX-rect.left)/sx,y:(touch.clientY-rect.top)/sy,winX:touch.clientX,winY:touch.clientY,id:touch.identifier}}_main.default.prototype._ontouchstart=function(e){var context=this._isGlobal?window:this;var executeDefault;this._setProperty("mouseIsPressed",true);this._updateTouchCoords(e);this._updateNextMouseCoords(e);this._updateMouseCoords();if(typeof context.touchStarted==="function"){executeDefault=context.touchStarted(e);if(executeDefault===false){e.preventDefault()}}else if(navigator.userAgent.toLowerCase().includes("safari")&&typeof context.mousePressed==="function"){executeDefault=context.mousePressed(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype._ontouchmove=function(e){var context=this._isGlobal?window:this;var executeDefault;this._updateTouchCoords(e);this._updateNextMouseCoords(e);if(typeof context.touchMoved==="function"){executeDefault=context.touchMoved(e);if(executeDefault===false){e.preventDefault()}}else if(typeof context.mouseDragged==="function"){executeDefault=context.mouseDragged(e);if(executeDefault===false){e.preventDefault()}}};_main.default.prototype._ontouchend=function(e){this._setProperty("mouseIsPressed",false);this._updateTouchCoords(e);this._updateNextMouseCoords(e);var context=this._isGlobal?window:this;var executeDefault;if(typeof context.touchEnded==="function"){executeDefault=context.touchEnded(e);if(executeDefault===false){e.preventDefault()}}else if(typeof context.mouseReleased==="function"){executeDefault=context.mouseReleased(e);if(executeDefault===false){e.preventDefault()}}};var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.includes":177,"core-js/modules/es.string.includes":209}],319:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.typed-array.int32-array");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.typed-array.int32-array");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var Filters={_toPixels:function _toPixels(canvas){if(canvas instanceof ImageData){return canvas.data}else{if(canvas.getContext("2d")){return canvas.getContext("2d").getImageData(0,0,canvas.width,canvas.height).data}else if(canvas.getContext("webgl")){var gl=canvas.getContext("webgl");var len=gl.drawingBufferWidth*gl.drawingBufferHeight*4;var data=new Uint8Array(len);gl.readPixels(0,0,canvas.width,canvas.height,gl.RGBA,gl.UNSIGNED_BYTE,data);return data}}},_getARGB:function _getARGB(data,i){var offset=i*4;return data[offset+3]<<24&4278190080|data[offset]<<16&16711680|data[offset+1]<<8&65280|data[offset+2]&255},_setPixels:function _setPixels(pixels,data){var offset=0;for(var i=0,al=pixels.length;i<al;i++){offset=i*4;pixels[offset+0]=(data[i]&16711680)>>>16;pixels[offset+1]=(data[i]&65280)>>>8;pixels[offset+2]=data[i]&255;pixels[offset+3]=(data[i]&4278190080)>>>24}},_toImageData:function _toImageData(canvas){if(canvas instanceof ImageData){return canvas}else{return canvas.getContext("2d").getImageData(0,0,canvas.width,canvas.height)}},_createImageData:function _createImageData(width,height){Filters._tmpCanvas=document.createElement("canvas");Filters._tmpCtx=Filters._tmpCanvas.getContext("2d");return this._tmpCtx.createImageData(width,height)},apply:function apply(canvas,func,filterParam){var pixelsState=canvas.getContext("2d");var imageData=pixelsState.getImageData(0,0,canvas.width,canvas.height);var newImageData=func(imageData,filterParam);if(newImageData instanceof ImageData){pixelsState.putImageData(newImageData,0,0,0,0,canvas.width,canvas.height)}else{pixelsState.putImageData(imageData,0,0,0,0,canvas.width,canvas.height)}},threshold:function threshold(canvas,level){var pixels=Filters._toPixels(canvas);if(level===undefined){level=.5}var thresh=Math.floor(level*255);for(var i=0;i<pixels.length;i+=4){var r=pixels[i];var g=pixels[i+1];var b=pixels[i+2];var gray=.2126*r+.7152*g+.0722*b;var val=void 0;if(gray>=thresh){val=255}else{val=0}pixels[i]=pixels[i+1]=pixels[i+2]=val}},gray:function gray(canvas){var pixels=Filters._toPixels(canvas);for(var i=0;i<pixels.length;i+=4){var r=pixels[i];var g=pixels[i+1];var b=pixels[i+2];var gray=.2126*r+.7152*g+.0722*b;pixels[i]=pixels[i+1]=pixels[i+2]=gray}},opaque:function opaque(canvas){var pixels=Filters._toPixels(canvas);for(var i=0;i<pixels.length;i+=4){pixels[i+3]=255}return pixels},invert:function invert(canvas){var pixels=Filters._toPixels(canvas);for(var i=0;i<pixels.length;i+=4){pixels[i]=255-pixels[i];pixels[i+1]=255-pixels[i+1];pixels[i+2]=255-pixels[i+2]}},posterize:function posterize(canvas,level){var pixels=Filters._toPixels(canvas);if(level===undefined){level=4}if(level<2||level>255){throw new Error("Level must be greater than 2 and less than 255 for posterize")}var levels1=level-1;for(var i=0;i<pixels.length;i+=4){var rlevel=pixels[i];var glevel=pixels[i+1];var blevel=pixels[i+2];pixels[i]=(rlevel*level>>8)*255/levels1;pixels[i+1]=(glevel*level>>8)*255/levels1;pixels[i+2]=(blevel*level>>8)*255/levels1}},dilate:function dilate(canvas){var pixels=Filters._toPixels(canvas);var currIdx=0;var maxIdx=pixels.length?pixels.length/4:0;var out=new Int32Array(maxIdx);var currRowIdx,maxRowIdx,colOrig,colOut,currLum;var idxRight,idxLeft,idxUp,idxDown;var colRight,colLeft,colUp,colDown;var lumRight,lumLeft,lumUp,lumDown;while(currIdx<maxIdx){currRowIdx=currIdx;maxRowIdx=currIdx+canvas.width;while(currIdx<maxRowIdx){colOrig=colOut=Filters._getARGB(pixels,currIdx);idxLeft=currIdx-1;idxRight=currIdx+1;idxUp=currIdx-canvas.width;idxDown=currIdx+canvas.width;if(idxLeft<currRowIdx){idxLeft=currIdx}if(idxRight>=maxRowIdx){idxRight=currIdx}if(idxUp<0){idxUp=0}if(idxDown>=maxIdx){idxDown=currIdx}colUp=Filters._getARGB(pixels,idxUp);colLeft=Filters._getARGB(pixels,idxLeft);colDown=Filters._getARGB(pixels,idxDown);colRight=Filters._getARGB(pixels,idxRight);currLum=77*(colOrig>>16&255)+151*(colOrig>>8&255)+28*(colOrig&255);lumLeft=77*(colLeft>>16&255)+151*(colLeft>>8&255)+28*(colLeft&255);lumRight=77*(colRight>>16&255)+151*(colRight>>8&255)+28*(colRight&255);lumUp=77*(colUp>>16&255)+151*(colUp>>8&255)+28*(colUp&255);lumDown=77*(colDown>>16&255)+151*(colDown>>8&255)+28*(colDown&255);if(lumLeft>currLum){colOut=colLeft;currLum=lumLeft}if(lumRight>currLum){colOut=colRight;currLum=lumRight}if(lumUp>currLum){colOut=colUp;currLum=lumUp}if(lumDown>currLum){colOut=colDown;currLum=lumDown}out[currIdx++]=colOut}}Filters._setPixels(pixels,out)},erode:function erode(canvas){var pixels=Filters._toPixels(canvas);var currIdx=0;var maxIdx=pixels.length?pixels.length/4:0;var out=new Int32Array(maxIdx);var currRowIdx,maxRowIdx,colOrig,colOut,currLum;var idxRight,idxLeft,idxUp,idxDown;var colRight,colLeft,colUp,colDown;var lumRight,lumLeft,lumUp,lumDown;while(currIdx<maxIdx){currRowIdx=currIdx;maxRowIdx=currIdx+canvas.width;while(currIdx<maxRowIdx){colOrig=colOut=Filters._getARGB(pixels,currIdx);idxLeft=currIdx-1;idxRight=currIdx+1;idxUp=currIdx-canvas.width;idxDown=currIdx+canvas.width;if(idxLeft<currRowIdx){idxLeft=currIdx}if(idxRight>=maxRowIdx){idxRight=currIdx}if(idxUp<0){idxUp=0}if(idxDown>=maxIdx){idxDown=currIdx}colUp=Filters._getARGB(pixels,idxUp);colLeft=Filters._getARGB(pixels,idxLeft);colDown=Filters._getARGB(pixels,idxDown);colRight=Filters._getARGB(pixels,idxRight);currLum=77*(colOrig>>16&255)+151*(colOrig>>8&255)+28*(colOrig&255);lumLeft=77*(colLeft>>16&255)+151*(colLeft>>8&255)+28*(colLeft&255);lumRight=77*(colRight>>16&255)+151*(colRight>>8&255)+28*(colRight&255);lumUp=77*(colUp>>16&255)+151*(colUp>>8&255)+28*(colUp&255);lumDown=77*(colDown>>16&255)+151*(colDown>>8&255)+28*(colDown&255);if(lumLeft<currLum){colOut=colLeft;currLum=lumLeft}if(lumRight<currLum){colOut=colRight;currLum=lumRight}if(lumUp<currLum){colOut=colUp;currLum=lumUp}if(lumDown<currLum){colOut=colDown;currLum=lumDown}out[currIdx++]=colOut}}Filters._setPixels(pixels,out)},blur:function blur(canvas,radius){blurARGB(canvas,radius)}};var blurRadius;var blurKernelSize;var blurKernel;var blurMult;function buildBlurKernel(r){var radius=r*3.5|0;radius=radius<1?1:radius<248?radius:248;if(blurRadius!==radius){blurRadius=radius;blurKernelSize=1+blurRadius<<1;blurKernel=new Int32Array(blurKernelSize);blurMult=new Array(blurKernelSize);for(var l=0;l<blurKernelSize;l++){blurMult[l]=new Int32Array(256)}var bk,bki;var bm,bmi;for(var i=1,radiusi=radius-1;i<radius;i++){blurKernel[radius+i]=blurKernel[radiusi]=bki=radiusi*radiusi;bm=blurMult[radius+i];bmi=blurMult[radiusi--];for(var j=0;j<256;j++){bm[j]=bmi[j]=bki*j}}bk=blurKernel[radius]=radius*radius;bm=blurMult[radius];for(var k=0;k<256;k++){bm[k]=bk*k}}}function blurARGB(canvas,radius){var pixels=Filters._toPixels(canvas);var width=canvas.width;var height=canvas.height;var numPackedPixels=width*height;var argb=new Int32Array(numPackedPixels);for(var j=0;j<numPackedPixels;j++){argb[j]=Filters._getARGB(pixels,j)}var sum,cr,cg,cb,ca;var read,ri,ym,ymi,bk0;var a2=new Int32Array(numPackedPixels);var r2=new Int32Array(numPackedPixels);var g2=new Int32Array(numPackedPixels);var b2=new Int32Array(numPackedPixels);var yi=0;buildBlurKernel(radius);var x,y,i;var bm;for(y=0;y<height;y++){for(x=0;x<width;x++){cb=cg=cr=ca=sum=0;read=x-blurRadius;if(read<0){bk0=-read;read=0}else{if(read>=width){break}bk0=0}for(i=bk0;i<blurKernelSize;i++){if(read>=width){break}var c=argb[read+yi];bm=blurMult[i];ca+=bm[(c&-16777216)>>>24];cr+=bm[(c&16711680)>>16];cg+=bm[(c&65280)>>8];cb+=bm[c&255];sum+=blurKernel[i];read++}ri=yi+x;a2[ri]=ca/sum;r2[ri]=cr/sum;g2[ri]=cg/sum;b2[ri]=cb/sum}yi+=width}yi=0;ym=-blurRadius;ymi=ym*width;for(y=0;y<height;y++){for(x=0;x<width;x++){cb=cg=cr=ca=sum=0;if(ym<0){bk0=ri=-ym;read=x}else{if(ym>=height){break}bk0=0;ri=ym;read=x+ymi}for(i=bk0;i<blurKernelSize;i++){if(ri>=height){break}bm=blurMult[i];ca+=bm[a2[read]];cr+=bm[r2[read]];cg+=bm[g2[read]];cb+=bm[b2[read]];sum+=blurKernel[i];ri++;read+=width}argb[x+yi]=ca/sum<<24|cr/sum<<16|cg/sum<<8|cb/sum}yi+=width;ymi+=width;ym++}Filters._setPixels(pixels,argb)}var _default=Filters;exports.default=_default},{"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.to-string":200,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.int32-array":235,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint8-array":252}],320:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.set");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.uint32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.set");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.uint32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var _omggif=_interopRequireDefault(_dereq_("omggif"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}_main.default.prototype.createImage=function(width,height){_main.default._validateParameters("createImage",arguments);return new _main.default.Image(width,height)};_main.default.prototype.saveCanvas=function(){_main.default._validateParameters("saveCanvas",arguments);var args=[].slice.call(arguments);var htmlCanvas,filename,extension,temporaryGraphics;if(arguments[0]instanceof HTMLCanvasElement){htmlCanvas=arguments[0];args.shift()}else if(arguments[0]instanceof _main.default.Element){htmlCanvas=arguments[0].elt;args.shift()}else if(arguments[0]instanceof _main.default.Framebuffer){var framebuffer=arguments[0];temporaryGraphics=this.createGraphics(framebuffer.width,framebuffer.height);temporaryGraphics.pixelDensity(pixelDensity());framebuffer.loadPixels();temporaryGraphics.loadPixels();temporaryGraphics.pixels.set(framebuffer.pixels);temporaryGraphics.updatePixels();htmlCanvas=temporaryGraphics.elt;args.shift()}else{htmlCanvas=this._curElement&&this._curElement.elt}if(args.length>=1){filename=args[0]}if(args.length>=2){extension=args[1]}extension=extension||_main.default.prototype._checkFileExtension(filename,extension)[1]||"png";var mimeType;switch(extension){default:mimeType="image/png";break;case"jpeg":case"jpg":mimeType="image/jpeg";break}htmlCanvas.toBlob(function(blob){_main.default.prototype.downloadFile(blob,filename,extension);if(temporaryGraphics)temporaryGraphics.remove()},mimeType)};_main.default.prototype.encodeAndDownloadGif=function(pImg,filename){var props=pImg.gifProperties;var loopLimit=props.loopLimit;if(loopLimit===1){loopLimit=null}else if(loopLimit===null){loopLimit=0}var buffer=new Uint8Array(pImg.width*pImg.height*props.numFrames);var allFramesPixelColors=[];var paletteFreqsAndFrames={};for(var i=0;i<props.numFrames;i++){var paletteSet=new Set;var data=props.frames[i].image.data;var dataLength=data.length;var pixelColors=new Uint32Array(pImg.width*pImg.height);for(var j=0,k=0;j<dataLength;j+=4,k++){var r=data[j+0];var g=data[j+1];var b=data[j+2];var color=r<<16|g<<8|b<<0;paletteSet.add(color);pixelColors[k]=color}var paletteStr=_toConsumableArray(paletteSet).sort().toString();if(paletteFreqsAndFrames[paletteStr]===undefined){paletteFreqsAndFrames[paletteStr]={freq:1,frames:[i]}}else{paletteFreqsAndFrames[paletteStr].freq+=1;paletteFreqsAndFrames[paletteStr].frames.push(i)}allFramesPixelColors.push(pixelColors)}var framesUsingGlobalPalette=[];var palettesSortedByFreq=Object.keys(paletteFreqsAndFrames).sort(function(a,b){return paletteFreqsAndFrames[b].freq-paletteFreqsAndFrames[a].freq});var globalPalette=palettesSortedByFreq[0].split(",").map(function(a){return parseInt(a)});framesUsingGlobalPalette=framesUsingGlobalPalette.concat(paletteFreqsAndFrames[globalPalette].frames);var globalPaletteSet=new Set(globalPalette);for(var _i=1;_i<palettesSortedByFreq.length;_i++){var palette=palettesSortedByFreq[_i].split(",").map(function(a){return parseInt(a)});var difference=palette.filter(function(x){return!globalPaletteSet.has(x)});if(globalPalette.length+difference.length<=256){for(var _j=0;_j<difference.length;_j++){globalPalette.push(difference[_j]);globalPaletteSet.add(difference[_j])}framesUsingGlobalPalette=framesUsingGlobalPalette.concat(paletteFreqsAndFrames[palettesSortedByFreq[_i]].frames)}}framesUsingGlobalPalette=new Set(framesUsingGlobalPalette);var globalIndicesLookup={};for(var _i2=0;_i2<globalPalette.length;_i2++){if(!globalIndicesLookup[globalPalette[_i2]]){globalIndicesLookup[globalPalette[_i2]]=_i2}}var powof2=1;while(powof2<globalPalette.length){powof2<<=1}globalPalette.length=powof2;var opts={loop:loopLimit,palette:new Uint32Array(globalPalette)};var gifWriter=new _omggif.default.GifWriter(buffer,pImg.width,pImg.height,opts);var previousFrame={};var _loop=function _loop(_i3){var localPaletteRequired=!framesUsingGlobalPalette.has(_i3);var palette=localPaletteRequired?[]:globalPalette;var pixelPaletteIndex=new Uint8Array(pImg.width*pImg.height);var colorIndicesLookup={};var cannotBeTransparent=new Set;allFramesPixelColors[_i3].forEach(function(color,k){if(localPaletteRequired){if(colorIndicesLookup[color]===undefined){colorIndicesLookup[color]=palette.length;palette.push(color)}pixelPaletteIndex[k]=colorIndicesLookup[color]}else{pixelPaletteIndex[k]=globalIndicesLookup[color]}if(_i3>0){if(allFramesPixelColors[_i3-1][k]!==color){cannotBeTransparent.add(color)}}});var frameOpts={};var canBeTransparent=palette.filter(function(a){return!cannotBeTransparent.has(a)});if(canBeTransparent.length>0){var transparent=canBeTransparent[0];var transparentIndex=localPaletteRequired?colorIndicesLookup[transparent]:globalIndicesLookup[transparent];if(_i3>0){for(var _k=0;_k<allFramesPixelColors[_i3].length;_k++){if(allFramesPixelColors[_i3-1][_k]===allFramesPixelColors[_i3][_k]){pixelPaletteIndex[_k]=transparentIndex}}frameOpts.transparent=transparentIndex;previousFrame.frameOpts.disposal=1}}frameOpts.delay=props.frames[_i3].delay/10;if(localPaletteRequired){var _powof=1;while(_powof<palette.length){_powof<<=1}palette.length=_powof;frameOpts.palette=new Uint32Array(palette)}if(_i3>0){gifWriter.addFrame(0,0,pImg.width,pImg.height,previousFrame.pixelPaletteIndex,previousFrame.frameOpts)}previousFrame={pixelPaletteIndex:pixelPaletteIndex,frameOpts:frameOpts}};for(var _i3=0;_i3<props.numFrames;_i3++){_loop(_i3)}previousFrame.frameOpts.disposal=1;gifWriter.addFrame(0,0,pImg.width,pImg.height,previousFrame.pixelPaletteIndex,previousFrame.frameOpts);var extension="gif";var blob=new Blob([buffer.slice(0,gifWriter.end())],{type:"image/gif"});_main.default.prototype.downloadFile(blob,filename,extension)};_main.default.prototype.saveFrames=function(fName,ext,_duration,_fps,callback){_main.default._validateParameters("saveFrames",arguments);var duration=_duration||3;duration=_main.default.prototype.constrain(duration,0,15);duration=duration*1e3;var fps=_fps||15;fps=_main.default.prototype.constrain(fps,0,22);var count=0;var makeFrame=_main.default.prototype._makeFrame;var cnv=this._curElement.elt;var frames=[];var frameFactory=setInterval(function(){frames.push(makeFrame(fName+count,ext,cnv));count++},1e3/fps);setTimeout(function(){clearInterval(frameFactory);if(callback){callback(frames)}else{for(var _i4=0,_frames=frames;_i4<_frames.length;_i4++){var f=_frames[_i4];_main.default.prototype.downloadFile(f.imageData,f.filename,f.ext)}}frames=[]},duration+.01)};_main.default.prototype._makeFrame=function(filename,extension,_cnv){var cnv;if(this){cnv=this._curElement.elt}else{cnv=_cnv}var mimeType;if(!extension){extension="png";mimeType="image/png"}else{switch(extension.toLowerCase()){case"png":mimeType="image/png";break;case"jpeg":mimeType="image/jpeg";break;case"jpg":mimeType="image/jpeg";break;default:mimeType="image/png";break}}var downloadMime="image/octet-stream";var imageData=cnv.toDataURL(mimeType);imageData=imageData.replace(mimeType,downloadMime);var thisFrame={};thisFrame.imageData=imageData;thisFrame.filename=filename;thisFrame.ext=extension;return thisFrame};var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.filter":173,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.from":176,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.keys":199,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.set":207,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.replace":214,"core-js/modules/es.string.split":216,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint32-array":251,"core-js/modules/es.typed-array.uint8-array":252,"core-js/modules/web.dom-collections.for-each":255,"core-js/modules/web.dom-collections.iterator":256,omggif:270}],321:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.copy-within");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.uint8-clamped-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.copy-within");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.uint8-clamped-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;_dereq_("regenerator-runtime/runtime");var _main=_interopRequireDefault(_dereq_("../core/main"));var _helpers=_interopRequireDefault(_dereq_("../core/helpers"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));var _omggif=_interopRequireDefault(_dereq_("omggif"));var _gifenc=_dereq_("gifenc");_dereq_("../core/friendly_errors/validate_params");_dereq_("../core/friendly_errors/file_errors");_dereq_("../core/friendly_errors/fes_core");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(undefined)})}}_main.default.prototype.loadImage=function(path,successCallback,failureCallback){_main.default._validateParameters("loadImage",arguments);var pImg=new _main.default.Image(1,1,this);var self=this;var req=new Request(path,{method:"GET",mode:"cors"});fetch(path,req).then(function(response){var contentType=response.headers.get("content-type");if(contentType===null){console.warn("The image you loaded does not have a Content-Type header. If you are using the online editor consider reuploading the asset.")}if(contentType&&contentType.includes("image/gif")){response.arrayBuffer().then(function(arrayBuffer){if(arrayBuffer){var byteArray=new Uint8Array(arrayBuffer);_createGif(byteArray,pImg,successCallback,failureCallback,function(pImg){self._decrementPreload()}.bind(self))}},function(e){if(typeof failureCallback==="function"){failureCallback(e);self._decrementPreload()}else{console.error(e)}})}else{var img=new Image;img.onload=function(){pImg.width=pImg.canvas.width=img.width;pImg.height=pImg.canvas.height=img.height;pImg.drawingContext.drawImage(img,0,0);pImg.modified=true;if(typeof successCallback==="function"){successCallback(pImg)}self._decrementPreload()};img.onerror=function(e){_main.default._friendlyFileLoadError(0,img.src);if(typeof failureCallback==="function"){failureCallback(e);self._decrementPreload()}else{console.error(e)}};if(path.indexOf("data:image/")!==0){img.crossOrigin="Anonymous"}img.src=path}pImg.modified=true}).catch(function(e){_main.default._friendlyFileLoadError(0,path);if(typeof failureCallback==="function"){failureCallback(e);self._decrementPreload()}else{console.error(e)}});return pImg};_main.default.prototype.saveGif=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(fileName,duration){var options,delay,units,silent,notificationDuration,notificationID,_frameRate,gifFrameDelay,nFrames,nFramesDelay,totalNumberOfFrames,frameIterator,lastPixelDensity,frames,p,pixels,gl,data,gif,globalPalette,paletteCache,getIndexedFrame,transparentIndex,prevIndexedFrame,i,indexedFrame,originalIndexedFrame,_i,buffer,extension,blob,_args=arguments;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:options=_args.length>2&&_args[2]!==undefined?_args[2]:{delay:0,units:"seconds",silent:false,notificationDuration:0,notificationID:"progressBar"};if(!(typeof fileName!=="string")){_context.next=3;break}throw TypeError("fileName parameter must be a string");case 3:if(!(typeof duration!=="number")){_context.next=5;break}throw TypeError("Duration parameter must be a number");case 5:delay=options&&options.delay||0;units=options&&options.units||"seconds";silent=options&&options.silent||false;notificationDuration=options&&options.notificationDuration||0;notificationID=options&&options.notificationID||"progressBar";if(!(typeof delay!=="number")){_context.next=12;break}throw TypeError("Delay parameter must be a number");case 12:if(!(units!=="seconds"&&units!=="frames")){_context.next=14;break}throw TypeError('Units parameter must be either "frames" or "seconds"');case 14:if(!(typeof silent!=="boolean")){_context.next=16;break}throw TypeError("Silent parameter must be a boolean");case 16:if(!(typeof notificationDuration!=="number")){_context.next=18;break}throw TypeError("Notification duration parameter must be a number");case 18:if(!(typeof notificationID!=="string")){_context.next=20;break}throw TypeError("Notification ID parameter must be a string");case 20:this._recording=true;_frameRate=this._targetFrameRate;if(_frameRate===Infinity||_frameRate===undefined||_frameRate===0){_frameRate=60}gifFrameDelay=1/_frameRate*1e3;gifFrameDelay=gifFrameDelay<20?20:gifFrameDelay;nFrames=units==="seconds"?duration*_frameRate:duration;nFramesDelay=units==="seconds"?delay*_frameRate:delay;totalNumberOfFrames=nFrames+nFramesDelay;frameIterator=nFramesDelay;this.frameCount=frameIterator;lastPixelDensity=this._pixelDensity;this.pixelDensity(1);frames=[];if(document.getElementById(notificationID)!==null)document.getElementById(notificationID).remove();if(!silent){p=this.createP("");p.id(notificationID);p.style("font-size","16px");p.style("font-family","Montserrat");p.style("background-color","#ffffffa0");p.style("padding","8px");p.style("border-radius","10px");p.position(0,0)}if(this._renderer instanceof _main.default.RendererGL){gl=this.drawingContext;pixels=new Uint8Array(gl.drawingBufferWidth*gl.drawingBufferHeight*4)}this.noLoop();_context.next=39;return Promise.resolve();case 39:if(!(frameIterator<totalNumberOfFrames)){_context.next=50;break}this.redraw();data=undefined;if(this._renderer instanceof _main.default.RendererGL){pixels=new Uint8Array(gl.drawingBufferWidth*gl.drawingBufferHeight*4);gl.readPixels(0,0,gl.drawingBufferWidth,gl.drawingBufferHeight,gl.RGBA,gl.UNSIGNED_BYTE,pixels);data=_flipPixels(pixels)}else{data=this.drawingContext.getImageData(0,0,this.width,this.height).data}frames.push(data);frameIterator++;if(!silent){p.html("Saved frame <b>"+frames.length.toString()+"</b> out of "+nFrames.toString())}_context.next=48;return new Promise(function(resolve){return setTimeout(resolve,0)});case 48:_context.next=39;break;case 50:if(!silent)p.html("Frames processed, generating color palette...");this.loop();this.pixelDensity(lastPixelDensity);gif=(0,_gifenc.GIFEncoder)();globalPalette=_generateGlobalPalette(frames);paletteCache={};getIndexedFrame=function getIndexedFrame(frame){var length=frame.length/4;var index=new Uint8Array(length);for(var i=0;i<length;i++){var key=frame[i*4]<<24|frame[i*4+1]<<16|frame[i*4+2]<<8|frame[i*4+3];if(paletteCache[key]===undefined){paletteCache[key]=(0,_gifenc.nearestColorIndex)(globalPalette,frame.slice(i*4,(i+1)*4))}index[i]=paletteCache[key]}return index};transparentIndex=globalPalette.length-1;prevIndexedFrame=[];i=0;case 60:if(!(i<frames.length)){_context.next=71;break}indexedFrame=getIndexedFrame(frames[i]);originalIndexedFrame=indexedFrame.slice();if(i===0){gif.writeFrame(indexedFrame,this.width,this.height,{palette:globalPalette,delay:gifFrameDelay,dispose:1})}else{for(_i=0;_i<indexedFrame.length;_i++){if(indexedFrame[_i]===prevIndexedFrame[_i]){indexedFrame[_i]=transparentIndex}}gif.writeFrame(indexedFrame,this.width,this.height,{delay:gifFrameDelay,transparent:true,transparentIndex:transparentIndex,dispose:1})}prevIndexedFrame=originalIndexedFrame;if(!silent){p.html("Rendered frame <b>"+i.toString()+"</b> out of "+nFrames.toString())}_context.next=68;return new Promise(function(resolve){return setTimeout(resolve,0)});case 68:i++;_context.next=60;break;case 71:gif.finish();buffer=gif.bytesView();extension="gif";blob=new Blob([buffer],{type:"image/gif"});frames=[];this._recording=false;this.loop();if(!silent){p.html("Done. Downloading your gif!🌸");if(notificationDuration>0)setTimeout(function(){return p.remove()},notificationDuration*1e3)}_main.default.prototype.downloadFile(blob,fileName,extension);case 80:case"end":return _context.stop()}}},_callee,this)}));return function(_x,_x2){return _ref.apply(this,arguments)}}();function _flipPixels(pixels){var halfHeight=parseInt(height/2);var bytesPerRow=width*4;var temp=new Uint8Array(width*4);for(var y=0;y<halfHeight;++y){var topOffset=y*bytesPerRow;var bottomOffset=(height-y-1)*bytesPerRow;temp.set(pixels.subarray(topOffset,topOffset+bytesPerRow));pixels.copyWithin(topOffset,bottomOffset,bottomOffset+bytesPerRow);pixels.set(temp,bottomOffset)}return pixels}function _generateGlobalPalette(frames){var allColors=new Uint8Array(frames.length*frames[0].length);for(var f=0;f<frames.length;f++){allColors.set(frames[f],f*frames[0].length)}var colorPalette=(0,_gifenc.quantize)(allColors,256,{format:"rgba4444",oneBitAlpha:true});if(colorPalette.length===256){colorPalette[colorPalette.length-1]=[Math.random()*255,Math.random()*255,Math.random()*255,0]}else{colorPalette.push([Math.random()*255,Math.random()*255,Math.random()*255,0])}return colorPalette}function _createGif(arrayBuffer,pImg,successCallback,failureCallback,finishCallback){var gifReader=new _omggif.default.GifReader(arrayBuffer);pImg.width=pImg.canvas.width=gifReader.width;pImg.height=pImg.canvas.height=gifReader.height;var frames=[];var numFrames=gifReader.numFrames();var framePixels=new Uint8ClampedArray(pImg.width*pImg.height*4);var loadGIFFrameIntoImage=function loadGIFFrameIntoImage(frameNum,gifReader){try{gifReader.decodeAndBlitFrameRGBA(frameNum,framePixels)}catch(e){_main.default._friendlyFileLoadError(8,pImg.src);if(typeof failureCallback==="function"){failureCallback(e)}else{console.error(e)}}};for(var j=0;j<numFrames;j++){var frameInfo=gifReader.frameInfo(j);var prevFrameData=pImg.drawingContext.getImageData(0,0,pImg.width,pImg.height);framePixels=prevFrameData.data.slice();loadGIFFrameIntoImage(j,gifReader);var imageData=new ImageData(framePixels,pImg.width,pImg.height);pImg.drawingContext.putImageData(imageData,0,0);var frameDelay=frameInfo.delay;if(frameDelay===0){frameDelay=10}frames.push({image:pImg.drawingContext.getImageData(0,0,pImg.width,pImg.height),delay:frameDelay*10});if(frameInfo.disposal===2){pImg.drawingContext.clearRect(frameInfo.x,frameInfo.y,frameInfo.width,frameInfo.height)}else if(frameInfo.disposal===3){pImg.drawingContext.putImageData(prevFrameData,0,0,frameInfo.x,frameInfo.y,frameInfo.width,frameInfo.height)}}var loopLimit=gifReader.loopCount();if(loopLimit===null){loopLimit=1}else if(loopLimit===0){loopLimit=null}pImg.drawingContext.putImageData(frames[0].image,0,0);if(frames.length>1){pImg.gifProperties={displayIndex:0,loopLimit:loopLimit,loopCount:0,frames:frames,numFrames:numFrames,playing:true,timeDisplayed:0,lastChangeTime:0}}if(typeof successCallback==="function"){successCallback(pImg)}finishCallback()}function _imageContain(xAlign,yAlign,dx,dy,dw,dh,sw,sh){var r=Math.max(sw/dw,sh/dh);var adjusted_dw=sw/r,adjusted_dh=sh/r;var x=dx;var y=dy;if(xAlign===constants.CENTER){x+=(dw-adjusted_dw)/2}else if(xAlign===constants.RIGHT){x+=dw-adjusted_dw}if(yAlign===constants.CENTER){y+=(dh-adjusted_dh)/2}else if(yAlign===constants.BOTTOM){y+=dh-adjusted_dh}return{x:x,y:y,w:adjusted_dw,h:adjusted_dh}}function _imageCover(xAlign,yAlign,dw,dh,sx,sy,sw,sh){var r=Math.max(dw/sw,dh/sh);var adjusted_sw=dw/r,adjusted_sh=dh/r;var x=sx;var y=sy;if(xAlign===constants.CENTER){x+=(sw-adjusted_sw)/2}else if(xAlign===constants.RIGHT){x+=sw-adjusted_sw}if(yAlign===constants.CENTER){y+=(sh-adjusted_sh)/2}else if(yAlign===constants.BOTTOM){y+=sh-adjusted_sh}return{x:x,y:y,w:adjusted_sw,h:adjusted_sh}}function _imageFit(fit,xAlign,yAlign,dx,dy,dw,dh,sx,sy,sw,sh){if(fit===constants.COVER){var _imageCover2=_imageCover(xAlign,yAlign,dw,dh,sx,sy,sw,sh),x=_imageCover2.x,y=_imageCover2.y,w=_imageCover2.w,h=_imageCover2.h;sx=x;sy=y;sw=w;sh=h}if(fit===constants.CONTAIN){var _imageContain2=_imageContain(xAlign,yAlign,dx,dy,dw,dh,sw,sh),_x3=_imageContain2.x,_y=_imageContain2.y,_w=_imageContain2.w,_h=_imageContain2.h;dx=_x3;dy=_y;dw=_w;dh=_h}return{sx:sx,sy:sy,sw:sw,sh:sh,dx:dx,dy:dy,dw:dw,dh:dh}}function _sAssign(sVal,iVal){if(sVal>0&&sVal<iVal){return sVal}else{return iVal}}_main.default.prototype.image=function(img,dx,dy,dWidth,dHeight,sx,sy,sWidth,sHeight,fit,xAlign,yAlign){_main.default._validateParameters("image",arguments);var defW=img.width;var defH=img.height;yAlign=yAlign||constants.CENTER;xAlign=xAlign||constants.CENTER;if(img.elt){defW=defW!==undefined?defW:img.elt.width;defH=defH!==undefined?defH:img.elt.height}if(img.elt&&img.elt.videoWidth&&!img.canvas){defW=defW!==undefined?defW:img.elt.videoWidth;defH=defH!==undefined?defH:img.elt.videoHeight}var _dx=dx;var _dy=dy;var _dw=dWidth||defW;var _dh=dHeight||defH;var _sx=sx||0;var _sy=sy||0;var _sw=sWidth!==undefined?sWidth:defW;var _sh=sHeight!==undefined?sHeight:defH;_sw=_sAssign(_sw,defW);_sh=_sAssign(_sh,defH);var pd=1;if(img.elt&&!img.canvas&&img.elt.style.width){if(img.elt.videoWidth&&!dWidth){pd=img.elt.videoWidth}else{pd=img.elt.width}pd/=parseInt(img.elt.style.width,10)}_sx*=pd;_sy*=pd;_sh*=pd;_sw*=pd;var vals=_helpers.default.modeAdjust(_dx,_dy,_dw,_dh,this._renderer._imageMode);vals=_imageFit(fit,xAlign,yAlign,vals.x,vals.y,vals.w,vals.h,_sx,_sy,_sw,_sh);this._renderer.image(img,vals.sx,vals.sy,vals.sw,vals.sh,vals.dx,vals.dy,vals.dw,vals.dh)};_main.default.prototype.tint=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("tint",args);var c=this.color.apply(this,args);this._renderer._tint=c.levels};_main.default.prototype.noTint=function(){this._renderer._tint=null};_main.default.prototype._getTintedImageCanvas=_main.default.Renderer2D.prototype._getTintedImageCanvas;_main.default.prototype.imageMode=function(m){_main.default._validateParameters("imageMode",arguments);if(m===constants.CORNER||m===constants.CORNERS||m===constants.CENTER){this._renderer._imageMode=m}};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/friendly_errors/fes_core":289,"../core/friendly_errors/file_errors":290,"../core/friendly_errors/validate_params":293,"../core/helpers":294,"../core/main":298,"core-js/modules/es.array.copy-within":170,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.promise":201,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint8-array":252,"core-js/modules/es.typed-array.uint8-clamped-array":253,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256,gifenc:263,omggif:270,"regenerator-runtime/runtime":274}],322:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var _filters=_interopRequireDefault(_dereq_("./filters"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.Image=function(){function _class(width,height){_classCallCheck(this,_class);this.width=width;this.height=height;this.canvas=document.createElement("canvas");this.canvas.width=this.width;this.canvas.height=this.height;this.drawingContext=this.canvas.getContext("2d");this._pixelsState=this;this._pixelDensity=1;this.gifProperties=null;this._modified=false;this.pixels=[]}_createClass(_class,[{key:"pixelDensity",value:function pixelDensity(density){if(typeof density!=="undefined"){if(density<=0){var errorObj={type:"INVALID_VALUE",format:{types:["Number"]},position:1};_main.default._friendlyParamError(errorObj,"pixelDensity");density=1}this._pixelDensity=density;this.width/=density;this.height/=density;return this}else{return this._pixelDensity}}},{key:"_animateGif",value:function _animateGif(pInst){var props=this.gifProperties;var curTime=pInst._lastRealFrameTime;if(props.lastChangeTime===0){props.lastChangeTime=curTime}if(props.playing){props.timeDisplayed=curTime-props.lastChangeTime;var curDelay=props.frames[props.displayIndex].delay;if(props.timeDisplayed>=curDelay){var skips=Math.floor(props.timeDisplayed/curDelay);props.timeDisplayed=0;props.lastChangeTime=curTime;props.displayIndex+=skips;props.loopCount=Math.floor(props.displayIndex/props.numFrames);if(props.loopLimit!==null&&props.loopCount>=props.loopLimit){props.playing=false}else{var ind=props.displayIndex%props.numFrames;this.drawingContext.putImageData(props.frames[ind].image,0,0);props.displayIndex=ind;this.setModified(true)}}}}},{key:"_setProperty",value:function _setProperty(prop,value){this[prop]=value;this.setModified(true)}},{key:"loadPixels",value:function loadPixels(){_main.default.Renderer2D.prototype.loadPixels.call(this);this.setModified(true)}},{key:"updatePixels",value:function updatePixels(x,y,w,h){_main.default.Renderer2D.prototype.updatePixels.call(this,x,y,w,h);this.setModified(true)}},{key:"get",value:function get(x,y,w,h){_main.default._validateParameters("p5.Image.get",arguments);return _main.default.Renderer2D.prototype.get.apply(this,arguments)}},{key:"_getPixel",value:function _getPixel(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _main.default.Renderer2D.prototype._getPixel.apply(this,args)}},{key:"set",value:function set(x,y,imgOrCol){_main.default.Renderer2D.prototype.set.call(this,x,y,imgOrCol);this.setModified(true)}},{key:"resize",value:function resize(width,height){if(width===0&&height===0){width=this.canvas.width;height=this.canvas.height}else if(width===0){width=this.canvas.width*height/this.canvas.height}else if(height===0){height=this.canvas.height*width/this.canvas.width}width=Math.floor(width);height=Math.floor(height);var tempCanvas=document.createElement("canvas");tempCanvas.width=width;tempCanvas.height=height;if(this.gifProperties){var props=this.gifProperties;var nearestNeighbor=function nearestNeighbor(src,dst){var pos=0;for(var y=0;y<dst.height;y++){for(var x=0;x<dst.width;x++){var srcX=Math.floor(x*src.width/dst.width);var srcY=Math.floor(y*src.height/dst.height);var srcPos=(srcY*src.width+srcX)*4;dst.data[pos++]=src.data[srcPos++];dst.data[pos++]=src.data[srcPos++];dst.data[pos++]=src.data[srcPos++];dst.data[pos++]=src.data[srcPos++]}}};for(var i=0;i<props.numFrames;i++){var resizedImageData=this.drawingContext.createImageData(width,height);nearestNeighbor(props.frames[i].image,resizedImageData);props.frames[i].image=resizedImageData}}tempCanvas.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,tempCanvas.width,tempCanvas.height);this.canvas.width=this.width=width;this.canvas.height=this.height=height;this.drawingContext.drawImage(tempCanvas,0,0,width,height,0,0,width,height);if(this.pixels.length>0){this.loadPixels()}this.setModified(true)}},{key:"copy",value:function copy(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default.prototype.copy.apply(this,args)}},{key:"mask",value:function mask(p5Image){if(p5Image===undefined){p5Image=this}var currBlend=this.drawingContext.globalCompositeOperation;var scaleFactor=1;if(p5Image instanceof _main.default.Renderer){scaleFactor=p5Image._pInst._pixelDensity}var copyArgs=[p5Image,0,0,scaleFactor*p5Image.width,scaleFactor*p5Image.height,0,0,this.width,this.height];this.drawingContext.globalCompositeOperation="destination-in";if(this.gifProperties){for(var i=0;i<this.gifProperties.frames.length;i++){this.drawingContext.putImageData(this.gifProperties.frames[i].image,0,0);this.copy.apply(this,copyArgs);this.gifProperties.frames[i].image=this.drawingContext.getImageData(0,0,this.width,this.height)}this.drawingContext.putImageData(this.gifProperties.frames[this.gifProperties.displayIndex].image,0,0)}else{this.copy.apply(this,copyArgs)}this.drawingContext.globalCompositeOperation=currBlend;this.setModified(true)}},{key:"filter",value:function filter(operation,value){_filters.default.apply(this.canvas,_filters.default[operation],value);this.setModified(true)}},{key:"blend",value:function blend(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}_main.default._validateParameters("p5.Image.blend",arguments);_main.default.prototype.blend.apply(this,args);this.setModified(true)}},{key:"setModified",value:function setModified(val){this._modified=val}},{key:"isModified",value:function isModified(){return this._modified}},{key:"save",value:function save(filename,extension){if(this.gifProperties){_main.default.prototype.encodeAndDownloadGif(this,filename)}else{_main.default.prototype.saveCanvas(this.canvas,filename,extension)}}},{key:"reset",value:function reset(){if(this.gifProperties){var props=this.gifProperties;props.playing=true;props.timeSinceStart=0;props.timeDisplayed=0;props.lastChangeTime=0;props.loopCount=0;props.displayIndex=0;this.drawingContext.putImageData(props.frames[0].image,0,0)}}},{key:"getCurrentFrame",value:function getCurrentFrame(){if(this.gifProperties){var props=this.gifProperties;return props.displayIndex%props.numFrames}}},{key:"setFrame",value:function setFrame(index){if(this.gifProperties){var props=this.gifProperties;if(index<props.numFrames&&index>=0){props.timeDisplayed=0;props.lastChangeTime=0;props.displayIndex=index;this.drawingContext.putImageData(props.frames[index].image,0,0)}else{console.log("Cannot set GIF to a frame number that is higher than total number of frames or below zero.")}}}},{key:"numFrames",value:function numFrames(){if(this.gifProperties){return this.gifProperties.numFrames}}},{key:"play",value:function play(){if(this.gifProperties){this.gifProperties.playing=true}}},{key:"pause",value:function pause(){if(this.gifProperties){this.gifProperties.playing=false}}},{key:"delay",value:function delay(d,index){if(this.gifProperties){var props=this.gifProperties;if(index<props.numFrames&&index>=0){props.frames[index].delay=d}else{var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=props.frames[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var frame=_step.value;frame.delay=d}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}}}}]);return _class}();var _default=_main.default.Image;exports.default=_default},{"../core/main":298,"./filters":319,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.iterator":256}],323:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.filter");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var _filters=_interopRequireDefault(_dereq_("./filters"));_dereq_("../color/p5.Color");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.pixels=[];_main.default.prototype.blend=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("blend",args);if(this._renderer){var _this$_renderer;(_this$_renderer=this._renderer).blend.apply(_this$_renderer,args)}else{_main.default.Renderer2D.prototype.blend.apply(this,args)}};_main.default.prototype.copy=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default._validateParameters("copy",args);var srcImage,sx,sy,sw,sh,dx,dy,dw,dh;if(args.length===9){srcImage=args[0];sx=args[1];sy=args[2];sw=args[3];sh=args[4];dx=args[5];dy=args[6];dw=args[7];dh=args[8]}else if(args.length===8){srcImage=this;sx=args[0];sy=args[1];sw=args[2];sh=args[3];dx=args[4];dy=args[5];dw=args[6];dh=args[7]}else{throw new Error("Signature not supported")}_main.default.prototype._copyHelper(this,srcImage,sx,sy,sw,sh,dx,dy,dw,dh)};_main.default.prototype._copyHelper=function(dstImage,srcImage,sx,sy,sw,sh,dx,dy,dw,dh){var s=srcImage.canvas.width/srcImage.width;var sxMod=0;var syMod=0;if(srcImage._renderer&&srcImage._renderer.isP3D){sxMod=srcImage.width/2;syMod=srcImage.height/2}if(dstImage._renderer&&dstImage._renderer.isP3D){_main.default.RendererGL.prototype.image.call(dstImage._renderer,srcImage,sx+sxMod,sy+syMod,sw,sh,dx,dy,dw,dh)}else{dstImage.drawingContext.drawImage(srcImage.canvas,s*(sx+sxMod),s*(sy+syMod),s*sw,s*sh,dx,dy,dw,dh)}};_main.default.prototype.getFilterGraphicsLayer=function(){return this._renderer.getFilterGraphicsLayer()};_main.default.prototype.filter=function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}_main.default._validateParameters("filter",arguments);var _parseFilterArgs=parseFilterArgs.apply(void 0,args),shader=_parseFilterArgs.shader,operation=_parseFilterArgs.operation,value=_parseFilterArgs.value,useWebGL=_parseFilterArgs.useWebGL;if(this._renderer.isP3D&&shader){_main.default.RendererGL.prototype.filter.call(this._renderer,shader);return}if(!useWebGL&&!this._renderer.isP3D){if(this.canvas!==undefined){_filters.default.apply(this.canvas,_filters.default[operation],value)}else{_filters.default.apply(this.elt,_filters.default[operation],value)}return}if(!useWebGL&&this._renderer.isP3D){console.warn("filter() with useWebGL=false is not supported in WEBGL")}if(this._renderer.isP3D){_main.default.RendererGL.prototype.filter.call(this._renderer,operation,value)}else{var filterGraphicsLayer=this.getFilterGraphicsLayer();filterGraphicsLayer.copy(this._renderer,0,0,this.width,this.height,-this.width/2,-this.height/2,this.width,this.height);this._renderer.clear();this._renderer.resetMatrix();filterGraphicsLayer.filter.apply(filterGraphicsLayer,args);this._renderer._pInst.image(filterGraphicsLayer,0,0);filterGraphicsLayer.clear()}};function parseFilterArgs(){var _ref;var result={shader:undefined,operation:undefined,value:undefined,useWebGL:true};if((arguments.length<=0?undefined:arguments[0])instanceof _main.default.Shader){result.shader=arguments.length<=0?undefined:arguments[0];return result}else{result.operation=arguments.length<=0?undefined:arguments[0]}if(arguments.length>1&&typeof(arguments.length<=1?undefined:arguments[1])==="number"){result.value=arguments.length<=1?undefined:arguments[1]}if((_ref=arguments.length-1,_ref<0||arguments.length<=_ref?undefined:arguments[_ref])===false){result.useWebGL=false}return result}_main.default.prototype.get=function(x,y,w,h){var _this$_renderer2;_main.default._validateParameters("get",arguments);return(_this$_renderer2=this._renderer).get.apply(_this$_renderer2,arguments)};_main.default.prototype.loadPixels=function(){for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}_main.default._validateParameters("loadPixels",args);this._renderer.loadPixels()};_main.default.prototype.set=function(x,y,imgOrCol){this._renderer.set(x,y,imgOrCol)};_main.default.prototype.updatePixels=function(x,y,w,h){_main.default._validateParameters("updatePixels",arguments);if(this.pixels.length===0){return}this._renderer.updatePixels(x,y,w,h)};var _default=_main.default;exports.default=_default},{"../color/p5.Color":284,"../core/main":298,"./filters":319,"core-js/modules/es.array.filter":173}],324:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.last-index-of");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.from-entries");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/web.url");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.last-index-of");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.from-entries");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.promise");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/web.url");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));_dereq_("whatwg-fetch");_dereq_("es6-promise/auto");var _fetchJsonp=_interopRequireDefault(_dereq_("fetch-jsonp"));var _fileSaver=_interopRequireDefault(_dereq_("file-saver"));_dereq_("../core/friendly_errors/validate_params");_dereq_("../core/friendly_errors/file_errors");_dereq_("../core/friendly_errors/fes_core");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_main.default.prototype.loadJSON=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("loadJSON",args);var path=args[0];var callback;var errorCallback;var options;var ret={};var t="json";for(var i=1;i<args.length;i++){var arg=args[i];if(typeof arg==="string"){if(arg==="jsonp"||arg==="json"){t=arg}}else if(typeof arg==="function"){if(!callback){callback=arg}else{errorCallback=arg}}else if(_typeof(arg)==="object"&&(arg.hasOwnProperty("jsonpCallback")||arg.hasOwnProperty("jsonpCallbackFunction"))){t="jsonp";options=arg}}var self=this;this.httpDo(path,"GET",options,t,function(resp){for(var k in resp){ret[k]=resp[k]}if(typeof callback!=="undefined"){callback(resp)}self._decrementPreload()},function(err){_main.default._friendlyFileLoadError(5,path);if(errorCallback){errorCallback(err)}else{throw err}});return ret};_main.default.prototype.loadStrings=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default._validateParameters("loadStrings",args);var ret=[];var callback,errorCallback;for(var i=1;i<args.length;i++){var arg=args[i];if(typeof arg==="function"){if(typeof callback==="undefined"){callback=arg}else if(typeof errorCallback==="undefined"){errorCallback=arg}}}var self=this;_main.default.prototype.httpDo.call(this,args[0],"GET","text",function(data){var lines=data.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/);var QUANTUM=32768;for(var _i=0,len=lines.length;_i<len;_i+=QUANTUM){Array.prototype.push.apply(ret,lines.slice(_i,Math.min(_i+QUANTUM,len)))}if(typeof callback!=="undefined"){callback(ret)}self._decrementPreload()},function(err){_main.default._friendlyFileLoadError(3,arguments[0]);if(errorCallback){errorCallback(err)}else{throw err}});return ret};_main.default.prototype.loadTable=function(path){var callback;var errorCallback;var options=[];var header=false;var ext=path.substring(path.lastIndexOf(".")+1,path.length);var sep;if(ext==="csv"){sep=","}else if(ext==="ssv"){sep=";"}else if(ext==="tsv"){sep="\t"}for(var i=1;i<arguments.length;i++){if(typeof arguments[i]==="function"){if(typeof callback==="undefined"){callback=arguments[i]}else if(typeof errorCallback==="undefined"){errorCallback=arguments[i]}}else if(typeof arguments[i]==="string"){options.push(arguments[i]);if(arguments[i]==="header"){header=true}if(arguments[i]==="csv"){sep=","}else if(arguments[i]==="ssv"){sep=";"}else if(arguments[i]==="tsv"){sep="\t"}}}var t=new _main.default.Table;var self=this;this.httpDo(path,"GET","table",function(resp){var state={};var PRE_TOKEN=0,MID_TOKEN=1,POST_TOKEN=2,POST_RECORD=4;var QUOTE='"',CR="\r",LF="\n";var records=[];var offset=0;var currentRecord=null;var currentChar;var tokenBegin=function tokenBegin(){state.currentState=PRE_TOKEN;state.token=""};var tokenEnd=function tokenEnd(){currentRecord.push(state.token);tokenBegin()};var recordBegin=function recordBegin(){state.escaped=false;currentRecord=[];tokenBegin()};var recordEnd=function recordEnd(){state.currentState=POST_RECORD;records.push(currentRecord);currentRecord=null};for(;;){currentChar=resp[offset++];if(currentChar==null){if(state.escaped){throw new Error("Unclosed quote in file.")}if(currentRecord){tokenEnd();recordEnd();break}}if(currentRecord===null){recordBegin()}if(state.currentState===PRE_TOKEN){if(currentChar===QUOTE){state.escaped=true;state.currentState=MID_TOKEN;continue}state.currentState=MID_TOKEN}if(state.currentState===MID_TOKEN&&state.escaped){if(currentChar===QUOTE){if(resp[offset]===QUOTE){state.token+=QUOTE;offset++}else{state.escaped=false;state.currentState=POST_TOKEN}}else if(currentChar===CR){continue}else{state.token+=currentChar}continue}if(currentChar===CR){if(resp[offset]===LF){offset++}tokenEnd();recordEnd()}else if(currentChar===LF){tokenEnd();recordEnd()}else if(currentChar===sep){tokenEnd()}else if(state.currentState===MID_TOKEN){state.token+=currentChar}}if(header){t.columns=records.shift()}else{for(var _i2=0;_i2<records[0].length;_i2++){t.columns[_i2]="null"}}var row;for(var _i3=0;_i3<records.length;_i3++){if(records[_i3].length===1){if(records[_i3][0]==="undefined"||records[_i3][0]===""){continue}}row=new _main.default.TableRow;row.arr=records[_i3];row.obj=makeObject(records[_i3],t.columns);t.addRow(row)}if(typeof callback==="function"){callback(t)}self._decrementPreload()},function(err){_main.default._friendlyFileLoadError(2,path);if(errorCallback){errorCallback(err)}else{console.error(err)}});return t};function makeObject(row,headers){headers=headers||[];if(typeof headers==="undefined"){for(var j=0;j<row.length;j++){headers[j.toString()]=j}}return Object.fromEntries(headers.map(function(key,i){return[key,row[i]]}))}_main.default.prototype.loadXML=function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}var ret=new _main.default.XML;var callback,errorCallback;for(var i=1;i<args.length;i++){var arg=args[i];if(typeof arg==="function"){if(typeof callback==="undefined"){callback=arg}else if(typeof errorCallback==="undefined"){errorCallback=arg}}}var self=this;this.httpDo(args[0],"GET","xml",function(xml){for(var key in xml){ret[key]=xml[key]}if(typeof callback!=="undefined"){callback(ret)}self._decrementPreload()},function(err){_main.default._friendlyFileLoadError(1,arguments[0]);if(errorCallback){errorCallback(err)}else{throw err}});return ret};_main.default.prototype.loadBytes=function(file,callback,errorCallback){var ret={};var self=this;this.httpDo(file,"GET","arrayBuffer",function(arrayBuffer){ret.bytes=new Uint8Array(arrayBuffer);if(typeof callback==="function"){callback(ret)}self._decrementPreload()},function(err){_main.default._friendlyFileLoadError(6,file);if(errorCallback){errorCallback(err)}else{throw err}});return ret};_main.default.prototype.httpGet=function(){_main.default._validateParameters("httpGet",arguments);var args=Array.prototype.slice.call(arguments);args.splice(1,0,"GET");return _main.default.prototype.httpDo.apply(this,args)};_main.default.prototype.httpPost=function(){_main.default._validateParameters("httpPost",arguments);var args=Array.prototype.slice.call(arguments);args.splice(1,0,"POST");return _main.default.prototype.httpDo.apply(this,args)};_main.default.prototype.httpDo=function(){var type;var callback;var errorCallback;var request;var promise;var jsonpOptions={};var cbCount=0;var contentType="text/plain";for(var i=arguments.length-1;i>0;i--){if(typeof(i<0||arguments.length<=i?undefined:arguments[i])==="function"){cbCount++}else{break}}var argsCount=arguments.length-cbCount;var path=arguments.length<=0?undefined:arguments[0];if(argsCount===2&&typeof path==="string"&&_typeof(arguments.length<=1?undefined:arguments[1])==="object"){request=new Request(path,arguments.length<=1?undefined:arguments[1]);callback=arguments.length<=2?undefined:arguments[2];errorCallback=arguments.length<=3?undefined:arguments[3]}else{var method="GET";var data;for(var j=1;j<arguments.length;j++){var a=j<0||arguments.length<=j?undefined:arguments[j];if(typeof a==="string"){if(a==="GET"||a==="POST"||a==="PUT"||a==="DELETE"){method=a}else if(a==="json"||a==="jsonp"||a==="binary"||a==="arrayBuffer"||a==="xml"||a==="text"||a==="table"){type=a}else{data=a}}else if(typeof a==="number"){data=a.toString()}else if(_typeof(a)==="object"){if(a.hasOwnProperty("jsonpCallback")||a.hasOwnProperty("jsonpCallbackFunction")){for(var attr in a){jsonpOptions[attr]=a[attr]}}else if(a instanceof _main.default.XML){data=a.serialize();contentType="application/xml"}else{data=JSON.stringify(a);contentType="application/json"}}else if(typeof a==="function"){if(!callback){callback=a}else{errorCallback=a}}}var headers=method==="GET"?new Headers:new Headers({"Content-Type":contentType});request=new Request(path,{method:method,mode:"cors",body:data,headers:headers})}if(!type){if(path.includes("json")){type="json"}else if(path.includes("xml")){type="xml"}else{type="text"}}if(type==="jsonp"){promise=(0,_fetchJsonp.default)(path,jsonpOptions)}else{promise=fetch(request)}promise=promise.then(function(res){if(!res.ok){var err=new Error(res.body);err.status=res.status;err.ok=false;throw err}else{var fileSize=0;if(type!=="jsonp"){fileSize=res.headers.get("content-length")}if(fileSize&&fileSize>64e6){_main.default._friendlyFileLoadError(7,path)}switch(type){case"json":case"jsonp":return res.json();case"binary":return res.blob();case"arrayBuffer":return res.arrayBuffer();case"xml":return res.text().then(function(text){var parser=new DOMParser;var xml=parser.parseFromString(text,"text/xml");return new _main.default.XML(xml.documentElement)});default:return res.text()}}});promise.then(callback||function(){});promise.catch(errorCallback||console.error);return promise};window.URL=window.URL||window.webkitURL;_main.default.prototype._pWriters=[];_main.default.prototype.createWriter=function(name,extension){var newPW;for(var i in _main.default.prototype._pWriters){if(_main.default.prototype._pWriters[i].name===name){newPW=new _main.default.PrintWriter(name+this.millis(),extension);_main.default.prototype._pWriters.push(newPW);return newPW}}newPW=new _main.default.PrintWriter(name,extension);_main.default.prototype._pWriters.push(newPW);return newPW};_main.default.PrintWriter=function(filename,extension){var self=this;this.name=filename;this.content="";this.write=function(data){this.content+=data};this.print=function(data){this.content+="".concat(data,"\n")};this.clear=function(){this.content=""};this.close=function(){var arr=[];arr.push(this.content);_main.default.prototype.writeFile(arr,filename,extension);for(var i in _main.default.prototype._pWriters){if(_main.default.prototype._pWriters[i].name===this.name){_main.default.prototype._pWriters.splice(i,1)}}self.clear();self={}}};_main.default.prototype.save=function(object,_filename,_options){var args=arguments;var cnv=this._curElement?this._curElement.elt:this.elt;if(args.length===0){_main.default.prototype.saveCanvas(cnv);return}else if(args[0]instanceof _main.default.Renderer||args[0]instanceof _main.default.Graphics){_main.default.prototype.saveCanvas(args[0].elt,args[1],args[2]);return}else if(args.length===1&&typeof args[0]==="string"){_main.default.prototype.saveCanvas(cnv,args[0])}else{var extension=_checkFileExtension(args[1],args[2])[1];switch(extension){case"json":_main.default.prototype.saveJSON(args[0],args[1],args[2]);return;case"txt":_main.default.prototype.saveStrings(args[0],args[1],args[2]);return;default:if(args[0]instanceof Array){_main.default.prototype.saveStrings(args[0],args[1],args[2])}else if(args[0]instanceof _main.default.Table){_main.default.prototype.saveTable(args[0],args[1],args[2])}else if(args[0]instanceof _main.default.Image){_main.default.prototype.saveCanvas(args[0].canvas,args[1])}else if(args[0]instanceof _main.default.SoundFile){_main.default.prototype.saveSound(args[0],args[1],args[2],args[3])}}}};_main.default.prototype.saveJSON=function(json,filename,opt){_main.default._validateParameters("saveJSON",arguments);var stringify;if(opt){stringify=JSON.stringify(json)}else{stringify=JSON.stringify(json,undefined,2)}this.saveStrings(stringify.split("\n"),filename,"json")};_main.default.prototype.saveJSONObject=_main.default.prototype.saveJSON;_main.default.prototype.saveJSONArray=_main.default.prototype.saveJSON;_main.default.prototype.saveStrings=function(list,filename,extension,isCRLF){_main.default._validateParameters("saveStrings",arguments);var ext=extension||"txt";var pWriter=this.createWriter(filename,ext);for(var i=0;i<list.length;i++){isCRLF?pWriter.write(list[i]+"\r\n"):pWriter.write(list[i]+"\n")}pWriter.close();pWriter.clear()};function escapeHelper(content){return content.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}_main.default.prototype.saveTable=function(table,filename,options){_main.default._validateParameters("saveTable",arguments);var ext;if(options===undefined){ext=filename.substring(filename.lastIndexOf(".")+1,filename.length)}else{ext=options}var pWriter=this.createWriter(filename,ext);var header=table.columns;var sep=",";if(ext==="tsv"){sep="\t"}if(ext!=="html"){if(header[0]!=="0"){for(var h=0;h<header.length;h++){if(h<header.length-1){pWriter.write(header[h]+sep)}else{pWriter.write(header[h])}}pWriter.write("\n")}for(var i=0;i<table.rows.length;i++){var j=void 0;for(j=0;j<table.rows[i].arr.length;j++){if(j<table.rows[i].arr.length-1){if(ext==="csv"&&String(table.rows[i].arr[j]).includes(",")){pWriter.write('"'+table.rows[i].arr[j]+'"'+sep)}else{pWriter.write(table.rows[i].arr[j]+sep)}}else{if(ext==="csv"&&String(table.rows[i].arr[j]).includes(",")){pWriter.write('"'+table.rows[i].arr[j]+'"')}else{pWriter.write(table.rows[i].arr[j])}}}pWriter.write("\n")}}else{pWriter.print("<html>");pWriter.print("<head>");var str='  <meta http-equiv="content-type" content';str+='="text/html;charset=utf-8" />';pWriter.print(str);pWriter.print("</head>");pWriter.print("<body>");pWriter.print("  <table>");if(header[0]!=="0"){pWriter.print("    <tr>");for(var k=0;k<header.length;k++){var e=escapeHelper(header[k]);pWriter.print("      <td>".concat(e));pWriter.print("      </td>")}pWriter.print("    </tr>")}for(var row=0;row<table.rows.length;row++){pWriter.print("    <tr>");for(var col=0;col<table.columns.length;col++){var entry=table.rows[row].getString(col);var htmlEntry=escapeHelper(entry);pWriter.print("      <td>".concat(htmlEntry));pWriter.print("      </td>")}pWriter.print("    </tr>")}pWriter.print("  </table>");pWriter.print("</body>");pWriter.print("</html>")}pWriter.close();pWriter.clear()};_main.default.prototype.writeFile=function(dataToDownload,filename,extension){var type="application/octet-stream";if(_main.default.prototype._isSafari()){type="text/plain"}var blob=new Blob(dataToDownload,{type:type});_main.default.prototype.downloadFile(blob,filename,extension)};_main.default.prototype.downloadFile=function(data,fName,extension){var fx=_checkFileExtension(fName,extension);var filename=fx[0];if(data instanceof Blob){_fileSaver.default.saveAs(data,filename);return}var a=document.createElement("a");a.href=data;a.download=filename;a.onclick=function(e){destroyClickedElement(e);e.stopPropagation()};a.style.display="none";document.body.appendChild(a);if(_main.default.prototype._isSafari()){var aText="Hello, Safari user! To download this file...\n";aText+="1. Go to File --\x3e Save As.\n";aText+='2. Choose "Page Source" as the Format.\n';aText+='3. Name it with this extension: ."'.concat(fx[1],'"');alert(aText)}a.click()};function _checkFileExtension(filename,extension){if(!extension||extension===true||extension==="true"){extension=""}if(!filename){filename="untitled"}var ext="";if(filename&&filename.includes(".")){ext=filename.split(".").pop()}if(extension){if(ext!==extension){ext=extension;filename="".concat(filename,".").concat(ext)}}return[filename,ext]}_main.default.prototype._checkFileExtension=_checkFileExtension;_main.default.prototype._isSafari=function(){var x=Object.prototype.toString.call(window.HTMLElement);return x.indexOf("Constructor")>0};function destroyClickedElement(event){document.body.removeChild(event.target)}var _default=_main.default;exports.default=_default},{"../core/friendly_errors/fes_core":289,"../core/friendly_errors/file_errors":290,"../core/friendly_errors/validate_params":293,"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.last-index-of":181,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.splice":185,"core-js/modules/es.function.name":186,"core-js/modules/es.object.from-entries":195,"core-js/modules/es.object.to-string":200,"core-js/modules/es.promise":201,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.replace":214,"core-js/modules/es.string.split":216,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint8-array":252,"core-js/modules/web.dom-collections.iterator":256,"core-js/modules/web.url":258,"es6-promise/auto":259,"fetch-jsonp":261,"file-saver":262,"whatwg-fetch":275}],325:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.replace");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.Table=function(){function _class(rows){_classCallCheck(this,_class);this.columns=[];this.rows=[]}_createClass(_class,[{key:"addRow",value:function addRow(row){var r=row||new _main.default.TableRow;if(typeof r.arr==="undefined"||typeof r.obj==="undefined"){throw new Error("invalid TableRow: ".concat(r))}r.table=this;this.rows.push(r);return r}},{key:"removeRow",value:function removeRow(id){this.rows[id].table=null;var chunk=this.rows.splice(id+1,this.rows.length);this.rows.pop();this.rows=this.rows.concat(chunk)}},{key:"getRow",value:function getRow(r){return this.rows[r]}},{key:"getRows",value:function getRows(){return this.rows}},{key:"findRow",value:function findRow(value,column){if(typeof column==="string"){for(var i=0;i<this.rows.length;i++){if(this.rows[i].obj[column]===value){return this.rows[i]}}}else{for(var j=0;j<this.rows.length;j++){if(this.rows[j].arr[column]===value){return this.rows[j]}}}return null}},{key:"findRows",value:function findRows(value,column){var ret=[];if(typeof column==="string"){for(var i=0;i<this.rows.length;i++){if(this.rows[i].obj[column]===value){ret.push(this.rows[i])}}}else{for(var j=0;j<this.rows.length;j++){if(this.rows[j].arr[column]===value){ret.push(this.rows[j])}}}return ret}},{key:"matchRow",value:function matchRow(regexp,column){if(typeof column==="number"){for(var j=0;j<this.rows.length;j++){if(this.rows[j].arr[column].match(regexp)){return this.rows[j]}}}else{for(var i=0;i<this.rows.length;i++){if(this.rows[i].obj[column].match(regexp)){return this.rows[i]}}}return null}},{key:"matchRows",value:function matchRows(regexp,column){var ret=[];if(typeof column==="number"){for(var j=0;j<this.rows.length;j++){if(this.rows[j].arr[column].match(regexp)){ret.push(this.rows[j])}}}else{for(var i=0;i<this.rows.length;i++){if(this.rows[i].obj[column].match(regexp)){ret.push(this.rows[i])}}}return ret}},{key:"getColumn",value:function getColumn(value){var ret=[];if(typeof value==="string"){for(var i=0;i<this.rows.length;i++){ret.push(this.rows[i].obj[value])}}else{for(var j=0;j<this.rows.length;j++){ret.push(this.rows[j].arr[value])}}return ret}},{key:"clearRows",value:function clearRows(){delete this.rows;this.rows=[]}},{key:"addColumn",value:function addColumn(title){var t=title||null;this.columns.push(t)}},{key:"getColumnCount",value:function getColumnCount(){return this.columns.length}},{key:"getRowCount",value:function getRowCount(){return this.rows.length}},{key:"removeTokens",value:function removeTokens(chars,column){var escape=function escape(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")};var charArray=[];for(var i=0;i<chars.length;i++){charArray.push(escape(chars.charAt(i)))}var regex=new RegExp(charArray.join("|"),"g");if(typeof column==="undefined"){for(var c=0;c<this.columns.length;c++){for(var d=0;d<this.rows.length;d++){var s=this.rows[d].arr[c];s=s.replace(regex,"");this.rows[d].arr[c]=s;this.rows[d].obj[this.columns[c]]=s}}}else if(typeof column==="string"){for(var j=0;j<this.rows.length;j++){var val=this.rows[j].obj[column];val=val.replace(regex,"");this.rows[j].obj[column]=val;var pos=this.columns.indexOf(column);this.rows[j].arr[pos]=val}}else{for(var k=0;k<this.rows.length;k++){var str=this.rows[k].arr[column];str=str.replace(regex,"");this.rows[k].arr[column]=str;this.rows[k].obj[this.columns[column]]=str}}}},{key:"trim",value:function trim(column){var regex=new RegExp(" ","g");if(typeof column==="undefined"){for(var c=0;c<this.columns.length;c++){for(var d=0;d<this.rows.length;d++){var s=this.rows[d].arr[c];s=s.replace(regex,"");this.rows[d].arr[c]=s;this.rows[d].obj[this.columns[c]]=s}}}else if(typeof column==="string"){for(var j=0;j<this.rows.length;j++){var val=this.rows[j].obj[column];val=val.replace(regex,"");this.rows[j].obj[column]=val;var pos=this.columns.indexOf(column);this.rows[j].arr[pos]=val}}else{for(var k=0;k<this.rows.length;k++){var str=this.rows[k].arr[column];str=str.replace(regex,"");this.rows[k].arr[column]=str;this.rows[k].obj[this.columns[column]]=str}}}},{key:"removeColumn",value:function removeColumn(c){var cString;var cNumber;if(typeof c==="string"){cString=c;cNumber=this.columns.indexOf(c)}else{cNumber=c;cString=this.columns[c]}var chunk=this.columns.splice(cNumber+1,this.columns.length);this.columns.pop();this.columns=this.columns.concat(chunk);for(var i=0;i<this.rows.length;i++){var tempR=this.rows[i].arr;var chip=tempR.splice(cNumber+1,tempR.length);tempR.pop();this.rows[i].arr=tempR.concat(chip);delete this.rows[i].obj[cString]}}},{key:"set",value:function set(row,column,value){this.rows[row].set(column,value)}},{key:"setNum",value:function setNum(row,column,value){this.rows[row].setNum(column,value)}},{key:"setString",value:function setString(row,column,value){this.rows[row].setString(column,value)}},{key:"get",value:function get(row,column){return this.rows[row].get(column)}},{key:"getNum",value:function getNum(row,column){return this.rows[row].getNum(column)}},{key:"getString",value:function getString(row,column){return this.rows[row].getString(column)}},{key:"getObject",value:function getObject(headerColumn){var tableObject={};var obj,cPos,index;for(var i=0;i<this.rows.length;i++){obj=this.rows[i].obj;if(typeof headerColumn==="string"){cPos=this.columns.indexOf(headerColumn);if(cPos>=0){index=obj[headerColumn];tableObject[index]=obj}else{throw new Error('This table has no column named "'.concat(headerColumn,'"'))}}else{tableObject[i]=this.rows[i].obj}}return tableObject}},{key:"getArray",value:function getArray(){var tableArray=[];for(var i=0;i<this.rows.length;i++){tableArray.push(this.rows[i].arr)}return tableArray}}]);return _class}();var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.join":180,"core-js/modules/es.array.splice":185,"core-js/modules/es.regexp.constructor":204,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.match":211,"core-js/modules/es.string.replace":214}],326:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.from-entries");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.from-entries");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.TableRow=function(){function _class(str,separator){_classCallCheck(this,_class);var arr=[];if(str){separator=separator||",";arr=str.split(separator)}this.arr=arr;this.obj=Object.fromEntries(arr.entries());this.table=null}_createClass(_class,[{key:"set",value:function set(column,value){if(typeof column==="string"){var cPos=this.table.columns.indexOf(column);if(cPos>=0){this.obj[column]=value;this.arr[cPos]=value}else{throw new Error('This table has no column named "'.concat(column,'"'))}}else{if(column<this.table.columns.length){this.arr[column]=value;var cTitle=this.table.columns[column];this.obj[cTitle]=value}else{throw new Error("Column #".concat(column," is out of the range of this table"))}}}},{key:"setNum",value:function setNum(column,value){var floatVal=parseFloat(value);this.set(column,floatVal)}},{key:"setString",value:function setString(column,value){var stringVal=value.toString();this.set(column,stringVal)}},{key:"get",value:function get(column){if(typeof column==="string"){return this.obj[column]}else{return this.arr[column]}}},{key:"getNum",value:function getNum(column){var ret;if(typeof column==="string"){ret=parseFloat(this.obj[column])}else{ret=parseFloat(this.arr[column])}if(ret.toString()==="NaN"){throw"Error: ".concat(this.obj[column]," is NaN (Not a Number)")}return ret}},{key:"getString",value:function getString(column){if(typeof column==="string"){return this.obj[column].toString()}else{return this.arr[column].toString()}}}]);return _class}();var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.from-entries":195,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.split":216,"core-js/modules/web.dom-collections.iterator":256}],327:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.XML=function(){function _class(DOM){_classCallCheck(this,_class);if(!DOM){var xmlDoc=document.implementation.createDocument(null,"doc");this.DOM=xmlDoc.createElement("root")}else{this.DOM=DOM}}_createClass(_class,[{key:"getParent",value:function getParent(){return new _main.default.XML(this.DOM.parentElement)}},{key:"getName",value:function getName(){return this.DOM.tagName}},{key:"setName",value:function setName(name){var content=this.DOM.innerHTML;var attributes=this.DOM.attributes;var xmlDoc=document.implementation.createDocument(null,"default");var newDOM=xmlDoc.createElement(name);newDOM.innerHTML=content;for(var i=0;i<attributes.length;i++){newDOM.setAttribute(attributes[i].nodeName,attributes.nodeValue)}this.DOM=newDOM}},{key:"hasChildren",value:function hasChildren(){return this.DOM.children.length>0}},{key:"listChildren",value:function listChildren(){var arr=[];for(var i=0;i<this.DOM.childNodes.length;i++){arr.push(this.DOM.childNodes[i].nodeName)}return arr}},{key:"getChildren",value:function getChildren(param){if(param){return elementsToP5XML(this.DOM.getElementsByTagName(param))}else{return elementsToP5XML(this.DOM.children)}}},{key:"getChild",value:function getChild(param){if(typeof param==="string"){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.DOM.children[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var child=_step.value;if(child.tagName===param)return new _main.default.XML(child)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}else{return new _main.default.XML(this.DOM.children[param])}}},{key:"addChild",value:function addChild(node){if(node instanceof _main.default.XML){this.DOM.appendChild(node.DOM)}else{}}},{key:"removeChild",value:function removeChild(param){var ind=-1;if(typeof param==="string"){for(var i=0;i<this.DOM.children.length;i++){if(this.DOM.children[i].tagName===param){ind=i;break}}}else{ind=param}if(ind!==-1){this.DOM.removeChild(this.DOM.children[ind])}}},{key:"getAttributeCount",value:function getAttributeCount(){return this.DOM.attributes.length}},{key:"listAttributes",value:function listAttributes(){var arr=[];var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.DOM.attributes[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var attribute=_step2.value;arr.push(attribute.nodeName)}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}return arr}},{key:"hasAttribute",value:function hasAttribute(name){var obj={};var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.DOM.attributes[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var attribute=_step3.value;obj[attribute.nodeName]=attribute.nodeValue}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return!=null){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}return obj[name]?true:false}},{key:"getNum",value:function getNum(name,defaultValue){var obj={};var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=this.DOM.attributes[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var attribute=_step4.value;obj[attribute.nodeName]=attribute.nodeValue}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return!=null){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}return Number(obj[name])||defaultValue||0}},{key:"getString",value:function getString(name,defaultValue){var obj={};var _iteratorNormalCompletion5=true;var _didIteratorError5=false;var _iteratorError5=undefined;try{for(var _iterator5=this.DOM.attributes[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=true){var attribute=_step5.value;obj[attribute.nodeName]=attribute.nodeValue}}catch(err){_didIteratorError5=true;_iteratorError5=err}finally{try{if(!_iteratorNormalCompletion5&&_iterator5.return!=null){_iterator5.return()}}finally{if(_didIteratorError5){throw _iteratorError5}}}return obj[name]?String(obj[name]):defaultValue||null}},{key:"setAttribute",value:function setAttribute(name,value){this.DOM.setAttribute(name,value)}},{key:"getContent",value:function getContent(defaultValue){var str;str=this.DOM.textContent;str=str.replace(/\s\s+/g,",");return str||defaultValue||null}},{key:"setContent",value:function setContent(content){if(!this.DOM.children.length){this.DOM.textContent=content}}},{key:"serialize",value:function serialize(){var xmlSerializer=new XMLSerializer;return xmlSerializer.serializeToString(this.DOM)}}]);return _class}();function elementsToP5XML(elements){var arr=[];for(var i=0;i<elements.length;i++){arr.push(new _main.default.XML(elements[i]))}return arr}var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.number.constructor":191,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.replace":214,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.iterator":256}],328:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.math.hypot");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.math.hypot");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.abs=Math.abs;_main.default.prototype.ceil=Math.ceil;_main.default.prototype.constrain=function(n,low,high){_main.default._validateParameters("constrain",arguments);return Math.max(Math.min(n,high),low)};_main.default.prototype.dist=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("dist",args);if(args.length===4){return Math.hypot(args[2]-args[0],args[3]-args[1])}else if(args.length===6){return Math.hypot(args[3]-args[0],args[4]-args[1],args[5]-args[2])}};_main.default.prototype.exp=Math.exp;_main.default.prototype.floor=Math.floor;_main.default.prototype.lerp=function(start,stop,amt){_main.default._validateParameters("lerp",arguments);return amt*(stop-start)+start};_main.default.prototype.log=Math.log;_main.default.prototype.mag=function(x,y){_main.default._validateParameters("mag",arguments);return Math.hypot(x,y)};_main.default.prototype.map=function(n,start1,stop1,start2,stop2,withinBounds){_main.default._validateParameters("map",arguments);var newval=(n-start1)/(stop1-start1)*(stop2-start2)+start2;if(!withinBounds){return newval}if(start2<stop2){return this.constrain(newval,start2,stop2)}else{return this.constrain(newval,stop2,start2)}};_main.default.prototype.max=function(){var findMax=function findMax(arr){var max=-Infinity;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=arr[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var x=_step.value;max=x>max?x:max}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return max};for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}if(args[0]instanceof Array){return findMax(args[0])}else{return findMax(args)}};_main.default.prototype.min=function(){var findMin=function findMin(arr){var min=Infinity;var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=arr[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var x=_step2.value;min=x<min?x:min}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}return min};for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}if(args[0]instanceof Array){return findMin(args[0])}else{return findMin(args)}};_main.default.prototype.norm=function(n,start,stop){_main.default._validateParameters("norm",arguments);return this.map(n,start,stop,0,1)};_main.default.prototype.pow=Math.pow;_main.default.prototype.round=function(n,decimals){if(!decimals){return Math.round(n)}var multiplier=Math.pow(10,decimals);return Math.round(n*multiplier)/multiplier};_main.default.prototype.sq=function(n){return n*n};_main.default.prototype.sqrt=Math.sqrt;_main.default.prototype.fract=function(toConvert){_main.default._validateParameters("fract",arguments);var sign=0;var num=Number(toConvert);if(isNaN(num)||Math.abs(num)===Infinity){return num}else if(num<0){num=-num;sign=1}if(String(num).includes(".")&&!String(num).includes("e")){var toFract=String(num);toFract=Number("0"+toFract.slice(toFract.indexOf(".")));return Math.abs(sign-toFract)}else if(num<1){return Math.abs(sign-num)}else{return 0}};var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.math.hypot":188,"core-js/modules/es.number.constructor":191,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.iterator":256}],329:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.slice");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function _construct(Parent,args,Class){if(isNativeReflectConstruct()){_construct=Reflect.construct}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}_main.default.prototype.createVector=function(x,y,z){if(this instanceof _main.default){return _construct(_main.default.Vector,[this._fromRadians.bind(this),this._toRadians.bind(this)].concat(Array.prototype.slice.call(arguments)))}else{return new _main.default.Vector(x,y,z)}};var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.to-string":200,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.regexp.to-string":206}],330:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var PERLIN_YWRAPB=4;var PERLIN_YWRAP=1<<PERLIN_YWRAPB;var PERLIN_ZWRAPB=8;var PERLIN_ZWRAP=1<<PERLIN_ZWRAPB;var PERLIN_SIZE=4095;var perlin_octaves=4;var perlin_amp_falloff=.5;var scaled_cosine=function scaled_cosine(i){return.5*(1-Math.cos(i*Math.PI))};var perlin;_main.default.prototype.noise=function(x){var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var z=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(perlin==null){perlin=new Array(PERLIN_SIZE+1);for(var i=0;i<PERLIN_SIZE+1;i++){perlin[i]=Math.random()}}if(x<0){x=-x}if(y<0){y=-y}if(z<0){z=-z}var xi=Math.floor(x),yi=Math.floor(y),zi=Math.floor(z);var xf=x-xi;var yf=y-yi;var zf=z-zi;var rxf,ryf;var r=0;var ampl=.5;var n1,n2,n3;for(var o=0;o<perlin_octaves;o++){var of=xi+(yi<<PERLIN_YWRAPB)+(zi<<PERLIN_ZWRAPB);rxf=scaled_cosine(xf);ryf=scaled_cosine(yf);n1=perlin[of&PERLIN_SIZE];n1+=rxf*(perlin[of+1&PERLIN_SIZE]-n1);n2=perlin[of+PERLIN_YWRAP&PERLIN_SIZE];n2+=rxf*(perlin[of+PERLIN_YWRAP+1&PERLIN_SIZE]-n2);n1+=ryf*(n2-n1);of+=PERLIN_ZWRAP;n2=perlin[of&PERLIN_SIZE];n2+=rxf*(perlin[of+1&PERLIN_SIZE]-n2);n3=perlin[of+PERLIN_YWRAP&PERLIN_SIZE];n3+=rxf*(perlin[of+PERLIN_YWRAP+1&PERLIN_SIZE]-n3);n2+=ryf*(n3-n2);n1+=scaled_cosine(zf)*(n2-n1);r+=n1*ampl;ampl*=perlin_amp_falloff;xi<<=1;xf*=2;yi<<=1;yf*=2;zi<<=1;zf*=2;if(xf>=1){xi++;xf--}if(yf>=1){yi++;yf--}if(zf>=1){zi++;zf--}}return r};_main.default.prototype.noiseDetail=function(lod,falloff){if(lod>0){perlin_octaves=lod}if(falloff>0){perlin_amp_falloff=falloff}};_main.default.prototype.noiseSeed=function(seed){var lcg=function(){var m=4294967296;var a=1664525;var c=1013904223;var seed,z;return{setSeed:function setSeed(val){z=seed=(val==null?Math.random()*m:val)>>>0},getSeed:function getSeed(){return seed},rand:function rand(){z=(a*z+c)%m;return z/m}}}();lcg.setSeed(seed);perlin=new Array(PERLIN_SIZE+1);for(var i=0;i<PERLIN_SIZE+1;i++){perlin[i]=lcg.rand()}};var _default=_main.default;exports.default=_default},{"../core/main":298}],331:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.every");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.math.sign");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.number.is-finite");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.sub");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.every");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.math.sign");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.number.is-finite");_dereq_("core-js/modules/es.string.sub");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var calculateRemainder2D=function calculateRemainder2D(xComponent,yComponent){if(xComponent!==0){this.x=this.x%xComponent}if(yComponent!==0){this.y=this.y%yComponent}return this};var calculateRemainder3D=function calculateRemainder3D(xComponent,yComponent,zComponent){if(xComponent!==0){this.x=this.x%xComponent}if(yComponent!==0){this.y=this.y%yComponent}if(zComponent!==0){this.z=this.z%zComponent}return this};_main.default.Vector=function(){function _class(){_classCallCheck(this,_class);var x,y,z;if(typeof(arguments.length<=0?undefined:arguments[0])==="function"){this.isPInst=true;this._fromRadians=arguments.length<=0?undefined:arguments[0];this._toRadians=arguments.length<=1?undefined:arguments[1];x=(arguments.length<=2?undefined:arguments[2])||0;y=(arguments.length<=3?undefined:arguments[3])||0;z=(arguments.length<=4?undefined:arguments[4])||0}else{x=(arguments.length<=0?undefined:arguments[0])||0;y=(arguments.length<=1?undefined:arguments[1])||0;z=(arguments.length<=2?undefined:arguments[2])||0}this.x=x;this.y=y;this.z=z}_createClass(_class,[{key:"toString",value:function toString(){return"p5.Vector Object : [".concat(this.x,", ").concat(this.y,", ").concat(this.z,"]")}},{key:"set",value:function set(x,y,z){if(x instanceof _main.default.Vector){this.x=x.x||0;this.y=x.y||0;this.z=x.z||0;return this}if(Array.isArray(x)){this.x=x[0]||0;this.y=x[1]||0;this.z=x[2]||0;return this}this.x=x||0;this.y=y||0;this.z=z||0;return this}},{key:"copy",value:function copy(){if(this.isPInst){return new _main.default.Vector(this._fromRadians,this._toRadians,this.x,this.y,this.z)}else{return new _main.default.Vector(this.x,this.y,this.z)}}},{key:"add",value:function add(x,y,z){if(x instanceof _main.default.Vector){this.x+=x.x||0;this.y+=x.y||0;this.z+=x.z||0;return this}if(Array.isArray(x)){this.x+=x[0]||0;this.y+=x[1]||0;this.z+=x[2]||0;return this}this.x+=x||0;this.y+=y||0;this.z+=z||0;return this}},{key:"rem",value:function rem(x,y,z){if(x instanceof _main.default.Vector){if([x.x,x.y,x.z].every(Number.isFinite)){var xComponent=parseFloat(x.x);var yComponent=parseFloat(x.y);var zComponent=parseFloat(x.z);return calculateRemainder3D.call(this,xComponent,yComponent,zComponent)}}else if(Array.isArray(x)){if(x.every(function(element){return Number.isFinite(element)})){if(x.length===2){return calculateRemainder2D.call(this,x[0],x[1])}if(x.length===3){return calculateRemainder3D.call(this,x[0],x[1],x[2])}}}else if(arguments.length===1){if(Number.isFinite(arguments[0])&&arguments[0]!==0){this.x=this.x%arguments[0];this.y=this.y%arguments[0];this.z=this.z%arguments[0];return this}}else if(arguments.length===2){var vectorComponents=Array.prototype.slice.call(arguments);if(vectorComponents.every(function(element){return Number.isFinite(element)})){if(vectorComponents.length===2){return calculateRemainder2D.call(this,vectorComponents[0],vectorComponents[1])}}}else if(arguments.length===3){var _vectorComponents=Array.prototype.slice.call(arguments);if(_vectorComponents.every(function(element){return Number.isFinite(element)})){if(_vectorComponents.length===3){return calculateRemainder3D.call(this,_vectorComponents[0],_vectorComponents[1],_vectorComponents[2])}}}}},{key:"sub",value:function sub(x,y,z){if(x instanceof _main.default.Vector){this.x-=x.x||0;this.y-=x.y||0;this.z-=x.z||0;return this}if(Array.isArray(x)){this.x-=x[0]||0;this.y-=x[1]||0;this.z-=x[2]||0;return this}this.x-=x||0;this.y-=y||0;this.z-=z||0;return this}},{key:"mult",value:function mult(x,y,z){if(x instanceof _main.default.Vector){if(Number.isFinite(x.x)&&Number.isFinite(x.y)&&Number.isFinite(x.z)&&typeof x.x==="number"&&typeof x.y==="number"&&typeof x.z==="number"){this.x*=x.x;this.y*=x.y;this.z*=x.z}else{console.warn("p5.Vector.prototype.mult:","x contains components that are either undefined or not finite numbers")}return this}if(Array.isArray(x)){if(x.every(function(element){return Number.isFinite(element)})&&x.every(function(element){return typeof element==="number"})){if(x.length===1){this.x*=x[0];this.y*=x[0];this.z*=x[0]}else if(x.length===2){this.x*=x[0];this.y*=x[1]}else if(x.length===3){this.x*=x[0];this.y*=x[1];this.z*=x[2]}}else{console.warn("p5.Vector.prototype.mult:","x contains elements that are either undefined or not finite numbers")}return this}var vectorComponents=Array.prototype.slice.call(arguments);if(vectorComponents.every(function(element){return Number.isFinite(element)})&&vectorComponents.every(function(element){return typeof element==="number"})){if(arguments.length===1){this.x*=x;this.y*=x;this.z*=x}if(arguments.length===2){this.x*=x;this.y*=y}if(arguments.length===3){this.x*=x;this.y*=y;this.z*=z}}else{console.warn("p5.Vector.prototype.mult:","x, y, or z arguments are either undefined or not a finite number")}return this}},{key:"div",value:function div(x,y,z){if(x instanceof _main.default.Vector){if(Number.isFinite(x.x)&&Number.isFinite(x.y)&&Number.isFinite(x.z)&&typeof x.x==="number"&&typeof x.y==="number"&&typeof x.z==="number"){var isLikely2D=x.z===0&&this.z===0;if(x.x===0||x.y===0||!isLikely2D&&x.z===0){console.warn("p5.Vector.prototype.div:","divide by 0");return this}this.x/=x.x;this.y/=x.y;if(!isLikely2D){this.z/=x.z}}else{console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers")}return this}if(Array.isArray(x)){if(x.every(function(element){return Number.isFinite(element)})&&x.every(function(element){return typeof element==="number"})){if(x.some(function(element){return element===0})){console.warn("p5.Vector.prototype.div:","divide by 0");return this}if(x.length===1){this.x/=x[0];this.y/=x[0];this.z/=x[0]}else if(x.length===2){this.x/=x[0];this.y/=x[1]}else if(x.length===3){this.x/=x[0];this.y/=x[1];this.z/=x[2]}}else{console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers")}return this}var vectorComponents=Array.prototype.slice.call(arguments);if(vectorComponents.every(function(element){return Number.isFinite(element)})&&vectorComponents.every(function(element){return typeof element==="number"})){if(vectorComponents.some(function(element){return element===0})){console.warn("p5.Vector.prototype.div:","divide by 0");return this}if(arguments.length===1){this.x/=x;this.y/=x;this.z/=x}if(arguments.length===2){this.x/=x;this.y/=y}if(arguments.length===3){this.x/=x;this.y/=y;this.z/=z}}else{console.warn("p5.Vector.prototype.div:","x, y, or z arguments are either undefined or not a finite number")}return this}},{key:"mag",value:function mag(){return Math.sqrt(this.magSq())}},{key:"magSq",value:function magSq(){var x=this.x;var y=this.y;var z=this.z;return x*x+y*y+z*z}},{key:"dot",value:function dot(x,y,z){if(x instanceof _main.default.Vector){return this.dot(x.x,x.y,x.z)}return this.x*(x||0)+this.y*(y||0)+this.z*(z||0)}},{key:"cross",value:function cross(v){var x=this.y*v.z-this.z*v.y;var y=this.z*v.x-this.x*v.z;var z=this.x*v.y-this.y*v.x;if(this.isPInst){return new _main.default.Vector(this._fromRadians,this._toRadians,x,y,z)}else{return new _main.default.Vector(x,y,z)}}},{key:"dist",value:function dist(v){return v.copy().sub(this).mag()}},{key:"normalize",value:function normalize(){var len=this.mag();if(len!==0)this.mult(1/len);return this}},{key:"limit",value:function limit(max){var mSq=this.magSq();if(mSq>max*max){this.div(Math.sqrt(mSq)).mult(max)}return this}},{key:"setMag",value:function setMag(n){return this.normalize().mult(n)}},{key:"heading",value:function heading(){var h=Math.atan2(this.y,this.x);if(this.isPInst)return this._fromRadians(h);return h}},{key:"setHeading",value:function setHeading(a){if(this.isPInst)a=this._toRadians(a);var m=this.mag();this.x=m*Math.cos(a);this.y=m*Math.sin(a);return this}},{key:"rotate",value:function rotate(a){var newHeading=this.heading()+a;if(this.isPInst)newHeading=this._toRadians(newHeading);var mag=this.mag();this.x=Math.cos(newHeading)*mag;this.y=Math.sin(newHeading)*mag;return this}},{key:"angleBetween",value:function angleBetween(v){var magSqMult=this.magSq()*v.magSq();if(magSqMult===0){return NaN}var u=this.cross(v);var angle=Math.atan2(u.mag(),this.dot(v))*Math.sign(u.z||1);if(this.isPInst){angle=this._fromRadians(angle)}return angle}},{key:"lerp",value:function lerp(x,y,z,amt){if(x instanceof _main.default.Vector){return this.lerp(x.x,x.y,x.z,y)}this.x+=(x-this.x)*amt||0;this.y+=(y-this.y)*amt||0;this.z+=(z-this.z)*amt||0;return this}},{key:"slerp",value:function slerp(v,amt){if(amt===0){return this}if(amt===1){return this.set(v)}var selfMag=this.mag();var vMag=v.mag();var magmag=selfMag*vMag;if(magmag===0){this.mult(1-amt).add(v.x*amt,v.y*amt,v.z*amt);return this}var axis=this.cross(v);var axisMag=axis.mag();var theta=Math.atan2(axisMag,this.dot(v));if(axisMag>0){axis.x/=axisMag;axis.y/=axisMag;axis.z/=axisMag}else if(theta<Math.PI*.5){this.mult(1-amt).add(v.x*amt,v.y*amt,v.z*amt);return this}else{if(this.z===0&&v.z===0){axis.set(0,0,1)}else if(this.x!==0){axis.set(this.y,-this.x,0).normalize()}else{axis.set(1,0,0)}}var ey=axis.cross(this);var lerpedMagFactor=1-amt+amt*vMag/selfMag;var cosMultiplier=lerpedMagFactor*Math.cos(amt*theta);var sinMultiplier=lerpedMagFactor*Math.sin(amt*theta);this.x=this.x*cosMultiplier+ey.x*sinMultiplier;this.y=this.y*cosMultiplier+ey.y*sinMultiplier;this.z=this.z*cosMultiplier+ey.z*sinMultiplier;return this}},{key:"reflect",value:function reflect(surfaceNormal){surfaceNormal.normalize();return this.sub(surfaceNormal.mult(2*this.dot(surfaceNormal)))}},{key:"array",value:function array(){return[this.x||0,this.y||0,this.z||0]}},{key:"equals",value:function equals(x,y,z){var a,b,c;if(x instanceof _main.default.Vector){a=x.x||0;b=x.y||0;c=x.z||0}else if(Array.isArray(x)){a=x[0]||0;b=x[1]||0;c=x[2]||0}else{a=x||0;b=y||0;c=z||0}return this.x===a&&this.y===b&&this.z===c}}],[{key:"fromAngle",value:function fromAngle(angle,length){if(typeof length==="undefined"){length=1}return new _main.default.Vector(length*Math.cos(angle),length*Math.sin(angle),0)}},{key:"fromAngles",value:function fromAngles(theta,phi,length){if(typeof length==="undefined"){length=1}var cosPhi=Math.cos(phi);var sinPhi=Math.sin(phi);var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);return new _main.default.Vector(length*sinTheta*sinPhi,-length*cosTheta,length*sinTheta*cosPhi)}},{key:"random2D",value:function random2D(){return this.fromAngle(Math.random()*constants.TWO_PI)}},{key:"random3D",value:function random3D(){var angle=Math.random()*constants.TWO_PI;var vz=Math.random()*2-1;var vzBase=Math.sqrt(1-vz*vz);var vx=vzBase*Math.cos(angle);var vy=vzBase*Math.sin(angle);return new _main.default.Vector(vx,vy,vz)}},{key:"copy",value:function copy(v){return v.copy(v)}},{key:"add",value:function add(v1,v2,target){if(!target){target=v1.copy();if(arguments.length===3){_main.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.add")}}else{target.set(v1)}target.add(v2);return target}},{key:"rem",value:function rem(v1,v2){if(v1 instanceof _main.default.Vector&&v2 instanceof _main.default.Vector){var target=v1.copy();target.rem(v2);return target}}},{key:"sub",value:function sub(v1,v2,target){if(!target){target=v1.copy();if(arguments.length===3){_main.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.sub")}}else{target.set(v1)}target.sub(v2);return target}},{key:"mult",value:function mult(v,n,target){if(!target){target=v.copy();if(arguments.length===3){_main.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.mult")}}else{target.set(v)}target.mult(n);return target}},{key:"rotate",value:function rotate(v,a,target){if(arguments.length===2){target=v.copy()}else{if(!(target instanceof _main.default.Vector)){_main.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.rotate")}target.set(v)}target.rotate(a);return target}},{key:"div",value:function div(v,n,target){if(!target){target=v.copy();if(arguments.length===3){_main.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.div")}}else{target.set(v)}target.div(n);return target}},{key:"dot",value:function dot(v1,v2){return v1.dot(v2)}},{key:"cross",value:function cross(v1,v2){return v1.cross(v2)}},{key:"dist",value:function dist(v1,v2){return v1.dist(v2)}},{key:"lerp",value:function lerp(v1,v2,amt,target){if(!target){target=v1.copy();if(arguments.length===4){_main.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.lerp")}}else{target.set(v1)}target.lerp(v2,amt);return target}},{key:"slerp",value:function slerp(v1,v2,amt,target){if(!target){target=v1.copy();if(arguments.length===4){_main.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.slerp")}}else{target.set(v1)}target.slerp(v2,amt);return target}},{key:"mag",value:function mag(vecT){return vecT.mag()}},{key:"magSq",value:function magSq(vecT){return vecT.magSq()}},{key:"normalize",value:function normalize(v,target){if(arguments.length<2){target=v.copy()}else{if(!(target instanceof _main.default.Vector)){_main.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.normalize")}target.set(v)}return target.normalize()}},{key:"limit",value:function limit(v,max,target){if(arguments.length<3){target=v.copy()}else{if(!(target instanceof _main.default.Vector)){_main.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.limit")}target.set(v)}return target.limit(max)}},{key:"setMag",value:function setMag(v,len,target){if(arguments.length<3){target=v.copy()}else{if(!(target instanceof _main.default.Vector)){_main.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.setMag")}target.set(v)}return target.setMag(len)}},{key:"heading",value:function heading(v){return v.heading()}},{key:"angleBetween",value:function angleBetween(v1,v2){return v1.angleBetween(v2)}},{key:"reflect",value:function reflect(incidentVector,surfaceNormal,target){if(arguments.length<3){target=incidentVector.copy()}else{if(!(target instanceof _main.default.Vector)){_main.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.reflect")}target.set(incidentVector)}return target.reflect(surfaceNormal)}},{key:"array",value:function array(v){return v.array()}},{key:"equals",value:function equals(v1,v2){var v;if(v1 instanceof _main.default.Vector){v=v1}else if(v1 instanceof Array){v=(new _main.default.Vector).set(v1)}else{_main.default._friendlyError("The v1 parameter should be of type Array or p5.Vector","p5.Vector.equals")}return v.equals(v2)}}]);return _class}();var _default=_main.default.Vector;exports.default=_default},{"../core/constants":286,"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.every":171,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.some":184,"core-js/modules/es.math.sign":190,"core-js/modules/es.number.constructor":191,"core-js/modules/es.number.is-finite":192,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.sub":218,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],332:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var randomStateProp="_lcg_random_state";var m=4294967296;var a=1664525;var c=1013904223;var y2=0;_main.default.prototype._lcg=function(stateProperty){this[stateProperty]=(a*this[stateProperty]+c)%m;return this[stateProperty]/m};_main.default.prototype._lcgSetSeed=function(stateProperty,val){this[stateProperty]=(val==null?Math.random()*m:val)>>>0};_main.default.prototype.randomSeed=function(seed){this._lcgSetSeed(randomStateProp,seed);this._gaussian_previous=false};_main.default.prototype.random=function(min,max){_main.default._validateParameters("random",arguments);var rand;if(this[randomStateProp]!=null){rand=this._lcg(randomStateProp)}else{rand=Math.random()}if(typeof min==="undefined"){return rand}else if(typeof max==="undefined"){if(min instanceof Array){return min[Math.floor(rand*min.length)]}else{return rand*min}}else{if(min>max){var tmp=min;min=max;max=tmp}return rand*(max-min)+min}};_main.default.prototype.randomGaussian=function(mean){var sd=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var y1,x1,x2,w;if(this._gaussian_previous){y1=y2;this._gaussian_previous=false}else{do{x1=this.random(2)-1;x2=this.random(2)-1;w=x1*x1+x2*x2}while(w>=1);w=Math.sqrt(-2*Math.log(w)/w);y1=x1*w;y2=x2*w;this._gaussian_previous=true}var m=mean||0;return y1*sd+m};var _default=_main.default;exports.default=_default},{"../core/main":298}],333:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype._angleMode=constants.RADIANS;_main.default.prototype.acos=function(ratio){return this._fromRadians(Math.acos(ratio))};_main.default.prototype.asin=function(ratio){return this._fromRadians(Math.asin(ratio))};_main.default.prototype.atan=function(ratio){return this._fromRadians(Math.atan(ratio))};_main.default.prototype.atan2=function(y,x){return this._fromRadians(Math.atan2(y,x))};_main.default.prototype.cos=function(angle){return Math.cos(this._toRadians(angle))};_main.default.prototype.sin=function(angle){return Math.sin(this._toRadians(angle))};_main.default.prototype.tan=function(angle){return Math.tan(this._toRadians(angle))};_main.default.prototype.degrees=function(angle){return angle*constants.RAD_TO_DEG};_main.default.prototype.radians=function(angle){return angle*constants.DEG_TO_RAD};_main.default.prototype.angleMode=function(mode){_main.default._validateParameters("angleMode",arguments);if(typeof mode==="undefined"){return this._angleMode}else if(mode===constants.DEGREES||mode===constants.RADIANS){this._angleMode=mode}};_main.default.prototype._toRadians=function(angle){if(this._angleMode===constants.DEGREES){return angle*constants.DEG_TO_RAD}return angle};_main.default.prototype._toDegrees=function(angle){if(this._angleMode===constants.RADIANS){return angle*constants.RAD_TO_DEG}return angle};_main.default.prototype._fromRadians=function(angle){if(this._angleMode===constants.DEGREES){return angle*constants.RAD_TO_DEG}return angle};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],334:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.textAlign=function(horizAlign,vertAlign){var _this$_renderer;_main.default._validateParameters("textAlign",arguments);return(_this$_renderer=this._renderer).textAlign.apply(_this$_renderer,arguments)};_main.default.prototype.textLeading=function(theLeading){var _this$_renderer2;_main.default._validateParameters("textLeading",arguments);return(_this$_renderer2=this._renderer).textLeading.apply(_this$_renderer2,arguments)};_main.default.prototype.textSize=function(theSize){var _this$_renderer3;_main.default._validateParameters("textSize",arguments);return(_this$_renderer3=this._renderer).textSize.apply(_this$_renderer3,arguments)};_main.default.prototype.textStyle=function(theStyle){var _this$_renderer4;_main.default._validateParameters("textStyle",arguments);return(_this$_renderer4=this._renderer).textStyle.apply(_this$_renderer4,arguments)};_main.default.prototype.textWidth=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}args[0]+="";_main.default._validateParameters("textWidth",args);if(args[0].length===0){return 0}var textLines=args[0].replace(/\t/g,"  ").split(/\r?\n|\r|\n/g);var newArr=[];for(var i=0;i<textLines.length;i++){newArr.push(this._renderer.textWidth(textLines[i]))}var largestWidth=Math.max.apply(Math,newArr);return largestWidth};_main.default.prototype.textAscent=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default._validateParameters("textAscent",args);return this._renderer.textAscent()};_main.default.prototype.textDescent=function(){for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}_main.default._validateParameters("textDescent",args);return this._renderer.textDescent()};_main.default.prototype._updateTextMetrics=function(){return this._renderer._updateTextMetrics()};_main.default.prototype.textWrap=function(wrapStyle){if(wrapStyle!=="WORD"&&wrapStyle!=="CHAR"){throw"Error: textWrap accepts only WORD or CHAR"}return this._renderer.textWrap(wrapStyle)};var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.replace":214,"core-js/modules/es.string.split":216}],335:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.last-index-of");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.last-index-of");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.split");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));var opentype=_interopRequireWildcard(_dereq_("opentype.js"));_dereq_("../core/friendly_errors/validate_params");_dereq_("../core/friendly_errors/file_errors");_dereq_("../core/friendly_errors/fes_core");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.loadFont=function(path,onSuccess,onError){_main.default._validateParameters("loadFont",arguments);var p5Font=new _main.default.Font(this);var self=this;opentype.load(path,function(err,font){if(err){_main.default._friendlyFileLoadError(4,path);if(typeof onError!=="undefined"){return onError(err)}console.error(err,path);return}p5Font.font=font;if(typeof onSuccess!=="undefined"){onSuccess(p5Font)}self._decrementPreload();var validFontTypes=["ttf","otf","woff","woff2"];var fileNoPath=path.split("\\").pop().split("/").pop();var lastDotIdx=fileNoPath.lastIndexOf(".");var fontFamily;var newStyle;var fileExt=lastDotIdx<1?null:fileNoPath.slice(lastDotIdx+1);if(validFontTypes.includes(fileExt)){fontFamily=fileNoPath.slice(0,lastDotIdx!==-1?lastDotIdx:0);newStyle=document.createElement("style");newStyle.appendChild(document.createTextNode("\n@font-face {\nfont-family: ".concat(fontFamily,";\nsrc: url(").concat(path,");\n}\n")));document.head.appendChild(newStyle)}});return p5Font};_main.default.prototype.text=function(str,x,y,maxWidth,maxHeight){var _this$_renderer;_main.default._validateParameters("text",arguments);return!(this._renderer._doFill||this._renderer._doStroke)?this:(_this$_renderer=this._renderer).text.apply(_this$_renderer,arguments)};_main.default.prototype.textFont=function(theFont,theSize){_main.default._validateParameters("textFont",arguments);if(arguments.length){if(!theFont){throw new Error("null font passed to textFont")}this._renderer._setProperty("_textFont",theFont);if(theSize){this._renderer._setProperty("_textSize",theSize);if(!this._renderer._leadingSet){this._renderer._setProperty("_textLeading",theSize*constants._DEFAULT_LEADMULT)}}return this._renderer._applyTextProperties()}return this._renderer._textFont};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/friendly_errors/fes_core":289,"../core/friendly_errors/file_errors":290,"../core/friendly_errors/validate_params":293,"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.last-index-of":181,"core-js/modules/es.array.slice":183,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.split":216,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256,"opentype.js":271}],336:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.number.to-fixed");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.number.to-fixed");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.Font=function(){function _class(p){_classCallCheck(this,_class);this.parent=p;this.cache={};this.font=undefined}_createClass(_class,[{key:"textBounds",value:function textBounds(str){var x=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var y=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var fontSize=arguments.length>3?arguments[3]:undefined;var opts=arguments.length>4?arguments[4]:undefined;var p=opts&&opts.renderer&&opts.renderer._pInst||this.parent;var ctx=p._renderer.drawingContext;var alignment=ctx.textAlign||constants.LEFT;var baseline=ctx.textBaseline||constants.BASELINE;var cacheResults=false;var result;var key;fontSize=fontSize||p._renderer._textSize;if(cacheResults){key=cacheKey("textBounds",str,x,y,fontSize,alignment,baseline);result=this.cache[key]}if(!result){var minX=[];var minY;var maxX=[];var maxY;var pos;var xCoords=[];xCoords[0]=[];var yCoords=[];var scale=this._scale(fontSize);var lineHeight=p._renderer.textLeading();var lineCount=0;this.font.forEachGlyph(str,x,y,fontSize,opts,function(glyph,gX,gY,gFontSize){var gm=glyph.getMetrics();if(glyph.index===0||glyph.index===10){lineCount+=1;xCoords[lineCount]=[]}else{xCoords[lineCount].push(gX+gm.xMin*scale);xCoords[lineCount].push(gX+gm.xMax*scale);yCoords.push(gY+lineCount*lineHeight+-gm.yMin*scale);yCoords.push(gY+lineCount*lineHeight+-gm.yMax*scale)}});if(xCoords[lineCount].length>0){minX[lineCount]=Math.min.apply(null,xCoords[lineCount]);maxX[lineCount]=Math.max.apply(null,xCoords[lineCount])}var finalMaxX=0;for(var i=0;i<=lineCount;i++){minX[i]=Math.min.apply(null,xCoords[i]);maxX[i]=Math.max.apply(null,xCoords[i]);var lineLength=maxX[i]-minX[i];if(lineLength>finalMaxX){finalMaxX=lineLength}}var finalMinX=Math.min.apply(null,minX);minY=Math.min.apply(null,yCoords);maxY=Math.max.apply(null,yCoords);result={x:finalMinX,y:minY,h:maxY-minY,w:finalMaxX,advance:finalMinX-x};pos=this._handleAlignment(p._renderer,str,result.x,result.y,result.w+result.advance);result.x=pos.x;result.y=pos.y;if(cacheResults){this.cache[key]=result}}return result}},{key:"textToPoints",value:function textToPoints(txt,x,y,fontSize,options){var xOriginal=x;var result=[];var lines=txt.split(/\r?\n|\r|\n/g);fontSize=fontSize||this.parent._renderer._textSize;function isSpace(i,text,glyphsLine){return glyphsLine[i].name&&glyphsLine[i].name==="space"||text.length===glyphsLine.length&&text[i]===" "}for(var i=0;i<lines.length;i++){var xoff=0;x=xOriginal;var line=lines[i];line=line.replace("\t","  ");var glyphs=this._getGlyphs(line);for(var j=0;j<glyphs.length;j++){if(!isSpace(j,line,glyphs)){var gpath=glyphs[j].getPath(x,y,fontSize),paths=splitPaths(gpath.commands);for(var k=0;k<paths.length;k++){var pts=pathToPoints(paths[k],options);for(var l=0;l<pts.length;l++){pts[l].x+=xoff;result.push(pts[l])}}}xoff+=glyphs[j].advanceWidth*this._scale(fontSize)}y=y+this.parent._renderer._textLeading}return result}},{key:"_getGlyphs",value:function _getGlyphs(str){return this.font.stringToGlyphs(str)}},{key:"_getPath",value:function _getPath(line,x,y,options){var p=options&&options.renderer&&options.renderer._pInst||this.parent,renderer=p._renderer,pos=this._handleAlignment(renderer,line,x,y);return this.font.getPath(line,pos.x,pos.y,renderer._textSize,options)}},{key:"_getPathData",value:function _getPathData(line,x,y,options){var decimals=3;if(typeof line==="string"&&arguments.length>2){line=this._getPath(line,x,y,options)}else if(_typeof(x)==="object"){options=x}if(options&&typeof options.decimals==="number"){decimals=options.decimals}return line.toPathData(decimals)}},{key:"_getSVG",value:function _getSVG(line,x,y,options){var decimals=3;if(typeof line==="string"&&arguments.length>2){line=this._getPath(line,x,y,options)}else if(_typeof(x)==="object"){options=x}if(options){if(typeof options.decimals==="number"){decimals=options.decimals}if(typeof options.strokeWidth==="number"){line.strokeWidth=options.strokeWidth}if(typeof options.fill!=="undefined"){line.fill=options.fill}if(typeof options.stroke!=="undefined"){line.stroke=options.stroke}}return line.toSVG(decimals)}},{key:"_renderPath",value:function _renderPath(line,x,y,options){var pdata;var pg=options&&options.renderer||this.parent._renderer;var ctx=pg.drawingContext;if(_typeof(line)==="object"&&line.commands){pdata=line.commands}else{pdata=this._getPath(line,x,y,options).commands}ctx.beginPath();var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=pdata[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var cmd=_step.value;if(cmd.type==="M"){ctx.moveTo(cmd.x,cmd.y)}else if(cmd.type==="L"){ctx.lineTo(cmd.x,cmd.y)}else if(cmd.type==="C"){ctx.bezierCurveTo(cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y)}else if(cmd.type==="Q"){ctx.quadraticCurveTo(cmd.x1,cmd.y1,cmd.x,cmd.y)}else if(cmd.type==="Z"){ctx.closePath()}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}if(pg._doStroke&&pg._strokeSet&&!pg._clipping){ctx.stroke()}if(pg._doFill&&!pg._clipping){if(!pg._fillSet){pg._setFill(constants._DEFAULT_TEXT_FILL)}ctx.fill()}return this}},{key:"_textWidth",value:function _textWidth(str,fontSize){return this.font.getAdvanceWidth(str,fontSize)}},{key:"_textAscent",value:function _textAscent(fontSize){return this.font.ascender*this._scale(fontSize)}},{key:"_textDescent",value:function _textDescent(fontSize){return-this.font.descender*this._scale(fontSize)}},{key:"_scale",value:function _scale(fontSize){return 1/this.font.unitsPerEm*(fontSize||this.parent._renderer._textSize)}},{key:"_handleAlignment",value:function _handleAlignment(renderer,line,x,y,textWidth){var fontSize=renderer._textSize;if(typeof textWidth==="undefined"){textWidth=this._textWidth(line,fontSize)}switch(renderer._textAlign){case constants.CENTER:x-=textWidth/2;break;case constants.RIGHT:x-=textWidth;break}switch(renderer._textBaseline){case constants.TOP:y+=this._textAscent(fontSize);break;case constants.CENTER:y+=this._textAscent(fontSize)/2;break;case constants.BOTTOM:y-=this._textDescent(fontSize);break}return{x:x,y:y}}}]);return _class}();function pathToPoints(cmds,options){var opts=parseOpts(options,{sampleFactor:.1,simplifyThreshold:0});var len=pointAtLength(cmds,0,1),t=len/(len*opts.sampleFactor),pts=[];for(var i=0;i<len;i+=t){pts.push(pointAtLength(cmds,i))}if(opts.simplifyThreshold){simplify(pts,opts.simplifyThreshold)}return pts}function simplify(pts){var angle=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var num=0;for(var i=pts.length-1;pts.length>3&&i>=0;--i){if(collinear(at(pts,i-1),at(pts,i),at(pts,i+1),angle)){pts.splice(i%pts.length,1);num++}}return num}function splitPaths(cmds){var paths=[];var current;for(var i=0;i<cmds.length;i++){if(cmds[i].type==="M"){if(current){paths.push(current)}current=[]}current.push(cmdToArr(cmds[i]))}paths.push(current);return paths}function cmdToArr(cmd){var arr=[cmd.type];if(cmd.type==="M"||cmd.type==="L"){arr.push(cmd.x,cmd.y)}else if(cmd.type==="C"){arr.push(cmd.x1,cmd.y1,cmd.x2,cmd.y2,cmd.x,cmd.y)}else if(cmd.type==="Q"){arr.push(cmd.x1,cmd.y1,cmd.x,cmd.y)}return arr}function parseOpts(options,defaults){if(_typeof(options)!=="object"){options=defaults}else{for(var key in defaults){if(typeof options[key]==="undefined"){options[key]=defaults[key]}}}return options}function at(v,i){var s=v.length;return v[i<0?i%s+s:i%s]}function collinear(a,b,c,thresholdAngle){if(!thresholdAngle){return areaTriangle(a,b,c)===0}if(typeof collinear.tmpPoint1==="undefined"){collinear.tmpPoint1=[];collinear.tmpPoint2=[]}var ab=collinear.tmpPoint1,bc=collinear.tmpPoint2;ab.x=b.x-a.x;ab.y=b.y-a.y;bc.x=c.x-b.x;bc.y=c.y-b.y;var dot=ab.x*bc.x+ab.y*bc.y,magA=Math.sqrt(ab.x*ab.x+ab.y*ab.y),magB=Math.sqrt(bc.x*bc.x+bc.y*bc.y),angle=Math.acos(dot/(magA*magB));return angle<thresholdAngle}function areaTriangle(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(c[0]-a[0])*(b[1]-a[1])}function findDotsAtSegment(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t){var t1=1-t;var t13=Math.pow(t1,3);var t12=Math.pow(t1,2);var t2=t*t;var t3=t2*t;var x=t13*p1x+t12*3*t*c1x+t1*3*t*t*c2x+t3*p2x;var y=t13*p1y+t12*3*t*c1y+t1*3*t*t*c2y+t3*p2y;var mx=p1x+2*t*(c1x-p1x)+t2*(c2x-2*c1x+p1x);var my=p1y+2*t*(c1y-p1y)+t2*(c2y-2*c1y+p1y);var nx=c1x+2*t*(c2x-c1x)+t2*(p2x-2*c2x+c1x);var ny=c1y+2*t*(c2y-c1y)+t2*(p2y-2*c2y+c1y);var ax=t1*p1x+t*c1x;var ay=t1*p1y+t*c1y;var cx=t1*c2x+t*p2x;var cy=t1*c2y+t*p2y;var alpha=90-Math.atan2(mx-nx,my-ny)*180/Math.PI;if(mx>nx||my<ny){alpha+=180}return{x:x,y:y,m:{x:mx,y:my},n:{x:nx,y:ny},start:{x:ax,y:ay},end:{x:cx,y:cy},alpha:alpha}}function getPointAtSegmentLength(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,length){return length==null?bezlen(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y):findDotsAtSegment(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,getTatLen(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,length))}function pointAtLength(path,length,istotal){path=path2curve(path);var x;var y;var p;var l;var sp="";var subpaths={};var point;var len=0;for(var i=0,ii=path.length;i<ii;i++){p=path[i];if(p[0]==="M"){x=+p[1];y=+p[2]}else{l=getPointAtSegmentLength(x,y,p[1],p[2],p[3],p[4],p[5],p[6]);if(len+l>length){if(!istotal){point=getPointAtSegmentLength(x,y,p[1],p[2],p[3],p[4],p[5],p[6],length-len);return{x:point.x,y:point.y,alpha:point.alpha}}}len+=l;x=+p[5];y=+p[6]}sp+=p.shift()+p}subpaths.end=sp;point=istotal?len:findDotsAtSegment(x,y,p[0],p[1],p[2],p[3],p[4],p[5],1);if(point.alpha){point={x:point.x,y:point.y,alpha:point.alpha}}return point}function pathToAbsolute(pathArray){var res=[],x=0,y=0,mx=0,my=0,start=0;if(!pathArray){return res}if(pathArray[0][0]==="M"){x=+pathArray[0][1];y=+pathArray[0][2];mx=x;my=y;start++;res[0]=["M",x,y]}var dots;var crz=pathArray.length===3&&pathArray[0][0]==="M"&&pathArray[1][0].toUpperCase()==="R"&&pathArray[2][0].toUpperCase()==="Z";for(var r,pa,i=start,ii=pathArray.length;i<ii;i++){res.push(r=[]);pa=pathArray[i];if(pa[0]!==String.prototype.toUpperCase.call(pa[0])){r[0]=String.prototype.toUpperCase.call(pa[0]);switch(r[0]){case"A":r[1]=pa[1];r[2]=pa[2];r[3]=pa[3];r[4]=pa[4];r[5]=pa[5];r[6]=+(pa[6]+x);r[7]=+(pa[7]+y);break;case"V":r[1]=+pa[1]+y;break;case"H":r[1]=+pa[1]+x;break;case"R":dots=[x,y].concat(pa.slice(1));for(var j=2,jj=dots.length;j<jj;j++){dots[j]=+dots[j]+x;dots[++j]=+dots[j]+y}res.pop();res=res.concat(catmullRom2bezier(dots,crz));break;case"M":mx=+pa[1]+x;my=+pa[2]+y;break;default:for(var _j=1,_jj=pa.length;_j<_jj;_j++){r[_j]=+pa[_j]+(_j%2?x:y)}}}else if(pa[0]==="R"){dots=[x,y].concat(pa.slice(1));res.pop();res=res.concat(catmullRom2bezier(dots,crz));r=["R"].concat(pa.slice(-2))}else{for(var k=0,kk=pa.length;k<kk;k++){r[k]=pa[k]}}switch(r[0]){case"Z":x=mx;y=my;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":mx=r[r.length-2];my=r[r.length-1];break;default:x=r[r.length-2];y=r[r.length-1]}}return res}function path2curve(path,path2){var p=pathToAbsolute(path),p2=path2&&pathToAbsolute(path2);var attrs={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};var attrs2={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};var pcoms1=[];var pcoms2=[];var ii;var processPath=function processPath(path,d,pcom){var nx;var ny;var tq={T:1,Q:1};if(!path){return["C",d.x,d.y,d.x,d.y,d.x,d.y]}if(!(path[0]in tq)){d.qx=d.qy=null}switch(path[0]){case"M":d.X=path[1];d.Y=path[2];break;case"A":path=["C"].concat(a2c.apply(0,[d.x,d.y].concat(path.slice(1))));break;case"S":if(pcom==="C"||pcom==="S"){nx=d.x*2-d.bx;ny=d.y*2-d.by}else{nx=d.x;ny=d.y}path=["C",nx,ny].concat(path.slice(1));break;case"T":if(pcom==="Q"||pcom==="T"){d.qx=d.x*2-d.qx;d.qy=d.y*2-d.qy}else{d.qx=d.x;d.qy=d.y}path=["C"].concat(q2c(d.x,d.y,d.qx,d.qy,path[1],path[2]));break;case"Q":d.qx=path[1];d.qy=path[2];path=["C"].concat(q2c(d.x,d.y,path[1],path[2],path[3],path[4]));break;case"L":path=["C"].concat(l2c(d.x,d.y,path[1],path[2]));break;case"H":path=["C"].concat(l2c(d.x,d.y,path[1],d.y));break;case"V":path=["C"].concat(l2c(d.x,d.y,d.x,path[1]));break;case"Z":path=["C"].concat(l2c(d.x,d.y,d.X,d.Y));break}return path},fixArc=function fixArc(pp,i){if(pp[i].length>7){pp[i].shift();var pi=pp[i];while(pi.length){pcoms1[i]="A";if(p2){pcoms2[i]="A"}pp.splice(i++,0,["C"].concat(pi.splice(0,6)))}pp.splice(i,1);ii=Math.max(p.length,p2&&p2.length||0)}},fixM=function fixM(path1,path2,a1,a2,i){if(path1&&path2&&path1[i][0]==="M"&&path2[i][0]!=="M"){path2.splice(i,0,["M",a2.x,a2.y]);a1.bx=0;a1.by=0;a1.x=path1[i][1];a1.y=path1[i][2];ii=Math.max(p.length,p2&&p2.length||0)}};var pfirst="";var pcom="";ii=Math.max(p.length,p2&&p2.length||0);for(var i=0;i<ii;i++){if(p[i]){pfirst=p[i][0]}if(pfirst!=="C"){pcoms1[i]=pfirst;if(i){pcom=pcoms1[i-1]}}p[i]=processPath(p[i],attrs,pcom);if(pcoms1[i]!=="A"&&pfirst==="C"){pcoms1[i]="C"}fixArc(p,i);if(p2){if(p2[i]){pfirst=p2[i][0]}if(pfirst!=="C"){pcoms2[i]=pfirst;if(i){pcom=pcoms2[i-1]}}p2[i]=processPath(p2[i],attrs2,pcom);if(pcoms2[i]!=="A"&&pfirst==="C"){pcoms2[i]="C"}fixArc(p2,i)}fixM(p,p2,attrs,attrs2,i);fixM(p2,p,attrs2,attrs,i);var seg=p[i],seg2=p2&&p2[i],seglen=seg.length,seg2len=p2&&seg2.length;attrs.x=seg[seglen-2];attrs.y=seg[seglen-1];attrs.bx=parseFloat(seg[seglen-4])||attrs.x;attrs.by=parseFloat(seg[seglen-3])||attrs.y;attrs2.bx=p2&&(parseFloat(seg2[seg2len-4])||attrs2.x);attrs2.by=p2&&(parseFloat(seg2[seg2len-3])||attrs2.y);attrs2.x=p2&&seg2[seg2len-2];attrs2.y=p2&&seg2[seg2len-1]}return p2?[p,p2]:p}function a2c(x1,y1,rx,ry,angle,lac,sweep_flag,x2,y2,recursive){var PI=Math.PI;var _120=PI*120/180;var f1;var f2;var cx;var cy;var rad=PI/180*(+angle||0);var res=[];var xy;var rotate=function rotate(x,y,rad){var X=x*Math.cos(rad)-y*Math.sin(rad),Y=x*Math.sin(rad)+y*Math.cos(rad);return{x:X,y:Y}};if(!recursive){xy=rotate(x1,y1,-rad);x1=xy.x;y1=xy.y;xy=rotate(x2,y2,-rad);x2=xy.x;y2=xy.y;var x=(x1-x2)/2;var y=(y1-y2)/2;var h=x*x/(rx*rx)+y*y/(ry*ry);if(h>1){h=Math.sqrt(h);rx=h*rx;ry=h*ry}var rx2=rx*rx,ry2=ry*ry;var k=(lac===sweep_flag?-1:1)*Math.sqrt(Math.abs((rx2*ry2-rx2*y*y-ry2*x*x)/(rx2*y*y+ry2*x*x)));cx=k*rx*y/ry+(x1+x2)/2;cy=k*-ry*x/rx+(y1+y2)/2;f1=Math.asin(((y1-cy)/ry).toFixed(9));f2=Math.asin(((y2-cy)/ry).toFixed(9));f1=x1<cx?PI-f1:f1;f2=x2<cx?PI-f2:f2;if(f1<0){f1=PI*2+f1}if(f2<0){f2=PI*2+f2}if(sweep_flag&&f1>f2){f1=f1-PI*2}if(!sweep_flag&&f2>f1){f2=f2-PI*2}}else{f1=recursive[0];f2=recursive[1];cx=recursive[2];cy=recursive[3]}var df=f2-f1;if(Math.abs(df)>_120){var f2old=f2,x2old=x2,y2old=y2;f2=f1+_120*(sweep_flag&&f2>f1?1:-1);x2=cx+rx*Math.cos(f2);y2=cy+ry*Math.sin(f2);res=a2c(x2,y2,rx,ry,angle,0,sweep_flag,x2old,y2old,[f2,f2old,cx,cy])}df=f2-f1;var c1=Math.cos(f1),s1=Math.sin(f1),c2=Math.cos(f2),s2=Math.sin(f2),t=Math.tan(df/4),hx=4/3*rx*t,hy=4/3*ry*t,m1=[x1,y1],m2=[x1+hx*s1,y1-hy*c1],m3=[x2+hx*s2,y2-hy*c2],m4=[x2,y2];m2[0]=2*m1[0]-m2[0];m2[1]=2*m1[1]-m2[1];if(recursive){return[m2,m3,m4].concat(res)}else{res=[m2,m3,m4].concat(res).join().split(",");var newres=[];for(var i=0,ii=res.length;i<ii;i++){newres[i]=i%2?rotate(res[i-1],res[i],rad).y:rotate(res[i],res[i+1],rad).x}return newres}}function catmullRom2bezier(crp,z){var d=[];for(var i=0,iLen=crp.length;iLen-2*!z>i;i+=2){var p=[{x:+crp[i-2],y:+crp[i-1]},{x:+crp[i],y:+crp[i+1]},{x:+crp[i+2],y:+crp[i+3]},{x:+crp[i+4],y:+crp[i+5]}];if(z){if(!i){p[0]={x:+crp[iLen-2],y:+crp[iLen-1]}}else if(iLen-4===i){p[3]={x:+crp[0],y:+crp[1]}}else if(iLen-2===i){p[2]={x:+crp[0],y:+crp[1]};p[3]={x:+crp[2],y:+crp[3]}}}else{if(iLen-4===i){p[3]=p[2]}else if(!i){p[0]={x:+crp[i],y:+crp[i+1]}}}d.push(["C",(-p[0].x+6*p[1].x+p[2].x)/6,(-p[0].y+6*p[1].y+p[2].y)/6,(p[1].x+6*p[2].x-p[3].x)/6,(p[1].y+6*p[2].y-p[3].y)/6,p[2].x,p[2].y])}return d}function l2c(x1,y1,x2,y2){return[x1,y1,x2,y2,x2,y2]}function q2c(x1,y1,ax,ay,x2,y2){var _13=1/3,_23=2/3;return[_13*x1+_23*ax,_13*y1+_23*ay,_13*x2+_23*ax,_13*y2+_23*ay,x2,y2]}function bezlen(x1,y1,x2,y2,x3,y3,x4,y4,z){if(z==null){z=1}z=z>1?1:z<0?0:z;var z2=z/2;var n=12;var Tvalues=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816];var sum=0;var Cvalues=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472];for(var i=0;i<n;i++){var ct=z2*Tvalues[i]+z2,xbase=base3(ct,x1,x2,x3,x4),ybase=base3(ct,y1,y2,y3,y4),comb=xbase*xbase+ybase*ybase;sum+=Cvalues[i]*Math.sqrt(comb)}return z2*sum}function getTatLen(x1,y1,x2,y2,x3,y3,x4,y4,ll){if(ll<0||bezlen(x1,y1,x2,y2,x3,y3,x4,y4)<ll){return}var t=1;var step=t/2;var t2=t-step;var l;var e=.01;l=bezlen(x1,y1,x2,y2,x3,y3,x4,y4,t2);while(Math.abs(l-ll)>e){step/=2;t2+=(l<ll?1:-1)*step;l=bezlen(x1,y1,x2,y2,x3,y3,x4,y4,t2)}return t2}function base3(t,p1,p2,p3,p4){var t1=-3*p1+9*p2-9*p3+3*p4,t2=t*t1+6*p1-12*p2+6*p3;return t*t2-3*p1+3*p2}function cacheKey(){var hash="";for(var i=arguments.length-1;i>=0;--i){hash+="？".concat(i<0||arguments.length<=i?undefined:arguments[i])}return hash}var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.fill":172,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.join":180,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.splice":185,"core-js/modules/es.function.name":186,"core-js/modules/es.number.to-fixed":193,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.replace":214,"core-js/modules/es.string.split":216,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],337:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.array-buffer.constructor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.array-buffer.constructor");_dereq_("core-js/modules/es.object.to-string");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.append=function(array,value){array.push(value);return array};_main.default.prototype.arrayCopy=function(src,srcPosition,dst,dstPosition,length){var start;var end;if(typeof length!=="undefined"){end=Math.min(length,src.length);start=dstPosition;src=src.slice(srcPosition,end+srcPosition)}else{if(typeof dst!=="undefined"){end=dst;end=Math.min(end,src.length)}else{end=src.length}start=0;dst=srcPosition;src=src.slice(0,end)}Array.prototype.splice.apply(dst,[start,end].concat(src))};_main.default.prototype.concat=function(list0,list1){return list0.concat(list1)};_main.default.prototype.reverse=function(list){return list.reverse()};_main.default.prototype.shorten=function(list){list.pop();return list};_main.default.prototype.shuffle=function(arr,bool){var isView=ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(arr);arr=bool||isView?arr:arr.slice();var rnd,tmp,idx=arr.length;while(idx>1){rnd=this.random(0,1)*idx|0;tmp=arr[--idx];arr[idx]=arr[rnd];arr[rnd]=tmp}return arr};_main.default.prototype.sort=function(list,count){var arr=count?list.slice(0,Math.min(count,list.length)):list;var rest=count?list.slice(Math.min(count,list.length)):[];if(typeof arr[0]==="string"){arr=arr.sort()}else{arr=arr.sort(function(a,b){return a-b})}return arr.concat(rest)};_main.default.prototype.splice=function(list,value,index){Array.prototype.splice.apply(list,[index,0].concat(value));return list};_main.default.prototype.subset=function(list,start,count){if(typeof count!=="undefined"){return list.slice(start,start+count)}else{return list.slice(start,list.length)}};var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array-buffer.constructor":168,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.splice":185,"core-js/modules/es.object.to-string":200}],338:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.repeat");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.number.constructor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.repeat");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.float=function(str){if(str instanceof Array){return str.map(parseFloat)}return parseFloat(str)};_main.default.prototype.int=function(n){var radix=arguments.length>1&&arguments[1]!==undefined?arguments[1]:10;if(n===Infinity||n==="Infinity"){return Infinity}else if(n===-Infinity||n==="-Infinity"){return-Infinity}else if(typeof n==="string"){return parseInt(n,radix)}else if(typeof n==="number"){return n|0}else if(typeof n==="boolean"){return n?1:0}else if(n instanceof Array){return n.map(function(n){return _main.default.prototype.int(n,radix)})}};_main.default.prototype.str=function(n){if(n instanceof Array){return n.map(_main.default.prototype.str)}else{return String(n)}};_main.default.prototype.boolean=function(n){if(typeof n==="number"){return n!==0}else if(typeof n==="string"){return n.toLowerCase()==="true"}else if(typeof n==="boolean"){return n}else if(n instanceof Array){return n.map(_main.default.prototype.boolean)}};_main.default.prototype.byte=function(n){var nn=_main.default.prototype.int(n,10);if(typeof nn==="number"){return(nn+128)%256-128}else if(nn instanceof Array){return nn.map(_main.default.prototype.byte)}};_main.default.prototype.char=function(n){if(typeof n==="number"&&!isNaN(n)){return String.fromCharCode(n)}else if(n instanceof Array){return n.map(_main.default.prototype.char)}else if(typeof n==="string"){return _main.default.prototype.char(parseInt(n,10))}};_main.default.prototype.unchar=function(n){if(typeof n==="string"&&n.length===1){return n.charCodeAt(0)}else if(n instanceof Array){return n.map(_main.default.prototype.unchar)}};_main.default.prototype.hex=function(n,digits){digits=digits===undefined||digits===null?digits=8:digits;if(n instanceof Array){return n.map(function(n){return _main.default.prototype.hex(n,digits)})}else if(n===Infinity||n===-Infinity){var c=n===Infinity?"F":"0";return c.repeat(digits)}else if(typeof n==="number"){if(n<0){n=4294967295+n+1}var hex=Number(n).toString(16).toUpperCase();while(hex.length<digits){hex="0".concat(hex)}if(hex.length>=digits){hex=hex.substring(hex.length-digits,hex.length)}return hex}};_main.default.prototype.unhex=function(n){if(n instanceof Array){return n.map(_main.default.prototype.unhex)}else{return parseInt("0x".concat(n),16)}};var _default=_main.default;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.map":182,"core-js/modules/es.number.constructor":191,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.repeat":213}],339:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.number.to-fixed");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.pad-start");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.array.filter");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.number.to-fixed");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.constructor");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.pad-start");_dereq_("core-js/modules/es.string.replace");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));_dereq_("../core/friendly_errors/validate_params");_dereq_("../core/friendly_errors/file_errors");_dereq_("../core/friendly_errors/fes_core");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||Object.prototype.toString.call(arr)==="[object Arguments]")){return}var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}_main.default.prototype.join=function(list,separator){_main.default._validateParameters("join",arguments);return list.join(separator)};_main.default.prototype.match=function(str,reg){_main.default._validateParameters("match",arguments);return str.match(reg)};_main.default.prototype.matchAll=function(str,reg){_main.default._validateParameters("matchAll",arguments);var re=new RegExp(reg,"g");var match=re.exec(str);var matches=[];while(match!==null){matches.push(match);match=re.exec(str)}return matches};_main.default.prototype.nf=function(nums,left,right){_main.default._validateParameters("nf",arguments);if(nums instanceof Array){return nums.map(function(x){return doNf(x,left,right)})}else{var typeOfFirst=Object.prototype.toString.call(nums);if(typeOfFirst==="[object Arguments]"){if(nums.length===3){return this.nf(nums[0],nums[1],nums[2])}else if(nums.length===2){return this.nf(nums[0],nums[1])}else{return this.nf(nums[0])}}else{return doNf(nums,left,right)}}};function doNf(num,left,right){var _num$toString$split=num.toString().split("."),_num$toString$split2=_slicedToArray(_num$toString$split,2),leftPart=_num$toString$split2[0],rightPart=_num$toString$split2[1];if(typeof right==="undefined"){leftPart=leftPart.padStart(left,"0");return rightPart?leftPart+"."+rightPart:leftPart}else{var roundedOff=num.toFixed(right);var _roundedOff$toString$=roundedOff.toString().split(".");var _roundedOff$toString$2=_slicedToArray(_roundedOff$toString$,2);leftPart=_roundedOff$toString$2[0];rightPart=_roundedOff$toString$2[1];leftPart=leftPart.padStart(left,"0");if(typeof rightPart==="undefined"){return leftPart}else{return leftPart+"."+rightPart}}}_main.default.prototype.nfc=function(num,right){_main.default._validateParameters("nfc",arguments);if(num instanceof Array){return num.map(function(x){return doNfc(x,right)})}else{return doNfc(num,right)}};function doNfc(num,right){num=num.toString();var dec=num.indexOf(".");var rem=dec!==-1?num.substring(dec):"";var n=dec!==-1?num.substring(0,dec):num;n=n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");if(right===0){rem=""}else if(typeof right!=="undefined"){if(right>rem.length){rem+=dec===-1?".":"";var len=right-rem.length+1;for(var i=0;i<len;i++){rem+="0"}}else{rem=rem.substring(0,right+1)}}return n+rem}_main.default.prototype.nfp=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("nfp",args);var nfRes=_main.default.prototype.nf.apply(this,args);if(nfRes instanceof Array){return nfRes.map(addNfp)}else{return addNfp(nfRes)}};function addNfp(num){return parseFloat(num)>0?"+".concat(num.toString()):num.toString()}_main.default.prototype.nfs=function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default._validateParameters("nfs",args);var nfRes=_main.default.prototype.nf.apply(this,args);if(nfRes instanceof Array){return nfRes.map(addNfs)}else{return addNfs(nfRes)}};function addNfs(num){return parseFloat(num)>=0?" ".concat(num.toString()):num.toString()}_main.default.prototype.split=function(str,delim){_main.default._validateParameters("split",arguments);return str.split(delim)};_main.default.prototype.splitTokens=function(value,delims){_main.default._validateParameters("splitTokens",arguments);var d;if(typeof delims!=="undefined"){var str=delims;var sqc=/\]/g.exec(str);var sqo=/\[/g.exec(str);if(sqo&&sqc){str=str.slice(0,sqc.index)+str.slice(sqc.index+1);sqo=/\[/g.exec(str);str=str.slice(0,sqo.index)+str.slice(sqo.index+1);d=new RegExp("[\\[".concat(str,"\\]]"),"g")}else if(sqc){str=str.slice(0,sqc.index)+str.slice(sqc.index+1);d=new RegExp("[".concat(str,"\\]]"),"g")}else if(sqo){str=str.slice(0,sqo.index)+str.slice(sqo.index+1);d=new RegExp("[".concat(str,"\\[]"),"g")}else{d=new RegExp("[".concat(str,"]"),"g")}}else{d=/\s/g}return value.split(d).filter(function(n){return n})};_main.default.prototype.trim=function(str){_main.default._validateParameters("trim",arguments);if(str instanceof Array){return str.map(this.trim)}else{return str.trim()}};var _default=_main.default;exports.default=_default},{"../core/friendly_errors/fes_core":289,"../core/friendly_errors/file_errors":290,"../core/friendly_errors/validate_params":293,"../core/main":298,"core-js/modules/es.array.filter":173,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.join":180,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.number.to-fixed":193,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.constructor":204,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.match":211,"core-js/modules/es.string.pad-start":212,"core-js/modules/es.string.replace":214,"core-js/modules/es.string.split":216,"core-js/modules/es.string.trim":219,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.iterator":256}],340:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.day=function(){return(new Date).getDate()};_main.default.prototype.hour=function(){return(new Date).getHours()};_main.default.prototype.minute=function(){return(new Date).getMinutes()};_main.default.prototype.millis=function(){if(this._millisStart===-1){return 0}else{return window.performance.now()-this._millisStart}};_main.default.prototype.month=function(){return(new Date).getMonth()+1};_main.default.prototype.second=function(){return(new Date).getSeconds()};_main.default.prototype.year=function(){return(new Date).getFullYear()};var _default=_main.default;exports.default=_default},{"../core/main":298}],341:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.math.hypot");_dereq_("core-js/modules/es.math.sign");_dereq_("core-js/modules/es.number.to-fixed");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.math.hypot");_dereq_("core-js/modules/es.math.sign");_dereq_("core-js/modules/es.number.to-fixed");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));_dereq_("./p5.Geometry");var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.beginGeometry=function(){return this._renderer.beginGeometry()};_main.default.prototype.endGeometry=function(){return this._renderer.endGeometry()};_main.default.prototype.buildGeometry=function(callback){return this._renderer.buildGeometry(callback)};_main.default.prototype.freeGeometry=function(geometry){this._renderer._freeBuffers(geometry.gid)};_main.default.prototype.plane=function(width,height,detailX,detailY){this._assert3d("plane");_main.default._validateParameters("plane",arguments);if(typeof width==="undefined"){width=50}if(typeof height==="undefined"){height=width}if(typeof detailX==="undefined"){detailX=1}if(typeof detailY==="undefined"){detailY=1}var gId="plane|".concat(detailX,"|").concat(detailY);if(!this._renderer.geometryInHash(gId)){var _plane=function _plane(){var u,v,p;for(var i=0;i<=this.detailY;i++){v=i/this.detailY;for(var j=0;j<=this.detailX;j++){u=j/this.detailX;p=new _main.default.Vector(u-.5,v-.5,0);this.vertices.push(p);this.uvs.push(u,v)}}};var planeGeom=new _main.default.Geometry(detailX,detailY,_plane);planeGeom.computeFaces().computeNormals();if(detailX<=1&&detailY<=1){planeGeom._makeTriangleEdges()._edgesToVertices()}else if(this._renderer._doStroke){console.log("Cannot draw stroke on plane objects with more"+" than 1 detailX or 1 detailY")}this._renderer.createBuffers(gId,planeGeom)}this._renderer.drawBuffersScaled(gId,width,height,1);return this};_main.default.prototype.box=function(width,height,depth,detailX,detailY){this._assert3d("box");_main.default._validateParameters("box",arguments);if(typeof width==="undefined"){width=50}if(typeof height==="undefined"){height=width}if(typeof depth==="undefined"){depth=height}var perPixelLighting=this._renderer.attributes&&this._renderer.attributes.perPixelLighting;if(typeof detailX==="undefined"){detailX=perPixelLighting?1:4}if(typeof detailY==="undefined"){detailY=perPixelLighting?1:4}var gId="box|".concat(detailX,"|").concat(detailY);if(!this._renderer.geometryInHash(gId)){var _box=function _box(){var _this=this;var cubeIndices=[[0,4,2,6],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[4,5,6,7]];this.edges=[[0,1],[1,3],[3,2],[6,7],[8,9],[9,11],[14,15],[16,17],[17,19],[18,19],[20,21],[22,23]];cubeIndices.forEach(function(cubeIndex,i){var v=i*4;for(var j=0;j<4;j++){var d=cubeIndex[j];var octant=new _main.default.Vector(((d&1)*2-1)/2,((d&2)-1)/2,((d&4)/2-1)/2);_this.vertices.push(octant);_this.uvs.push(j&1,(j&2)/2)}_this.faces.push([v,v+1,v+2]);_this.faces.push([v+2,v+1,v+3])})};var boxGeom=new _main.default.Geometry(detailX,detailY,_box);boxGeom.computeNormals();if(detailX<=4&&detailY<=4){boxGeom._edgesToVertices()}else if(this._renderer._doStroke){console.log("Cannot draw stroke on box objects with more"+" than 4 detailX or 4 detailY")}this._renderer.createBuffers(gId,boxGeom)}this._renderer.drawBuffersScaled(gId,width,height,depth);return this};_main.default.prototype.sphere=function(radius,detailX,detailY){this._assert3d("sphere");_main.default._validateParameters("sphere",arguments);if(typeof radius==="undefined"){radius=50}if(typeof detailX==="undefined"){detailX=24}if(typeof detailY==="undefined"){detailY=16}this.ellipsoid(radius,radius,radius,detailX,detailY);return this};var _truncatedCone=function _truncatedCone(bottomRadius,topRadius,height,detailX,detailY,bottomCap,topCap){bottomRadius=bottomRadius<=0?1:bottomRadius;topRadius=topRadius<0?0:topRadius;height=height<=0?bottomRadius:height;detailX=detailX<3?3:detailX;detailY=detailY<1?1:detailY;bottomCap=bottomCap===undefined?true:bottomCap;topCap=topCap===undefined?topRadius!==0:topCap;var start=bottomCap?-2:0;var end=detailY+(topCap?2:0);var slant=Math.atan2(bottomRadius-topRadius,height);var sinSlant=Math.sin(slant);var cosSlant=Math.cos(slant);var yy,ii,jj;for(yy=start;yy<=end;++yy){var v=yy/detailY;var y=height*v;var ringRadius=void 0;if(yy<0){y=0;v=0;ringRadius=bottomRadius}else if(yy>detailY){y=height;v=1;ringRadius=topRadius}else{ringRadius=bottomRadius+(topRadius-bottomRadius)*v}if(yy===-2||yy===detailY+2){ringRadius=0}y-=height/2;for(ii=0;ii<detailX;++ii){var u=ii/(detailX-1);var ur=2*Math.PI*u;var sur=Math.sin(ur);var cur=Math.cos(ur);this.vertices.push(new _main.default.Vector(sur*ringRadius,y,cur*ringRadius));var vertexNormal=void 0;if(yy<0){vertexNormal=new _main.default.Vector(0,-1,0)}else if(yy>detailY&&topRadius){vertexNormal=new _main.default.Vector(0,1,0)}else{vertexNormal=new _main.default.Vector(sur*cosSlant,sinSlant,cur*cosSlant)}this.vertexNormals.push(vertexNormal);this.uvs.push(u,v)}}var startIndex=0;if(bottomCap){for(jj=0;jj<detailX;++jj){var nextjj=(jj+1)%detailX;this.faces.push([startIndex+jj,startIndex+detailX+nextjj,startIndex+detailX+jj])}startIndex+=detailX*2}for(yy=0;yy<detailY;++yy){for(ii=0;ii<detailX;++ii){var nextii=(ii+1)%detailX;this.faces.push([startIndex+ii,startIndex+nextii,startIndex+detailX+nextii]);this.faces.push([startIndex+ii,startIndex+detailX+nextii,startIndex+detailX+ii])}startIndex+=detailX}if(topCap){startIndex+=detailX;for(ii=0;ii<detailX;++ii){this.faces.push([startIndex+ii,startIndex+(ii+1)%detailX,startIndex+detailX])}}};_main.default.prototype.cylinder=function(radius,height,detailX,detailY,bottomCap,topCap){this._assert3d("cylinder");_main.default._validateParameters("cylinder",arguments);if(typeof radius==="undefined"){radius=50}if(typeof height==="undefined"){height=radius}if(typeof detailX==="undefined"){detailX=24}if(typeof detailY==="undefined"){detailY=1}if(typeof topCap==="undefined"){topCap=true}if(typeof bottomCap==="undefined"){bottomCap=true}var gId="cylinder|".concat(detailX,"|").concat(detailY,"|").concat(bottomCap,"|").concat(topCap);if(!this._renderer.geometryInHash(gId)){var cylinderGeom=new _main.default.Geometry(detailX,detailY);_truncatedCone.call(cylinderGeom,1,1,1,detailX,detailY,bottomCap,topCap);if(detailX<=24&&detailY<=16){cylinderGeom._makeTriangleEdges()._edgesToVertices()}else if(this._renderer._doStroke){console.log("Cannot draw stroke on cylinder objects with more"+" than 24 detailX or 16 detailY")}this._renderer.createBuffers(gId,cylinderGeom)}this._renderer.drawBuffersScaled(gId,radius,height,radius);return this};_main.default.prototype.cone=function(radius,height,detailX,detailY,cap){this._assert3d("cone");_main.default._validateParameters("cone",arguments);if(typeof radius==="undefined"){radius=50}if(typeof height==="undefined"){height=radius}if(typeof detailX==="undefined"){detailX=24}if(typeof detailY==="undefined"){detailY=1}if(typeof cap==="undefined"){cap=true}var gId="cone|".concat(detailX,"|").concat(detailY,"|").concat(cap);if(!this._renderer.geometryInHash(gId)){var coneGeom=new _main.default.Geometry(detailX,detailY);_truncatedCone.call(coneGeom,1,0,1,detailX,detailY,cap,false);if(detailX<=24&&detailY<=16){coneGeom._makeTriangleEdges()._edgesToVertices()}else if(this._renderer._doStroke){console.log("Cannot draw stroke on cone objects with more"+" than 24 detailX or 16 detailY")}this._renderer.createBuffers(gId,coneGeom)}this._renderer.drawBuffersScaled(gId,radius,height,radius);return this};_main.default.prototype.ellipsoid=function(radiusX,radiusY,radiusZ,detailX,detailY){this._assert3d("ellipsoid");_main.default._validateParameters("ellipsoid",arguments);if(typeof radiusX==="undefined"){radiusX=50}if(typeof radiusY==="undefined"){radiusY=radiusX}if(typeof radiusZ==="undefined"){radiusZ=radiusX}if(typeof detailX==="undefined"){detailX=24}if(typeof detailY==="undefined"){detailY=16}var gId="ellipsoid|".concat(detailX,"|").concat(detailY);if(!this._renderer.geometryInHash(gId)){var _ellipsoid=function _ellipsoid(){for(var i=0;i<=this.detailY;i++){var v=i/this.detailY;var phi=Math.PI*v-Math.PI/2;var cosPhi=Math.cos(phi);var sinPhi=Math.sin(phi);for(var j=0;j<=this.detailX;j++){var u=j/this.detailX;var theta=2*Math.PI*u;var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);var p=new _main.default.Vector(cosPhi*sinTheta,sinPhi,cosPhi*cosTheta);this.vertices.push(p);this.vertexNormals.push(p);this.uvs.push(u,v)}}};var ellipsoidGeom=new _main.default.Geometry(detailX,detailY,_ellipsoid);ellipsoidGeom.computeFaces();if(detailX<=24&&detailY<=24){ellipsoidGeom._makeTriangleEdges()._edgesToVertices()}else if(this._renderer._doStroke){console.log("Cannot draw stroke on ellipsoids with more"+" than 24 detailX or 24 detailY")}this._renderer.createBuffers(gId,ellipsoidGeom)}this._renderer.drawBuffersScaled(gId,radiusX,radiusY,radiusZ);return this};_main.default.prototype.torus=function(radius,tubeRadius,detailX,detailY){this._assert3d("torus");_main.default._validateParameters("torus",arguments);if(typeof radius==="undefined"){radius=50}else if(!radius){return}if(typeof tubeRadius==="undefined"){tubeRadius=10}else if(!tubeRadius){return}if(typeof detailX==="undefined"){detailX=24}if(typeof detailY==="undefined"){detailY=16}var tubeRatio=(tubeRadius/radius).toPrecision(4);var gId="torus|".concat(tubeRatio,"|").concat(detailX,"|").concat(detailY);if(!this._renderer.geometryInHash(gId)){var _torus=function _torus(){for(var i=0;i<=this.detailY;i++){var v=i/this.detailY;var phi=2*Math.PI*v;var cosPhi=Math.cos(phi);var sinPhi=Math.sin(phi);var r=1+tubeRatio*cosPhi;for(var j=0;j<=this.detailX;j++){var u=j/this.detailX;var theta=2*Math.PI*u;var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);var p=new _main.default.Vector(r*cosTheta,r*sinTheta,tubeRatio*sinPhi);var n=new _main.default.Vector(cosPhi*cosTheta,cosPhi*sinTheta,sinPhi);this.vertices.push(p);this.vertexNormals.push(n);this.uvs.push(u,v)}}};var torusGeom=new _main.default.Geometry(detailX,detailY,_torus);torusGeom.computeFaces();if(detailX<=24&&detailY<=16){torusGeom._makeTriangleEdges()._edgesToVertices()}else if(this._renderer._doStroke){console.log("Cannot draw strokes on torus object with more"+" than 24 detailX or 16 detailY")}this._renderer.createBuffers(gId,torusGeom)}this._renderer.drawBuffersScaled(gId,radius,radius,radius);return this};_main.default.RendererGL.prototype.point=function(x,y,z){if(typeof z==="undefined"){z=0}var _vertex=[];_vertex.push(new _main.default.Vector(x,y,z));this._drawPoints(_vertex,this.immediateMode.buffers.point);return this};_main.default.RendererGL.prototype.triangle=function(args){var x1=args[0],y1=args[1];var x2=args[2],y2=args[3];var x3=args[4],y3=args[5];var gId="tri";if(!this.geometryInHash(gId)){var _triangle=function _triangle(){var vertices=[];vertices.push(new _main.default.Vector(0,0,0));vertices.push(new _main.default.Vector(1,0,0));vertices.push(new _main.default.Vector(0,1,0));this.edges=[[0,1],[1,2],[2,0]];this.vertices=vertices;this.faces=[[0,1,2]];this.uvs=[0,0,1,0,1,1]};var triGeom=new _main.default.Geometry(1,1,_triangle);triGeom._edgesToVertices();triGeom.computeNormals();this.createBuffers(gId,triGeom)}var uMVMatrix=this.uMVMatrix.copy();try{var orientation=Math.sign(x1*y2-x2*y1+x2*y3-x3*y2+x3*y1-x1*y3);var mult=new _main.default.Matrix([x2-x1,y2-y1,0,0,x3-x1,y3-y1,0,0,0,0,orientation,0,x1,y1,0,1]).mult(this.uMVMatrix);this.uMVMatrix=mult;this.drawBuffers(gId)}finally{this.uMVMatrix=uMVMatrix}return this};_main.default.RendererGL.prototype.ellipse=function(args){this.arc(args[0],args[1],args[2],args[3],0,constants.TWO_PI,constants.OPEN,args[4])};_main.default.RendererGL.prototype.arc=function(args){var x=arguments[0];var y=arguments[1];var width=arguments[2];var height=arguments[3];var start=arguments[4];var stop=arguments[5];var mode=arguments[6];var detail=arguments[7]||25;var shape;var gId;if(Math.abs(stop-start)>=constants.TWO_PI){shape="ellipse";gId="".concat(shape,"|").concat(detail,"|")}else{shape="arc";gId="".concat(shape,"|").concat(start,"|").concat(stop,"|").concat(mode,"|").concat(detail,"|")}if(!this.geometryInHash(gId)){var _arc=function _arc(){if(start.toFixed(10)!==stop.toFixed(10)){if(mode===constants.PIE||typeof mode==="undefined"){this.vertices.push(new _main.default.Vector(.5,.5,0));this.uvs.push([.5,.5])}for(var i=0;i<=detail;i++){var u=i/detail;var theta=(stop-start)*u+start;var _x=.5+Math.cos(theta)/2;var _y=.5+Math.sin(theta)/2;this.vertices.push(new _main.default.Vector(_x,_y,0));this.uvs.push([_x,_y]);if(i<detail-1){this.faces.push([0,i+1,i+2]);this.edges.push([i+1,i+2])}}switch(mode){case constants.PIE:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]);this.edges.push([0,1]);this.edges.push([this.vertices.length-2,this.vertices.length-1]);this.edges.push([0,this.vertices.length-1]);break;case constants.CHORD:this.edges.push([0,1]);this.edges.push([0,this.vertices.length-1]);break;case constants.OPEN:this.edges.push([0,1]);break;default:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]);this.edges.push([this.vertices.length-2,this.vertices.length-1])}}};var arcGeom=new _main.default.Geometry(detail,1,_arc);arcGeom.computeNormals();if(detail<=50){arcGeom._edgesToVertices(arcGeom)}else if(this._doStroke){console.log("Cannot apply a stroke to an ".concat(shape," with more than 50 detail"))}this.createBuffers(gId,arcGeom)}var uMVMatrix=this.uMVMatrix.copy();try{this.uMVMatrix.translate([x,y,0]);this.uMVMatrix.scale(width,height,1);this.drawBuffers(gId)}finally{this.uMVMatrix=uMVMatrix}return this};_main.default.RendererGL.prototype.rect=function(args){var x=args[0];var y=args[1];var width=args[2];var height=args[3];if(typeof args[4]==="undefined"){var perPixelLighting=this._pInst._glAttributes.perPixelLighting;var detailX=args[4]||(perPixelLighting?1:24);var detailY=args[5]||(perPixelLighting?1:16);var gId="rect|".concat(detailX,"|").concat(detailY);if(!this.geometryInHash(gId)){var _rect=function _rect(){for(var i=0;i<=this.detailY;i++){var v=i/this.detailY;for(var j=0;j<=this.detailX;j++){var u=j/this.detailX;var p=new _main.default.Vector(u,v,0);this.vertices.push(p);this.uvs.push(u,v)}}if(detailX>0&&detailY>0){this.edges=[[0,detailX],[detailX,(detailX+1)*(detailY+1)-1],[(detailX+1)*(detailY+1)-1,(detailX+1)*detailY],[(detailX+1)*detailY,0]]}};var rectGeom=new _main.default.Geometry(detailX,detailY,_rect);rectGeom.computeFaces().computeNormals()._edgesToVertices();this.createBuffers(gId,rectGeom)}var uMVMatrix=this.uMVMatrix.copy();try{this.uMVMatrix.translate([x,y,0]);this.uMVMatrix.scale(width,height,1);this.drawBuffers(gId)}finally{this.uMVMatrix=uMVMatrix}}else{var tl=args[4];var tr=typeof args[5]==="undefined"?tl:args[5];var br=typeof args[6]==="undefined"?tr:args[6];var bl=typeof args[7]==="undefined"?br:args[7];var a=x;var b=y;var c=width;var d=height;c+=a;d+=b;if(a>c){var temp=a;a=c;c=temp}if(b>d){var _temp=b;b=d;d=_temp}var maxRounding=Math.min((c-a)/2,(d-b)/2);if(tl>maxRounding)tl=maxRounding;if(tr>maxRounding)tr=maxRounding;if(br>maxRounding)br=maxRounding;if(bl>maxRounding)bl=maxRounding;var x1=a;var y1=b;var x2=c;var y2=d;this.beginShape();if(tr!==0){this.vertex(x2-tr,y1);this.quadraticVertex(x2,y1,x2,y1+tr)}else{this.vertex(x2,y1)}if(br!==0){this.vertex(x2,y2-br);this.quadraticVertex(x2,y2,x2-br,y2)}else{this.vertex(x2,y2)}if(bl!==0){this.vertex(x1+bl,y2);this.quadraticVertex(x1,y2,x1,y2-bl)}else{this.vertex(x1,y2)}if(tl!==0){this.vertex(x1,y1+tl);this.quadraticVertex(x1,y1,x1+tl,y1)}else{this.vertex(x1,y1)}this.immediateMode.geometry.uvs.length=0;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.immediateMode.geometry.vertices[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var vert=_step.value;var u=(vert.x-x1)/width;var v=(vert.y-y1)/height;this.immediateMode.geometry.uvs.push(u,v)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}this.endShape(constants.CLOSE)}return this};_main.default.RendererGL.prototype.quad=function(x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4,detailX,detailY){if(typeof detailX==="undefined"){detailX=2}if(typeof detailY==="undefined"){detailY=2}var gId="quad|".concat(x1,"|").concat(y1,"|").concat(z1,"|").concat(x2,"|").concat(y2,"|").concat(z2,"|").concat(x3,"|").concat(y3,"|").concat(z3,"|").concat(x4,"|").concat(y4,"|").concat(z4,"|").concat(detailX,"|").concat(detailY);if(!this.geometryInHash(gId)){var quadGeom=new _main.default.Geometry(detailX,detailY,function(){var xRes=1/(this.detailX-1);var yRes=1/(this.detailY-1);for(var y=0;y<this.detailY;y++){for(var x=0;x<this.detailX;x++){var pctx=x*xRes;var pcty=y*yRes;var linePt0x=(1-pcty)*x1+pcty*x4;var linePt0y=(1-pcty)*y1+pcty*y4;var linePt0z=(1-pcty)*z1+pcty*z4;var linePt1x=(1-pcty)*x2+pcty*x3;var linePt1y=(1-pcty)*y2+pcty*y3;var linePt1z=(1-pcty)*z2+pcty*z3;var ptx=(1-pctx)*linePt0x+pctx*linePt1x;var pty=(1-pctx)*linePt0y+pctx*linePt1y;var ptz=(1-pctx)*linePt0z+pctx*linePt1z;this.vertices.push(new _main.default.Vector(ptx,pty,ptz));this.uvs.push([pctx,pcty])}}});quadGeom.faces=[];for(var y=0;y<detailY-1;y++){for(var x=0;x<detailX-1;x++){var pt0=x+y*detailX;var pt1=x+1+y*detailX;var pt2=x+1+(y+1)*detailX;var pt3=x+(y+1)*detailX;quadGeom.faces.push([pt0,pt1,pt2]);quadGeom.faces.push([pt0,pt2,pt3])}}quadGeom.computeNormals();quadGeom.edges.length=0;var vertexOrder=[0,2,3,1];for(var i=0;i<vertexOrder.length;i++){var startVertex=vertexOrder[i];var endVertex=vertexOrder[(i+1)%vertexOrder.length];quadGeom.edges.push([startVertex,endVertex])}quadGeom._edgesToVertices();this.createBuffers(gId,quadGeom)}this.drawBuffers(gId);return this};_main.default.RendererGL.prototype.bezier=function(x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4){if(arguments.length===8){y4=y3;x4=x3;y3=z2;x3=y2;y2=x2;x2=z1;z1=z2=z3=z4=0}var bezierDetail=this._pInst._bezierDetail||20;this.beginShape();for(var i=0;i<=bezierDetail;i++){var c1=Math.pow(1-i/bezierDetail,3);var c2=3*(i/bezierDetail)*Math.pow(1-i/bezierDetail,2);var c3=3*Math.pow(i/bezierDetail,2)*(1-i/bezierDetail);var c4=Math.pow(i/bezierDetail,3);this.vertex(x1*c1+x2*c2+x3*c3+x4*c4,y1*c1+y2*c2+y3*c3+y4*c4,z1*c1+z2*c2+z3*c3+z4*c4)}this.endShape();return this};_main.default.RendererGL.prototype.curve=function(x1,y1,z1,x2,y2,z2,x3,y3,z3,x4,y4,z4){if(arguments.length===8){x4=x3;y4=y3;x3=y2;y3=x2;x2=z1;y2=x2;z1=z2=z3=z4=0}var curveDetail=this._pInst._curveDetail;this.beginShape();for(var i=0;i<=curveDetail;i++){var c1=Math.pow(i/curveDetail,3)*.5;var c2=Math.pow(i/curveDetail,2)*.5;var c3=i/curveDetail*.5;var c4=.5;var vx=c1*(-x1+3*x2-3*x3+x4)+c2*(2*x1-5*x2+4*x3-x4)+c3*(-x1+x3)+c4*(2*x2);var vy=c1*(-y1+3*y2-3*y3+y4)+c2*(2*y1-5*y2+4*y3-y4)+c3*(-y1+y3)+c4*(2*y2);var vz=c1*(-z1+3*z2-3*z3+z4)+c2*(2*z1-5*z2+4*z3-z4)+c3*(-z1+z3)+c4*(2*z2);this.vertex(vx,vy,vz)}this.endShape();return this};_main.default.RendererGL.prototype.line=function(){if(arguments.length===6){this.beginShape(constants.LINES);this.vertex(arguments.length<=0?undefined:arguments[0],arguments.length<=1?undefined:arguments[1],arguments.length<=2?undefined:arguments[2]);this.vertex(arguments.length<=3?undefined:arguments[3],arguments.length<=4?undefined:arguments[4],arguments.length<=5?undefined:arguments[5]);this.endShape()}else if(arguments.length===4){this.beginShape(constants.LINES);this.vertex(arguments.length<=0?undefined:arguments[0],arguments.length<=1?undefined:arguments[1],0);this.vertex(arguments.length<=2?undefined:arguments[2],arguments.length<=3?undefined:arguments[3],0);this.endShape()}return this};_main.default.RendererGL.prototype.bezierVertex=function(){if(this.immediateMode._bezierVertex.length===0){throw Error("vertex() must be used once before calling bezierVertex()")}else{var w_x=[];var w_y=[];var w_z=[];var t,_x,_y,_z,i,k,m;var argLength=arguments.length;t=0;if(this._lookUpTableBezier.length===0||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[];this._lutBezierDetail=this._pInst._curveDetail;var step=1/this._lutBezierDetail;var start=0;var end=1;var j=0;while(start<1){t=parseFloat(start.toFixed(6));this._lookUpTableBezier[j]=this._bezierCoefficients(t);if(end.toFixed(6)===step.toFixed(6)){t=parseFloat(end.toFixed(6))+parseFloat(start.toFixed(6));++j;this._lookUpTableBezier[j]=this._bezierCoefficients(t);break}start+=step;end-=step;++j}}var LUTLength=this._lookUpTableBezier.length;var fillColors=[];for(m=0;m<4;m++){fillColors.push([])}fillColors[0]=this.immediateMode.geometry.vertexColors.slice(-4);fillColors[3]=this.curFillColor.slice();var strokeColors=[];for(m=0;m<4;m++){strokeColors.push([])}strokeColors[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4);strokeColors[3]=this.curStrokeColor.slice();if(argLength===6){this.isBezier=true;w_x=[this.immediateMode._bezierVertex[0],arguments.length<=0?undefined:arguments[0],arguments.length<=2?undefined:arguments[2],arguments.length<=4?undefined:arguments[4]];w_y=[this.immediateMode._bezierVertex[1],arguments.length<=1?undefined:arguments[1],arguments.length<=3?undefined:arguments[3],arguments.length<=5?undefined:arguments[5]];var d0=Math.hypot(w_x[0]-w_x[1],w_y[0]-w_y[1]);var d1=Math.hypot(w_x[1]-w_x[2],w_y[1]-w_y[2]);var d2=Math.hypot(w_x[2]-w_x[3],w_y[2]-w_y[3]);var totalLength=d0+d1+d2;d0/=totalLength;d2/=totalLength;for(k=0;k<4;k++){fillColors[1].push(fillColors[0][k]*(1-d0)+fillColors[3][k]*d0);fillColors[2].push(fillColors[0][k]*d2+fillColors[3][k]*(1-d2));strokeColors[1].push(strokeColors[0][k]*(1-d0)+strokeColors[3][k]*d0);strokeColors[2].push(strokeColors[0][k]*d2+strokeColors[3][k]*(1-d2))}for(i=0;i<LUTLength;i++){this.curFillColor=[0,0,0,0];this.curStrokeColor=[0,0,0,0];_x=_y=0;for(m=0;m<4;m++){for(k=0;k<4;k++){this.curFillColor[k]+=this._lookUpTableBezier[i][m]*fillColors[m][k];this.curStrokeColor[k]+=this._lookUpTableBezier[i][m]*strokeColors[m][k]}_x+=w_x[m]*this._lookUpTableBezier[i][m];_y+=w_y[m]*this._lookUpTableBezier[i][m]}this.vertex(_x,_y)}this.curFillColor=fillColors[3];this.curStrokeColor=strokeColors[3];this.immediateMode._bezierVertex[0]=arguments.length<=4?undefined:arguments[4];this.immediateMode._bezierVertex[1]=arguments.length<=5?undefined:arguments[5]}else if(argLength===9){this.isBezier=true;w_x=[this.immediateMode._bezierVertex[0],arguments.length<=0?undefined:arguments[0],arguments.length<=3?undefined:arguments[3],arguments.length<=6?undefined:arguments[6]];w_y=[this.immediateMode._bezierVertex[1],arguments.length<=1?undefined:arguments[1],arguments.length<=4?undefined:arguments[4],arguments.length<=7?undefined:arguments[7]];w_z=[this.immediateMode._bezierVertex[2],arguments.length<=2?undefined:arguments[2],arguments.length<=5?undefined:arguments[5],arguments.length<=8?undefined:arguments[8]];var _d=Math.hypot(w_x[0]-w_x[1],w_y[0]-w_y[1],w_z[0]-w_z[1]);var _d2=Math.hypot(w_x[1]-w_x[2],w_y[1]-w_y[2],w_z[1]-w_z[2]);var _d3=Math.hypot(w_x[2]-w_x[3],w_y[2]-w_y[3],w_z[2]-w_z[3]);var _totalLength=_d+_d2+_d3;_d/=_totalLength;_d3/=_totalLength;for(k=0;k<4;k++){fillColors[1].push(fillColors[0][k]*(1-_d)+fillColors[3][k]*_d);fillColors[2].push(fillColors[0][k]*_d3+fillColors[3][k]*(1-_d3));strokeColors[1].push(strokeColors[0][k]*(1-_d)+strokeColors[3][k]*_d);strokeColors[2].push(strokeColors[0][k]*_d3+strokeColors[3][k]*(1-_d3))}for(i=0;i<LUTLength;i++){this.curFillColor=[0,0,0,0];this.curStrokeColor=[0,0,0,0];_x=_y=_z=0;for(m=0;m<4;m++){for(k=0;k<4;k++){this.curFillColor[k]+=this._lookUpTableBezier[i][m]*fillColors[m][k];this.curStrokeColor[k]+=this._lookUpTableBezier[i][m]*strokeColors[m][k]}_x+=w_x[m]*this._lookUpTableBezier[i][m];_y+=w_y[m]*this._lookUpTableBezier[i][m];_z+=w_z[m]*this._lookUpTableBezier[i][m]}this.vertex(_x,_y,_z)}this.curFillColor=fillColors[3];this.curStrokeColor=strokeColors[3];this.immediateMode._bezierVertex[0]=arguments.length<=6?undefined:arguments[6];this.immediateMode._bezierVertex[1]=arguments.length<=7?undefined:arguments[7];this.immediateMode._bezierVertex[2]=arguments.length<=8?undefined:arguments[8]}}};_main.default.RendererGL.prototype.quadraticVertex=function(){if(this.immediateMode._quadraticVertex.length===0){throw Error("vertex() must be used once before calling quadraticVertex()")}else{var w_x=[];var w_y=[];var w_z=[];var t,_x,_y,_z,i,k,m;var argLength=arguments.length;t=0;if(this._lookUpTableQuadratic.length===0||this._lutQuadraticDetail!==this._pInst._curveDetail){this._lookUpTableQuadratic=[];this._lutQuadraticDetail=this._pInst._curveDetail;var step=1/this._lutQuadraticDetail;var start=0;var end=1;var j=0;while(start<1){t=parseFloat(start.toFixed(6));this._lookUpTableQuadratic[j]=this._quadraticCoefficients(t);if(end.toFixed(6)===step.toFixed(6)){t=parseFloat(end.toFixed(6))+parseFloat(start.toFixed(6));++j;this._lookUpTableQuadratic[j]=this._quadraticCoefficients(t);break}start+=step;end-=step;++j}}var LUTLength=this._lookUpTableQuadratic.length;var fillColors=[];for(m=0;m<3;m++){fillColors.push([])}fillColors[0]=this.immediateMode.geometry.vertexColors.slice(-4);fillColors[2]=this.curFillColor.slice();var strokeColors=[];for(m=0;m<3;m++){strokeColors.push([])}strokeColors[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4);strokeColors[2]=this.curStrokeColor.slice();if(argLength===4){this.isQuadratic=true;w_x=[this.immediateMode._quadraticVertex[0],arguments.length<=0?undefined:arguments[0],arguments.length<=2?undefined:arguments[2]];w_y=[this.immediateMode._quadraticVertex[1],arguments.length<=1?undefined:arguments[1],arguments.length<=3?undefined:arguments[3]];var d0=Math.hypot(w_x[0]-w_x[1],w_y[0]-w_y[1]);var d1=Math.hypot(w_x[1]-w_x[2],w_y[1]-w_y[2]);var totalLength=d0+d1;d0/=totalLength;for(k=0;k<4;k++){fillColors[1].push(fillColors[0][k]*(1-d0)+fillColors[2][k]*d0);strokeColors[1].push(strokeColors[0][k]*(1-d0)+strokeColors[2][k]*d0)}for(i=0;i<LUTLength;i++){this.curFillColor=[0,0,0,0];this.curStrokeColor=[0,0,0,0];_x=_y=0;for(m=0;m<3;m++){for(k=0;k<4;k++){this.curFillColor[k]+=this._lookUpTableQuadratic[i][m]*fillColors[m][k];this.curStrokeColor[k]+=this._lookUpTableQuadratic[i][m]*strokeColors[m][k]}_x+=w_x[m]*this._lookUpTableQuadratic[i][m];_y+=w_y[m]*this._lookUpTableQuadratic[i][m]}this.vertex(_x,_y)}this.curFillColor=fillColors[2];this.curStrokeColor=strokeColors[2];this.immediateMode._quadraticVertex[0]=arguments.length<=2?undefined:arguments[2];this.immediateMode._quadraticVertex[1]=arguments.length<=3?undefined:arguments[3]}else if(argLength===6){this.isQuadratic=true;w_x=[this.immediateMode._quadraticVertex[0],arguments.length<=0?undefined:arguments[0],arguments.length<=3?undefined:arguments[3]];w_y=[this.immediateMode._quadraticVertex[1],arguments.length<=1?undefined:arguments[1],arguments.length<=4?undefined:arguments[4]];w_z=[this.immediateMode._quadraticVertex[2],arguments.length<=2?undefined:arguments[2],arguments.length<=5?undefined:arguments[5]];var _d4=Math.hypot(w_x[0]-w_x[1],w_y[0]-w_y[1],w_z[0]-w_z[1]);var _d5=Math.hypot(w_x[1]-w_x[2],w_y[1]-w_y[2],w_z[1]-w_z[2]);var _totalLength2=_d4+_d5;_d4/=_totalLength2;for(k=0;k<4;k++){fillColors[1].push(fillColors[0][k]*(1-_d4)+fillColors[2][k]*_d4);strokeColors[1].push(strokeColors[0][k]*(1-_d4)+strokeColors[2][k]*_d4)}for(i=0;i<LUTLength;i++){this.curFillColor=[0,0,0,0];this.curStrokeColor=[0,0,0,0];_x=_y=_z=0;for(m=0;m<3;m++){for(k=0;k<4;k++){this.curFillColor[k]+=this._lookUpTableQuadratic[i][m]*fillColors[m][k];this.curStrokeColor[k]+=this._lookUpTableQuadratic[i][m]*strokeColors[m][k]}_x+=w_x[m]*this._lookUpTableQuadratic[i][m];_y+=w_y[m]*this._lookUpTableQuadratic[i][m];_z+=w_z[m]*this._lookUpTableQuadratic[i][m]}this.vertex(_x,_y,_z)}this.curFillColor=fillColors[2];this.curStrokeColor=strokeColors[2];this.immediateMode._quadraticVertex[0]=arguments.length<=3?undefined:arguments[3];this.immediateMode._quadraticVertex[1]=arguments.length<=4?undefined:arguments[4];this.immediateMode._quadraticVertex[2]=arguments.length<=5?undefined:arguments[5]}}};_main.default.RendererGL.prototype.curveVertex=function(){var w_x=[];var w_y=[];var w_z=[];var t,_x,_y,_z,i;t=0;var argLength=arguments.length;if(this._lookUpTableBezier.length===0||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[];this._lutBezierDetail=this._pInst._curveDetail;var step=1/this._lutBezierDetail;var start=0;var end=1;var j=0;while(start<1){t=parseFloat(start.toFixed(6));this._lookUpTableBezier[j]=this._bezierCoefficients(t);if(end.toFixed(6)===step.toFixed(6)){t=parseFloat(end.toFixed(6))+parseFloat(start.toFixed(6));++j;this._lookUpTableBezier[j]=this._bezierCoefficients(t);break}start+=step;end-=step;++j}}var LUTLength=this._lookUpTableBezier.length;if(argLength===2){this.immediateMode._curveVertex.push(arguments.length<=0?undefined:arguments[0]);this.immediateMode._curveVertex.push(arguments.length<=1?undefined:arguments[1]);if(this.immediateMode._curveVertex.length===8){this.isCurve=true;w_x=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[6]]);w_y=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[7]]);for(i=0;i<LUTLength;i++){_x=w_x[0]*this._lookUpTableBezier[i][0]+w_x[1]*this._lookUpTableBezier[i][1]+w_x[2]*this._lookUpTableBezier[i][2]+w_x[3]*this._lookUpTableBezier[i][3];_y=w_y[0]*this._lookUpTableBezier[i][0]+w_y[1]*this._lookUpTableBezier[i][1]+w_y[2]*this._lookUpTableBezier[i][2]+w_y[3]*this._lookUpTableBezier[i][3];this.vertex(_x,_y)}for(i=0;i<argLength;i++){this.immediateMode._curveVertex.shift()}}}else if(argLength===3){this.immediateMode._curveVertex.push(arguments.length<=0?undefined:arguments[0]);this.immediateMode._curveVertex.push(arguments.length<=1?undefined:arguments[1]);this.immediateMode._curveVertex.push(arguments.length<=2?undefined:arguments[2]);if(this.immediateMode._curveVertex.length===12){this.isCurve=true;w_x=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[6],this.immediateMode._curveVertex[9]]);w_y=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[7],this.immediateMode._curveVertex[10]]);w_z=this._bezierToCatmull([this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[8],this.immediateMode._curveVertex[11]]);for(i=0;i<LUTLength;i++){_x=w_x[0]*this._lookUpTableBezier[i][0]+w_x[1]*this._lookUpTableBezier[i][1]+w_x[2]*this._lookUpTableBezier[i][2]+w_x[3]*this._lookUpTableBezier[i][3];_y=w_y[0]*this._lookUpTableBezier[i][0]+w_y[1]*this._lookUpTableBezier[i][1]+w_y[2]*this._lookUpTableBezier[i][2]+w_y[3]*this._lookUpTableBezier[i][3];_z=w_z[0]*this._lookUpTableBezier[i][0]+w_z[1]*this._lookUpTableBezier[i][1]+w_z[2]*this._lookUpTableBezier[i][2]+w_z[3]*this._lookUpTableBezier[i][3];this.vertex(_x,_y,_z)}for(i=0;i<argLength;i++){this.immediateMode._curveVertex.shift()}}}};_main.default.RendererGL.prototype.image=function(img,sx,sy,sWidth,sHeight,dx,dy,dWidth,dHeight){if(this._isErasing){this.blendMode(this._cachedBlendMode)}this._pInst.push();this._pInst.noLights();this._pInst.noStroke();this._pInst.texture(img);this._pInst.textureMode(constants.NORMAL);var u0=0;if(sx<=img.width){u0=sx/img.width}var u1=1;if(sx+sWidth<=img.width){u1=(sx+sWidth)/img.width}var v0=0;if(sy<=img.height){v0=sy/img.height}var v1=1;if(sy+sHeight<=img.height){v1=(sy+sHeight)/img.height}this.beginShape();this.vertex(dx,dy,0,u0,v0);this.vertex(dx+dWidth,dy,0,u1,v0);this.vertex(dx+dWidth,dy+dHeight,0,u1,v1);this.vertex(dx,dy+dHeight,0,u0,v1);this.endShape(constants.CLOSE);this._pInst.pop();if(this._isErasing){this.blendMode(constants.REMOVE)}};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/main":298,"./p5.Geometry":350,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.math.hypot":188,"core-js/modules/es.math.sign":190,"core-js/modules/es.number.to-fixed":193,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],342:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.every");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.every");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.object.assign");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var GeometryBuilder=function(){function GeometryBuilder(renderer){_classCallCheck(this,GeometryBuilder);this.renderer=renderer;renderer._pInst.push();this.identityMatrix=new _main.default.Matrix;renderer.uMVMatrix=new _main.default.Matrix;this.geometry=new _main.default.Geometry;this.geometry.gid="_p5_GeometryBuilder_".concat(GeometryBuilder.nextGeometryId);GeometryBuilder.nextGeometryId++;this.hasTransform=false}_createClass(GeometryBuilder,[{key:"transformVertices",value:function transformVertices(vertices){var _this=this;if(!this.hasTransform)return vertices;return vertices.map(function(v){return _this.renderer.uMVMatrix.multiplyPoint(v)})}},{key:"transformNormals",value:function transformNormals(normals){var _this2=this;if(!this.hasTransform)return normals;return normals.map(function(v){return _this2.renderer.uNMatrix.multiplyVec3(v)})}},{key:"addGeometry",value:function addGeometry(input){var _this3=this,_this$geometry$vertic,_this$geometry$vertex,_this$geometry$uvs,_this$geometry$vertex2;this.hasTransform=!this.renderer.uMVMatrix.mat4.every(function(v,i){return v===_this3.identityMatrix.mat4[i]});if(this.hasTransform){this.renderer.uNMatrix.inverseTranspose(this.renderer.uMVMatrix)}var startIdx=this.geometry.vertices.length;(_this$geometry$vertic=this.geometry.vertices).push.apply(_this$geometry$vertic,_toConsumableArray(this.transformVertices(input.vertices)));(_this$geometry$vertex=this.geometry.vertexNormals).push.apply(_this$geometry$vertex,_toConsumableArray(this.transformNormals(input.vertexNormals)));(_this$geometry$uvs=this.geometry.uvs).push.apply(_this$geometry$uvs,_toConsumableArray(input.uvs));if(this.renderer._doFill){var _this$geometry$faces;(_this$geometry$faces=this.geometry.faces).push.apply(_this$geometry$faces,_toConsumableArray(input.faces.map(function(f){return f.map(function(idx){return idx+startIdx})})))}if(this.renderer._doStroke){var _this$geometry$edges;(_this$geometry$edges=this.geometry.edges).push.apply(_this$geometry$edges,_toConsumableArray(input.edges.map(function(edge){return edge.map(function(idx){return idx+startIdx})})))}var vertexColors=_toConsumableArray(input.vertexColors);while(vertexColors.length<input.vertices.length*4){vertexColors.push.apply(vertexColors,_toConsumableArray(this.renderer.curFillColor))}(_this$geometry$vertex2=this.geometry.vertexColors).push.apply(_this$geometry$vertex2,_toConsumableArray(vertexColors))}},{key:"addImmediate",value:function addImmediate(){var geometry=this.renderer.immediateMode.geometry;var shapeMode=this.renderer.immediateMode.shapeMode;var faces=[];if(this.renderer._doFill){if(shapeMode===constants.TRIANGLE_STRIP||shapeMode===constants.QUAD_STRIP){for(var i=2;i<geometry.vertices.length;i++){if(i%2===0){faces.push([i,i-1,i-2])}else{faces.push([i,i-2,i-1])}}}else if(shapeMode===constants.TRIANGLE_FAN){for(var _i=2;_i<geometry.vertices.length;_i++){faces.push([0,_i-1,_i])}}else{for(var _i2=0;_i2<geometry.vertices.length;_i2+=3){faces.push([_i2,_i2+1,_i2+2])}}}this.addGeometry(Object.assign({},geometry,{faces:faces}))}},{key:"addRetained",value:function addRetained(geometry){this.addGeometry(geometry.model)}},{key:"finish",value:function finish(){this.renderer._pInst.pop();return this.geometry}}]);return GeometryBuilder}();GeometryBuilder.nextGeometryId=0;var _default=GeometryBuilder;exports.default=_default},{"../core/constants":286,"../core/main":298,"core-js/modules/es.array.every":171,"core-js/modules/es.array.from":176,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.map":182,"core-js/modules/es.object.assign":194,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],343:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.math.hypot");_dereq_("core-js/modules/es.math.sign");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.math.hypot");_dereq_("core-js/modules/es.math.sign");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_main.default.prototype.orbitControl=function(sensitivityX,sensitivityY,sensitivityZ,options){var _this=this;this._assert3d("orbitControl");_main.default._validateParameters("orbitControl",arguments);var cam=this._renderer._curCamera;if(typeof sensitivityX==="undefined"){sensitivityX=1}if(typeof sensitivityY==="undefined"){sensitivityY=sensitivityX}if(typeof sensitivityZ==="undefined"){sensitivityZ=1}if(_typeof(options)!=="object"){options={}}if(this.contextMenuDisabled!==true){this.canvas.oncontextmenu=function(){return false};this._setProperty("contextMenuDisabled",true)}if(this.wheelDefaultDisabled!==true){this.canvas.onwheel=function(){return false};this._setProperty("wheelDefaultDisabled",true)}var _options=options,_options$disableTouch=_options.disableTouchActions,disableTouchActions=_options$disableTouch===void 0?true:_options$disableTouch;if(this.touchActionsDisabled!==true&&disableTouchActions){this.canvas.style["touch-action"]="none";this._setProperty("touchActionsDisabled",true)}var _options2=options,_options2$freeRotatio=_options2.freeRotation,freeRotation=_options2$freeRotatio===void 0?false:_options2$freeRotatio;var movedTouches=[];this.touches.forEach(function(curTouch){_this._renderer.prevTouches.forEach(function(prevTouch){if(curTouch.id===prevTouch.id){var movedTouch={x:curTouch.x,y:curTouch.y,px:prevTouch.x,py:prevTouch.y};movedTouches.push(movedTouch)}})});this._renderer.prevTouches=this.touches;var deltaRadius=0;var deltaTheta=0;var deltaPhi=0;var moveDeltaX=0;var moveDeltaY=0;var damping=.85;var rotateAccelerationFactor=.6;var moveAccelerationFactor=.15;var mouseZoomScaleFactor=.01;var touchZoomScaleFactor=4e-4;var scaleFactor=this.height<this.width?this.height:this.width;var pointersInCanvas=false;if(movedTouches.length>0){pointersInCanvas=movedTouches[0].x>0&&movedTouches[0].x<this.width&&movedTouches[0].y>0&&movedTouches[0].y<this.height;if(movedTouches.length===1){var t=movedTouches[0];deltaTheta=-sensitivityX*(t.x-t.px)/scaleFactor;deltaPhi=sensitivityY*(t.y-t.py)/scaleFactor}else{var t0=movedTouches[0];var t1=movedTouches[1];var distWithTouches=Math.hypot(t0.x-t1.x,t0.y-t1.y);var prevDistWithTouches=Math.hypot(t0.px-t1.px,t0.py-t1.py);var changeDist=distWithTouches-prevDistWithTouches;deltaRadius=-changeDist*sensitivityZ*touchZoomScaleFactor;moveDeltaX=.5*(t0.x+t1.x)-.5*(t0.px+t1.px);moveDeltaY=.5*(t0.y+t1.y)-.5*(t0.py+t1.py)}if(this.touches.length>0){if(pointersInCanvas){this._renderer.executeRotateAndMove=true;this._renderer.executeZoom=true}}else{this._renderer.executeRotateAndMove=false;this._renderer.executeZoom=false}}else{pointersInCanvas=this.mouseX>0&&this.mouseX<this.width&&this.mouseY>0&&this.mouseY<this.height;if(this._mouseWheelDeltaY!==0){deltaRadius=Math.sign(this._mouseWheelDeltaY)*sensitivityZ;deltaRadius*=mouseZoomScaleFactor;this._mouseWheelDeltaY=0;if(pointersInCanvas)this._renderer.executeZoom=true}else{this._renderer.zoomFlag=false}if(this.mouseIsPressed){if(this.mouseButton===this.LEFT){deltaTheta=-sensitivityX*this.movedX/scaleFactor;deltaPhi=sensitivityY*this.movedY/scaleFactor}else if(this.mouseButton===this.RIGHT){moveDeltaX=this.movedX;moveDeltaY=this.movedY*cam.yScale}if(pointersInCanvas)this._renderer.executeRotateAndMove=true}else{this._renderer.executeRotateAndMove=false}}if(deltaRadius!==0&&this._renderer.executeZoom){this._renderer.zoomVelocity+=deltaRadius}if(Math.abs(this._renderer.zoomVelocity)>.001){if(freeRotation){cam._orbitFree(0,0,this._renderer.zoomVelocity)}else{cam._orbit(0,0,this._renderer.zoomVelocity)}if(cam.projMatrix.mat4[15]!==0){cam.projMatrix.mat4[0]*=Math.pow(10,-this._renderer.zoomVelocity);cam.projMatrix.mat4[5]*=Math.pow(10,-this._renderer.zoomVelocity);this._renderer.uPMatrix.mat4[0]=cam.projMatrix.mat4[0];this._renderer.uPMatrix.mat4[5]=cam.projMatrix.mat4[5]}this._renderer.zoomVelocity*=damping}else{this._renderer.zoomVelocity=0}if((deltaTheta!==0||deltaPhi!==0)&&this._renderer.executeRotateAndMove){this._renderer.rotateVelocity.add(deltaTheta*rotateAccelerationFactor,deltaPhi*rotateAccelerationFactor)}if(this._renderer.rotateVelocity.magSq()>1e-6){if(freeRotation){cam._orbitFree(-this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0)}else{cam._orbit(this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0)}this._renderer.rotateVelocity.mult(damping)}else{this._renderer.rotateVelocity.set(0,0)}if((moveDeltaX!==0||moveDeltaY!==0)&&this._renderer.executeRotateAndMove){var ndcX=moveDeltaX*2/this.width;var ndcY=-moveDeltaY*2/this.height;this._renderer.moveVelocity.add(ndcX*moveAccelerationFactor,ndcY*moveAccelerationFactor)}if(this._renderer.moveVelocity.magSq()>1e-6){var local=cam._getLocalAxes();var diffX=cam.eyeX-cam.centerX;var diffY=cam.eyeY-cam.centerY;var diffZ=cam.eyeZ-cam.centerZ;var viewZ=Math.sqrt(diffX*diffX+diffY*diffY+diffZ*diffZ);var cv=new _main.default.Vector(cam.centerX,cam.centerY,cam.centerZ);cv=cam.cameraMatrix.multiplyPoint(cv);cv=this._renderer.uPMatrix.multiplyAndNormalizePoint(cv);cv.x-=this._renderer.moveVelocity.x;cv.y-=this._renderer.moveVelocity.y;var dx,dy;var uP=this._renderer.uPMatrix.mat4;if(uP[15]===0){dx=(uP[8]+cv.x)/uP[0]*viewZ;dy=(uP[9]+cv.y)/uP[5]*viewZ}else{dx=(cv.x-uP[12])/uP[0];dy=(cv.y-uP[13])/uP[5]}cam.setPosition(cam.eyeX+dx*local.x[0]+dy*local.y[0],cam.eyeY+dx*local.x[1]+dy*local.y[1],cam.eyeZ+dx*local.x[2]+dy*local.y[2]);this._renderer.moveVelocity.mult(damping)}else{this._renderer.moveVelocity.set(0,0)}return this};_main.default.prototype.debugMode=function(){this._assert3d("debugMode");for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("debugMode",args);for(var i=this._registeredMethods.post.length-1;i>=0;i--){if(this._registeredMethods.post[i].toString()===this._grid().toString()||this._registeredMethods.post[i].toString()===this._axesIcon().toString()){this._registeredMethods.post.splice(i,1)}}if(args[0]===constants.GRID){this.registerMethod("post",this._grid.call(this,args[1],args[2],args[3],args[4],args[5]))}else if(args[0]===constants.AXES){this.registerMethod("post",this._axesIcon.call(this,args[1],args[2],args[3],args[4]))}else{this.registerMethod("post",this._grid.call(this,args[0],args[1],args[2],args[3],args[4]));this.registerMethod("post",this._axesIcon.call(this,args[5],args[6],args[7],args[8]))}};_main.default.prototype.noDebugMode=function(){this._assert3d("noDebugMode");for(var i=this._registeredMethods.post.length-1;i>=0;i--){if(this._registeredMethods.post[i].toString()===this._grid().toString()||this._registeredMethods.post[i].toString()===this._axesIcon().toString()){this._registeredMethods.post.splice(i,1)}}};_main.default.prototype._grid=function(size,numDivs,xOff,yOff,zOff){if(typeof size==="undefined"){size=this.width/2}if(typeof numDivs==="undefined"){numDivs=Math.round(size/30)<4?4:Math.round(size/30)}if(typeof xOff==="undefined"){xOff=0}if(typeof yOff==="undefined"){yOff=0}if(typeof zOff==="undefined"){zOff=0}var spacing=size/numDivs;var halfSize=size/2;return function(){this.push();this.stroke(this._renderer.curStrokeColor[0]*255,this._renderer.curStrokeColor[1]*255,this._renderer.curStrokeColor[2]*255);this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix.mat4[0],this._renderer._curCamera.cameraMatrix.mat4[1],this._renderer._curCamera.cameraMatrix.mat4[2],this._renderer._curCamera.cameraMatrix.mat4[3],this._renderer._curCamera.cameraMatrix.mat4[4],this._renderer._curCamera.cameraMatrix.mat4[5],this._renderer._curCamera.cameraMatrix.mat4[6],this._renderer._curCamera.cameraMatrix.mat4[7],this._renderer._curCamera.cameraMatrix.mat4[8],this._renderer._curCamera.cameraMatrix.mat4[9],this._renderer._curCamera.cameraMatrix.mat4[10],this._renderer._curCamera.cameraMatrix.mat4[11],this._renderer._curCamera.cameraMatrix.mat4[12],this._renderer._curCamera.cameraMatrix.mat4[13],this._renderer._curCamera.cameraMatrix.mat4[14],this._renderer._curCamera.cameraMatrix.mat4[15]);for(var q=0;q<=numDivs;q++){this.beginShape(this.LINES);this.vertex(-halfSize+xOff,yOff,q*spacing-halfSize+zOff);this.vertex(+halfSize+xOff,yOff,q*spacing-halfSize+zOff);this.endShape()}for(var i=0;i<=numDivs;i++){this.beginShape(this.LINES);this.vertex(i*spacing-halfSize+xOff,yOff,-halfSize+zOff);this.vertex(i*spacing-halfSize+xOff,yOff,+halfSize+zOff);this.endShape()}this.pop()}};_main.default.prototype._axesIcon=function(size,xOff,yOff,zOff){if(typeof size==="undefined"){size=this.width/20>40?this.width/20:40}if(typeof xOff==="undefined"){xOff=-this.width/4}if(typeof yOff==="undefined"){yOff=xOff}if(typeof zOff==="undefined"){zOff=xOff}return function(){this.push();this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix.mat4[0],this._renderer._curCamera.cameraMatrix.mat4[1],this._renderer._curCamera.cameraMatrix.mat4[2],this._renderer._curCamera.cameraMatrix.mat4[3],this._renderer._curCamera.cameraMatrix.mat4[4],this._renderer._curCamera.cameraMatrix.mat4[5],this._renderer._curCamera.cameraMatrix.mat4[6],this._renderer._curCamera.cameraMatrix.mat4[7],this._renderer._curCamera.cameraMatrix.mat4[8],this._renderer._curCamera.cameraMatrix.mat4[9],this._renderer._curCamera.cameraMatrix.mat4[10],this._renderer._curCamera.cameraMatrix.mat4[11],this._renderer._curCamera.cameraMatrix.mat4[12],this._renderer._curCamera.cameraMatrix.mat4[13],this._renderer._curCamera.cameraMatrix.mat4[14],this._renderer._curCamera.cameraMatrix.mat4[15]);this.strokeWeight(2);this.stroke(255,0,0);this.beginShape(this.LINES);this.vertex(xOff,yOff,zOff);this.vertex(xOff+size,yOff,zOff);this.endShape();this.stroke(0,255,0);this.beginShape(this.LINES);this.vertex(xOff,yOff,zOff);this.vertex(xOff,yOff+size,zOff);this.endShape();this.stroke(0,0,255);this.beginShape(this.LINES);this.vertex(xOff,yOff,zOff);this.vertex(xOff,yOff,zOff+size);this.endShape();this.pop()}};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/main":298,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.splice":185,"core-js/modules/es.math.hypot":188,"core-js/modules/es.math.sign":190,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.for-each":255,"core-js/modules/web.dom-collections.iterator":256}],344:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.ambientLight=function(v1,v2,v3,a){this._assert3d("ambientLight");_main.default._validateParameters("ambientLight",arguments);var color=this.color.apply(this,arguments);this._renderer.ambientLightColors.push(color._array[0],color._array[1],color._array[2]);this._renderer._enableLighting=true;return this};_main.default.prototype.specularColor=function(v1,v2,v3){this._assert3d("specularColor");_main.default._validateParameters("specularColor",arguments);var color=this.color.apply(this,arguments);this._renderer.specularColors=[color._array[0],color._array[1],color._array[2]];return this};_main.default.prototype.directionalLight=function(v1,v2,v3,x,y,z){this._assert3d("directionalLight");_main.default._validateParameters("directionalLight",arguments);var color;if(v1 instanceof _main.default.Color){color=v1}else{color=this.color(v1,v2,v3)}var _x,_y,_z;var v=arguments[arguments.length-1];if(typeof v==="number"){_x=arguments[arguments.length-3];_y=arguments[arguments.length-2];_z=arguments[arguments.length-1]}else{_x=v.x;_y=v.y;_z=v.z}var l=Math.sqrt(_x*_x+_y*_y+_z*_z);this._renderer.directionalLightDirections.push(_x/l,_y/l,_z/l);this._renderer.directionalLightDiffuseColors.push(color._array[0],color._array[1],color._array[2]);Array.prototype.push.apply(this._renderer.directionalLightSpecularColors,this._renderer.specularColors);this._renderer._enableLighting=true;return this};_main.default.prototype.pointLight=function(v1,v2,v3,x,y,z){this._assert3d("pointLight");_main.default._validateParameters("pointLight",arguments);var color;if(v1 instanceof _main.default.Color){color=v1}else{color=this.color(v1,v2,v3)}var _x,_y,_z;var v=arguments[arguments.length-1];if(typeof v==="number"){_x=arguments[arguments.length-3];_y=arguments[arguments.length-2];_z=arguments[arguments.length-1]}else{_x=v.x;_y=v.y;_z=v.z}this._renderer.pointLightPositions.push(_x,_y,_z);this._renderer.pointLightDiffuseColors.push(color._array[0],color._array[1],color._array[2]);Array.prototype.push.apply(this._renderer.pointLightSpecularColors,this._renderer.specularColors);this._renderer._enableLighting=true;return this};_main.default.prototype.imageLight=function(img){this._renderer.activeImageLight=img;this._renderer._enableLighting=true};_main.default.prototype.lights=function(){this._assert3d("lights");var grayColor=this.color("rgb(128,128,128)");this.ambientLight(grayColor);this.directionalLight(grayColor,0,0,-1);return this};_main.default.prototype.lightFalloff=function(constantAttenuation,linearAttenuation,quadraticAttenuation){this._assert3d("lightFalloff");_main.default._validateParameters("lightFalloff",arguments);if(constantAttenuation<0){constantAttenuation=0;console.warn("Value of constant argument in lightFalloff() should be never be negative. Set to 0.")}if(linearAttenuation<0){linearAttenuation=0;console.warn("Value of linear argument in lightFalloff() should be never be negative. Set to 0.")}if(quadraticAttenuation<0){quadraticAttenuation=0;console.warn("Value of quadratic argument in lightFalloff() should be never be negative. Set to 0.")}if(constantAttenuation===0&&linearAttenuation===0&&quadraticAttenuation===0){constantAttenuation=1;console.warn("Either one of the three arguments in lightFalloff() should be greater than zero. Set constant argument to 1.")}this._renderer.constantAttenuation=constantAttenuation;this._renderer.linearAttenuation=linearAttenuation;this._renderer.quadraticAttenuation=quadraticAttenuation;return this};_main.default.prototype.spotLight=function(v1,v2,v3,x,y,z,nx,ny,nz,angle,concentration){this._assert3d("spotLight");_main.default._validateParameters("spotLight",arguments);var color,position,direction;var length=arguments.length;switch(length){case 11:case 10:color=this.color(v1,v2,v3);position=new _main.default.Vector(x,y,z);direction=new _main.default.Vector(nx,ny,nz);break;case 9:if(v1 instanceof _main.default.Color){color=v1;position=new _main.default.Vector(v2,v3,x);direction=new _main.default.Vector(y,z,nx);angle=ny;concentration=nz}else if(x instanceof _main.default.Vector){color=this.color(v1,v2,v3);position=x;direction=new _main.default.Vector(y,z,nx);angle=ny;concentration=nz}else if(nx instanceof _main.default.Vector){color=this.color(v1,v2,v3);position=new _main.default.Vector(x,y,z);direction=nx;angle=ny;concentration=nz}else{color=this.color(v1,v2,v3);position=new _main.default.Vector(x,y,z);direction=new _main.default.Vector(nx,ny,nz)}break;case 8:if(v1 instanceof _main.default.Color){color=v1;position=new _main.default.Vector(v2,v3,x);direction=new _main.default.Vector(y,z,nx);angle=ny}else if(x instanceof _main.default.Vector){color=this.color(v1,v2,v3);position=x;direction=new _main.default.Vector(y,z,nx);angle=ny}else{color=this.color(v1,v2,v3);position=new _main.default.Vector(x,y,z);direction=nx;angle=ny}break;case 7:if(v1 instanceof _main.default.Color&&v2 instanceof _main.default.Vector){color=v1;position=v2;direction=new _main.default.Vector(v3,x,y);angle=z;concentration=nx}else if(v1 instanceof _main.default.Color&&y instanceof _main.default.Vector){color=v1;position=new _main.default.Vector(v2,v3,x);direction=y;angle=z;concentration=nx}else if(x instanceof _main.default.Vector&&y instanceof _main.default.Vector){color=this.color(v1,v2,v3);position=x;direction=y;angle=z;concentration=nx}else if(v1 instanceof _main.default.Color){color=v1;position=new _main.default.Vector(v2,v3,x);direction=new _main.default.Vector(y,z,nx)}else if(x instanceof _main.default.Vector){color=this.color(v1,v2,v3);position=x;direction=new _main.default.Vector(y,z,nx)}else{color=this.color(v1,v2,v3);position=new _main.default.Vector(x,y,z);direction=nx}break;case 6:if(x instanceof _main.default.Vector&&y instanceof _main.default.Vector){color=this.color(v1,v2,v3);position=x;direction=y;angle=z}else if(v1 instanceof _main.default.Color&&y instanceof _main.default.Vector){color=v1;position=new _main.default.Vector(v2,v3,x);direction=y;angle=z}else if(v1 instanceof _main.default.Color&&v2 instanceof _main.default.Vector){color=v1;position=v2;direction=new _main.default.Vector(v3,x,y);angle=z}break;case 5:if(v1 instanceof _main.default.Color&&v2 instanceof _main.default.Vector&&v3 instanceof _main.default.Vector){color=v1;position=v2;direction=v3;angle=x;concentration=y}else if(x instanceof _main.default.Vector&&y instanceof _main.default.Vector){color=this.color(v1,v2,v3);position=x;direction=y}else if(v1 instanceof _main.default.Color&&y instanceof _main.default.Vector){color=v1;position=new _main.default.Vector(v2,v3,x);direction=y}else if(v1 instanceof _main.default.Color&&v2 instanceof _main.default.Vector){color=v1;position=v2;direction=new _main.default.Vector(v3,x,y)}break;case 4:color=v1;position=v2;direction=v3;angle=x;break;case 3:color=v1;position=v2;direction=v3;break;default:console.warn("Sorry, input for spotlight() is not in prescribed format. Too ".concat(length<3?"few":"many"," arguments were provided"));return this}this._renderer.spotLightDiffuseColors.push(color._array[0],color._array[1],color._array[2]);Array.prototype.push.apply(this._renderer.spotLightSpecularColors,this._renderer.specularColors);this._renderer.spotLightPositions.push(position.x,position.y,position.z);direction.normalize();this._renderer.spotLightDirections.push(direction.x,direction.y,direction.z);if(angle===undefined){angle=Math.PI/3}if(concentration!==undefined&&concentration<1){concentration=1;console.warn("Value of concentration needs to be greater than 1. Setting it to 1")}else if(concentration===undefined){concentration=100}angle=this._renderer._pInst._toRadians(angle);this._renderer.spotLightAngle.push(Math.cos(angle));this._renderer.spotLightConc.push(concentration);this._renderer._enableLighting=true;return this};_main.default.prototype.noLights=function(){this._assert3d("noLights");for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("noLights",args);this._renderer._enableLighting=false;this._renderer.ambientLightColors.length=0;this._renderer.specularColors=[1,1,1];this._renderer.directionalLightDirections.length=0;this._renderer.directionalLightDiffuseColors.length=0;this._renderer.directionalLightSpecularColors.length=0;this._renderer.pointLightPositions.length=0;this._renderer.pointLightDiffuseColors.length=0;this._renderer.pointLightSpecularColors.length=0;this._renderer.spotLightPositions.length=0;this._renderer.spotLightDirections.length=0;this._renderer.spotLightDiffuseColors.length=0;this._renderer.spotLightSpecularColors.length=0;this._renderer.spotLightAngle.length=0;this._renderer.spotLightConc.length=0;this._renderer.constantAttenuation=1;this._renderer.linearAttenuation=0;this._renderer.quadraticAttenuation=0;this._renderer._useShininess=1;return this};var _default=_main.default;exports.default=_default},{"../core/main":298}],345:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.splice");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.match");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.trim");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));_dereq_("./p5.Geometry");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.loadModel=function(path){_main.default._validateParameters("loadModel",arguments);var normalize;var successCallback;var failureCallback;var fileType=path.slice(-4);if(typeof arguments[1]==="boolean"){normalize=arguments[1];successCallback=arguments[2];failureCallback=arguments[3];if(typeof arguments[4]!=="undefined"){fileType=arguments[4]}}else{normalize=false;successCallback=arguments[1];failureCallback=arguments[2];if(typeof arguments[3]!=="undefined"){fileType=arguments[3]}}var model=new _main.default.Geometry;model.gid="".concat(path,"|").concat(normalize);var self=this;if(fileType.match(/\.stl$/i)){this.httpDo(path,"GET","arrayBuffer",function(arrayBuffer){parseSTL(model,arrayBuffer);if(normalize){model.normalize()}self._decrementPreload();if(typeof successCallback==="function"){successCallback(model)}},failureCallback)}else if(fileType.match(/\.obj$/i)){this.loadStrings(path,function(strings){parseObj(model,strings);if(normalize){model.normalize()}self._decrementPreload();if(typeof successCallback==="function"){successCallback(model)}},failureCallback)}else{_main.default._friendlyFileLoadError(3,path);if(failureCallback){failureCallback()}else{_main.default._friendlyError("Sorry, the file type is invalid. Only OBJ and STL files are supported.")}}return model};function parseObj(model,lines){var loadedVerts={v:[],vt:[],vn:[]};var indexedVerts={};for(var line=0;line<lines.length;++line){var tokens=lines[line].trim().split(/\b\s+/);if(tokens.length>0){if(tokens[0]==="v"||tokens[0]==="vn"){var vertex=new _main.default.Vector(parseFloat(tokens[1]),parseFloat(tokens[2]),parseFloat(tokens[3]));loadedVerts[tokens[0]].push(vertex)}else if(tokens[0]==="vt"){var texVertex=[parseFloat(tokens[1]),1-parseFloat(tokens[2])];loadedVerts[tokens[0]].push(texVertex)}else if(tokens[0]==="f"){for(var tri=3;tri<tokens.length;++tri){var face=[];var vertexTokens=[1,tri-1,tri];for(var tokenInd=0;tokenInd<vertexTokens.length;++tokenInd){var vertString=tokens[vertexTokens[tokenInd]];var vertIndex=0;if(indexedVerts[vertString]!==undefined){vertIndex=indexedVerts[vertString]}else{var vertParts=vertString.split("/");for(var i=0;i<vertParts.length;i++){vertParts[i]=parseInt(vertParts[i])-1}vertIndex=indexedVerts[vertString]=model.vertices.length;model.vertices.push(loadedVerts.v[vertParts[0]].copy());if(loadedVerts.vt[vertParts[1]]){model.uvs.push(loadedVerts.vt[vertParts[1]].slice())}else{model.uvs.push([0,0])}if(loadedVerts.vn[vertParts[2]]){model.vertexNormals.push(loadedVerts.vn[vertParts[2]].copy())}}face.push(vertIndex)}if(face[0]!==face[1]&&face[0]!==face[2]&&face[1]!==face[2]){model.faces.push(face)}}}}}if(model.vertexNormals.length===0){model.computeNormals()}return model}function parseSTL(model,buffer){if(isBinary(buffer)){parseBinarySTL(model,buffer)}else{var reader=new DataView(buffer);if(!("TextDecoder"in window)){console.warn("Sorry, ASCII STL loading only works in browsers that support TextDecoder (https://caniuse.com/#feat=textencoder)");return model}var decoder=new TextDecoder("utf-8");var lines=decoder.decode(reader);var lineArray=lines.split("\n");parseASCIISTL(model,lineArray)}return model}function isBinary(data){var reader=new DataView(data);var solid=[115,111,108,105,100];for(var off=0;off<5;off++){if(matchDataViewAt(solid,reader,off))return false}return true}function matchDataViewAt(query,reader,offset){for(var i=0,il=query.length;i<il;i++){if(query[i]!==reader.getUint8(offset+i,false))return false}return true}function parseBinarySTL(model,buffer){var reader=new DataView(buffer);var faces=reader.getUint32(80,true);var r,g,b,hasColors=false,colors;var defaultR,defaultG,defaultB;for(var index=0;index<80-10;index++){if(reader.getUint32(index,false)===1129270351&&reader.getUint8(index+4)===82&&reader.getUint8(index+5)===61){hasColors=true;colors=[];defaultR=reader.getUint8(index+6)/255;defaultG=reader.getUint8(index+7)/255;defaultB=reader.getUint8(index+8)/255}}var dataOffset=84;var faceLength=12*4+2;for(var face=0;face<faces;face++){var start=dataOffset+face*faceLength;var normalX=reader.getFloat32(start,true);var normalY=reader.getFloat32(start+4,true);var normalZ=reader.getFloat32(start+8,true);if(hasColors){var packedColor=reader.getUint16(start+48,true);if((packedColor&32768)===0){r=(packedColor&31)/31;g=(packedColor>>5&31)/31;b=(packedColor>>10&31)/31}else{r=defaultR;g=defaultG;b=defaultB}}var newNormal=new _main.default.Vector(normalX,normalY,normalZ);for(var i=1;i<=3;i++){var vertexstart=start+i*12;var newVertex=new _main.default.Vector(reader.getFloat32(vertexstart,true),reader.getFloat32(vertexstart+4,true),reader.getFloat32(vertexstart+8,true));model.vertices.push(newVertex);model.vertexNormals.push(newNormal);if(hasColors){colors.push(r,g,b)}}model.faces.push([3*face,3*face+1,3*face+2]);model.uvs.push([0,0],[0,0],[0,0])}if(hasColors){}return model}function parseASCIISTL(model,lines){var state="";var curVertexIndex=[];var newNormal,newVertex;for(var iterator=0;iterator<lines.length;++iterator){var line=lines[iterator].trim();var parts=line.split(" ");for(var partsiterator=0;partsiterator<parts.length;++partsiterator){if(parts[partsiterator]===""){parts.splice(partsiterator,1)}}if(parts.length===0){continue}switch(state){case"":if(parts[0]!=="solid"){console.error(line);console.error('Invalid state "'.concat(parts[0],'", should be "solid"'));return}else{state="solid"}break;case"solid":if(parts[0]!=="facet"||parts[1]!=="normal"){console.error(line);console.error('Invalid state "'.concat(parts[0],'", should be "facet normal"'));return}else{newNormal=new _main.default.Vector(parseFloat(parts[2]),parseFloat(parts[3]),parseFloat(parts[4]));model.vertexNormals.push(newNormal,newNormal,newNormal);state="facet normal"}break;case"facet normal":if(parts[0]!=="outer"||parts[1]!=="loop"){console.error(line);console.error('Invalid state "'.concat(parts[0],'", should be "outer loop"'));return}else{state="vertex"}break;case"vertex":if(parts[0]==="vertex"){newVertex=new _main.default.Vector(parseFloat(parts[1]),parseFloat(parts[2]),parseFloat(parts[3]));model.vertices.push(newVertex);model.uvs.push([0,0]);curVertexIndex.push(model.vertices.indexOf(newVertex))}else if(parts[0]==="endloop"){model.faces.push(curVertexIndex);curVertexIndex=[];state="endloop"}else{console.error(line);console.error('Invalid state "'.concat(parts[0],'", should be "vertex" or "endloop"'));return}break;case"endloop":if(parts[0]!=="endfacet"){console.error(line);console.error('Invalid state "'.concat(parts[0],'", should be "endfacet"'));return}else{state="endfacet"}break;case"endfacet":if(parts[0]==="endsolid"){}else if(parts[0]==="facet"&&parts[1]==="normal"){newNormal=new _main.default.Vector(parseFloat(parts[2]),parseFloat(parts[3]),parseFloat(parts[4]));model.vertexNormals.push(newNormal,newNormal,newNormal);state="facet normal"}else{console.error(line);console.error('Invalid state "'.concat(parts[0],'", should be "endsolid" or "facet normal"'));return}break;default:console.error('Invalid state "'.concat(state,'"'));break}}return model}_main.default.prototype.model=function(model){this._assert3d("model");_main.default._validateParameters("model",arguments);if(model.vertices.length>0){if(!this._renderer.geometryInHash(model.gid)){if(model.edges.length===0){model._makeTriangleEdges()}model._edgesToVertices();this._renderer.createBuffers(model.gid,model)}this._renderer.drawBuffers(model.gid)}};var _default=_main.default;exports.default=_default},{"../core/main":298,"./p5.Geometry":350,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.splice":185,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.match":211,"core-js/modules/es.string.split":216,"core-js/modules/es.string.trim":219}],346:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.join");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));_dereq_("./p5.Texture");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.prototype.loadShader=function(vertFilename,fragFilename,callback,errorCallback){_main.default._validateParameters("loadShader",arguments);if(!errorCallback){errorCallback=console.error}var loadedShader=new _main.default.Shader;var self=this;var loadedFrag=false;var loadedVert=false;var onLoad=function onLoad(){self._decrementPreload();if(callback){callback(loadedShader)}};this.loadStrings(vertFilename,function(result){loadedShader._vertSrc=result.join("\n");loadedVert=true;if(loadedFrag){onLoad()}},errorCallback);this.loadStrings(fragFilename,function(result){loadedShader._fragSrc=result.join("\n");loadedFrag=true;if(loadedVert){onLoad()}},errorCallback);return loadedShader};_main.default.prototype.createShader=function(vertSrc,fragSrc){_main.default._validateParameters("createShader",arguments);return new _main.default.Shader(this._renderer,vertSrc,fragSrc)};_main.default.prototype.createFilterShader=function(fragSrc){_main.default._validateParameters("createFilterShader",arguments);var defaultVertV1="\n    uniform mat4 uModelViewMatrix;\n    uniform mat4 uProjectionMatrix;\n\n    attribute vec3 aPosition;\n    // texcoords only come from p5 to vertex shader\n    // so pass texcoords on to the fragment shader in a varying variable\n    attribute vec2 aTexCoord;\n    varying vec2 vTexCoord;\n\n    void main() {\n      // transferring texcoords for the frag shader\n      vTexCoord = aTexCoord;\n\n      // copy position with a fourth coordinate for projection (1.0 is normal)\n      vec4 positionVec4 = vec4(aPosition, 1.0);\n\n      // project to 3D space\n      gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n    }\n  ";var defaultVertV2="#version 300 es\n    uniform mat4 uModelViewMatrix;\n    uniform mat4 uProjectionMatrix;\n\n    in vec3 aPosition;\n    in vec2 aTexCoord;\n    out vec2 vTexCoord;\n\n    void main() {\n      // transferring texcoords for the frag shader\n      vTexCoord = aTexCoord;\n\n      // copy position with a fourth coordinate for projection (1.0 is normal)\n      vec4 positionVec4 = vec4(aPosition, 1.0);\n\n      // project to 3D space\n      gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n    }\n  ";var vertSrc=fragSrc.includes("#version 300 es")?defaultVertV2:defaultVertV1;var shader=new _main.default.Shader(this._renderer,vertSrc,fragSrc);if(this._renderer.GL){shader.ensureCompiledOnContext(this)}else{shader.ensureCompiledOnContext(this._renderer.getFilterGraphicsLayer())}return shader};_main.default.prototype.shader=function(s){this._assert3d("shader");_main.default._validateParameters("shader",arguments);s.ensureCompiledOnContext(this);if(s.isStrokeShader()){this._renderer.userStrokeShader=s}else{this._renderer.userFillShader=s;this._renderer._useNormalMaterial=false}return this};_main.default.prototype.resetShader=function(){this._renderer.userFillShader=this._renderer.userStrokeShader=null;return this};_main.default.prototype.texture=function(tex){this._assert3d("texture");_main.default._validateParameters("texture",arguments);if(tex.gifProperties){tex._animateGif(this)}this._renderer.drawMode=constants.TEXTURE;this._renderer._useNormalMaterial=false;this._renderer._tex=tex;this._renderer._setProperty("_doFill",true);return this};_main.default.prototype.textureMode=function(mode){if(mode!==constants.IMAGE&&mode!==constants.NORMAL){console.warn("You tried to set ".concat(mode," textureMode only supports IMAGE & NORMAL "))}else{this._renderer.textureMode=mode}};_main.default.prototype.textureWrap=function(wrapX){var wrapY=arguments.length>1&&arguments[1]!==undefined?arguments[1]:wrapX;this._renderer.textureWrapX=wrapX;this._renderer.textureWrapY=wrapY;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this._renderer.textures.values()[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var texture=_step.value;texture.setWrapMode(wrapX,wrapY)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}};_main.default.prototype.normalMaterial=function(){this._assert3d("normalMaterial");for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("normalMaterial",args);this._renderer.drawMode=constants.FILL;this._renderer._useSpecularMaterial=false;this._renderer._useEmissiveMaterial=false;this._renderer._useNormalMaterial=true;this._renderer.curFillColor=[1,1,1,1];this._renderer._setProperty("_doFill",true);this.noStroke();return this};_main.default.prototype.ambientMaterial=function(v1,v2,v3){this._assert3d("ambientMaterial");_main.default._validateParameters("ambientMaterial",arguments);var color=_main.default.prototype.color.apply(this,arguments);this._renderer._hasSetAmbient=true;this._renderer.curAmbientColor=color._array;this._renderer._useNormalMaterial=false;this._renderer._enableLighting=true;this._renderer._setProperty("_doFill",true);return this};_main.default.prototype.emissiveMaterial=function(v1,v2,v3,a){this._assert3d("emissiveMaterial");_main.default._validateParameters("emissiveMaterial",arguments);var color=_main.default.prototype.color.apply(this,arguments);this._renderer.curEmissiveColor=color._array;this._renderer._useEmissiveMaterial=true;this._renderer._useNormalMaterial=false;this._renderer._enableLighting=true;return this};_main.default.prototype.specularMaterial=function(v1,v2,v3,alpha){this._assert3d("specularMaterial");_main.default._validateParameters("specularMaterial",arguments);var color=_main.default.prototype.color.apply(this,arguments);this._renderer.curSpecularColor=color._array;this._renderer._useSpecularMaterial=true;this._renderer._useNormalMaterial=false;this._renderer._enableLighting=true;return this};_main.default.prototype.shininess=function(shine){this._assert3d("shininess");_main.default._validateParameters("shininess",arguments);if(shine<1){shine=1}this._renderer._useShininess=shine;return this};_main.default.RendererGL.prototype._applyColorBlend=function(colors){var gl=this.GL;var isTexture=this.drawMode===constants.TEXTURE;var doBlend=this.userFillShader||this.userStrokeShader||this.userPointShader||isTexture||this.curBlendMode!==constants.BLEND||colors[colors.length-1]<1||this._isErasing;if(doBlend!==this._isBlending){if(doBlend||this.curBlendMode!==constants.BLEND&&this.curBlendMode!==constants.ADD){gl.enable(gl.BLEND)}else{gl.disable(gl.BLEND)}gl.depthMask(true);this._isBlending=doBlend}this._applyBlendMode();return colors};_main.default.RendererGL.prototype._applyBlendMode=function(){if(this._cachedBlendMode===this.curBlendMode){return}var gl=this.GL;switch(this.curBlendMode){case constants.BLEND:gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA);break;case constants.ADD:gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.ONE,gl.ONE);break;case constants.REMOVE:gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.ZERO,gl.ONE_MINUS_SRC_ALPHA);break;case constants.MULTIPLY:gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA);break;case constants.SCREEN:gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_COLOR);break;case constants.EXCLUSION:gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD);gl.blendFuncSeparate(gl.ONE_MINUS_DST_COLOR,gl.ONE_MINUS_SRC_COLOR,gl.ONE,gl.ONE);break;case constants.REPLACE:gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.ONE,gl.ZERO);break;case constants.SUBTRACT:gl.blendEquationSeparate(gl.FUNC_REVERSE_SUBTRACT,gl.FUNC_ADD);gl.blendFuncSeparate(gl.ONE,gl.ONE,gl.ONE,gl.ONE_MINUS_SRC_ALPHA);break;case constants.DARKEST:if(this.blendExt){gl.blendEquationSeparate(this.blendExt.MIN||this.blendExt.MIN_EXT,gl.FUNC_ADD);gl.blendFuncSeparate(gl.ONE,gl.ONE,gl.ONE,gl.ONE)}else{console.warn("blendMode(DARKEST) does not work in your browser in WEBGL mode.")}break;case constants.LIGHTEST:if(this.blendExt){gl.blendEquationSeparate(this.blendExt.MAX||this.blendExt.MAX_EXT,gl.FUNC_ADD);gl.blendFuncSeparate(gl.ONE,gl.ONE,gl.ONE,gl.ONE)}else{console.warn("blendMode(LIGHTEST) does not work in your browser in WEBGL mode.")}break;default:console.error("Oops! Somehow RendererGL set curBlendMode to an unsupported mode.");break}if(!this._isErasing){this._cachedBlendMode=this.curBlendMode}};var _default=_main.default;exports.default=_default},{"../core/constants":286,"../core/main":298,"./p5.Texture":357,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.join":180,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],347:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.math.hypot");_dereq_("core-js/modules/es.string.sub");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.math.hypot");_dereq_("core-js/modules/es.string.sub");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.prototype.camera=function(){var _this$_renderer$_curC;this._assert3d("camera");for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_main.default._validateParameters("camera",args);(_this$_renderer$_curC=this._renderer._curCamera).camera.apply(_this$_renderer$_curC,args);return this};_main.default.prototype.perspective=function(){var _this$_renderer$_curC2;this._assert3d("perspective");for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}_main.default._validateParameters("perspective",args);(_this$_renderer$_curC2=this._renderer._curCamera).perspective.apply(_this$_renderer$_curC2,args);return this};_main.default.prototype.ortho=function(){var _this$_renderer$_curC3;this._assert3d("ortho");for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}_main.default._validateParameters("ortho",args);(_this$_renderer$_curC3=this._renderer._curCamera).ortho.apply(_this$_renderer$_curC3,args);return this};_main.default.prototype.frustum=function(){var _this$_renderer$_curC4;this._assert3d("frustum");for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}_main.default._validateParameters("frustum",args);(_this$_renderer$_curC4=this._renderer._curCamera).frustum.apply(_this$_renderer$_curC4,args);return this};_main.default.prototype.createCamera=function(){this._assert3d("createCamera");var _cam=new _main.default.Camera(this._renderer);_cam._computeCameraDefaultSettings();_cam._setDefaultCamera();this._renderer._curCamera=_cam;return _cam};_main.default.Camera=function(){function Camera(renderer){_classCallCheck(this,Camera);this._renderer=renderer;this.cameraType="default";this.cameraMatrix=new _main.default.Matrix;this.projMatrix=new _main.default.Matrix;this.yScale=1}_createClass(Camera,[{key:"perspective",value:function perspective(fovy,aspect,near,far){this.cameraType=arguments.length>0?"custom":"default";if(typeof fovy==="undefined"){fovy=this.defaultCameraFOV;this.cameraFOV=fovy}else{this.cameraFOV=this._renderer._pInst._toRadians(fovy)}if(typeof aspect==="undefined"){aspect=this.defaultAspectRatio}if(typeof near==="undefined"){near=this.defaultCameraNear}if(typeof far==="undefined"){far=this.defaultCameraFar}if(near<=1e-4){near=.01;console.log("Avoid perspective near plane values close to or below 0. "+"Setting value to 0.01.")}if(far<near){console.log("Perspective far plane value is less than near plane value. "+"Nothing will be shown.")}this.aspectRatio=aspect;this.cameraNear=near;this.cameraFar=far;this.projMatrix=_main.default.Matrix.identity();var f=1/Math.tan(this.cameraFOV/2);var nf=1/(this.cameraNear-this.cameraFar);this.projMatrix.set(f/aspect,0,0,0,0,-f*this.yScale,0,0,0,0,(far+near)*nf,-1,0,0,2*far*near*nf,0);if(this._isActive()){this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15])}}},{key:"ortho",value:function ortho(left,right,bottom,top,near,far){if(left===undefined)left=-this._renderer.width/2;if(right===undefined)right=+this._renderer.width/2;if(bottom===undefined)bottom=-this._renderer.height/2;if(top===undefined)top=+this._renderer.height/2;if(near===undefined)near=0;if(far===undefined)far=Math.max(this._renderer.width,this._renderer.height);this.cameraNear=near;this.cameraFar=far;var w=right-left;var h=top-bottom;var d=far-near;var x=+2/w;var y=+2/h*this.yScale;var z=-2/d;var tx=-(right+left)/w;var ty=-(top+bottom)/h;var tz=-(far+near)/d;this.projMatrix=_main.default.Matrix.identity();this.projMatrix.set(x,0,0,0,0,-y,0,0,0,0,z,0,tx,ty,tz,1);if(this._isActive()){this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15])}this.cameraType="custom"}},{key:"frustum",value:function frustum(left,right,bottom,top,near,far){if(left===undefined)left=-this._renderer.width*.05;if(right===undefined)right=+this._renderer.width*.05;if(bottom===undefined)bottom=+this._renderer.height*.05;if(top===undefined)top=-this._renderer.height*.05;if(near===undefined)near=this.defaultCameraNear;if(far===undefined)far=this.defaultCameraFar;this.cameraNear=near;this.cameraFar=far;var w=right-left;var h=top-bottom;var d=far-near;var x=+(2*near)/w;var y=+(2*near)/h*this.yScale;var z=-(2*far*near)/d;var tx=(right+left)/w;var ty=(top+bottom)/h;var tz=-(far+near)/d;this.projMatrix=_main.default.Matrix.identity();this.projMatrix.set(x,0,0,0,0,-y,0,0,tx,ty,tz,-1,0,0,z,0);if(this._isActive()){this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15])}this.cameraType="custom"}},{key:"_rotateView",value:function _rotateView(a,x,y,z){var centerX=this.centerX;var centerY=this.centerY;var centerZ=this.centerZ;centerX-=this.eyeX;centerY-=this.eyeY;centerZ-=this.eyeZ;var rotation=_main.default.Matrix.identity(this._renderer._pInst);rotation.rotate(this._renderer._pInst._toRadians(a),x,y,z);var rotatedCenter=[centerX*rotation.mat4[0]+centerY*rotation.mat4[4]+centerZ*rotation.mat4[8],centerX*rotation.mat4[1]+centerY*rotation.mat4[5]+centerZ*rotation.mat4[9],centerX*rotation.mat4[2]+centerY*rotation.mat4[6]+centerZ*rotation.mat4[10]];rotatedCenter[0]+=this.eyeX;rotatedCenter[1]+=this.eyeY;rotatedCenter[2]+=this.eyeZ;this.camera(this.eyeX,this.eyeY,this.eyeZ,rotatedCenter[0],rotatedCenter[1],rotatedCenter[2],this.upX,this.upY,this.upZ)}},{key:"pan",value:function pan(amount){var local=this._getLocalAxes();this._rotateView(amount,local.y[0],local.y[1],local.y[2])}},{key:"tilt",value:function tilt(amount){var local=this._getLocalAxes();this._rotateView(amount,local.x[0],local.x[1],local.x[2])}},{key:"lookAt",value:function lookAt(x,y,z){this.camera(this.eyeX,this.eyeY,this.eyeZ,x,y,z,this.upX,this.upY,this.upZ)}},{key:"camera",value:function camera(eyeX,eyeY,eyeZ,centerX,centerY,centerZ,upX,upY,upZ){if(typeof eyeX==="undefined"){eyeX=this.defaultEyeX;eyeY=this.defaultEyeY;eyeZ=this.defaultEyeZ;centerX=eyeX;centerY=eyeY;centerZ=0;upX=0;upY=1;upZ=0}this.eyeX=eyeX;this.eyeY=eyeY;this.eyeZ=eyeZ;if(typeof centerX!=="undefined"){this.centerX=centerX;this.centerY=centerY;this.centerZ=centerZ}if(typeof upX!=="undefined"){this.upX=upX;this.upY=upY;this.upZ=upZ}var local=this._getLocalAxes();this.cameraMatrix.set(local.x[0],local.y[0],local.z[0],0,local.x[1],local.y[1],local.z[1],0,local.x[2],local.y[2],local.z[2],0,0,0,0,1);var tx=-eyeX;var ty=-eyeY;var tz=-eyeZ;this.cameraMatrix.translate([tx,ty,tz]);if(this._isActive()){this._renderer.uMVMatrix.set(this.cameraMatrix.mat4[0],this.cameraMatrix.mat4[1],this.cameraMatrix.mat4[2],this.cameraMatrix.mat4[3],this.cameraMatrix.mat4[4],this.cameraMatrix.mat4[5],this.cameraMatrix.mat4[6],this.cameraMatrix.mat4[7],this.cameraMatrix.mat4[8],this.cameraMatrix.mat4[9],this.cameraMatrix.mat4[10],this.cameraMatrix.mat4[11],this.cameraMatrix.mat4[12],this.cameraMatrix.mat4[13],this.cameraMatrix.mat4[14],this.cameraMatrix.mat4[15])}return this}},{key:"move",value:function move(x,y,z){var local=this._getLocalAxes();var dx=[local.x[0]*x,local.x[1]*x,local.x[2]*x];var dy=[local.y[0]*y,local.y[1]*y,local.y[2]*y];var dz=[local.z[0]*z,local.z[1]*z,local.z[2]*z];this.camera(this.eyeX+dx[0]+dy[0]+dz[0],this.eyeY+dx[1]+dy[1]+dz[1],this.eyeZ+dx[2]+dy[2]+dz[2],this.centerX+dx[0]+dy[0]+dz[0],this.centerY+dx[1]+dy[1]+dz[1],this.centerZ+dx[2]+dy[2]+dz[2],this.upX,this.upY,this.upZ)}},{key:"setPosition",value:function setPosition(x,y,z){var diffX=x-this.eyeX;var diffY=y-this.eyeY;var diffZ=z-this.eyeZ;this.camera(x,y,z,this.centerX+diffX,this.centerY+diffY,this.centerZ+diffZ,this.upX,this.upY,this.upZ)}},{key:"set",value:function set(cam){var keyNamesOfThePropToCopy=["eyeX","eyeY","eyeZ","centerX","centerY","centerZ","upX","upY","upZ","cameraFOV","aspectRatio","cameraNear","cameraFar","cameraType","yScale"];for(var _i=0,_keyNamesOfThePropToC=keyNamesOfThePropToCopy;_i<_keyNamesOfThePropToC.length;_i++){var keyName=_keyNamesOfThePropToC[_i];this[keyName]=cam[keyName]}this.cameraMatrix=cam.cameraMatrix.copy();this.projMatrix=cam.projMatrix.copy();if(this._isActive()){this._renderer.uMVMatrix.mat4=this.cameraMatrix.mat4.slice();this._renderer.uPMatrix.mat4=this.projMatrix.mat4.slice()}}},{key:"slerp",value:function slerp(cam0,cam1,amt){if(amt===0){this.set(cam0);return}else if(amt===1){this.set(cam1);return}if(this.projMatrix.mat4[15]!==0){this.projMatrix.mat4[0]=cam0.projMatrix.mat4[0]*Math.pow(cam1.projMatrix.mat4[0]/cam0.projMatrix.mat4[0],amt);this.projMatrix.mat4[5]=cam0.projMatrix.mat4[5]*Math.pow(cam1.projMatrix.mat4[5]/cam0.projMatrix.mat4[5],amt);if(this._isActive()){this._renderer.uPMatrix.mat4=this.projMatrix.mat4.slice()}}var eye0=new _main.default.Vector(cam0.eyeX,cam0.eyeY,cam0.eyeZ);var eye1=new _main.default.Vector(cam1.eyeX,cam1.eyeY,cam1.eyeZ);var center0=new _main.default.Vector(cam0.centerX,cam0.centerY,cam0.centerZ);var center1=new _main.default.Vector(cam1.centerX,cam1.centerY,cam1.centerZ);var dist0=_main.default.Vector.dist(eye0,center0);var dist1=_main.default.Vector.dist(eye1,center1);var lerpedDist=dist0*Math.pow(dist1/dist0,amt);var eyeDiff=_main.default.Vector.sub(eye0,eye1);var diffDiff=eye0.copy().sub(eye1).sub(center0).add(center1);var divider=diffDiff.magSq();var ratio=1;if(divider>1e-6){ratio=_main.default.Vector.dot(eyeDiff,diffDiff)/divider;ratio=Math.max(0,Math.min(ratio,1))}var lerpedMedium=_main.default.Vector.lerp(_main.default.Vector.lerp(eye0,center0,ratio),_main.default.Vector.lerp(eye1,center1,ratio),amt);var rotMat0=cam0.cameraMatrix.createSubMatrix3x3();var rotMat1=cam1.cameraMatrix.createSubMatrix3x3();var front0=rotMat0.row(2);var front1=rotMat1.row(2);var up0=rotMat0.row(1);var up1=rotMat1.row(1);var newFront=new _main.default.Vector;var newUp=new _main.default.Vector;var newEye=new _main.default.Vector;var newCenter=new _main.default.Vector;var deltaRot=rotMat1.mult3x3(rotMat0.copy().transpose3x3());var diag=deltaRot.diagonal();var cosTheta=.5*(diag[0]+diag[1]+diag[2]-1);if(1-cosTheta<1e-7){newFront.set(_main.default.Vector.lerp(front0,front1,amt)).normalize();newEye.set(newFront).mult(ratio*lerpedDist).add(lerpedMedium);newCenter.set(newFront).mult((ratio-1)*lerpedDist).add(lerpedMedium);newUp.set(_main.default.Vector.lerp(up0,up1,amt)).normalize();this.camera(newEye.x,newEye.y,newEye.z,newCenter.x,newCenter.y,newCenter.z,newUp.x,newUp.y,newUp.z);return}var a,b,c,sinTheta;var invOneMinusCosTheta=1/(1-cosTheta);var maxDiag=Math.max(diag[0],diag[1],diag[2]);var offDiagSum13=deltaRot.mat3[1]+deltaRot.mat3[3];var offDiagSum26=deltaRot.mat3[2]+deltaRot.mat3[6];var offDiagSum57=deltaRot.mat3[5]+deltaRot.mat3[7];if(maxDiag===diag[0]){a=Math.sqrt((diag[0]-cosTheta)*invOneMinusCosTheta);invOneMinusCosTheta/=a;b=.5*offDiagSum13*invOneMinusCosTheta;c=.5*offDiagSum26*invOneMinusCosTheta;sinTheta=.5*(deltaRot.mat3[7]-deltaRot.mat3[5])/a}else if(maxDiag===diag[1]){b=Math.sqrt((diag[1]-cosTheta)*invOneMinusCosTheta);invOneMinusCosTheta/=b;c=.5*offDiagSum57*invOneMinusCosTheta;a=.5*offDiagSum13*invOneMinusCosTheta;sinTheta=.5*(deltaRot.mat3[2]-deltaRot.mat3[6])/b}else{c=Math.sqrt((diag[2]-cosTheta)*invOneMinusCosTheta);invOneMinusCosTheta/=c;a=.5*offDiagSum26*invOneMinusCosTheta;b=.5*offDiagSum57*invOneMinusCosTheta;sinTheta=.5*(deltaRot.mat3[3]-deltaRot.mat3[1])/c}var angle=amt*Math.atan2(sinTheta,cosTheta);var cosAngle=Math.cos(angle);var sinAngle=Math.sin(angle);var oneMinusCosAngle=1-cosAngle;var ab=a*b;var bc=b*c;var ca=c*a;var lerpedRotMat=new _main.default.Matrix("mat3",[cosAngle+oneMinusCosAngle*a*a,oneMinusCosAngle*ab+sinAngle*c,oneMinusCosAngle*ca-sinAngle*b,oneMinusCosAngle*ab-sinAngle*c,cosAngle+oneMinusCosAngle*b*b,oneMinusCosAngle*bc+sinAngle*a,oneMinusCosAngle*ca+sinAngle*b,oneMinusCosAngle*bc-sinAngle*a,cosAngle+oneMinusCosAngle*c*c]);lerpedRotMat.multiplyVec3(front0,newFront);newEye.set(newFront).mult(ratio*lerpedDist).add(lerpedMedium);newCenter.set(newFront).mult((ratio-1)*lerpedDist).add(lerpedMedium);lerpedRotMat.multiplyVec3(up0,newUp);this.camera(newEye.x,newEye.y,newEye.z,newCenter.x,newCenter.y,newCenter.z,newUp.x,newUp.y,newUp.z)}},{key:"_computeCameraDefaultSettings",value:function _computeCameraDefaultSettings(){this.defaultAspectRatio=this._renderer.width/this._renderer.height;this.defaultEyeX=0;this.defaultEyeY=0;this.defaultEyeZ=800;this.defaultCameraFOV=2*Math.atan(this._renderer.height/2/this.defaultEyeZ);this.defaultCenterX=0;this.defaultCenterY=0;this.defaultCenterZ=0;this.defaultCameraNear=this.defaultEyeZ*.1;this.defaultCameraFar=this.defaultEyeZ*10}},{key:"_setDefaultCamera",value:function _setDefaultCamera(){this.cameraFOV=this.defaultCameraFOV;this.aspectRatio=this.defaultAspectRatio;this.eyeX=this.defaultEyeX;this.eyeY=this.defaultEyeY;this.eyeZ=this.defaultEyeZ;this.centerX=this.defaultCenterX;this.centerY=this.defaultCenterY;this.centerZ=this.defaultCenterZ;this.upX=0;this.upY=1;this.upZ=0;this.cameraNear=this.defaultCameraNear;this.cameraFar=this.defaultCameraFar;this.perspective();this.camera();this.cameraType="default"}},{key:"_resize",value:function _resize(){if(this.cameraType==="default"){this._computeCameraDefaultSettings();this.cameraFOV=this.defaultCameraFOV;this.aspectRatio=this.defaultAspectRatio;this.perspective()}}},{key:"copy",value:function copy(){var _cam=new _main.default.Camera(this._renderer);_cam.cameraFOV=this.cameraFOV;_cam.aspectRatio=this.aspectRatio;_cam.eyeX=this.eyeX;_cam.eyeY=this.eyeY;_cam.eyeZ=this.eyeZ;_cam.centerX=this.centerX;_cam.centerY=this.centerY;_cam.centerZ=this.centerZ;_cam.upX=this.upX;_cam.upY=this.upY;_cam.upZ=this.upZ;_cam.cameraNear=this.cameraNear;_cam.cameraFar=this.cameraFar;_cam.cameraType=this.cameraType;_cam.cameraMatrix=this.cameraMatrix.copy();_cam.projMatrix=this.projMatrix.copy();_cam.yScale=this.yScale;return _cam}},{key:"_getLocalAxes",value:function _getLocalAxes(){var z0=this.eyeX-this.centerX;var z1=this.eyeY-this.centerY;var z2=this.eyeZ-this.centerZ;var eyeDist=Math.sqrt(z0*z0+z1*z1+z2*z2);if(eyeDist!==0){z0/=eyeDist;z1/=eyeDist;z2/=eyeDist}var y0=this.upX;var y1=this.upY;var y2=this.upZ;var x0=y1*z2-y2*z1;var x1=-y0*z2+y2*z0;var x2=y0*z1-y1*z0;y0=z1*x2-z2*x1;y1=-z0*x2+z2*x0;y2=z0*x1-z1*x0;var xmag=Math.sqrt(x0*x0+x1*x1+x2*x2);if(xmag!==0){x0/=xmag;x1/=xmag;x2/=xmag}var ymag=Math.sqrt(y0*y0+y1*y1+y2*y2);if(ymag!==0){y0/=ymag;y1/=ymag;y2/=ymag}return{x:[x0,x1,x2],y:[y0,y1,y2],z:[z0,z1,z2]}}},{key:"_orbit",value:function _orbit(dTheta,dPhi,dRadius){var diffX=this.eyeX-this.centerX;var diffY=this.eyeY-this.centerY;var diffZ=this.eyeZ-this.centerZ;var camRadius=Math.hypot(diffX,diffY,diffZ);var front=new _main.default.Vector(diffX,diffY,diffZ).normalize();var up=new _main.default.Vector(this.upX,this.upY,this.upZ).normalize();var side=new _main.default.Vector.cross(up,front).normalize();var vertical=new _main.default.Vector.cross(side,up);camRadius*=Math.pow(10,dRadius);if(camRadius<this.cameraNear){camRadius=this.cameraNear}if(camRadius>this.cameraFar){camRadius=this.cameraFar}var camPhi=Math.acos(Math.max(-1,Math.min(1,_main.default.Vector.dot(front,up))))+dPhi;var camTheta=dTheta;if(camPhi<=0||camPhi>=Math.PI){this.upX*=-1;this.upY*=-1;this.upZ*=-1}up.mult(Math.cos(camPhi));vertical.mult(Math.cos(camTheta)*Math.sin(camPhi));side.mult(Math.sin(camTheta)*Math.sin(camPhi));front.set(up).add(vertical).add(side);this.eyeX=camRadius*front.x+this.centerX;this.eyeY=camRadius*front.y+this.centerY;this.eyeZ=camRadius*front.z+this.centerZ;this.camera(this.eyeX,this.eyeY,this.eyeZ,this.centerX,this.centerY,this.centerZ,this.upX,this.upY,this.upZ)}},{key:"_orbitFree",value:function _orbitFree(dx,dy,dRadius){var diffX=this.eyeX-this.centerX;var diffY=this.eyeY-this.centerY;var diffZ=this.eyeZ-this.centerZ;var camRadius=Math.hypot(diffX,diffY,diffZ);var front=new _main.default.Vector(diffX,diffY,diffZ).normalize();var up=new _main.default.Vector(this.upX,this.upY,this.upZ);var side=new _main.default.Vector.cross(up,front).normalize();var down=new _main.default.Vector.cross(front,side);var directionAngle=Math.atan2(dy,dx);down.mult(Math.sin(directionAngle));side.mult(Math.cos(directionAngle)).add(down);var rotAngle=Math.sqrt(dx*dx+dy*dy);var axis=new _main.default.Vector.cross(front,side);camRadius*=Math.pow(10,dRadius);if(camRadius<this.cameraNear){camRadius=this.cameraNear}if(camRadius>this.cameraFar){camRadius=this.cameraFar}var c=Math.cos(rotAngle);var s=Math.sin(rotAngle);var dotFront=up.dot(front);var dotSide=up.dot(side);var ux=dotFront*c+dotSide*s;var uy=-dotFront*s+dotSide*c;var uz=up.dot(axis);up.x=ux*front.x+uy*side.x+uz*axis.x;up.y=ux*front.y+uy*side.y+uz*axis.y;up.z=ux*front.z+uy*side.z+uz*axis.z;side.mult(-s);front.mult(c).add(side).mult(camRadius);this.camera(front.x+this.centerX,front.y+this.centerY,front.z+this.centerZ,this.centerX,this.centerY,this.centerZ,up.x,up.y,up.z)}},{key:"_isActive",value:function _isActive(){return this===this._renderer._curCamera}}]);return Camera}();_main.default.prototype.setCamera=function(cam){this._renderer._curCamera=cam;this._renderer.uPMatrix.set(cam.projMatrix.mat4[0],cam.projMatrix.mat4[1],cam.projMatrix.mat4[2],cam.projMatrix.mat4[3],cam.projMatrix.mat4[4],cam.projMatrix.mat4[5],cam.projMatrix.mat4[6],cam.projMatrix.mat4[7],cam.projMatrix.mat4[8],cam.projMatrix.mat4[9],cam.projMatrix.mat4[10],cam.projMatrix.mat4[11],cam.projMatrix.mat4[12],cam.projMatrix.mat4[13],cam.projMatrix.mat4[14],cam.projMatrix.mat4[15])};var _default=_main.default.Camera;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.slice":183,"core-js/modules/es.math.hypot":188,"core-js/modules/es.string.sub":218}],348:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.math.log2");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.math.log2");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.DataArray=function(){function DataArray(){var initialLength=arguments.length>0&&arguments[0]!==undefined?arguments[0]:128;_classCallCheck(this,DataArray);this.length=0;this.data=new Float32Array(initialLength);this.initialLength=initialLength}_createClass(DataArray,[{key:"dataArray",value:function dataArray(){return this.subArray(0,this.length)}},{key:"clear",value:function clear(){this.length=0}},{key:"rescale",value:function rescale(){if(this.length<this.data.length/2){var targetLength=1<<Math.ceil(Math.log2(this.length));var newData=new Float32Array(targetLength);newData.set(this.data.subarray(0,this.length),0);this.data=newData}}},{key:"reset",value:function reset(){this.clear();this.data=new Float32Array(this.initialLength)}},{key:"push",value:function push(){for(var _len=arguments.length,values=new Array(_len),_key=0;_key<_len;_key++){values[_key]=arguments[_key]}this.ensureLength(this.length+values.length);this.data.set(values,this.length);this.length+=values.length}},{key:"slice",value:function slice(from,to){return this.data.slice(from,Math.min(to,this.length))}},{key:"subArray",value:function subArray(from,to){return this.data.subarray(from,Math.min(to,this.length))}},{key:"ensureLength",value:function ensureLength(target){while(this.data.length<target){var newData=new Float32Array(this.data.length*2);newData.set(this.data,0);this.data=newData}}}]);return DataArray}();var _default=_main.default.DataArray;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.math.log2":189,"core-js/modules/es.object.to-string":200,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.float32-array":229,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249}],349:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.reflect.get");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.uint8-clamped-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.uint8-clamped-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));var _p=_dereq_("./p5.Texture");var _p2=_dereq_("./p5.RendererGL");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||Object.prototype.toString.call(arr)==="[object Arguments]")){return}var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver)}return desc.value}}return _get(target,property,receiver||target)}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break}return object}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var Super=_getPrototypeOf(Derived),result;if(isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var FramebufferCamera=function(_p5$Camera){_inherits(FramebufferCamera,_p5$Camera);var _super=_createSuper(FramebufferCamera);function FramebufferCamera(framebuffer){var _this;_classCallCheck(this,FramebufferCamera);_this=_super.call(this,framebuffer.target._renderer);_this.fbo=framebuffer;_this.yScale=-1;return _this}_createClass(FramebufferCamera,[{key:"_computeCameraDefaultSettings",value:function _computeCameraDefaultSettings(){_get(_getPrototypeOf(FramebufferCamera.prototype),"_computeCameraDefaultSettings",this).call(this);this.defaultAspectRatio=this.fbo.width/this.fbo.height;this.defaultCameraFOV=2*Math.atan(this.fbo.height/2/this.defaultEyeZ)}}]);return FramebufferCamera}(_main.default.Camera);_main.default.FramebufferCamera=FramebufferCamera;var FramebufferTexture=function(){function FramebufferTexture(framebuffer,property){_classCallCheck(this,FramebufferTexture);this.framebuffer=framebuffer;this.property=property}_createClass(FramebufferTexture,[{key:"rawTexture",value:function rawTexture(){return this.framebuffer[this.property]}},{key:"width",get:function get(){return this.framebuffer.width*this.framebuffer.density}},{key:"height",get:function get(){return this.framebuffer.height*this.framebuffer.density}}]);return FramebufferTexture}();_main.default.FramebufferTexture=FramebufferTexture;var Framebuffer=function(){function Framebuffer(target){var _this2=this;var settings=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Framebuffer);this.target=target;this.target._renderer.framebuffers.add(this);this._isClipApplied=false;this.pixels=[];this.format=settings.format||constants.UNSIGNED_BYTE;this.channels=settings.channels||(target._renderer._pInst._glAttributes.alpha?constants.RGBA:constants.RGB);this.useDepth=settings.depth===undefined?true:settings.depth;this.depthFormat=settings.depthFormat||constants.FLOAT;this.textureFiltering=settings.textureFiltering||constants.LINEAR;if(settings.antialias===undefined){this.antialiasSamples=target._renderer._pInst._glAttributes.antialias?2:0}else if(typeof settings.antialias==="number"){this.antialiasSamples=settings.antialias}else{this.antialiasSamples=settings.antialias?2:0}this.antialias=this.antialiasSamples>0;if(this.antialias&&target.webglVersion!==constants.WEBGL2){console.warn("Antialiasing is unsupported in a WebGL 1 context");this.antialias=false}if(settings.width&&settings.height){this.width=settings.width;this.height=settings.height;this.autoSized=false}else{if(settings.width===undefined!==(settings.height===undefined)){console.warn("Please supply both width and height for a framebuffer to give it a "+"size. Only one was given, so the framebuffer will match the size "+"of its canvas.")}this.width=target.width;this.height=target.height;this.autoSized=true}this.density=settings.density||target.pixelDensity();var gl=target._renderer.GL;this.gl=gl;this._checkIfFormatsAvailable();if(settings.stencil&&!this.useDepth){console.warn("A stencil buffer can only be used if also using depth. Since the framebuffer has no depth buffer, the stencil buffer will be ignored.")}this.useStencil=this.useDepth&&(settings.stencil===undefined?true:settings.stencil);this.framebuffer=gl.createFramebuffer();if(!this.framebuffer){throw new Error("Unable to create a framebuffer")}if(this.antialias){this.aaFramebuffer=gl.createFramebuffer();if(!this.aaFramebuffer){throw new Error("Unable to create a framebuffer for antialiasing")}}this._recreateTextures();var prevCam=this.target._renderer._curCamera;this.defaultCamera=this.createCamera();this.target._renderer._curCamera=prevCam;this.draw(function(){return _this2.target.clear()})}_createClass(Framebuffer,[{key:"resize",value:function resize(width,height){this.autoSized=false;this.width=width;this.height=height;this._handleResize()}},{key:"pixelDensity",value:function pixelDensity(density){if(density){this.autoSized=false;this.density=density;this._handleResize()}else{return this.density}}},{key:"autoSized",value:function autoSized(_autoSized){if(_autoSized===undefined){return this.autoSized}else{this.autoSized=_autoSized;this._handleResize()}}},{key:"_checkIfFormatsAvailable",value:function _checkIfFormatsAvailable(){var gl=this.gl;if(this.useDepth&&this.target.webglVersion===constants.WEBGL&&!gl.getExtension("WEBGL_depth_texture")){console.warn("Unable to create depth textures in this environment. Falling back "+"to a framebuffer without depth.");this.useDepth=false}if(this.useDepth&&this.target.webglVersion===constants.WEBGL&&this.depthFormat===constants.FLOAT){console.warn("FLOAT depth format is unavailable in WebGL 1. "+"Defaulting to UNSIGNED_INT.");this.depthFormat=constants.UNSIGNED_INT}if(![constants.UNSIGNED_BYTE,constants.FLOAT,constants.HALF_FLOAT].includes(this.format)){console.warn("Unknown Framebuffer format. "+"Please use UNSIGNED_BYTE, FLOAT, or HALF_FLOAT. "+"Defaulting to UNSIGNED_BYTE.");this.format=constants.UNSIGNED_BYTE}if(this.useDepth&&![constants.UNSIGNED_INT,constants.FLOAT].includes(this.depthFormat)){console.warn("Unknown Framebuffer depth format. "+"Please use UNSIGNED_INT or FLOAT. Defaulting to FLOAT.");this.depthFormat=constants.FLOAT}var support=(0,_p.checkWebGLCapabilities)(this.target._renderer);if(!support.float&&this.format===constants.FLOAT){console.warn("This environment does not support FLOAT textures. "+"Falling back to UNSIGNED_BYTE.");this.format=constants.UNSIGNED_BYTE}if(this.useDepth&&!support.float&&this.depthFormat===constants.FLOAT){console.warn("This environment does not support FLOAT depth textures. "+"Falling back to UNSIGNED_INT.");this.depthFormat=constants.UNSIGNED_INT}if(!support.halfFloat&&this.format===constants.HALF_FLOAT){console.warn("This environment does not support HALF_FLOAT textures. "+"Falling back to UNSIGNED_BYTE.");this.format=constants.UNSIGNED_BYTE}if(this.channels===constants.RGB&&[constants.FLOAT,constants.HALF_FLOAT].includes(this.format)){console.warn("FLOAT and HALF_FLOAT formats do not work cross-platform with only "+"RGB channels. Falling back to RGBA.");this.channels=constants.RGBA}}},{key:"_recreateTextures",value:function _recreateTextures(){var gl=this.gl;this._updateSize();var prevBoundTexture=gl.getParameter(gl.TEXTURE_BINDING_2D);var prevBoundFramebuffer=gl.getParameter(gl.FRAMEBUFFER_BINDING);var colorTexture=gl.createTexture();if(!colorTexture){throw new Error("Unable to create color texture")}gl.bindTexture(gl.TEXTURE_2D,colorTexture);var colorFormat=this._glColorFormat();gl.texImage2D(gl.TEXTURE_2D,0,colorFormat.internalFormat,this.width*this.density,this.height*this.density,0,colorFormat.format,colorFormat.type,null);this.colorTexture=colorTexture;gl.bindFramebuffer(gl.FRAMEBUFFER,this.framebuffer);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,colorTexture,0);if(this.useDepth){var depthTexture=gl.createTexture();if(!depthTexture){throw new Error("Unable to create depth texture")}var depthFormat=this._glDepthFormat();gl.bindTexture(gl.TEXTURE_2D,depthTexture);gl.texImage2D(gl.TEXTURE_2D,0,depthFormat.internalFormat,this.width*this.density,this.height*this.density,0,depthFormat.format,depthFormat.type,null);gl.framebufferTexture2D(gl.FRAMEBUFFER,this.useStencil?gl.DEPTH_STENCIL_ATTACHMENT:gl.DEPTH_ATTACHMENT,gl.TEXTURE_2D,depthTexture,0);this.depthTexture=depthTexture}if(this.antialias){this.colorRenderbuffer=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,this.colorRenderbuffer);gl.renderbufferStorageMultisample(gl.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,gl.getParameter(gl.MAX_SAMPLES))),colorFormat.internalFormat,this.width*this.density,this.height*this.density);if(this.useDepth){var _depthFormat=this._glDepthFormat();this.depthRenderbuffer=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,this.depthRenderbuffer);gl.renderbufferStorageMultisample(gl.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,gl.getParameter(gl.MAX_SAMPLES))),_depthFormat.internalFormat,this.width*this.density,this.height*this.density)}gl.bindFramebuffer(gl.FRAMEBUFFER,this.aaFramebuffer);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.RENDERBUFFER,this.colorRenderbuffer);if(this.useDepth){gl.framebufferRenderbuffer(gl.FRAMEBUFFER,this.useStencil?gl.DEPTH_STENCIL_ATTACHMENT:gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,this.depthRenderbuffer)}}if(this.useDepth){this.depth=new FramebufferTexture(this,"depthTexture");var depthFilter=gl.NEAREST;this.depthP5Texture=new _main.default.Texture(this.target._renderer,this.depth,{minFilter:depthFilter,magFilter:depthFilter});this.target._renderer.textures.set(this.depth,this.depthP5Texture)}this.color=new FramebufferTexture(this,"colorTexture");var filter=this.textureFiltering===constants.LINEAR?gl.LINEAR:gl.NEAREST;this.colorP5Texture=new _main.default.Texture(this.target._renderer,this.color,{minFilter:filter,magFilter:filter});this.target._renderer.textures.set(this.color,this.colorP5Texture);gl.bindTexture(gl.TEXTURE_2D,prevBoundTexture);gl.bindFramebuffer(gl.FRAMEBUFFER,prevBoundFramebuffer)}},{key:"_glColorFormat",value:function _glColorFormat(){var type,format,internalFormat;var gl=this.gl;if(this.format===constants.FLOAT){type=gl.FLOAT}else if(this.format===constants.HALF_FLOAT){type=this.target.webglVersion===constants.WEBGL2?gl.HALF_FLOAT:gl.getExtension("OES_texture_half_float").HALF_FLOAT_OES}else{type=gl.UNSIGNED_BYTE}if(this.channels===constants.RGBA){format=gl.RGBA}else{format=gl.RGB}if(this.target.webglVersion===constants.WEBGL2){var _gl$UNSIGNED_BYTE,_table;var table=(_table={},_defineProperty(_table,gl.FLOAT,_defineProperty({},gl.RGBA,gl.RGBA32F)),_defineProperty(_table,gl.HALF_FLOAT,_defineProperty({},gl.RGBA,gl.RGBA16F)),_defineProperty(_table,gl.UNSIGNED_BYTE,(_gl$UNSIGNED_BYTE={},_defineProperty(_gl$UNSIGNED_BYTE,gl.RGBA,gl.RGBA8),_defineProperty(_gl$UNSIGNED_BYTE,gl.RGB,gl.RGB8),_gl$UNSIGNED_BYTE)),_table);internalFormat=table[type][format]}else if(this.format===constants.HALF_FLOAT){internalFormat=gl.RGBA}else{internalFormat=format}return{internalFormat:internalFormat,format:format,type:type}}},{key:"_glDepthFormat",value:function _glDepthFormat(){var type,format,internalFormat;var gl=this.gl;if(this.useStencil){if(this.depthFormat===constants.FLOAT){type=gl.FLOAT_32_UNSIGNED_INT_24_8_REV}else if(this.target.webglVersion===constants.WEBGL2){type=gl.UNSIGNED_INT_24_8}else{type=gl.getExtension("WEBGL_depth_texture").UNSIGNED_INT_24_8_WEBGL}}else{if(this.depthFormat===constants.FLOAT){type=gl.FLOAT}else{type=gl.UNSIGNED_INT}}if(this.useStencil){format=gl.DEPTH_STENCIL}else{format=gl.DEPTH_COMPONENT}if(this.useStencil){if(this.depthFormat===constants.FLOAT){internalFormat=gl.DEPTH32F_STENCIL8}else if(this.target.webglVersion===constants.WEBGL2){internalFormat=gl.DEPTH24_STENCIL8}else{internalFormat=gl.DEPTH_STENCIL}}else if(this.target.webglVersion===constants.WEBGL2){if(this.depthFormat===constants.FLOAT){internalFormat=gl.DEPTH_COMPONENT32F}else{internalFormat=gl.DEPTH_COMPONENT24}}else{internalFormat=gl.DEPTH_COMPONENT}return{internalFormat:internalFormat,format:format,type:type}}},{key:"_updateSize",value:function _updateSize(){if(this.autoSized){this.width=this.target.width;this.height=this.target.height;this.density=this.target.pixelDensity()}}},{key:"_canvasSizeChanged",value:function _canvasSizeChanged(){if(this.autoSized){this._handleResize()}}},{key:"_handleResize",value:function _handleResize(){var oldColor=this.color;var oldDepth=this.depth;var oldColorRenderbuffer=this.colorRenderbuffer;var oldDepthRenderbuffer=this.depthRenderbuffer;this._deleteTexture(oldColor);if(oldDepth)this._deleteTexture(oldDepth);var gl=this.gl;if(oldColorRenderbuffer)gl.deleteRenderbuffer(oldColorRenderbuffer);if(oldDepthRenderbuffer)gl.deleteRenderbuffer(oldDepthRenderbuffer);this._recreateTextures();this.defaultCamera._resize()}},{key:"createCamera",value:function createCamera(){var cam=new FramebufferCamera(this);cam._computeCameraDefaultSettings();cam._setDefaultCamera();this.target._renderer._curCamera=cam;return cam}},{key:"_deleteTexture",value:function _deleteTexture(texture){var gl=this.gl;gl.deleteTexture(texture.rawTexture());this.target._renderer.textures.delete(texture)}},{key:"remove",value:function remove(){var gl=this.gl;this._deleteTexture(this.color);if(this.depth)this._deleteTexture(this.depth);gl.deleteFramebuffer(this.framebuffer);if(this.aaFramebuffer){gl.deleteFramebuffer(this.aaFramebuffer)}if(this.depthRenderbuffer){gl.deleteRenderbuffer(this.depthRenderbuffer)}if(this.colorRenderbuffer){gl.deleteRenderbuffer(this.colorRenderbuffer)}this.target._renderer.framebuffers.delete(this)}},{key:"begin",value:function begin(){this.prevFramebuffer=this.target._renderer.activeFramebuffer();if(this.prevFramebuffer){this.prevFramebuffer._beforeEnd()}this.target._renderer.activeFramebuffers.push(this);this._beforeBegin();this.target.push();this.target.setCamera(this.defaultCamera);this.target._renderer.uMVMatrix.set(this.target._renderer._curCamera.cameraMatrix.mat4[0],this.target._renderer._curCamera.cameraMatrix.mat4[1],this.target._renderer._curCamera.cameraMatrix.mat4[2],this.target._renderer._curCamera.cameraMatrix.mat4[3],this.target._renderer._curCamera.cameraMatrix.mat4[4],this.target._renderer._curCamera.cameraMatrix.mat4[5],this.target._renderer._curCamera.cameraMatrix.mat4[6],this.target._renderer._curCamera.cameraMatrix.mat4[7],this.target._renderer._curCamera.cameraMatrix.mat4[8],this.target._renderer._curCamera.cameraMatrix.mat4[9],this.target._renderer._curCamera.cameraMatrix.mat4[10],this.target._renderer._curCamera.cameraMatrix.mat4[11],this.target._renderer._curCamera.cameraMatrix.mat4[12],this.target._renderer._curCamera.cameraMatrix.mat4[13],this.target._renderer._curCamera.cameraMatrix.mat4[14],this.target._renderer._curCamera.cameraMatrix.mat4[15])}},{key:"_framebufferToBind",value:function _framebufferToBind(){if(this.antialias){return this.aaFramebuffer}else{return this.framebuffer}}},{key:"_beforeBegin",value:function _beforeBegin(){var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,this._framebufferToBind());this.target._renderer.viewport(this.width*this.density,this.height*this.density)}},{key:"_beforeEnd",value:function _beforeEnd(){if(this.antialias){var gl=this.gl;gl.bindFramebuffer(gl.READ_FRAMEBUFFER,this.aaFramebuffer);gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER,this.framebuffer);var partsToCopy=[[gl.COLOR_BUFFER_BIT,this.colorP5Texture.glMagFilter]];if(this.useDepth){partsToCopy.push([gl.DEPTH_BUFFER_BIT,this.depthP5Texture.glMagFilter])}for(var _i=0,_partsToCopy=partsToCopy;_i<_partsToCopy.length;_i++){var _partsToCopy$_i=_slicedToArray(_partsToCopy[_i],2),flag=_partsToCopy$_i[0],filter=_partsToCopy$_i[1];gl.blitFramebuffer(0,0,this.width*this.density,this.height*this.density,0,0,this.width*this.density,this.height*this.density,flag,filter)}}}},{key:"end",value:function end(){var gl=this.gl;this.target.pop();var fbo=this.target._renderer.activeFramebuffers.pop();if(fbo!==this){throw new Error("It looks like you've called end() while another Framebuffer is active.")}this._beforeEnd();if(this.prevFramebuffer){this.prevFramebuffer._beforeBegin()}else{gl.bindFramebuffer(gl.FRAMEBUFFER,null);this.target._renderer.viewport(this.target._renderer._origViewport.width,this.target._renderer._origViewport.height)}this.target._renderer._applyStencilTestIfClipping()}},{key:"draw",value:function draw(callback){this.begin();callback();this.end()}},{key:"loadPixels",value:function loadPixels(){var gl=this.gl;var prevFramebuffer=this.target._renderer.activeFramebuffer();gl.bindFramebuffer(gl.FRAMEBUFFER,this.framebuffer);var colorFormat=this._glColorFormat();this.pixels=(0,_p2.readPixelsWebGL)(this.pixels,gl,this.framebuffer,0,0,this.width*this.density,this.height*this.density,colorFormat.format,colorFormat.type);if(prevFramebuffer){gl.bindFramebuffer(gl.FRAMEBUFFER,prevFramebuffer._framebufferToBind())}else{gl.bindFramebuffer(gl.FRAMEBUFFER,null)}}},{key:"get",value:function get(x,y,w,h){_main.default._validateParameters("p5.Framebuffer.get",arguments);var colorFormat=this._glColorFormat();if(x===undefined&&y===undefined){x=0;y=0;w=this.width;h=this.height}else if(w===undefined&&h===undefined){if(x<0||y<0||x>=this.width||y>=this.height){console.warn("The x and y values passed to p5.Framebuffer.get are outside of its range and will be clamped.");x=this.target.constrain(x,0,this.width-1);y=this.target.constrain(y,0,this.height-1)}return(0,_p2.readPixelWebGL)(this.gl,this.framebuffer,x*this.density,y*this.density,colorFormat.format,colorFormat.type)}x=this.target.constrain(x,0,this.width-1);y=this.target.constrain(y,0,this.height-1);w=this.target.constrain(w,1,this.width-x);h=this.target.constrain(h,1,this.height-y);var rawData=(0,_p2.readPixelsWebGL)(undefined,this.gl,this.framebuffer,x*this.density,y*this.density,w*this.density,h*this.density,colorFormat.format,colorFormat.type);var fullData=new Uint8ClampedArray(w*h*this.density*this.density*4);fullData.fill(255);var channels=colorFormat.type===this.gl.RGB?3:4;for(var _y=0;_y<h*this.density;_y++){for(var _x=0;_x<w*this.density;_x++){for(var channel=0;channel<4;channel++){var idx=(_y*w*this.density+_x)*4+channel;if(channel<channels){var rawDataIdx=channels===4?idx:(_y*w*this.density+_x)*channels+channel;fullData[idx]=rawData[rawDataIdx]}}}}var region=new _main.default.Image(w*this.density,h*this.density);region.imageData=region.canvas.getContext("2d").createImageData(region.width,region.height);region.imageData.data.set(fullData);region.pixels=region.imageData.data;region.updatePixels();if(this.density!==1){region.resize(w,h)}return region}},{key:"updatePixels",value:function updatePixels(){var gl=this.gl;this.colorP5Texture.bindTexture();var colorFormat=this._glColorFormat();var channels=colorFormat.format===gl.RGBA?4:3;var len=this.width*this.height*this.density*this.density*channels;var TypedArrayClass=colorFormat.type===gl.UNSIGNED_BYTE?Uint8Array:Float32Array;if(!(this.pixels instanceof TypedArrayClass)||this.pixels.length!==len){throw new Error("The pixels array has not been set correctly. Please call loadPixels() before updatePixels().")}gl.texImage2D(gl.TEXTURE_2D,0,colorFormat.internalFormat,this.width*this.density,this.height*this.density,0,colorFormat.format,colorFormat.type,this.pixels);this.colorP5Texture.unbindTexture();var prevFramebuffer=this.target._renderer.activeFramebuffer();if(this.antialias){this.begin();this.target.push();this.target.imageMode(this.target.CENTER);this.target.resetMatrix();this.target.noStroke();this.target.clear();this.target.image(this,0,0);this.target.pop();if(this.useDepth){gl.clearDepth(1);gl.clear(gl.DEPTH_BUFFER_BIT)}this.end()}else{gl.bindFramebuffer(gl.FRAMEBUFFER,this.framebuffer);if(this.useDepth){gl.clearDepth(1);gl.clear(gl.DEPTH_BUFFER_BIT)}if(prevFramebuffer){gl.bindFramebuffer(gl.FRAMEBUFFER,prevFramebuffer._framebufferToBind())}else{gl.bindFramebuffer(gl.FRAMEBUFFER,null)}}}}]);return Framebuffer}();_main.default.Framebuffer=Framebuffer;var _default=Framebuffer;exports.default=_default},{"../core/constants":286,"../core/main":298,"./p5.RendererGL":355,"./p5.Texture":357,"core-js/modules/es.array.fill":172,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.to-string":200,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.reflect.get":203,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.float32-array":229,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint8-array":252,"core-js/modules/es.typed-array.uint8-clamped-array":253,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],350:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.map");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.set");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.sub");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.for-each");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.map");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.set");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.sub");_dereq_("core-js/modules/web.dom-collections.for-each");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.Geometry=function(){function Geometry(detailX,detailY,callback){_classCallCheck(this,Geometry);this.vertices=[];this.lineVertices=new _main.default.DataArray;this.lineTangentsIn=new _main.default.DataArray;this.lineTangentsOut=new _main.default.DataArray;this.lineSides=new _main.default.DataArray;this.vertexNormals=[];this.faces=[];this.uvs=[];this.edges=[];this.vertexColors=[];this.vertexStrokeColors=[];this.lineVertexColors=new _main.default.DataArray;this.detailX=detailX!==undefined?detailX:1;this.detailY=detailY!==undefined?detailY:1;this.dirtyFlags={};if(callback instanceof Function){callback.call(this)}return this}_createClass(Geometry,[{key:"reset",value:function reset(){this.lineVertices.clear();this.lineTangentsIn.clear();this.lineTangentsOut.clear();this.lineSides.clear();this.vertices.length=0;this.edges.length=0;this.vertexColors.length=0;this.vertexStrokeColors.length=0;this.lineVertexColors.clear();this.vertexNormals.length=0;this.uvs.length=0;this.dirtyFlags={}}},{key:"clearColors",value:function clearColors(){this.vertexColors=[];return this}},{key:"computeFaces",value:function computeFaces(){this.faces.length=0;var sliceCount=this.detailX+1;var a,b,c,d;for(var i=0;i<this.detailY;i++){for(var j=0;j<this.detailX;j++){a=i*sliceCount+j;b=i*sliceCount+j+1;c=(i+1)*sliceCount+j+1;d=(i+1)*sliceCount+j;this.faces.push([a,b,d]);this.faces.push([d,b,c])}}return this}},{key:"_getFaceNormal",value:function _getFaceNormal(faceId){var face=this.faces[faceId];var vA=this.vertices[face[0]];var vB=this.vertices[face[1]];var vC=this.vertices[face[2]];var ab=_main.default.Vector.sub(vB,vA);var ac=_main.default.Vector.sub(vC,vA);var n=_main.default.Vector.cross(ab,ac);var ln=_main.default.Vector.mag(n);var sinAlpha=ln/(_main.default.Vector.mag(ab)*_main.default.Vector.mag(ac));if(sinAlpha===0||isNaN(sinAlpha)){console.warn("p5.Geometry.prototype._getFaceNormal:","face has colinear sides or a repeated vertex");return n}if(sinAlpha>1)sinAlpha=1;return n.mult(Math.asin(sinAlpha)/ln)}},{key:"computeNormals",value:function computeNormals(){var _this=this;var shadingType=arguments.length>0&&arguments[0]!==undefined?arguments[0]:constants.FLAT;var _ref=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref$roundToPrecision=_ref.roundToPrecision,roundToPrecision=_ref$roundToPrecision===void 0?3:_ref$roundToPrecision;var vertexNormals=this.vertexNormals;var vertices=this.vertices;var faces=this.faces;var iv;if(shadingType===constants.SMOOTH){var vertexIndices={};var uniqueVertices=[];var power=Math.pow(10,roundToPrecision);var rounded=function rounded(val){return Math.round(val*power)/power};var getKey=function getKey(vert){return"".concat(rounded(vert.x),",").concat(rounded(vert.y),",").concat(rounded(vert.z))};for(var i=0;i<vertices.length;i++){var vertex=vertices[i];var key=getKey(vertex);if(vertexIndices[key]===undefined){vertexIndices[key]=uniqueVertices.length;uniqueVertices.push(vertex)}}faces.forEach(function(face){for(var fv=0;fv<3;++fv){var originalVertexIndex=face[fv];var originalVertex=vertices[originalVertexIndex];var _key=getKey(originalVertex);face[fv]=vertexIndices[_key]}});this.edges.forEach(function(edge){for(var ev=0;ev<2;++ev){var originalVertexIndex=edge[ev];var originalVertex=vertices[originalVertexIndex];var _key2=getKey(originalVertex);edge[ev]=vertexIndices[_key2]}});this.vertices=vertices=uniqueVertices}vertexNormals.length=0;for(iv=0;iv<vertices.length;++iv){vertexNormals.push(new _main.default.Vector)}faces.forEach(function(face,f){var faceNormal=_this._getFaceNormal(f);for(var fv=0;fv<3;++fv){var vertexIndex=face[fv];vertexNormals[vertexIndex].add(faceNormal)}});for(iv=0;iv<vertices.length;++iv){vertexNormals[iv].normalize()}return this}},{key:"averageNormals",value:function averageNormals(){for(var i=0;i<=this.detailY;i++){var offset=this.detailX+1;var temp=_main.default.Vector.add(this.vertexNormals[i*offset],this.vertexNormals[i*offset+this.detailX]);temp=_main.default.Vector.div(temp,2);this.vertexNormals[i*offset]=temp;this.vertexNormals[i*offset+this.detailX]=temp}return this}},{key:"averagePoleNormals",value:function averagePoleNormals(){var sum=new _main.default.Vector(0,0,0);for(var i=0;i<this.detailX;i++){sum.add(this.vertexNormals[i])}sum=_main.default.Vector.div(sum,this.detailX);for(var _i=0;_i<this.detailX;_i++){this.vertexNormals[_i]=sum}sum=new _main.default.Vector(0,0,0);for(var _i2=this.vertices.length-1;_i2>this.vertices.length-1-this.detailX;_i2--){sum.add(this.vertexNormals[_i2])}sum=_main.default.Vector.div(sum,this.detailX);for(var _i3=this.vertices.length-1;_i3>this.vertices.length-1-this.detailX;_i3--){this.vertexNormals[_i3]=sum}return this}},{key:"_makeTriangleEdges",value:function _makeTriangleEdges(){this.edges.length=0;for(var j=0;j<this.faces.length;j++){this.edges.push([this.faces[j][0],this.faces[j][1]]);this.edges.push([this.faces[j][1],this.faces[j][2]]);this.edges.push([this.faces[j][2],this.faces[j][0]])}return this}},{key:"_edgesToVertices",value:function _edgesToVertices(){this.lineVertices.clear();this.lineTangentsIn.clear();this.lineTangentsOut.clear();this.lineSides.clear();var potentialCaps=new Map;var connected=new Set;var lastValidDir;for(var i=0;i<this.edges.length;i++){var prevEdge=this.edges[i-1];var currEdge=this.edges[i];var begin=this.vertices[currEdge[0]];var end=this.vertices[currEdge[1]];var fromColor=this.vertexStrokeColors.length>0?this.vertexStrokeColors.slice(currEdge[0]*4,(currEdge[0]+1)*4):[0,0,0,0];var toColor=this.vertexStrokeColors.length>0?this.vertexStrokeColors.slice(currEdge[1]*4,(currEdge[1]+1)*4):[0,0,0,0];var dir=end.copy().sub(begin).normalize();var dirOK=dir.magSq()>0;if(dirOK){this._addSegment(begin,end,fromColor,toColor,dir)}if(i>0&&prevEdge[1]===currEdge[0]){if(!connected.has(currEdge[0])){connected.add(currEdge[0]);potentialCaps.delete(currEdge[0]);if(lastValidDir&&dirOK&&dir.dot(lastValidDir)<1-1e-8){this._addJoin(begin,lastValidDir,dir,fromColor)}}}else{if(dirOK&&!connected.has(currEdge[0])){var existingCap=potentialCaps.get(currEdge[0]);if(existingCap){this._addJoin(begin,existingCap.dir,dir,fromColor);potentialCaps.delete(currEdge[0]);connected.add(currEdge[0])}else{potentialCaps.set(currEdge[0],{point:begin,dir:dir.copy().mult(-1),color:fromColor})}}if(lastValidDir&&!connected.has(prevEdge[1])){var _existingCap=potentialCaps.get(prevEdge[1]);if(_existingCap){this._addJoin(this.vertices[prevEdge[1]],lastValidDir,_existingCap.dir.copy().mult(-1),fromColor);potentialCaps.delete(prevEdge[1]);connected.add(prevEdge[1])}else{potentialCaps.set(prevEdge[1],{point:this.vertices[prevEdge[1]],dir:lastValidDir,color:fromColor})}lastValidDir=undefined}}if(i===this.edges.length-1&&!connected.has(currEdge[1])){var _existingCap2=potentialCaps.get(currEdge[1]);if(_existingCap2){this._addJoin(end,dir,_existingCap2.dir.copy().mult(-1),toColor);potentialCaps.delete(currEdge[1]);connected.add(currEdge[1])}else{potentialCaps.set(currEdge[1],{point:end,dir:dir,color:toColor})}}if(dirOK){lastValidDir=dir}}var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=potentialCaps.values()[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _step$value=_step.value,point=_step$value.point,_dir=_step$value.dir,color=_step$value.color;this._addCap(point,_dir,color)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return this}},{key:"_addSegment",value:function _addSegment(begin,end,fromColor,toColor,dir){var _this$lineVertices,_this$lineVertexColor;var a=begin.array();var b=end.array();var dirArr=dir.array();this.lineSides.push(1,1,-1,1,-1,-1);for(var _i4=0,_arr=[this.lineTangentsIn,this.lineTangentsOut];_i4<_arr.length;_i4++){var tangents=_arr[_i4];for(var i=0;i<6;i++){tangents.push.apply(tangents,_toConsumableArray(dirArr))}}(_this$lineVertices=this.lineVertices).push.apply(_this$lineVertices,_toConsumableArray(a).concat(_toConsumableArray(b),_toConsumableArray(a),_toConsumableArray(b),_toConsumableArray(b),_toConsumableArray(a)));(_this$lineVertexColor=this.lineVertexColors).push.apply(_this$lineVertexColor,_toConsumableArray(fromColor).concat(_toConsumableArray(toColor),_toConsumableArray(fromColor),_toConsumableArray(toColor),_toConsumableArray(toColor),_toConsumableArray(fromColor)));return this}},{key:"_addCap",value:function _addCap(point,tangent,color){var ptArray=point.array();var tanInArray=tangent.array();var tanOutArray=[0,0,0];for(var i=0;i<6;i++){var _this$lineVertices2,_this$lineTangentsIn,_this$lineTangentsOut,_this$lineVertexColor2;(_this$lineVertices2=this.lineVertices).push.apply(_this$lineVertices2,_toConsumableArray(ptArray));(_this$lineTangentsIn=this.lineTangentsIn).push.apply(_this$lineTangentsIn,_toConsumableArray(tanInArray));(_this$lineTangentsOut=this.lineTangentsOut).push.apply(_this$lineTangentsOut,tanOutArray);(_this$lineVertexColor2=this.lineVertexColors).push.apply(_this$lineVertexColor2,_toConsumableArray(color))}this.lineSides.push(-1,2,-2,1,2,-1);return this}},{key:"_addJoin",value:function _addJoin(point,fromTangent,toTangent,color){var ptArray=point.array();var tanInArray=fromTangent.array();var tanOutArray=toTangent.array();for(var i=0;i<12;i++){var _this$lineVertices3,_this$lineTangentsIn2,_this$lineTangentsOut2,_this$lineVertexColor3;(_this$lineVertices3=this.lineVertices).push.apply(_this$lineVertices3,_toConsumableArray(ptArray));(_this$lineTangentsIn2=this.lineTangentsIn).push.apply(_this$lineTangentsIn2,_toConsumableArray(tanInArray));(_this$lineTangentsOut2=this.lineTangentsOut).push.apply(_this$lineTangentsOut2,_toConsumableArray(tanOutArray));(_this$lineVertexColor3=this.lineVertexColors).push.apply(_this$lineVertexColor3,_toConsumableArray(color))}this.lineSides.push(-1,-3,-2,-1,0,-3);this.lineSides.push(3,1,2,3,0,1);return this}},{key:"normalize",value:function normalize(){if(this.vertices.length>0){var maxPosition=this.vertices[0].copy();var minPosition=this.vertices[0].copy();for(var i=0;i<this.vertices.length;i++){maxPosition.x=Math.max(maxPosition.x,this.vertices[i].x);minPosition.x=Math.min(minPosition.x,this.vertices[i].x);maxPosition.y=Math.max(maxPosition.y,this.vertices[i].y);minPosition.y=Math.min(minPosition.y,this.vertices[i].y);maxPosition.z=Math.max(maxPosition.z,this.vertices[i].z);minPosition.z=Math.min(minPosition.z,this.vertices[i].z)}var center=_main.default.Vector.lerp(maxPosition,minPosition,.5);var dist=_main.default.Vector.sub(maxPosition,minPosition);var longestDist=Math.max(Math.max(dist.x,dist.y),dist.z);var scale=200/longestDist;for(var _i5=0;_i5<this.vertices.length;_i5++){this.vertices[_i5].sub(center);this.vertices[_i5].mult(scale)}}return this}}]);return Geometry}();var _default=_main.default.Geometry;exports.default=_default},{"../core/constants":286,"../core/main":298,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.for-each":175,"core-js/modules/es.array.from":176,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.map":187,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.set":207,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.sub":218,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.for-each":255,"core-js/modules/web.dom-collections.iterator":256}],351:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var GLMAT_ARRAY_TYPE=Array;var isMatrixArray=function isMatrixArray(x){return Array.isArray(x)};if(typeof Float32Array!=="undefined"){GLMAT_ARRAY_TYPE=Float32Array;isMatrixArray=function isMatrixArray(x){return Array.isArray(x)||x instanceof Float32Array}}_main.default.Matrix=function(){function _class(){var _ref;_classCallCheck(this,_class);if(arguments.length&&(_ref=arguments.length-1,_ref<0||arguments.length<=_ref?undefined:arguments[_ref])instanceof _main.default){var _ref2;this.p5=(_ref2=arguments.length-1,_ref2<0||arguments.length<=_ref2?undefined:arguments[_ref2])}if((arguments.length<=0?undefined:arguments[0])==="mat3"){this.mat3=Array.isArray(arguments.length<=1?undefined:arguments[1])?arguments.length<=1?undefined:arguments[1]:new GLMAT_ARRAY_TYPE([1,0,0,0,1,0,0,0,1])}else{this.mat4=Array.isArray(arguments.length<=0?undefined:arguments[0])?arguments.length<=0?undefined:arguments[0]:new GLMAT_ARRAY_TYPE([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return this}_createClass(_class,[{key:"set",value:function set(inMatrix){if(inMatrix instanceof _main.default.Matrix){this.mat4=inMatrix.mat4;return this}else if(isMatrixArray(inMatrix)){this.mat4=inMatrix;return this}else if(arguments.length===16){this.mat4[0]=arguments[0];this.mat4[1]=arguments[1];this.mat4[2]=arguments[2];this.mat4[3]=arguments[3];this.mat4[4]=arguments[4];this.mat4[5]=arguments[5];this.mat4[6]=arguments[6];this.mat4[7]=arguments[7];this.mat4[8]=arguments[8];this.mat4[9]=arguments[9];this.mat4[10]=arguments[10];this.mat4[11]=arguments[11];this.mat4[12]=arguments[12];this.mat4[13]=arguments[13];this.mat4[14]=arguments[14];this.mat4[15]=arguments[15]}return this}},{key:"get",value:function get(){return new _main.default.Matrix(this.mat4,this.p5)}},{key:"copy",value:function copy(){if(this.mat3!==undefined){var copied3x3=new _main.default.Matrix("mat3",this.p5);copied3x3.mat3[0]=this.mat3[0];copied3x3.mat3[1]=this.mat3[1];copied3x3.mat3[2]=this.mat3[2];copied3x3.mat3[3]=this.mat3[3];copied3x3.mat3[4]=this.mat3[4];copied3x3.mat3[5]=this.mat3[5];copied3x3.mat3[6]=this.mat3[6];copied3x3.mat3[7]=this.mat3[7];copied3x3.mat3[8]=this.mat3[8];return copied3x3}var copied=new _main.default.Matrix(this.p5);copied.mat4[0]=this.mat4[0];copied.mat4[1]=this.mat4[1];copied.mat4[2]=this.mat4[2];copied.mat4[3]=this.mat4[3];copied.mat4[4]=this.mat4[4];copied.mat4[5]=this.mat4[5];copied.mat4[6]=this.mat4[6];copied.mat4[7]=this.mat4[7];copied.mat4[8]=this.mat4[8];copied.mat4[9]=this.mat4[9];copied.mat4[10]=this.mat4[10];copied.mat4[11]=this.mat4[11];copied.mat4[12]=this.mat4[12];copied.mat4[13]=this.mat4[13];copied.mat4[14]=this.mat4[14];copied.mat4[15]=this.mat4[15];return copied}},{key:"transpose",value:function transpose(a){var a01,a02,a03,a12,a13,a23;if(a instanceof _main.default.Matrix){a01=a.mat4[1];a02=a.mat4[2];a03=a.mat4[3];a12=a.mat4[6];a13=a.mat4[7];a23=a.mat4[11];this.mat4[0]=a.mat4[0];this.mat4[1]=a.mat4[4];this.mat4[2]=a.mat4[8];this.mat4[3]=a.mat4[12];this.mat4[4]=a01;this.mat4[5]=a.mat4[5];this.mat4[6]=a.mat4[9];this.mat4[7]=a.mat4[13];this.mat4[8]=a02;this.mat4[9]=a12;this.mat4[10]=a.mat4[10];this.mat4[11]=a.mat4[14];this.mat4[12]=a03;this.mat4[13]=a13;this.mat4[14]=a23;this.mat4[15]=a.mat4[15]}else if(isMatrixArray(a)){a01=a[1];a02=a[2];a03=a[3];a12=a[6];a13=a[7];a23=a[11];this.mat4[0]=a[0];this.mat4[1]=a[4];this.mat4[2]=a[8];this.mat4[3]=a[12];this.mat4[4]=a01;this.mat4[5]=a[5];this.mat4[6]=a[9];this.mat4[7]=a[13];this.mat4[8]=a02;this.mat4[9]=a12;this.mat4[10]=a[10];this.mat4[11]=a[14];this.mat4[12]=a03;this.mat4[13]=a13;this.mat4[14]=a23;this.mat4[15]=a[15]}return this}},{key:"invert",value:function invert(a){var a00,a01,a02,a03,a10,a11,a12,a13;var a20,a21,a22,a23,a30,a31,a32,a33;if(a instanceof _main.default.Matrix){a00=a.mat4[0];a01=a.mat4[1];a02=a.mat4[2];a03=a.mat4[3];a10=a.mat4[4];a11=a.mat4[5];a12=a.mat4[6];a13=a.mat4[7];a20=a.mat4[8];a21=a.mat4[9];a22=a.mat4[10];a23=a.mat4[11];a30=a.mat4[12];a31=a.mat4[13];a32=a.mat4[14];a33=a.mat4[15]}else if(isMatrixArray(a)){a00=a[0];a01=a[1];a02=a[2];a03=a[3];a10=a[4];a11=a[5];a12=a[6];a13=a[7];a20=a[8];a21=a[9];a22=a[10];a23=a[11];a30=a[12];a31=a[13];a32=a[14];a33=a[15]}var b00=a00*a11-a01*a10;var b01=a00*a12-a02*a10;var b02=a00*a13-a03*a10;var b03=a01*a12-a02*a11;var b04=a01*a13-a03*a11;var b05=a02*a13-a03*a12;var b06=a20*a31-a21*a30;var b07=a20*a32-a22*a30;var b08=a20*a33-a23*a30;var b09=a21*a32-a22*a31;var b10=a21*a33-a23*a31;var b11=a22*a33-a23*a32;var det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det){return null}det=1/det;this.mat4[0]=(a11*b11-a12*b10+a13*b09)*det;this.mat4[1]=(a02*b10-a01*b11-a03*b09)*det;this.mat4[2]=(a31*b05-a32*b04+a33*b03)*det;this.mat4[3]=(a22*b04-a21*b05-a23*b03)*det;this.mat4[4]=(a12*b08-a10*b11-a13*b07)*det;this.mat4[5]=(a00*b11-a02*b08+a03*b07)*det;this.mat4[6]=(a32*b02-a30*b05-a33*b01)*det;this.mat4[7]=(a20*b05-a22*b02+a23*b01)*det;this.mat4[8]=(a10*b10-a11*b08+a13*b06)*det;this.mat4[9]=(a01*b08-a00*b10-a03*b06)*det;this.mat4[10]=(a30*b04-a31*b02+a33*b00)*det;this.mat4[11]=(a21*b02-a20*b04-a23*b00)*det;this.mat4[12]=(a11*b07-a10*b09-a12*b06)*det;this.mat4[13]=(a00*b09-a01*b07+a02*b06)*det;this.mat4[14]=(a31*b01-a30*b03-a32*b00)*det;this.mat4[15]=(a20*b03-a21*b01+a22*b00)*det;return this}},{key:"invert3x3",value:function invert3x3(){var a00=this.mat3[0];var a01=this.mat3[1];var a02=this.mat3[2];var a10=this.mat3[3];var a11=this.mat3[4];var a12=this.mat3[5];var a20=this.mat3[6];var a21=this.mat3[7];var a22=this.mat3[8];var b01=a22*a11-a12*a21;var b11=-a22*a10+a12*a20;var b21=a21*a10-a11*a20;var det=a00*b01+a01*b11+a02*b21;if(!det){return null}det=1/det;this.mat3[0]=b01*det;this.mat3[1]=(-a22*a01+a02*a21)*det;this.mat3[2]=(a12*a01-a02*a11)*det;this.mat3[3]=b11*det;this.mat3[4]=(a22*a00-a02*a20)*det;this.mat3[5]=(-a12*a00+a02*a10)*det;this.mat3[6]=b21*det;this.mat3[7]=(-a21*a00+a01*a20)*det;this.mat3[8]=(a11*a00-a01*a10)*det;return this}},{key:"transpose3x3",value:function transpose3x3(mat3){if(mat3===undefined){mat3=this.mat3}var a01=mat3[1];var a02=mat3[2];var a12=mat3[5];this.mat3[0]=mat3[0];this.mat3[1]=mat3[3];this.mat3[2]=mat3[6];this.mat3[3]=a01;this.mat3[4]=mat3[4];this.mat3[5]=mat3[7];this.mat3[6]=a02;this.mat3[7]=a12;this.mat3[8]=mat3[8];return this}},{key:"inverseTranspose",value:function inverseTranspose(_ref3){var mat4=_ref3.mat4;if(this.mat3===undefined){_main.default._friendlyError("sorry, this function only works with mat3")}else{this.mat3[0]=mat4[0];this.mat3[1]=mat4[1];this.mat3[2]=mat4[2];this.mat3[3]=mat4[4];this.mat3[4]=mat4[5];this.mat3[5]=mat4[6];this.mat3[6]=mat4[8];this.mat3[7]=mat4[9];this.mat3[8]=mat4[10]}var inverse=this.invert3x3();if(inverse){inverse.transpose3x3(this.mat3)}else{for(var i=0;i<9;i++){this.mat3[i]=0}}return this}},{key:"determinant",value:function determinant(){var d00=this.mat4[0]*this.mat4[5]-this.mat4[1]*this.mat4[4],d01=this.mat4[0]*this.mat4[6]-this.mat4[2]*this.mat4[4],d02=this.mat4[0]*this.mat4[7]-this.mat4[3]*this.mat4[4],d03=this.mat4[1]*this.mat4[6]-this.mat4[2]*this.mat4[5],d04=this.mat4[1]*this.mat4[7]-this.mat4[3]*this.mat4[5],d05=this.mat4[2]*this.mat4[7]-this.mat4[3]*this.mat4[6],d06=this.mat4[8]*this.mat4[13]-this.mat4[9]*this.mat4[12],d07=this.mat4[8]*this.mat4[14]-this.mat4[10]*this.mat4[12],d08=this.mat4[8]*this.mat4[15]-this.mat4[11]*this.mat4[12],d09=this.mat4[9]*this.mat4[14]-this.mat4[10]*this.mat4[13],d10=this.mat4[9]*this.mat4[15]-this.mat4[11]*this.mat4[13],d11=this.mat4[10]*this.mat4[15]-this.mat4[11]*this.mat4[14];return d00*d11-d01*d10+d02*d09+d03*d08-d04*d07+d05*d06}},{key:"mult",value:function mult(multMatrix){var _src;if(multMatrix===this||multMatrix===this.mat4){_src=this.copy().mat4}else if(multMatrix instanceof _main.default.Matrix){_src=multMatrix.mat4}else if(isMatrixArray(multMatrix)){_src=multMatrix}else if(arguments.length===16){_src=arguments}else{return}var b0=this.mat4[0],b1=this.mat4[1],b2=this.mat4[2],b3=this.mat4[3];this.mat4[0]=b0*_src[0]+b1*_src[4]+b2*_src[8]+b3*_src[12];this.mat4[1]=b0*_src[1]+b1*_src[5]+b2*_src[9]+b3*_src[13];this.mat4[2]=b0*_src[2]+b1*_src[6]+b2*_src[10]+b3*_src[14];this.mat4[3]=b0*_src[3]+b1*_src[7]+b2*_src[11]+b3*_src[15];b0=this.mat4[4];b1=this.mat4[5];b2=this.mat4[6];b3=this.mat4[7];this.mat4[4]=b0*_src[0]+b1*_src[4]+b2*_src[8]+b3*_src[12];this.mat4[5]=b0*_src[1]+b1*_src[5]+b2*_src[9]+b3*_src[13];this.mat4[6]=b0*_src[2]+b1*_src[6]+b2*_src[10]+b3*_src[14];this.mat4[7]=b0*_src[3]+b1*_src[7]+b2*_src[11]+b3*_src[15];b0=this.mat4[8];b1=this.mat4[9];b2=this.mat4[10];b3=this.mat4[11];this.mat4[8]=b0*_src[0]+b1*_src[4]+b2*_src[8]+b3*_src[12];this.mat4[9]=b0*_src[1]+b1*_src[5]+b2*_src[9]+b3*_src[13];this.mat4[10]=b0*_src[2]+b1*_src[6]+b2*_src[10]+b3*_src[14];this.mat4[11]=b0*_src[3]+b1*_src[7]+b2*_src[11]+b3*_src[15];b0=this.mat4[12];b1=this.mat4[13];b2=this.mat4[14];b3=this.mat4[15];this.mat4[12]=b0*_src[0]+b1*_src[4]+b2*_src[8]+b3*_src[12];this.mat4[13]=b0*_src[1]+b1*_src[5]+b2*_src[9]+b3*_src[13];this.mat4[14]=b0*_src[2]+b1*_src[6]+b2*_src[10]+b3*_src[14];this.mat4[15]=b0*_src[3]+b1*_src[7]+b2*_src[11]+b3*_src[15];return this}},{key:"apply",value:function apply(multMatrix){var _src;if(multMatrix===this||multMatrix===this.mat4){_src=this.copy().mat4}else if(multMatrix instanceof _main.default.Matrix){_src=multMatrix.mat4}else if(isMatrixArray(multMatrix)){_src=multMatrix}else if(arguments.length===16){_src=arguments}else{return}var mat4=this.mat4;var m0=mat4[0];var m4=mat4[4];var m8=mat4[8];var m12=mat4[12];mat4[0]=_src[0]*m0+_src[1]*m4+_src[2]*m8+_src[3]*m12;mat4[4]=_src[4]*m0+_src[5]*m4+_src[6]*m8+_src[7]*m12;mat4[8]=_src[8]*m0+_src[9]*m4+_src[10]*m8+_src[11]*m12;mat4[12]=_src[12]*m0+_src[13]*m4+_src[14]*m8+_src[15]*m12;var m1=mat4[1];var m5=mat4[5];var m9=mat4[9];var m13=mat4[13];mat4[1]=_src[0]*m1+_src[1]*m5+_src[2]*m9+_src[3]*m13;mat4[5]=_src[4]*m1+_src[5]*m5+_src[6]*m9+_src[7]*m13;mat4[9]=_src[8]*m1+_src[9]*m5+_src[10]*m9+_src[11]*m13;mat4[13]=_src[12]*m1+_src[13]*m5+_src[14]*m9+_src[15]*m13;var m2=mat4[2];var m6=mat4[6];var m10=mat4[10];var m14=mat4[14];mat4[2]=_src[0]*m2+_src[1]*m6+_src[2]*m10+_src[3]*m14;mat4[6]=_src[4]*m2+_src[5]*m6+_src[6]*m10+_src[7]*m14;mat4[10]=_src[8]*m2+_src[9]*m6+_src[10]*m10+_src[11]*m14;mat4[14]=_src[12]*m2+_src[13]*m6+_src[14]*m10+_src[15]*m14;var m3=mat4[3];var m7=mat4[7];var m11=mat4[11];var m15=mat4[15];mat4[3]=_src[0]*m3+_src[1]*m7+_src[2]*m11+_src[3]*m15;mat4[7]=_src[4]*m3+_src[5]*m7+_src[6]*m11+_src[7]*m15;mat4[11]=_src[8]*m3+_src[9]*m7+_src[10]*m11+_src[11]*m15;mat4[15]=_src[12]*m3+_src[13]*m7+_src[14]*m11+_src[15]*m15;return this}},{key:"scale",value:function scale(x,y,z){if(x instanceof _main.default.Vector){y=x.y;z=x.z;x=x.x}else if(x instanceof Array){y=x[1];z=x[2];x=x[0]}this.mat4[0]*=x;this.mat4[1]*=x;this.mat4[2]*=x;this.mat4[3]*=x;this.mat4[4]*=y;this.mat4[5]*=y;this.mat4[6]*=y;this.mat4[7]*=y;this.mat4[8]*=z;this.mat4[9]*=z;this.mat4[10]*=z;this.mat4[11]*=z;return this}},{key:"rotate",value:function rotate(a,x,y,z){if(x instanceof _main.default.Vector){y=x.y;z=x.z;x=x.x}else if(x instanceof Array){y=x[1];z=x[2];x=x[0]}var len=Math.sqrt(x*x+y*y+z*z);x*=1/len;y*=1/len;z*=1/len;var a00=this.mat4[0];var a01=this.mat4[1];var a02=this.mat4[2];var a03=this.mat4[3];var a10=this.mat4[4];var a11=this.mat4[5];var a12=this.mat4[6];var a13=this.mat4[7];var a20=this.mat4[8];var a21=this.mat4[9];var a22=this.mat4[10];var a23=this.mat4[11];var sA=Math.sin(a);var cA=Math.cos(a);var tA=1-cA;var b00=x*x*tA+cA;var b01=y*x*tA+z*sA;var b02=z*x*tA-y*sA;var b10=x*y*tA-z*sA;var b11=y*y*tA+cA;var b12=z*y*tA+x*sA;var b20=x*z*tA+y*sA;var b21=y*z*tA-x*sA;var b22=z*z*tA+cA;this.mat4[0]=a00*b00+a10*b01+a20*b02;this.mat4[1]=a01*b00+a11*b01+a21*b02;this.mat4[2]=a02*b00+a12*b01+a22*b02;this.mat4[3]=a03*b00+a13*b01+a23*b02;this.mat4[4]=a00*b10+a10*b11+a20*b12;this.mat4[5]=a01*b10+a11*b11+a21*b12;this.mat4[6]=a02*b10+a12*b11+a22*b12;this.mat4[7]=a03*b10+a13*b11+a23*b12;this.mat4[8]=a00*b20+a10*b21+a20*b22;this.mat4[9]=a01*b20+a11*b21+a21*b22;this.mat4[10]=a02*b20+a12*b21+a22*b22;this.mat4[11]=a03*b20+a13*b21+a23*b22;return this}},{key:"translate",value:function translate(v){var x=v[0],y=v[1],z=v[2]||0;this.mat4[12]+=this.mat4[0]*x+this.mat4[4]*y+this.mat4[8]*z;this.mat4[13]+=this.mat4[1]*x+this.mat4[5]*y+this.mat4[9]*z;this.mat4[14]+=this.mat4[2]*x+this.mat4[6]*y+this.mat4[10]*z;this.mat4[15]+=this.mat4[3]*x+this.mat4[7]*y+this.mat4[11]*z}},{key:"rotateX",value:function rotateX(a){this.rotate(a,1,0,0)}},{key:"rotateY",value:function rotateY(a){this.rotate(a,0,1,0)}},{key:"rotateZ",value:function rotateZ(a){this.rotate(a,0,0,1)}},{key:"perspective",value:function perspective(fovy,aspect,near,far){var f=1/Math.tan(fovy/2),nf=1/(near-far);this.mat4[0]=f/aspect;this.mat4[1]=0;this.mat4[2]=0;this.mat4[3]=0;this.mat4[4]=0;this.mat4[5]=f;this.mat4[6]=0;this.mat4[7]=0;this.mat4[8]=0;this.mat4[9]=0;this.mat4[10]=(far+near)*nf;this.mat4[11]=-1;this.mat4[12]=0;this.mat4[13]=0;this.mat4[14]=2*far*near*nf;this.mat4[15]=0;return this}},{key:"ortho",value:function ortho(left,right,bottom,top,near,far){var lr=1/(left-right),bt=1/(bottom-top),nf=1/(near-far);this.mat4[0]=-2*lr;this.mat4[1]=0;this.mat4[2]=0;this.mat4[3]=0;this.mat4[4]=0;this.mat4[5]=-2*bt;this.mat4[6]=0;this.mat4[7]=0;this.mat4[8]=0;this.mat4[9]=0;this.mat4[10]=2*nf;this.mat4[11]=0;this.mat4[12]=(left+right)*lr;this.mat4[13]=(top+bottom)*bt;this.mat4[14]=(far+near)*nf;this.mat4[15]=1;return this}},{key:"multiplyVec4",value:function multiplyVec4(x,y,z,w){var result=new Array(4);var m=this.mat4;result[0]=m[0]*x+m[4]*y+m[8]*z+m[12]*w;result[1]=m[1]*x+m[5]*y+m[9]*z+m[13]*w;result[2]=m[2]*x+m[6]*y+m[10]*z+m[14]*w;result[3]=m[3]*x+m[7]*y+m[11]*z+m[15]*w;return result}},{key:"multiplyPoint",value:function multiplyPoint(_ref4){var x=_ref4.x,y=_ref4.y,z=_ref4.z;var array=this.multiplyVec4(x,y,z,1);return new _main.default.Vector(array[0],array[1],array[2])}},{key:"multiplyAndNormalizePoint",value:function multiplyAndNormalizePoint(_ref5){var x=_ref5.x,y=_ref5.y,z=_ref5.z;var array=this.multiplyVec4(x,y,z,1);array[0]/=array[3];array[1]/=array[3];array[2]/=array[3];return new _main.default.Vector(array[0],array[1],array[2])}},{key:"multiplyDirection",value:function multiplyDirection(_ref6){var x=_ref6.x,y=_ref6.y,z=_ref6.z;var array=this.multiplyVec4(x,y,z,0);return new _main.default.Vector(array[0],array[1],array[2])}},{key:"mult3x3",value:function mult3x3(multMatrix){var _src;if(multMatrix===this||multMatrix===this.mat3){_src=this.copy().mat3}else if(multMatrix instanceof _main.default.Matrix){_src=multMatrix.mat3}else if(isMatrixArray(multMatrix)){_src=multMatrix}else if(arguments.length===9){_src=arguments}else{return}var b0=this.mat3[0];var b1=this.mat3[1];var b2=this.mat3[2];this.mat3[0]=b0*_src[0]+b1*_src[3]+b2*_src[6];this.mat3[1]=b0*_src[1]+b1*_src[4]+b2*_src[7];this.mat3[2]=b0*_src[2]+b1*_src[5]+b2*_src[8];b0=this.mat3[3];b1=this.mat3[4];b2=this.mat3[5];this.mat3[3]=b0*_src[0]+b1*_src[3]+b2*_src[6];this.mat3[4]=b0*_src[1]+b1*_src[4]+b2*_src[7];this.mat3[5]=b0*_src[2]+b1*_src[5]+b2*_src[8];b0=this.mat3[6];b1=this.mat3[7];b2=this.mat3[8];this.mat3[6]=b0*_src[0]+b1*_src[3]+b2*_src[6];this.mat3[7]=b0*_src[1]+b1*_src[4]+b2*_src[7];this.mat3[8]=b0*_src[2]+b1*_src[5]+b2*_src[8];return this}},{key:"column",value:function column(columnIndex){return new _main.default.Vector(this.mat3[3*columnIndex],this.mat3[3*columnIndex+1],this.mat3[3*columnIndex+2])}},{key:"row",value:function row(rowIndex){return new _main.default.Vector(this.mat3[rowIndex],this.mat3[rowIndex+3],this.mat3[rowIndex+6])}},{key:"diagonal",value:function diagonal(){if(this.mat3!==undefined){return[this.mat3[0],this.mat3[4],this.mat3[8]]}return[this.mat4[0],this.mat4[5],this.mat4[10],this.mat4[15]]}},{key:"multiplyVec3",value:function multiplyVec3(multVector,target){if(target===undefined){target=multVector.copy()}target.x=this.row(0).dot(multVector);target.y=this.row(1).dot(multVector);target.z=this.row(2).dot(multVector);return target}},{key:"createSubMatrix3x3",value:function createSubMatrix3x3(){var result=new _main.default.Matrix("mat3");result.mat3[0]=this.mat4[0];result.mat3[1]=this.mat4[1];result.mat3[2]=this.mat4[2];result.mat3[3]=this.mat4[4];result.mat3[4]=this.mat4[5];result.mat3[5]=this.mat4[6];result.mat3[6]=this.mat4[8];result.mat3[7]=this.mat4[9];result.mat3[8]=this.mat4[10];return result}}],[{key:"identity",value:function identity(pInst){return new _main.default.Matrix(pInst)}}]);return _class}();var _default=_main.default.Matrix;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.to-string":200,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.float32-array":229,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249}],352:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.map");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.RenderBuffer=function(){function _class(size,src,dst,attr,renderer,map){_classCallCheck(this,_class);this.size=size;this.src=src;this.dst=dst;this.attr=attr;this._renderer=renderer;this.map=map}_createClass(_class,[{key:"_prepareBuffer",value:function _prepareBuffer(geometry,shader){var attributes=shader.attributes;var gl=this._renderer.GL;var model;if(geometry.model){model=geometry.model}else{model=geometry}var attr=attributes[this.attr];if(!attr){return}var buffer=geometry[this.dst];var src=model[this.src];if(src.length>0){var createBuffer=!buffer;if(createBuffer){geometry[this.dst]=buffer=gl.createBuffer()}gl.bindBuffer(gl.ARRAY_BUFFER,buffer);if(createBuffer||model.dirtyFlags[this.src]!==false){var map=this.map;var values=map?map(src):src;this._renderer._bindBuffer(buffer,gl.ARRAY_BUFFER,values);model.dirtyFlags[this.src]=false}shader.enableAttrib(attr,this.size)}else{var loc=attr.location;if(loc===-1||!this._renderer.registerEnabled.has(loc)){return}gl.disableVertexAttribArray(loc);this._renderer.registerEnabled.delete(loc)}}}]);return _class}();var _default=_main.default.RenderBuffer;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.map":182}],353:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.find-index");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.map");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.find-index");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.map");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.map");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));_dereq_("./p5.RenderBuffer");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}_main.default.RendererGL.prototype.beginShape=function(mode){this.immediateMode.shapeMode=mode!==undefined?mode:constants.TESS;this.immediateMode.geometry.reset();this.immediateMode.contourIndices=[];return this};var immediateBufferStrides={vertices:1,vertexNormals:1,vertexColors:4,vertexStrokeColors:4,uvs:2};_main.default.RendererGL.prototype.beginContour=function(){if(this.immediateMode.shapeMode!==constants.TESS){throw new Error("WebGL mode can only use contours with beginShape(TESS).")}this.immediateMode.contourIndices.push(this.immediateMode.geometry.vertices.length)};_main.default.RendererGL.prototype.vertex=function(x,y){if(this.immediateMode.shapeMode===constants.QUADS){if(this.immediateMode.geometry.vertices.length%6===3){for(var key in immediateBufferStrides){var stride=immediateBufferStrides[key];var buffer=this.immediateMode.geometry[key];buffer.push.apply(buffer,_toConsumableArray(buffer.slice(buffer.length-3*stride,buffer.length-2*stride)).concat(_toConsumableArray(buffer.slice(buffer.length-stride,buffer.length))))}}}var z,u,v;z=u=v=0;if(arguments.length===3){z=arguments[2]}else if(arguments.length===4){u=arguments[2];v=arguments[3]}else if(arguments.length===5){z=arguments[2];u=arguments[3];v=arguments[4]}var vert=new _main.default.Vector(x,y,z);this.immediateMode.geometry.vertices.push(vert);this.immediateMode.geometry.vertexNormals.push(this._currentNormal);var vertexColor=this.curFillColor||[.5,.5,.5,1];this.immediateMode.geometry.vertexColors.push(vertexColor[0],vertexColor[1],vertexColor[2],vertexColor[3]);var lineVertexColor=this.curStrokeColor||[.5,.5,.5,1];this.immediateMode.geometry.vertexStrokeColors.push(lineVertexColor[0],lineVertexColor[1],lineVertexColor[2],lineVertexColor[3]);if(this.textureMode===constants.IMAGE&&!this.isProcessingVertices){if(this._tex!==null){if(this._tex.width>0&&this._tex.height>0){u/=this._tex.width;v/=this._tex.height}}else if(this.userFillShader!==undefined||this.userStrokeShader!==undefined||this.userPointShader!==undefined){}else if(this._tex===null&&arguments.length>=4){console.warn("You must first call texture() before using"+" vertex() with image based u and v coordinates")}}this.immediateMode.geometry.uvs.push(u,v);this.immediateMode._bezierVertex[0]=x;this.immediateMode._bezierVertex[1]=y;this.immediateMode._bezierVertex[2]=z;this.immediateMode._quadraticVertex[0]=x;this.immediateMode._quadraticVertex[1]=y;this.immediateMode._quadraticVertex[2]=z;return this};_main.default.RendererGL.prototype.normal=function(xorv,y,z){if(xorv instanceof _main.default.Vector){this._currentNormal=xorv}else{this._currentNormal=new _main.default.Vector(xorv,y,z)}return this};_main.default.RendererGL.prototype.endShape=function(mode,isCurve,isBezier,isQuadratic,isContour,shapeKind){var count=arguments.length>6&&arguments[6]!==undefined?arguments[6]:1;if(this.immediateMode.shapeMode===constants.POINTS){this._drawPoints(this.immediateMode.geometry.vertices,this.immediateMode.buffers.point);return this}if(this.immediateMode.geometry.vertices.length===3&&this.immediateMode.shapeMode===constants.TESS){this.immediateMode.shapeMode===constants.TRIANGLES}this.isProcessingVertices=true;this._processVertices.apply(this,arguments);this.isProcessingVertices=false;if(this.immediateMode.shapeMode===constants.LINE_STRIP||this.immediateMode.shapeMode===constants.LINES){this.immediateMode.shapeMode=constants.TRIANGLE_FAN}if(this.immediateMode.shapeMode===constants.QUADS){this.immediateMode.shapeMode=constants.TRIANGLES}else if(this.immediateMode.shapeMode===constants.QUAD_STRIP){this.immediateMode.shapeMode=constants.TRIANGLE_STRIP}if(this._doFill){if(!this.geometryBuilder&&this.immediateMode.geometry.vertices.length>=3){this._drawImmediateFill(count)}}if(this._doStroke){if(!this.geometryBuilder&&this.immediateMode.geometry.lineVertices.length>=1){this._drawImmediateStroke()}}if(this.geometryBuilder){this.geometryBuilder.addImmediate()}this.isBezier=false;this.isQuadratic=false;this.isCurve=false;this.immediateMode._bezierVertex.length=0;this.immediateMode._quadraticVertex.length=0;this.immediateMode._curveVertex.length=0;return this};_main.default.RendererGL.prototype._processVertices=function(mode){if(this.immediateMode.geometry.vertices.length===0)return;var calculateStroke=this._doStroke;var shouldClose=mode===constants.CLOSE;if(calculateStroke){this.immediateMode.geometry.edges=this._calculateEdges(this.immediateMode.shapeMode,this.immediateMode.geometry.vertices,shouldClose);if(!this.geometryBuilder){this.immediateMode.geometry._edgesToVertices()}}var convexShape=this.immediateMode.shapeMode===constants.TESS;var hasContour=this.immediateMode.contourIndices.length>0;var shouldTess=this._doFill&&(this.isBezier||this.isQuadratic||this.isCurve||convexShape||hasContour)&&this.immediateMode.shapeMode!==constants.LINES;if(shouldTess){this._tesselateShape()}};_main.default.RendererGL.prototype._calculateEdges=function(shapeMode,verts,shouldClose){var res=[];var i=0;var contourIndices=this.immediateMode.contourIndices.slice();var contourStart=0;switch(shapeMode){case constants.TRIANGLE_STRIP:for(i=0;i<verts.length-2;i++){res.push([i,i+1]);res.push([i,i+2])}res.push([i,i+1]);break;case constants.TRIANGLE_FAN:for(i=1;i<verts.length-1;i++){res.push([0,i]);res.push([i,i+1])}res.push([0,verts.length-1]);break;case constants.TRIANGLES:for(i=0;i<verts.length-2;i=i+3){res.push([i,i+1]);res.push([i+1,i+2]);res.push([i+2,i])}break;case constants.LINES:for(i=0;i<verts.length-1;i=i+2){res.push([i,i+1])}break;case constants.QUADS:for(i=0;i<verts.length-5;i+=6){res.push([i,i+1]);res.push([i+1,i+2]);res.push([i+3,i+5]);res.push([i+4,i+5])}break;case constants.QUAD_STRIP:for(i=0;i<verts.length-2;i+=2){res.push([i,i+1]);res.push([i,i+2]);res.push([i+1,i+3])}res.push([i,i+1]);break;default:for(i=0;i<verts.length;i++){if(i+1<verts.length&&i+1!==contourIndices[0]){res.push([i,i+1])}else{if(shouldClose||contourStart){res.push([i,contourStart])}if(contourIndices.length>0){contourStart=contourIndices.shift()}}}break}if(shapeMode!==constants.TESS&&shouldClose){res.push([verts.length-1,0])}return res};_main.default.RendererGL.prototype._tesselateShape=function(){var _this=this;this.immediateMode.shapeMode=constants.TRIANGLES;var contours=[[]];for(var i=0;i<this.immediateMode.geometry.vertices.length;i++){if(this.immediateMode.contourIndices.length>0&&this.immediateMode.contourIndices[0]===i){this.immediateMode.contourIndices.shift();contours.push([])}contours[contours.length-1].push(this.immediateMode.geometry.vertices[i].x,this.immediateMode.geometry.vertices[i].y,this.immediateMode.geometry.vertices[i].z,this.immediateMode.geometry.uvs[i*2],this.immediateMode.geometry.uvs[i*2+1],this.immediateMode.geometry.vertexColors[i*4],this.immediateMode.geometry.vertexColors[i*4+1],this.immediateMode.geometry.vertexColors[i*4+2],this.immediateMode.geometry.vertexColors[i*4+3],this.immediateMode.geometry.vertexNormals[i].x,this.immediateMode.geometry.vertexNormals[i].y,this.immediateMode.geometry.vertexNormals[i].z)}var polyTriangles=this._triangulate(contours);var originalVertices=this.immediateMode.geometry.vertices;this.immediateMode.geometry.vertices=[];this.immediateMode.geometry.vertexNormals=[];this.immediateMode.geometry.uvs=[];var colors=[];for(var j=0,polyTriLength=polyTriangles.length;j<polyTriLength;j=j+_main.default.RendererGL.prototype.tessyVertexSize){colors.push.apply(colors,_toConsumableArray(polyTriangles.slice(j+5,j+9)));this.normal.apply(this,_toConsumableArray(polyTriangles.slice(j+9,j+12)));this.vertex.apply(this,_toConsumableArray(polyTriangles.slice(j,j+5)))}if(this.geometryBuilder){var newIndex=new Map;this.immediateMode.geometry.edges=this.immediateMode.geometry.edges.map(function(edge){return edge.map(function(origIdx){if(!newIndex.has(origIdx)){var orig=originalVertices[origIdx];var newVertIndex=_this.immediateMode.geometry.vertices.findIndex(function(v){return orig.x===v.x&&orig.y===v.y&&orig.z===v.z});if(newVertIndex===-1){var closestDist=Infinity;var closestIndex=0;for(var _i=0;_i<_this.immediateMode.geometry.vertices.length;_i++){var vert=_this.immediateMode.geometry.vertices[_i];var dX=orig.x-vert.x;var dY=orig.y-vert.y;var dZ=orig.z-vert.z;var dist=dX*dX+dY*dY+dZ*dZ;if(dist<closestDist){closestDist=dist;closestIndex=_i}}newVertIndex=closestIndex}newIndex.set(origIdx,newVertIndex)}return newIndex.get(origIdx)})})}this.immediateMode.geometry.vertexColors=colors};_main.default.RendererGL.prototype._drawImmediateFill=function(){var count=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var gl=this.GL;this._useVertexColor=this.immediateMode.geometry.vertexColors.length>0;var shader;shader=this._getImmediateFillShader();this._setFillUniforms(shader);var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.immediateMode.buffers.fill[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var buff=_step.value;buff._prepareBuffer(this.immediateMode.geometry,shader)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}shader.disableRemainingAttributes();this._applyColorBlend(this.curFillColor);if(count===1){gl.drawArrays(this.immediateMode.shapeMode,0,this.immediateMode.geometry.vertices.length)}else{try{gl.drawArraysInstanced(this.immediateMode.shapeMode,0,this.immediateMode.geometry.vertices.length,count)}catch(e){console.log("🌸 p5.js says: Instancing is only supported in WebGL2 mode")}}shader.unbindShader()};_main.default.RendererGL.prototype._drawImmediateStroke=function(){var gl=this.GL;this._useLineColor=this.immediateMode.geometry.vertexStrokeColors.length>0;var shader=this._getImmediateStrokeShader();this._setStrokeUniforms(shader);var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.immediateMode.buffers.stroke[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var buff=_step2.value;buff._prepareBuffer(this.immediateMode.geometry,shader)}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}shader.disableRemainingAttributes();this._applyColorBlend(this.curStrokeColor);gl.drawArrays(gl.TRIANGLES,0,this.immediateMode.geometry.lineVertices.length/3);shader.unbindShader()};var _default=_main.default.RendererGL;exports.default=_default},{"../core/constants":286,"../core/main":298,"./p5.RenderBuffer":352,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.fill":172,"core-js/modules/es.array.find-index":174,"core-js/modules/es.array.from":176,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.map":182,"core-js/modules/es.array.slice":183,"core-js/modules/es.map":187,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],354:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.uint16-array");_dereq_("core-js/modules/es.typed-array.uint32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.uint16-array");_dereq_("core-js/modules/es.typed-array.uint32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));_dereq_("./p5.RendererGL");_dereq_("./p5.RenderBuffer");var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_main.default.RendererGL.prototype.freeGeometry=function(geometry){if(!geometry.gid){console.warn("The model you passed to freeGeometry does not have an id!");return}this._freeBuffers(geometry.gid)};_main.default.RendererGL.prototype._initBufferDefaults=function(gId){this._freeBuffers(gId);if(Object.keys(this.retainedMode.geometry).length>1e3){var key=Object.keys(this.retainedMode.geometry)[0];this._freeBuffers(key)}return this.retainedMode.geometry[gId]={}};_main.default.RendererGL.prototype._freeBuffers=function(gId){var buffers=this.retainedMode.geometry[gId];if(!buffers){return}delete this.retainedMode.geometry[gId];var gl=this.GL;if(buffers.indexBuffer){gl.deleteBuffer(buffers.indexBuffer)}function freeBuffers(defs){var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=defs[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var def=_step.value;if(buffers[def.dst]){gl.deleteBuffer(buffers[def.dst]);buffers[def.dst]=null}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}freeBuffers(this.retainedMode.buffers.stroke);freeBuffers(this.retainedMode.buffers.fill)};_main.default.RendererGL.prototype.createBuffers=function(gId,model){var gl=this.GL;var buffers=this._initBufferDefaults(gId);buffers.model=model;var indexBuffer=buffers.indexBuffer;if(model.faces.length){if(!indexBuffer)indexBuffer=buffers.indexBuffer=gl.createBuffer();var vals=_main.default.RendererGL.prototype._flatten(model.faces);var hasVertexIndicesOverMaxUInt16=vals.some(function(v){return v>65535});var type=hasVertexIndicesOverMaxUInt16?Uint32Array:Uint16Array;this._bindBuffer(indexBuffer,gl.ELEMENT_ARRAY_BUFFER,vals,type);buffers.indexBufferType=hasVertexIndicesOverMaxUInt16?gl.UNSIGNED_INT:gl.UNSIGNED_SHORT;buffers.vertexCount=model.faces.length*3}else{if(indexBuffer){gl.deleteBuffer(indexBuffer);buffers.indexBuffer=null}buffers.vertexCount=model.vertices?model.vertices.length:0}buffers.lineVertexCount=model.lineVertices?model.lineVertices.length/3:0;return buffers};_main.default.RendererGL.prototype.drawBuffers=function(gId){var gl=this.GL;var geometry=this.retainedMode.geometry[gId];if(!this.geometryBuilder&&this._doFill&&this.retainedMode.geometry[gId].vertexCount>0){this._useVertexColor=geometry.model.vertexColors.length>0;var fillShader=this._getRetainedFillShader();this._setFillUniforms(fillShader);var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.retainedMode.buffers.fill[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var buff=_step2.value;buff._prepareBuffer(geometry,fillShader)}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}fillShader.disableRemainingAttributes();if(geometry.indexBuffer){this._bindBuffer(geometry.indexBuffer,gl.ELEMENT_ARRAY_BUFFER)}this._applyColorBlend(this.curFillColor);this._drawElements(gl.TRIANGLES,gId);fillShader.unbindShader()}if(!this.geometryBuilder&&this._doStroke&&geometry.lineVertexCount>0){this._useLineColor=geometry.model.vertexStrokeColors.length>0;var strokeShader=this._getRetainedStrokeShader();this._setStrokeUniforms(strokeShader);var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.retainedMode.buffers.stroke[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var _buff=_step3.value;_buff._prepareBuffer(geometry,strokeShader)}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return!=null){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}strokeShader.disableRemainingAttributes();this._applyColorBlend(this.curStrokeColor);this._drawArrays(gl.TRIANGLES,gId);strokeShader.unbindShader()}if(this.geometryBuilder){this.geometryBuilder.addRetained(geometry)}return this};_main.default.RendererGL.prototype.drawBuffersScaled=function(gId,scaleX,scaleY,scaleZ){var uMVMatrix=this.uMVMatrix.copy();try{this.uMVMatrix.scale(scaleX,scaleY,scaleZ);this.drawBuffers(gId)}finally{this.uMVMatrix=uMVMatrix}};_main.default.RendererGL.prototype._drawArrays=function(drawMode,gId){this.GL.drawArrays(drawMode,0,this.retainedMode.geometry[gId].lineVertexCount);return this};_main.default.RendererGL.prototype._drawElements=function(drawMode,gId){var buffers=this.retainedMode.geometry[gId];var gl=this.GL;if(buffers.indexBuffer){if(this._pInst.webglVersion!==constants.WEBGL2&&buffers.indexBufferType===gl.UNSIGNED_INT){if(!gl.getExtension("OES_element_index_uint")){throw new Error("Unable to render a 3d model with > 65535 triangles. Your web browser does not support the WebGL Extension OES_element_index_uint.")}}gl.drawElements(gl.TRIANGLES,buffers.vertexCount,buffers.indexBufferType,0)}else{gl.drawArrays(drawMode||gl.TRIANGLES,0,buffers.vertexCount)}};_main.default.RendererGL.prototype._drawPoints=function(vertices,vertexBuffer){var gl=this.GL;var pointShader=this._getImmediatePointShader();this._setPointUniforms(pointShader);this._bindBuffer(vertexBuffer,gl.ARRAY_BUFFER,this._vToNArray(vertices),Float32Array,gl.STATIC_DRAW);pointShader.enableAttrib(pointShader.attributes.aPosition,3);this._applyColorBlend(this.curStrokeColor);gl.drawArrays(gl.Points,0,vertices.length);pointShader.unbindShader()};var _default=_main.default.RendererGL;exports.default=_default},{"../core/constants":286,"../core/main":298,"./p5.RenderBuffer":352,"./p5.RendererGL":355,"core-js/modules/es.array.fill":172,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.some":184,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.keys":199,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.float32-array":229,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint16-array":250,"core-js/modules/es.typed-array.uint32-array":251,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],355:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.copy-within");_dereq_("core-js/modules/es.array.every");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.map");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.reflect.get");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.set");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.float64-array");_dereq_("core-js/modules/es.typed-array.int16-array");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.uint16-array");_dereq_("core-js/modules/es.typed-array.uint32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.concat");_dereq_("core-js/modules/es.array.copy-within");_dereq_("core-js/modules/es.array.every");_dereq_("core-js/modules/es.array.fill");_dereq_("core-js/modules/es.array.from");_dereq_("core-js/modules/es.array.includes");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.map");_dereq_("core-js/modules/es.object.assign");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.set");_dereq_("core-js/modules/es.string.includes");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.float32-array");_dereq_("core-js/modules/es.typed-array.float64-array");_dereq_("core-js/modules/es.typed-array.int16-array");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.uint16-array");_dereq_("core-js/modules/es.typed-array.uint32-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.readPixelsWebGL=readPixelsWebGL;exports.readPixelWebGL=readPixelWebGL;exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));var _GeometryBuilder=_interopRequireDefault(_dereq_("./GeometryBuilder"));var _libtess=_interopRequireDefault(_dereq_("libtess"));_dereq_("./p5.Shader");_dereq_("./p5.Camera");_dereq_("../core/p5.Renderer");_dereq_("./p5.Matrix");_dereq_("./p5.Framebuffer");var _path=_dereq_("path");var _p6=_dereq_("./p5.Texture");var _filterShaderFrags;function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _get(target,property,receiver){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(receiver)}return desc.value}}return _get(target,property,receiver||target)}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break}return object}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var Super=_getPrototypeOf(Derived),result;if(isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var STROKE_CAP_ENUM={};var STROKE_JOIN_ENUM={};var lineDefs="";var defineStrokeCapEnum=function defineStrokeCapEnum(key,val){lineDefs+="#define STROKE_CAP_".concat(key," ").concat(val,"\n");STROKE_CAP_ENUM[constants[key]]=val};var defineStrokeJoinEnum=function defineStrokeJoinEnum(key,val){lineDefs+="#define STROKE_JOIN_".concat(key," ").concat(val,"\n");STROKE_JOIN_ENUM[constants[key]]=val};defineStrokeCapEnum("ROUND",0);defineStrokeCapEnum("PROJECT",1);defineStrokeCapEnum("SQUARE",2);defineStrokeJoinEnum("ROUND",0);defineStrokeJoinEnum("MITER",1);defineStrokeJoinEnum("BEVEL",2);var lightingShader='#define PI 3.141592\n\nprecision highp float;\nprecision highp int;\n\nuniform mat4 uViewMatrix;\n\nuniform bool uUseLighting;\n\nuniform int uAmbientLightCount;\nuniform vec3 uAmbientColor[5];\n\nuniform int uDirectionalLightCount;\nuniform vec3 uLightingDirection[5];\nuniform vec3 uDirectionalDiffuseColors[5];\nuniform vec3 uDirectionalSpecularColors[5];\n\nuniform int uPointLightCount;\nuniform vec3 uPointLightLocation[5];\nuniform vec3 uPointLightDiffuseColors[5];\t\nuniform vec3 uPointLightSpecularColors[5];\n\nuniform int uSpotLightCount;\nuniform float uSpotLightAngle[5];\nuniform float uSpotLightConc[5];\nuniform vec3 uSpotLightDiffuseColors[5];\nuniform vec3 uSpotLightSpecularColors[5];\nuniform vec3 uSpotLightLocation[5];\nuniform vec3 uSpotLightDirection[5];\n\nuniform bool uSpecular;\nuniform float uShininess;\n\nuniform float uConstantAttenuation;\nuniform float uLinearAttenuation;\nuniform float uQuadraticAttenuation;\n\n// setting from  _setImageLightUniforms()\n// boolean to initiate the calculateImageDiffuse and calculateImageSpecular\nuniform bool uUseImageLight;\n// texture for use in calculateImageDiffuse\nuniform sampler2D environmentMapDiffused;\n// texture for use in calculateImageSpecular\nuniform sampler2D environmentMapSpecular;\n// roughness for use in calculateImageSpecular\nuniform float levelOfDetail;\n\nconst float specularFactor = 2.0;\nconst float diffuseFactor = 0.73;\n\nstruct LightResult {\n  float specular;\n  float diffuse;\n};\n\nfloat _phongSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float shininess) {\n\n  vec3 R = reflect(lightDirection, surfaceNormal);\n  return pow(max(0.0, dot(R, viewDirection)), shininess);\n}\n\nfloat _lambertDiffuse(vec3 lightDirection, vec3 surfaceNormal) {\n  return max(0.0, dot(-lightDirection, surfaceNormal));\n}\n\nLightResult _light(vec3 viewDirection, vec3 normal, vec3 lightVector) {\n\n  vec3 lightDir = normalize(lightVector);\n\n  //compute our diffuse & specular terms\n  LightResult lr;\n  if (uSpecular)\n    lr.specular = _phongSpecular(lightDir, viewDirection, normal, uShininess);\n  lr.diffuse = _lambertDiffuse(lightDir, normal);\n  return lr;\n}\n\n// converts the range of "value" from [min1 to max1] to [min2 to max2]\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec2 mapTextureToNormal( vec3 v ){\n  // x = r sin(phi) cos(theta)   \n  // y = r cos(phi)  \n  // z = r sin(phi) sin(theta)\n  float phi = acos( v.y );\n  // if phi is 0, then there are no x, z components\n  float theta = 0.0;\n  // else \n  theta = acos(v.x / sin(phi));\n  float sinTheta = v.z / sin(phi);\n  if (sinTheta < 0.0) {\n    // Turn it into -theta, but in the 0-2PI range\n    theta = 2.0 * PI - theta;\n  }\n  theta = theta / (2.0 * 3.14159);\n  phi = phi / 3.14159 ;\n  \n  vec2 angles = vec2( fract(theta + 0.25), 1.0 - phi );\n  return angles;\n}\n\n\nvec3 calculateImageDiffuse( vec3 vNormal, vec3 vViewPosition ){\n  // make 2 seperate builds \n  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);  // hardcoded world camera position\n  vec3 worldNormal = normalize(vNormal);\n  vec2 newTexCoor = mapTextureToNormal( worldNormal );\n  vec4 texture = TEXTURE( environmentMapDiffused, newTexCoor );\n  // this is to make the darker sections more dark\n  // png and jpg usually flatten the brightness so it is to reverse that\n  return smoothstep(vec3(0.0), vec3(0.8), texture.xyz);\n}\n\nvec3 calculateImageSpecular( vec3 vNormal, vec3 vViewPosition ){\n  vec3 worldCameraPosition =  vec3(0.0, 0.0, 0.0);\n  vec3 worldNormal = normalize(vNormal);\n  vec3 lightDirection = normalize( vViewPosition - worldCameraPosition );\n  vec3 R = reflect(lightDirection, worldNormal);\n  vec2 newTexCoor = mapTextureToNormal( R );\n#ifdef WEBGL2\n  vec4 outColor = textureLod(environmentMapSpecular, newTexCoor, levelOfDetail);\n#else\n  vec4 outColor = TEXTURE(environmentMapSpecular, newTexCoor);\n#endif\n  // this is to make the darker sections more dark\n  // png and jpg usually flatten the brightness so it is to reverse that\n  return pow(outColor.xyz, vec3(10.0));\n}\n\nvoid totalLight(\n  vec3 modelPosition,\n  vec3 normal,\n  out vec3 totalDiffuse,\n  out vec3 totalSpecular\n) {\n\n  totalSpecular = vec3(0.0);\n\n  if (!uUseLighting) {\n    totalDiffuse = vec3(1.0);\n    return;\n  }\n\n  totalDiffuse = vec3(0.0);\n\n  vec3 viewDirection = normalize(-modelPosition);\n\n  for (int j = 0; j < 5; j++) {\n    if (j < uDirectionalLightCount) {\n      vec3 lightVector = (uViewMatrix * vec4(uLightingDirection[j], 0.0)).xyz;\n      vec3 lightColor = uDirectionalDiffuseColors[j];\n      vec3 specularColor = uDirectionalSpecularColors[j];\n      LightResult result = _light(viewDirection, normal, lightVector);\n      totalDiffuse += result.diffuse * lightColor;\n      totalSpecular += result.specular * lightColor * specularColor;\n    }\n\n    if (j < uPointLightCount) {\n      vec3 lightPosition = (uViewMatrix * vec4(uPointLightLocation[j], 1.0)).xyz;\n      vec3 lightVector = modelPosition - lightPosition;\n    \n      //calculate attenuation\n      float lightDistance = length(lightVector);\n      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);\n      vec3 lightColor = lightFalloff * uPointLightDiffuseColors[j];\n      vec3 specularColor = lightFalloff * uPointLightSpecularColors[j];\n\n      LightResult result = _light(viewDirection, normal, lightVector);\n      totalDiffuse += result.diffuse * lightColor;\n      totalSpecular += result.specular * lightColor * specularColor;\n    }\n\n    if(j < uSpotLightCount) {\n      vec3 lightPosition = (uViewMatrix * vec4(uSpotLightLocation[j], 1.0)).xyz;\n      vec3 lightVector = modelPosition - lightPosition;\n    \n      float lightDistance = length(lightVector);\n      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);\n\n      vec3 lightDirection = (uViewMatrix * vec4(uSpotLightDirection[j], 0.0)).xyz;\n      float spotDot = dot(normalize(lightVector), normalize(lightDirection));\n      float spotFalloff;\n      if(spotDot < uSpotLightAngle[j]) {\n        spotFalloff = 0.0;\n      }\n      else {\n        spotFalloff = pow(spotDot, uSpotLightConc[j]);\n      }\n      lightFalloff *= spotFalloff;\n\n      vec3 lightColor = uSpotLightDiffuseColors[j];\n      vec3 specularColor = uSpotLightSpecularColors[j];\n     \n      LightResult result = _light(viewDirection, normal, lightVector);\n      \n      totalDiffuse += result.diffuse * lightColor * lightFalloff;\n      totalSpecular += result.specular * lightColor * specularColor * lightFalloff;\n    }\n  }\n\n  if( uUseImageLight ){\n    totalDiffuse += calculateImageDiffuse(normal, modelPosition);\n    totalSpecular += calculateImageSpecular(normal, modelPosition);\n  }\n\n  totalDiffuse *= diffuseFactor;\n  totalSpecular *= specularFactor;\n}\n';var webgl2CompatibilityShader="#ifdef WEBGL2\n\n#define IN in\n#define OUT out\n\n#ifdef FRAGMENT_SHADER\nout vec4 outColor;\n#define OUT_COLOR outColor\n#endif\n#define TEXTURE texture\n\n#else\n\n#ifdef FRAGMENT_SHADER\n#define IN varying\n#else\n#define IN attribute\n#endif\n#define OUT varying\n#define TEXTURE texture2D\n\n#ifdef FRAGMENT_SHADER\n#define OUT_COLOR gl_FragColor\n#endif\n\n#endif\n";var defaultShaders={immediateVert:"IN vec3 aPosition;\nIN vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform float uResolution;\nuniform float uPointSize;\n\nOUT vec4 vColor;\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vColor = aVertexColor;\n  gl_PointSize = uPointSize;\n}\n",vertexColorVert:"IN vec3 aPosition;\nIN vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nOUT vec4 vColor;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vColor = aVertexColor;\n}\n",vertexColorFrag:"IN vec4 vColor;\nvoid main(void) {\n  OUT_COLOR = vec4(vColor.rgb, 1.) * vColor.a;\n}\n",normalVert:"IN vec3 aPosition;\nIN vec3 aNormal;\nIN vec2 aTexCoord;\nIN vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nuniform vec4 uMaterialColor;\nuniform bool uUseVertexColor;\n\nOUT vec3 vVertexNormal;\nOUT highp vec2 vVertTexCoord;\nOUT vec4 vColor;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vVertexNormal = normalize(vec3( uNormalMatrix * aNormal ));\n  vVertTexCoord = aTexCoord;\n  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);\n}\n",normalFrag:"IN vec3 vVertexNormal;\nvoid main(void) {\n  OUT_COLOR = vec4(vVertexNormal, 1.0);\n}\n",basicFrag:"IN vec4 vColor;\nvoid main(void) {\n  OUT_COLOR = vec4(vColor.rgb, 1.) * vColor.a;\n}\n",lightVert:lightingShader+"// include lighting.glgl\n\nIN vec3 aPosition;\nIN vec3 aNormal;\nIN vec2 aTexCoord;\nIN vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nuniform bool uUseVertexColor;\nuniform vec4 uMaterialColor;\n\nOUT highp vec2 vVertTexCoord;\nOUT vec3 vDiffuseColor;\nOUT vec3 vSpecularColor;\nOUT vec4 vColor;\n\nvoid main(void) {\n\n  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * viewModelPosition;\n\n  vec3 vertexNormal = normalize(uNormalMatrix * aNormal);\n  vVertTexCoord = aTexCoord;\n\n  totalLight(viewModelPosition.xyz, vertexNormal, vDiffuseColor, vSpecularColor);\n\n  for (int i = 0; i < 8; i++) {\n    if (i < uAmbientLightCount) {\n      vDiffuseColor += uAmbientColor[i];\n    }\n  }\n  \n  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);\n}\n",lightTextureFrag:"uniform vec4 uTint;\nuniform sampler2D uSampler;\nuniform bool isTexture;\nuniform bool uEmissive;\n\nIN highp vec2 vVertTexCoord;\nIN vec3 vDiffuseColor;\nIN vec3 vSpecularColor;\nIN vec4 vColor;\n\nvoid main(void) {\n  if(uEmissive && !isTexture) {\n    OUT_COLOR = vColor;\n  }\n  else {\n    vec4 baseColor = isTexture\n      // Textures come in with premultiplied alpha. To apply tint and still have\n      // premultiplied alpha output, we need to multiply the RGB channels by the\n      // tint RGB, and all channels by the tint alpha.\n      ? TEXTURE(uSampler, vVertTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)\n      // Colors come in with unmultiplied alpha, so we need to multiply the RGB\n      // channels by alpha to convert it to premultiplied alpha.\n      : vec4(vColor.rgb * vColor.a, vColor.a);\n    OUT_COLOR = vec4(baseColor.rgb * vDiffuseColor + vSpecularColor, baseColor.a);\n  }\n}\n",phongVert:"precision highp int;\n\nIN vec3 aPosition;\nIN vec3 aNormal;\nIN vec2 aTexCoord;\nIN vec4 aVertexColor;\n\nuniform vec3 uAmbientColor[5];\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform int uAmbientLightCount;\n\nuniform bool uUseVertexColor;\nuniform vec4 uMaterialColor;\n\nOUT vec3 vNormal;\nOUT vec2 vTexCoord;\nOUT vec3 vViewPosition;\nOUT vec3 vAmbientColor;\nOUT vec4 vColor;\n\nvoid main(void) {\n\n  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\n\n  // Pass varyings to fragment shader\n  vViewPosition = viewModelPosition.xyz;\n  gl_Position = uProjectionMatrix * viewModelPosition;  \n\n  vNormal = uNormalMatrix * aNormal;\n  vTexCoord = aTexCoord;\n\n  // TODO: this should be a uniform\n  vAmbientColor = vec3(0.0);\n  for (int i = 0; i < 5; i++) {\n    if (i < uAmbientLightCount) {\n      vAmbientColor += uAmbientColor[i];\n    }\n  }\n  \n  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);\n}\n",phongFrag:lightingShader+"// include lighting.glsl\nprecision highp int;\n\nuniform bool uHasSetAmbient;\nuniform vec4 uSpecularMatColor;\nuniform vec4 uAmbientMatColor;\nuniform vec4 uEmissiveMatColor;\n\nuniform vec4 uTint;\nuniform sampler2D uSampler;\nuniform bool isTexture;\n\nIN vec3 vNormal;\nIN vec2 vTexCoord;\nIN vec3 vViewPosition;\nIN vec3 vAmbientColor;\nIN vec4 vColor;\n\nvoid main(void) {\n\n  vec3 diffuse;\n  vec3 specular;\n  totalLight(vViewPosition, normalize(vNormal), diffuse, specular);\n\n  // Calculating final color as result of all lights (plus emissive term).\n\n  vec4 baseColor = isTexture\n    // Textures come in with premultiplied alpha. To apply tint and still have\n    // premultiplied alpha output, we need to multiply the RGB channels by the\n    // tint RGB, and all channels by the tint alpha.\n    ? TEXTURE(uSampler, vTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)\n    // Colors come in with unmultiplied alpha, so we need to multiply the RGB\n    // channels by alpha to convert it to premultiplied alpha.\n    : vec4(vColor.rgb * vColor.a, vColor.a);\n  OUT_COLOR = vec4(diffuse * baseColor.rgb + \n                    vAmbientColor * (\n                      uHasSetAmbient ? uAmbientMatColor.rgb : baseColor.rgb\n                    ) + \n                    specular * uSpecularMatColor.rgb + \n                    uEmissiveMatColor.rgb, baseColor.a);\n}\n",fontVert:"IN vec3 aPosition;\nIN vec2 aTexCoord;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec4 uGlyphRect;\nuniform float uGlyphOffset;\n\nOUT vec2 vTexCoord;\nOUT float w;\n\nvoid main() {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n\n  // scale by the size of the glyph's rectangle\n  positionVec4.xy *= uGlyphRect.zw - uGlyphRect.xy;\n\n  // Expand glyph bounding boxes by 1px on each side to give a bit of room\n  // for antialiasing\n  vec3 newOrigin = (uModelViewMatrix * vec4(0., 0., 0., 1.)).xyz;\n  vec3 newDX = (uModelViewMatrix * vec4(1., 0., 0., 1.)).xyz;\n  vec3 newDY = (uModelViewMatrix * vec4(0., 1., 0., 1.)).xyz;\n  vec2 pixelScale = vec2(\n    1. / length(newOrigin - newDX),\n    1. / length(newOrigin - newDY)\n  );\n  vec2 offset = pixelScale * normalize(aTexCoord - vec2(0.5, 0.5)) * vec2(1., -1.);\n  vec2 textureOffset = offset * (1. / vec2(\n    uGlyphRect.z - uGlyphRect.x,\n    uGlyphRect.w - uGlyphRect.y\n  ));\n\n  // move to the corner of the glyph\n  positionVec4.xy += uGlyphRect.xy;\n\n  // move to the letter's line offset\n  positionVec4.x += uGlyphOffset;\n\n  positionVec4.xy += offset;\n  \n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vTexCoord = aTexCoord + textureOffset;\n  w = gl_Position.w;\n}\n",fontFrag:"#ifndef WEBGL2\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n#if 0\n  // simulate integer math using floats\n\t#define int float\n\t#define ivec2 vec2\n\t#define INT(x) float(x)\n\n\tint ifloor(float v) { return floor(v); }\n\tivec2 ifloor(vec2 v) { return floor(v); }\n\n#else\n  // use native integer math\n\tprecision highp int;\n\t#define INT(x) x\n\n\tint ifloor(float v) { return int(v); }\n\tint ifloor(int v) { return v; }\n\tivec2 ifloor(vec2 v) { return ivec2(v); }\n\n#endif\n\nuniform sampler2D uSamplerStrokes;\nuniform sampler2D uSamplerRowStrokes;\nuniform sampler2D uSamplerRows;\nuniform sampler2D uSamplerColStrokes;\nuniform sampler2D uSamplerCols;\n\nuniform ivec2 uStrokeImageSize;\nuniform ivec2 uCellsImageSize;\nuniform ivec2 uGridImageSize;\n\nuniform ivec2 uGridOffset;\nuniform ivec2 uGridSize;\nuniform vec4 uMaterialColor;\n\nIN vec2 vTexCoord;\n\n// some helper functions\nint ROUND(float v) { return ifloor(v + 0.5); }\nivec2 ROUND(vec2 v) { return ifloor(v + 0.5); }\nfloat saturate(float v) { return clamp(v, 0.0, 1.0); }\nvec2 saturate(vec2 v) { return clamp(v, 0.0, 1.0); }\n\nint mul(float v1, int v2) {\n  return ifloor(v1 * float(v2));\n}\n\nivec2 mul(vec2 v1, ivec2 v2) {\n  return ifloor(v1 * vec2(v2) + 0.5);\n}\n\n// unpack a 16-bit integer from a float vec2\nint getInt16(vec2 v) {\n  ivec2 iv = ROUND(v * 255.0);\n  return iv.x * INT(128) + iv.y;\n}\n\nvec2 pixelScale;\nvec2 coverage = vec2(0.0);\nvec2 weight = vec2(0.5);\nconst float minDistance = 1.0/8192.0;\nconst float hardness = 1.05; // amount of antialias\n\n// the maximum number of curves in a glyph\nconst int N = INT(250);\n\n// retrieves an indexed pixel from a sampler\nvec4 getTexel(sampler2D sampler, int pos, ivec2 size) {\n  int width = size.x;\n  int y = ifloor(pos / width);\n  int x = pos - y * width;  // pos % width\n\n  return TEXTURE(sampler, (vec2(x, y) + 0.5) / vec2(size));\n}\n\nvoid calulateCrossings(vec2 p0, vec2 p1, vec2 p2, out vec2 C1, out vec2 C2) {\n\n  // get the coefficients of the quadratic in t\n  vec2 a = p0 - p1 * 2.0 + p2;\n  vec2 b = p0 - p1;\n  vec2 c = p0 - vTexCoord;\n\n  // found out which values of 't' it crosses the axes\n  vec2 surd = sqrt(max(vec2(0.0), b * b - a * c));\n  vec2 t1 = ((b - surd) / a).yx;\n  vec2 t2 = ((b + surd) / a).yx;\n\n  // approximate straight lines to avoid rounding errors\n  if (abs(a.y) < 0.001)\n    t1.x = t2.x = c.y / (2.0 * b.y);\n\n  if (abs(a.x) < 0.001)\n    t1.y = t2.y = c.x / (2.0 * b.x);\n\n  // plug into quadratic formula to find the corrdinates of the crossings\n  C1 = ((a * t1 - b * 2.0) * t1 + c) * pixelScale;\n  C2 = ((a * t2 - b * 2.0) * t2 + c) * pixelScale;\n}\n\nvoid coverageX(vec2 p0, vec2 p1, vec2 p2) {\n\n  vec2 C1, C2;\n  calulateCrossings(p0, p1, p2, C1, C2);\n\n  // determine on which side of the x-axis the points lie\n  bool y0 = p0.y > vTexCoord.y;\n  bool y1 = p1.y > vTexCoord.y;\n  bool y2 = p2.y > vTexCoord.y;\n\n  // could web be under the curve (after t1)?\n  if (y1 ? !y2 : y0) {\n    // add the coverage for t1\n    coverage.x += saturate(C1.x + 0.5);\n    // calculate the anti-aliasing for t1\n    weight.x = min(weight.x, abs(C1.x));\n  }\n\n  // are we outside the curve (after t2)?\n  if (y1 ? !y0 : y2) {\n    // subtract the coverage for t2\n    coverage.x -= saturate(C2.x + 0.5);\n    // calculate the anti-aliasing for t2\n    weight.x = min(weight.x, abs(C2.x));\n  }\n}\n\n// this is essentially the same as coverageX, but with the axes swapped\nvoid coverageY(vec2 p0, vec2 p1, vec2 p2) {\n\n  vec2 C1, C2;\n  calulateCrossings(p0, p1, p2, C1, C2);\n\n  bool x0 = p0.x > vTexCoord.x;\n  bool x1 = p1.x > vTexCoord.x;\n  bool x2 = p2.x > vTexCoord.x;\n\n  if (x1 ? !x2 : x0) {\n    coverage.y -= saturate(C1.y + 0.5);\n    weight.y = min(weight.y, abs(C1.y));\n  }\n\n  if (x1 ? !x0 : x2) {\n    coverage.y += saturate(C2.y + 0.5);\n    weight.y = min(weight.y, abs(C2.y));\n  }\n}\n\nvoid main() {\n\n  // calculate the pixel scale based on screen-coordinates\n  pixelScale = hardness / fwidth(vTexCoord);\n\n  // which grid cell is this pixel in?\n  ivec2 gridCoord = ifloor(vTexCoord * vec2(uGridSize));\n\n  // intersect curves in this row\n  {\n    // the index into the row info bitmap\n    int rowIndex = gridCoord.y + uGridOffset.y;\n    // fetch the info texel\n    vec4 rowInfo = getTexel(uSamplerRows, rowIndex, uGridImageSize);\n    // unpack the rowInfo\n    int rowStrokeIndex = getInt16(rowInfo.xy);\n    int rowStrokeCount = getInt16(rowInfo.zw);\n\n    for (int iRowStroke = INT(0); iRowStroke < N; iRowStroke++) {\n      if (iRowStroke >= rowStrokeCount)\n        break;\n\n      // each stroke is made up of 3 points: the start and control point\n      // and the start of the next curve.\n      // fetch the indices of this pair of strokes:\n      vec4 strokeIndices = getTexel(uSamplerRowStrokes, rowStrokeIndex++, uCellsImageSize);\n\n      // unpack the stroke index\n      int strokePos = getInt16(strokeIndices.xy);\n\n      // fetch the two strokes\n      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);\n      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);\n\n      // calculate the coverage\n      coverageX(stroke0.xy, stroke0.zw, stroke1.xy);\n    }\n  }\n\n  // intersect curves in this column\n  {\n    int colIndex = gridCoord.x + uGridOffset.x;\n    vec4 colInfo = getTexel(uSamplerCols, colIndex, uGridImageSize);\n    int colStrokeIndex = getInt16(colInfo.xy);\n    int colStrokeCount = getInt16(colInfo.zw);\n    \n    for (int iColStroke = INT(0); iColStroke < N; iColStroke++) {\n      if (iColStroke >= colStrokeCount)\n        break;\n\n      vec4 strokeIndices = getTexel(uSamplerColStrokes, colStrokeIndex++, uCellsImageSize);\n\n      int strokePos = getInt16(strokeIndices.xy);\n      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);\n      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);\n      coverageY(stroke0.xy, stroke0.zw, stroke1.xy);\n    }\n  }\n\n  weight = saturate(1.0 - weight * 2.0);\n  float distance = max(weight.x + weight.y, minDistance); // manhattan approx.\n  float antialias = abs(dot(coverage, weight) / distance);\n  float cover = min(abs(coverage.x), abs(coverage.y));\n  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;\n  OUT_COLOR *= saturate(max(antialias, cover));\n}\n",lineVert:lineDefs+"/*\n  Part of the Processing project - http://processing.org\n  Copyright (c) 2012-15 The Processing Foundation\n  Copyright (c) 2004-12 Ben Fry and Casey Reas\n  Copyright (c) 2001-04 Massachusetts Institute of Technology\n  This library is free software; you can redistribute it and/or\n  modify it under the terms of the GNU Lesser General Public\n  License as published by the Free Software Foundation, version 2.1.\n  This library is distributed in the hope that it will be useful,\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n  Lesser General Public License for more details.\n  You should have received a copy of the GNU Lesser General\n  Public License along with this library; if not, write to the\n  Free Software Foundation, Inc., 59 Temple Place, Suite 330,\n  Boston, MA  02111-1307  USA\n*/\n\n#define PROCESSING_LINE_SHADER\n\nprecision mediump int;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform float uStrokeWeight;\n\nuniform bool uUseLineColor;\nuniform vec4 uMaterialColor;\n\nuniform vec4 uViewport;\nuniform int uPerspective;\nuniform int uStrokeJoin;\n\nIN vec4 aPosition;\nIN vec3 aTangentIn;\nIN vec3 aTangentOut;\nIN float aSide;\nIN vec4 aVertexColor;\n\nOUT vec4 vColor;\nOUT vec2 vTangent;\nOUT vec2 vCenter;\nOUT vec2 vPosition;\nOUT float vMaxDist;\nOUT float vCap;\nOUT float vJoin;\n\nvec2 lineIntersection(vec2 aPoint, vec2 aDir, vec2 bPoint, vec2 bDir) {\n  // Rotate and translate so a starts at the origin and goes out to the right\n  bPoint -= aPoint;\n  vec2 rotatedBFrom = vec2(\n    bPoint.x*aDir.x + bPoint.y*aDir.y,\n    bPoint.y*aDir.x - bPoint.x*aDir.y\n  );\n  vec2 bTo = bPoint + bDir;\n  vec2 rotatedBTo = vec2(\n    bTo.x*aDir.x + bTo.y*aDir.y,\n    bTo.y*aDir.x - bTo.x*aDir.y\n  );\n  float intersectionDistance =\n    rotatedBTo.x + (rotatedBFrom.x - rotatedBTo.x) * rotatedBTo.y /\n    (rotatedBTo.y - rotatedBFrom.y);\n  return aPoint + aDir * intersectionDistance;\n}\n\nvoid main() {\n  // Caps have one of either the in or out tangent set to 0\n  vCap = (aTangentIn == vec3(0.)) != (aTangentOut == (vec3(0.)))\n    ? 1. : 0.;\n\n  // Joins have two unique, defined tangents\n  vJoin = (\n    aTangentIn != vec3(0.) &&\n    aTangentOut != vec3(0.) &&\n    aTangentIn != aTangentOut\n  ) ? 1. : 0.;\n\n  vec4 posp = uModelViewMatrix * aPosition;\n  vec4 posqIn = uModelViewMatrix * (aPosition + vec4(aTangentIn, 0));\n  vec4 posqOut = uModelViewMatrix * (aPosition + vec4(aTangentOut, 0));\n\n  float facingCamera = pow(\n    // The word space tangent's z value is 0 if it's facing the camera\n    abs(normalize(posqIn-posp).z),\n\n    // Using pow() here to ramp `facingCamera` up from 0 to 1 really quickly\n    // so most lines get scaled and don't get clipped\n    0.25\n  );\n\n  // using a scale <1 moves the lines towards the camera\n  // in order to prevent popping effects due to half of\n  // the line disappearing behind the geometry faces.\n  float scale = mix(1., 0.995, facingCamera);\n\n  // Moving vertices slightly toward the camera\n  // to avoid depth-fighting with the fill triangles.\n  // Discussed here:\n  // http://www.opengl.org/discussion_boards/ubbthreads.php?ubb=showflat&Number=252848  \n  posp.xyz = posp.xyz * scale;\n  posqIn.xyz = posqIn.xyz * scale;\n  posqOut.xyz = posqOut.xyz * scale;\n\n  vec4 p = uProjectionMatrix * posp;\n  vec4 qIn = uProjectionMatrix * posqIn;\n  vec4 qOut = uProjectionMatrix * posqOut;\n  vCenter = p.xy;\n\n  // formula to convert from clip space (range -1..1) to screen space (range 0..[width or height])\n  // screen_p = (p.xy/p.w + <1,1>) * 0.5 * uViewport.zw\n\n  // prevent division by W by transforming the tangent formula (div by 0 causes\n  // the line to disappear, see https://github.com/processing/processing/issues/5183)\n  // t = screen_q - screen_p\n  //\n  // tangent is normalized and we don't care which aDirection it points to (+-)\n  // t = +- normalize( screen_q - screen_p )\n  // t = +- normalize( (q.xy/q.w+<1,1>)*0.5*uViewport.zw - (p.xy/p.w+<1,1>)*0.5*uViewport.zw )\n  //\n  // extract common factor, <1,1> - <1,1> cancels out\n  // t = +- normalize( (q.xy/q.w - p.xy/p.w) * 0.5 * uViewport.zw )\n  //\n  // convert to common divisor\n  // t = +- normalize( ((q.xy*p.w - p.xy*q.w) / (p.w*q.w)) * 0.5 * uViewport.zw )\n  //\n  // remove the common scalar divisor/factor, not needed due to normalize and +-\n  // (keep uViewport - can't remove because it has different components for x and y\n  //  and corrects for aspect ratio, see https://github.com/processing/processing/issues/5181)\n  // t = +- normalize( (q.xy*p.w - p.xy*q.w) * uViewport.zw )\n\n  vec2 tangentIn = normalize((qIn.xy*p.w - p.xy*qIn.w) * uViewport.zw);\n  vec2 tangentOut = normalize((qOut.xy*p.w - p.xy*qOut.w) * uViewport.zw);\n\n  vec2 curPerspScale;\n  if(uPerspective == 1) {\n    // Perspective ---\n    // convert from world to clip by multiplying with projection scaling factor\n    // to get the right thickness (see https://github.com/processing/processing/issues/5182)\n\n    // The y value of the projection matrix may be flipped if rendering to a Framebuffer.\n    // Multiplying again by its sign here negates the flip to get just the scale.\n    curPerspScale = (uProjectionMatrix * vec4(1, sign(uProjectionMatrix[1][1]), 0, 0)).xy;\n  } else {\n    // No Perspective ---\n    // multiply by W (to cancel out division by W later in the pipeline) and\n    // convert from screen to clip (derived from clip to screen above)\n    curPerspScale = p.w / (0.5 * uViewport.zw);\n  }\n\n  vec2 offset;\n  if (vJoin == 1.) {\n    vTangent = normalize(tangentIn + tangentOut);\n    vec2 normalIn = vec2(-tangentIn.y, tangentIn.x);\n    vec2 normalOut = vec2(-tangentOut.y, tangentOut.x);\n    float side = sign(aSide);\n    float sideEnum = abs(aSide);\n\n    // We generate vertices for joins on either side of the centerline, but\n    // the \"elbow\" side is the only one needing a join. By not setting the\n    // offset for the other side, all its vertices will end up in the same\n    // spot and not render, effectively discarding it.\n    if (sign(dot(tangentOut, vec2(-tangentIn.y, tangentIn.x))) != side) {\n      // Side enums:\n      //   1: the side going into the join\n      //   2: the middle of the join\n      //   3: the side going out of the join\n      if (sideEnum == 2.) {\n        // Calculate the position + tangent on either side of the join, and\n        // find where the lines intersect to find the elbow of the join\n        vec2 c = (posp.xy/posp.w + vec2(1.,1.)) * 0.5 * uViewport.zw;\n        vec2 intersection = lineIntersection(\n          c + (side * normalIn * uStrokeWeight / 2.),\n          tangentIn,\n          c + (side * normalOut * uStrokeWeight / 2.),\n          tangentOut\n        );\n        offset = (intersection - c);\n\n        // When lines are thick and the angle of the join approaches 180, the\n        // elbow might be really far from the center. We'll apply a limit to\n        // the magnitude to avoid lines going across the whole screen when this\n        // happens.\n        float mag = length(offset);\n        float maxMag = 3. * uStrokeWeight;\n        if (mag > maxMag) {\n          offset *= maxMag / mag;\n        }\n      } else if (sideEnum == 1.) {\n        offset = side * normalIn * uStrokeWeight / 2.;\n      } else if (sideEnum == 3.) {\n        offset = side * normalOut * uStrokeWeight / 2.;\n      }\n    }\n    if (uStrokeJoin == STROKE_JOIN_BEVEL) {\n      vec2 avgNormal = vec2(-vTangent.y, vTangent.x);\n      vMaxDist = abs(dot(avgNormal, normalIn * uStrokeWeight / 2.));\n    } else {\n      vMaxDist = uStrokeWeight / 2.;\n    }\n  } else {\n    vec2 tangent = aTangentIn == vec3(0.) ? tangentOut : tangentIn;\n    vTangent = tangent;\n    vec2 normal = vec2(-tangent.y, tangent.x);\n\n    float normalOffset = sign(aSide);\n    // Caps will have side values of -2 or 2 on the edge of the cap that\n    // extends out from the line\n    float tangentOffset = abs(aSide) - 1.;\n    offset = (normal * normalOffset + tangent * tangentOffset) *\n      uStrokeWeight * 0.5;\n    vMaxDist = uStrokeWeight / 2.;\n  }\n  vPosition = vCenter + offset;\n\n  gl_Position.xy = p.xy + offset.xy * curPerspScale;\n  gl_Position.zw = p.zw;\n  \n  vColor = (uUseLineColor ? aVertexColor : uMaterialColor);\n}\n",lineFrag:lineDefs+"precision mediump int;\n\nuniform vec4 uMaterialColor;\nuniform int uStrokeCap;\nuniform int uStrokeJoin;\nuniform float uStrokeWeight;\n\nIN vec4 vColor;\nIN vec2 vTangent;\nIN vec2 vCenter;\nIN vec2 vPosition;\nIN float vMaxDist;\nIN float vCap;\nIN float vJoin;\n\nfloat distSquared(vec2 a, vec2 b) {\n  vec2 aToB = b - a;\n  return dot(aToB, aToB);\n}\n\nvoid main() {\n  if (vCap > 0.) {\n    if (\n      uStrokeCap == STROKE_CAP_ROUND &&\n      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25\n    ) {\n      discard;\n    } else if (\n      uStrokeCap == STROKE_CAP_SQUARE &&\n      dot(vPosition - vCenter, vTangent) > 0.\n    ) {\n      discard;\n    }\n    // Use full area for PROJECT\n  } else if (vJoin > 0.) {\n    if (\n      uStrokeJoin == STROKE_JOIN_ROUND &&\n      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25\n    ) {\n      discard;\n    } else if (uStrokeJoin == STROKE_JOIN_BEVEL) {\n      vec2 normal = vec2(-vTangent.y, vTangent.x);\n      if (abs(dot(vPosition - vCenter, normal)) > vMaxDist) {\n        discard;\n      }\n    }\n    // Use full area for MITER\n  }\n  OUT_COLOR = vec4(vColor.rgb, 1.) * vColor.a;\n}\n",pointVert:"IN vec3 aPosition;\nuniform float uPointSize;\nOUT float vStrokeWeight;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nvoid main() {\n\tvec4 positionVec4 =  vec4(aPosition, 1.0);\n\tgl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n\tgl_PointSize = uPointSize;\n\tvStrokeWeight = uPointSize;\n}\n",pointFrag:"precision mediump int;\nuniform vec4 uMaterialColor;\nIN float vStrokeWeight;\n\nvoid main(){\n  float mask = 0.0;\n\n  // make a circular mask using the gl_PointCoord (goes from 0 - 1 on a point)\n  // might be able to get a nicer edge on big strokeweights with smoothstep but slightly less performant\n\n  mask = step(0.98, length(gl_PointCoord * 2.0 - 1.0));\n\n  // if strokeWeight is 1 or less lets just draw a square\n  // this prevents weird artifacting from carving circles when our points are really small\n  // if strokeWeight is larger than 1, we just use it as is\n\n  mask = mix(0.0, mask, clamp(floor(vStrokeWeight - 0.5),0.0,1.0));\n\n  // throw away the borders of the mask\n  // otherwise we get weird alpha blending issues\n\n  if(mask > 0.98){\n    discard;\n  }\n\n  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;\n}\n",imageLightVert:"precision highp float;\nattribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\n\nvarying vec3 localPos;\nvarying vec3 vWorldNormal;\nvarying vec3 vWorldPosition;\nvarying vec2 vTexCoord;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nvoid main() {\n  // Multiply the position by the matrix.\n  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * viewModelPosition;  \n  \n  // orient the normals and pass to the fragment shader\n  vWorldNormal = uNormalMatrix * aNormal;\n  \n  // send the view position to the fragment shader\n  vWorldPosition = (uModelViewMatrix * vec4(aPosition, 1.0)).xyz;\n  \n  localPos = vWorldPosition;\n  vTexCoord = aTexCoord;\n}\n\n\n/*\nin the vertex shader we'll compute the world position and world oriented normal of the vertices and pass those to the fragment shader as varyings.\n*/\n",imageLightDiffusedFrag:"precision highp float;\nvarying vec3 localPos;\n\n// the HDR cubemap converted (can be from an equirectangular environment map.)\nuniform sampler2D environmentMap;\nvarying vec2 vTexCoord;\n\nconst float PI = 3.14159265359;\n\nvec2 nTOE( vec3 v ){\n  // x = r sin(phi) cos(theta)   \n  // y = r cos(phi)  \n  // z = r sin(phi) sin(theta)\n  float phi = acos( v.y );\n  // if phi is 0, then there are no x, z components\n  float theta = 0.0;\n  // else \n  theta = acos(v.x / sin(phi));\n  float sinTheta = v.z / sin(phi);\n  if (sinTheta < 0.0) {\n    // Turn it into -theta, but in the 0-2PI range\n    theta = 2.0 * PI - theta;\n  }\n  theta = theta / (2.0 * 3.14159);\n  phi = phi / 3.14159 ;\n  \n  vec2 angles = vec2( phi, theta );\n  return angles;\n}\n\nvoid main()\n{   \t \n\t// the sample direction equals the hemisphere's orientation\n  float phi = vTexCoord.x * 2.0 * PI;\n  float theta = vTexCoord.y * PI;\n  float x = sin(theta) * cos(phi);\n  float y = sin(theta) * sin(phi);\n  float z = cos(theta);\n  vec3 normal = vec3( x, y, z);\n\n\t// Discretely sampling the hemisphere given the integral's\n  // spherical coordinates translates to the following fragment code:\n\tvec3 irradiance = vec3(0.0);  \n\tvec3 up\t= vec3(0.0, 1.0, 0.0);\n\tvec3 right = normalize(cross(up, normal));\n\tup = normalize(cross(normal, right));\n\n\t//  We specify a fixed sampleDelta delta value to traverse\n  // the hemisphere; decreasing or increasing the sample delta\n  // will increase or decrease the accuracy respectively.\n\tconst float sampleDelta = 0.025;\n\tfloat nrSamples = 0.0;\n  \n\tfor(float phi = 0.0; phi < 2.0 * PI; phi += sampleDelta)\n\t{\n    for(float theta = 0.0; theta < ( 0.5 ) * PI; theta += sampleDelta)\n    {\n      // spherical to cartesian (in tangent space) // tangent space to world // add each sample result to irradiance\n      float x = sin(theta) * cos(phi);\n      float y = sin(theta) * sin(phi);\n      float z = cos(theta);\n      vec3 tangentSample = vec3( x, y, z);\n      \n      vec3 sampleVec = tangentSample.x * right + tangentSample.y * up + tangentSample.z * normal;\n        irradiance += (texture2D(environmentMap, nTOE(sampleVec)).xyz) * cos(theta) * sin(theta);\n      nrSamples++;\n    }\n\t}\n\t// divide by the total number of samples taken, giving us the average sampled irradiance.\n\tirradiance = PI * irradiance * (1.0 / float(nrSamples )) ;\n  \n \n\tgl_FragColor = vec4(irradiance, 1.0);\n}",imageLightSpecularFrag:"precision highp float;\r\nvarying vec3 localPos;\r\nvarying vec2 vTexCoord;\r\n\r\n// our texture\r\nuniform sampler2D environmentMap;\r\nuniform float roughness;\r\n\r\nconst float PI = 3.14159265359;\r\n\r\nfloat VanDerCorput(int bits);\r\nvec2 HammersleyNoBitOps(int i, int N);\r\nvec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness);\r\n\r\n\r\nvec2 nTOE( vec3 v ){\r\n  // x = r sin(phi) cos(theta)   \r\n  // y = r cos(phi)  \r\n  // z = r sin(phi) sin(theta)\r\n  float phi = acos( v.y );\r\n  // if phi is 0, then there are no x, z components\r\n  float theta = 0.0;\r\n  // else \r\n  theta = acos(v.x / sin(phi));\r\n  float sinTheta = v.z / sin(phi);\r\n  if (sinTheta < 0.0) {\r\n    // Turn it into -theta, but in the 0-2PI range\r\n    theta = 2.0 * PI - theta;\r\n  }\r\n  theta = theta / (2.0 * 3.14159);\r\n  phi = phi / 3.14159 ;\r\n  \r\n  vec2 angles = vec2( phi, theta );\r\n  return angles;\r\n}\r\n\r\n\r\nvoid main(){\r\n  const int SAMPLE_COUNT = 1024; // 4096\r\n  float totalWeight = 0.0;\r\n  vec3 prefilteredColor = vec3(0.0);\r\n  float phi = vTexCoord.x * 2.0 * PI;\r\n  float theta = vTexCoord.y * PI;\r\n  float x = sin(theta) * cos(phi);\r\n  float y = sin(theta) * sin(phi);\r\n  float z = cos(theta);\r\n  vec3 N = vec3(x,y,z);\r\n  vec3 V = N;\r\n  for (int i = 0; i < SAMPLE_COUNT; ++i)\r\n  {\r\n    vec2 Xi = HammersleyNoBitOps(i, SAMPLE_COUNT);\r\n    vec3 H = ImportanceSampleGGX(Xi, N, roughness);\r\n    vec3 L = normalize(2.0 * dot(V, H) * H - V);\r\n\r\n    float NdotL = max(dot(N, L), 0.0);\r\n    if (NdotL > 0.0)\r\n    {\r\n      prefilteredColor += texture2D(environmentMap, nTOE(L)).xyz * NdotL;\r\n      totalWeight += NdotL;\r\n    }\r\n  }\r\n  prefilteredColor = prefilteredColor / totalWeight;\r\n\r\n  gl_FragColor = vec4(prefilteredColor, 1.0);\r\n}\r\n\r\nvec3 ImportanceSampleGGX(vec2 Xi, vec3 N, float roughness){\r\n  float a = roughness * roughness;\r\n\r\n  float phi = 2.0 * PI * Xi.x;\r\n  float cosTheta = sqrt((1.0 - Xi.y) / (1.0 + (a * a - 1.0) * Xi.y));\r\n  float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\r\n  // from spherical coordinates to cartesian coordinates\r\n  vec3 H;\r\n  H.x = cos(phi) * sinTheta;\r\n  H.y = sin(phi) * sinTheta;\r\n  H.z = cosTheta;\r\n\r\n  // from tangent-space vector to world-space sample vector\r\n  vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\r\n  vec3 tangent = normalize(cross(up, N));\r\n  vec3 bitangent = cross(N, tangent);\r\n\r\n  vec3 sampleVec = tangent * H.x + bitangent * H.y + N * H.z;\r\n  return normalize(sampleVec);\r\n}\r\n\r\n\r\nfloat VanDerCorput(int n, int base)\r\n{\r\n  float invBase = 1.0 / float(base);\r\n  float denom = 1.0;\r\n  float result = 0.0;\r\n\r\n  for (int i = 0; i < 32; ++i)\r\n  {\r\n\tif (n > 0)\r\n\t{\r\n  \tdenom = mod(float(n), 2.0);\r\n  \tresult += denom * invBase;\r\n  \tinvBase = invBase / 2.0;\r\n  \tn = int(float(n) / 2.0);\r\n\t}\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nvec2 HammersleyNoBitOps(int i, int N)\r\n{\r\n  return vec2(float(i) / float(N), VanDerCorput(i, 2));\r\n}\r\n"};for(var key in defaultShaders){defaultShaders[key]=webgl2CompatibilityShader+defaultShaders[key]}var filterShaderFrags=(_filterShaderFrags={},_defineProperty(_filterShaderFrags,constants.GRAY,"precision highp float;\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D tex0;\n\nfloat luma(vec3 color) {\n  // weighted grayscale with luminance values\n  return dot(color, vec3(0.2126, 0.7152, 0.0722));\n}\n\nvoid main() {\n  vec4 tex = texture2D(tex0, vTexCoord);\n  float gray = luma(tex.rgb);\n  gl_FragColor = vec4(gray, gray, gray, tex.a);\n}\n"),_defineProperty(_filterShaderFrags,constants.ERODE,"// Reduces the bright areas in an image\n\nprecision highp float;\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D tex0;\nuniform vec2 texelSize;\n\nfloat luma(vec3 color) {\n  // weighted grayscale with luminance values\n  // weights 77, 151, 28 taken from src/image/filters.js\n  return dot(color, vec3(0.300781, 0.589844, 0.109375));\n}\n\nvoid main() {\n  vec4 color = texture2D(tex0, vTexCoord);\n  float lum = luma(color.rgb);\n\n  // set current color as the darkest neighbor color\n\n  vec4 neighbors[4];\n  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));\n  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));\n  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));\n  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));\n\n  for (int i = 0; i < 4; i++) {\n    vec4 neighborColor = neighbors[i];\n    float neighborLum = luma(neighborColor.rgb);\n\n    if (neighborLum < lum) {\n      color = neighborColor;\n      lum = neighborLum;\n    }\n  }\n\n  gl_FragColor = color;\n}\n"),_defineProperty(_filterShaderFrags,constants.DILATE,"// Increase the bright areas in an image\n\nprecision highp float;\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D tex0;\nuniform vec2 texelSize;\n\nfloat luma(vec3 color) {\n  // weighted grayscale with luminance values\n  // weights 77, 151, 28 taken from src/image/filters.js\n  return dot(color, vec3(0.300781, 0.589844, 0.109375));\n}\n\nvoid main() {\n  vec4 color = texture2D(tex0, vTexCoord);\n  float lum = luma(color.rgb);\n\n  // set current color as the brightest neighbor color\n\n  vec4 neighbors[4];\n  neighbors[0] = texture2D(tex0, vTexCoord + vec2( texelSize.x, 0.0));\n  neighbors[1] = texture2D(tex0, vTexCoord + vec2(-texelSize.x, 0.0));\n  neighbors[2] = texture2D(tex0, vTexCoord + vec2(0.0,  texelSize.y));\n  neighbors[3] = texture2D(tex0, vTexCoord + vec2(0.0, -texelSize.y));\n\n  for (int i = 0; i < 4; i++) {\n    vec4 neighborColor = neighbors[i];\n    float neighborLum = luma(neighborColor.rgb);\n\n    if (neighborLum > lum) {\n      color = neighborColor;\n      lum = neighborLum;\n    }\n  }\n\n  gl_FragColor = color;\n}\n"),_defineProperty(_filterShaderFrags,constants.BLUR,"precision highp float;\n\n// Two-pass blur filter, unweighted kernel.\n// See also a similar blur at Adam Ferriss' repo of shader examples:\n// https://github.com/aferriss/p5jsShaderExamples/blob/gh-pages/4_image-effects/4-9_single-pass-blur/effect.frag\n\n\nuniform sampler2D tex0;\nvarying vec2 vTexCoord;\nuniform vec2 direction;\nuniform vec2 canvasSize;\nuniform float radius;\n\nfloat random(vec2 p) {\n  vec3 p3  = fract(vec3(p.xyx) * .1031);\n  p3 += dot(p3, p3.yzx + 33.33);\n  return fract((p3.x + p3.y) * p3.z);\n}\n\n// This isn't a real Gaussian weight, it's a quadratic weight. It's what the\n// CPU mode's blur uses though, so we also use it here to match.\nfloat quadWeight(float x, float e) {\n  return pow(e-abs(x), 2.);\n}\n\nvoid main(){\n  vec2 uv = vTexCoord;\n\n  // A reasonable maximum number of samples\n  const float maxSamples = 64.0;\n\n  float numSamples = floor(7. * radius);\n  if (fract(numSamples / 2.) == 0.) {\n    numSamples++;\n  }\n  vec4 avg = vec4(0.0);\n  float total = 0.0;\n\n  // Calculate the spacing to avoid skewing if numSamples > maxSamples\n  float spacing = 1.0;\n  if (numSamples > maxSamples) {\n    spacing = numSamples / maxSamples;\n    numSamples = maxSamples;\n  }\n\n  float randomOffset = (spacing - 1.0) * mix(-0.5, 0.5, random(gl_FragCoord.xy));\n  for (float i = 0.0; i < maxSamples; i++) {\n    if (i >= numSamples) break;\n\n    float sample = i * spacing - (numSamples - 1.0) * 0.5 * spacing + randomOffset;\n    vec2 sampleCoord = uv + vec2(sample, sample) / canvasSize * direction;\n    float weight = quadWeight(sample, (numSamples - 1.0) * 0.5 * spacing);\n\n    avg += weight * texture2D(tex0, sampleCoord);\n    total += weight;\n  }\n\n  avg /= total;\n  gl_FragColor = avg;\n}\n"),_defineProperty(_filterShaderFrags,constants.POSTERIZE,"// Limit color space for a stylized cartoon / poster effect\n\nprecision highp float;\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D tex0;\nuniform float filterParameter;\n\nvec3 quantize(vec3 color, float n) {\n  // restrict values to N options/bins\n  // and floor each channel to nearest value\n  //\n  // eg. when N = 5, values = 0.0, 0.25, 0.50, 0.75, 1.0\n  // then quantize (0.1, 0.7, 0.9) -> (0.0, 0.5, 1.0)\n\n  color = color * n;\n  color = floor(color);\n  color = color / (n - 1.0);\n  return color;\n}\n\nvoid main() {\n  vec4 color = texture2D(tex0, vTexCoord);\n\n  vec3 restrictedColor = quantize(color.rgb / color.a, filterParameter);\n\n  gl_FragColor = vec4(restrictedColor.rgb * color.a, color.a);\n}\n"),_defineProperty(_filterShaderFrags,constants.OPAQUE,"// Set alpha channel to entirely opaque\n\nprecision highp float;\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D tex0;\n\nvoid main() {\n  vec4 color = texture2D(tex0, vTexCoord);\n  gl_FragColor = vec4(color.rgb / color.a, 1.0);\n}\n"),_defineProperty(_filterShaderFrags,constants.INVERT,"// Set each pixel to inverse value\n// Note that original INVERT does not change the opacity, so this follows suit\n\nprecision highp float;\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D tex0;\n\nvoid main() {\nvec4 color = texture2D(tex0, vTexCoord);\nvec3 origColor = color.rgb / color.a;\nvec3 invertedColor = vec3(1.0) - origColor;\ngl_FragColor = vec4(invertedColor * color.a, color.a);\n}\n"),_defineProperty(_filterShaderFrags,constants.THRESHOLD,"// Convert pixels to either white or black, \n// depending on if their luma is above or below filterParameter\n\nprecision highp float;\n\nvarying vec2 vTexCoord;\n\nuniform sampler2D tex0;\nuniform float filterParameter;\n\nfloat luma(vec3 color) {\n  // weighted grayscale with luminance values\n  return dot(color, vec3(0.2126, 0.7152, 0.0722));\n}\n\nvoid main() {\n  vec4 color = texture2D(tex0, vTexCoord);\n  float gray = luma(color.rgb / color.a);\n  // floor() used to match src/image/filters.js\n  float threshold = floor(filterParameter * 255.0) / 255.0;\n  float blackOrWhite = step(threshold, gray);\n  gl_FragColor = vec4(vec3(blackOrWhite) * color.a, color.a);\n}\n"),_filterShaderFrags);var filterShaderVert="uniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nattribute vec3 aPosition;\n// texcoords only come from p5 to vertex shader\n// so pass texcoords on to the fragment shader in a varying variable\nattribute vec2 aTexCoord;\nvarying vec2 vTexCoord;\n\nvoid main() {\n  // transferring texcoords for the frag shader\n  vTexCoord = aTexCoord;\n\n  // copy position with a fourth coordinate for projection (1.0 is normal)\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n}\n";_main.default.prototype.setAttributes=function(key,value){if(typeof this._glAttributes==="undefined"){console.log("You are trying to use setAttributes on a p5.Graphics object "+"that does not use a WEBGL renderer.");return}var unchanged=true;if(typeof value!=="undefined"){if(this._glAttributes===null){this._glAttributes={}}if(this._glAttributes[key]!==value){this._glAttributes[key]=value;unchanged=false}}else if(key instanceof Object){if(this._glAttributes!==key){this._glAttributes=key;unchanged=false}}if(!this._renderer.isP3D||unchanged){return}if(!this._setupDone){for(var x in this._renderer.retainedMode.geometry){if(this._renderer.retainedMode.geometry.hasOwnProperty(x)){_main.default._friendlyError("Sorry, Could not set the attributes, you need to call setAttributes() "+"before calling the other drawing methods in setup()");return}}}this.push();this._renderer._resetContext();this.pop();if(this._renderer._curCamera){this._renderer._curCamera._renderer=this._renderer}};function readPixelsWebGL(pixels,gl,framebuffer,x,y,width,height,format,type,flipY){var prevFramebuffer=gl.getParameter(gl.FRAMEBUFFER_BINDING);gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer);var channels=format===gl.RGBA?4:3;var len=width*height*channels;var TypedArrayClass=type===gl.UNSIGNED_BYTE?Uint8Array:Float32Array;if(!(pixels instanceof TypedArrayClass)||pixels.length!==len){pixels=new TypedArrayClass(len)}gl.readPixels(x,flipY?flipY-y-height:y,width,height,format,type,pixels);gl.bindFramebuffer(gl.FRAMEBUFFER,prevFramebuffer);if(flipY){var halfHeight=Math.floor(height/2);var tmpRow=new TypedArrayClass(width*channels);for(var _y=0;_y<halfHeight;_y++){var topOffset=_y*width*4;var bottomOffset=(height-_y-1)*width*4;tmpRow.set(pixels.subarray(topOffset,topOffset+width*4));pixels.copyWithin(topOffset,bottomOffset,bottomOffset+width*4);pixels.set(tmpRow,bottomOffset)}}return pixels}function readPixelWebGL(gl,framebuffer,x,y,format,type,flipY){var prevFramebuffer=gl.getParameter(gl.FRAMEBUFFER_BINDING);gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer);var channels=format===gl.RGBA?4:3;var TypedArrayClass=type===gl.UNSIGNED_BYTE?Uint8Array:Float32Array;var pixels=new TypedArrayClass(channels);gl.readPixels(x,flipY?flipY-y-1:y,1,1,format,type,pixels);gl.bindFramebuffer(gl.FRAMEBUFFER,prevFramebuffer);return Array.from(pixels)}_main.default.RendererGL=function(_p5$Renderer){_inherits(RendererGL,_p5$Renderer);var _super=_createSuper(RendererGL);function RendererGL(elt,pInst,isMainCanvas,attr){var _this;_classCallCheck(this,RendererGL);_this=_super.call(this,elt,pInst,isMainCanvas);_this._setAttributeDefaults(pInst);_this._initContext();_this.isP3D=true;_this.geometryBuilder=undefined;_this.GL=_this.drawingContext;_this._pInst._setProperty("drawingContext",_this.drawingContext);_this._isErasing=false;_this._clipDepths=[];_this._isClipApplied=false;_this._stencilTestOn=false;_this._enableLighting=false;_this.ambientLightColors=[];_this.specularColors=[1,1,1];_this.directionalLightDirections=[];_this.directionalLightDiffuseColors=[];_this.directionalLightSpecularColors=[];_this.pointLightPositions=[];_this.pointLightDiffuseColors=[];_this.pointLightSpecularColors=[];_this.spotLightPositions=[];_this.spotLightDirections=[];_this.spotLightDiffuseColors=[];_this.spotLightSpecularColors=[];_this.spotLightAngle=[];_this.spotLightConc=[];_this.activeImageLight=null;_this.diffusedTextures=new Map;_this.specularTextures=new Map;_this.drawMode=constants.FILL;_this.curFillColor=_this._cachedFillStyle=[1,1,1,1];_this.curAmbientColor=_this._cachedFillStyle=[1,1,1,1];_this.curSpecularColor=_this._cachedFillStyle=[0,0,0,0];_this.curEmissiveColor=_this._cachedFillStyle=[0,0,0,0];_this.curStrokeColor=_this._cachedStrokeStyle=[0,0,0,1];_this.curBlendMode=constants.BLEND;_this._cachedBlendMode=undefined;if(_this.webglVersion===constants.WEBGL2){_this.blendExt=_this.GL}else{_this.blendExt=_this.GL.getExtension("EXT_blend_minmax")}_this._isBlending=false;_this._hasSetAmbient=false;_this._useSpecularMaterial=false;_this._useEmissiveMaterial=false;_this._useNormalMaterial=false;_this._useShininess=1;_this._useLineColor=false;_this._useVertexColor=false;_this.registerEnabled=new Set;_this._tint=[255,255,255,255];_this.constantAttenuation=1;_this.linearAttenuation=0;_this.quadraticAttenuation=0;_this.uMVMatrix=new _main.default.Matrix;_this.uPMatrix=new _main.default.Matrix;_this.uNMatrix=new _main.default.Matrix("mat3");_this._currentNormal=new _main.default.Vector(0,0,1);_this._curCamera=new _main.default.Camera(_assertThisInitialized(_this));_this._curCamera._computeCameraDefaultSettings();_this._curCamera._setDefaultCamera();_this.filterCamera=new _main.default.Camera(_assertThisInitialized(_this));_this.filterCamera._computeCameraDefaultSettings();_this.filterCamera._setDefaultCamera();_this.prevTouches=[];_this.zoomVelocity=0;_this.rotateVelocity=new _main.default.Vector(0,0);_this.moveVelocity=new _main.default.Vector(0,0);_this.executeZoom=false;_this.executeRotateAndMove=false;_this._defaultLightShader=undefined;_this._defaultImmediateModeShader=undefined;_this._defaultNormalShader=undefined;_this._defaultColorShader=undefined;_this._defaultPointShader=undefined;_this.userFillShader=undefined;_this.userStrokeShader=undefined;_this.userPointShader=undefined;_this.retainedMode={geometry:{},buffers:{stroke:[new _main.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",_assertThisInitialized(_this)),new _main.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",_assertThisInitialized(_this)),new _main.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",_assertThisInitialized(_this)),new _main.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",_assertThisInitialized(_this)),new _main.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",_assertThisInitialized(_this))],fill:[new _main.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",_assertThisInitialized(_this),_this._vToNArray),new _main.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",_assertThisInitialized(_this),_this._vToNArray),new _main.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",_assertThisInitialized(_this)),new _main.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",_assertThisInitialized(_this)),new _main.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",_assertThisInitialized(_this),_this._flatten)],text:[new _main.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",_assertThisInitialized(_this),_this._vToNArray),new _main.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",_assertThisInitialized(_this),_this._flatten)]}};_this.immediateMode={geometry:new _main.default.Geometry,shapeMode:constants.TRIANGLE_FAN,contourIndices:[],_bezierVertex:[],_quadraticVertex:[],_curveVertex:[],buffers:{fill:[new _main.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",_assertThisInitialized(_this),_this._vToNArray),new _main.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",_assertThisInitialized(_this),_this._vToNArray),new _main.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",_assertThisInitialized(_this)),new _main.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",_assertThisInitialized(_this)),new _main.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",_assertThisInitialized(_this),_this._flatten)],stroke:[new _main.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",_assertThisInitialized(_this)),new _main.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",_assertThisInitialized(_this)),new _main.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",_assertThisInitialized(_this)),new _main.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",_assertThisInitialized(_this)),new _main.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",_assertThisInitialized(_this))],point:_this.GL.createBuffer()}};_this.pointSize=5;_this.curStrokeWeight=1;_this.curStrokeCap=constants.ROUND;_this.curStrokeJoin=constants.ROUND;_this.textures=new Map;_this.framebuffers=new Set;_this.activeFramebuffers=[];_this.filterShader=undefined;_this.filterLayer=undefined;_this.filterLayerTemp=undefined;_this.defaultFilterShaders={};_this.textureMode=constants.IMAGE;_this.textureWrapX=constants.CLAMP;_this.textureWrapY=constants.CLAMP;_this._tex=null;_this._curveTightness=6;_this._lookUpTableBezier=[];_this._lookUpTableQuadratic=[];_this._lutBezierDetail=0;_this._lutQuadraticDetail=0;_this.isProcessingVertices=false;_this._tessy=_this._initTessy();_this.fontInfos={};_this._curShader=undefined;return _this}_createClass(RendererGL,[{key:"beginGeometry",value:function beginGeometry(){if(this.geometryBuilder){throw new Error("It looks like `beginGeometry()` is being called while another p5.Geometry is already being build.")}this.geometryBuilder=new _GeometryBuilder.default(this)}},{key:"endGeometry",value:function endGeometry(){if(!this.geometryBuilder){throw new Error("Make sure you call beginGeometry() before endGeometry()!")}var geometry=this.geometryBuilder.finish();this.geometryBuilder=undefined;return geometry}},{key:"buildGeometry",value:function buildGeometry(callback){this.beginGeometry();callback();return this.endGeometry()}},{key:"_setAttributeDefaults",value:function _setAttributeDefaults(pInst){var applyAA=navigator.userAgent.toLowerCase().includes("safari");var defaults={alpha:true,depth:true,stencil:true,antialias:applyAA,premultipliedAlpha:true,preserveDrawingBuffer:true,perPixelLighting:true,version:2};if(pInst._glAttributes===null){pInst._glAttributes=defaults}else{pInst._glAttributes=Object.assign(defaults,pInst._glAttributes)}return}},{key:"_initContext",value:function _initContext(){if(this._pInst._glAttributes.version!==1){this.drawingContext=this.canvas.getContext("webgl2",this._pInst._glAttributes)}this.webglVersion=this.drawingContext?constants.WEBGL2:constants.WEBGL;this._pInst._setProperty("webglVersion",this.webglVersion);if(!this.drawingContext){this.drawingContext=this.canvas.getContext("webgl",this._pInst._glAttributes)||this.canvas.getContext("experimental-webgl",this._pInst._glAttributes)}if(this.drawingContext===null){throw new Error("Error creating webgl context")}else{var gl=this.drawingContext;gl.enable(gl.DEPTH_TEST);gl.depthFunc(gl.LEQUAL);gl.viewport(0,0,gl.drawingBufferWidth,gl.drawingBufferHeight);gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);this._viewport=this.drawingContext.getParameter(this.drawingContext.VIEWPORT)}}},{key:"_resetContext",value:function _resetContext(options,callback){var w=this.width;var h=this.height;var defaultId=this.canvas.id;var isPGraphics=this._pInst instanceof _main.default.Graphics;if(isPGraphics){var pg=this._pInst;pg.canvas.parentNode.removeChild(pg.canvas);pg.canvas=document.createElement("canvas");var node=pg._pInst._userNode||document.body;node.appendChild(pg.canvas);_main.default.Element.call(pg,pg.canvas,pg._pInst);pg.width=w;pg.height=h}else{var c=this.canvas;if(c){c.parentNode.removeChild(c)}c=document.createElement("canvas");c.id=defaultId;if(this._pInst._userNode){this._pInst._userNode.appendChild(c)}else{document.body.appendChild(c)}this._pInst.canvas=c;this.canvas=c}var renderer=new _main.default.RendererGL(this._pInst.canvas,this._pInst,!isPGraphics);this._pInst._setProperty("_renderer",renderer);renderer.resize(w,h);renderer._applyDefaults();if(!isPGraphics){this._pInst._elements.push(renderer)}if(typeof callback==="function"){setTimeout(function(){callback.apply(window._renderer,options)},0)}}},{key:"_update",value:function _update(){this.uMVMatrix.set(this._curCamera.cameraMatrix.mat4[0],this._curCamera.cameraMatrix.mat4[1],this._curCamera.cameraMatrix.mat4[2],this._curCamera.cameraMatrix.mat4[3],this._curCamera.cameraMatrix.mat4[4],this._curCamera.cameraMatrix.mat4[5],this._curCamera.cameraMatrix.mat4[6],this._curCamera.cameraMatrix.mat4[7],this._curCamera.cameraMatrix.mat4[8],this._curCamera.cameraMatrix.mat4[9],this._curCamera.cameraMatrix.mat4[10],this._curCamera.cameraMatrix.mat4[11],this._curCamera.cameraMatrix.mat4[12],this._curCamera.cameraMatrix.mat4[13],this._curCamera.cameraMatrix.mat4[14],this._curCamera.cameraMatrix.mat4[15]);this.ambientLightColors.length=0;this.specularColors=[1,1,1];this.directionalLightDirections.length=0;this.directionalLightDiffuseColors.length=0;this.directionalLightSpecularColors.length=0;this.pointLightPositions.length=0;this.pointLightDiffuseColors.length=0;this.pointLightSpecularColors.length=0;this.spotLightPositions.length=0;this.spotLightDirections.length=0;this.spotLightDiffuseColors.length=0;this.spotLightSpecularColors.length=0;this.spotLightAngle.length=0;this.spotLightConc.length=0;this._enableLighting=false;this._tint=[255,255,255,255];this.GL.clearStencil(0);this.GL.clear(this.GL.DEPTH_BUFFER_BIT|this.GL.STENCIL_BUFFER_BIT);this.GL.disable(this.GL.STENCIL_TEST)}},{key:"background",value:function background(){var _this$_pInst;var _col=(_this$_pInst=this._pInst).color.apply(_this$_pInst,arguments);var _r=_col.levels[0]/255;var _g=_col.levels[1]/255;var _b=_col.levels[2]/255;var _a=_col.levels[3]/255;this.clear(_r,_g,_b,_a)}},{key:"fill",value:function fill(v1,v2,v3,a){var color=_main.default.prototype.color.apply(this._pInst,arguments);this.curFillColor=color._array;this.drawMode=constants.FILL;this._useNormalMaterial=false;this._tex=null}},{key:"stroke",value:function stroke(r,g,b,a){var color=_main.default.prototype.color.apply(this._pInst,arguments);this.curStrokeColor=color._array}},{key:"strokeCap",value:function strokeCap(cap){this.curStrokeCap=cap}},{key:"strokeJoin",value:function strokeJoin(join){this.curStrokeJoin=join}},{key:"getFilterLayer",value:function getFilterLayer(){if(!this.filterLayer){this.filterLayer=this._pInst.createFramebuffer()}return this.filterLayer}},{key:"getFilterLayerTemp",value:function getFilterLayerTemp(){if(!this.filterLayerTemp){this.filterLayerTemp=this._pInst.createFramebuffer()}return this.filterLayerTemp}},{key:"matchSize",value:function matchSize(fboToMatch,target){if(fboToMatch.width!==target.width||fboToMatch.height!==target.height){fboToMatch.resize(target.width,target.height)}if(fboToMatch.pixelDensity()!==target.pixelDensity()){fboToMatch.pixelDensity(target.pixelDensity())}}},{key:"filter",value:function filter(){var _this2=this;var fbo=this.getFilterLayer();var filterParameter=undefined;var operation=undefined;if(typeof(arguments.length<=0?undefined:arguments[0])==="string"){var _defaults;operation=arguments.length<=0?undefined:arguments[0];var defaults=(_defaults={},_defineProperty(_defaults,constants.BLUR,3),_defineProperty(_defaults,constants.POSTERIZE,4),_defineProperty(_defaults,constants.THRESHOLD,.5),_defaults);var useDefaultParam=operation in defaults&&(arguments.length<=1?undefined:arguments[1])===undefined;filterParameter=useDefaultParam?defaults[operation]:arguments.length<=1?undefined:arguments[1];if(!(operation in this.defaultFilterShaders)){this.defaultFilterShaders[operation]=new _main.default.Shader(fbo._renderer,filterShaderVert,filterShaderFrags[operation])}this.filterShader=this.defaultFilterShaders[operation]}else{this.filterShader=arguments.length<=0?undefined:arguments[0]}var target=this.activeFramebuffer()||this;this.matchSize(fbo,target);if(target!==this){this.filterCamera=this.getFilterLayer().createCamera()}fbo.draw(function(){return _this2._pInst.clear()});var texelSize=[1/(target.width*target.pixelDensity()),1/(target.height*target.pixelDensity())];if(operation===constants.BLUR){var tmp=this.getFilterLayerTemp();this.matchSize(tmp,target);this._pInst.push();this._pInst.noStroke();this._pInst.shader(this.filterShader);this.filterShader.setUniform("texelSize",texelSize);this.filterShader.setUniform("canvasSize",[target.width,target.height]);this.filterShader.setUniform("radius",Math.max(1,filterParameter));tmp.draw(function(){_this2.filterShader.setUniform("direction",[1,0]);_this2.filterShader.setUniform("tex0",target);_this2._pInst.clear();_this2._pInst.shader(_this2.filterShader);_this2._pInst.rect(-target.width/2,-target.height/2,target.width,target.height)});fbo.draw(function(){_this2.filterShader.setUniform("direction",[0,1]);_this2.filterShader.setUniform("tex0",tmp);_this2._pInst.clear();_this2._pInst.shader(_this2.filterShader);_this2._pInst.rect(-target.width/2,-target.height/2,target.width,target.height)});this._pInst.pop()}else{fbo.draw(function(){_this2._pInst.noStroke();_this2._pInst.shader(_this2.filterShader);_this2.filterShader.setUniform("tex0",target);_this2.filterShader.setUniform("texelSize",texelSize);_this2.filterShader.setUniform("canvasSize",[target.width,target.height]);_this2.filterShader.setUniform("filterParameter",filterParameter);_this2._pInst.rect(-target.width/2,-target.height/2,target.width,target.height)})}this._pInst.push();this._pInst.noStroke();this.clear();this._pInst.push();this._pInst.imageMode(constants.CORNER);this._pInst.blendMode(constants.BLEND);this.filterCamera._resize();this._pInst.setCamera(this.filterCamera);this._pInst.resetMatrix();this._pInst.image(fbo,-this.width/2,-this.height/2,this.width,this.height);this._pInst.pop();this._pInst.pop()}},{key:"pixelDensity",value:function pixelDensity(newDensity){if(newDensity){return this._pInst.pixelDensity(newDensity)}return this._pInst.pixelDensity()}},{key:"blendMode",value:function blendMode(mode){if(mode===constants.DARKEST||mode===constants.LIGHTEST||mode===constants.ADD||mode===constants.BLEND||mode===constants.SUBTRACT||mode===constants.SCREEN||mode===constants.EXCLUSION||mode===constants.REPLACE||mode===constants.MULTIPLY||mode===constants.REMOVE)this.curBlendMode=mode;else if(mode===constants.BURN||mode===constants.OVERLAY||mode===constants.HARD_LIGHT||mode===constants.SOFT_LIGHT||mode===constants.DODGE){console.warn("BURN, OVERLAY, HARD_LIGHT, SOFT_LIGHT, and DODGE only work for blendMode in 2D mode.")}}},{key:"erase",value:function erase(opacityFill,opacityStroke){if(!this._isErasing){this._cachedBlendMode=this.curBlendMode;this._isErasing=true;this.blendMode(constants.REMOVE);this._cachedFillStyle=this.curFillColor.slice();this.curFillColor=[1,1,1,opacityFill/255];this._cachedStrokeStyle=this.curStrokeColor.slice();this.curStrokeColor=[1,1,1,opacityStroke/255]}}},{key:"noErase",value:function noErase(){if(this._isErasing){this.curFillColor=this._cachedFillStyle.slice();this.curStrokeColor=this._cachedStrokeStyle.slice();var temp=this.curBlendMode;this.blendMode(this._cachedBlendMode);this._cachedBlendMode=temp;this._isErasing=false;this._applyBlendMode()}}},{key:"drawTarget",value:function drawTarget(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||this}},{key:"beginClip",value:function beginClip(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_get(_getPrototypeOf(RendererGL.prototype),"beginClip",this).call(this,options);this.drawTarget()._isClipApplied=true;var gl=this.GL;gl.clearStencil(0);gl.clear(gl.STENCIL_BUFFER_BIT);gl.enable(gl.STENCIL_TEST);this._stencilTestOn=true;gl.stencilFunc(gl.ALWAYS,1,255);gl.stencilOp(gl.KEEP,gl.KEEP,gl.REPLACE);gl.disable(gl.DEPTH_TEST);this._pInst.push();this._pInst.resetShader();if(this._doFill)this._pInst.fill(0,0);if(this._doStroke)this._pInst.stroke(0,0)}},{key:"endClip",value:function endClip(){this._pInst.pop();var gl=this.GL;gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP);gl.stencilFunc(this._clipInvert?gl.EQUAL:gl.NOTEQUAL,0,255);gl.enable(gl.DEPTH_TEST);this._clipDepths.push(this._pushPopDepth);_get(_getPrototypeOf(RendererGL.prototype),"endClip",this).call(this)}},{key:"_clearClip",value:function _clearClip(){this.GL.clearStencil(1);this.GL.clear(this.GL.STENCIL_BUFFER_BIT);if(this._clipDepths.length>0){this._clipDepths.pop()}this.drawTarget()._isClipApplied=false}},{key:"strokeWeight",value:function strokeWeight(w){if(this.curStrokeWeight!==w){this.pointSize=w;this.curStrokeWeight=w}}},{key:"_getPixel",value:function _getPixel(x,y){var gl=this.GL;return readPixelWebGL(gl,null,x,y,gl.RGBA,gl.UNSIGNED_BYTE,this._pInst.height*this._pInst.pixelDensity())}},{key:"loadPixels",value:function loadPixels(){var pixelsState=this._pixelsState;if(this._pInst._glAttributes.preserveDrawingBuffer!==true){console.log("loadPixels only works in WebGL when preserveDrawingBuffer "+"is true.");return}var pd=this._pInst._pixelDensity;var gl=this.GL;pixelsState._setProperty("pixels",readPixelsWebGL(pixelsState.pixels,gl,null,0,0,this.width*pd,this.height*pd,gl.RGBA,gl.UNSIGNED_BYTE,this.height*pd))}},{key:"updatePixels",value:function updatePixels(){var fbo=this._getTempFramebuffer();fbo.pixels=this._pixelsState.pixels;fbo.updatePixels();this._pInst.push();this._pInst.resetMatrix();this._pInst.clear();this._pInst.imageMode(constants.CENTER);this._pInst.image(fbo,0,0);this._pInst.pop();this.GL.clearDepth(1);this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}},{key:"_getTempFramebuffer",value:function _getTempFramebuffer(){if(!this._tempFramebuffer){this._tempFramebuffer=this._pInst.createFramebuffer({format:constants.UNSIGNED_BYTE,useDepth:this._pInst._glAttributes.depth,depthFormat:constants.UNSIGNED_INT,antialias:this._pInst._glAttributes.antialias})}return this._tempFramebuffer}},{key:"geometryInHash",value:function geometryInHash(gId){return this.retainedMode.geometry[gId]!==undefined}},{key:"viewport",value:function viewport(w,h){this._viewport=[0,0,w,h];this.GL.viewport(0,0,w,h)}},{key:"resize",value:function resize(w,h){_main.default.Renderer.prototype.resize.call(this,w,h);this._origViewport={width:this.GL.drawingBufferWidth,height:this.GL.drawingBufferHeight};this.viewport(this._origViewport.width,this._origViewport.height);this._curCamera._resize();var pixelsState=this._pixelsState;if(typeof pixelsState.pixels!=="undefined"){pixelsState._setProperty("pixels",new Uint8Array(this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4))}var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.framebuffers[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var framebuffer=_step.value;framebuffer._canvasSizeChanged()}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}},{key:"clear",value:function clear(){var _r=(arguments.length<=0?undefined:arguments[0])||0;var _g=(arguments.length<=1?undefined:arguments[1])||0;var _b=(arguments.length<=2?undefined:arguments[2])||0;var _a=(arguments.length<=3?undefined:arguments[3])||0;var activeFramebuffer=this.activeFramebuffer();if(activeFramebuffer&&activeFramebuffer.format===constants.UNSIGNED_BYTE&&!activeFramebuffer.antialias&&_a===0){_a=1e-10}this.GL.clearColor(_r*_a,_g*_a,_b*_a,_a);this.GL.clearDepth(1);this.GL.clear(this.GL.COLOR_BUFFER_BIT|this.GL.DEPTH_BUFFER_BIT)}},{key:"applyMatrix",value:function applyMatrix(a,b,c,d,e,f){if(arguments.length===16){_main.default.Matrix.prototype.apply.apply(this.uMVMatrix,arguments)}else{this.uMVMatrix.apply([a,b,0,0,c,d,0,0,0,0,1,0,e,f,0,1])}}},{key:"translate",value:function translate(x,y,z){if(x instanceof _main.default.Vector){z=x.z;y=x.y;x=x.x}this.uMVMatrix.translate([x,y,z]);return this}},{key:"scale",value:function scale(x,y,z){this.uMVMatrix.scale(x,y,z);return this}},{key:"rotate",value:function rotate(rad,axis){if(typeof axis==="undefined"){return this.rotateZ(rad)}_main.default.Matrix.prototype.rotate.apply(this.uMVMatrix,arguments);return this}},{key:"rotateX",value:function rotateX(rad){this.rotate(rad,1,0,0);return this}},{key:"rotateY",value:function rotateY(rad){this.rotate(rad,0,1,0);return this}},{key:"rotateZ",value:function rotateZ(rad){this.rotate(rad,0,0,1);return this}},{key:"push",value:function push(){var style=_main.default.Renderer.prototype.push.apply(this);var properties=style.properties;properties.uMVMatrix=this.uMVMatrix.copy();properties.uPMatrix=this.uPMatrix.copy();properties._curCamera=this._curCamera;this._curCamera=this._curCamera.copy();properties.ambientLightColors=this.ambientLightColors.slice();properties.specularColors=this.specularColors.slice();properties.directionalLightDirections=this.directionalLightDirections.slice();properties.directionalLightDiffuseColors=this.directionalLightDiffuseColors.slice();properties.directionalLightSpecularColors=this.directionalLightSpecularColors.slice();properties.pointLightPositions=this.pointLightPositions.slice();properties.pointLightDiffuseColors=this.pointLightDiffuseColors.slice();properties.pointLightSpecularColors=this.pointLightSpecularColors.slice();properties.spotLightPositions=this.spotLightPositions.slice();properties.spotLightDirections=this.spotLightDirections.slice();properties.spotLightDiffuseColors=this.spotLightDiffuseColors.slice();properties.spotLightSpecularColors=this.spotLightSpecularColors.slice();properties.spotLightAngle=this.spotLightAngle.slice();properties.spotLightConc=this.spotLightConc.slice();properties.userFillShader=this.userFillShader;properties.userStrokeShader=this.userStrokeShader;properties.userPointShader=this.userPointShader;properties.pointSize=this.pointSize;properties.curStrokeWeight=this.curStrokeWeight;properties.curStrokeColor=this.curStrokeColor;properties.curFillColor=this.curFillColor;properties.curAmbientColor=this.curAmbientColor;properties.curSpecularColor=this.curSpecularColor;properties.curEmissiveColor=this.curEmissiveColor;properties._hasSetAmbient=this._hasSetAmbient;properties._useSpecularMaterial=this._useSpecularMaterial;properties._useEmissiveMaterial=this._useEmissiveMaterial;properties._useShininess=this._useShininess;properties.constantAttenuation=this.constantAttenuation;properties.linearAttenuation=this.linearAttenuation;properties.quadraticAttenuation=this.quadraticAttenuation;properties._enableLighting=this._enableLighting;properties._useNormalMaterial=this._useNormalMaterial;properties._tex=this._tex;properties.drawMode=this.drawMode;properties._currentNormal=this._currentNormal;properties.curBlendMode=this.curBlendMode;properties.activeImageLight=this.activeImageLight;return style}},{key:"pop",value:function pop(){var _get2;if(this._clipDepths.length>0&&this._pushPopDepth===this._clipDepths[this._clipDepths.length-1]){this._clearClip()}for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}(_get2=_get(_getPrototypeOf(RendererGL.prototype),"pop",this)).call.apply(_get2,[this].concat(args));this._applyStencilTestIfClipping()}},{key:"_applyStencilTestIfClipping",value:function _applyStencilTestIfClipping(){var drawTarget=this.drawTarget();if(drawTarget._isClipApplied!==this._stencilTestOn){if(drawTarget._isClipApplied){this.GL.enable(this.GL.STENCIL_TEST);this._stencilTestOn=true}else{this.GL.disable(this.GL.STENCIL_TEST);this._stencilTestOn=false}}}},{key:"resetMatrix",value:function resetMatrix(){this.uMVMatrix.set(this._curCamera.cameraMatrix.mat4[0],this._curCamera.cameraMatrix.mat4[1],this._curCamera.cameraMatrix.mat4[2],this._curCamera.cameraMatrix.mat4[3],this._curCamera.cameraMatrix.mat4[4],this._curCamera.cameraMatrix.mat4[5],this._curCamera.cameraMatrix.mat4[6],this._curCamera.cameraMatrix.mat4[7],this._curCamera.cameraMatrix.mat4[8],this._curCamera.cameraMatrix.mat4[9],this._curCamera.cameraMatrix.mat4[10],this._curCamera.cameraMatrix.mat4[11],this._curCamera.cameraMatrix.mat4[12],this._curCamera.cameraMatrix.mat4[13],this._curCamera.cameraMatrix.mat4[14],this._curCamera.cameraMatrix.mat4[15]);return this}},{key:"_getImmediateStrokeShader",value:function _getImmediateStrokeShader(){var stroke=this.userStrokeShader;if(!stroke||!stroke.isStrokeShader()){return this._getLineShader()}return stroke}},{key:"_getRetainedStrokeShader",value:function _getRetainedStrokeShader(){return this._getImmediateStrokeShader()}},{key:"_getImmediateFillShader",value:function _getImmediateFillShader(){var fill=this.userFillShader;if(this._useNormalMaterial){if(!fill||!fill.isNormalShader()){return this._getNormalShader()}}if(this._enableLighting){if(!fill||!fill.isLightShader()){return this._getLightShader()}}else if(this._tex){if(!fill||!fill.isTextureShader()){return this._getLightShader()}}else if(!fill){return this._getImmediateModeShader()}return fill}},{key:"_getRetainedFillShader",value:function _getRetainedFillShader(){if(this._useNormalMaterial){return this._getNormalShader()}var fill=this.userFillShader;if(this._enableLighting){if(!fill||!fill.isLightShader()){return this._getLightShader()}}else if(this._tex){if(!fill||!fill.isTextureShader()){return this._getLightShader()}}else if(!fill){return this._getColorShader()}return fill}},{key:"_getImmediatePointShader",value:function _getImmediatePointShader(){var point=this.userPointShader;if(!point||!point.isPointShader()){return this._getPointShader()}return point}},{key:"_getRetainedLineShader",value:function _getRetainedLineShader(){return this._getImmediateLineShader()}},{key:"_getLightShader",value:function _getLightShader(){if(!this._defaultLightShader){if(this._pInst._glAttributes.perPixelLighting){this._defaultLightShader=new _main.default.Shader(this,this._webGL2CompatibilityPrefix("vert","highp")+defaultShaders.phongVert,this._webGL2CompatibilityPrefix("frag","highp")+defaultShaders.phongFrag)}else{this._defaultLightShader=new _main.default.Shader(this,this._webGL2CompatibilityPrefix("vert","highp")+defaultShaders.lightVert,this._webGL2CompatibilityPrefix("frag","highp")+defaultShaders.lightTextureFrag)}}return this._defaultLightShader}},{key:"_getImmediateModeShader",value:function _getImmediateModeShader(){if(!this._defaultImmediateModeShader){this._defaultImmediateModeShader=new _main.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+defaultShaders.immediateVert,this._webGL2CompatibilityPrefix("frag","mediump")+defaultShaders.vertexColorFrag)}return this._defaultImmediateModeShader}},{key:"_getNormalShader",value:function _getNormalShader(){if(!this._defaultNormalShader){this._defaultNormalShader=new _main.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+defaultShaders.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+defaultShaders.normalFrag)}return this._defaultNormalShader}},{key:"_getColorShader",value:function _getColorShader(){if(!this._defaultColorShader){this._defaultColorShader=new _main.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+defaultShaders.normalVert,this._webGL2CompatibilityPrefix("frag","mediump")+defaultShaders.basicFrag)}return this._defaultColorShader}},{key:"_getPointShader",value:function _getPointShader(){if(!this._defaultPointShader){this._defaultPointShader=new _main.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+defaultShaders.pointVert,this._webGL2CompatibilityPrefix("frag","mediump")+defaultShaders.pointFrag)}return this._defaultPointShader}},{key:"_getLineShader",value:function _getLineShader(){if(!this._defaultLineShader){this._defaultLineShader=new _main.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+defaultShaders.lineVert,this._webGL2CompatibilityPrefix("frag","mediump")+defaultShaders.lineFrag)}return this._defaultLineShader}},{key:"_getFontShader",value:function _getFontShader(){if(!this._defaultFontShader){if(this.webglVersion===constants.WEBGL){this.GL.getExtension("OES_standard_derivatives")}this._defaultFontShader=new _main.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+defaultShaders.fontVert,this._webGL2CompatibilityPrefix("frag","mediump")+defaultShaders.fontFrag)}return this._defaultFontShader}},{key:"_webGL2CompatibilityPrefix",value:function _webGL2CompatibilityPrefix(shaderType,floatPrecision){var code="";if(this.webglVersion===constants.WEBGL2){code+="#version 300 es\n#define WEBGL2\n"}if(shaderType==="vert"){code+="#define VERTEX_SHADER\n"}else if(shaderType==="frag"){code+="#define FRAGMENT_SHADER\n"}if(floatPrecision){code+="precision ".concat(floatPrecision," float;\n")}return code}},{key:"_getEmptyTexture",value:function _getEmptyTexture(){if(!this._emptyTexture){var im=new _main.default.Image(1,1);im.set(0,0,255);this._emptyTexture=new _main.default.Texture(this,im)}return this._emptyTexture}},{key:"getTexture",value:function getTexture(input){var src=input;if(src instanceof _main.default.Framebuffer){src=src.color}var texture=this.textures.get(src);if(texture){return texture}var tex=new _main.default.Texture(this,src);this.textures.set(src,tex);return tex}},{key:"getDiffusedTexture",value:function getDiffusedTexture(input){if(this.diffusedTextures.get(input)!=null){return this.diffusedTextures.get(input)}var newGraphic;var smallWidth=200;var width=smallWidth;var height=Math.floor(smallWidth*(input.height/input.width));newGraphic=this._pInst.createGraphics(width,height,constants.WEBGL);var irradiance=newGraphic.createShader(defaultShaders.imageLightVert,defaultShaders.imageLightDiffusedFrag);newGraphic.shader(irradiance);irradiance.setUniform("environmentMap",input);newGraphic.noStroke();newGraphic.rectMode(newGraphic.CENTER);newGraphic.rect(0,0,newGraphic.width,newGraphic.height);this.diffusedTextures.set(input,newGraphic);return newGraphic}},{key:"getSpecularTexture",value:function getSpecularTexture(input){if(this.specularTextures.get(input)!=null){return this.specularTextures.get(input)}var size=512;var tex;var levels=[];var graphic=this._pInst.createGraphics(size,size,constants.WEBGL);var count=Math.log(size)/Math.log(2);graphic.pixelDensity(1);for(var w=size;w>=1;w/=2){graphic.resizeCanvas(w,w);var currCount=Math.log(w)/Math.log(2);var roughness=1-currCount/count;var myShader=graphic.createShader(defaultShaders.imageLightVert,defaultShaders.imageLightSpecularFrag);graphic.shader(myShader);graphic.clear();myShader.setUniform("environmentMap",input);myShader.setUniform("roughness",roughness);graphic.noStroke();graphic.plane(w,w);levels.push(graphic.get().drawingContext.getImageData(0,0,w,w))}graphic.remove();tex=new _p6.MipmapTexture(this,levels,{});this.specularTextures.set(input,tex);return tex}},{key:"activeFramebuffer",value:function activeFramebuffer(){return this.activeFramebuffers[this.activeFramebuffers.length-1]||null}},{key:"createFramebuffer",value:function createFramebuffer(options){return new _main.default.Framebuffer(this,options)}},{key:"_setStrokeUniforms",value:function _setStrokeUniforms(strokeShader){strokeShader.bindShader();strokeShader.setUniform("uUseLineColor",this._useLineColor);strokeShader.setUniform("uMaterialColor",this.curStrokeColor);strokeShader.setUniform("uStrokeWeight",this.curStrokeWeight);strokeShader.setUniform("uStrokeCap",STROKE_CAP_ENUM[this.curStrokeCap]);strokeShader.setUniform("uStrokeJoin",STROKE_JOIN_ENUM[this.curStrokeJoin])}},{key:"_setFillUniforms",value:function _setFillUniforms(fillShader){fillShader.bindShader();fillShader.setUniform("uUseVertexColor",this._useVertexColor);fillShader.setUniform("uMaterialColor",this.curFillColor);fillShader.setUniform("isTexture",!!this._tex);if(this._tex){fillShader.setUniform("uSampler",this._tex)}fillShader.setUniform("uTint",this._tint);fillShader.setUniform("uHasSetAmbient",this._hasSetAmbient);fillShader.setUniform("uAmbientMatColor",this.curAmbientColor);fillShader.setUniform("uSpecularMatColor",this.curSpecularColor);fillShader.setUniform("uEmissiveMatColor",this.curEmissiveColor);fillShader.setUniform("uSpecular",this._useSpecularMaterial);fillShader.setUniform("uEmissive",this._useEmissiveMaterial);fillShader.setUniform("uShininess",this._useShininess);this._setImageLightUniforms(fillShader);fillShader.setUniform("uUseLighting",this._enableLighting);var pointLightCount=this.pointLightDiffuseColors.length/3;fillShader.setUniform("uPointLightCount",pointLightCount);fillShader.setUniform("uPointLightLocation",this.pointLightPositions);fillShader.setUniform("uPointLightDiffuseColors",this.pointLightDiffuseColors);fillShader.setUniform("uPointLightSpecularColors",this.pointLightSpecularColors);var directionalLightCount=this.directionalLightDiffuseColors.length/3;fillShader.setUniform("uDirectionalLightCount",directionalLightCount);fillShader.setUniform("uLightingDirection",this.directionalLightDirections);fillShader.setUniform("uDirectionalDiffuseColors",this.directionalLightDiffuseColors);fillShader.setUniform("uDirectionalSpecularColors",this.directionalLightSpecularColors);var ambientLightCount=this.ambientLightColors.length/3;fillShader.setUniform("uAmbientLightCount",ambientLightCount);fillShader.setUniform("uAmbientColor",this.ambientLightColors);var spotLightCount=this.spotLightDiffuseColors.length/3;fillShader.setUniform("uSpotLightCount",spotLightCount);fillShader.setUniform("uSpotLightAngle",this.spotLightAngle);fillShader.setUniform("uSpotLightConc",this.spotLightConc);fillShader.setUniform("uSpotLightDiffuseColors",this.spotLightDiffuseColors);fillShader.setUniform("uSpotLightSpecularColors",this.spotLightSpecularColors);fillShader.setUniform("uSpotLightLocation",this.spotLightPositions);fillShader.setUniform("uSpotLightDirection",this.spotLightDirections);fillShader.setUniform("uConstantAttenuation",this.constantAttenuation);fillShader.setUniform("uLinearAttenuation",this.linearAttenuation);fillShader.setUniform("uQuadraticAttenuation",this.quadraticAttenuation);fillShader.bindTextures()}},{key:"_setImageLightUniforms",value:function _setImageLightUniforms(shader){shader.setUniform("uUseImageLight",this.activeImageLight!=null);if(this.activeImageLight){var diffusedLight=this.getDiffusedTexture(this.activeImageLight);shader.setUniform("environmentMapDiffused",diffusedLight);var specularLight=this.getSpecularTexture(this.activeImageLight);var roughness=20/this._useShininess;shader.setUniform("levelOfDetail",roughness*8);shader.setUniform("environmentMapSpecular",specularLight)}}},{key:"_setPointUniforms",value:function _setPointUniforms(pointShader){pointShader.bindShader();pointShader.setUniform("uMaterialColor",this.curStrokeColor);pointShader.setUniform("uPointSize",this.pointSize*this._pInst._pixelDensity)}},{key:"_bindBuffer",value:function _bindBuffer(buffer,target,values,type,usage){if(!target)target=this.GL.ARRAY_BUFFER;this.GL.bindBuffer(target,buffer);if(values!==undefined){var data=values;if(values instanceof _main.default.DataArray){data=values.dataArray()}else if(!(data instanceof(type||Float32Array))){data=new(type||Float32Array)(data)}this.GL.bufferData(target,data,usage||this.GL.STATIC_DRAW)}}},{key:"_arraysEqual",value:function _arraysEqual(a,b){var aLength=a.length;if(aLength!==b.length)return false;return a.every(function(ai,i){return ai===b[i]})}},{key:"_isTypedArray",value:function _isTypedArray(arr){return[Float32Array,Float64Array,Int16Array,Uint16Array,Uint32Array].some(function(x){return arr instanceof x})}},{key:"_flatten",value:function _flatten(arr){if(arr.length===0){return[]}else if(arr.length>2e4){var result=[];var nodes=arr.slice();var node;node=nodes.pop();do{if(Array.isArray(node)){nodes.push.apply(nodes,_toConsumableArray(node))}else{result.push(node)}}while(nodes.length&&(node=nodes.pop())!==undefined);result.reverse();return result}else{var _ref;return(_ref=[]).concat.apply(_ref,_toConsumableArray(arr))}}},{key:"_vToNArray",value:function _vToNArray(arr){var ret=[];var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=arr[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var item=_step2.value;ret.push(item.x,item.y,item.z)}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}return ret}},{key:"_bezierCoefficients",value:function _bezierCoefficients(t){var t2=t*t;var t3=t2*t;var mt=1-t;var mt2=mt*mt;var mt3=mt2*mt;return[mt3,3*mt2*t,3*mt*t2,t3]}},{key:"_quadraticCoefficients",value:function _quadraticCoefficients(t){var t2=t*t;var mt=1-t;var mt2=mt*mt;return[mt2,2*mt*t,t2]}},{key:"_bezierToCatmull",value:function _bezierToCatmull(w){var p1=w[1];var p2=w[1]+(w[2]-w[0])/this._curveTightness;var p3=w[2]-(w[3]-w[1])/this._curveTightness;var p4=w[2];var p=[p1,p2,p3,p4];return p}},{key:"_initTessy",value:function _initTessy(){function vertexCallback(data,polyVertArray){for(var i=0;i<data.length;i++){polyVertArray.push(data[i])}}function begincallback(type){if(type!==_libtess.default.primitiveType.GL_TRIANGLES){console.log("expected TRIANGLES but got type: ".concat(type))}}function errorcallback(errno){console.log("error callback");console.log("error number: ".concat(errno))}function combinecallback(coords,data,weight){var result=new Array(_main.default.RendererGL.prototype.tessyVertexSize).fill(0);for(var i=0;i<weight.length;i++){for(var j=0;j<result.length;j++){if(weight[i]===0||!data[i])continue;result[j]+=data[i][j]*weight[i]}}return result}function edgeCallback(flag){}var tessy=new _libtess.default.GluTesselator;tessy.gluTessCallback(_libtess.default.gluEnum.GLU_TESS_VERTEX_DATA,vertexCallback);tessy.gluTessCallback(_libtess.default.gluEnum.GLU_TESS_BEGIN,begincallback);tessy.gluTessCallback(_libtess.default.gluEnum.GLU_TESS_ERROR,errorcallback);tessy.gluTessCallback(_libtess.default.gluEnum.GLU_TESS_COMBINE,combinecallback);tessy.gluTessCallback(_libtess.default.gluEnum.GLU_TESS_EDGE_FLAG,edgeCallback);tessy.gluTessProperty(_libtess.default.gluEnum.GLU_TESS_WINDING_RULE,_libtess.default.windingRule.GLU_TESS_WINDING_NONZERO);return tessy}},{key:"_triangulate",value:function _triangulate(contours){var z=contours[0]?contours[0][2]:undefined;var allSameZ=true;var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=contours[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var contour=_step3.value;for(var j=0;j<contour.length;j+=_main.default.RendererGL.prototype.tessyVertexSize){if(contour[j+2]!==z){allSameZ=false;break}}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return!=null){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}if(allSameZ){this._tessy.gluTessNormal(0,0,1)}else{this._tessy.gluTessNormal(0,0,0)}var triangleVerts=[];this._tessy.gluTessBeginPolygon(triangleVerts);var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=contours[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var _contour=_step4.value;this._tessy.gluTessBeginContour();for(var _j=0;_j<_contour.length;_j+=_main.default.RendererGL.prototype.tessyVertexSize){var coords=_contour.slice(_j,_j+_main.default.RendererGL.prototype.tessyVertexSize);this._tessy.gluTessVertex(coords,coords)}this._tessy.gluTessEndContour()}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return!=null){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}this._tessy.gluTessEndPolygon();return triangleVerts}}]);return RendererGL}(_main.default.Renderer);_main.default.prototype._assert3d=function(name){if(!this._renderer.isP3D)throw new Error("".concat(name,"() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information."))};_main.default.RendererGL.prototype.tessyVertexSize=12;var _default=_main.default.RendererGL;exports.default=_default},{"../core/constants":286,"../core/main":298,"../core/p5.Renderer":301,"./GeometryBuilder":342,"./p5.Camera":347,"./p5.Framebuffer":349,"./p5.Matrix":351,"./p5.Shader":356,"./p5.Texture":357,"core-js/modules/es.array.concat":169,"core-js/modules/es.array.copy-within":170,"core-js/modules/es.array.every":171,"core-js/modules/es.array.fill":172,"core-js/modules/es.array.from":176,"core-js/modules/es.array.includes":177,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.some":184,"core-js/modules/es.map":187,"core-js/modules/es.object.assign":194,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.to-string":200,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.reflect.get":203,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.set":207,"core-js/modules/es.string.includes":209,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.float32-array":229,"core-js/modules/es.typed-array.float64-array":230,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.int16-array":234,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint16-array":250,"core-js/modules/es.typed-array.uint32-array":251,"core-js/modules/es.typed-array.uint8-array":252,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256,libtess:269,path:272}],356:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.index-of");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.array.slice");_dereq_("core-js/modules/es.array.some");_dereq_("core-js/modules/es.function.name");_dereq_("core-js/modules/es.object.keys");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/web.dom-collections.iterator");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.Shader=function(){function _class(renderer,vertSrc,fragSrc){_classCallCheck(this,_class);this._renderer=renderer;this._vertSrc=vertSrc;this._fragSrc=fragSrc;this._vertShader=-1;this._fragShader=-1;this._glProgram=0;this._loadedAttributes=false;this.attributes={};this._loadedUniforms=false;this.uniforms={};this._bound=false;this.samplers=[]}_createClass(_class,[{key:"init",value:function init(){if(this._glProgram===0){var gl=this._renderer.GL;this._vertShader=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(this._vertShader,this._vertSrc);gl.compileShader(this._vertShader);if(!gl.getShaderParameter(this._vertShader,gl.COMPILE_STATUS)){_main.default._friendlyError("Yikes! An error occurred compiling the vertex shader:".concat(gl.getShaderInfoLog(this._vertShader)));return null}this._fragShader=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(this._fragShader,this._fragSrc);gl.compileShader(this._fragShader);if(!gl.getShaderParameter(this._fragShader,gl.COMPILE_STATUS)){_main.default._friendlyError("Darn! An error occurred compiling the fragment shader:".concat(gl.getShaderInfoLog(this._fragShader)));return null}this._glProgram=gl.createProgram();gl.attachShader(this._glProgram,this._vertShader);gl.attachShader(this._glProgram,this._fragShader);gl.linkProgram(this._glProgram);if(!gl.getProgramParameter(this._glProgram,gl.LINK_STATUS)){_main.default._friendlyError("Snap! Error linking shader program: ".concat(gl.getProgramInfoLog(this._glProgram)))}this._loadAttributes();this._loadUniforms()}return this}},{key:"copyToContext",value:function copyToContext(context){var shader=new _main.default.Shader(context._renderer,this._vertSrc,this._fragSrc);shader.ensureCompiledOnContext(context);return shader}},{key:"ensureCompiledOnContext",value:function ensureCompiledOnContext(context){if(this._glProgram!==0&&this._renderer!==context._renderer){throw new Error("The shader being run is attached to a different context. Do you need to copy it to this context first with .copyToContext()?")}else if(this._glProgram===0){this._renderer=context._renderer;this.init()}}},{key:"_loadAttributes",value:function _loadAttributes(){if(this._loadedAttributes){return}this.attributes={};var gl=this._renderer.GL;var numAttributes=gl.getProgramParameter(this._glProgram,gl.ACTIVE_ATTRIBUTES);for(var i=0;i<numAttributes;++i){var attributeInfo=gl.getActiveAttrib(this._glProgram,i);var name=attributeInfo.name;var location=gl.getAttribLocation(this._glProgram,name);var attribute={};attribute.name=name;attribute.location=location;attribute.index=i;attribute.type=attributeInfo.type;attribute.size=attributeInfo.size;this.attributes[name]=attribute}this._loadedAttributes=true}},{key:"_loadUniforms",value:function _loadUniforms(){if(this._loadedUniforms){return}var gl=this._renderer.GL;var numUniforms=gl.getProgramParameter(this._glProgram,gl.ACTIVE_UNIFORMS);var samplerIndex=0;for(var i=0;i<numUniforms;++i){var uniformInfo=gl.getActiveUniform(this._glProgram,i);var uniform={};uniform.location=gl.getUniformLocation(this._glProgram,uniformInfo.name);uniform.size=uniformInfo.size;var uniformName=uniformInfo.name;if(uniformInfo.size>1){uniformName=uniformName.substring(0,uniformName.indexOf("[0]"))}uniform.name=uniformName;uniform.type=uniformInfo.type;uniform._cachedData=undefined;if(uniform.type===gl.SAMPLER_2D){uniform.samplerIndex=samplerIndex;samplerIndex++;this.samplers.push(uniform)}uniform.isArray=uniformInfo.size>1||uniform.type===gl.FLOAT_MAT3||uniform.type===gl.FLOAT_MAT4||uniform.type===gl.FLOAT_VEC2||uniform.type===gl.FLOAT_VEC3||uniform.type===gl.FLOAT_VEC4||uniform.type===gl.INT_VEC2||uniform.type===gl.INT_VEC4||uniform.type===gl.INT_VEC3;this.uniforms[uniformName]=uniform}this._loadedUniforms=true}},{key:"compile",value:function compile(){}},{key:"bindShader",value:function bindShader(){this.init();if(!this._bound){this.useProgram();this._bound=true;this._setMatrixUniforms();this.setUniform("uViewport",this._renderer._viewport)}}},{key:"unbindShader",value:function unbindShader(){if(this._bound){this.unbindTextures();this._bound=false}return this}},{key:"bindTextures",value:function bindTextures(){var gl=this._renderer.GL;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=this.samplers[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var uniform=_step.value;var tex=uniform.texture;if(tex===undefined){tex=this._renderer._getEmptyTexture()}gl.activeTexture(gl.TEXTURE0+uniform.samplerIndex);tex.bindTexture();tex.update();gl.uniform1i(uniform.location,uniform.samplerIndex)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}}},{key:"updateTextures",value:function updateTextures(){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.samplers[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var uniform=_step2.value;var tex=uniform.texture;if(tex){tex.update()}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}},{key:"unbindTextures",value:function unbindTextures(){var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.samplers[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var uniform=_step3.value;this.setUniform(uniform.name,this._renderer._getEmptyTexture())}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return!=null){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}}},{key:"_setMatrixUniforms",value:function _setMatrixUniforms(){var viewMatrix=this._renderer._curCamera.cameraMatrix;var projectionMatrix=this._renderer.uPMatrix;var modelViewMatrix=this._renderer.uMVMatrix;var modelViewProjectionMatrix=modelViewMatrix.copy();modelViewProjectionMatrix.mult(projectionMatrix);if(this.isStrokeShader()){if(this._renderer._curCamera.cameraType==="default"){this.setUniform("uPerspective",1)}else{this.setUniform("uPerspective",0)}}this.setUniform("uViewMatrix",viewMatrix.mat4);this.setUniform("uProjectionMatrix",projectionMatrix.mat4);this.setUniform("uModelViewMatrix",modelViewMatrix.mat4);this.setUniform("uModelViewProjectionMatrix",modelViewProjectionMatrix.mat4);if(this.uniforms.uNormalMatrix){this._renderer.uNMatrix.inverseTranspose(this._renderer.uMVMatrix);this.setUniform("uNormalMatrix",this._renderer.uNMatrix.mat3)}}},{key:"useProgram",value:function useProgram(){var gl=this._renderer.GL;if(this._renderer._curShader!==this){gl.useProgram(this._glProgram);this._renderer._curShader=this}return this}},{key:"setUniform",value:function setUniform(uniformName,data){var uniform=this.uniforms[uniformName];if(!uniform){return}var gl=this._renderer.GL;if(uniform.isArray){if(uniform._cachedData&&this._renderer._arraysEqual(uniform._cachedData,data)){return}else{uniform._cachedData=data.slice(0)}}else if(uniform._cachedData&&uniform._cachedData===data){return}else{if(Array.isArray(data)){uniform._cachedData=data.slice(0)}else{uniform._cachedData=data}}var location=uniform.location;this.useProgram();switch(uniform.type){case gl.BOOL:if(data===true){gl.uniform1i(location,1)}else{gl.uniform1i(location,0)}break;case gl.INT:if(uniform.size>1){data.length&&gl.uniform1iv(location,data)}else{gl.uniform1i(location,data)}break;case gl.FLOAT:if(uniform.size>1){data.length&&gl.uniform1fv(location,data)}else{gl.uniform1f(location,data)}break;case gl.FLOAT_MAT3:gl.uniformMatrix3fv(location,false,data);break;case gl.FLOAT_MAT4:gl.uniformMatrix4fv(location,false,data);break;case gl.FLOAT_VEC2:if(uniform.size>1){data.length&&gl.uniform2fv(location,data)}else{gl.uniform2f(location,data[0],data[1])}break;case gl.FLOAT_VEC3:if(uniform.size>1){data.length&&gl.uniform3fv(location,data)}else{gl.uniform3f(location,data[0],data[1],data[2])}break;case gl.FLOAT_VEC4:if(uniform.size>1){data.length&&gl.uniform4fv(location,data)}else{gl.uniform4f(location,data[0],data[1],data[2],data[3])}break;case gl.INT_VEC2:if(uniform.size>1){data.length&&gl.uniform2iv(location,data)}else{gl.uniform2i(location,data[0],data[1])}break;case gl.INT_VEC3:if(uniform.size>1){data.length&&gl.uniform3iv(location,data)}else{gl.uniform3i(location,data[0],data[1],data[2])}break;case gl.INT_VEC4:if(uniform.size>1){data.length&&gl.uniform4iv(location,data)}else{gl.uniform4i(location,data[0],data[1],data[2],data[3])}break;case gl.SAMPLER_2D:gl.activeTexture(gl.TEXTURE0+uniform.samplerIndex);uniform.texture=data instanceof _main.default.Texture?data:this._renderer.getTexture(data);gl.uniform1i(location,uniform.samplerIndex);if(uniform.texture.src.gifProperties){uniform.texture.src._animateGif(this._renderer._pInst)}break}return this}},{key:"isLightShader",value:function isLightShader(){return this.attributes.aNormal!==undefined||this.uniforms.uUseLighting!==undefined||this.uniforms.uAmbientLightCount!==undefined||this.uniforms.uDirectionalLightCount!==undefined||this.uniforms.uPointLightCount!==undefined||this.uniforms.uAmbientColor!==undefined||this.uniforms.uDirectionalDiffuseColors!==undefined||this.uniforms.uDirectionalSpecularColors!==undefined||this.uniforms.uPointLightLocation!==undefined||this.uniforms.uPointLightDiffuseColors!==undefined||this.uniforms.uPointLightSpecularColors!==undefined||this.uniforms.uLightingDirection!==undefined||this.uniforms.uSpecular!==undefined}},{key:"isNormalShader",value:function isNormalShader(){return this.attributes.aNormal!==undefined}},{key:"isTextureShader",value:function isTextureShader(){return this.samplers.length>0}},{key:"isColorShader",value:function isColorShader(){return this.attributes.aVertexColor!==undefined||this.uniforms.uMaterialColor!==undefined}},{key:"isTexLightShader",value:function isTexLightShader(){return this.isLightShader()&&this.isTextureShader()}},{key:"isStrokeShader",value:function isStrokeShader(){return this.uniforms.uStrokeWeight!==undefined}},{key:"enableAttrib",value:function enableAttrib(attr,size,type,normalized,stride,offset){if(attr){if(typeof IS_MINIFIED==="undefined"&&this.attributes[attr.name]!==attr){console.warn('The attribute "'.concat(attr.name,'"passed to enableAttrib does not belong to this shader.'))}var loc=attr.location;if(loc!==-1){var gl=this._renderer.GL;if(!this._renderer.registerEnabled.has(loc)){gl.enableVertexAttribArray(loc);this._renderer.registerEnabled.add(loc)}this._renderer.GL.vertexAttribPointer(loc,size,type||gl.FLOAT,normalized||false,stride||0,offset||0)}}return this}},{key:"disableRemainingAttributes",value:function disableRemainingAttributes(){var _this=this;var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{var _loop=function _loop(){var location=_step4.value;if(!Object.keys(_this.attributes).some(function(key){return _this.attributes[key].location===location})){_this._renderer.GL.disableVertexAttribArray(location);_this._renderer.registerEnabled.delete(location)}};for(var _iterator4=this._renderer.registerEnabled.values()[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){_loop()}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return!=null){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}}}]);return _class}();var _default=_main.default.Shader;exports.default=_default},{"../core/main":298,"core-js/modules/es.array.index-of":178,"core-js/modules/es.array.iterator":179,"core-js/modules/es.array.slice":183,"core-js/modules/es.array.some":184,"core-js/modules/es.function.name":186,"core-js/modules/es.object.keys":199,"core-js/modules/es.object.to-string":200,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/web.dom-collections.iterator":256}],357:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.get-prototype-of");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.reflect.construct");_dereq_("core-js/modules/es.regexp.to-string");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.typed-array.uint8-array");_dereq_("core-js/modules/es.typed-array.copy-within");_dereq_("core-js/modules/es.typed-array.every");_dereq_("core-js/modules/es.typed-array.fill");_dereq_("core-js/modules/es.typed-array.filter");_dereq_("core-js/modules/es.typed-array.find");_dereq_("core-js/modules/es.typed-array.find-index");_dereq_("core-js/modules/es.typed-array.for-each");_dereq_("core-js/modules/es.typed-array.includes");_dereq_("core-js/modules/es.typed-array.index-of");_dereq_("core-js/modules/es.typed-array.iterator");_dereq_("core-js/modules/es.typed-array.join");_dereq_("core-js/modules/es.typed-array.last-index-of");_dereq_("core-js/modules/es.typed-array.map");_dereq_("core-js/modules/es.typed-array.reduce");_dereq_("core-js/modules/es.typed-array.reduce-right");_dereq_("core-js/modules/es.typed-array.reverse");_dereq_("core-js/modules/es.typed-array.set");_dereq_("core-js/modules/es.typed-array.slice");_dereq_("core-js/modules/es.typed-array.some");_dereq_("core-js/modules/es.typed-array.sort");_dereq_("core-js/modules/es.typed-array.subarray");_dereq_("core-js/modules/es.typed-array.to-locale-string");_dereq_("core-js/modules/es.typed-array.to-string");Object.defineProperty(exports,"__esModule",{value:true});exports.checkWebGLCapabilities=checkWebGLCapabilities;exports.default=exports.MipmapTexture=void 0;var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _createSuper(Derived){function isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}return function(){var Super=_getPrototypeOf(Derived),result;if(isNativeReflectConstruct()){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else{result=Super.apply(this,arguments)}return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.Texture=function(){function Texture(renderer,obj,settings){_classCallCheck(this,Texture);this._renderer=renderer;var gl=this._renderer.GL;settings=settings||{};this.src=obj;this.glTex=undefined;this.glTarget=gl.TEXTURE_2D;this.glFormat=settings.format||gl.RGBA;this.mipmaps=false;this.glMinFilter=settings.minFilter||gl.LINEAR;this.glMagFilter=settings.magFilter||gl.LINEAR;this.glWrapS=settings.wrapS||gl.CLAMP_TO_EDGE;this.glWrapT=settings.wrapT||gl.CLAMP_TO_EDGE;this.glDataType=settings.dataType||gl.UNSIGNED_BYTE;var support=checkWebGLCapabilities(renderer);if(this.glFormat===gl.HALF_FLOAT&&!support.halfFloat){console.log("This device does not support dataType HALF_FLOAT. Falling back to FLOAT.");this.glDataType=gl.FLOAT}if(this.glFormat===gl.HALF_FLOAT&&(this.glMinFilter===gl.LINEAR||this.glMagFilter===gl.LINEAR)&&!support.halfFloatLinear){console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST.");if(this.glMinFilter===gl.LINEAR)this.glMinFilter=gl.NEAREST;if(this.glMagFilter===gl.LINEAR)this.glMagFilter=gl.NEAREST}if(this.glFormat===gl.FLOAT&&!support.float){console.log("This device does not support dataType FLOAT. Falling back to UNSIGNED_BYTE.");this.glDataType=gl.UNSIGNED_BYTE}if(this.glFormat===gl.FLOAT&&(this.glMinFilter===gl.LINEAR||this.glMagFilter===gl.LINEAR)&&!support.floatLinear){console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST.");if(this.glMinFilter===gl.LINEAR)this.glMinFilter=gl.NEAREST;if(this.glMagFilter===gl.LINEAR)this.glMagFilter=gl.NEAREST}this.isSrcMediaElement=typeof _main.default.MediaElement!=="undefined"&&obj instanceof _main.default.MediaElement;this._videoPrevUpdateTime=0;this.isSrcHTMLElement=typeof _main.default.Element!=="undefined"&&obj instanceof _main.default.Element&&!(obj instanceof _main.default.Graphics)&&!(obj instanceof _main.default.Renderer);this.isSrcP5Image=obj instanceof _main.default.Image;this.isSrcP5Graphics=obj instanceof _main.default.Graphics;this.isSrcP5Renderer=obj instanceof _main.default.Renderer;this.isImageData=typeof ImageData!=="undefined"&&obj instanceof ImageData;this.isFramebufferTexture=obj instanceof _main.default.FramebufferTexture;var textureData=this._getTextureDataFromSource();this.width=textureData.width;this.height=textureData.height;this.init(textureData);return this}_createClass(Texture,[{key:"_getTextureDataFromSource",value:function _getTextureDataFromSource(){var textureData;if(this.isFramebufferTexture){textureData=this.src.rawTexture()}else if(this.isSrcP5Image){textureData=this.src.canvas}else if(this.isSrcMediaElement||this.isSrcP5Graphics||this.isSrcP5Renderer||this.isSrcHTMLElement){textureData=this.src.elt}else if(this.isImageData){textureData=this.src}return textureData}},{key:"init",value:function init(data){var gl=this._renderer.GL;if(!this.isFramebufferTexture){this.glTex=gl.createTexture()}this.glWrapS=this._renderer.textureWrapX;this.glWrapT=this._renderer.textureWrapY;this.setWrapMode(this.glWrapS,this.glWrapT);this.bindTexture();gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,this.glMagFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,this.glMinFilter);if(this.isFramebufferTexture){}else if(this.width===0||this.height===0||this.isSrcMediaElement&&!this.src.loadedmetadata){var tmpdata=new Uint8Array([1,1,1,1]);gl.texImage2D(this.glTarget,0,gl.RGBA,1,1,0,this.glFormat,this.glDataType,tmpdata)}else{gl.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,data)}}},{key:"update",value:function update(){var data=this.src;if(data.width===0||data.height===0){return false}if(this.isFramebufferTexture){return false}var textureData=this._getTextureDataFromSource();var updated=false;var gl=this._renderer.GL;if(textureData.width!==this.width||textureData.height!==this.height){updated=true;this.width=textureData.width||data.width;this.height=textureData.height||data.height;if(this.isSrcP5Image){data.setModified(false)}else if(this.isSrcMediaElement||this.isSrcHTMLElement){data.setModified(true)}}else if(this.isSrcP5Image){if(data.isModified()){updated=true;data.setModified(false)}}else if(this.isSrcMediaElement){if(data.isModified()){updated=true;data.setModified(false)}else if(data.loadedmetadata){if(this._videoPrevUpdateTime!==data.time()){this._videoPrevUpdateTime=data.time();updated=true}}}else if(this.isImageData){if(data._dirty){data._dirty=false;updated=true}}else{updated=true}if(updated){this.bindTexture();gl.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,textureData)}return updated}},{key:"bindTexture",value:function bindTexture(){var gl=this._renderer.GL;gl.bindTexture(this.glTarget,this.getTexture());return this}},{key:"unbindTexture",value:function unbindTexture(){var gl=this._renderer.GL;gl.bindTexture(this.glTarget,null)}},{key:"getTexture",value:function getTexture(){if(this.isFramebufferTexture){return this.src.rawTexture()}else{return this.glTex}}},{key:"setInterpolation",value:function setInterpolation(downScale,upScale){var gl=this._renderer.GL;this.glMinFilter=this.glFilter(downScale);this.glMagFilter=this.glFilter(upScale);this.bindTexture();gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,this.glMinFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,this.glMagFilter);this.unbindTexture()}},{key:"glFilter",value:function glFilter(filter){var gl=this._renderer.GL;if(filter===constants.NEAREST){return gl.NEAREST}else{return gl.LINEAR}}},{key:"setWrapMode",value:function setWrapMode(wrapX,wrapY){var gl=this._renderer.GL;var isPowerOfTwo=function isPowerOfTwo(x){return(x&x-1)===0};var textureData=this._getTextureDataFromSource();var wrapWidth;var wrapHeight;if(textureData.naturalWidth&&textureData.naturalHeight){wrapWidth=textureData.naturalWidth;wrapHeight=textureData.naturalHeight}else{wrapWidth=this.width;wrapHeight=this.height}var widthPowerOfTwo=isPowerOfTwo(wrapWidth);var heightPowerOfTwo=isPowerOfTwo(wrapHeight);if(wrapX===constants.REPEAT){if(this._renderer.webglVersion===constants.WEBGL2||widthPowerOfTwo&&heightPowerOfTwo){this.glWrapS=gl.REPEAT}else{console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead");this.glWrapS=gl.CLAMP_TO_EDGE}}else if(wrapX===constants.MIRROR){if(this._renderer.webglVersion===constants.WEBGL2||widthPowerOfTwo&&heightPowerOfTwo){this.glWrapS=gl.MIRRORED_REPEAT}else{console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead");this.glWrapS=gl.CLAMP_TO_EDGE}}else{this.glWrapS=gl.CLAMP_TO_EDGE}if(wrapY===constants.REPEAT){if(this._renderer.webglVersion===constants.WEBGL2||widthPowerOfTwo&&heightPowerOfTwo){this.glWrapT=gl.REPEAT}else{console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead");this.glWrapT=gl.CLAMP_TO_EDGE}}else if(wrapY===constants.MIRROR){if(this._renderer.webglVersion===constants.WEBGL2||widthPowerOfTwo&&heightPowerOfTwo){this.glWrapT=gl.MIRRORED_REPEAT}else{console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead");this.glWrapT=gl.CLAMP_TO_EDGE}}else{this.glWrapT=gl.CLAMP_TO_EDGE}this.bindTexture();gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,this.glWrapS);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,this.glWrapT);this.unbindTexture()}}]);return Texture}();var MipmapTexture=function(_p5$Texture){_inherits(MipmapTexture,_p5$Texture);var _super=_createSuper(MipmapTexture);function MipmapTexture(renderer,levels,settings){var _this;_classCallCheck(this,MipmapTexture);_this=_super.call(this,renderer,levels,settings);var gl=_this._renderer.GL;if(_this.glMinFilter===gl.LINEAR){_this.glMinFilter=gl.LINEAR_MIPMAP_LINEAR}return _this}_createClass(MipmapTexture,[{key:"glFilter",value:function glFilter(_filter){var gl=this._renderer.GL;return gl.LINEAR_MIPMAP_LINEAR}},{key:"_getTextureDataFromSource",value:function _getTextureDataFromSource(){return this.src}},{key:"init",value:function init(levels){var gl=this._renderer.GL;this.glTex=gl.createTexture();this.bindTexture();for(var level=0;level<levels.length;level++){gl.texImage2D(this.glTarget,level,this.glFormat,this.glFormat,this.glDataType,levels[level])}this.glMinFilter=gl.LINEAR_MIPMAP_LINEAR;gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,this.glMagFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,this.glMinFilter);this.unbindTexture()}},{key:"update",value:function update(){}}]);return MipmapTexture}(_main.default.Texture);exports.MipmapTexture=MipmapTexture;function checkWebGLCapabilities(_ref){var GL=_ref.GL,webglVersion=_ref.webglVersion;var gl=GL;var supportsFloat=webglVersion===constants.WEBGL2?gl.getExtension("EXT_color_buffer_float")&&gl.getExtension("EXT_float_blend"):gl.getExtension("OES_texture_float");var supportsFloatLinear=supportsFloat&&gl.getExtension("OES_texture_float_linear");var supportsHalfFloat=webglVersion===constants.WEBGL2?gl.getExtension("EXT_color_buffer_float"):gl.getExtension("OES_texture_half_float");var supportsHalfFloatLinear=supportsHalfFloat&&gl.getExtension("OES_texture_half_float_linear");return{float:supportsFloat,floatLinear:supportsFloatLinear,halfFloat:supportsHalfFloat,halfFloatLinear:supportsHalfFloatLinear}}var _default=_main.default.Texture;exports.default=_default},{"../core/constants":286,"../core/main":298,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.get-prototype-of":198,"core-js/modules/es.object.to-string":200,"core-js/modules/es.reflect.construct":202,"core-js/modules/es.regexp.to-string":206,"core-js/modules/es.string.iterator":210,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.typed-array.copy-within":223,"core-js/modules/es.typed-array.every":224,"core-js/modules/es.typed-array.fill":225,"core-js/modules/es.typed-array.filter":226,"core-js/modules/es.typed-array.find":228,"core-js/modules/es.typed-array.find-index":227,"core-js/modules/es.typed-array.for-each":231,"core-js/modules/es.typed-array.includes":232,"core-js/modules/es.typed-array.index-of":233,"core-js/modules/es.typed-array.iterator":236,"core-js/modules/es.typed-array.join":237,"core-js/modules/es.typed-array.last-index-of":238,"core-js/modules/es.typed-array.map":239,"core-js/modules/es.typed-array.reduce":241,"core-js/modules/es.typed-array.reduce-right":240,"core-js/modules/es.typed-array.reverse":242,"core-js/modules/es.typed-array.set":243,"core-js/modules/es.typed-array.slice":244,"core-js/modules/es.typed-array.some":245,"core-js/modules/es.typed-array.sort":246,"core-js/modules/es.typed-array.subarray":247,"core-js/modules/es.typed-array.to-locale-string":248,"core-js/modules/es.typed-array.to-string":249,"core-js/modules/es.typed-array.uint8-array":252,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],358:[function(_dereq_,module,exports){"use strict";_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.get-own-property-descriptor");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.sub");_dereq_("core-js/modules/es.weak-map");_dereq_("core-js/modules/web.dom-collections.iterator");function _typeof2(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof2=function _typeof2(obj){return typeof obj}}else{_typeof2=function _typeof2(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof2(obj)}function _typeof(obj){if(typeof Symbol==="function"&&_typeof2(Symbol.iterator)==="symbol"){_typeof=function _typeof(obj){return _typeof2(obj)}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)}}return _typeof(obj)}_dereq_("core-js/modules/es.symbol");_dereq_("core-js/modules/es.symbol.description");_dereq_("core-js/modules/es.symbol.iterator");_dereq_("core-js/modules/es.array.iterator");_dereq_("core-js/modules/es.object.to-string");_dereq_("core-js/modules/es.regexp.exec");_dereq_("core-js/modules/es.string.iterator");_dereq_("core-js/modules/es.string.split");_dereq_("core-js/modules/es.string.sub");_dereq_("core-js/modules/web.dom-collections.iterator");var _main=_interopRequireDefault(_dereq_("../core/main"));var constants=_interopRequireWildcard(_dereq_("../core/constants"));_dereq_("./p5.Shader");_dereq_("./p5.RendererGL.Retained");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj.default=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}_main.default.RendererGL.prototype._applyTextProperties=function(){};_main.default.RendererGL.prototype.textWidth=function(s){if(this._isOpenType()){return this._textFont._textWidth(s,this._textSize)}return 0};var charGridWidth=9;var charGridHeight=charGridWidth;var strokeImageWidth=64;var strokeImageHeight=64;var gridImageWidth=64;var gridImageHeight=64;var cellImageWidth=64;var cellImageHeight=64;var ImageInfos=function(){function ImageInfos(width,height){_classCallCheck(this,ImageInfos);this.width=width;this.height=height;this.infos=[]}_createClass(ImageInfos,[{key:"findImage",value:function findImage(space){var imageSize=this.width*this.height;if(space>imageSize)throw new Error("font is too complex to render in 3D");var imageInfo,imageData;for(var ii=this.infos.length-1;ii>=0;--ii){var imageInfoTest=this.infos[ii];if(imageInfoTest.index+space<imageSize){imageInfo=imageInfoTest;imageData=imageInfoTest.imageData;break}}if(!imageInfo){try{imageData=new ImageData(this.width,this.height)}catch(err){var canvas=document.getElementsByTagName("canvas")[0];var created=!canvas;if(!canvas){canvas=document.createElement("canvas");canvas.style.display="none";document.body.appendChild(canvas)}var ctx=canvas.getContext("2d");if(ctx){imageData=ctx.createImageData(this.width,this.height)}if(created){document.body.removeChild(canvas)}}imageInfo={index:0,imageData:imageData};this.infos.push(imageInfo)}var index=imageInfo.index;imageInfo.index+=space;imageData._dirty=true;return{imageData:imageData,index:index}}}]);return ImageInfos}();function setPixel(imageInfo,r,g,b,a){var imageData=imageInfo.imageData;var pixels=imageData.data;var index=imageInfo.index++*4;pixels[index++]=r;pixels[index++]=g;pixels[index++]=b;pixels[index++]=a}var SQRT3=Math.sqrt(3);var FontInfo=function(){function FontInfo(font){_classCallCheck(this,FontInfo);this.font=font;this.strokeImageInfos=new ImageInfos(strokeImageWidth,strokeImageHeight);this.colDimImageInfos=new ImageInfos(gridImageWidth,gridImageHeight);this.rowDimImageInfos=new ImageInfos(gridImageWidth,gridImageHeight);this.colCellImageInfos=new ImageInfos(cellImageWidth,cellImageHeight);this.rowCellImageInfos=new ImageInfos(cellImageWidth,cellImageHeight);this.glyphInfos={}}_createClass(FontInfo,[{key:"getGlyphInfo",value:function getGlyphInfo(glyph){var gi=this.glyphInfos[glyph.index];if(gi)return gi;var bb=glyph.getBoundingBox();var xMin=bb.x1;var yMin=bb.y1;var gWidth=bb.x2-xMin;var gHeight=bb.y2-yMin;var cmds=glyph.path.commands;if(gWidth===0||gHeight===0||!cmds.length){return this.glyphInfos[glyph.index]={}}var i;var strokes=[];var rows=[];var cols=[];for(i=charGridWidth-1;i>=0;--i){cols.push([])}for(i=charGridHeight-1;i>=0;--i){rows.push([])}function push(xs,ys,v){var index=strokes.length;strokes.push(v);function minMax(rg,min,max){for(var _i=rg.length;_i-- >0;){var _v=rg[_i];if(min>_v)min=_v;if(max<_v)max=_v}return{min:min,max:max}}var cellOffset=.5;var mmX=minMax(xs,1,0);var ixMin=Math.max(Math.floor(mmX.min*charGridWidth-cellOffset),0);var ixMax=Math.min(Math.ceil(mmX.max*charGridWidth+cellOffset),charGridWidth);for(var iCol=ixMin;iCol<ixMax;++iCol){cols[iCol].push(index)}var mmY=minMax(ys,1,0);var iyMin=Math.max(Math.floor(mmY.min*charGridHeight-cellOffset),0);var iyMax=Math.min(Math.ceil(mmY.max*charGridHeight+cellOffset),charGridHeight);for(var iRow=iyMin;iRow<iyMax;++iRow){rows[iRow].push(index)}}function clamp(v,min,max){if(v<min)return min;if(v>max)return max;return v}function byte(v){return clamp(255*v,0,255)}var Cubic=function(){function Cubic(p0,c0,c1,p1){_classCallCheck(this,Cubic);this.p0=p0;this.c0=c0;this.c1=c1;this.p1=p1}_createClass(Cubic,[{key:"toQuadratic",value:function toQuadratic(){return{x:this.p0.x,y:this.p0.y,x1:this.p1.x,y1:this.p1.y,cx:((this.c0.x+this.c1.x)*3-(this.p0.x+this.p1.x))/4,cy:((this.c0.y+this.c1.y)*3-(this.p0.y+this.p1.y))/4}}},{key:"quadError",value:function quadError(){return _main.default.Vector.sub(_main.default.Vector.sub(this.p1,this.p0),_main.default.Vector.mult(_main.default.Vector.sub(this.c1,this.c0),3)).mag()/2}},{key:"split",value:function split(t){var m1=_main.default.Vector.lerp(this.p0,this.c0,t);var m2=_main.default.Vector.lerp(this.c0,this.c1,t);var mm1=_main.default.Vector.lerp(m1,m2,t);this.c1=_main.default.Vector.lerp(this.c1,this.p1,t);this.c0=_main.default.Vector.lerp(m2,this.c1,t);var pt=_main.default.Vector.lerp(mm1,this.c0,t);var part1=new Cubic(this.p0,m1,mm1,pt);this.p0=pt;return part1}},{key:"splitInflections",value:function splitInflections(){var a=_main.default.Vector.sub(this.c0,this.p0);var b=_main.default.Vector.sub(_main.default.Vector.sub(this.c1,this.c0),a);var c=_main.default.Vector.sub(_main.default.Vector.sub(_main.default.Vector.sub(this.p1,this.c1),a),_main.default.Vector.mult(b,2));var cubics=[];var A=b.x*c.y-b.y*c.x;if(A!==0){var B=a.x*c.y-a.y*c.x;var C=a.x*b.y-a.y*b.x;var disc=B*B-4*A*C;if(disc>=0){if(A<0){A=-A;B=-B;C=-C}var Q=Math.sqrt(disc);var t0=(-B-Q)/(2*A);var t1=(-B+Q)/(2*A);if(t0>0&&t0<1){cubics.push(this.split(t0));t1=1-(1-t1)/(1-t0)}if(t1>0&&t1<1){cubics.push(this.split(t1))}}}cubics.push(this);return cubics}}]);return Cubic}();function cubicToQuadratics(x0,y0,cx0,cy0,cx1,cy1,x1,y1){var cubics=new Cubic(new _main.default.Vector(x0,y0),new _main.default.Vector(cx0,cy0),new _main.default.Vector(cx1,cy1),new _main.default.Vector(x1,y1)).splitInflections();var qs=[];var precision=30/SQRT3;var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=cubics[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var cubic=_step.value;var tail=[];var t3=void 0;for(;;){t3=precision/cubic.quadError();if(t3>=.5*.5*.5){break}var t=Math.pow(t3,1/3);var start=cubic.split(t);var middle=cubic.split(1-t/(1-t));qs.push(start);tail.push(cubic);cubic=middle}if(t3<1){qs.push(cubic.split(.5))}qs.push(cubic);Array.prototype.push.apply(qs,tail.reverse())}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return qs}function pushLine(x0,y0,x1,y1){var mx=(x0+x1)/2;var my=(y0+y1)/2;push([x0,x1],[y0,y1],{x:x0,y:y0,cx:mx,cy:my})}function samePoint(x0,y0,x1,y1){return Math.abs(x1-x0)<1e-5&&Math.abs(y1-y0)<1e-5}var x0,y0,xs,ys;var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=cmds[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var cmd=_step2.value;var x1=(cmd.x-xMin)/gWidth;var y1=(cmd.y-yMin)/gHeight;if(samePoint(x0,y0,x1,y1))continue;switch(cmd.type){case"M":{xs=x1;ys=y1;break}case"L":{pushLine(x0,y0,x1,y1);break}case"Q":{var cx=(cmd.x1-xMin)/gWidth;var cy=(cmd.y1-yMin)/gHeight;push([x0,x1,cx],[y0,y1,cy],{x:x0,y:y0,cx:cx,cy:cy});break}case"Z":{if(!samePoint(x0,y0,xs,ys)){pushLine(x0,y0,xs,ys);strokes.push({x:xs,y:ys})}else{strokes.push({x:x0,y:y0})}break}case"C":{var cx1=(cmd.x1-xMin)/gWidth;var cy1=(cmd.y1-yMin)/gHeight;var cx2=(cmd.x2-xMin)/gWidth;var cy2=(cmd.y2-yMin)/gHeight;var qs=cubicToQuadratics(x0,y0,cx1,cy1,cx2,cy2,x1,y1);for(var iq=0;iq<qs.length;iq++){var q=qs[iq].toQuadratic();push([q.x,q.x1,q.cx],[q.y,q.y1,q.cy],q)}break}default:throw new Error("unknown command type: ".concat(cmd.type))}x0=x1;y0=y1}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return!=null){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}var strokeCount=strokes.length;var strokeImageInfo=this.strokeImageInfos.findImage(strokeCount);var strokeOffset=strokeImageInfo.index;for(var il=0;il<strokeCount;++il){var s=strokes[il];setPixel(strokeImageInfo,byte(s.x),byte(s.y),byte(s.cx),byte(s.cy))}function layout(dim,dimImageInfos,cellImageInfos){var dimLength=dim.length;var dimImageInfo=dimImageInfos.findImage(dimLength);var dimOffset=dimImageInfo.index;var totalStrokes=0;for(var id=0;id<dimLength;++id){totalStrokes+=dim[id].length}var cellImageInfo=cellImageInfos.findImage(totalStrokes);for(var _i2=0;_i2<dimLength;++_i2){var strokeIndices=dim[_i2];var _strokeCount=strokeIndices.length;var cellLineIndex=cellImageInfo.index;setPixel(dimImageInfo,cellLineIndex>>7,cellLineIndex&127,_strokeCount>>7,_strokeCount&127);for(var iil=0;iil<_strokeCount;++iil){var strokeIndex=strokeIndices[iil]+strokeOffset;setPixel(cellImageInfo,strokeIndex>>7,strokeIndex&127,0,0)}}return{cellImageInfo:cellImageInfo,dimOffset:dimOffset,dimImageInfo:dimImageInfo}}gi=this.glyphInfos[glyph.index]={glyph:glyph,uGlyphRect:[bb.x1,-bb.y1,bb.x2,-bb.y2],strokeImageInfo:strokeImageInfo,strokes:strokes,colInfo:layout(cols,this.colDimImageInfos,this.colCellImageInfos),rowInfo:layout(rows,this.rowDimImageInfos,this.rowCellImageInfos)};gi.uGridOffset=[gi.colInfo.dimOffset,gi.rowInfo.dimOffset];return gi}}]);return FontInfo}();_main.default.RendererGL.prototype._renderText=function(p,line,x,y,maxY){if(!this._textFont||typeof this._textFont==="string"){console.log("WEBGL: you must load and set a font before drawing text. See `loadFont` and `textFont` for more details.");return}if(y>=maxY||!this._doFill){return}if(!this._isOpenType()){console.log("WEBGL: only Opentype (.otf) and Truetype (.ttf) fonts are supported");return p}p.push();var doStroke=this._doStroke;var drawMode=this.drawMode;this._doStroke=false;this.drawMode=constants.TEXTURE;var font=this._textFont.font;var fontInfo=this._textFont._fontInfo;if(!fontInfo){fontInfo=this._textFont._fontInfo=new FontInfo(font)}var pos=this._textFont._handleAlignment(this,line,x,y);var fontSize=this._textSize;var scale=fontSize/font.unitsPerEm;this.translate(pos.x,pos.y,0);this.scale(scale,scale,1);var gl=this.GL;var initializeShader=!this._defaultFontShader;var sh=this._getFontShader();sh.init();sh.bindShader();if(initializeShader){sh.setUniform("uGridImageSize",[gridImageWidth,gridImageHeight]);sh.setUniform("uCellsImageSize",[cellImageWidth,cellImageHeight]);sh.setUniform("uStrokeImageSize",[strokeImageWidth,strokeImageHeight]);sh.setUniform("uGridSize",[charGridWidth,charGridHeight])}this._applyColorBlend(this.curFillColor);var g=this.retainedMode.geometry["glyph"];if(!g){var geom=this._textGeom=new _main.default.Geometry(1,1,function(){for(var i=0;i<=1;i++){for(var j=0;j<=1;j++){this.vertices.push(new _main.default.Vector(j,i,0));this.uvs.push(j,i)}}});geom.computeFaces().computeNormals();g=this.createBuffers("glyph",geom)}var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.retainedMode.buffers.text[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var buff=_step3.value;buff._prepareBuffer(g,sh)}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return!=null){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}this._bindBuffer(g.indexBuffer,gl.ELEMENT_ARRAY_BUFFER);sh.setUniform("uMaterialColor",this.curFillColor);gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,false);try{var dx=0;var glyphPrev=null;var glyphs=font.stringToGlyphs(line);var _iteratorNormalCompletion4=true;var _didIteratorError4=false;var _iteratorError4=undefined;try{for(var _iterator4=glyphs[Symbol.iterator](),_step4;!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=true){var glyph=_step4.value;if(glyphPrev)dx+=font.getKerningValue(glyphPrev,glyph);var gi=fontInfo.getGlyphInfo(glyph);if(gi.uGlyphRect){var rowInfo=gi.rowInfo;var colInfo=gi.colInfo;sh.setUniform("uSamplerStrokes",gi.strokeImageInfo.imageData);sh.setUniform("uSamplerRowStrokes",rowInfo.cellImageInfo.imageData);sh.setUniform("uSamplerRows",rowInfo.dimImageInfo.imageData);sh.setUniform("uSamplerColStrokes",colInfo.cellImageInfo.imageData);sh.setUniform("uSamplerCols",colInfo.dimImageInfo.imageData);sh.setUniform("uGridOffset",gi.uGridOffset);sh.setUniform("uGlyphRect",gi.uGlyphRect);sh.setUniform("uGlyphOffset",dx);sh.bindTextures();gl.drawElements(gl.TRIANGLES,6,this.GL.UNSIGNED_SHORT,0)}dx+=glyph.advanceWidth;glyphPrev=glyph}}catch(err){_didIteratorError4=true;_iteratorError4=err}finally{try{if(!_iteratorNormalCompletion4&&_iterator4.return!=null){_iterator4.return()}}finally{if(_didIteratorError4){throw _iteratorError4}}}}finally{sh.unbindShader();this._doStroke=doStroke;this.drawMode=drawMode;gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);p.pop()}return p}},{"../core/constants":286,"../core/main":298,"./p5.RendererGL.Retained":354,"./p5.Shader":356,"core-js/modules/es.array.iterator":179,"core-js/modules/es.object.get-own-property-descriptor":196,"core-js/modules/es.object.to-string":200,"core-js/modules/es.regexp.exec":205,"core-js/modules/es.string.iterator":210,"core-js/modules/es.string.split":216,"core-js/modules/es.string.sub":218,"core-js/modules/es.symbol":222,"core-js/modules/es.symbol.description":220,"core-js/modules/es.symbol.iterator":221,"core-js/modules/es.weak-map":254,"core-js/modules/web.dom-collections.iterator":256}],359:[function(_dereq_,module,exports){module.exports={fes:{autoplay:"The media that tried to play (with '{{src}}') wasn't allowed to by this browser, most likely due to the browser's autoplay policy.\n\n+ More info: {{url}}",checkUserDefinedFns:"It seems that you may have accidentally written {{name}} instead of {{actualName}}. Please correct it if it's not intentional.",fileLoadError:{bytes:"It looks like there was a problem loading your file. {{suggestion}}",font:"It looks like there was a problem loading your font. {{suggestion}}",gif:"There was some trouble loading your GIF. Make sure that your GIF is using 87a or 89a encoding.",image:"It looks like there was a problem loading your image. {{suggestion}}",json:"It looks like there was a problem loading your JSON file. {{suggestion}}",large:"If your large file isn't fetched successfully, we recommend splitting the file into smaller segments and fetching those.",strings:"It looks like there was a problem loading your text file. {{suggestion}}",suggestion:"Try checking if the file path ({{filePath}}) is correct, hosting the file online, or running a local server.\n\n+ More info: {{url}}",table:"It looks like there was a problem loading your table file. {{suggestion}}",xml:"It looks like there was a problem loading your XML file. {{suggestion}}"},friendlyParamError:{type_EMPTY_VAR:"{{location}} {{func}}() was expecting {{formatType}} for the {{position}} parameter, received an empty variable instead. If not intentional, this is often a problem with scope.\n\n+ More info: {{url}}",type_TOO_FEW_ARGUMENTS:"{{location}} {{func}}() was expecting at least {{minParams}} arguments, but received only {{argCount}}.",type_TOO_MANY_ARGUMENTS:"{{location}} {{func}}() was expecting no more than {{maxParams}} arguments, but received {{argCount}}.",type_WRONG_TYPE:"{{location}} {{func}}() was expecting {{formatType}} for the {{position}} parameter, received {{argType}} instead."},globalErrors:{reference:{cannotAccess:'\n{{location}} "{{symbol}}" is used before declaration. Make sure you have declared the variable before using it.\n\n+ More info: {{url}}',notDefined:'\n{{location}} "{{symbol}}" is not defined in the current scope. If you have defined it in your code, you should check its scope, spelling, and letter-casing (JavaScript is case-sensitive).\n\n+ More info: {{url}}'},stackSubseq:"└[{{location}}] \n\t Called from line {{line}} in {{func}}()\n",stackTop:"┌[{{location}}] \n\t Error at line {{line}} in {{func}}()\n",syntax:{badReturnOrYield:"\nSyntax Error - return lies outside of a function. Make sure you’re not missing any brackets, so that return lies inside a function.\n\n+ More info: {{url}}",invalidToken:"\nSyntax Error - Found a symbol that JavaScript doesn't recognize or didn't expect at it's place.\n\n+ More info: {{url}}",missingInitializer:"\nSyntax Error - A const variable is declared but not initialized. In JavaScript, an initializer for a const is required. A value must be specified in the same statement in which the variable is declared. Check the line number in the error and assign the const variable a value.\n\n+ More info: {{url}}",redeclaredVariable:'\nSyntax Error - "{{symbol}}" is being redeclared. JavaScript doesn\'t allow declaring a variable more than once. Check the line number in error for redeclaration of the variable.\n\n+ More info: {{url}}',unexpectedToken:"\nSyntax Error - Symbol present at a place that wasn't expected.\nUsually this is due to a typo. Check the line number in the error for anything missing/extra.\n\n+ More info: {{url}}"},type:{constAssign:"\n{{location}} A const variable is being re-assigned. In javascript, re-assigning a value to a constant is not allowed. If you want to re-assign new values to a variable, make sure it is declared as var or let.\n\n+ More info: {{url}}",notfunc:'\n{{location}} "{{symbol}}" could not be called as a function.\nCheck the spelling, letter-casing (JavaScript is case-sensitive) and its type.\n\n+ More info: {{url}}',notfuncObj:'\n{{location}} "{{symbol}}" could not be called as a function.\nVerify whether "{{obj}}" has "{{symbol}}" in it and check the spelling, letter-casing (JavaScript is case-sensitive) and its type.\n\n+ More info: {{url}}',readFromNull:"\n{{location}} The property of null can't be read. In javascript the value null indicates that an object has no value.\n\n+ More info: {{url}}",readFromUndefined:"\n{{location}} Cannot read property of undefined. Check the line number in error and make sure the variable which is being operated is not undefined.\n\n + More info: {{url}}"}},libraryError:'{{location}} An error with message "{{error}}" occurred inside the p5js library when {{func}} was called. If not stated otherwise, it might be an issue with the arguments passed to {{func}}.',location:"[{{file}}, line {{line}}]",misspelling:'{{location}} It seems that you may have accidentally written "{{name}}" instead of "{{actualName}}". Please correct it to {{actualName}} if you wish to use the {{type}} from p5.js.',misspelling_plural:'{{location}} It seems that you may have accidentally written "{{name}}".\nYou may have meant one of the following: \n{{suggestions}}',misusedTopLevel:"Did you just try to use p5.js's {{symbolName}} {{symbolType}}? If so, you may want to move it into your sketch's setup() function.\n\n+ More info: {{url}}",positions:{p_1:"first",p_10:"tenth",p_11:"eleventh",p_12:"twelfth",p_2:"second",p_3:"third",p_4:"fourth",p_5:"fifth",p_6:"sixth",p_7:"seventh",p_8:"eighth",p_9:"ninth"},pre:"\n🌸 p5.js says: {{message}}",sketchReaderErrors:{reservedConst:'you have used a p5.js reserved variable "{{symbol}}" make sure you change the variable name to something else.\n\n+ More info: {{url}}',reservedFunc:'you have used a p5.js reserved function "{{symbol}}" make sure you change the function name to something else.\n\n+ More info: {{url}}'},welcome:"Welcome! This is your friendly debugger. To turn me off, switch to using p5.min.js.",wrongPreload:'{{location}} An error with message "{{error}}" occurred inside the p5js library when "{{func}}" was called. If not stated otherwise, it might be due to "{{func}}" being called from preload. Nothing besides load calls (loadImage, loadJSON, loadFont, loadStrings, etc.) should be inside the preload function.'}}},{}],360:[function(_dereq_,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.languages=exports.default=void 0;var _translation=_interopRequireDefault(_dereq_("./en/translation"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _default={en:{translation:_translation.default}};exports.default=_default;var languages=["en","es","ko","zh","hi"];exports.languages=languages},{"./en/translation":359}]},{},[281])(281)});!function(n){var i={};function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=n,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=40)}([function(t,e,n){var i;void 0===(i=function(){"use strict";function l(t,e){this.isUndef(t)||1===t?this.input=this.context.createGain():1<t&&(this.input=new Array(t)),this.isUndef(e)||1===e?this.output=this.context.createGain():1<e&&(this.output=new Array(t))}var e;return l.prototype.set=function(t,e,n){if(this.isObject(t))n=e;else if(this.isString(t)){var i={};i[t]=e,t=i}t:for(var r in t){e=t[r];var o=this;if(-1!==r.indexOf(".")){for(var s=r.split("."),a=0;a<s.length-1;a++)if((o=o[s[a]])instanceof l){s.splice(0,a+1);var u=s.join(".");o.set(u,e);continue t}r=s[s.length-1]}var c=o[r];this.isUndef(c)||(l.Signal&&c instanceof l.Signal||l.Param&&c instanceof l.Param?c.value!==e&&(this.isUndef(n)?c.value=e:c.rampTo(e,n)):c instanceof AudioParam?c.value!==e&&(c.value=e):c instanceof l?c.set(e):c!==e&&(o[r]=e))}return this},l.prototype.get=function(t){this.isUndef(t)?t=this._collectDefaults(this.constructor):this.isString(t)&&(t=[t]);for(var e={},n=0;n<t.length;n++){var i=t[n],r=this,o=e;if(-1!==i.indexOf(".")){for(var s=i.split("."),a=0;a<s.length-1;a++){var u=s[a];o[u]=o[u]||{},o=o[u],r=r[u]}i=s[s.length-1]}var c=r[i];this.isObject(t[i])?o[i]=c.get():l.Signal&&c instanceof l.Signal?o[i]=c.value:l.Param&&c instanceof l.Param?o[i]=c.value:c instanceof AudioParam?o[i]=c.value:c instanceof l?o[i]=c.get():this.isFunction(c)||this.isUndef(c)||(o[i]=c)}return e},l.prototype._collectDefaults=function(t){var e=[];if(this.isUndef(t.defaults)||(e=Object.keys(t.defaults)),!this.isUndef(t._super))for(var n=this._collectDefaults(t._super),i=0;i<n.length;i++)-1===e.indexOf(n[i])&&e.push(n[i]);return e},l.prototype.toString=function(){for(var t in l){var e=t[0].match(/^[A-Z]$/),n=l[t]===this.constructor;if(this.isFunction(l[t])&&e&&n)return t}return"Tone"},Object.defineProperty(l.prototype,"numberOfInputs",{get:function(){return this.input?this.isArray(this.input)?this.input.length:1:0}}),Object.defineProperty(l.prototype,"numberOfOutputs",{get:function(){return this.output?this.isArray(this.output)?this.output.length:1:0}}),l.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this},l.prototype.connect=function(t,e,n){return Array.isArray(this.output)?(e=this.defaultArg(e,0),this.output[e].connect(t,0,n)):this.output.connect(t,e,n),this},l.prototype.disconnect=function(t,e,n){this.isArray(this.output)?this.isNumber(t)?this.output[t].disconnect():(e=this.defaultArg(e,0),this.output[e].disconnect(t,0,n)):this.output.disconnect.apply(this.output,arguments)},l.prototype.connectSeries=function(){if(1<arguments.length)for(var t=arguments[0],e=1;e<arguments.length;e++){var n=arguments[e];t.connect(n),t=n}return this},l.prototype.chain=function(){if(0<arguments.length)for(var t=this,e=0;e<arguments.length;e++){var n=arguments[e];t.connect(n),t=n}return this},l.prototype.fan=function(){if(0<arguments.length)for(var t=0;t<arguments.length;t++)this.connect(arguments[t]);return this},AudioNode.prototype.chain=l.prototype.chain,AudioNode.prototype.fan=l.prototype.fan,l.prototype.defaultArg=function(t,e){if(this.isObject(t)&&this.isObject(e)){var n={};for(var i in t)n[i]=this.defaultArg(e[i],t[i]);for(var r in e)n[r]=this.defaultArg(t[r],e[r]);return n}return this.isUndef(t)?e:t},l.prototype.optionsObject=function(t,e,n){var i={};if(1===t.length&&this.isObject(t[0]))i=t[0];else for(var r=0;r<e.length;r++)i[e[r]]=t[r];return this.isUndef(n)?i:this.defaultArg(i,n)},l.prototype.isUndef=function(t){return void 0===t},l.prototype.isFunction=function(t){return"function"==typeof t},l.prototype.isNumber=function(t){return"number"==typeof t},l.prototype.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object},l.prototype.isBoolean=function(t){return"boolean"==typeof t},l.prototype.isArray=function(t){return Array.isArray(t)},l.prototype.isString=function(t){return"string"==typeof t},l.noOp=function(){},l.prototype._readOnly=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._readOnly(t[e]);else Object.defineProperty(this,t,{writable:!1,enumerable:!0})},l.prototype._writable=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._writable(t[e]);else Object.defineProperty(this,t,{writable:!0})},l.State={Started:"started",Stopped:"stopped",Paused:"paused"},l.prototype.equalPowerScale=function(t){var e=.5*Math.PI;return Math.sin(t*e)},l.prototype.dbToGain=function(t){return Math.pow(2,t/6)},l.prototype.gainToDb=function(t){return Math.log(t)/Math.LN10*20},l.prototype.intervalToFrequencyRatio=function(t){return Math.pow(2,t/12)},l.prototype.now=function(){return l.context.now()},l.now=function(){return l.context.now()},l.extend=function(t,e){function n(){}l.prototype.isUndef(e)&&(e=l),n.prototype=e.prototype,t.prototype=new n,(t.prototype.constructor=t)._super=e},Object.defineProperty(l,"context",{get:function(){return e},set:function(t){e=l.Context&&t instanceof l.Context?t:new l.Context(t),l.Context&&l.Context.emit("init",e)}}),Object.defineProperty(l.prototype,"context",{get:function(){return l.context}}),l.setContext=function(t){l.context=t},Object.defineProperty(l.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate}}),Object.defineProperty(l.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate}}),Object.defineProperty(l,"supported",{get:function(){var t=window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"),e=window.hasOwnProperty("Promise"),n=window.hasOwnProperty("Worker");return t&&e&&n}}),l.version="r10",window.TONE_SILENCE_VERSION_LOGGING,l}.call(e,n,e,t))||(t.exports=i)},function(t,e,n){var i,r;i=[n(0),n(2),n(10)],void 0===(r=function(e){"use strict";return e.Multiply=function(t){this.createInsOuts(2,0),this._mult=this.input[0]=this.output=new e.Gain,this._param=this.input[1]=this.output.gain,this._param.value=this.defaultArg(t,0)},e.extend(e.Multiply,e.Signal),e.Multiply.prototype.dispose=function(){return e.prototype.dispose.call(this),this._mult.dispose(),this._mult=null,this._param=null,this},e.Multiply}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(6),n(9),n(18),n(10)],void 0===(r=function(e){"use strict";return e.Signal=function(){var t=this.optionsObject(arguments,["value","units"],e.Signal.defaults);this.output=this._gain=this.context.createGain(),t.param=this._gain.gain,e.Param.call(this,t),this.input=this._param=this._gain.gain,this.context.getConstant(1).chain(this._gain)},e.extend(e.Signal,e.Param),e.Signal.defaults={value:0,units:e.Type.Default,convert:!0},e.Signal.prototype.connect=e.SignalBase.prototype.connect,e.Signal.prototype.dispose=function(){return e.Param.prototype.dispose.call(this),this._param=null,this._gain.disconnect(),this._gain=null,this},e.Signal}.apply(e,i))||(t.exports=r)},function(t,u,c){"use strict";(function(t){c.d(u,"b",function(){return s}),c.d(u,"c",function(){return a});var e=c(22),i=c.n(e),n=c(0),r=c.n(n);c(12);t.TONE_SILENCE_VERSION_LOGGING=!0;var o=new window.AudioContext;function s(){return o}function a(t,e){var n=t;return t instanceof p5.Element?n=t.elt:t instanceof Array&&t[0]instanceof p5.Element&&(n=t.map(function(t){return t.elt})),i()(o,n,e)}r.a.setContext(o),u.a=o}).call(this,c(26))},function(t,e,n){var i,r;i=[n(0),n(2),n(10)],void 0===(r=function(e){"use strict";return e.Add=function(t){this.createInsOuts(2,0),this._sum=this.input[0]=this.input[1]=this.output=new e.Gain,this._param=this.input[1]=new e.Signal(t),this._param.connect(this._sum)},e.extend(e.Add,e.Signal),e.Add.prototype.dispose=function(){return e.prototype.dispose.call(this),this._sum.dispose(),this._sum=null,this._param.dispose(),this._param=null,this},e.Add}.apply(e,i))||(t.exports=r)},function(t,e){t.exports={recorderProcessor:"recorder-processor",soundFileProcessor:"sound-file-processor",amplitudeProcessor:"amplitude-processor"}},function(t,e,n){var i,r;i=[n(0),n(15)],void 0===(r=function(t){"use strict";return t.WaveShaper=function(t,e){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(t)?this.curve=t:isFinite(t)||this.isUndef(t)?this._curve=new Float32Array(this.defaultArg(t,1024)):this.isFunction(t)&&(this._curve=new Float32Array(this.defaultArg(e,1024)),this.setMap(t))},t.extend(t.WaveShaper,t.SignalBase),t.WaveShaper.prototype.setMap=function(t){for(var e=0,n=this._curve.length;e<n;e++){var i=e/(n-1)*2-1;this._curve[e]=t(i,e)}return this._shaper.curve=this._curve,this},Object.defineProperty(t.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(t){this._curve=new Float32Array(t),this._shaper.curve=this._curve}}),Object.defineProperty(t.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){if(-1===["none","2x","4x"].indexOf(t))throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");this._shaper.oversample=t}}),t.WaveShaper.prototype.dispose=function(){return t.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},t.WaveShaper}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(2),n(19)],void 0===(r=function(u){"use strict";return u.TimelineSignal=function(){var t=this.optionsObject(arguments,["value","units"],u.Signal.defaults);this._events=new u.Timeline(10),u.Signal.apply(this,t),t.param=this._param,u.Param.call(this,t),this._initial=this._fromUnits(this._param.value)},u.extend(u.TimelineSignal,u.Param),u.TimelineSignal.Type={Linear:"linear",Exponential:"exponential",Target:"target",Curve:"curve",Set:"set"},Object.defineProperty(u.TimelineSignal.prototype,"value",{get:function(){var t=this.now(),e=this.getValueAtTime(t);return this._toUnits(e)},set:function(t){var e=this._fromUnits(t);this._initial=e,this.cancelScheduledValues(),this._param.value=e}}),u.TimelineSignal.prototype.setValueAtTime=function(t,e){return t=this._fromUnits(t),e=this.toSeconds(e),this._events.add({type:u.TimelineSignal.Type.Set,value:t,time:e}),this._param.setValueAtTime(t,e),this},u.TimelineSignal.prototype.linearRampToValueAtTime=function(t,e){return t=this._fromUnits(t),e=this.toSeconds(e),this._events.add({type:u.TimelineSignal.Type.Linear,value:t,time:e}),this._param.linearRampToValueAtTime(t,e),this},u.TimelineSignal.prototype.exponentialRampToValueAtTime=function(t,e){e=this.toSeconds(e);var n=this._searchBefore(e);n&&0===n.value&&this.setValueAtTime(this._minOutput,n.time),t=this._fromUnits(t);var i=Math.max(t,this._minOutput);return this._events.add({type:u.TimelineSignal.Type.Exponential,value:i,time:e}),t<this._minOutput?(this._param.exponentialRampToValueAtTime(this._minOutput,e-this.sampleTime),this.setValueAtTime(0,e)):this._param.exponentialRampToValueAtTime(t,e),this},u.TimelineSignal.prototype.setTargetAtTime=function(t,e,n){return t=this._fromUnits(t),t=Math.max(this._minOutput,t),n=Math.max(this._minOutput,n),e=this.toSeconds(e),this._events.add({type:u.TimelineSignal.Type.Target,value:t,time:e,constant:n}),this._param.setTargetAtTime(t,e,n),this},u.TimelineSignal.prototype.setValueCurveAtTime=function(t,e,n,i){i=this.defaultArg(i,1);for(var r=new Array(t.length),o=0;o<r.length;o++)r[o]=this._fromUnits(t[o])*i;e=this.toSeconds(e),n=this.toSeconds(n),this._events.add({type:u.TimelineSignal.Type.Curve,value:r,time:e,duration:n}),this._param.setValueAtTime(r[0],e);for(var s=1;s<r.length;s++){var a=e+s/(r.length-1)*n;this._param.linearRampToValueAtTime(r[s],a)}return this},u.TimelineSignal.prototype.cancelScheduledValues=function(t){return t=this.toSeconds(t),this._events.cancel(t),this._param.cancelScheduledValues(t),this},u.TimelineSignal.prototype.setRampPoint=function(t){t=this.toSeconds(t);var e=this._toUnits(this.getValueAtTime(t)),n=this._searchBefore(t);if(n&&n.time===t)this.cancelScheduledValues(t+this.sampleTime);else if(n&&n.type===u.TimelineSignal.Type.Curve&&n.time+n.duration>t)this.cancelScheduledValues(t),this.linearRampToValueAtTime(e,t);else{var i=this._searchAfter(t);i&&(this.cancelScheduledValues(t),i.type===u.TimelineSignal.Type.Linear?this.linearRampToValueAtTime(e,t):i.type===u.TimelineSignal.Type.Exponential&&this.exponentialRampToValueAtTime(e,t)),this.setValueAtTime(e,t)}return this},u.TimelineSignal.prototype.linearRampToValueBetween=function(t,e,n){return this.setRampPoint(e),this.linearRampToValueAtTime(t,n),this},u.TimelineSignal.prototype.exponentialRampToValueBetween=function(t,e,n){return this.setRampPoint(e),this.exponentialRampToValueAtTime(t,n),this},u.TimelineSignal.prototype._searchBefore=function(t){return this._events.get(t)},u.TimelineSignal.prototype._searchAfter=function(t){return this._events.getAfter(t)},u.TimelineSignal.prototype.getValueAtTime=function(t){t=this.toSeconds(t);var e=this._searchAfter(t),n=this._searchBefore(t),i=this._initial;if(null===n)i=this._initial;else if(n.type===u.TimelineSignal.Type.Target){var r,o=this._events.getBefore(n.time);r=null===o?this._initial:o.value,i=this._exponentialApproach(n.time,r,n.value,n.constant,t)}else i=n.type===u.TimelineSignal.Type.Curve?this._curveInterpolate(n.time,n.value,n.duration,t):null===e?n.value:e.type===u.TimelineSignal.Type.Linear?this._linearInterpolate(n.time,n.value,e.time,e.value,t):e.type===u.TimelineSignal.Type.Exponential?this._exponentialInterpolate(n.time,n.value,e.time,e.value,t):n.value;return i},u.TimelineSignal.prototype.connect=u.SignalBase.prototype.connect,u.TimelineSignal.prototype._exponentialApproach=function(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)},u.TimelineSignal.prototype._linearInterpolate=function(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e)},u.TimelineSignal.prototype._exponentialInterpolate=function(t,e,n,i,r){return(e=Math.max(this._minOutput,e))*Math.pow(i/e,(r-t)/(n-t))},u.TimelineSignal.prototype._curveInterpolate=function(t,e,n,i){var r=e.length;if(t+n<=i)return e[r-1];if(i<=t)return e[0];var o=(i-t)/n,s=Math.floor((r-1)*o),a=Math.ceil((r-1)*o),u=e[s],c=e[a];return a===s?u:this._linearInterpolate(s,u,a,c,o*(r-1))},u.TimelineSignal.prototype.dispose=function(){u.Signal.prototype.dispose.call(this),u.Param.prototype.dispose.call(this),this._events.dispose(),this._events=null},u.TimelineSignal}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(4),n(1),n(2)],void 0===(r=function(n){"use strict";return n.Scale=function(t,e){this._outputMin=this.defaultArg(t,0),this._outputMax=this.defaultArg(e,1),this._scale=this.input=new n.Multiply(1),this._add=this.output=new n.Add(0),this._scale.connect(this._add),this._setRange()},n.extend(n.Scale,n.SignalBase),Object.defineProperty(n.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(t){this._outputMin=t,this._setRange()}}),Object.defineProperty(n.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(t){this._outputMax=t,this._setRange()}}),n.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},n.Scale.prototype.dispose=function(){return n.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},n.Scale}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(16),n(30),n(31),n(12)],void 0===(r=function(e){return e.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"},e.prototype.toSeconds=function(t){return this.isNumber(t)?t:this.isUndef(t)?this.now():this.isString(t)?new e.Time(t).toSeconds():t instanceof e.TimeBase?t.toSeconds():void 0},e.prototype.toFrequency=function(t){return this.isNumber(t)?t:this.isString(t)||this.isUndef(t)?new e.Frequency(t).valueOf():t instanceof e.TimeBase?t.toFrequency():void 0},e.prototype.toTicks=function(t){return this.isNumber(t)||this.isString(t)?new e.TransportTime(t).toTicks():this.isUndef(t)?e.Transport.ticks:t instanceof e.TimeBase?t.toTicks():void 0},e}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(18),n(9)],void 0===(r=function(n){"use strict";return window.GainNode&&!AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),n.Gain=function(){var t=this.optionsObject(arguments,["gain","units"],n.Gain.defaults);this.input=this.output=this._gainNode=this.context.createGain(),this.gain=new n.Param({param:this._gainNode.gain,units:t.units,value:t.gain,convert:t.convert}),this._readOnly("gain")},n.extend(n.Gain),n.Gain.defaults={gain:1,convert:!0},n.Gain.prototype.dispose=function(){n.Param.prototype.dispose.call(this),this._gainNode.disconnect(),this._gainNode=null,this._writable("gain"),this.gain.dispose(),this.gain=null},n.prototype.createInsOuts=function(t,e){1===t?this.input=new n.Gain:1<t&&(this.input=new Array(t)),1===e?this.output=new n.Gain:1<e&&(this.output=new Array(t))},n.Gain}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(7),n(39),n(14),n(12)],void 0===(r=function(r){"use strict";return r.Clock=function(){r.Emitter.call(this);var t=this.optionsObject(arguments,["callback","frequency"],r.Clock.defaults);this.callback=t.callback,this._nextTick=0,this._lastState=r.State.Stopped,this.frequency=new r.TimelineSignal(t.frequency,r.Type.Frequency),this._readOnly("frequency"),this.ticks=0,this._state=new r.TimelineState(r.State.Stopped),this._boundLoop=this._loop.bind(this),this.context.on("tick",this._boundLoop)},r.extend(r.Clock,r.Emitter),r.Clock.defaults={callback:r.noOp,frequency:1,lookAhead:"auto"},Object.defineProperty(r.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),r.Clock.prototype.start=function(t,e){return t=this.toSeconds(t),this._state.getValueAtTime(t)!==r.State.Started&&this._state.add({state:r.State.Started,time:t,offset:e}),this},r.Clock.prototype.stop=function(t){return t=this.toSeconds(t),this._state.cancel(t),this._state.setStateAtTime(r.State.Stopped,t),this},r.Clock.prototype.pause=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)===r.State.Started&&this._state.setStateAtTime(r.State.Paused,t),this},r.Clock.prototype._loop=function(){for(var t=this.now()+this.context.lookAhead+this.context.updateInterval+2*this.context.lag;t>this._nextTick&&this._state;){var e=this._state.getValueAtTime(this._nextTick);if(e!==this._lastState){this._lastState=e;var n=this._state.get(this._nextTick);e===r.State.Started?(this._nextTick=n.time,this.isUndef(n.offset)||(this.ticks=n.offset),this.emit("start",n.time,this.ticks)):e===r.State.Stopped?(this.ticks=0,this.emit("stop",n.time)):e===r.State.Paused&&this.emit("pause",n.time)}var i=this._nextTick;this.frequency&&(this._nextTick+=1/this.frequency.getValueAtTime(this._nextTick),e===r.State.Started&&(this.callback(i),this.ticks++))}},r.Clock.prototype.getStateAtTime=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)},r.Clock.prototype.dispose=function(){r.Emitter.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._writable("frequency"),this.frequency.dispose(),this.frequency=null,this._boundLoop=null,this._nextTick=1/0,this.callback=null,this._state.dispose(),this._state=null},r.Clock}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(14)],void 0===(r=function(i){function t(t,e,n){if(t.input)Array.isArray(t.input)?(i.prototype.isUndef(n)&&(n=0),this.connect(t.input[n])):this.connect(t.input,e,n);else try{t instanceof AudioNode?r.call(this,t,e,n):r.call(this,t,e)}catch(e){throw new Error("error connecting to node: "+t+"\n"+e)}}var r,o;return!window.hasOwnProperty("AudioContext")&&window.hasOwnProperty("webkitAudioContext")&&(window.AudioContext=window.webkitAudioContext),i.Context=function(t){for(var e in i.Emitter.call(this),t=t||new window.AudioContext,this._context=t,this._context)this._defineProperty(this._context,e);this._latencyHint="interactive",this._lookAhead=.1,this._updateInterval=this._lookAhead/3,this._computedUpdateInterval=0,this._worker=this._createWorker(),this._constants={}},i.extend(i.Context,i.Emitter),i.Emitter.mixin(i.Context),i.Context.prototype._defineProperty=function(e,n){this.isUndef(this[n])&&Object.defineProperty(this,n,{get:function(){return"function"==typeof e[n]?e[n].bind(e):e[n]},set:function(t){e[n]=t}})},i.Context.prototype.now=function(){return this._context.currentTime},i.Context.prototype._createWorker=function(){window.URL=window.URL||window.webkitURL;var t=new Blob(["var timeoutTime = "+(1e3*this._updateInterval).toFixed(1)+";self.onmessage = function(msg){\ttimeoutTime = parseInt(msg.data);};function tick(){\tsetTimeout(tick, timeoutTime);\tself.postMessage('tick');}tick();"]),e=URL.createObjectURL(t),n=new Worker(e);return n.addEventListener("message",function(){this.emit("tick")}.bind(this)),n.addEventListener("message",function(){var t=this.now();if(this.isNumber(this._lastUpdate)){var e=t-this._lastUpdate;this._computedUpdateInterval=Math.max(e,.97*this._computedUpdateInterval)}this._lastUpdate=t}.bind(this)),n},i.Context.prototype.getConstant=function(t){if(this._constants[t])return this._constants[t];for(var e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0),i=0;i<n.length;i++)n[i]=t;var r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=e,r.loop=!0,r.start(0),this._constants[t]=r},Object.defineProperty(i.Context.prototype,"lag",{get:function(){var t=this._computedUpdateInterval-this._updateInterval;return Math.max(t,0)}}),Object.defineProperty(i.Context.prototype,"lookAhead",{get:function(){return this._lookAhead},set:function(t){this._lookAhead=t}}),Object.defineProperty(i.Context.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(t){this._updateInterval=Math.max(t,i.prototype.blockTime),this._worker.postMessage(Math.max(1e3*t,1))}}),Object.defineProperty(i.Context.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(t){var e=t;if(this._latencyHint=t,this.isString(t))switch(t){case"interactive":e=.1,this._context.latencyHint=t;break;case"playback":e=.8,this._context.latencyHint=t;break;case"balanced":e=.25,this._context.latencyHint=t;break;case"fastest":e=.01}this.lookAhead=e,this.updateInterval=e/3}}),i.supported&&(r=AudioNode.prototype.connect,o=AudioNode.prototype.disconnect,AudioNode.prototype.connect!==t&&(AudioNode.prototype.connect=t,AudioNode.prototype.disconnect=function(t,e,n){if(t&&t.input&&Array.isArray(t.input))i.prototype.isUndef(n)&&(n=0),this.disconnect(t.input[n],e,n);else if(t&&t.input)this.disconnect(t.input,e,n);else try{o.apply(this,arguments)}catch(e){throw new Error("error disconnecting node: "+t+"\n"+e)}}),i.context=new i.Context),i.Context}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(4),n(20),n(2),n(10)],void 0===(r=function(e){"use strict";return e.Subtract=function(t){this.createInsOuts(2,0),this._sum=this.input[0]=this.output=new e.Gain,this._neg=new e.Negate,this._param=this.input[1]=new e.Signal(t),this._param.chain(this._neg,this._sum)},e.extend(e.Subtract,e.Signal),e.Subtract.prototype.dispose=function(){return e.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._param.dispose(),this._param=null,this},e.Subtract}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0)],void 0===(r=function(s){"use strict";return s.Emitter=function(){this._events={}},s.extend(s.Emitter),s.Emitter.prototype.on=function(t,e){for(var n=t.split(/\W+/),i=0;i<n.length;i++){var r=n[i];this._events.hasOwnProperty(r)||(this._events[r]=[]),this._events[r].push(e)}return this},s.Emitter.prototype.off=function(t,e){for(var n=t.split(/\W+/),i=0;i<n.length;i++)if(t=n[i],this._events.hasOwnProperty(t))if(s.prototype.isUndef(e))this._events[t]=[];else for(var r=this._events[t],o=0;o<r.length;o++)r[o]===e&&r.splice(o,1);return this},s.Emitter.prototype.emit=function(t){if(this._events){var e=Array.apply(null,arguments).slice(1);if(this._events.hasOwnProperty(t))for(var n=this._events[t],i=0,r=n.length;i<r;i++)n[i].apply(this,e)}return this},s.Emitter.mixin=function(t){var e=["on","off","emit"];t._events={};for(var n=0;n<e.length;n++){var i=e[n],r=s.Emitter.prototype[i];t[i]=r}},s.Emitter.prototype.dispose=function(){return s.prototype.dispose.call(this),this._events=null,this},s.Emitter}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0)],void 0===(r=function(i){"use strict";return i.SignalBase=function(){},i.extend(i.SignalBase),i.SignalBase.prototype.connect=function(t,e,n){return i.Signal&&i.Signal===t.constructor||i.Param&&i.Param===t.constructor||i.TimelineSignal&&i.TimelineSignal===t.constructor?(t._param.cancelScheduledValues(0),t._param.value=0,t.overridden=!0):t instanceof AudioParam&&(t.cancelScheduledValues(0),t.value=0),i.prototype.connect.call(this,t,e,n),this},i.SignalBase}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(17)],void 0===(r=function(n){return n.Time=function(t,e){if(!(this instanceof n.Time))return new n.Time(t,e);this._plusNow=!1,n.TimeBase.call(this,t,e)},n.extend(n.Time,n.TimeBase),n.Time.prototype._unaryExpressions=Object.create(n.TimeBase.prototype._unaryExpressions),n.Time.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(t){return n.Transport.nextSubdivision(t())}},n.Time.prototype._unaryExpressions.now={regexp:/^\+/,method:function(t){return this._plusNow=!0,t()}},n.Time.prototype.quantize=function(t,e){return e=this.defaultArg(e,1),this._expr=function(t,e,n){return t=t(),e=e.toSeconds(),t+(Math.round(t/e)*e-t)*n}.bind(this,this._expr,new this.constructor(t),e),this},n.Time.prototype.addNow=function(){return this._plusNow=!0,this},n.Time.prototype._defaultExpr=function(){return this._plusNow=!0,this._noOp},n.Time.prototype.copy=function(t){return n.TimeBase.prototype.copy.call(this,t),this._plusNow=t._plusNow,this},n.Time.prototype.toNotation=function(){var t=this.toSeconds(),e=this._toNotationHelper(t,["1m","2n","4n","8n","16n","32n","64n","128n"]),n=this._toNotationHelper(t,["1m","2n","2t","4n","4t","8n","8t","16n","16t","32n","32t","64n","64t","128n"]);return n.split("+").length<e.split("+").length?n:e},n.Time.prototype._toNotationHelper=function(t,e){for(var n=this._notationToUnits(e[e.length-1]),i="",r=0;r<e.length;r++){var o=this._notationToUnits(e[r]),s=t/o;if(1-s%1<1e-6&&(s+=1e-6),0<(s=Math.floor(s))){if(i+=1===s?e[r]:s.toString()+"*"+e[r],(t-=s*o)<n)break;i+=" + "}}return""===i&&(i="0"),i},n.Time.prototype._notationToUnits=function(t){for(var e=this._primaryExpressions,n=[e.n,e.t,e.m],i=0;i<n.length;i++){var r=n[i],o=t.match(r.regexp);if(o)return r.method.call(this,o[1])}},n.Time.prototype.toBarsBeatsSixteenths=function(){var t=this._beatsToUnits(1),e=this.toSeconds()/t,n=Math.floor(e/this._timeSignature()),i=e%1*4;return e=Math.floor(e)%this._timeSignature(),3<(i=i.toString()).length&&(i=parseFloat(i).toFixed(3)),[n,e,i].join(":")},n.Time.prototype.toTicks=function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*n.Transport.PPQ)},n.Time.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},n.Time.prototype.toFrequency=function(){return 1/this.toSeconds()},n.Time.prototype.toSeconds=function(){return this.valueOf()},n.Time.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},n.Time.prototype.valueOf=function(){return this._expr()+(this._plusNow?this.now():0)},n.Time}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0)],void 0===(r=function(i){return i.TimeBase=function(t,e){if(!(this instanceof i.TimeBase))return new i.TimeBase(t,e);if(this._expr=this._noOp,t instanceof i.TimeBase)this.copy(t);else if(!this.isUndef(e)||this.isNumber(t)){e=this.defaultArg(e,this._defaultUnits);var n=this._primaryExpressions[e].method;this._expr=n.bind(this,t)}else this.isString(t)?this.set(t):this.isUndef(t)&&(this._expr=this._defaultExpr())},i.extend(i.TimeBase),i.TimeBase.prototype.set=function(t){return this._expr=this._parseExprString(t),this},i.TimeBase.prototype.clone=function(){var t=new this.constructor;return t.copy(this),t},i.TimeBase.prototype.copy=function(t){var e=t._expr();return this.set(e)},i.TimeBase.prototype._primaryExpressions={n:{regexp:/^(\d+)n/i,method:function(t){return 1===(t=parseInt(t))?this._beatsToUnits(this._timeSignature()):this._beatsToUnits(4/t)}},t:{regexp:/^(\d+)t/i,method:function(t){return t=parseInt(t),this._beatsToUnits(8/(3*parseInt(t)))}},m:{regexp:/^(\d+)m/i,method:function(t){return this._beatsToUnits(parseInt(t)*this._timeSignature())}},i:{regexp:/^(\d+)i/i,method:function(t){return this._ticksToUnits(parseInt(t))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz/i,method:function(t){return this._frequencyToUnits(parseFloat(t))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,n){var i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._timeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i}},s:{regexp:/^(\d+(?:\.\d+)?s)/,method:function(t){return this._secondsToUnits(parseFloat(t))}},samples:{regexp:/^(\d+)samples/,method:function(t){return parseInt(t)/this.context.sampleRate}},default:{regexp:/^(\d+(?:\.\d+)?)/,method:function(t){return this._primaryExpressions[this._defaultUnits].method.call(this,t)}}},i.TimeBase.prototype._binaryExpressions={"+":{regexp:/^\+/,precedence:2,method:function(t,e){return t()+e()}},"-":{regexp:/^\-/,precedence:2,method:function(t,e){return t()-e()}},"*":{regexp:/^\*/,precedence:1,method:function(t,e){return t()*e()}},"/":{regexp:/^\//,precedence:1,method:function(t,e){return t()/e()}}},i.TimeBase.prototype._unaryExpressions={neg:{regexp:/^\-/,method:function(t){return-t()}}},i.TimeBase.prototype._syntaxGlue={"(":{regexp:/^\(/},")":{regexp:/^\)/}},i.TimeBase.prototype._tokenize=function(t){for(var e=-1,n=[];0<t.length;){var i=r(t=t.trim(),this);n.push(i),t=t.substr(i.value.length)}function r(t,e){for(var n=["_binaryExpressions","_unaryExpressions","_primaryExpressions","_syntaxGlue"],i=0;i<n.length;i++){var r=e[n[i]];for(var o in r){var s=r[o],a=s.regexp,u=t.match(a);if(null!==u)return{method:s.method,precedence:s.precedence,regexp:s.regexp,value:u[0]}}}throw new SyntaxError("Tone.TimeBase: Unexpected token "+t)}return{next:function(){return n[++e]},peek:function(){return n[e+1]}}},i.TimeBase.prototype._matchGroup=function(t,e,n){if(!this.isUndef(t))for(var i in e){var r=e[i];if(r.regexp.test(t.value)){if(this.isUndef(n))return r;if(r.precedence===n)return r}}return!1},i.TimeBase.prototype._parseBinary=function(t,e){var n;this.isUndef(e)&&(e=2),n=e<0?this._parseUnary(t):this._parseBinary(t,e-1);for(var i=t.peek();i&&this._matchGroup(i,this._binaryExpressions,e);)n=(i=t.next()).method.bind(this,n,this._parseBinary(t,e-1)),i=t.peek();return n},i.TimeBase.prototype._parseUnary=function(t){var e,n;e=t.peek();var i=this._matchGroup(e,this._unaryExpressions);return i?(e=t.next(),n=this._parseUnary(t),i.method.bind(this,n)):this._parsePrimary(t)},i.TimeBase.prototype._parsePrimary=function(t){var e,n;if(e=t.peek(),this.isUndef(e))throw new SyntaxError("Tone.TimeBase: Unexpected end of expression");if(this._matchGroup(e,this._primaryExpressions)){var i=(e=t.next()).value.match(e.regexp);return e.method.bind(this,i[1],i[2],i[3])}if(e&&"("===e.value){if(t.next(),n=this._parseBinary(t),!(e=t.next())||")"!==e.value)throw new SyntaxError("Expected )");return n}throw new SyntaxError("Tone.TimeBase: Cannot process token "+e.value)},i.TimeBase.prototype._parseExprString=function(t){this.isString(t)||(t=t.toString());var e=this._tokenize(t);return this._parseBinary(e)},i.TimeBase.prototype._noOp=function(){return 0},i.TimeBase.prototype._defaultExpr=function(){return this._noOp},i.TimeBase.prototype._defaultUnits="s",i.TimeBase.prototype._frequencyToUnits=function(t){return 1/t},i.TimeBase.prototype._beatsToUnits=function(t){return 60/i.Transport.bpm.value*t},i.TimeBase.prototype._secondsToUnits=function(t){return t},i.TimeBase.prototype._ticksToUnits=function(t){return t*(this._beatsToUnits(1)/i.Transport.PPQ)},i.TimeBase.prototype._timeSignature=function(){return i.Transport.timeSignature},i.TimeBase.prototype._pushExpr=function(t,e,n){return t instanceof i.TimeBase||(t=new this.constructor(t,n)),this._expr=this._binaryExpressions[e].method.bind(this,this._expr,t._expr),this},i.TimeBase.prototype.add=function(t,e){return this._pushExpr(t,"+",e)},i.TimeBase.prototype.sub=function(t,e){return this._pushExpr(t,"-",e)},i.TimeBase.prototype.mult=function(t,e){return this._pushExpr(t,"*",e)},i.TimeBase.prototype.div=function(t,e){return this._pushExpr(t,"/",e)},i.TimeBase.prototype.valueOf=function(){return this._expr()},i.TimeBase.prototype.dispose=function(){this._expr=null},i.TimeBase}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(9)],void 0===(r=function(i){"use strict";return i.Param=function(){var t=this.optionsObject(arguments,["param","units","convert"],i.Param.defaults);this._param=this.input=t.param,this.units=t.units,this.convert=t.convert,this.overridden=!1,this._lfo=null,this.isObject(t.lfo)?this.value=t.lfo:this.isUndef(t.value)||(this.value=t.value)},i.extend(i.Param),i.Param.defaults={units:i.Type.Default,convert:!0,param:void 0},Object.defineProperty(i.Param.prototype,"value",{get:function(){return this._toUnits(this._param.value)},set:function(t){if(this.isObject(t)){if(this.isUndef(i.LFO))throw new Error("Include 'Tone.LFO' to use an LFO as a Param value.");this._lfo&&this._lfo.dispose(),this._lfo=new i.LFO(t).start(),this._lfo.connect(this.input)}else{var e=this._fromUnits(t);this._param.cancelScheduledValues(0),this._param.value=e}}}),i.Param.prototype._fromUnits=function(t){if(!this.convert&&!this.isUndef(this.convert))return t;switch(this.units){case i.Type.Time:return this.toSeconds(t);case i.Type.Frequency:return this.toFrequency(t);case i.Type.Decibels:return this.dbToGain(t);case i.Type.NormalRange:return Math.min(Math.max(t,0),1);case i.Type.AudioRange:return Math.min(Math.max(t,-1),1);case i.Type.Positive:return Math.max(t,0);default:return t}},i.Param.prototype._toUnits=function(t){if(!this.convert&&!this.isUndef(this.convert))return t;switch(this.units){case i.Type.Decibels:return this.gainToDb(t);default:return t}},i.Param.prototype._minOutput=1e-5,i.Param.prototype.setValueAtTime=function(t,e){return t=this._fromUnits(t),(e=this.toSeconds(e))<=this.now()+this.blockTime?this._param.value=t:this._param.setValueAtTime(t,e),this},i.Param.prototype.setRampPoint=function(t){t=this.defaultArg(t,this.now());var e=this._param.value;return 0===e&&(e=this._minOutput),this._param.setValueAtTime(e,t),this},i.Param.prototype.linearRampToValueAtTime=function(t,e){return t=this._fromUnits(t),this._param.linearRampToValueAtTime(t,this.toSeconds(e)),this},i.Param.prototype.exponentialRampToValueAtTime=function(t,e){return t=this._fromUnits(t),t=Math.max(this._minOutput,t),this._param.exponentialRampToValueAtTime(t,this.toSeconds(e)),this},i.Param.prototype.exponentialRampToValue=function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this},i.Param.prototype.linearRampToValue=function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this},i.Param.prototype.setTargetAtTime=function(t,e,n){return t=this._fromUnits(t),t=Math.max(this._minOutput,t),n=Math.max(this._minOutput,n),this._param.setTargetAtTime(t,this.toSeconds(e),n),this},i.Param.prototype.setValueCurveAtTime=function(t,e,n){for(var i=0;i<t.length;i++)t[i]=this._fromUnits(t[i]);return this._param.setValueCurveAtTime(t,this.toSeconds(e),this.toSeconds(n)),this},i.Param.prototype.cancelScheduledValues=function(t){return this._param.cancelScheduledValues(this.toSeconds(t)),this},i.Param.prototype.rampTo=function(t,e,n){return e=this.defaultArg(e,0),this.units===i.Type.Frequency||this.units===i.Type.BPM||this.units===i.Type.Decibels?this.exponentialRampToValue(t,e,n):this.linearRampToValue(t,e,n),this},Object.defineProperty(i.Param.prototype,"lfo",{get:function(){return this._lfo}}),i.Param.prototype.dispose=function(){return i.prototype.dispose.call(this),this._param=null,this._lfo&&(this._lfo.dispose(),this._lfo=null),this},i.Param}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(9)],void 0===(r=function(e){"use strict";return e.Timeline=function(){var t=this.optionsObject(arguments,["memory"],e.Timeline.defaults);this._timeline=[],this._toRemove=[],this._iterating=!1,this.memory=t.memory},e.extend(e.Timeline),e.Timeline.defaults={memory:1/0},Object.defineProperty(e.Timeline.prototype,"length",{get:function(){return this._timeline.length}}),e.Timeline.prototype.add=function(t){if(this.isUndef(t.time))throw new Error("Tone.Timeline: events must have a time attribute");if(this._timeline.length){var e=this._search(t.time);this._timeline.splice(e+1,0,t)}else this._timeline.push(t);if(this.length>this.memory){var n=this.length-this.memory;this._timeline.splice(0,n)}return this},e.Timeline.prototype.remove=function(t){if(this._iterating)this._toRemove.push(t);else{var e=this._timeline.indexOf(t);-1!==e&&this._timeline.splice(e,1)}return this},e.Timeline.prototype.get=function(t){var e=this._search(t);return-1!==e?this._timeline[e]:null},e.Timeline.prototype.peek=function(){return this._timeline[0]},e.Timeline.prototype.shift=function(){return this._timeline.shift()},e.Timeline.prototype.getAfter=function(t){var e=this._search(t);return e+1<this._timeline.length?this._timeline[e+1]:null},e.Timeline.prototype.getBefore=function(t){var e=this._timeline.length;if(0<e&&this._timeline[e-1].time<t)return this._timeline[e-1];var n=this._search(t);return 0<=n-1?this._timeline[n-1]:null},e.Timeline.prototype.cancel=function(t){if(1<this._timeline.length){var e=this._search(t);if(0<=e)if(this._timeline[e].time===t){for(var n=e;0<=n&&this._timeline[n].time===t;n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&this._timeline[0].time>=t&&(this._timeline=[]);return this},e.Timeline.prototype.cancelBefore=function(t){if(this._timeline.length){var e=this._search(t);0<=e&&(this._timeline=this._timeline.slice(e+1))}return this},e.Timeline.prototype._search=function(t){var e=0,n=this._timeline.length,i=n;if(0<n&&this._timeline[n-1].time<=t)return n-1;for(;e<i;){var r=Math.floor(e+(i-e)/2),o=this._timeline[r],s=this._timeline[r+1];if(o.time===t){for(var a=r;a<this._timeline.length;a++)this._timeline[a].time===t&&(r=a);return r}if(o.time<t&&s.time>t)return r;o.time>t?i=r:o.time<t&&(e=r+1)}return-1},e.Timeline.prototype._iterate=function(t,e,n){this._iterating=!0,e=this.defaultArg(e,0),n=this.defaultArg(n,this._timeline.length-1);for(var i=e;i<=n;i++)t(this._timeline[i]);if(this._iterating=!1,0<this._toRemove.length){for(var r=0;r<this._toRemove.length;r++){var o=this._timeline.indexOf(this._toRemove[r]);-1!==o&&this._timeline.splice(o,1)}this._toRemove=[]}},e.Timeline.prototype.forEach=function(t){return this._iterate(t),this},e.Timeline.prototype.forEachBefore=function(t,e){var n=this._search(t);return-1!==n&&this._iterate(e,0,n),this},e.Timeline.prototype.forEachAfter=function(t,e){var n=this._search(t);return this._iterate(e,n+1),this},e.Timeline.prototype.forEachFrom=function(t,e){for(var n=this._search(t);0<=n&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this},e.Timeline.prototype.forEachAtTime=function(e,n){var t=this._search(e);return-1!==t&&this._iterate(function(t){t.time===e&&n(t)},0,t),this},e.Timeline.prototype.dispose=function(){e.prototype.dispose.call(this),this._timeline=null,this._toRemove=null},e.Timeline}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(1),n(2)],void 0===(r=function(t){"use strict";return t.Negate=function(){this._multiply=this.input=this.output=new t.Multiply(-1)},t.extend(t.Negate,t.SignalBase),t.Negate.prototype.dispose=function(){return t.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},t.Negate}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(2),n(1),n(6)],void 0===(r=function(t){"use strict";return t.GreaterThanZero=function(){this._thresh=this.output=new t.WaveShaper(function(t){return t<=0?0:1},127),this._scale=this.input=new t.Multiply(1e4),this._scale.connect(this._thresh)},t.extend(t.GreaterThanZero,t.SignalBase),t.GreaterThanZero.prototype.dispose=function(){return t.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},t.GreaterThanZero}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r,o;r=[],void 0===(o="function"==typeof(i=function(){var s=function(t,e){this._dragged=!1,this._element=t,this._bindedMove=this._moved.bind(this),this._bindedEnd=this._ended.bind(this,e),t.addEventListener("touchstart",this._bindedEnd),t.addEventListener("touchmove",this._bindedMove),t.addEventListener("touchend",this._bindedEnd),t.addEventListener("mouseup",this._bindedEnd)};function o(t){return"running"===t.state}return s.prototype._moved=function(t){this._dragged=!0},s.prototype._ended=function(t){this._dragged||function(t){var e=t.createBuffer(1,1,t.sampleRate),n=t.createBufferSource();n.buffer=e,n.connect(t.destination),n.start(0),t.resume&&t.resume()}(t),this._dragged=!1},s.prototype.dispose=function(){this._element.removeEventListener("touchstart",this._bindedEnd),this._element.removeEventListener("touchmove",this._bindedMove),this._element.removeEventListener("touchend",this._bindedEnd),this._element.removeEventListener("mouseup",this._bindedEnd),this._bindedMove=null,this._bindedEnd=null,this._element=null},function(e,t,n){var i=new Promise(function(t){!function(e,n){o(e)?n():function t(){o(e)?n():(requestAnimationFrame(t),e.resume&&e.resume())}()}(e,t)}),r=[];return function t(e,n,i){if(Array.isArray(e)||NodeList&&e instanceof NodeList)for(var r=0;r<e.length;r++)t(e[r],n,i);else if("string"==typeof e)t(document.querySelectorAll(e),n,i);else if(e.jquery&&"function"==typeof e.toArray)t(e.toArray(),n,i);else if(Element&&e instanceof Element){var o=new s(e,i);n.push(o)}}(t=t||document.body,r,e),i.then(function(){for(var t=0;t<r.length;t++)r[t].dispose();r=null,n&&n()}),i}})?i.apply(e,r):i)||(t.exports=o)},function(t,e,n){var i,r;i=[n(0),n(2),n(32),n(38),n(10)],void 0===(r=function(e){"use strict";return e.CrossFade=function(t){this.createInsOuts(2,1),this.a=this.input[0]=new e.Gain,this.b=this.input[1]=new e.Gain,this.fade=new e.Signal(this.defaultArg(t,.5),e.Type.NormalRange),this._equalPowerA=new e.EqualPowerGain,this._equalPowerB=new e.EqualPowerGain,this._invert=new e.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},e.extend(e.CrossFade),e.CrossFade.prototype.dispose=function(){return e.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.dispose(),this.a=null,this.b.dispose(),this.b=null,this},e.CrossFade}.apply(e,i))||(t.exports=r)},function(t,e){function l(t){var i=this,r={},o=-1;this.parameters.forEach(function(t,e){var n=a[++o]||(a[o]=new Float32Array(i.bufferSize));n.fill(t.value),r[e]=n}),this.processor.realm.exec("self.sampleRate=sampleRate="+this.context.sampleRate+";self.currentTime=currentTime="+this.context.currentTime);var e=s(t.inputBuffer),n=s(t.outputBuffer);this.instance.process([e],[n],r)}function s(t){for(var e=[],n=0;n<t.numberOfChannels;n++)e[n]=t.getChannelData(n);return e}function h(t){return t.$$processors||(t.$$processors={})}function n(t){this.$$context=t}var p,a;a=[],"function"!=typeof AudioWorkletNode&&(self.AudioWorkletNode=function(t,e,n){var i=h(t)[e],r=t.createScriptProcessor(void 0,2,n&&n.outputChannelCount?n.outputChannelCount[0]:2);if(r.parameters=new Map,i.properties)for(var o=0;o<i.properties.length;o++){var s=i.properties[o],a=t.createGain().gain;a.value=s.defaultValue,r.parameters.set(s.name,a)}var u=new MessageChannel;p=u.port2;var c=new i.Processor(n||{});return p=null,r.port=u.port1,r.processor=i,r.instance=c,r.onaudioprocess=l,r},Object.defineProperty((self.AudioContext||self.webkitAudioContext).prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new self.AudioWorklet(this))}}),self.AudioWorklet=(n.prototype.addModule=function(t,e){var r=this;return fetch(t).then(function(t){if(!t.ok)throw Error(t.status);return t.text()}).then(function(t){var n={sampleRate:0,currentTime:0,AudioWorkletProcessor:function(){this.port=p},registerProcessor:function(t,e){h(r.$$context)[t]={realm:i,context:n,Processor:e,properties:e.parameterDescriptors||[]}}},i=new function(t,e){var n=document.createElement("iframe");n.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",e.appendChild(n);var i=n.contentWindow,r=i.document,o="var window,$hook";for(var s in i)s in t||"eval"===s||(o+=",",o+=s);for(var a in t)o+=",",o+=a,o+="=self.",o+=a;var u=r.createElement("script");u.appendChild(r.createTextNode('function $hook(self,console) {"use strict";\n        '+o+";return function() {return eval(arguments[0])}}")),r.body.appendChild(u),this.exec=i.$hook(t,console)}(n.self=n,document.documentElement);return i.exec((e&&e.transpile||String)(t)),null})},n))},function(t,e){function n(t){t&&(t.setTargetAtTime||(t.setTargetAtTime=t.setTargetValueAtTime))}window,window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=window.webkitAudioContext,"function"!=typeof AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),"function"!=typeof AudioContext.prototype.createDelay&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),"function"!=typeof AudioContext.prototype.createScriptProcessor&&(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),"function"!=typeof AudioContext.prototype.createPeriodicWave&&(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return n(t.gain),t},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(t){var e=t?this.internal_createDelay(t):this.internal_createDelay();return n(e.delayTime),e},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var i=this.internal_createBufferSource();return i.start?(i.internal_start=i.start,i.start=function(t,e,n){void 0!==n?i.internal_start(t||0,e,n):i.internal_start(t||0,e||0)}):i.start=function(t,e,n){e||n?this.noteGrainOn(t||0,e,n):this.noteOn(t||0)},i.stop?(i.internal_stop=i.stop,i.stop=function(t){i.internal_stop(t||0)}):i.stop=function(t){this.noteOff(t||0)},n(i.playbackRate),i},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return n(t.threshold),n(t.knee),n(t.ratio),n(t.reduction),n(t.attack),n(t.release),t},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();return n(t.frequency),n(t.detune),n(t.Q),n(t.gain),t},"function"!=typeof AudioContext.prototype.createOscillator&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var e=this.internal_createOscillator();return e.start?(e.internal_start=e.start,e.start=function(t){e.internal_start(t||0)}):e.start=function(t){this.noteOn(t||0)},e.stop?(e.internal_stop=e.stop,e.stop=function(t){e.internal_stop(t||0)}):e.stop=function(t){this.noteOff(t||0)},e.setPeriodicWave||(e.setPeriodicWave=e.setWaveTable),n(e.frequency),n(e.detune),e})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=window.webkitOfflineAudioContext),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var i=document.createElement("audio");p5.prototype.isSupported=function(){return!!i.canPlayType};p5.prototype.isFileSupported=function(t){switch(t.toLowerCase()){case"mp3":return!!i.canPlayType&&i.canPlayType("audio/mpeg;");case"wav":return!!i.canPlayType&&i.canPlayType('audio/wav; codecs="1"');case"ogg":return!!i.canPlayType&&i.canPlayType('audio/ogg; codecs="vorbis"');case"aac":case"m4a":case"mp4":return!!i.canPlayType&&(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/aac;"));case"aif":case"aiff":return!!i.canPlayType&&i.canPlayType("audio/x-aiff;");default:return!1}}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e),e.default='function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// import dependencies via preval.require so that they\'re available as values at compile time\nvar processorNames = {\n  "recorderProcessor": "recorder-processor",\n  "soundFileProcessor": "sound-file-processor",\n  "amplitudeProcessor": "amplitude-processor"\n};\nvar RingBuffer = {\n  "default":\n  /*#__PURE__*/\n  function () {\n    /**\n     * @constructor\n     * @param  {number} length Buffer length in frames.\n     * @param  {number} channelCount Buffer channel count.\n     */\n    function RingBuffer(length, channelCount) {\n      _classCallCheck(this, RingBuffer);\n\n      this._readIndex = 0;\n      this._writeIndex = 0;\n      this._framesAvailable = 0;\n      this._channelCount = channelCount;\n      this._length = length;\n      this._channelData = [];\n\n      for (var i = 0; i < this._channelCount; ++i) {\n        this._channelData[i] = new Float32Array(length);\n      }\n    }\n    /**\n     * Getter for Available frames in buffer.\n     *\n     * @return {number} Available frames in buffer.\n     */\n\n\n    _createClass(RingBuffer, [{\n      key: "push",\n\n      /**\n       * Push a sequence of Float32Arrays to buffer.\n       *\n       * @param  {array} arraySequence A sequence of Float32Arrays.\n       */\n      value: function push(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // Transfer data from the |arraySequence| storage to the internal buffer.\n        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;\n\n        for (var i = 0; i < sourceLength; ++i) {\n          var writeIndex = (this._writeIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            this._channelData[channel][writeIndex] = arraySequence[channel][i];\n          }\n        }\n\n        this._writeIndex += sourceLength;\n\n        if (this._writeIndex >= this._length) {\n          this._writeIndex = 0;\n        } // For excessive frames, the buffer will be overwritten.\n\n\n        this._framesAvailable += sourceLength;\n\n        if (this._framesAvailable > this._length) {\n          this._framesAvailable = this._length;\n        }\n      }\n      /**\n       * Pull data out of buffer and fill a given sequence of Float32Arrays.\n       *\n       * @param  {array} arraySequence An array of Float32Arrays.\n       */\n\n    }, {\n      key: "pull",\n      value: function pull(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // If the FIFO is completely empty, do nothing.\n        if (this._framesAvailable === 0) {\n          return;\n        }\n\n        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.\n\n        for (var i = 0; i < destinationLength; ++i) {\n          var readIndex = (this._readIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            arraySequence[channel][i] = this._channelData[channel][readIndex];\n          }\n        }\n\n        this._readIndex += destinationLength;\n\n        if (this._readIndex >= this._length) {\n          this._readIndex = 0;\n        }\n\n        this._framesAvailable -= destinationLength;\n\n        if (this._framesAvailable < 0) {\n          this._framesAvailable = 0;\n        }\n      }\n    }, {\n      key: "framesAvailable",\n      get: function get() {\n        return this._framesAvailable;\n      }\n    }]);\n\n    return RingBuffer;\n  }()\n}["default"];\n\nvar RecorderProcessor =\n/*#__PURE__*/\nfunction (_AudioWorkletProcesso) {\n  _inherits(RecorderProcessor, _AudioWorkletProcesso);\n\n  function RecorderProcessor(options) {\n    var _this;\n\n    _classCallCheck(this, RecorderProcessor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RecorderProcessor).call(this));\n    var processorOptions = options.processorOptions || {};\n    _this.numOutputChannels = options.outputChannelCount || 2;\n    _this.numInputChannels = processorOptions.numInputChannels || 2;\n    _this.bufferSize = processorOptions.bufferSize || 1024;\n    _this.recording = false;\n\n    _this.clear();\n\n    _this.port.onmessage = function (event) {\n      var data = event.data;\n\n      if (data.name === \'start\') {\n        _this.record(data.duration);\n      } else if (data.name === \'stop\') {\n        _this.stop();\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(RecorderProcessor, [{\n    key: "process",\n    value: function process(inputs) {\n      if (!this.recording) {\n        return true;\n      } else if (this.sampleLimit && this.recordedSamples >= this.sampleLimit) {\n        this.stop();\n        return true;\n      }\n\n      var input = inputs[0];\n      this.inputRingBuffer.push(input);\n\n      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {\n        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);\n\n        for (var channel = 0; channel < this.numOutputChannels; ++channel) {\n          var inputChannelCopy = this.inputRingBufferArraySequence[channel].slice();\n\n          if (channel === 0) {\n            this.leftBuffers.push(inputChannelCopy);\n\n            if (this.numInputChannels === 1) {\n              this.rightBuffers.push(inputChannelCopy);\n            }\n          } else if (channel === 1 && this.numInputChannels > 1) {\n            this.rightBuffers.push(inputChannelCopy);\n          }\n        }\n\n        this.recordedSamples += this.bufferSize;\n      }\n\n      return true;\n    }\n  }, {\n    key: "record",\n    value: function record(duration) {\n      if (duration) {\n        this.sampleLimit = Math.round(duration * sampleRate);\n      }\n\n      this.recording = true;\n    }\n  }, {\n    key: "stop",\n    value: function stop() {\n      this.recording = false;\n      var buffers = this.getBuffers();\n      var leftBuffer = buffers[0].buffer;\n      var rightBuffer = buffers[1].buffer;\n      this.port.postMessage({\n        name: \'buffers\',\n        leftBuffer: leftBuffer,\n        rightBuffer: rightBuffer\n      }, [leftBuffer, rightBuffer]);\n      this.clear();\n    }\n  }, {\n    key: "getBuffers",\n    value: function getBuffers() {\n      var buffers = [];\n      buffers.push(this.mergeBuffers(this.leftBuffers));\n      buffers.push(this.mergeBuffers(this.rightBuffers));\n      return buffers;\n    }\n  }, {\n    key: "mergeBuffers",\n    value: function mergeBuffers(channelBuffer) {\n      var result = new Float32Array(this.recordedSamples);\n      var offset = 0;\n      var lng = channelBuffer.length;\n\n      for (var i = 0; i < lng; i++) {\n        var buffer = channelBuffer[i];\n        result.set(buffer, offset);\n        offset += buffer.length;\n      }\n\n      return result;\n    }\n  }, {\n    key: "clear",\n    value: function clear() {\n      var _this2 = this;\n\n      this.leftBuffers = [];\n      this.rightBuffers = [];\n      this.inputRingBuffer = new RingBuffer(this.bufferSize, this.numInputChannels);\n      this.inputRingBufferArraySequence = new Array(this.numInputChannels).fill(null).map(function () {\n        return new Float32Array(_this2.bufferSize);\n      });\n      this.recordedSamples = 0;\n      this.sampleLimit = null;\n    }\n  }]);\n\n  return RecorderProcessor;\n}(_wrapNativeSuper(AudioWorkletProcessor));\n\nregisterProcessor(processorNames.recorderProcessor, RecorderProcessor);'},function(t,e,n){"use strict";n.r(e),e.default='function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// import dependencies via preval.require so that they\'re available as values at compile time\nvar processorNames = {\n  "recorderProcessor": "recorder-processor",\n  "soundFileProcessor": "sound-file-processor",\n  "amplitudeProcessor": "amplitude-processor"\n};\nvar RingBuffer = {\n  "default":\n  /*#__PURE__*/\n  function () {\n    /**\n     * @constructor\n     * @param  {number} length Buffer length in frames.\n     * @param  {number} channelCount Buffer channel count.\n     */\n    function RingBuffer(length, channelCount) {\n      _classCallCheck(this, RingBuffer);\n\n      this._readIndex = 0;\n      this._writeIndex = 0;\n      this._framesAvailable = 0;\n      this._channelCount = channelCount;\n      this._length = length;\n      this._channelData = [];\n\n      for (var i = 0; i < this._channelCount; ++i) {\n        this._channelData[i] = new Float32Array(length);\n      }\n    }\n    /**\n     * Getter for Available frames in buffer.\n     *\n     * @return {number} Available frames in buffer.\n     */\n\n\n    _createClass(RingBuffer, [{\n      key: "push",\n\n      /**\n       * Push a sequence of Float32Arrays to buffer.\n       *\n       * @param  {array} arraySequence A sequence of Float32Arrays.\n       */\n      value: function push(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // Transfer data from the |arraySequence| storage to the internal buffer.\n        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;\n\n        for (var i = 0; i < sourceLength; ++i) {\n          var writeIndex = (this._writeIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            this._channelData[channel][writeIndex] = arraySequence[channel][i];\n          }\n        }\n\n        this._writeIndex += sourceLength;\n\n        if (this._writeIndex >= this._length) {\n          this._writeIndex = 0;\n        } // For excessive frames, the buffer will be overwritten.\n\n\n        this._framesAvailable += sourceLength;\n\n        if (this._framesAvailable > this._length) {\n          this._framesAvailable = this._length;\n        }\n      }\n      /**\n       * Pull data out of buffer and fill a given sequence of Float32Arrays.\n       *\n       * @param  {array} arraySequence An array of Float32Arrays.\n       */\n\n    }, {\n      key: "pull",\n      value: function pull(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // If the FIFO is completely empty, do nothing.\n        if (this._framesAvailable === 0) {\n          return;\n        }\n\n        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.\n\n        for (var i = 0; i < destinationLength; ++i) {\n          var readIndex = (this._readIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            arraySequence[channel][i] = this._channelData[channel][readIndex];\n          }\n        }\n\n        this._readIndex += destinationLength;\n\n        if (this._readIndex >= this._length) {\n          this._readIndex = 0;\n        }\n\n        this._framesAvailable -= destinationLength;\n\n        if (this._framesAvailable < 0) {\n          this._framesAvailable = 0;\n        }\n      }\n    }, {\n      key: "framesAvailable",\n      get: function get() {\n        return this._framesAvailable;\n      }\n    }]);\n\n    return RingBuffer;\n  }()\n}["default"];\n\nvar SoundFileProcessor =\n/*#__PURE__*/\nfunction (_AudioWorkletProcesso) {\n  _inherits(SoundFileProcessor, _AudioWorkletProcesso);\n\n  function SoundFileProcessor(options) {\n    var _this;\n\n    _classCallCheck(this, SoundFileProcessor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SoundFileProcessor).call(this));\n    var processorOptions = options.processorOptions || {};\n    _this.bufferSize = processorOptions.bufferSize || 256;\n    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, 1);\n    _this.inputRingBufferArraySequence = [new Float32Array(_this.bufferSize)];\n    return _this;\n  }\n\n  _createClass(SoundFileProcessor, [{\n    key: "process",\n    value: function process(inputs) {\n      var input = inputs[0]; // we only care about the first input channel, because that contains the position data\n\n      this.inputRingBuffer.push([input[0]]);\n\n      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {\n        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);\n        var inputChannel = this.inputRingBufferArraySequence[0];\n        var position = inputChannel[inputChannel.length - 1] || 0;\n        this.port.postMessage({\n          name: \'position\',\n          position: position\n        });\n      }\n\n      return true;\n    }\n  }]);\n\n  return SoundFileProcessor;\n}(_wrapNativeSuper(AudioWorkletProcessor));\n\nregisterProcessor(processorNames.soundFileProcessor, SoundFileProcessor);'},function(t,e,n){"use strict";n.r(e),e.default='function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _wrapNativeSuper(Class) { var _cache = typeof Map === "function" ? new Map() : undefined; _wrapNativeSuper = function _wrapNativeSuper(Class) { if (Class === null || !_isNativeFunction(Class)) return Class; if (typeof Class !== "function") { throw new TypeError("Super expression must either be null or a function"); } if (typeof _cache !== "undefined") { if (_cache.has(Class)) return _cache.get(Class); _cache.set(Class, Wrapper); } function Wrapper() { return _construct(Class, arguments, _getPrototypeOf(this).constructor); } Wrapper.prototype = Object.create(Class.prototype, { constructor: { value: Wrapper, enumerable: false, writable: true, configurable: true } }); return _setPrototypeOf(Wrapper, Class); }; return _wrapNativeSuper(Class); }\n\nfunction isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _construct(Parent, args, Class) { if (isNativeReflectConstruct()) { _construct = Reflect.construct; } else { _construct = function _construct(Parent, args, Class) { var a = [null]; a.push.apply(a, args); var Constructor = Function.bind.apply(Parent, a); var instance = new Constructor(); if (Class) _setPrototypeOf(instance, Class.prototype); return instance; }; } return _construct.apply(null, arguments); }\n\nfunction _isNativeFunction(fn) { return Function.toString.call(fn).indexOf("[native code]") !== -1; }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n// import dependencies via preval.require so that they\'re available as values at compile time\nvar processorNames = {\n  "recorderProcessor": "recorder-processor",\n  "soundFileProcessor": "sound-file-processor",\n  "amplitudeProcessor": "amplitude-processor"\n};\nvar RingBuffer = {\n  "default":\n  /*#__PURE__*/\n  function () {\n    /**\n     * @constructor\n     * @param  {number} length Buffer length in frames.\n     * @param  {number} channelCount Buffer channel count.\n     */\n    function RingBuffer(length, channelCount) {\n      _classCallCheck(this, RingBuffer);\n\n      this._readIndex = 0;\n      this._writeIndex = 0;\n      this._framesAvailable = 0;\n      this._channelCount = channelCount;\n      this._length = length;\n      this._channelData = [];\n\n      for (var i = 0; i < this._channelCount; ++i) {\n        this._channelData[i] = new Float32Array(length);\n      }\n    }\n    /**\n     * Getter for Available frames in buffer.\n     *\n     * @return {number} Available frames in buffer.\n     */\n\n\n    _createClass(RingBuffer, [{\n      key: "push",\n\n      /**\n       * Push a sequence of Float32Arrays to buffer.\n       *\n       * @param  {array} arraySequence A sequence of Float32Arrays.\n       */\n      value: function push(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // Transfer data from the |arraySequence| storage to the internal buffer.\n        var sourceLength = arraySequence[0] ? arraySequence[0].length : 0;\n\n        for (var i = 0; i < sourceLength; ++i) {\n          var writeIndex = (this._writeIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            this._channelData[channel][writeIndex] = arraySequence[channel][i];\n          }\n        }\n\n        this._writeIndex += sourceLength;\n\n        if (this._writeIndex >= this._length) {\n          this._writeIndex = 0;\n        } // For excessive frames, the buffer will be overwritten.\n\n\n        this._framesAvailable += sourceLength;\n\n        if (this._framesAvailable > this._length) {\n          this._framesAvailable = this._length;\n        }\n      }\n      /**\n       * Pull data out of buffer and fill a given sequence of Float32Arrays.\n       *\n       * @param  {array} arraySequence An array of Float32Arrays.\n       */\n\n    }, {\n      key: "pull",\n      value: function pull(arraySequence) {\n        // The channel count of arraySequence and the length of each channel must\n        // match with this buffer obejct.\n        // If the FIFO is completely empty, do nothing.\n        if (this._framesAvailable === 0) {\n          return;\n        }\n\n        var destinationLength = arraySequence[0].length; // Transfer data from the internal buffer to the |arraySequence| storage.\n\n        for (var i = 0; i < destinationLength; ++i) {\n          var readIndex = (this._readIndex + i) % this._length;\n\n          for (var channel = 0; channel < this._channelCount; ++channel) {\n            arraySequence[channel][i] = this._channelData[channel][readIndex];\n          }\n        }\n\n        this._readIndex += destinationLength;\n\n        if (this._readIndex >= this._length) {\n          this._readIndex = 0;\n        }\n\n        this._framesAvailable -= destinationLength;\n\n        if (this._framesAvailable < 0) {\n          this._framesAvailable = 0;\n        }\n      }\n    }, {\n      key: "framesAvailable",\n      get: function get() {\n        return this._framesAvailable;\n      }\n    }]);\n\n    return RingBuffer;\n  }()\n}["default"];\n\nvar AmplitudeProcessor =\n/*#__PURE__*/\nfunction (_AudioWorkletProcesso) {\n  _inherits(AmplitudeProcessor, _AudioWorkletProcesso);\n\n  function AmplitudeProcessor(options) {\n    var _this;\n\n    _classCallCheck(this, AmplitudeProcessor);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AmplitudeProcessor).call(this));\n    var processorOptions = options.processorOptions || {};\n    _this.numOutputChannels = options.outputChannelCount || 1;\n    _this.numInputChannels = processorOptions.numInputChannels || 2;\n    _this.normalize = processorOptions.normalize || false;\n    _this.smoothing = processorOptions.smoothing || 0;\n    _this.bufferSize = processorOptions.bufferSize || 2048;\n    _this.inputRingBuffer = new RingBuffer(_this.bufferSize, _this.numInputChannels);\n    _this.outputRingBuffer = new RingBuffer(_this.bufferSize, _this.numOutputChannels);\n    _this.inputRingBufferArraySequence = new Array(_this.numInputChannels).fill(null).map(function () {\n      return new Float32Array(_this.bufferSize);\n    });\n    _this.stereoVol = [0, 0];\n    _this.stereoVolNorm = [0, 0];\n    _this.volMax = 0.001;\n\n    _this.port.onmessage = function (event) {\n      var data = event.data;\n\n      if (data.name === \'toggleNormalize\') {\n        _this.normalize = data.normalize;\n      } else if (data.name === \'smoothing\') {\n        _this.smoothing = Math.max(0, Math.min(1, data.smoothing));\n      }\n    };\n\n    return _this;\n  } // TO DO make this stereo / dependent on # of audio channels\n\n\n  _createClass(AmplitudeProcessor, [{\n    key: "process",\n    value: function process(inputs, outputs) {\n      var input = inputs[0];\n      var output = outputs[0];\n      var smoothing = this.smoothing;\n      this.inputRingBuffer.push(input);\n\n      if (this.inputRingBuffer.framesAvailable >= this.bufferSize) {\n        this.inputRingBuffer.pull(this.inputRingBufferArraySequence);\n\n        for (var channel = 0; channel < this.numInputChannels; ++channel) {\n          var inputBuffer = this.inputRingBufferArraySequence[channel];\n          var bufLength = inputBuffer.length;\n          var sum = 0;\n\n          for (var i = 0; i < bufLength; i++) {\n            var x = inputBuffer[i];\n\n            if (this.normalize) {\n              sum += Math.max(Math.min(x / this.volMax, 1), -1) * Math.max(Math.min(x / this.volMax, 1), -1);\n            } else {\n              sum += x * x;\n            }\n          } // ... then take the square root of the sum.\n\n\n          var rms = Math.sqrt(sum / bufLength);\n          this.stereoVol[channel] = Math.max(rms, this.stereoVol[channel] * smoothing);\n          this.volMax = Math.max(this.stereoVol[channel], this.volMax);\n        } // calculate stero normalized volume and add volume from all channels together\n\n\n        var volSum = 0;\n\n        for (var index = 0; index < this.stereoVol.length; index++) {\n          this.stereoVolNorm[index] = Math.max(Math.min(this.stereoVol[index] / this.volMax, 1), 0);\n          volSum += this.stereoVol[index];\n        } // volume is average of channels\n\n\n        var volume = volSum / this.stereoVol.length; // normalized value\n\n        var volNorm = Math.max(Math.min(volume / this.volMax, 1), 0);\n        this.port.postMessage({\n          name: \'amplitude\',\n          volume: volume,\n          volNorm: volNorm,\n          stereoVol: this.stereoVol,\n          stereoVolNorm: this.stereoVolNorm\n        }); // pass input through to output\n\n        this.outputRingBuffer.push(this.inputRingBufferArraySequence);\n      } // pull 128 frames out of the ring buffer\n      // if the ring buffer does not have enough frames, the output will be silent\n\n\n      this.outputRingBuffer.pull(output);\n      return true;\n    }\n  }]);\n\n  return AmplitudeProcessor;\n}(_wrapNativeSuper(AudioWorkletProcessor));\n\nregisterProcessor(processorNames.amplitudeProcessor, AmplitudeProcessor);'},function(t,e,n){var i,r;i=[n(0),n(17)],void 0===(r=function(r){r.Frequency=function(t,e){if(!(this instanceof r.Frequency))return new r.Frequency(t,e);r.TimeBase.call(this,t,e)},r.extend(r.Frequency,r.TimeBase),r.Frequency.prototype._primaryExpressions=Object.create(r.TimeBase.prototype._primaryExpressions),r.Frequency.prototype._primaryExpressions.midi={regexp:/^(\d+(?:\.\d+)?midi)/,method:function(t){return this.midiToFrequency(t)}},r.Frequency.prototype._primaryExpressions.note={regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(t,e){var n=i[t.toLowerCase()]+12*(parseInt(e)+1);return this.midiToFrequency(n)}},r.Frequency.prototype._primaryExpressions.tr={regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,n){var i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._timeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}},r.Frequency.prototype.transpose=function(t){return this._expr=function(t,e){return t()*this.intervalToFrequencyRatio(e)}.bind(this,this._expr,t),this},r.Frequency.prototype.harmonize=function(t){return this._expr=function(t,e){for(var n=t(),i=[],r=0;r<e.length;r++)i[r]=n*this.intervalToFrequencyRatio(e[r]);return i}.bind(this,this._expr,t),this},r.Frequency.prototype.toMidi=function(){return this.frequencyToMidi(this.valueOf())},r.Frequency.prototype.toNote=function(){var t=this.valueOf(),e=Math.log(t/r.Frequency.A4)/Math.LN2,n=Math.round(12*e)+57,i=Math.floor(n/12);return i<0&&(n+=-12*i),o[n%12]+i.toString()},r.Frequency.prototype.toSeconds=function(){return 1/this.valueOf()},r.Frequency.prototype.toFrequency=function(){return this.valueOf()},r.Frequency.prototype.toTicks=function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*r.Transport.PPQ)},r.Frequency.prototype._frequencyToUnits=function(t){return t},r.Frequency.prototype._ticksToUnits=function(t){return 1/(60*t/(r.Transport.bpm.value*r.Transport.PPQ))},r.Frequency.prototype._beatsToUnits=function(t){return 1/r.TimeBase.prototype._beatsToUnits.call(this,t)},r.Frequency.prototype._secondsToUnits=function(t){return 1/t},r.Frequency.prototype._defaultUnits="hz";var i={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return r.Frequency.A4=440,r.Frequency.prototype.midiToFrequency=function(t){return r.Frequency.A4*Math.pow(2,(t-69)/12)},r.Frequency.prototype.frequencyToMidi=function(t){return 69+12*Math.log(t/r.Frequency.A4)/Math.LN2},r.Frequency}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(16)],void 0===(r=function(i){return i.TransportTime=function(t,e){if(!(this instanceof i.TransportTime))return new i.TransportTime(t,e);i.Time.call(this,t,e)},i.extend(i.TransportTime,i.Time),i.TransportTime.prototype._unaryExpressions=Object.create(i.Time.prototype._unaryExpressions),i.TransportTime.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(t){var e=this._secondsToTicks(t()),n=Math.ceil(i.Transport.ticks/e);return this._ticksToUnits(n*e)}},i.TransportTime.prototype._secondsToTicks=function(t){var e=t/this._beatsToUnits(1);return Math.round(e*i.Transport.PPQ)},i.TransportTime.prototype.valueOf=function(){return this._secondsToTicks(this._expr())+(this._plusNow?i.Transport.ticks:0)},i.TransportTime.prototype.toTicks=function(){return this.valueOf()},i.TransportTime.prototype.toSeconds=function(){return this._expr()+(this._plusNow?i.Transport.seconds:0)},i.TransportTime.prototype.toFrequency=function(){return 1/this.toSeconds()},i.TransportTime}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(4),n(13),n(1),n(33),n(21),n(34),n(20),n(35),n(36),n(37)],void 0===(r=function(u){"use strict";function n(t,e,n){var i=new t;return n._eval(e[0]).connect(i,0,0),n._eval(e[1]).connect(i,0,1),i}function i(t,e,n){var i=new t;return n._eval(e[0]).connect(i,0,0),i}function r(t){return t?parseFloat(t):void 0}function o(t){return t&&t.args?parseFloat(t.args):void 0}return u.Expr=function(){var t=this._replacements(Array.prototype.slice.call(arguments)),e=this._parseInputs(t);this._nodes=[],this.input=new Array(e);for(var n=0;n<e;n++)this.input[n]=this.context.createGain();var i,r=this._parseTree(t);try{i=this._eval(r)}catch(e){throw this._disposeNodes(),new Error("Tone.Expr: Could evaluate expression: "+t)}this.output=i},u.extend(u.Expr,u.SignalBase),u.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(t){return new u.Signal(r(t))}},input:{regexp:/^\$\d/,method:function(t,e){return e.input[r(t.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:i.bind(this,u.Abs)},mod:{regexp:/^mod/,method:function(t,e){var n=o(t[1]),i=new u.Modulo(n);return e._eval(t[0]).connect(i),i}},pow:{regexp:/^pow/,method:function(t,e){var n=o(t[1]),i=new u.Pow(n);return e._eval(t[0]).connect(i),i}},a2g:{regexp:/^a2g/,method:function(t,e){var n=new u.AudioToGain;return e._eval(t[0]).connect(n),n}}},binary:{"+":{regexp:/^\+/,precedence:1,method:n.bind(this,u.Add)},"-":{regexp:/^\-/,precedence:1,method:function(t,e){return 1===t.length?i(u.Negate,t,e):n(u.Subtract,t,e)}},"*":{regexp:/^\*/,precedence:0,method:n.bind(this,u.Multiply)}},unary:{"-":{regexp:/^\-/,method:i.bind(this,u.Negate)},"!":{regexp:/^\!/,method:i.bind(this,u.NOT)}}},u.Expr.prototype._parseInputs=function(t){var e=t.match(/\$\d/g),n=0;if(null!==e)for(var i=0;i<e.length;i++){var r=parseInt(e[i].substr(1))+1;n=Math.max(n,r)}return n},u.Expr.prototype._replacements=function(t){for(var e=t.shift(),n=0;n<t.length;n++)e=e.replace(/\%/i,t[n]);return e},u.Expr.prototype._tokenize=function(t){for(var e=-1,n=[];0<t.length;){var i=r(t=t.trim());n.push(i),t=t.substr(i.value.length)}function r(t){for(var e in u.Expr._Expressions){var n=u.Expr._Expressions[e];for(var i in n){var r=n[i],o=r.regexp,s=t.match(o);if(null!==s)return{type:e,value:s[0],method:r.method}}}throw new SyntaxError("Tone.Expr: Unexpected token "+t)}return{next:function(){return n[++e]},peek:function(){return n[e+1]}}},u.Expr.prototype._parseTree=function(t){var i=this._tokenize(t),s=this.isUndef.bind(this);function r(t,e){return!s(t)&&"glue"===t.type&&t.value===e}function o(t,e,n){var i=u.Expr._Expressions[e];if(!s(t))for(var r in i){var o=i[r];if(o.regexp.test(t.value)){if(s(n))return!0;if(o.precedence===n)return!0}}return!1}function a(t){var e;s(t)&&(t=5),e=t<0?function t(){var e,n;return o(e=i.peek(),"unary")?(e=i.next(),n=t(),{operator:e.value,method:e.method,args:[n]}):function(){var t,e;if(t=i.peek(),s(t))throw new SyntaxError("Tone.Expr: Unexpected termination of expression");if("func"===t.type)return function(t){var e=[];if(!r(i.next(),"("))throw new SyntaxError('Tone.Expr: Expected ( in a function call "'+t.value+'"');if(r(i.peek(),")")||(e=function(){for(var t,e=[];t=a(),!s(t)&&(e.push(t),r(i.peek(),","));)i.next();return e}()),r(i.next(),")"))return{method:t.method,args:e,name:name};throw new SyntaxError('Tone.Expr: Expected ) in a function call "'+t.value+'"')}(t=i.next());if("value"===t.type)return{method:(t=i.next()).method,args:t.value};if(r(t,"(")){if(i.next(),e=a(),!r(t=i.next(),")"))throw new SyntaxError("Expected )");return e}throw new SyntaxError("Tone.Expr: Parse error, cannot process token "+t.value)}()}():a(t-1);for(var n=i.peek();o(n,"binary",t);)e={operator:(n=i.next()).value,method:n.method,args:[e,a(t-1)]},n=i.peek();return e}return a()},u.Expr.prototype._eval=function(t){if(!this.isUndef(t)){var e=t.method(t.args,this);return this._nodes.push(e),e}},u.Expr.prototype._disposeNodes=function(){for(var t=0;t<this._nodes.length;t++){var e=this._nodes[t];this.isFunction(e.dispose)?e.dispose():this.isFunction(e.disconnect)&&e.disconnect(),e=null,this._nodes[t]=null}this._nodes=null},u.Expr.prototype.dispose=function(){u.prototype.dispose.call(this),this._disposeNodes()},u.Expr}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(21),n(13),n(2)],void 0===(r=function(e){"use strict";return e.GreaterThan=function(t){this.createInsOuts(2,0),this._param=this.input[0]=new e.Subtract(t),this.input[1]=this._param.input[1],this._gtz=this.output=new e.GreaterThanZero,this._param.connect(this._gtz)},e.extend(e.GreaterThan,e.Signal),e.GreaterThan.prototype.dispose=function(){return e.prototype.dispose.call(this),this._param.dispose(),this._param=null,this._gtz.dispose(),this._gtz=null,this},e.GreaterThan}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(6),n(15)],void 0===(r=function(t){"use strict";return t.Abs=function(){this._abs=this.input=this.output=new t.WaveShaper(function(t){return 0===t?0:Math.abs(t)},127)},t.extend(t.Abs,t.SignalBase),t.Abs.prototype.dispose=function(){return t.prototype.dispose.call(this),this._abs.dispose(),this._abs=null,this},t.Abs}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(6),n(1),n(13)],void 0===(r=function(e){"use strict";return e.Modulo=function(t){this.createInsOuts(1,0),this._shaper=new e.WaveShaper(Math.pow(2,16)),this._multiply=new e.Multiply,this._subtract=this.output=new e.Subtract,this._modSignal=new e.Signal(t),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(t)},e.extend(e.Modulo,e.SignalBase),e.Modulo.prototype._setWaveShaper=function(e){this._shaper.setMap(function(t){return Math.floor((t+1e-4)/e)})},Object.defineProperty(e.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(t){this._modSignal.value=t,this._setWaveShaper(t)}}),e.Modulo.prototype.dispose=function(){return e.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},e.Modulo}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(6)],void 0===(r=function(e){"use strict";return e.Pow=function(t){this._exp=this.defaultArg(t,1),this._expScaler=this.input=this.output=new e.WaveShaper(this._expFunc(this._exp),8192)},e.extend(e.Pow,e.SignalBase),Object.defineProperty(e.Pow.prototype,"value",{get:function(){return this._exp},set:function(t){this._exp=t,this._expScaler.setMap(this._expFunc(this._exp))}}),e.Pow.prototype._expFunc=function(e){return function(t){return Math.pow(Math.abs(t),e)}},e.Pow.prototype.dispose=function(){return e.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},e.Pow}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(6),n(2)],void 0===(r=function(t){"use strict";return t.AudioToGain=function(){this._norm=this.input=this.output=new t.WaveShaper(function(t){return(t+1)/2})},t.extend(t.AudioToGain,t.SignalBase),t.AudioToGain.prototype.dispose=function(){return t.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},t.AudioToGain}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(6)],void 0===(r=function(t){"use strict";return t.EqualPowerGain=function(){this._eqPower=this.input=this.output=new t.WaveShaper(function(t){return Math.abs(t)<.001?0:this.equalPowerScale(t)}.bind(this),4096)},t.extend(t.EqualPowerGain,t.SignalBase),t.EqualPowerGain.prototype.dispose=function(){return t.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},t.EqualPowerGain}.apply(e,i))||(t.exports=r)},function(t,e,n){var i,r;i=[n(0),n(19),n(9)],void 0===(r=function(e){"use strict";return e.TimelineState=function(t){e.Timeline.call(this),this._initial=t},e.extend(e.TimelineState,e.Timeline),e.TimelineState.prototype.getValueAtTime=function(t){var e=this.get(t);return null!==e?e.state:this._initial},e.TimelineState.prototype.setStateAtTime=function(t,e){this.add({state:t,time:e})},e.TimelineState}.apply(e,i))||(t.exports=r)},function(t,e,n){"use strict";n.r(e);n(24),n(25);var c=n(3);var o=new function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.input=c.a.createGain(),this.output=c.a.createGain(),this.limiter=c.a.createDynamicsCompressor(),this.limiter.threshold.value=-3,this.limiter.ratio.value=20,this.limiter.knee.value=1,this.audiocontext=c.a,this.output.disconnect(),this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=c.a.createGain(),this.fftMeter=c.a.createGain(),this.output.connect(this.meter),this.output.connect(this.fftMeter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.parts=[],this.extensions=[]};p5.prototype.getOutputVolume=function(){return o.output.gain.value},p5.prototype.outputVolume=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if("number"==typeof t){var i=o.audiocontext.currentTime,r=o.output.gain.value;o.output.gain.cancelScheduledValues(i+n),o.output.gain.linearRampToValueAtTime(r,i+n),o.output.gain.linearRampToValueAtTime(t,i+n+e)}else{if(!t)return o.output.gain;t.connect(o.output.gain)}},p5.prototype.soundOut=p5.soundOut=o,p5.soundOut._silentNode=o.audiocontext.createGain(),p5.soundOut._silentNode.gain.value=0,p5.soundOut._silentNode.connect(o.audiocontext.destination);var p=o,i=n(5),s=n.n(i);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){var e=Math.log(t/440)/Math.log(2);return Math.round(12*e)+69}function r(t){return 440*Math.pow(2,(t-69)/12)}function h(t){if("string"!=typeof t)return t;var e={A:21,B:23,C:24,D:26,E:28,F:29,G:31}[t[0].toUpperCase()];switch(e+=12*(~~t.slice(-1)-1),t[1]){case"#":e+=1;break;case"b":e-=1}return r(e)}function a(t){var e,n=u(e=t.getChannelData(0),1<t.numberOfChannels?t.getChannelData(1):e),i=new window.ArrayBuffer(44+2*n.length),r=new window.DataView(i);d(r,0,"RIFF"),r.setUint32(4,36+2*n.length,!0),d(r,8,"WAVE"),d(r,12,"fmt "),r.setUint32(16,16,!0),r.setUint16(20,1,!0),r.setUint16(22,2,!0),r.setUint32(24,p.audiocontext.sampleRate,!0),r.setUint32(28,4*p.audiocontext.sampleRate,!0),r.setUint16(32,4,!0),r.setUint16(34,16,!0),d(r,36,"data"),r.setUint32(40,2*n.length,!0);for(var o=n.length,s=44,a=0;a<o;a++)r.setInt16(s,32767*n[a],!0),s+=2;return r}function u(t,e){for(var n=t.length+e.length,i=new Float32Array(n),r=0,o=0;o<n;)i[o++]=t[r],i[o++]=e[r],r++;return i}function d(t,e,n){for(var i=n.length,r=0;r<i;r++)t.setUint8(e+r,n.charCodeAt(r))}function y(t){var e=t,n=new AudioWorkletNode(p.audiocontext,s.a.soundFileProcessor);return n instanceof ScriptProcessorNode&&(e=n.bufferSize),n.disconnect(),n=null,e}var m=function(t,e,n){var i,r,o=new Error;return o.name=t,o.originalStack=o.stack+e,i=o.stack+e,o.failedPath=n,r=i.split("\n").filter(function(t){return!t.match(/(p5.|native code|globalInit)/g)}),o.stack=r.join("\n"),o},v=[n(27).default,n(28).default,n(29).default],_=p.audiocontext,g=!1;function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function w(t,e,n){return e&&T(t.prototype,e),n&&T(t,n),t}p5.prototype.registerMethod("init",function(){if(!g){this.preload||window.preload||(this.preload=function(){}),this._incrementPreload();var t=function(){g=!0,this._decrementPreload()}.bind(this);Promise.all(v.map(function(t){var e=new Blob([t],{type:"application/javascript"}),n=URL.createObjectURL(e);return _.audioWorklet.addModule(n)})).then(t)}});var x,S=p.audiocontext;void 0!==S.createStereoPanner?x=function(){function n(t,e){b(this,n),this.stereoPanner=this.input=S.createStereoPanner(),t.connect(this.stereoPanner),this.stereoPanner.connect(e)}return w(n,[{key:"pan",value:function(t,e){var n=e||0,i=S.currentTime+n;this.stereoPanner.pan.linearRampToValueAtTime(t,i)}},{key:"inputChannels",value:function(){}},{key:"connect",value:function(t){this.stereoPanner.connect(t)}},{key:"disconnect",value:function(){this.stereoPanner&&this.stereoPanner.disconnect()}}]),n}():x=function(){function i(t,e,n){b(this,i),this.input=S.createGain(),t.connect(this.input),this.left=S.createGain(),this.right=S.createGain(),this.left.channelInterpretation="discrete",this.right.channelInterpretation="discrete",1<n?(this.splitter=S.createChannelSplitter(2),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0)):(this.input.connect(this.left),this.input.connect(this.right)),this.output=S.createChannelMerger(2),this.left.connect(this.output,0,1),this.right.connect(this.output,0,0),this.output.connect(e)}return w(i,[{key:"pan",value:function(t,e){var n=e||0,i=S.currentTime+n,r=(t+1)/2,o=Math.cos(r*Math.PI/2),s=Math.sin(r*Math.PI/2);this.left.gain.linearRampToValueAtTime(s,i),this.right.gain.linearRampToValueAtTime(o,i)}},{key:"inputChannels",value:function(t){1===t?(this.input.disconnect(),this.input.connect(this.left),this.input.connect(this.right)):2===t&&(void 0===this.splitter&&(this.splitter=S.createChannelSplitter(2)),this.input.disconnect(),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0))}},{key:"connect",value:function(t){this.output.connect(t)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}}]),i}();var k=x;function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e,n,i){O(this,C),this.callback=t,this.time=e,this.id=n,this.val=i}var R=p.audiocontext;var q=function(){function o(t,e,n,i){if(O(this,o),void 0!==t){if("string"==typeof t||"string"==typeof t[0]){var r=p5.prototype._checkFileFormats(t);this.url=r}else if("object"===P(t)&&!(window.File&&window.FileReader&&window.FileList&&window.Blob))throw"Unable to load file because the File API is not supported";t.file&&(t=t.file),this.file=t}this._onended=function(){},this._looping=!1,this._playing=!1,this._paused=!1,this._pauseTime=0,this._cues=[],this._cueIDCounter=0,this._lastPos=0,this._counterNode=null,this._workletNode=null,this.bufferSourceNodes=[],this.bufferSourceNode=null,this.buffer=null,this.playbackRate=1,this.input=p.audiocontext.createGain(),this.output=p.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.pauseTime=0,this.mode="sustain",this.startMillis=null,this.panPosition=0,this.panner=new k(this.output,p.input,2),(this.url||this.file)&&this.load(e,n),p.soundArray.push(this),this._whileLoading="function"==typeof i?i:function(){},this._clearOnEnd=function(t){var e=t.target,n=this;e._playing=!1,e.removeEventListener("ended",n._clearOnEnd),n._onended(n),n.bufferSourceNodes.map(function(t,e){return e}).reverse().forEach(function(t){!1===n.bufferSourceNodes[t]._playing&&n.bufferSourceNodes.splice(t,1)}),0===n.bufferSourceNodes.length&&(n._playing=!1)}.bind(this),this.amp=this.setVolume,this.fade=this.setVolume}return function(t,e,n){e&&A(t.prototype,e),n&&A(t,n)}(o,[{key:"load",value:function(n,i){var r=this,o=(new Error).stack;if(void 0!==this.url&&""!==this.url){var s=new XMLHttpRequest;s.addEventListener("progress",function(t){r._updateProgress(t)},!1),s.open("GET",this.url,!0),s.responseType="arraybuffer",s.onload=function(){if(200===s.status){if(!r.panner)return;R.decodeAudioData(s.response,function(t){r.panner&&(r.buffer=t,r.panner.inputChannels(t.numberOfChannels),n&&n(r))},function(){if(r.panner){var t=new m("decodeAudioData",o,r.url),e="AudioContext error at decodeAudioData for "+r.url;i&&(t.msg=e,i(t))}})}else{if(!r.panner)return;var t=new m("loadSound",o,r.url),e="Unable to load "+r.url+". The request status was: "+s.status+" ("+s.statusText+")";i&&(t.message=e,i(t))}},s.onerror=function(){var t=new m("loadSound",o,r.url),e="There was no response from the server at "+r.url+". Check the url and internet connectivity.";i&&(t.message=e,i(t))},s.send()}else if(void 0!==this.file){var t=new FileReader;t.onload=function(){r.panner&&R.decodeAudioData(t.result,function(t){r.panner&&(r.buffer=t,r.panner.inputChannels(t.numberOfChannels),n&&n(r))})},t.onerror=function(t){r.panner&&onerror&&onerror(t)},t.readAsArrayBuffer(this.file)}}},{key:"_updateProgress",value:function(t){if(t.lengthComputable){var e=t.loaded/t.total*.99;this._whileLoading(e,t)}else this._whileLoading("size unknown")}},{key:"isLoaded",value:function(){return!!this.buffer}},{key:"play",value:function(t,e,n,i,r){if(this.output){var o,s,a=t||0;if(a<0&&(a=0),a+=p.audiocontext.currentTime,void 0!==e&&this.rate(e),void 0!==n&&this.setVolume(n),!this.buffer)throw"not ready to play file, buffer has yet to load. Try preload()";if(this._pauseTime=0,"restart"===this.mode&&this.buffer&&this.bufferSourceNode&&(this.bufferSourceNode.stop(a),this._counterNode.stop(a)),"untildone"!==this.mode||!this.isPlaying()){if(this.bufferSourceNode=this._initSourceNode(),delete this._counterNode,this._counterNode=this._initCounterNode(),i){if(!(0<=i&&i<this.buffer.duration))throw"start time out of range";o=i}else o=0;r=r&&(r<=this.buffer.duration-o?r:this.buffer.duration),this._paused?(this.bufferSourceNode.start(a,this.pauseTime,r),this._counterNode.start(a,this.pauseTime,r)):(this.bufferSourceNode.start(a,o,r),this._counterNode.start(a,o,r)),this._playing=!0,this._paused=!1,this.bufferSourceNodes.push(this.bufferSourceNode),this.bufferSourceNode._arrayIndex=this.bufferSourceNodes.length-1,this.bufferSourceNode.addEventListener("ended",this._clearOnEnd),this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping,!0===this._looping&&(s=r||o-1e-15,this.bufferSourceNode.loopStart=o,this.bufferSourceNode.loopEnd=s,this._counterNode.loopStart=o,this._counterNode.loopEnd=s)}}}},{key:"playMode",value:function(t){var e=t.toLowerCase();if("restart"===e&&this.buffer&&this.bufferSourceNode)for(var n=0;n<this.bufferSourceNodes.length-1;n++){var i=p.audiocontext.currentTime;this.bufferSourceNodes[n].stop(i)}if("restart"!==e&&"sustain"!==e&&"untildone"!==e)throw'Invalid play mode. Must be either "restart" or "sustain"';this.mode=e}},{key:"pause",value:function(t){var e=(t||0)+p.audiocontext.currentTime;this.isPlaying()&&this.buffer&&this.bufferSourceNode?(this._paused=!0,this._playing=!1,this.pauseTime=this.currentTime(),this.bufferSourceNode.stop(e),this._counterNode.stop(e),this._pauseTime=this.currentTime()):this._pauseTime=0}},{key:"loop",value:function(t,e,n,i,r){this._looping=!0,this.play(t,e,n,i,r)}},{key:"setLoop",value:function(t){if(!0===t)this._looping=!0;else{if(!1!==t)throw"Error: setLoop accepts either true or false";this._looping=!1}this.bufferSourceNode&&(this.bufferSourceNode.loop=this._looping,this._counterNode.loop=this._looping)}},{key:"isLooping",value:function(){return!!this.bufferSourceNode&&(!0===this._looping&&!0===this.isPlaying())}},{key:"isPlaying",value:function(){return this._playing}},{key:"isPaused",value:function(){return this._paused}},{key:"stop",value:function(t){var e=t||0;if("sustain"===this.mode||"untildone"===this.mode)this.stopAll(e),this._playing=!1,this.pauseTime=0,this._paused=!1;else if(this.buffer&&this.bufferSourceNode){var n=p.audiocontext.currentTime,i=e||0;this.pauseTime=0,this.bufferSourceNode.stop(n+i),this._counterNode.stop(n+i),this._playing=!1,this._paused=!1}}},{key:"stopAll",value:function(t){var e=p.audiocontext.currentTime,n=t||0;if(this.buffer&&this.bufferSourceNode){for(var i in this.bufferSourceNodes){var r=this.bufferSourceNodes[i];if(r)try{r.stop(e+n)}catch(t){}}this._counterNode.stop(e+n)}}},{key:"getVolume",value:function(){return this.output.gain.value}},{key:"pan",value:function(t,e){this.panPosition=t,this.panner.pan(t,e)}},{key:"getPan",value:function(){return this.panPosition}},{key:"rate",value:function(t){var e=!1;if(void 0===t)return this.playbackRate;if(0===(this.playbackRate=t)?t=1e-13:t<0&&!this.reversed?(t=Math.abs(t),e=!0):0<t&&this.reversed&&(e=!0),this.bufferSourceNode){var n=p.audiocontext.currentTime;this.bufferSourceNode.playbackRate.cancelScheduledValues(n),this.bufferSourceNode.playbackRate.linearRampToValueAtTime(Math.abs(t),n),this._counterNode.playbackRate.cancelScheduledValues(n),this._counterNode.playbackRate.linearRampToValueAtTime(Math.abs(t),n)}return e&&this.reverseBuffer(),this.playbackRate}},{key:"setPitch",value:function(t){var e=r(t)/r(60);this.rate(e)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setVolume",value:function(t,e,n){if("number"==typeof t){var i=e||0,r=n||0,o=p.audiocontext.currentTime,s=this.output.gain.value;this.output.gain.cancelScheduledValues(o+r),this.output.gain.linearRampToValueAtTime(s,o+r),this.output.gain.linearRampToValueAtTime(t,o+r+i)}else{if(!t)return this.output.gain;t.connect(this.output.gain)}}},{key:"duration",value:function(){return this.buffer?this.buffer.duration:0}},{key:"currentTime",value:function(){return this.reversed?Math.abs(this._lastPos-this.buffer.length)/R.sampleRate:this._lastPos/R.sampleRate}},{key:"jump",value:function(t,e){if(t<0||t>this.buffer.duration)throw"jump time out of range";if(e>this.buffer.duration-t)throw"end time out of range";var n=t||0,i=e||void 0;this.isPlaying()&&(this.stop(0),this.play(0,this.playbackRate,this.output.gain.value,n,i))}},{key:"channels",value:function(){return this.buffer.numberOfChannels}},{key:"sampleRate",value:function(){return this.buffer.sampleRate}},{key:"frames",value:function(){return this.buffer.length}},{key:"getPeaks",value:function(t){if(!this.buffer)throw"Cannot load peaks yet, buffer is not loaded";if(t=t||5*window.width,this.buffer){for(var e=this.buffer,n=e.length/t,i=~~(n/10)||1,r=e.numberOfChannels,o=new Float32Array(Math.round(t)),s=0;s<r;s++)for(var a=e.getChannelData(s),u=0;u<t;u++){for(var c=~~(u*n),l=~~(c+n),h=0,p=c;p<l;p+=i){var f=a[p];h<f?h=f:h<-f&&(h=f)}(0===s||Math.abs(h)>o[u])&&(o[u]=h)}return o}}},{key:"reverseBuffer",value:function(){if(!this.buffer)throw"SoundFile is not done loading";var t=this._lastPos/R.sampleRate,e=this.getVolume();this.setVolume(0,.001);for(var n=this.buffer.numberOfChannels,i=0;i<n;i++)this.buffer.getChannelData(i).reverse();this.reversed=!this.reversed,this.isPlaying()&&t&&this.jump(this.duration()-t),this.setVolume(e,.001)}},{key:"onended",value:function(t){return this._onended=t,this}},{key:"add",value:function(){}},{key:"dispose",value:function(){var t=p.audiocontext.currentTime,e=p.soundArray.indexOf(this);if(p.soundArray.splice(e,1),this.stop(t),this.buffer&&this.bufferSourceNode){for(var n=0;n<this.bufferSourceNodes.length-1;n++)if(null!==this.bufferSourceNodes[n]){this.bufferSourceNodes[n].disconnect();try{this.bufferSourceNodes[n].stop(t)}catch(t){}this.bufferSourceNodes[n]=null}if(this.isPlaying()){try{this._counterNode.stop(t)}catch(t){}this._counterNode=null}}this.output&&(this.output.disconnect(),this.output=null),this.panner&&(this.panner.disconnect(),this.panner=null)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.panner.connect(t.input):this.panner.connect(t):this.panner.connect(p.input)}},{key:"disconnect",value:function(){this.panner&&this.panner.disconnect()}},{key:"getLevel",value:function(){}},{key:"setPath",value:function(t,e){var n=p5.prototype._checkFileFormats(t);this.url=n,this.load(e)}},{key:"setBuffer",value:function(t){var e=t.length,n=t[0].length,i=R.createBuffer(e,n,R.sampleRate);t[0]instanceof Float32Array||(t[0]=new Float32Array(t[0]));for(var r=0;r<e;r++){i.getChannelData(r).set(t[r])}this.buffer=i,this.panner.inputChannels(e)}},{key:"_initCounterNode",value:function(){var e=this,n=this,t=R.currentTime,i=R.createBufferSource(),r=y(256);return n._workletNode&&(n._workletNode.disconnect(),delete n._workletNode),n._workletNode=new AudioWorkletNode(R,s.a.soundFileProcessor,{processorOptions:{bufferSize:r}}),n._workletNode.port.onmessage=function(t){if("position"===t.data.name){if(0===t.data.position)return;e._lastPos=t.data.position,e._onTimeUpdate(n._lastPos)}},i.buffer=function(t){for(var e=t.length,n=R.createBuffer(1,t.length,R.sampleRate),i=n.getChannelData(0),r=0;r<e;r++)i[r]=r;return n}(n.buffer),i.playbackRate.setValueAtTime(n.playbackRate,t),i.connect(n._workletNode),n._workletNode.connect(p5.soundOut._silentNode),i}},{key:"_initSourceNode",value:function(){var t=R.createBufferSource();return t.buffer=this.buffer,t.playbackRate.value=this.playbackRate,t.connect(this.output),t}},{key:"processPeaks",value:function(t,e,n,i){}},{key:"addCue",value:function(t,e,n){var i=this._cueIDCounter++,r=new C(e,t,i,n);return this._cues.push(r),i}},{key:"removeCue",value:function(t){for(var e=this._cues.length,n=0;n<e;n++){if(this._cues[n].id===t){this._cues.splice(n,1);break}}this._cues.length}},{key:"clearCues",value:function(){this._cues=[]}},{key:"_onTimeUpdate",value:function(t){for(var e=t/this.buffer.sampleRate,n=this._cues.length,i=0;i<n;i++){var r=this._cues[i],o=r.time,s=r.val;(this._prevUpdateTime||0)<=o&&o<=e&&r.callback(s)}this._prevUpdateTime=e}},{key:"save",value:function(t){p5.prototype.saveSound(this,t,"wav")}},{key:"getBlob",value:function(){var t=a(this.buffer);return new Blob([t],{type:"audio/wav"})}}]),o}();var E=q;function N(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var B=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.bufferSize=y(2048),this.audiocontext=p.audiocontext,this._workletNode=new AudioWorkletNode(this.audiocontext,s.a.amplitudeProcessor,{outputChannelCount:[1],parameterData:{smoothing:t||0},processorOptions:{normalize:!1,smoothing:t||0,numInputChannels:2,bufferSize:this.bufferSize}}),this._workletNode.port.onmessage=function(t){"amplitude"===t.data.name&&(this.volume=t.data.volume,this.volNorm=t.data.volNorm,this.stereoVol=t.data.stereoVol,this.stereoVolNorm=t.data.stereoVolNorm)}.bind(this),this.input=this._workletNode,this.output=this.audiocontext.createGain(),this.volume=0,this.volNorm=0,this.stereoVol=[0,0],this.stereoVolNorm=[0,0],this.normalize=!1,this._workletNode.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),p.meter.connect(this._workletNode),p.soundArray.push(this)}return function(t,e,n){e&&N(t.prototype,e),n&&N(t,n)}(e,[{key:"setInput",value:function(t,e){p.meter.disconnect(),e&&(this._workletNode.parameters.get("smoothing").value=e),null==t?p.meter.connect(this._workletNode):t?(t.connect(this._workletNode),this._workletNode.disconnect(),this._workletNode.connect(this.output)):p.meter.connect(this._workletNode)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):this.output.connect(t):this.output.connect(this.panner.connect(p.input))}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"getLevel",value:function(t){return void 0!==t?this.normalize?this.stereoVolNorm[t]:this.stereoVol[t]:this.normalize?this.volNorm:this.volume}},{key:"toggleNormalize",value:function(t){this.normalize="boolean"==typeof t?t:!this.normalize,this._workletNode.port.postMessage({name:"toggleNormalize",normalize:this.normalize})}},{key:"smooth",value:function(t){0<=t&&t<1&&this._workletNode.port.postMessage({name:"smoothing",smoothing:t})}},{key:"dispose",value:function(){var t=p.soundArray.indexOf(this);p.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._workletNode.disconnect(),delete this._workletNode}}]),e}();function V(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var j=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.input=this.analyser=p.audiocontext.createAnalyser(),Object.defineProperties(this,{bins:{get:function(){return this.analyser.fftSize/2},set:function(t){this.analyser.fftSize=2*t},configurable:!0,enumerable:!0},smoothing:{get:function(){return this.analyser.smoothingTimeConstant},set:function(t){this.analyser.smoothingTimeConstant=t},configurable:!0,enumerable:!0}}),this.smooth(t),this.bins=e||1024,p.fftMeter.connect(this.analyser),this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount),this.bass=[20,140],this.lowMid=[140,400],this.mid=[400,2600],this.highMid=[2600,5200],this.treble=[5200,14e3],p.soundArray.push(this)}return function(t,e,n){e&&V(t.prototype,e),n&&V(t,n)}(n,[{key:"setInput",value:function(t){t?(t.output?t.output.connect(this.analyser):t.connect&&t.connect(this.analyser),p.fftMeter.disconnect()):p.fftMeter.connect(this.analyser)}},{key:"waveform",value:function(){for(var t,e,n=new Array,i=0;i<arguments.length;i++)"number"==typeof arguments[i]&&(t=arguments[i],this.analyser.fftSize=2*t),"string"==typeof arguments[i]&&(e=arguments[i]);if(e&&!p5.prototype._isSafari())return function(t){t.timeDomain instanceof Float32Array==!1&&(t.timeDomain=new Float32Array(t.analyser.frequencyBinCount))}(this,this.timeDomain),this.analyser.getFloatTimeDomainData(this.timeDomain),this.timeDomain;!function(t){t.timeDomain instanceof Uint8Array==!1&&(t.timeDomain=new Uint8Array(t.analyser.frequencyBinCount))}(this,this.timeDomain),this.analyser.getByteTimeDomainData(this.timeDomain);for(var r=0;r<this.timeDomain.length;r++){var o=p5.prototype.map(this.timeDomain[r],0,255,-1,1);n.push(o)}return n}},{key:"analyze",value:function(){for(var t,e=0;e<arguments.length;e++)"number"==typeof arguments[e]&&(this.bins=arguments[e],this.analyser.fftSize=2*this.bins),"string"==typeof arguments[e]&&(t=arguments[e]);return t&&"db"===t.toLowerCase()?(function(t){t.freqDomain instanceof Float32Array==!1&&(t.freqDomain=new Float32Array(t.analyser.frequencyBinCount))}(this),this.analyser.getFloatFrequencyData(this.freqDomain),this.freqDomain):(function(t){t.freqDomain instanceof Uint8Array==!1&&(t.freqDomain=new Uint8Array(t.analyser.frequencyBinCount))}(this,this.freqDomain),this.analyser.getByteFrequencyData(this.freqDomain),Array.apply([],this.freqDomain))}},{key:"getEnergy",value:function(t,e){var n=p.audiocontext.sampleRate/2;if("bass"===t?(t=this.bass[0],e=this.bass[1]):"lowMid"===t?(t=this.lowMid[0],e=this.lowMid[1]):"mid"===t?(t=this.mid[0],e=this.mid[1]):"highMid"===t?(t=this.highMid[0],e=this.highMid[1]):"treble"===t&&(t=this.treble[0],e=this.treble[1]),"number"!=typeof t)throw"invalid input for getEnergy()";if(e){if(t&&e){if(e<t){var i=e;e=t,t=i}for(var r=Math.round(t/n*this.freqDomain.length),o=Math.round(e/n*this.freqDomain.length),s=0,a=0,u=r;u<=o;u++)s+=this.freqDomain[u],a+=1;return s/a}throw"invalid input for getEnergy()"}var c=Math.round(t/n*this.freqDomain.length);return this.freqDomain[c]}},{key:"getFreq",value:function(t,e){return this.getEnergy(t,e)}},{key:"getCentroid",value:function(){for(var t=p.audiocontext.sampleRate/2,e=0,n=0,i=0;i<this.freqDomain.length;i++)e+=i*this.freqDomain[i],n+=this.freqDomain[i];var r=0;return 0!==n&&(r=e/n),r*(t/this.freqDomain.length)}},{key:"smooth",value:function(t){return void 0!==t&&(this.smoothing=t),this.smoothing}},{key:"dispose",value:function(){var t=p.soundArray.indexOf(this);p.soundArray.splice(t,1),this.analyser&&(this.analyser.disconnect(),delete this.analyser)}},{key:"linAverages",value:function(t){for(var e=t||16,n=this.freqDomain,i=n.length,r=Math.floor(i/e),o=new Array(e),s=0,a=0;a<i;a++)o[s]=void 0!==o[s]?(o[s]+n[a])/2:n[a],a%r==r-1&&s++;return o}},{key:"logAverages",value:function(t){for(var e=p.audiocontext.sampleRate/2,n=this.freqDomain,i=n.length,r=new Array(t.length),o=0,s=0;s<i;s++){Math.round(s*e/this.freqDomain.length)>t[o].hi&&o++,r[o]=void 0!==r[o]?(r[o]+n[s])/2:n[s]}return r}},{key:"getOctaveBands",value:function(t,e){var n=t||3,i=e||15.625,r=[],o={lo:i/Math.pow(2,1/(2*n)),ctr:i,hi:i*Math.pow(2,1/(2*n))};r.push(o);for(var s=p.audiocontext.sampleRate/2;o.hi<s;){var a={};a.lo=o.hi,a.ctr=o.ctr*Math.pow(2,1/n),a.hi=a.ctr*Math.pow(2,1/(2*n)),r.push(a),o=a}return r}}]),n}(),M=n(4),F=n.n(M),D=n(1),I=n.n(D),U=n(8),G=n.n(U);function L(t){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,e){return!e||"object"!==L(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function W(t){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Z(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function $(t,e,n,i,r){var o=t.oscillator;for(var s in t.mathOps)t.mathOps[s]instanceof r&&(o.disconnect(),t.mathOps[s].dispose(),(n=s)<t.mathOps.length-2&&(i=t.mathOps[s+1]));return n===t.mathOps.length-1&&t.mathOps.push(i),0<s&&(o=t.mathOps[s-1]),o.disconnect(),o.connect(e),e.connect(i),t.mathOps[n]=e,t}var Q=function(){function r(t,e){if(Y(this,r),"string"==typeof t){var n=e;e=t,t=n}if("number"==typeof e){var i=e;e=t,t=i}this.started=!1,this.phaseAmount=void 0,this.oscillator=p.audiocontext.createOscillator(),this.f=t||440,this.oscillator.type=e||"sine",this.oscillator.frequency.setValueAtTime(this.f,p.audiocontext.currentTime),this.output=p.audiocontext.createGain(),this._freqMods=[],this.output.gain.value=.5,this.output.gain.setValueAtTime(.5,p.audiocontext.currentTime),this.oscillator.connect(this.output),this.panPosition=0,this.connection=p.input,this.panner=new k(this.output,this.connection,1),this.mathOps=[this.output],p.soundArray.push(this),this.fade=this.amp}return function(t,e,n){e&&H(t.prototype,e),n&&H(t,n)}(r,[{key:"start",value:function(t,e){if(this.started){var n=p.audiocontext.currentTime;this.stop(n)}if(!this.started){var i=e||this.f,r=this.oscillator.type;for(var o in this.oscillator&&(this.oscillator.disconnect(),delete this.oscillator),this.oscillator=p.audiocontext.createOscillator(),this.oscillator.frequency.value=Math.abs(i),this.oscillator.type=r,this.oscillator.connect(this.output),t=t||0,this.oscillator.start(t+p.audiocontext.currentTime),this.freqNode=this.oscillator.frequency,this._freqMods)void 0!==this._freqMods[o].connect&&this._freqMods[o].connect(this.oscillator.frequency);this.started=!0}}},{key:"stop",value:function(t){if(this.started){var e=t||0,n=p.audiocontext.currentTime;this.oscillator.stop(e+n),this.started=!1}}},{key:"amp",value:function(t,e,n){var i=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==n?n:0;if("number"==typeof t){var o=p.audiocontext.currentTime;this.output.gain.linearRampToValueAtTime(t,o+r+i)}else{if(!t)return this.output.gain;t.connect(this.output.gain)}}},{key:"getAmp",value:function(){return this.output.gain.value}},{key:"freq",value:function(t,e,n){var i=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==n?n:0;if("number"!=typeof t||isNaN(t)){if(!t)return this.oscillator.frequency;t.output&&(t=t.output),t.connect(this.oscillator.frequency),this._freqMods.push(t)}else{this.f=t;var o=p.audiocontext.currentTime;0===i?this.oscillator.frequency.setValueAtTime(t,r+o):0<t?this.oscillator.frequency.exponentialRampToValueAtTime(t,r+i+o):this.oscillator.frequency.linearRampToValueAtTime(t,r+i+o),this.phaseAmount&&this.phase(this.phaseAmount)}}},{key:"getFreq",value:function(){return this.oscillator.frequency.value}},{key:"setType",value:function(t){this.oscillator.type=t}},{key:"getType",value:function(){return this.oscillator.type}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?(this.panner.connect(t.input),this.connection=t.input):(this.panner.connect(t),this.connection=t):this.panner.connect(p.input)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect(),this.panner&&(this.panner.disconnect(),this.output&&this.output.connect(this.panner)),this.oscMods=[]}},{key:"pan",value:function(t,e){this.panPosition=t,this.panner.pan(t,e)}},{key:"getPan",value:function(){return this.panPosition}},{key:"dispose",value:function(){var t=p.soundArray.indexOf(this);if(p.soundArray.splice(t,1),this.oscillator){var e=p.audiocontext.currentTime;this.stop(e),this.disconnect(),this.panner=null,this.oscillator=null}this.osc2&&this.osc2.dispose()}},{key:"phase",value:function(t){var e=p5.prototype.map(t,0,1,0,1/this.f),n=p.audiocontext.currentTime;this.phaseAmount=t,this.dNode||(this.dNode=p.audiocontext.createDelay(),this.oscillator.disconnect(),this.oscillator.connect(this.dNode),this.dNode.connect(this.output)),this.dNode.delayTime.setValueAtTime(e,n)}},{key:"add",value:function(t){var e=new F.a(t);return $(this,e,this.mathOps.length-1,this.output,F.a)}},{key:"mult",value:function(t){var e=new I.a(t);return $(this,e,this.mathOps.length-1,this.output,I.a)}},{key:"scale",value:function(t,e,n,i){var r,o;o=4===arguments.length?(r=p5.prototype.map(n,t,e,0,1)-.5,p5.prototype.map(i,t,e,0,1)-.5):(r=t,e);var s=new G.a(r,o);return $(this,s,this.mathOps.length-1,this.output,G.a)}}]),r}(),J=function(){function e(t){return Y(this,e),z(this,W(e).call(this,t,"sine"))}return Z(e,Q),e}(),K=function(){function e(t){return Y(this,e),z(this,W(e).call(this,t,"triangle"))}return Z(e,Q),e}(),tt=function(){function e(t){return Y(this,e),z(this,W(e).call(this,t,"sawtooth"))}return Z(e,Q),e}(),et=function(){function e(t){return Y(this,e),z(this,W(e).call(this,t,"square"))}return Z(e,Q),e}(),nt=Q,it=n(7),rt=n.n(it);p5.Envelope=function(t,e,n,i,r,o){this.aTime=t||.1,this.aLevel=e||1,this.dTime=n||.5,this.dLevel=i||0,this.rTime=r||0,this.rLevel=o||0,this._rampHighPercentage=.98,this._rampLowPercentage=.02,this.output=p.audiocontext.createGain(),this.control=new rt.a,this._init(),this.control.connect(this.output),this.connection=null,this.mathOps=[this.control],this.isExponential=!1,this.sourceToClear=null,this.wasTriggered=!1,p.soundArray.push(this)},p5.Envelope.prototype._init=function(){var t=p.audiocontext.currentTime;this.control.setTargetAtTime(1e-5,t,.001),this._setRampAD(this.aTime,this.dTime)},p5.Envelope.prototype.set=function(t,e,n,i,r,o){this.aTime=t,this.aLevel=e,this.dTime=n||0,this.dLevel=i||0,this.rTime=r||0,this.rLevel=o||0,this._setRampAD(t,n)},p5.Envelope.prototype.setADSR=function(t,e,n,i){this.aTime=t,this.dTime=e||0,this.sPercent=n||0,this.dLevel=void 0!==n?n*(this.aLevel-this.rLevel)+this.rLevel:0,this.rTime=i||0,this._setRampAD(t,e)},p5.Envelope.prototype.setRange=function(t,e){this.aLevel=t||1,this.rLevel=e||0},p5.Envelope.prototype._setRampAD=function(t,e){this._rampAttackTime=this.checkExpInput(t),this._rampDecayTime=this.checkExpInput(e);var n=1;n=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=t/this.checkExpInput(n),n=Math.log(1/this._rampLowPercentage),this._rampDecayTC=e/this.checkExpInput(n)},p5.Envelope.prototype.setRampPercentages=function(t,e){this._rampHighPercentage=this.checkExpInput(t),this._rampLowPercentage=this.checkExpInput(e);var n=1;n=Math.log(1/this.checkExpInput(1-this._rampHighPercentage)),this._rampAttackTC=this._rampAttackTime/this.checkExpInput(n),n=Math.log(1/this._rampLowPercentage),this._rampDecayTC=this._rampDecayTime/this.checkExpInput(n)},p5.Envelope.prototype.setInput=function(){for(var t=0;t<arguments.length;t++)this.connect(arguments[t])},p5.Envelope.prototype.setExp=function(t){this.isExponential=t},p5.Envelope.prototype.checkExpInput=function(t){return t<=0&&(t=1e-8),t},p5.Envelope.prototype.play=function(t,e,n){var i=e||0;t&&this.connection!==t&&this.connect(t),this.triggerAttack(t,i),this.triggerRelease(t,i+this.aTime+this.dTime+~~n)},p5.Envelope.prototype.triggerAttack=function(t,e){var n=p.audiocontext.currentTime+(e||0);this.lastAttack=n,this.wasTriggered=!0,t&&this.connection!==t&&this.connect(t);var i=this.control.getValueAtTime(n);!0===this.isExponential?this.control.exponentialRampToValueAtTime(this.checkExpInput(i),n):this.control.linearRampToValueAtTime(i,n),n+=this.aTime,!0===this.isExponential?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.aLevel),n),i=this.checkExpInput(this.control.getValueAtTime(n)),this.control.cancelScheduledValues(n),this.control.exponentialRampToValueAtTime(i,n)):(this.control.linearRampToValueAtTime(this.aLevel,n),i=this.control.getValueAtTime(n),this.control.cancelScheduledValues(n),this.control.linearRampToValueAtTime(i,n)),n+=this.dTime,!0===this.isExponential?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.dLevel),n),i=this.checkExpInput(this.control.getValueAtTime(n)),this.control.cancelScheduledValues(n),this.control.exponentialRampToValueAtTime(i,n)):(this.control.linearRampToValueAtTime(this.dLevel,n),i=this.control.getValueAtTime(n),this.control.cancelScheduledValues(n),this.control.linearRampToValueAtTime(i,n))},p5.Envelope.prototype.triggerRelease=function(t,e){if(this.wasTriggered){var n=p.audiocontext.currentTime+(e||0);t&&this.connection!==t&&this.connect(t);var i=this.control.getValueAtTime(n);!0===this.isExponential?this.control.exponentialRampToValueAtTime(this.checkExpInput(i),n):this.control.linearRampToValueAtTime(i,n),n+=this.rTime,!0===this.isExponential?(this.control.exponentialRampToValueAtTime(this.checkExpInput(this.rLevel),n),i=this.checkExpInput(this.control.getValueAtTime(n)),this.control.cancelScheduledValues(n),this.control.exponentialRampToValueAtTime(i,n)):(this.control.linearRampToValueAtTime(this.rLevel,n),i=this.control.getValueAtTime(n),this.control.cancelScheduledValues(n),this.control.linearRampToValueAtTime(i,n)),this.wasTriggered=!1}},p5.Envelope.prototype.ramp=function(t,e,n,i){var r=p.audiocontext.currentTime+(e||0),o=this.checkExpInput(n),s=void 0!==i?this.checkExpInput(i):void 0;t&&this.connection!==t&&this.connect(t);var a=this.checkExpInput(this.control.getValueAtTime(r));a<o?(this.control.setTargetAtTime(o,r,this._rampAttackTC),r+=this._rampAttackTime):o<a&&(this.control.setTargetAtTime(o,r,this._rampDecayTC),r+=this._rampDecayTime),void 0!==s&&(o<s?this.control.setTargetAtTime(s,r,this._rampAttackTC):s<o&&this.control.setTargetAtTime(s,r,this._rampDecayTC))},p5.Envelope.prototype.connect=function(t){((this.connection=t)instanceof p5.Oscillator||t instanceof p5.SoundFile||t instanceof p5.AudioIn||t instanceof p5.Reverb||t instanceof p5.Noise||t instanceof p5.Filter||t instanceof p5.Delay)&&(t=t.output.gain),t instanceof AudioParam&&t.setValueAtTime(0,p.audiocontext.currentTime),this.output.connect(t)},p5.Envelope.prototype.disconnect=function(){this.output&&this.output.disconnect()},p5.Envelope.prototype.add=function(t){var e=new F.a(t),n=this.mathOps.length,i=this.output;return p5.prototype._mathChain(this,e,n,i,F.a)},p5.Envelope.prototype.mult=function(t){var e=new I.a(t),n=this.mathOps.length,i=this.output;return p5.prototype._mathChain(this,e,n,i,I.a)},p5.Envelope.prototype.scale=function(t,e,n,i){var r=new G.a(t,e,n,i),o=this.mathOps.length,s=this.output;return p5.prototype._mathChain(this,r,o,s,G.a)},p5.Envelope.prototype.dispose=function(){var t=p.soundArray.indexOf(this);p.soundArray.splice(t,1),this.disconnect(),this.control&&(this.control.dispose(),this.control=null);for(var e=1;e<this.mathOps.length;e++)this.mathOps[e].dispose()},p5.Env=function(t,e,n,i,r,o){p5.Envelope.call(this,t,e,n,i,r,o)},p5.Env.prototype=Object.create(p5.Envelope.prototype);var ot=p5.Envelope;function st(t){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function at(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ut(t,e){return!e||"object"!==st(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lt(t,e){return(lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ht=function(){for(var t=2*p.audiocontext.sampleRate,e=p.audiocontext.createBuffer(1,t,p.audiocontext.sampleRate),n=e.getChannelData(0),i=0;i<t;i++)n[i]=2*Math.random()-1;return e.type="white",e}(),pt=function(){var t,e,n,i,r,o,s,a=2*p.audiocontext.sampleRate,u=p.audiocontext.createBuffer(1,a,p.audiocontext.sampleRate),c=u.getChannelData(0);t=e=n=i=r=o=s=0;for(var l=0;l<a;l++){var h=2*Math.random()-1;t=.99886*t+.0555179*h,e=.99332*e+.0750759*h,n=.969*n+.153852*h,i=.8665*i+.3104856*h,r=.55*r+.5329522*h,o=-.7616*o-.016898*h,c[l]=t+e+n+i+r+o+s+.5362*h,c[l]*=.11,s=.115926*h}return u.type="pink",u}(),ft=function(){for(var t=2*p.audiocontext.sampleRate,e=p.audiocontext.createBuffer(1,t,p.audiocontext.sampleRate),n=e.getChannelData(0),i=0,r=0;r<t;r++){var o=2*Math.random()-1;n[r]=(i+.02*o)/1.02,i=n[r],n[r]*=3.5}return e.type="brown",e}(),dt=function(){function i(t){var e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),delete(e=ut(this,ct(i).call(this))).f,delete e.freq,delete e.oscillator,n="brown"===t?ft:"pink"===t?pt:ht,e.buffer=n,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lt(t,e)}(i,nt),function(t,e,n){e&&at(t.prototype,e),n&&at(t,n)}(i,[{key:"setType",value:function(t){switch(t){case"white":this.buffer=ht;break;case"pink":this.buffer=pt;break;case"brown":this.buffer=ft;break;default:this.buffer=ht}if(this.started){var e=p.audiocontext.currentTime;this.stop(e),this.start(e+.01)}}},{key:"getType",value:function(){return this.buffer.type}},{key:"start",value:function(){this.started&&this.stop(),this.noise=p.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output);var t=p.audiocontext.currentTime;this.noise.start(t),this.started=!0}},{key:"stop",value:function(){var t=p.audiocontext.currentTime;this.noise&&(this.noise.stop(t),this.started=!1)}},{key:"dispose",value:function(){var t=p.audiocontext.currentTime,e=p.soundArray.indexOf(this);p.soundArray.splice(e,1),this.noise&&(this.noise.disconnect(),this.stop(t)),this.output&&this.output.disconnect(),this.panner&&this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise=null}}]),i}(),yt=n(2),mt=n.n(yt);function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function gt(t,e){return!e||"object"!==vt(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function bt(t){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t,e){return(Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wt(){for(var t=p.audiocontext,e=t.createBuffer(1,2048,t.sampleRate),n=e.getChannelData(0),i=0;i<2048;i++)n[i]=1;var r=t.createBufferSource();return r.buffer=e,r.loop=!0,r}var xt=function(){function r(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(n=gt(this,bt(r).call(this,t,"sawtooth"))).w=e||0,n.osc2=new tt(t),n.dNode=p.audiocontext.createDelay(),n.dcOffset=wt(),n.dcGain=p.audiocontext.createGain(),n.dcOffset.connect(n.dcGain),n.dcGain.connect(n.output),n.f=t||440;var i=n.w/n.oscillator.frequency.value;return n.dNode.delayTime.value=i,n.dcGain.gain.value=1.7*(.5-n.w),n.osc2.disconnect(),n.osc2.panner.disconnect(),n.osc2.amp(-1),n.osc2.output.connect(n.dNode),n.dNode.connect(n.output),n.output.gain.value=1,n.output.connect(n.panner),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}(r,nt),function(t,e,n){e&&_t(t.prototype,e),n&&_t(t,n)}(r,[{key:"width",value:function(t){if("number"==typeof t){if(t<=1&&0<=t){this.w=t;var e=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=e}this.dcGain.gain.value=1.7*(.5-this.w)}else{t.connect(this.dNode.delayTime);var n=new mt.a(-.5);t.connect(n);var i=new I.a(-1),r=new I.a(1.7);(n=n.connect(i).connect(r)).connect(this.dcGain.gain)}}},{key:"start",value:function(t,e){var n=p.audiocontext.currentTime,i=e||0;if(!this.started){var r=t||this.f,o=this.oscillator.type;this.oscillator=p.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.type=o,this.oscillator.connect(this.output),this.oscillator.start(i+n),this.osc2.oscillator=p.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(r,i+n),this.osc2.oscillator.type=o,this.osc2.oscillator.connect(this.osc2.output),this.osc2.start(i+n),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],this.dcOffset=wt(),this.dcOffset.connect(this.dcGain),this.dcOffset.start(i+n),void 0!==this.mods&&void 0!==this.mods.frequency&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0}}},{key:"stop",value:function(t){if(this.started){var e=t||0,n=p.audiocontext.currentTime;this.oscillator.stop(e+n),this.osc2.oscillator&&this.osc2.oscillator.stop(e+n),this.dcOffset.stop(e+n),this.started=!1,this.osc2.started=!1}}},{key:"freq",value:function(t,e,n){var i=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==n?n:0;if("number"==typeof t){this.f=t;var o=p.audiocontext.currentTime,s=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(o),this.oscillator.frequency.setValueAtTime(s,o+r),this.oscillator.frequency.exponentialRampToValueAtTime(t,r+i+o),this.osc2.oscillator.frequency.cancelScheduledValues(o),this.osc2.oscillator.frequency.setValueAtTime(s,o+r),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(t,r+i+o),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)}else t.output&&(t.output.disconnect(),t.output.connect(this.oscillator.frequency),t.output.connect(this.osc2.oscillator.frequency),this.freqMod=t)}}]),r}();function St(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}p.inputSources=[];var kt=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.input=p.audiocontext.createGain(),this.output=p.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=null,this.enabled=!1,this.amplitude=new B,this.output.connect(this.amplitude.input),window.MediaStreamTrack&&window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia||(t?t():window.alert("This browser does not support MediaStreamTrack and mediaDevices")),p.soundArray.push(this)}return function(t,e,n){e&&St(t.prototype,e),n&&St(t,n)}(e,[{key:"start",value:function(e,n){var i=this;this.stream&&this.stop();var t=p.inputSources[i.currentSource],r={audio:{sampleRate:p.audiocontext.sampleRate,echoCancellation:!1}};p.inputSources[this.currentSource]&&(r.audio.deviceId=t.deviceId),window.navigator.mediaDevices.getUserMedia(r).then(function(t){i.stream=t,i.enabled=!0,i.mediaStream=p.audiocontext.createMediaStreamSource(t),i.mediaStream.connect(i.output),i.amplitude.setInput(i.output),e&&e()}).catch(function(t){n&&n(t)})}},{key:"stop",value:function(){this.stream&&(this.stream.getTracks().forEach(function(t){t.stop()}),this.mediaStream.disconnect(),delete this.mediaStream,delete this.stream)}},{key:"connect",value:function(t){t?t.hasOwnProperty("input")?this.output.connect(t.input):t.hasOwnProperty("analyser")?this.output.connect(t.analyser):this.output.connect(t):this.output.connect(p.input)}},{key:"disconnect",value:function(){this.output&&(this.output.disconnect(),this.output.connect(this.amplitude.input))}},{key:"getLevel",value:function(t){return t&&(this.amplitude.smoothing=t),this.amplitude.getLevel()}},{key:"amp",value:function(t,e){if(e){var n=e||0,i=this.output.gain.value;this.output.gain.cancelScheduledValues(p.audiocontext.currentTime),this.output.gain.setValueAtTime(i,p.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(t,n+p.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(p.audiocontext.currentTime),this.output.gain.setValueAtTime(t,p.audiocontext.currentTime)}},{key:"getSources",value:function(i,r){return new Promise(function(e,n){window.navigator.mediaDevices.enumerateDevices().then(function(t){p.inputSources=t.filter(function(t){return"audioinput"===t.kind}),e(p.inputSources),i&&i(p.inputSources)}).catch(function(t){n(t),r&&r(t)})})}},{key:"setSource",value:function(t){0<p.inputSources.length&&t<p.inputSources.length&&(this.currentSource=t),this.stream&&this.stream.active&&this.start()}},{key:"dispose",value:function(){var t=p.soundArray.indexOf(this);p.soundArray.splice(t,1),this.stop(),this.output&&this.output.disconnect(),this.amplitude&&this.amplitude.disconnect(),delete this.amplitude,delete this.output}}]),e}(),Pt=n(23),At=n.n(Pt);function Ot(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ct=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ac=p.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this._drywet=new At.a(1),this.wet=this.ac.createGain(),this.input.connect(this._drywet.a),this.wet.connect(this._drywet.b),this._drywet.connect(this.output),this.connect(),p.soundArray.push(this)}return function(t,e,n){e&&Ot(t.prototype,e),n&&Ot(t,n)}(t,[{key:"amp",value:function(t,e,n){var i=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==n?n:0,o=p.audiocontext.currentTime,s=o+r,a=s+i+.001,u=this.output.gain.value;this.output.gain.cancelScheduledValues(o),this.output.gain.linearRampToValueAtTime(u,s+.001),this.output.gain.linearRampToValueAtTime(t,a)}},{key:"chain",value:function(t){if(0<arguments.length){this.connect(t);for(var e=1;e<arguments.length;e+=1)arguments[e-1].connect(arguments[e])}return this}},{key:"drywet",value:function(t){return void 0!==t&&(this._drywet.fade.value=t),this._drywet.fade.value}},{key:"connect",value:function(t){var e=t||p5.soundOut.input;this.output.connect(e.input?e.input:e)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){var t=p.soundArray.indexOf(this);p.soundArray.splice(t,1),this.input&&(this.input.disconnect(),delete this.input),this.output&&(this.output.disconnect(),delete this.output),this._drywet&&(this._drywet.disconnect(),delete this._drywet),this.wet&&(this.wet.disconnect(),delete this.wet),this.ac=void 0}}]),t}();function Rt(t){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Et(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Nt(t,e){return!e||"object"!==Rt(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Bt(t,e,n){return(Bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vt(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Vt(t){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}function Mt(t,e){return(Mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ft=function(){function n(t){var e;return qt(this,n),(e=Nt(this,Vt(n).call(this))).biquad=e.ac.createBiquadFilter(),e.input.connect(e.biquad),e.biquad.connect(e.wet),t&&e.setType(t),e._on=!0,e._untoggledType=e.biquad.type,e}return jt(n,Ct),function(t,e,n){e&&Et(t.prototype,e),n&&Et(t,n)}(n,[{key:"process",value:function(t,e,n,i){t.connect(this.input),this.set(e,n,i)}},{key:"set",value:function(t,e,n){t&&this.freq(t,n),e&&this.res(e,n)}},{key:"freq",value:function(t,e){var n=e||0;return t<=0&&(t=1),"number"==typeof t?(this.biquad.frequency.cancelScheduledValues(this.ac.currentTime+.01+n),this.biquad.frequency.exponentialRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.biquad.frequency),this.biquad.frequency.value}},{key:"res",value:function(t,e){var n=e||0;return"number"==typeof t?(this.biquad.Q.value=t,this.biquad.Q.cancelScheduledValues(this.ac.currentTime+.01+n),this.biquad.Q.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.biquad.Q),this.biquad.Q.value}},{key:"gain",value:function(t,e){var n=e||0;return"number"==typeof t?(this.biquad.gain.value=t,this.biquad.gain.cancelScheduledValues(this.ac.currentTime+.01+n),this.biquad.gain.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.biquad.gain),this.biquad.gain.value}},{key:"toggle",value:function(){return this._on=!this._on,!0===this._on?this.biquad.type=this._untoggledType:!1===this._on&&(this.biquad.type="allpass"),this._on}},{key:"setType",value:function(t){this.biquad.type=t,this._untoggledType=this.biquad.type}},{key:"dispose",value:function(){Bt(Vt(n.prototype),"dispose",this).call(this),this.biquad&&(this.biquad.disconnect(),delete this.biquad)}}]),n}(),Dt=function(){function t(){return qt(this,t),Nt(this,Vt(t).call(this,"lowpass"))}return jt(t,Ft),t}(),It=function(){function t(){return qt(this,t),Nt(this,Vt(t).call(this,"highpass"))}return jt(t,Ft),t}(),Ut=function(){function t(){return qt(this,t),Nt(this,Vt(t).call(this,"bandpass"))}return jt(t,Ft),t}(),Gt=Ft;function Lt(t){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Wt(t,e){return!e||"object"!==Lt(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Zt(t){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xt(t,e){return(Xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yt=function(){function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=Wt(this,Zt(i).call(this,"peaking"))).disconnect(),n.set(t,e),n.biquad.gain.value=0,delete n.input,delete n.output,delete n._drywet,delete n.wet,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xt(t,e)}(i,Gt),function(t,e,n){e&&zt(t.prototype,e),n&&zt(t,n)}(i,[{key:"amp",value:function(){}},{key:"drywet",value:function(){}},{key:"connect",value:function(t){var e=t||p5.soundOut.input;this.biquad?this.biquad.connect(e.input?e.input:e):this.output.connect(e.input?e.input:e)}},{key:"disconnect",value:function(){this.biquad&&this.biquad.disconnect()}},{key:"dispose",value:function(){var t=p.soundArray.indexOf(this);p.soundArray.splice(t,1),this.disconnect(),delete this.biquad}}]),i}();function Ht(t){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Qt(t,e){return!e||"object"!==Ht(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Jt(t,e,n){return(Jt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Kt(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Kt(t){return(Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function te(t,e){return(te=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ee=function(){function s(t){var e,n,i,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),e=Qt(this,Kt(s).call(this)),n=3===(t=3===t||8===t?t:3)?Math.pow(2,3):2,e.bands=[];for(var o=0;o<t;o++)r=o===t-1?(i=21e3,.01):0===o?(i=100,.1):(i=1===o?3===t?360*n:360:e.bands[o-1].freq()*n,1),e.bands[o]=e._newBand(i,r),0<o?e.bands[o-1].connect(e.bands[o].biquad):e.input.connect(e.bands[o].biquad);return e.bands[t-1].connect(e.output),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&te(t,e)}(s,Ct),function(t,e,n){e&&$t(t.prototype,e),n&&$t(t,n)}(s,[{key:"process",value:function(t){t.connect(this.input)}},{key:"set",value:function(){if(arguments.length===2*this.bands.length)for(var t=0;t<arguments.length;t+=2)this.bands[t/2].freq(arguments[t]),this.bands[t/2].gain(arguments[t+1])}},{key:"_newBand",value:function(t,e){return new Yt(t,e)}},{key:"dispose",value:function(){if(Jt(Kt(s.prototype),"dispose",this).call(this),this.bands){for(;0<this.bands.length;)this.bands.pop().dispose();delete this.bands}}}]),s}();function ne(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ie=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.ac=p.audiocontext,this.listener=this.ac.listener}return function(t,e,n){e&&ne(t.prototype,e),n&&ne(t,n)}(e,[{key:"process",value:function(t){t.connect(this.input)}},{key:"position",value:function(t,e,n,i){return this.positionX(t,i),this.positionY(e,i),this.positionZ(n,i),[this.listener.positionX.value,this.listener.positionY.value,this.listener.positionZ.value]}},{key:"positionX",value:function(t,e){var n=e||0;return"number"==typeof t?(this.listener.positionX.value=t,this.listener.positionX.cancelScheduledValues(this.ac.currentTime+.01+n),this.listener.positionX.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.listener.positionX),this.listener.positionX.value}},{key:"positionY",value:function(t,e){var n=e||0;return"number"==typeof t?(this.listener.positionY.value=t,this.listener.positionY.cancelScheduledValues(this.ac.currentTime+.01+n),this.listener.positionY.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.listener.positionY),this.listener.positionY.value}},{key:"positionZ",value:function(t,e){var n=e||0;return"number"==typeof t?(this.listener.positionZ.value=t,this.listener.positionZ.cancelScheduledValues(this.ac.currentTime+.01+n),this.listener.positionZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.listener.positionZ),this.listener.positionZ.value}},{key:"orient",value:function(t,e,n,i,r,o,s){return 3===arguments.length||4===arguments.length?(s=i,this.orientForward(t,e,n,s)):6!==arguments.length&&7!==arguments||(this.orientForward(t,e,n),this.orientUp(i,r,o,s)),[this.listener.forwardX.value,this.listener.forwardY.value,this.listener.forwardZ.value,this.listener.upX.value,this.listener.upY.value,this.listener.upZ.value]}},{key:"orientForward",value:function(t,e,n,i){return this.forwardX(t,i),this.forwardY(e,i),this.forwardZ(n,i),[this.listener.forwardX,this.listener.forwardY,this.listener.forwardZ]}},{key:"orientUp",value:function(t,e,n,i){return this.upX(t,i),this.upY(e,i),this.upZ(n,i),[this.listener.upX,this.listener.upY,this.listener.upZ]}},{key:"forwardX",value:function(t,e){var n=e||0;return"number"==typeof t?(this.listener.forwardX.value=t,this.listener.forwardX.cancelScheduledValues(this.ac.currentTime+.01+n),this.listener.forwardX.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.listener.forwardX),this.listener.forwardX.value}},{key:"forwardY",value:function(t,e){var n=e||0;return"number"==typeof t?(this.listener.forwardY.value=t,this.listener.forwardY.cancelScheduledValues(this.ac.currentTime+.01+n),this.listener.forwardY.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.listener.forwardY),this.listener.forwardY.value}},{key:"forwardZ",value:function(t,e){var n=e||0;return"number"==typeof t?(this.listener.forwardZ.value=t,this.listener.forwardZ.cancelScheduledValues(this.ac.currentTime+.01+n),this.listener.forwardZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.listener.forwardZ),this.listener.forwardZ.value}},{key:"upX",value:function(t,e){var n=e||0;return"number"==typeof t?(this.listener.upX.value=t,this.listener.upX.cancelScheduledValues(this.ac.currentTime+.01+n),this.listener.upX.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.listener.upX),this.listener.upX.value}},{key:"upY",value:function(t,e){var n=e||0;return"number"==typeof t?(this.listener.upY.value=t,this.listener.upY.cancelScheduledValues(this.ac.currentTime+.01+n),this.listener.upY.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.listener.upY),this.listener.upY.value}},{key:"upZ",value:function(t,e){var n=e||0;return"number"==typeof t?(this.listener.upZ.value=t,this.listener.upZ.cancelScheduledValues(this.ac.currentTime+.01+n),this.listener.upZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.listener.upZ),this.listener.upZ.value}}]),e}();function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function se(t,e){return!e||"object"!==re(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function ae(t,e,n){return(ae="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ue(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ue(t){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ce(t,e){return(ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var le=function(){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=se(this,ue(e).call(this))).panner=t.ac.createPanner(),t.panner.panningModel="HRTF",t.panner.distanceModel="linear",t.panner.connect(t.output),t.input.connect(t.panner),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ce(t,e)}(e,Ct),function(t,e,n){e&&oe(t.prototype,e),n&&oe(t,n)}(e,[{key:"process",value:function(t){t.connect(this.input)}},{key:"set",value:function(t,e,n,i){return this.positionX(t,i),this.positionY(e,i),this.positionZ(n,i),[this.panner.positionX.value,this.panner.positionY.value,this.panner.positionZ.value]}},{key:"positionX",value:function(t,e){var n=e||0;return"number"==typeof t?(this.panner.positionX.value=t,this.panner.positionX.cancelScheduledValues(this.ac.currentTime+.01+n),this.panner.positionX.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.panner.positionX),this.panner.positionX.value}},{key:"positionY",value:function(t,e){var n=e||0;return"number"==typeof t?(this.panner.positionY.value=t,this.panner.positionY.cancelScheduledValues(this.ac.currentTime+.01+n),this.panner.positionY.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.panner.positionY),this.panner.positionY.value}},{key:"positionZ",value:function(t,e){var n=e||0;return"number"==typeof t?(this.panner.positionZ.value=t,this.panner.positionZ.cancelScheduledValues(this.ac.currentTime+.01+n),this.panner.positionZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.panner.positionZ),this.panner.positionZ.value}},{key:"orient",value:function(t,e,n,i){return this.orientX(t,i),this.orientY(e,i),this.orientZ(n,i),[this.panner.orientationX.value,this.panner.orientationY.value,this.panner.orientationZ.value]}},{key:"orientX",value:function(t,e){var n=e||0;return"number"==typeof t?(this.panner.orientationX.value=t,this.panner.orientationX.cancelScheduledValues(this.ac.currentTime+.01+n),this.panner.orientationX.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.panner.orientationX),this.panner.orientationX.value}},{key:"orientY",value:function(t,e){var n=e||0;return"number"==typeof t?(this.panner.orientationY.value=t,this.panner.orientationY.cancelScheduledValues(this.ac.currentTime+.01+n),this.panner.orientationY.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.panner.orientationY),this.panner.orientationY.value}},{key:"orientZ",value:function(t,e){var n=e||0;return"number"==typeof t?(this.panner.orientationZ.value=t,this.panner.orientationZ.cancelScheduledValues(this.ac.currentTime+.01+n),this.panner.orientationZ.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):t&&t.connect(this.panner.orientationZ),this.panner.orientationZ.value}},{key:"setFalloff",value:function(t,e){this.maxDist(t),this.rolloff(e)}},{key:"maxDist",value:function(t){return"number"==typeof t&&(this.panner.maxDistance=t),this.panner.maxDistance}},{key:"rolloff",value:function(t){return"number"==typeof t&&(this.panner.rolloffFactor=t),this.panner.rolloffFactor}},{key:"dispose",value:function(){ae(ue(e.prototype),"dispose",this).call(this),this.panner&&(this.panner.disconnect(),delete this.panner)}}]),e}();function he(t){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function fe(t,e){return!e||"object"!==he(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function de(t,e,n){return(de="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ye(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function me(t,e){return(me=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ve=function(){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=fe(this,ye(e).call(this)))._split=t.ac.createChannelSplitter(2),t._merge=t.ac.createChannelMerger(2),t._leftGain=t.ac.createGain(),t._rightGain=t.ac.createGain(),t.leftDelay=t.ac.createDelay(),t.rightDelay=t.ac.createDelay(),t._leftFilter=new Gt,t._rightFilter=new Gt,t._leftFilter.disconnect(),t._rightFilter.disconnect(),t._leftFilter.biquad.frequency.setValueAtTime(1200,t.ac.currentTime),t._rightFilter.biquad.frequency.setValueAtTime(1200,t.ac.currentTime),t._leftFilter.biquad.Q.setValueAtTime(.3,t.ac.currentTime),t._rightFilter.biquad.Q.setValueAtTime(.3,t.ac.currentTime),t.input.connect(t._split),t.leftDelay.connect(t._leftGain),t.rightDelay.connect(t._rightGain),t._leftGain.connect(t._leftFilter.input),t._rightGain.connect(t._rightFilter.input),t._merge.connect(t.wet),t._leftFilter.biquad.gain.setValueAtTime(1,t.ac.currentTime),t._rightFilter.biquad.gain.setValueAtTime(1,t.ac.currentTime),t.setType(0),t._maxDelay=t.leftDelay.delayTime.maxValue,t.feedback(.5),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&me(t,e)}(e,Ct),function(t,e,n){e&&pe(t.prototype,e),n&&pe(t,n)}(e,[{key:"process",value:function(t,e,n,i){var r=n||0,o=e||0;if(1<=r)throw new Error("Feedback value will force a positive feedback loop.");if(o>=this._maxDelay)throw new Error("Delay Time exceeds maximum delay time of "+this._maxDelay+" second.");t.connect(this.input),this.leftDelay.delayTime.setValueAtTime(o,this.ac.currentTime),this.rightDelay.delayTime.setValueAtTime(o,this.ac.currentTime),this._leftGain.gain.value=r,this._rightGain.gain.value=r,i&&(this._leftFilter.freq(i),this._rightFilter.freq(i))}},{key:"delayTime",value:function(t){"number"!=typeof t?(t.connect(this.leftDelay.delayTime),t.connect(this.rightDelay.delayTime)):(this.leftDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.rightDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.leftDelay.delayTime.linearRampToValueAtTime(t,this.ac.currentTime),this.rightDelay.delayTime.linearRampToValueAtTime(t,this.ac.currentTime))}},{key:"feedback",value:function(t){if(t&&"number"!=typeof t)t.connect(this._leftGain.gain),t.connect(this._rightGain.gain);else{if(1<=t)throw new Error("Feedback value will force a positive feedback loop.");"number"==typeof t&&(this._leftGain.gain.value=t,this._rightGain.gain.value=t)}return this._leftGain.gain.value}},{key:"filter",value:function(t,e){this._leftFilter.set(t,e),this._rightFilter.set(t,e)}},{key:"setType",value:function(t){switch(1===t&&(t="pingPong"),this._split.disconnect(),this._leftFilter.disconnect(),this._rightFilter.disconnect(),this._split.connect(this.leftDelay,0),this._split.connect(this.rightDelay,1),t){case"pingPong":this._rightFilter.setType(this._leftFilter.biquad.type),this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.rightDelay),this._rightFilter.output.connect(this.leftDelay);break;default:this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.leftDelay),this._rightFilter.output.connect(this.rightDelay)}}},{key:"dispose",value:function(){de(ye(e.prototype),"dispose",this).call(this),this._split.disconnect(),this._leftFilter.dispose(),this._rightFilter.dispose(),this._merge.disconnect(),this._leftGain.disconnect(),this._rightGain.disconnect(),this.leftDelay.disconnect(),this.rightDelay.disconnect(),this._split=void 0,this._leftFilter=void 0,this._rightFilter=void 0,this._merge=void 0,this._leftGain=void 0,this._rightGain=void 0,this.leftDelay=void 0,this.rightDelay=void 0}}]),e}();function _e(t){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function be(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Te(t,e,n){return e&&be(t.prototype,e),n&&be(t,n),t}function we(t,e){return!e||"object"!==_e(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function xe(t,e,n){return(xe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Se(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Se(t){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ke(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pe(t,e)}function Pe(t,e){return(Pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ae=function(){function e(){var t;return ge(this,e),(t=we(this,Se(e).call(this)))._initConvolverNode(),t.input.gain.value=.5,t._seconds=3,t._decay=2,t._reverse=!1,t._buildImpulse(),t}return ke(e,Ct),Te(e,[{key:"_initConvolverNode",value:function(){this.convolverNode=this.ac.createConvolver(),this.input.connect(this.convolverNode),this.convolverNode.connect(this.wet)}},{key:"_teardownConvolverNode",value:function(){this.convolverNode&&(this.convolverNode.disconnect(),delete this.convolverNode)}},{key:"_setBuffer",value:function(t){this._teardownConvolverNode(),this._initConvolverNode(),this.convolverNode.buffer=t}},{key:"process",value:function(t,e,n,i){t.connect(this.input);var r=!1;e&&(this._seconds=e,r=!0),n&&(this._decay=n),i&&(this._reverse=i),r&&this._buildImpulse()}},{key:"set",value:function(t,e,n){var i=!1;t&&(this._seconds=t,i=!0),e&&(this._decay=e),n&&(this._reverse=n),i&&this._buildImpulse()}},{key:"_buildImpulse",value:function(){var t,e,n=this.ac.sampleRate,i=n*this._seconds,r=this._decay,o=this.ac.createBuffer(2,i,n),s=o.getChannelData(0),a=o.getChannelData(1);for(e=0;e<i;e++)t=this._reverse?i-e:e,s[e]=(2*Math.random()-1)*Math.pow(1-t/i,r),a[e]=(2*Math.random()-1)*Math.pow(1-t/i,r);this._setBuffer(o)}},{key:"dispose",value:function(){xe(Se(e.prototype),"dispose",this).call(this),this._teardownConvolverNode()}}]),e}(),Oe=function(){function r(t,e,n){var i;return ge(this,r),(i=we(this,Se(r).call(this)))._initConvolverNode(),i.input.gain.value=.5,t?(i.impulses=[],i._loadBuffer(t,e,n)):(i._seconds=3,i._decay=2,i._reverse=!1,i._buildImpulse()),i.impulses=[],i.set=null,i}return ke(r,Ae),Te(r,[{key:"_loadBuffer",value:function(t,i,n){var r=p5.prototype._checkFileFormats(t),o=this,s=(new Error).stack,a=Object(c.b)(),u=new XMLHttpRequest;u.open("GET",r,!0),u.responseType="arraybuffer",u.onload=function(){if(200===u.status)a.decodeAudioData(u.response,function(t){var e={},n=r.split("/");e.name=n[n.length-1],e.audioBuffer=t,o.impulses.push(e),o._setBuffer(e.audioBuffer),i&&i(e)},function(){var t=new m("decodeAudioData",s,o.url),e="AudioContext error at decodeAudioData for "+o.url;n&&(t.msg=e,n(t))});else{var t=new m("loadConvolver",s,o.url),e="Unable to load "+o.url+". The request status was: "+u.status+" ("+u.statusText+")";n&&(t.message=e,n(t))}},u.onerror=function(){var t=new m("loadConvolver",s,o.url),e="There was no response from the server at "+o.url+". Check the url and internet connectivity.";n&&(t.message=e,n(t))},u.send()}},{key:"process",value:function(t){t.connect(this.input)}},{key:"addImpulse",value:function(t,e,n){-1<window.location.origin.indexOf("file://")&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this._loadBuffer(t,e,n)}},{key:"resetImpulse",value:function(t,e,n){-1<window.location.origin.indexOf("file://")&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this.impulses=[],this._loadBuffer(t,e,n)}},{key:"toggleImpulse",value:function(t){if("number"==typeof t&&t<this.impulses.length&&this._setBuffer(this.impulses[t].audioBuffer),"string"==typeof t)for(var e=0;e<this.impulses.length;e++)if(this.impulses[e].name===t){this._setBuffer(this.impulses[e].audioBuffer);break}}},{key:"dispose",value:function(){for(var t in xe(Se(r.prototype),"dispose",this).call(this),this.impulses)this.impulses[t]&&(this.impulses[t]=null)}}]),r}();var Ce=n(11),Re=n.n(Ce);function qe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ee=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clock=new Re.a({callback:this.ontick.bind(this)}),this.syncedParts=[],this.bpm=120,this._init(),this.prevTick=0,this.tatumTime=0,this.tickCallback=function(){}}return function(t,e,n){e&&qe(t.prototype,e),n&&qe(t,n)}(t,[{key:"ontick",value:function(t){var e=t-this.prevTick,i=t-p.audiocontext.currentTime;if(!(e-this.tatumTime<=-.02)){this.prevTick=t;var r=this;this.syncedParts.forEach(function(t){t.isPlaying&&(t.incrementStep(i),t.phrases.forEach(function(t){var e=t.sequence,n=r.metroTicks%e.length;0!==e[n]&&(r.metroTicks<e.length||!t.looping)&&t.callback(i,e[n])}))}),this.metroTicks+=1,this.tickCallback(i)}}},{key:"setBPM",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:0,i=60/(t*this.tatums),r=p.audiocontext.currentTime;this.tatumTime=i,this.clock.frequency.setValueAtTime(this.clock.frequency.value,r),this.clock.frequency.linearRampToValueAtTime(t,r+n),this.bpm=t}},{key:"getBPM",value:function(){return this.clock.getRate()/this.tatums*60}},{key:"_init",value:function(){this.metroTicks=0}},{key:"resetSync",value:function(t){this.syncedParts=[t]}},{key:"pushSync",value:function(t){this.syncedParts.push(t)}},{key:"start",value:function(t){var e=t||0,n=p.audiocontext.currentTime;this.clock.start(n+e),this.setBPM(this.bpm)}},{key:"stop",value:function(t){var e=t||0,n=p.audiocontext.currentTime;this.clock.stop(n+e)}},{key:"beatLength",value:function(t){this.tatums=1/t/4}}]),t}();function Ne(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Be(t,e,n){return e&&Ne(t.prototype,e),n&&Ne(t,n),t}function Ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var je=120;p5.prototype.setBPM=function(t,e){for(var n in je=t,p.parts)p.parts[n]&&p.parts[n].setBPM(t,e)};function Me(t,e,n){Ve(this,Me),this.phraseStep=0,this.name=t,this.callback=e,this.sequence=n}var Fe=function(){function n(t,e){Ve(this,n),this.length=t||0,this.partStep=0,this.phrases=[],this.isPlaying=!1,this.noLoop(),this.tatums=e||.0625,this.metro=new Ee,this.metro._init(),this.metro.beatLength(this.tatums),this.metro.setBPM(je),p.parts.push(this),this.callback=function(){}}return Be(n,[{key:"setBPM",value:function(t,e){this.metro.setBPM(t,e)}},{key:"getBPM",value:function(){return this.metro.getBPM()}},{key:"start",value:function(t){if(!this.isPlaying){this.isPlaying=!0,this.metro.resetSync(this);var e=t||0;this.metro.start(e)}}},{key:"loop",value:function(t){this.looping=!0,this.onended=function(){this.partStep=0};var e=t||0;this.start(e)}},{key:"noLoop",value:function(){this.looping=!1,this.onended=function(){this.stop()}}},{key:"stop",value:function(t){this.partStep=0,this.pause(t)}},{key:"pause",value:function(t){this.isPlaying=!1;var e=t||0;this.metro.stop(e)}},{key:"addPhrase",value:function(t,e,n){var i;if(3===arguments.length)i=new Me(t,e,n);else{if(!(t instanceof Me))throw"invalid input. addPhrase accepts name, callback, array or a p5.Phrase";i=t}this.phrases.push(i),i.sequence.length>this.length&&(this.length=i.sequence.length)}},{key:"removePhrase",value:function(t){for(var e in this.phrases)this.phrases[e].name===t&&this.phrases.splice(e,1)}},{key:"getPhrase",value:function(t){for(var e in this.phrases)if(this.phrases[e].name===t)return this.phrases[e]}},{key:"replaceSequence",value:function(t,e){for(var n in this.phrases)this.phrases[n].name===t&&(this.phrases[n].sequence=e)}},{key:"incrementStep",value:function(t){this.partStep<this.length-1?(this.callback(t),this.partStep+=1):this.looping||this.partStep!==this.length-1||this.onended()}},{key:"onStep",value:function(t){this.callback=t}}]),n}(),De=function(){function n(){Ve(this,n),this.parts=[],this.currentPart=new Array(arguments.length);var t=this;for(var e in arguments)this.parts[e]=arguments[e],this.parts[e].nextPart=this.parts[e+1],this.parts[e].onended=function(){t.resetPart(e),Ie(t)};this.looping=!1}return Be(n,[{key:"onended",value:function(){this.looping?this.parts[0].start():this.parts[this.parts.length-1].onended=function(){this.stop(),this.resetParts()},this.currentPart=0}},{key:"start",value:function(){this.parts[this.currentPart].start(),this.scoreStep=0}},{key:"stop",value:function(){this.parts[this.currentPart].stop(),this.currentPart=0,this.scoreStep=0}},{key:"pause",value:function(){this.parts[this.currentPart].stop()}},{key:"loop",value:function(){this.looping=!0,this.start()}},{key:"noLoop",value:function(){this.looping=!1}},{key:"resetParts",value:function(){var e=this;this.parts.forEach(function(t){e.resetParts[t]})}},{key:"resetPart",value:function(t){for(var e in this.parts[t].stop(),this.parts[t].partStep=0,this.parts[t].phrases)this.parts[t]&&(this.parts[t].phrases[e].phraseStep=0)}},{key:"setBPM",value:function(t,e){for(var n in this.parts)this.parts[n]&&this.parts[n].setBPM(t,e)}}]),n}();function Ie(t){t.currentPart++,t.currentPart>=t.parts.length?(t.scoreStep=0,t.onended()):(t.scoreStep=0,t.parts[t.currentPart-1].stop(),t.parts[t.currentPart].start())}function Ue(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ge=function(){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),Object.defineProperty(this,"bpm",{get:function(){return this._bpm},set:function(t){this.musicalTimeMode,this._bpm=t,this._update()}}),Object.defineProperty(this,"timeSignature",{get:function(){return this._timeSignature},set:function(t){this.musicalTimeMode,this._timeSignature=t,this._update()}}),Object.defineProperty(this,"interval",{get:function(){return this._interval},set:function(t){this.musicalTimeMode="number"!=typeof t,this._interval=t,this._update()}}),Object.defineProperty(this,"iterations",{get:function(){return this.clock.ticks}}),this.callback=t,this.musicalTimeMode="number"!=typeof this._interval,this._interval=e||1,this._timeSignature=4,this._bpm=60,this.isPlaying=!1,this.maxIterations=1/0;var n=this;this.clock=new Re.a({callback:function(t){var e=t-p.audiocontext.currentTime;0<e&&n.iterations<=n.maxIterations&&n.callback(e)},frequency:this._calcFreq()})}return function(t,e,n){e&&Ue(t.prototype,e),n&&Ue(t,n)}(i,[{key:"start",value:function(t){var e=t||0,n=p.audiocontext.currentTime;this.isPlaying||(this.clock.start(n+e),this.isPlaying=!0)}},{key:"stop",value:function(t){var e=t||0,n=p.audiocontext.currentTime;this.isPlaying&&(this.clock.stop(n+e),this.isPlaying=!1)}},{key:"pause",value:function(t){var e=t||0,n=p.audiocontext.currentTime;this.isPlaying&&(this.clock.pause(n+e),this.isPlaying=!1)}},{key:"syncedStart",value:function(t,e){var n=e||0,i=p.audiocontext.currentTime;if(t.isPlaying){if(t.isPlaying){var r=t.clock._nextTick-p.audiocontext.currentTime;this.clock.start(i+r),this.isPlaying=!0}}else t.clock.start(i+n),t.isPlaying=!0,this.clock.start(i+n),this.isPlaying=!0}},{key:"_update",value:function(){this.clock.frequency.value=this._calcFreq()}},{key:"_calcFreq",value:function(){return"number"==typeof this._interval?(this.musicalTimeMode=!1,1/this._interval):"string"==typeof this._interval?(this.musicalTimeMode=!0,this._bpm/60/this._convertNotation(this._interval)*(this._timeSignature/4)):void 0}},{key:"_convertNotation",value:function(t){var e=t.slice(-1);switch(t=Number(t.slice(0,-1)),e){case"m":return this._measure(t);case"n":return this._note(t)}}},{key:"_measure",value:function(t){return t*this._timeSignature}},{key:"_note",value:function(t){return this._timeSignature/t}}]),i}();function Le(t){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ze(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function We(t,e){return!e||"object"!==Le(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Ze(t,e,n){return(Ze="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xe(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Xe(t){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ye(t,e){return(Ye=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var He=function(){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=We(this,Xe(e).call(this))).compressor=t.ac.createDynamicsCompressor(),t.input.connect(t.compressor),t.compressor.connect(t.wet),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ye(t,e)}(e,Ct),function(t,e,n){e&&ze(t.prototype,e),n&&ze(t,n)}(e,[{key:"process",value:function(t,e,n,i,r,o){t.connect(this.input),this.set(e,n,i,r,o)}},{key:"set",value:function(t,e,n,i,r){void 0!==t&&this.attack(t),void 0!==e&&this.knee(e),void 0!==n&&this.ratio(n),void 0!==i&&this.threshold(i),void 0!==r&&this.release(r)}},{key:"attack",value:function(t,e){var n=e||0;return"number"==typeof t?(this.compressor.attack.value=t,this.compressor.attack.cancelScheduledValues(this.ac.currentTime+.01+n),this.compressor.attack.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):void 0!==t&&t.connect(this.compressor.attack),this.compressor.attack.value}},{key:"knee",value:function(t,e){var n=e||0;return"number"==typeof t?(this.compressor.knee.value=t,this.compressor.knee.cancelScheduledValues(this.ac.currentTime+.01+n),this.compressor.knee.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):void 0!==t&&t.connect(this.compressor.knee),this.compressor.knee.value}},{key:"ratio",value:function(t,e){var n=e||0;return"number"==typeof t?(this.compressor.ratio.value=t,this.compressor.ratio.cancelScheduledValues(this.ac.currentTime+.01+n),this.compressor.ratio.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):void 0!==t&&t.connect(this.compressor.ratio),this.compressor.ratio.value}},{key:"threshold",value:function(t,e){var n=e||0;return"number"==typeof t?(this.compressor.threshold.value=t,this.compressor.threshold.cancelScheduledValues(this.ac.currentTime+.01+n),this.compressor.threshold.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):void 0!==t&&t.connect(this.compressor.threshold),this.compressor.threshold.value}},{key:"release",value:function(t,e){var n=e||0;return"number"==typeof t?(this.compressor.release.value=t,this.compressor.release.cancelScheduledValues(this.ac.currentTime+.01+n),this.compressor.release.linearRampToValueAtTime(t,this.ac.currentTime+.02+n)):"undefined"!=typeof number&&t.connect(this.compressor.release),this.compressor.release.value}},{key:"reduction",value:function(){return this.compressor.reduction.value}},{key:"dispose",value:function(){Ze(Xe(e.prototype),"dispose",this).call(this),this.compressor&&(this.compressor.disconnect(),delete this.compressor)}}]),e}();function $e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Qe=function(){function r(t,e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.framesPerPeak=i||20,this.framesSinceLastPeak=0,this.decayRate=.95,this.threshold=n||.35,this.cutoff=0,this.cutoffMult=1.5,this.energy=0,this.penergy=0,this.currentValue=0,this.isDetected=!1,this.f1=t||40,this.f2=e||2e4,this._onPeak=function(){}}return function(t,e,n){e&&$e(t.prototype,e),n&&$e(t,n)}(r,[{key:"update",value:function(t){var e=this.energy=t.getEnergy(this.f1,this.f2)/255;e>this.cutoff&&e>this.threshold&&0<e-this.penergy?(this._onPeak(),this.isDetected=!0,this.cutoff=e*this.cutoffMult,this.framesSinceLastPeak=0):(this.isDetected=!1,this.framesSinceLastPeak<=this.framesPerPeak?this.framesSinceLastPeak++:(this.cutoff*=this.decayRate,this.cutoff=Math.max(this.cutoff,this.threshold))),this.currentValue=e,this.penergy=e}},{key:"onPeak",value:function(t,e){var n=this;n._onPeak=function(){t(n.energy,e)}}}]),r}();function Je(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ke=p.audiocontext,tn=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.input=Ke.createGain(),this.output=Ke.createGain(),this._inputChannels=2,this._outputChannels=2;var t=y(1024);this._workletNode=new AudioWorkletNode(Ke,s.a.recorderProcessor,{outputChannelCount:[this._outputChannels],processorOptions:{numInputChannels:this._inputChannels,bufferSize:t}}),this._workletNode.port.onmessage=function(t){if("buffers"===t.data.name){var e=[new Float32Array(t.data.leftBuffer),new Float32Array(t.data.rightBuffer)];this._callback(e)}}.bind(this),this._callback=function(){},this._workletNode.connect(p5.soundOut._silentNode),this.setInput(),p.soundArray.push(this)}return function(t,e,n){e&&Je(t.prototype,e),n&&Je(t,n)}(e,[{key:"setInput",value:function(t){this.input.disconnect(),this.input=null,this.input=Ke.createGain(),this.input.connect(this._workletNode),this.input.connect(this.output),t?t.connect(this.input):p5.soundOut.output.connect(this.input)}},{key:"record",value:function(e,t,n){this._workletNode.port.postMessage({name:"start",duration:t}),e&&n?this._callback=function(t){e.setBuffer(t),n()}:e&&(this._callback=function(t){e.setBuffer(t)})}},{key:"stop",value:function(){this._workletNode.port.postMessage({name:"stop"})}},{key:"dispose",value:function(){var t=p.soundArray.indexOf(this);p.soundArray.splice(t,1),this._callback=function(){},this.input&&this.input.disconnect(),this.input=null,this._workletNode=null}}]),e}();function en(t){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function rn(t,e){return!e||"object"!==en(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function on(t,e,n){return(on="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sn(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function sn(t){return(sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function an(t,e){return(an=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function un(t){for(var e,n="number"==typeof t?t:50,i=new Float32Array(44100),r=Math.PI/180,o=0;o<44100;++o)e=2*o/44100-1,i[o]=(3+n)*e*20*r/(Math.PI+n*Math.abs(e));return i}var cn=function(){function r(t,e){var n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),n=rn(this,sn(r).call(this)),void 0===t&&(t=.25),"number"!=typeof t)throw new Error("amount must be a number");if(void 0===e&&(e="2x"),"string"!=typeof e)throw new Error("oversample must be a String");var i=p5.prototype.map(t,0,1,0,2e3);return n.waveShaperNode=n.ac.createWaveShaper(),n.amount=i,n.waveShaperNode.curve=un(i),n.waveShaperNode.oversample=e,n.input.connect(n.waveShaperNode),n.waveShaperNode.connect(n.wet),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&an(t,e)}(r,Ct),function(t,e,n){e&&nn(t.prototype,e),n&&nn(t,n)}(r,[{key:"process",value:function(t,e,n){t.connect(this.input),this.set(e,n)}},{key:"set",value:function(t,e){if(t){var n=p5.prototype.map(t,0,1,0,2e3);this.amount=n,this.waveShaperNode.curve=un(n)}e&&(this.waveShaperNode.oversample=e)}},{key:"getAmount",value:function(){return this.amount}},{key:"getOversample",value:function(){return this.waveShaperNode.oversample}},{key:"dispose",value:function(){on(sn(r.prototype),"dispose",this).call(this),this.waveShaperNode&&(this.waveShaperNode.disconnect(),this.waveShaperNode=null)}}]),r}();function ln(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var hn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ac=p.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.output),p.soundArray.push(this)}return function(t,e,n){e&&ln(t.prototype,e),n&&ln(t,n)}(t,[{key:"setInput",value:function(t){t.connect(this.input)}},{key:"connect",value:function(t){var e=t||p5.soundOut.input;this.output.connect(e.input?e.input:e)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"amp",value:function(t,e,n){var i=1<arguments.length&&void 0!==e?e:0,r=2<arguments.length&&void 0!==n?n:0,o=p.audiocontext.currentTime,s=this.output.gain.value;this.output.gain.cancelScheduledValues(o),this.output.gain.linearRampToValueAtTime(s,o+r),this.output.gain.linearRampToValueAtTime(t,o+r+i)}},{key:"dispose",value:function(){var t=p.soundArray.indexOf(this);p.soundArray.splice(t,1),this.output&&(this.output.disconnect(),delete this.output),this.input&&(this.input.disconnect(),delete this.input)}}]),t}();function pn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var fn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ac=p.audiocontext,this.output=this.ac.createGain(),this.connect(),p.soundArray.push(this)}return function(t,e,n){e&&pn(t.prototype,e),n&&pn(t,n)}(t,[{key:"play",value:function(t,e,n,i){}},{key:"triggerAttack",value:function(t,e,n){}},{key:"triggerRelease",value:function(t){}},{key:"amp",value:function(t,e){}},{key:"connect",value:function(t){var e=t||p.input;this.output.connect(e.input?e.input:e)}},{key:"disconnect",value:function(){this.output.disconnect()}},{key:"dispose",value:function(){this.output&&(this.output.disconnect(),delete this.output)}}]),t}();function dn(t){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function mn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vn(t,e,n){return(vn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_n(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function _n(t){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gn(t,e){return(gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bn=function(){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e){return!e||"object"!==dn(e)&&"function"!=typeof e?mn(t):e}(this,_n(e).call(this))).oscillator=new nt,t.env=new ot,t.env.setRange(1,0),t.env.setExp(!0),t.setADSR(.02,.25,.05,.35),t.oscillator.disconnect(),t.oscillator.connect(t.output),t.env.disconnect(),t.env.setInput(t.output.gain),t.oscillator.output.gain.value=1,t.oscillator.start(),t.connect(),p.soundArray.push(mn(t)),Object.defineProperties(mn(t),{attack:{get:function(){return this.env.aTime},set:function(t){this.env.setADSR(t,this.env.dTime,this.env.sPercent,this.env.rTime)}},decay:{get:function(){return this.env.dTime},set:function(t){this.env.setADSR(this.env.aTime,t,this.env.sPercent,this.env.rTime)}},sustain:{get:function(){return this.env.sPercent},set:function(t){this.env.setADSR(this.env.aTime,this.env.dTime,t,this.env.rTime)}},release:{get:function(){return this.env.rTime},set:function(t){this.env.setADSR(this.env.aTime,this.env.dTime,this.env.sPercent,t)}}}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gn(t,e)}(e,fn),function(t,e,n){e&&yn(t.prototype,e),n&&yn(t,n)}(e,[{key:"play",value:function(t,e,n,i){this.triggerAttack(t,e,~~n),this.triggerRelease(~~n+(i||.15))}},{key:"triggerAttack",value:function(t,e,n){var i=2<arguments.length&&void 0!==n?n:0,r=h(t),o=e||.1;this.oscillator.freq(r,0,i),this.env.ramp(this.output.gain,i,o)}},{key:"triggerRelease",value:function(t){var e=0<arguments.length&&void 0!==t?t:0;this.env.ramp(this.output.gain,e,0)}},{key:"setADSR",value:function(t,e,n,i){this.env.setADSR(t,e,n,i)}},{key:"amp",value:function(t,e){var n=e||0;return void 0!==t&&this.oscillator.amp(t,n),this.oscillator.amp().value}},{key:"connect",value:function(t){var e=t||p.input;this.output.connect(e.input?e.input:e)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){vn(_n(e.prototype),"dispose",this).call(this),this.env&&this.env.dispose(),this.oscillator&&this.oscillator.dispose()}}]),e}();function Tn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var wn=function(){function r(t,e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.isDetected=!1,this.freqLow=t,this.freqHigh=e,this.treshold=n,this.energy=0,this.penergy=0,this.sensitivity=500,this.callback=i}return function(t,e,n){e&&Tn(t.prototype,e),n&&Tn(t,n)}(r,[{key:"update",value:function(t,e){if(this.energy=t.getEnergy(this.freqLow,this.freqHigh)/255,!1===this.isDetected&&this.energy-this.penergy>this.treshold){this.isDetected=!0,this.callback?this.callback(this.energy):e&&e(this.energy);var n=this;setTimeout(function(){n.isDetected=!1},this.sensitivity)}this.penergy=this.energy}}]),r}();function xn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Sn=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.audiovoices=[],this.notes={},this._newest=0,this._oldest=0,this.maxVoices=e||8,this.AudioVoice=void 0===t?p5.MonoSynth:t,this._voicesInUse=new rt.a(0),this.output=p.audiocontext.createGain(),this.connect(),this._allocateVoices(),p.soundArray.push(this)}return function(t,e,n){e&&xn(t.prototype,e),n&&xn(t,n)}(n,[{key:"_allocateVoices",value:function(){for(var t=0;t<this.maxVoices;t++)this.audiovoices.push(new this.AudioVoice),this.audiovoices[t].disconnect(),this.audiovoices[t].connect(this.output)}},{key:"play",value:function(t,e,n,i){var r=3<arguments.length&&void 0!==i?i:1;this.noteAttack(t,e,n),this.noteRelease(t,n+r)}},{key:"noteADSR",value:function(t,e,n,i,r,o){var s=5<arguments.length&&void 0!==o?o:0,a=p.audiocontext.currentTime+s;this.audiovoices[this.notes[t].getValueAtTime(a)].setADSR(e,n,i,r)}},{key:"setADSR",value:function(e,n,i,r){this.audiovoices.forEach(function(t){t.setADSR(e,n,i,r)})}},{key:"noteAttack",value:function(t,e,n){var i,r=2<arguments.length&&void 0!==n?n:0,o=p.audiocontext.currentTime+r,s=h(t),a=e||.1;this.notes[s]&&null!==this.notes[s].getValueAtTime(o)&&this.noteRelease(s,0),this._voicesInUse.getValueAtTime(o)<this.maxVoices?i=Math.max(~~this._voicesInUse.getValueAtTime(o),0):(i=this._oldest,oldestNote=l(this.audiovoices[this._oldest].oscillator.freq().value),this.noteRelease(oldestNote),this._oldest=(this._oldest+1)%(this.maxVoices-1)),this.notes[s]=new rt.a,this.notes[s].setValueAtTime(i,o);var u=null===this._voicesInUse._searchBefore(o)?0:this._voicesInUse._searchBefore(o).value;if(this._voicesInUse.setValueAtTime(u+1,o),this._updateAfter(o,1),this._newest=i,"number"==typeof a){var c=1/this._voicesInUse.getValueAtTime(o)*2;a=c<a?c:a}this.audiovoices[i].triggerAttack(s,a,r)}},{key:"_updateAfter",value:function(t,e){if(null!==this._voicesInUse._searchAfter(t)){this._voicesInUse._searchAfter(t).value+=e;var n=this._voicesInUse._searchAfter(t).time;this._updateAfter(n,e)}}},{key:"noteRelease",value:function(t,e){var n=p.audiocontext.currentTime,i=e||0,r=n+i;if(t){var o=h(t);if(this.notes[o]&&null!==this.notes[o].getValueAtTime(r)){var s=Math.max(~~this._voicesInUse.getValueAtTime(r).value,1);this._voicesInUse.setValueAtTime(s-1,r),0<s&&this._updateAfter(r,-1),this.audiovoices[this.notes[o].getValueAtTime(r)].triggerRelease(i),this.notes[o].dispose(),delete this.notes[o],this._newest=0===this._newest?0:(this._newest-1)%(this.maxVoices-1)}else;}else for(var a in this.audiovoices.forEach(function(t){t.triggerRelease(i)}),this._voicesInUse.setValueAtTime(0,r),this.notes)this.notes[a].dispose(),delete this.notes[a]}},{key:"connect",value:function(t){var e=t||p.input;this.output.connect(e.input?e.input:e)}},{key:"disconnect",value:function(){this.output&&this.output.disconnect()}},{key:"dispose",value:function(){this.audiovoices.forEach(function(t){t.dispose()}),this.output&&(this.output.disconnect(),delete this.output)}}]),n}();function kn(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,kn)}p5.prototype.getAudioContext=c.b,p5.prototype.userStartAudio=c.c,p5.prototype.sampleRate=function(){return p.audiocontext.sampleRate},p5.prototype.freqToMidi=l,p5.prototype.midiToFreq=r,p5.prototype.noteToFreq=h,p5.prototype.soundFormats=function(){p.extensions=[];for(var t=0;t<arguments.length;t++){if(arguments[t]=arguments[t].toLowerCase(),!(-1<["mp3","wav","ogg","m4a","aac"].indexOf(arguments[t])))throw arguments[t]+" is not a valid sound format!";p.extensions.push(arguments[t])}},p5.prototype.disposeSound=function(){for(var t=0;t<p.soundArray.length;t++)p.soundArray[t].dispose()},p5.prototype._checkFileFormats=function(t){var e;if("string"==typeof t){var n=(e=t).split(".").pop();if(-1<["mp3","wav","ogg","m4a","aac"].indexOf(n)){if(!p5.prototype.isFileSupported(n))for(var i=e.split("."),r=i[i.length-1],o=0;o<p.extensions.length;o++){var s=p.extensions[o];if(p5.prototype.isFileSupported(s)){r="",2===i.length&&(r+=i[0]);for(var a=1;a<=i.length-2;a++){r+="."+i[a]}e=r+=".",e=e+=s;break}}}else for(var u=0;u<p.extensions.length;u++){var c=p.extensions[u];if(p5.prototype.isFileSupported(c)){e=e+"."+c;break}}}else if("object"===f(t))for(var l=0;l<t.length;l++){var h=t[l].split(".").pop();if(p5.prototype.isFileSupported(h)){e=t[l];break}}return e},p5.prototype._mathChain=function(t,e,n,i,r){for(var o in t.mathOps)t.mathOps[o]instanceof r&&(t.mathOps[o].dispose(),(n=o)<t.mathOps.length-1&&(i=t.mathOps[o+1]));return t.mathOps[n-1].disconnect(),t.mathOps[n-1].connect(e),e.connect(i),t.mathOps[n]=e,t},p5.prototype.convertToWav=a,p5.prototype.interleave=u,p5.prototype.writeUTFBytes=d,p5.prototype.safeBufferSize=y,p5.prototype.saveSound=function(t,e){var n=a(t.buffer);p5.prototype.writeFile([n],e,"wav")},p5.prototype.registerMethod("remove",p5.prototype.disposeSound),p5.Panner=k,p5.SoundFile=E,p5.prototype.loadSound=function(t,e,n,i){-1<window.location.origin.indexOf("file://")&&"undefined"===window.cordova&&window.alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var r=this;return new q(t,function(){"function"==typeof e&&e.apply(r,arguments),"function"==typeof r._decrementPreload&&r._decrementPreload()},n,i)},p5.prototype.registerPreloadMethod("loadSound",p5.prototype),p5.Amplitude=B,p5.FFT=j,p5.Oscillator=nt,p5.SinOsc=J,p5.TriOsc=K,p5.SawOsc=tt,p5.SqrOsc=et,p5.Noise=dt,p5.Pulse=xt,p5.AudioIn=kt,p5.Effect=Ct,p5.Filter=Gt,p5.LowPass=Dt,p5.HighPass=It,p5.BandPass=Ut,p5.EQ=ee,p5.listener3D=ie,p5.Panner3D=le,p5.Delay=ve,p5.Reverb=Ae,p5.Convolver=Oe,p5.prototype.createConvolver=function(t,e,n){-1<window.location.origin.indexOf("file://")&&"undefined"===window.cordova&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var i=this,r=new Oe(t,function(t){"function"==typeof e&&e(t),"function"==typeof i._decrementPreload&&i._decrementPreload()},n);return r.impulses=[],r},p5.prototype.registerPreloadMethod("createConvolver",p5.prototype),p5.Metro=Ee,p5.Phrase=Me,p5.Part=Fe,p5.Score=De,p5.SoundLoop=Ge,p5.Compressor=He,p5.peakDetect=Qe,p5.SoundRecorder=tn,p5.Distortion=cn,p5.Gain=hn,p5.AudioVoice=fn,p5.MonoSynth=bn,p5.OnsetDetect=wn,p5.PolySynth=Sn,p5.PeakDetect=Qe,p5.Signal=kn}]);!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).planck={})}(this,function(t){"use strict";var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,i)};function i(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}var o=function(){return(o=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)},s=function(t,e){null==t&&(t={});var i=o({},t);for(var s in e)e.hasOwnProperty(s)&&void 0===t[s]&&(i[s]=e[s]);if("function"==typeof Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(e),r=0;r<n.length;r++){var a=n[r];e.propertyIsEnumerable(a)&&void 0===t[a]&&(i[a]=e[a])}return i},n=Math.random,r=1e-9,a=Number.isFinite;function m(t,e,i){return void 0===e?(i=1,e=0):void 0===i&&(i=e,e=0),i>e?(t=(t-e)%(i-e))+(t<0?i:e):(t=(t-i)%(e-i))+(t<=0?e:i)}function h(t,e,i){return t<e?e:t>i?i:t}var c=Object.create(Math);c.EPSILON=r,c.isFinite=a,c.nextPowerOfTwo=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},c.isPowerOfTwo=function(t){return t>0&&0==(t&t-1)},c.mod=m,c.clamp=h,c.random=function(t,e){return void 0===t?(e=1,t=0):void 0===e&&(e=t,t=0),t===e?t:n()*(e-t)+t};var _=Math.abs,l=Math.sqrt,u=Math.max,p=Math.min,y=function(){function t(e,i){if(!(this instanceof t))return new t(e,i);void 0===e?(this.x=0,this.y=0):"object"==typeof e?(this.x=e.x,this.y=e.y):(this.x=e,this.y=i)}return t.prototype._serialize=function(){return{x:this.x,y:this.y}},t._deserialize=function(e){var i=Object.create(t.prototype);return i.x=e.x,i.y=e.y,i},t.zero=function(){var e=Object.create(t.prototype);return e.x=0,e.y=0,e},t.neo=function(e,i){var o=Object.create(t.prototype);return o.x=e,o.y=i,o},t.clone=function(e){return t.neo(e.x,e.y)},t.prototype.toString=function(){return JSON.stringify(this)},t.isValid=function(t){return null!=t&&(Number.isFinite(t.x)&&Number.isFinite(t.y))},t.assert=function(t){},t.prototype.clone=function(){return t.clone(this)},t.prototype.setZero=function(){return this.x=0,this.y=0,this},t.prototype.set=function(t,e){return"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),this},t.prototype.setNum=function(t,e){return this.x=t,this.y=e,this},t.prototype.setVec2=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.wSet=function(t,e,i,o){return void 0!==i||void 0!==o?this.setCombine(t,e,i,o):this.setMul(t,e)},t.prototype.setCombine=function(t,e,i,o){var s=t*e.x+i*o.x,n=t*e.y+i*o.y;return this.x=s,this.y=n,this},t.prototype.setMul=function(t,e){var i=t*e.x,o=t*e.y;return this.x=i,this.y=o,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.wAdd=function(t,e,i,o){return void 0!==i||void 0!==o?this.addCombine(t,e,i,o):this.addMul(t,e)},t.prototype.addCombine=function(t,e,i,o){var s=t*e.x+i*o.x,n=t*e.y+i*o.y;return this.x+=s,this.y+=n,this},t.prototype.addMul=function(t,e){var i=t*e.x,o=t*e.y;return this.x+=i,this.y+=o,this},t.prototype.wSub=function(t,e,i,o){return void 0!==i||void 0!==o?this.subCombine(t,e,i,o):this.subMul(t,e)},t.prototype.subCombine=function(t,e,i,o){var s=t*e.x+i*o.x,n=t*e.y+i*o.y;return this.x-=s,this.y-=n,this},t.prototype.subMul=function(t,e){var i=t*e.x,o=t*e.y;return this.x-=i,this.y-=o,this},t.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.mul=function(t){return this.x*=t,this.y*=t,this},t.prototype.length=function(){return t.lengthOf(this)},t.prototype.lengthSquared=function(){return t.lengthSquared(this)},t.prototype.normalize=function(){var t=this.length();if(t<r)return 0;var e=1/t;return this.x*=e,this.y*=e,t},t.lengthOf=function(t){return l(t.x*t.x+t.y*t.y)},t.lengthSquared=function(t){return t.x*t.x+t.y*t.y},t.distance=function(t,e){var i=t.x-e.x,o=t.y-e.y;return l(i*i+o*o)},t.distanceSquared=function(t,e){var i=t.x-e.x,o=t.y-e.y;return i*i+o*o},t.areEqual=function(t,e){return t===e||"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y},t.skew=function(e){return t.neo(-e.y,e.x)},t.dot=function(t,e){return t.x*e.x+t.y*e.y},t.cross=function(e,i){return"number"==typeof i?t.neo(i*e.y,-i*e.x):"number"==typeof e?t.neo(-e*i.y,e*i.x):e.x*i.y-e.y*i.x},t.crossVec2Vec2=function(t,e){return t.x*e.y-t.y*e.x},t.crossVec2Num=function(e,i){return t.neo(i*e.y,-i*e.x)},t.crossNumVec2=function(e,i){return t.neo(-e*i.y,e*i.x)},t.addCross=function(e,i,o){return"number"==typeof o?t.neo(o*i.y+e.x,-o*i.x+e.y):"number"==typeof i?t.neo(-i*o.y+e.x,i*o.x+e.y):void 0},t.addCrossVec2Num=function(e,i,o){return t.neo(o*i.y+e.x,-o*i.x+e.y)},t.addCrossNumVec2=function(e,i,o){return t.neo(-i*o.y+e.x,i*o.x+e.y)},t.add=function(e,i){return t.neo(e.x+i.x,e.y+i.y)},t.wAdd=function(e,i,o,s){return void 0!==o||void 0!==s?t.combine(e,i,o,s):t.mulNumVec2(e,i)},t.combine=function(e,i,o,s){return t.zero().setCombine(e,i,o,s)},t.sub=function(e,i){return t.neo(e.x-i.x,e.y-i.y)},t.mul=function(e,i){return"object"==typeof e?t.neo(e.x*i,e.y*i):"object"==typeof i?t.neo(e*i.x,e*i.y):void 0},t.mulVec2Num=function(e,i){return t.neo(e.x*i,e.y*i)},t.mulNumVec2=function(e,i){return t.neo(e*i.x,e*i.y)},t.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},t.neg=function(e){return t.neo(-e.x,-e.y)},t.abs=function(e){return t.neo(_(e.x),_(e.y))},t.mid=function(e,i){return t.neo(.5*(e.x+i.x),.5*(e.y+i.y))},t.upper=function(e,i){return t.neo(u(e.x,i.x),u(e.y,i.y))},t.lower=function(e,i){return t.neo(p(e.x,i.x),p(e.y,i.y))},t.prototype.clamp=function(t){var e=this.x*this.x+this.y*this.y;if(e>t*t){var i=t/l(e);this.x*=i,this.y*=i}return this},t.clamp=function(e,i){var o=t.neo(e.x,e.y);return o.clamp(i),o},t.scaleFn=function(e,i){return function(o){return t.neo(o.x*e,o.y*i)}},t.translateFn=function(e,i){return function(o){return t.neo(o.x+e,o.y+i)}},t}(),d=Math.max,f=Math.min,v=function(){function t(e,i){if(!(this instanceof t))return new t(e,i);this.lowerBound=y.zero(),this.upperBound=y.zero(),"object"==typeof e&&this.lowerBound.setVec2(e),"object"==typeof i?this.upperBound.setVec2(i):"object"==typeof e&&this.upperBound.setVec2(e)}return t.prototype.isValid=function(){return t.isValid(this)},t.isValid=function(t){return null!=t&&(y.isValid(t.lowerBound)&&y.isValid(t.upperBound)&&y.sub(t.upperBound,t.lowerBound).lengthSquared()>=0)},t.assert=function(t){},t.prototype.getCenter=function(){return y.neo(.5*(this.lowerBound.x+this.upperBound.x),.5*(this.lowerBound.y+this.upperBound.y))},t.prototype.getExtents=function(){return y.neo(.5*(this.upperBound.x-this.lowerBound.x),.5*(this.upperBound.y-this.lowerBound.y))},t.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},t.prototype.combine=function(t,e){e=e||this;var i=t.lowerBound,o=t.upperBound,s=e.lowerBound,n=e.upperBound,r=f(i.x,s.x),a=f(i.y,s.y),m=d(n.x,o.x),h=d(n.y,o.y);this.lowerBound.setNum(r,a),this.upperBound.setNum(m,h)},t.prototype.combinePoints=function(t,e){this.lowerBound.setNum(f(t.x,e.x),f(t.y,e.y)),this.upperBound.setNum(d(t.x,e.x),d(t.y,e.y))},t.prototype.set=function(t){this.lowerBound.setNum(t.lowerBound.x,t.lowerBound.y),this.upperBound.setNum(t.upperBound.x,t.upperBound.y)},t.prototype.contains=function(t){var e=!0;return e=(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},t.prototype.extend=function(e){return t.extend(this,e),this},t.extend=function(t,e){return t.lowerBound.x-=e,t.lowerBound.y-=e,t.upperBound.x+=e,t.upperBound.y+=e,t},t.testOverlap=function(t,e){var i=e.lowerBound.x-t.upperBound.x,o=t.lowerBound.x-e.upperBound.x,s=e.lowerBound.y-t.upperBound.y,n=t.lowerBound.y-e.upperBound.y;return!(i>0||s>0||o>0||n>0)},t.areEqual=function(t,e){return y.areEqual(t.lowerBound,e.lowerBound)&&y.areEqual(t.upperBound,e.upperBound)},t.diff=function(t,e){var i=d(0,f(t.upperBound.x,e.upperBound.x)-d(e.lowerBound.x,t.lowerBound.x)),o=d(0,f(t.upperBound.y,e.upperBound.y)-d(e.lowerBound.y,t.lowerBound.y));return(t.upperBound.x-t.lowerBound.x)*(t.upperBound.y-t.lowerBound.y)+(e.upperBound.x-e.lowerBound.x)*(e.upperBound.y-e.lowerBound.y)-i*o},t.prototype.rayCast=function(t,e){for(var i=-1/0,o=1/0,s=e.p1,n=y.sub(e.p2,e.p1),a=y.abs(n),m=y.zero(),h="x";null!==h;h="x"===h?"y":null)if(a.x<r){if(s[h]<this.lowerBound[h]||this.upperBound[h]<s[h])return!1}else{var c=1/n[h],_=(this.lowerBound[h]-s[h])*c,l=(this.upperBound[h]-s[h])*c,u=-1;if(_>l){var p=_;_=l,l=p,u=1}if(_>i&&(m.setZero(),m[h]=u,i=_),i>(o=f(o,l)))return!1}return!(i<0||e.maxFraction<i)&&(t.fraction=i,t.normal=m,!0)},t.prototype.toString=function(){return JSON.stringify(this)},t.combinePoints=function(t,e,i){return t.lowerBound.x=f(e.x,i.x),t.lowerBound.y=f(e.y,i.y),t.upperBound.x=d(e.x,i.x),t.upperBound.y=d(e.y,i.y),t},t.combinedPerimeter=function(t,e){var i=f(t.lowerBound.x,e.lowerBound.x),o=f(t.lowerBound.y,e.lowerBound.y);return 2*(d(t.upperBound.x,e.upperBound.x)-i+d(t.upperBound.y,e.upperBound.y)-o)},t}(),x=Math.PI,A=function(){function t(){}return Object.defineProperty(t,"polygonRadius",{get:function(){return 2*t.linearSlop},enumerable:!1,configurable:!0}),t.lengthUnitsPerMeter=1,t.maxManifoldPoints=2,t.maxPolygonVertices=12,t.aabbExtension=.1,t.aabbMultiplier=2,t.linearSlop=.005,t.angularSlop=2/180*x,t.maxSubSteps=8,t.maxTOIContacts=32,t.maxTOIIterations=20,t.maxDistanceIterations=20,t.velocityThreshold=1,t.maxLinearCorrection=.2,t.maxAngularCorrection=8/180*x,t.maxTranslation=2,t.maxRotation=.5*x,t.baumgarte=.2,t.toiBaugarte=.75,t.timeToSleep=.5,t.linearSleepTolerance=.01,t.angularSleepTolerance=2/180*x,t}(),g=function(){function t(){}return Object.defineProperty(t,"maxManifoldPoints",{get:function(){return A.maxManifoldPoints},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxPolygonVertices",{get:function(){return A.maxPolygonVertices},enumerable:!1,configurable:!0}),Object.defineProperty(t,"aabbExtension",{get:function(){return A.aabbExtension*A.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(t,"aabbMultiplier",{get:function(){return A.aabbMultiplier},enumerable:!1,configurable:!0}),Object.defineProperty(t,"linearSlop",{get:function(){return A.linearSlop*A.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(t,"linearSlopSquared",{get:function(){return A.linearSlop*A.lengthUnitsPerMeter*A.linearSlop*A.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(t,"angularSlop",{get:function(){return A.angularSlop},enumerable:!1,configurable:!0}),Object.defineProperty(t,"polygonRadius",{get:function(){return 2*A.linearSlop},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxSubSteps",{get:function(){return A.maxSubSteps},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxTOIContacts",{get:function(){return A.maxTOIContacts},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxTOIIterations",{get:function(){return A.maxTOIIterations},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxDistanceIterations",{get:function(){return A.maxDistanceIterations},enumerable:!1,configurable:!0}),Object.defineProperty(t,"velocityThreshold",{get:function(){return A.velocityThreshold*A.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxLinearCorrection",{get:function(){return A.maxLinearCorrection*A.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxAngularCorrection",{get:function(){return A.maxAngularCorrection},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxTranslation",{get:function(){return A.maxTranslation*A.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxTranslationSquared",{get:function(){return A.maxTranslation*A.lengthUnitsPerMeter*A.maxTranslation*A.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxRotation",{get:function(){return A.maxRotation},enumerable:!1,configurable:!0}),Object.defineProperty(t,"maxRotationSquared",{get:function(){return A.maxRotation*A.maxRotation},enumerable:!1,configurable:!0}),Object.defineProperty(t,"baumgarte",{get:function(){return A.baumgarte},enumerable:!1,configurable:!0}),Object.defineProperty(t,"toiBaugarte",{get:function(){return A.toiBaugarte},enumerable:!1,configurable:!0}),Object.defineProperty(t,"timeToSleep",{get:function(){return A.timeToSleep},enumerable:!1,configurable:!0}),Object.defineProperty(t,"linearSleepTolerance",{get:function(){return A.linearSleepTolerance*A.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(t,"linearSleepToleranceSqr",{get:function(){return A.linearSleepTolerance*A.lengthUnitsPerMeter*A.linearSleepTolerance*A.lengthUnitsPerMeter},enumerable:!1,configurable:!0}),Object.defineProperty(t,"angularSleepTolerance",{get:function(){return A.angularSleepTolerance},enumerable:!1,configurable:!0}),Object.defineProperty(t,"angularSleepToleranceSqr",{get:function(){return A.angularSleepTolerance*A.angularSleepTolerance},enumerable:!1,configurable:!0}),t}(),b=function(){function t(t){this._list=[],this._max=1/0,this._hasCreateFn=!1,this._createCount=0,this._hasAllocateFn=!1,this._allocateCount=0,this._hasReleaseFn=!1,this._releaseCount=0,this._hasDisposeFn=!1,this._disposeCount=0,this._list=[],this._max=t.max||this._max,this._createFn=t.create,this._hasCreateFn="function"==typeof this._createFn,this._allocateFn=t.allocate,this._hasAllocateFn="function"==typeof this._allocateFn,this._releaseFn=t.release,this._hasReleaseFn="function"==typeof this._releaseFn,this._disposeFn=t.dispose,this._hasDisposeFn="function"==typeof this._disposeFn}return t.prototype.max=function(t){return"number"==typeof t?(this._max=t,this):this._max},t.prototype.size=function(){return this._list.length},t.prototype.allocate=function(){var t;return this._list.length>0?t=this._list.shift():(this._createCount++,t=this._hasCreateFn?this._createFn():{}),this._allocateCount++,this._hasAllocateFn&&this._allocateFn(t),t},t.prototype.release=function(t){this._list.length<this._max?(this._releaseCount++,this._hasReleaseFn&&this._releaseFn(t),this._list.push(t)):(this._disposeCount++,this._hasDisposeFn&&(t=this._disposeFn(t)))},t.prototype.toString=function(){return" +"+this._createCount+" >"+this._allocateCount+" <"+this._releaseCount+" -"+this._disposeCount+" ="+this._list.length+"/"+this._max},t}(),B=Math.abs,w=Math.max,V=function(){function t(t){this.aabb=new v,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.id=t}return t.prototype.toString=function(){return this.id+": "+this.userData},t.prototype.isLeaf=function(){return null==this.child1},t}(),C=new b({create:function(){return new V},release:function(t){t.userData=null,t.parent=null,t.child1=null,t.child2=null,t.height=-1,t.id=void 0}}),M=function(){function t(){this.inputPool=new b({create:function(){return{}},release:function(t){}}),this.stackPool=new b({create:function(){return[]},release:function(t){t.length=0}}),this.iteratorPool=new b({create:function(){return new I},release:function(t){t.close()}}),this.m_root=null,this.m_nodes={},this.m_lastProxyId=0}return t.prototype.getUserData=function(t){return this.m_nodes[t].userData},t.prototype.getFatAABB=function(t){return this.m_nodes[t].aabb},t.prototype.allocateNode=function(){var t=C.allocate();return t.id=++this.m_lastProxyId,this.m_nodes[t.id]=t,t},t.prototype.freeNode=function(t){delete this.m_nodes[t.id],C.release(t)},t.prototype.createProxy=function(t,e){var i=this.allocateNode();return i.aabb.set(t),v.extend(i.aabb,g.aabbExtension),i.userData=e,i.height=0,this.insertLeaf(i),i.id},t.prototype.destroyProxy=function(t){var e=this.m_nodes[t];this.removeLeaf(e),this.freeNode(e)},t.prototype.moveProxy=function(t,e,i){var o=this.m_nodes[t];return!o.aabb.contains(e)&&(this.removeLeaf(o),o.aabb.set(e),e=o.aabb,v.extend(e,g.aabbExtension),i.x<0?e.lowerBound.x+=i.x*g.aabbMultiplier:e.upperBound.x+=i.x*g.aabbMultiplier,i.y<0?e.lowerBound.y+=i.y*g.aabbMultiplier:e.upperBound.y+=i.y*g.aabbMultiplier,this.insertLeaf(o),!0)},t.prototype.insertLeaf=function(t){if(null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);for(var e=t.aabb,i=this.m_root;!i.isLeaf();){var o=i.child1,s=i.child2,n=i.aabb.getPerimeter(),r=v.combinedPerimeter(i.aabb,e),a=2*r,m=2*(r-n),h=v.combinedPerimeter(e,o.aabb)+m;if(!o.isLeaf())h-=o.aabb.getPerimeter();var c=v.combinedPerimeter(e,s.aabb)+m;if(!s.isLeaf())c-=s.aabb.getPerimeter();if(a<h&&a<c)break;i=h<c?o:s}var _=i,l=_.parent,u=this.allocateNode();for(u.parent=l,u.userData=null,u.aabb.combine(e,_.aabb),u.height=_.height+1,null!=l?(l.child1===_?l.child1=u:l.child2=u,u.child1=_,u.child2=t,_.parent=u,t.parent=u):(u.child1=_,u.child2=t,_.parent=u,t.parent=u,this.m_root=u),i=t.parent;null!=i;){o=(i=this.balance(i)).child1,s=i.child2;i.height=1+w(o.height,s.height),i.aabb.combine(o.aabb,s.aabb),i=i.parent}},t.prototype.removeLeaf=function(t){if(t!==this.m_root){var e,i=t.parent,o=i.parent;if(e=i.child1===t?i.child2:i.child1,null!=o){o.child1===i?o.child1=e:o.child2=e,e.parent=o,this.freeNode(i);for(var s=o;null!=s;){var n=(s=this.balance(s)).child1,r=s.child2;s.aabb.combine(n.aabb,r.aabb),s.height=1+w(n.height,r.height),s=s.parent}}else this.m_root=e,e.parent=null,this.freeNode(i)}else this.m_root=null},t.prototype.balance=function(t){var e=t;if(e.isLeaf()||e.height<2)return t;var i=e.child1,o=e.child2,s=o.height-i.height;if(s>1){var n=o.child1,r=o.child2;return o.child1=e,o.parent=e.parent,e.parent=o,null!=o.parent?o.parent.child1===t?o.parent.child1=o:o.parent.child2=o:this.m_root=o,n.height>r.height?(o.child2=n,e.child2=r,r.parent=e,e.aabb.combine(i.aabb,r.aabb),o.aabb.combine(e.aabb,n.aabb),e.height=1+w(i.height,r.height),o.height=1+w(e.height,n.height)):(o.child2=r,e.child2=n,n.parent=e,e.aabb.combine(i.aabb,n.aabb),o.aabb.combine(e.aabb,r.aabb),e.height=1+w(i.height,n.height),o.height=1+w(e.height,r.height)),o}if(s<-1){var a=i.child1,m=i.child2;return i.child1=e,i.parent=e.parent,e.parent=i,null!=i.parent?i.parent.child1===e?i.parent.child1=i:i.parent.child2=i:this.m_root=i,a.height>m.height?(i.child2=a,e.child1=m,m.parent=e,e.aabb.combine(o.aabb,m.aabb),i.aabb.combine(e.aabb,a.aabb),e.height=1+w(o.height,m.height),i.height=1+w(e.height,a.height)):(i.child2=m,e.child1=a,a.parent=e,e.aabb.combine(o.aabb,a.aabb),i.aabb.combine(e.aabb,m.aabb),e.height=1+w(o.height,a.height),i.height=1+w(e.height,m.height)),i}return e},t.prototype.getHeight=function(){return null==this.m_root?0:this.m_root.height},t.prototype.getAreaRatio=function(){if(null==this.m_root)return 0;for(var t,e=this.m_root.aabb.getPerimeter(),i=0,o=this.iteratorPool.allocate().preorder(this.m_root);t=o.next();)t.height<0||(i+=t.aabb.getPerimeter());return this.iteratorPool.release(o),i/e},t.prototype.computeHeight=function(t){var e;if((e=void 0!==t?this.m_nodes[t]:this.m_root).isLeaf())return 0;var i=this.computeHeight(e.child1.id),o=this.computeHeight(e.child2.id);return 1+w(i,o)},t.prototype.validateStructure=function(t){if(null!=t){this.m_root;var e=t.child1,i=t.child2;t.isLeaf()||(this.validateStructure(e),this.validateStructure(i))}},t.prototype.validateMetrics=function(t){if(null!=t){var e=t.child1,i=t.child2;if(!t.isLeaf())e.height,i.height,(new v).combine(e.aabb,i.aabb),this.validateMetrics(e),this.validateMetrics(i)}},t.prototype.validate=function(){},t.prototype.getMaxBalance=function(){for(var t,e=0,i=this.iteratorPool.allocate().preorder(this.m_root);t=i.next();)if(!(t.height<=1)){var o=B(t.child2.height-t.child1.height);e=w(e,o)}return this.iteratorPool.release(i),e},t.prototype.rebuildBottomUp=function(){for(var t,e=[],i=0,o=this.iteratorPool.allocate().preorder(this.m_root);t=o.next();)t.height<0||(t.isLeaf()?(t.parent=null,e[i]=t,++i):this.freeNode(t));for(this.iteratorPool.release(o);i>1;){for(var s=1/0,n=-1,r=-1,a=0;a<i;++a)for(var m=e[a].aabb,h=a+1;h<i;++h){var c=e[h].aabb,_=v.combinedPerimeter(m,c);_<s&&(n=a,r=h,s=_)}var l=e[n],u=e[r],p=this.allocateNode();p.child1=l,p.child2=u,p.height=1+w(l.height,u.height),p.aabb.combine(l.aabb,u.aabb),p.parent=null,l.parent=p,u.parent=p,e[r]=e[i-1],e[n]=p,--i}this.m_root=e[0]},t.prototype.shiftOrigin=function(t){for(var e,i=this.iteratorPool.allocate().preorder(this.m_root);e=i.next();){var o=e.aabb;o.lowerBound.x-=t.x,o.lowerBound.y-=t.y,o.upperBound.x-=t.x,o.upperBound.y-=t.y}this.iteratorPool.release(i)},t.prototype.query=function(t,e){var i=this.stackPool.allocate();for(i.push(this.m_root);i.length>0;){var o=i.pop();if(null!=o)if(v.testOverlap(o.aabb,t))if(o.isLeaf()){if(!1===e(o.id))return}else i.push(o.child1),i.push(o.child2)}this.stackPool.release(i)},t.prototype.rayCast=function(t,e){var i=t.p1,o=t.p2,s=y.sub(o,i);s.normalize();var n=y.crossNumVec2(1,s),r=y.abs(n),a=t.maxFraction,m=new v,h=y.combine(1-a,i,a,o);m.combinePoints(i,h);var c=this.stackPool.allocate(),_=this.inputPool.allocate();for(c.push(this.m_root);c.length>0;){var l=c.pop();if(null!=l&&!1!==v.testOverlap(l.aabb,m)){var u=l.aabb.getCenter(),p=l.aabb.getExtents();if(!(B(y.dot(n,y.sub(i,u)))-y.dot(r,p)>0))if(l.isLeaf()){_.p1=y.clone(t.p1),_.p2=y.clone(t.p2),_.maxFraction=a;var d=e(_,l.id);if(0===d)return;d>0&&(a=d,h=y.combine(1-a,i,a,o),m.combinePoints(i,h))}else c.push(l.child1),c.push(l.child2)}}this.stackPool.release(c),this.inputPool.release(_)},t}(),I=function(){function t(){this.parents=[],this.states=[]}return t.prototype.preorder=function(t){return this.parents.length=0,this.parents.push(t),this.states.length=0,this.states.push(0),this},t.prototype.next=function(){for(;this.parents.length>0;){var t=this.parents.length-1,e=this.parents[t];if(0===this.states[t])return this.states[t]=1,e;if(1===this.states[t]&&(this.states[t]=2,e.child1))return this.parents.push(e.child1),this.states.push(1),e.child1;if(2===this.states[t]&&(this.states[t]=3,e.child2))return this.parents.push(e.child2),this.states.push(1),e.child2;this.parents.pop(),this.states.pop()}},t.prototype.close=function(){this.parents.length=0},t}(),P=Math.max,S=Math.min,T=function(){function t(){var t=this;this.m_tree=new M,this.m_moveBuffer=[],this.query=function(e,i){t.m_tree.query(e,i)},this.queryCallback=function(e){if(e===t.m_queryProxyId)return!0;var i=S(e,t.m_queryProxyId),o=P(e,t.m_queryProxyId),s=t.m_tree.getUserData(i),n=t.m_tree.getUserData(o);return t.m_callback(s,n),!0}}return t.prototype.getUserData=function(t){return this.m_tree.getUserData(t)},t.prototype.testOverlap=function(t,e){var i=this.m_tree.getFatAABB(t),o=this.m_tree.getFatAABB(e);return v.testOverlap(i,o)},t.prototype.getFatAABB=function(t){return this.m_tree.getFatAABB(t)},t.prototype.getProxyCount=function(){return this.m_moveBuffer.length},t.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},t.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},t.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},t.prototype.rayCast=function(t,e){this.m_tree.rayCast(t,e)},t.prototype.shiftOrigin=function(t){this.m_tree.shiftOrigin(t)},t.prototype.createProxy=function(t,e){var i=this.m_tree.createProxy(t,e);return this.bufferMove(i),i},t.prototype.destroyProxy=function(t){this.unbufferMove(t),this.m_tree.destroyProxy(t)},t.prototype.moveProxy=function(t,e,i){this.m_tree.moveProxy(t,e,i)&&this.bufferMove(t)},t.prototype.touchProxy=function(t){this.bufferMove(t)},t.prototype.bufferMove=function(t){this.m_moveBuffer.push(t)},t.prototype.unbufferMove=function(t){for(var e=0;e<this.m_moveBuffer.length;++e)this.m_moveBuffer[e]===t&&(this.m_moveBuffer[e]=null)},t.prototype.updatePairs=function(t){for(this.m_callback=t;this.m_moveBuffer.length>0;)if(this.m_queryProxyId=this.m_moveBuffer.pop(),null!==this.m_queryProxyId){var e=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(e,this.queryCallback)}},t}(),z=Math.sin,F=Math.cos,L=Math.sqrt;function q(t,e){return{x:t,y:e}}function k(t,e,i){return t.x=e,t.y=i,t}function N(t,e){return t.x=e.x,t.y=e.y,t}function j(t){return t.x=0,t.y=0,t}function D(t){return t.x=-t.x,t.y=-t.y,t}function O(t,e){return t.x+=e.x,t.y+=e.y,t}function R(t,e){return t.x-=e.x,t.y-=e.y,t}function E(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t}function J(t,e){return t.x*=e,t.y*=e,t}function Y(t,e,i){return t.x=e*i.x,t.y=e*i.y,t}function W(t,e,i){return t.x+=e*i.x,t.y+=e*i.y,t}function H(t,e,i){return t.x-=e*i.x,t.y-=e*i.y,t}function U(t,e,i,o,s){return t.x=e*i.x+o*s.x,t.y=e*i.y+o*s.y,t}function Z(t){var e=L(t.x*t.x+t.y*t.y);if(e>0){var i=1/e;t.x*=i,t.y*=i}return t}function K(t,e,i){var o=i*e.y,s=-i*e.x;return t.x=o,t.y=s,t}function X(t,e,i){var o=-e*i.y,s=e*i.x;return t.x=o,t.y=s,t}function G(t,e){return t.x*e.y-t.y*e.x}function Q(t,e){return t.x*e.x+t.y*e.y}function $(t){return t.x*t.x+t.y*t.y}function tt(t,e){var i=t.x-e.x,o=t.y-e.y;return L(i*i+o*o)}function et(t,e){var i=t.x-e.x,o=t.y-e.y;return i*i+o*o}function it(t,e,i){return t.x=e.c*i.x-e.s*i.y,t.y=e.s*i.x+e.c*i.y,t}function ot(t,e,i){var o=e.c*i.x+e.s*i.y,s=-e.s*i.x+e.c*i.y;return t.x=o,t.y=s,t}function st(t,e,i){return{p:q(t,e),q:(o=i,{s:z(o),c:F(o)})};var o}function nt(t,e){return t.p.x=e.p.x,t.p.y=e.p.y,t.q.s=e.q.s,t.q.c=e.q.c,t}function rt(t,e,i){var o=e.q.c*i.x-e.q.s*i.y+e.p.x,s=e.q.s*i.x+e.q.c*i.y+e.p.y;return t.x=o,t.y=s,t}function at(t,e,i){var o=i.x-e.p.x,s=i.y-e.p.y,n=e.q.c*o+e.q.s*s,r=-e.q.s*o+e.q.c*s;return t.x=n,t.y=r,t}function mt(t,e,i,o){var s=e.q.c*o.x-e.q.s*o.y+e.p.x,n=e.q.s*o.x+e.q.c*o.y+e.p.y,r=s-i.p.x,a=n-i.p.y,m=i.q.c*r+i.q.s*a,h=-i.q.s*r+i.q.c*a;return t.x=m,t.y=h,t}function ht(t,e,i){var o=e.q.c*i.q.c+e.q.s*i.q.s,s=e.q.c*i.q.s-e.q.s*i.q.c,n=e.q.c*(i.p.x-e.p.x)+e.q.s*(i.p.y-e.p.y),r=-e.q.s*(i.p.x-e.p.x)+e.q.c*(i.p.y-e.p.y);return t.q.c=o,t.q.s=s,t.p.x=n,t.p.y=r,t}var ct=Math.sin,_t=Math.cos,lt=Math.atan2,ut=function(){function t(e){if(!(this instanceof t))return new t(e);"number"==typeof e?this.setAngle(e):"object"==typeof e?this.setRot(e):this.setIdentity()}return t.neo=function(e){var i=Object.create(t.prototype);return i.setAngle(e),i},t.clone=function(e){var i=Object.create(t.prototype);return i.s=e.s,i.c=e.c,i},t.identity=function(){var e=Object.create(t.prototype);return e.s=0,e.c=1,e},t.isValid=function(t){return null!=t&&(Number.isFinite(t.s)&&Number.isFinite(t.c))},t.assert=function(t){},t.prototype.setIdentity=function(){this.s=0,this.c=1},t.prototype.set=function(t){"object"==typeof t?(this.s=t.s,this.c=t.c):(this.s=ct(t),this.c=_t(t))},t.prototype.setRot=function(t){this.s=t.s,this.c=t.c},t.prototype.setAngle=function(t){this.s=ct(t),this.c=_t(t)},t.prototype.getAngle=function(){return lt(this.s,this.c)},t.prototype.getXAxis=function(){return y.neo(this.c,this.s)},t.prototype.getYAxis=function(){return y.neo(-this.s,this.c)},t.mul=function(e,i){if("c"in i&&"s"in i){var o=t.identity();return o.s=e.s*i.c+e.c*i.s,o.c=e.c*i.c-e.s*i.s,o}if("x"in i&&"y"in i)return y.neo(e.c*i.x-e.s*i.y,e.s*i.x+e.c*i.y)},t.mulRot=function(e,i){var o=t.identity();return o.s=e.s*i.c+e.c*i.s,o.c=e.c*i.c-e.s*i.s,o},t.mulVec2=function(t,e){return y.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},t.mulSub=function(t,e,i){var o=t.c*(e.x-i.x)-t.s*(e.y-i.y),s=t.s*(e.x-i.x)+t.c*(e.y-i.y);return y.neo(o,s)},t.mulT=function(e,i){if("c"in i&&"s"in i){var o=t.identity();return o.s=e.c*i.s-e.s*i.c,o.c=e.c*i.c+e.s*i.s,o}if("x"in i&&"y"in i)return y.neo(e.c*i.x+e.s*i.y,-e.s*i.x+e.c*i.y)},t.mulTRot=function(e,i){var o=t.identity();return o.s=e.c*i.s-e.s*i.c,o.c=e.c*i.c+e.s*i.s,o},t.mulTVec2=function(t,e){return y.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)},t}(),pt=Math.atan2,yt=Math.PI,dt=q(0,0),ft=function(){function t(){this.localCenter=y.zero(),this.c=y.zero(),this.a=0,this.alpha0=0,this.c0=y.zero(),this.a0=0}return t.prototype.recycle=function(){j(this.localCenter),j(this.c),this.a=0,this.alpha0=0,j(this.c0),this.a0=0},t.prototype.setTransform=function(t){rt(dt,t,this.localCenter),N(this.c,dt),N(this.c0,dt),this.a=this.a0=pt(t.q.s,t.q.c)},t.prototype.setLocalCenter=function(t,e){N(this.localCenter,t),rt(dt,e,this.localCenter),N(this.c,dt),N(this.c0,dt)},t.prototype.getTransform=function(t,e){void 0===e&&(e=0),function(t,e){t.c=F(e),t.s=z(e)}(t.q,(1-e)*this.a0+e*this.a),U(t.p,1-e,this.c0,e,this.c),R(t.p,it(dt,t.q,this.localCenter))},t.prototype.advance=function(t){var e=(t-this.alpha0)/(1-this.alpha0);U(this.c0,e,this.c,1-e,this.c0),this.a0=e*this.a+(1-e)*this.a0,this.alpha0=t},t.prototype.forward=function(){this.a0=this.a,N(this.c0,this.c)},t.prototype.normalize=function(){var t=m(this.a0,-yt,+yt);this.a-=this.a0-t,this.a0=t},t.prototype.set=function(t){N(this.localCenter,t.localCenter),N(this.c,t.c),this.a=t.a,this.alpha0=t.alpha0,N(this.c0,t.c0),this.a0=t.a0},t}(),vt=function(){function t(e,i){if(!(this instanceof t))return new t(e,i);this.p=y.zero(),this.q=ut.identity(),void 0!==e&&this.p.setVec2(e),void 0!==i&&this.q.setAngle(i)}return t.clone=function(e){var i=Object.create(t.prototype);return i.p=y.clone(e.p),i.q=ut.clone(e.q),i},t.neo=function(e,i){var o=Object.create(t.prototype);return o.p=y.clone(e),o.q=ut.clone(i),o},t.identity=function(){var e=Object.create(t.prototype);return e.p=y.zero(),e.q=ut.identity(),e},t.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},t.prototype.set=function(t,e){void 0===e?(this.p.set(t.p),this.q.set(t.q)):(this.p.set(t),this.q.set(e))},t.prototype.setNum=function(t,e){this.p.setVec2(t),this.q.setAngle(e)},t.prototype.setTransform=function(t){this.p.setVec2(t.p),this.q.setRot(t.q)},t.isValid=function(t){return null!=t&&(y.isValid(t.p)&&ut.isValid(t.q))},t.assert=function(t){},t.mul=function(e,i){if(Array.isArray(i)){for(var o=[],s=0;s<i.length;s++)o[s]=t.mul(e,i[s]);return o}return"x"in i&&"y"in i?t.mulVec2(e,i):"p"in i&&"q"in i?t.mulXf(e,i):void 0},t.mulAll=function(e,i){for(var o=[],s=0;s<i.length;s++)o[s]=t.mul(e,i[s]);return o},t.mulFn=function(e){return function(i){return t.mul(e,i)}},t.mulVec2=function(t,e){var i=t.q.c*e.x-t.q.s*e.y+t.p.x,o=t.q.s*e.x+t.q.c*e.y+t.p.y;return y.neo(i,o)},t.mulXf=function(e,i){var o=t.identity();return o.q=ut.mulRot(e.q,i.q),o.p=y.add(ut.mulVec2(e.q,i.p),e.p),o},t.mulT=function(e,i){return"x"in i&&"y"in i?t.mulTVec2(e,i):"p"in i&&"q"in i?t.mulTXf(e,i):void 0},t.mulTVec2=function(t,e){var i=e.x-t.p.x,o=e.y-t.p.y,s=t.q.c*i+t.q.s*o,n=-t.q.s*i+t.q.c*o;return y.neo(s,n)},t.mulTXf=function(e,i){var o=t.identity();return o.q.setRot(ut.mulTRot(e.q,i.q)),o.p.setVec2(ut.mulTVec2(e.q,y.sub(i.p,e.p))),o},t}(),xt=function(){this.v=y.zero(),this.w=0},At=Math.sin,gt=Math.cos,bt=function(){function t(){this.c=y.zero(),this.a=0}return t.prototype.getTransform=function(t,e){return t.q.c=gt(this.a),t.q.s=At(this.a),t.p.x=this.c.x-(t.q.c*e.x-t.q.s*e.y),t.p.y=this.c.y-(t.q.s*e.x+t.q.c*e.y),t},t}();function Bt(t,e,i,o){return t.q.c=gt(o),t.q.s=At(o),t.p.x=i.x-(t.q.c*e.x-t.q.s*e.y),t.p.y=i.y-(t.q.s*e.x+t.q.c*e.y),t}var wt=function(){function t(){}return t.isValid=function(t){return null!=t&&("string"==typeof t.m_type&&"number"==typeof t.m_radius)},t}(),Vt=new v,Ct=new v,Mt=q(0,0),It={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535},Pt=function(t,e){this.aabb=new v,this.fixture=t,this.childIndex=e,this.proxyId},St=function(){function t(t,e,i){e.shape?(i=e,e=e.shape):"number"==typeof i&&(i={density:i}),i=s(i,It),this.m_body=t,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_density=i.density,this.m_isSensor=i.isSensor,this.m_filterGroupIndex=i.filterGroupIndex,this.m_filterCategoryBits=i.filterCategoryBits,this.m_filterMaskBits=i.filterMaskBits,this.m_shape=e,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0;for(var o=this.m_shape.getChildCount(),n=0;n<o;++n)this.m_proxies[n]=new Pt(this,n);this.m_userData=i.userData}return t.prototype._reset=function(){var t=this.getBody(),e=t.m_world.m_broadPhase;this.destroyProxies(e),this.m_shape._reset&&this.m_shape._reset();for(var i=this.m_shape.getChildCount(),o=0;o<i;++o)this.m_proxies[o]=new Pt(this,o);this.createProxies(e,t.m_xf),t.resetMassData()},t.prototype._serialize=function(){return{friction:this.m_friction,restitution:this.m_restitution,density:this.m_density,isSensor:this.m_isSensor,filterGroupIndex:this.m_filterGroupIndex,filterCategoryBits:this.m_filterCategoryBits,filterMaskBits:this.m_filterMaskBits,shape:this.m_shape}},t._deserialize=function(e,i,o){var s=o(wt,e.shape);return s&&new t(i,s,e)},t.prototype.getType=function(){return this.m_shape.m_type},t.prototype.getShape=function(){return this.m_shape},t.prototype.isSensor=function(){return this.m_isSensor},t.prototype.setSensor=function(t){t!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=t)},t.prototype.getUserData=function(){return this.m_userData},t.prototype.setUserData=function(t){this.m_userData=t},t.prototype.getBody=function(){return this.m_body},t.prototype.getNext=function(){return this.m_next},t.prototype.getDensity=function(){return this.m_density},t.prototype.setDensity=function(t){this.m_density=t},t.prototype.getFriction=function(){return this.m_friction},t.prototype.setFriction=function(t){this.m_friction=t},t.prototype.getRestitution=function(){return this.m_restitution},t.prototype.setRestitution=function(t){this.m_restitution=t},t.prototype.testPoint=function(t){return this.m_shape.testPoint(this.m_body.getTransform(),t)},t.prototype.rayCast=function(t,e,i){return this.m_shape.rayCast(t,e,this.m_body.getTransform(),i)},t.prototype.getMassData=function(t){this.m_shape.computeMass(t,this.m_density)},t.prototype.getAABB=function(t){return this.m_proxies[t].aabb},t.prototype.createProxies=function(t,e){this.m_proxyCount=this.m_shape.getChildCount();for(var i=0;i<this.m_proxyCount;++i){var o=this.m_proxies[i];this.m_shape.computeAABB(o.aabb,e,i),o.proxyId=t.createProxy(o.aabb,o)}},t.prototype.destroyProxies=function(t){for(var e=0;e<this.m_proxyCount;++e){var i=this.m_proxies[e];t.destroyProxy(i.proxyId),i.proxyId=null}this.m_proxyCount=0},t.prototype.synchronize=function(t,e,i){for(var o=0;o<this.m_proxyCount;++o){var s=this.m_proxies[o];this.m_shape.computeAABB(Vt,e,s.childIndex),this.m_shape.computeAABB(Ct,i,s.childIndex),s.aabb.combine(Vt,Ct),E(Mt,i.p,e.p),t.moveProxy(s.proxyId,s.aabb,Mt)}},t.prototype.setFilterData=function(t){this.m_filterGroupIndex=t.groupIndex,this.m_filterCategoryBits=t.categoryBits,this.m_filterMaskBits=t.maskBits,this.refilter()},t.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},t.prototype.setFilterGroupIndex=function(t){this.m_filterGroupIndex=t,this.refilter()},t.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},t.prototype.setFilterCategoryBits=function(t){this.m_filterCategoryBits=t,this.refilter()},t.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},t.prototype.setFilterMaskBits=function(t){this.m_filterMaskBits=t,this.refilter()},t.prototype.refilter=function(){if(null!=this.m_body){for(var t=this.m_body.getContactList();t;){var e=t.contact,i=e.getFixtureA(),o=e.getFixtureB();i!=this&&o!=this||e.flagForFiltering(),t=t.next}var s=this.m_body.getWorld();if(null!=s)for(var n=s.m_broadPhase,r=0;r<this.m_proxyCount;++r)n.touchProxy(this.m_proxies[r].proxyId)}},t.prototype.shouldCollide=function(t){if(t.m_filterGroupIndex===this.m_filterGroupIndex&&0!==t.m_filterGroupIndex)return t.m_filterGroupIndex>0;var e=0!=(t.m_filterMaskBits&this.m_filterCategoryBits),i=0!=(t.m_filterCategoryBits&this.m_filterMaskBits);return e&&i},t}(),Tt="static",zt="kinematic",Ft="dynamic",Lt=q(0,0),qt=q(0,0),kt=q(0,0),Nt=q(0,0),jt=st(0,0,0),Dt={type:Tt,position:y.zero(),angle:0,linearVelocity:y.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null},Ot=function(){function t(t,e){e=s(e,Dt),this.m_world=t,this.m_awakeFlag=e.awake,this.m_autoSleepFlag=e.allowSleep,this.m_bulletFlag=e.bullet,this.m_fixedRotationFlag=e.fixedRotation,this.m_activeFlag=e.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_userData=e.userData,this.m_type=e.type,this.m_type==Ft?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_xf=vt.identity(),this.m_xf.p.setVec2(e.position),this.m_xf.q.setAngle(e.angle),this.m_sweep=new ft,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new xt,this.c_position=new bt,this.m_force=y.zero(),this.m_torque=0,this.m_linearVelocity=y.clone(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1}return t.prototype._serialize=function(){for(var t=[],e=this.m_fixtureList;e;e=e.m_next)t.push(e);return{type:this.m_type,bullet:this.m_bulletFlag,position:this.m_xf.p,angle:this.m_xf.q.getAngle(),linearVelocity:this.m_linearVelocity,angularVelocity:this.m_angularVelocity,fixtures:t}},t._deserialize=function(e,i,o){var s=new t(i,e);if(e.fixtures)for(var n=e.fixtures.length-1;n>=0;n--){var r=o(St,e.fixtures[n],s);s._addFixture(r)}return s},t.prototype.isWorldLocked=function(){return!(!this.m_world||!this.m_world.isLocked())},t.prototype.getWorld=function(){return this.m_world},t.prototype.getNext=function(){return this.m_next},t.prototype.setUserData=function(t){this.m_userData=t},t.prototype.getUserData=function(){return this.m_userData},t.prototype.getFixtureList=function(){return this.m_fixtureList},t.prototype.getJointList=function(){return this.m_jointList},t.prototype.getContactList=function(){return this.m_contactList},t.prototype.isStatic=function(){return this.m_type==Tt},t.prototype.isDynamic=function(){return this.m_type==Ft},t.prototype.isKinematic=function(){return this.m_type==zt},t.prototype.setStatic=function(){return this.setType(Tt),this},t.prototype.setDynamic=function(){return this.setType(Ft),this},t.prototype.setKinematic=function(){return this.setType(zt),this},t.prototype.getType=function(){return this.m_type},t.prototype.setType=function(t){if(1!=this.isWorldLocked()&&this.m_type!=t){this.m_type=t,this.resetMassData(),this.m_type==Tt&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;for(var e=this.m_contactList;e;){var i=e;e=e.next,this.m_world.destroyContact(i.contact)}this.m_contactList=null;for(var o=this.m_world.m_broadPhase,s=this.m_fixtureList;s;s=s.m_next)for(var n=0;n<s.m_proxyCount;++n)o.touchProxy(s.m_proxies[n].proxyId)}},t.prototype.isBullet=function(){return this.m_bulletFlag},t.prototype.setBullet=function(t){this.m_bulletFlag=!!t},t.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},t.prototype.setSleepingAllowed=function(t){this.m_autoSleepFlag=!!t,0==this.m_autoSleepFlag&&this.setAwake(!0)},t.prototype.isAwake=function(){return this.m_awakeFlag},t.prototype.setAwake=function(t){t?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},t.prototype.isActive=function(){return this.m_activeFlag},t.prototype.setActive=function(t){if(t!=this.m_activeFlag)if(this.m_activeFlag=!!t,this.m_activeFlag){for(var e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.createProxies(e,this.m_xf);this.m_world.m_newFixture=!0}else{for(e=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.destroyProxies(e);for(var o=this.m_contactList;o;){var s=o;o=o.next,this.m_world.destroyContact(s.contact)}this.m_contactList=null}},t.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},t.prototype.setFixedRotation=function(t){this.m_fixedRotationFlag!=t&&(this.m_fixedRotationFlag=!!t,this.m_angularVelocity=0,this.resetMassData())},t.prototype.getTransform=function(){return this.m_xf},t.prototype.setTransform=function(t,e){if(1!=this.isWorldLocked()){this.m_xf.setNum(t,e),this.m_sweep.setTransform(this.m_xf);for(var i=this.m_world.m_broadPhase,o=this.m_fixtureList;o;o=o.m_next)o.synchronize(i,this.m_xf,this.m_xf);this.setAwake(!0)}},t.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1)},t.prototype.synchronizeFixtures=function(){this.m_sweep.getTransform(jt,0);for(var t=this.m_world.m_broadPhase,e=this.m_fixtureList;e;e=e.m_next)e.synchronize(t,jt,this.m_xf)},t.prototype.advance=function(t){this.m_sweep.advance(t),N(this.m_sweep.c,this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},t.prototype.getPosition=function(){return this.m_xf.p},t.prototype.setPosition=function(t){this.setTransform(t,this.m_sweep.a)},t.prototype.getAngle=function(){return this.m_sweep.a},t.prototype.setAngle=function(t){this.setTransform(this.m_xf.p,t)},t.prototype.getWorldCenter=function(){return this.m_sweep.c},t.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},t.prototype.getLinearVelocity=function(){return this.m_linearVelocity},t.prototype.getLinearVelocityFromWorldPoint=function(t){var e=y.sub(t,this.m_sweep.c);return y.add(this.m_linearVelocity,y.crossNumVec2(this.m_angularVelocity,e))},t.prototype.getLinearVelocityFromLocalPoint=function(t){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(t))},t.prototype.setLinearVelocity=function(t){this.m_type!=Tt&&(y.dot(t,t)>0&&this.setAwake(!0),this.m_linearVelocity.setVec2(t))},t.prototype.getAngularVelocity=function(){return this.m_angularVelocity},t.prototype.setAngularVelocity=function(t){this.m_type!=Tt&&(t*t>0&&this.setAwake(!0),this.m_angularVelocity=t)},t.prototype.getLinearDamping=function(){return this.m_linearDamping},t.prototype.setLinearDamping=function(t){this.m_linearDamping=t},t.prototype.getAngularDamping=function(){return this.m_angularDamping},t.prototype.setAngularDamping=function(t){this.m_angularDamping=t},t.prototype.getGravityScale=function(){return this.m_gravityScale},t.prototype.setGravityScale=function(t){this.m_gravityScale=t},t.prototype.getMass=function(){return this.m_mass},t.prototype.getInertia=function(){return this.m_I+this.m_mass*y.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},t.prototype.getMassData=function(t){t.mass=this.m_mass,t.I=this.getInertia(),N(t.center,this.m_sweep.localCenter)},t.prototype.resetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,j(this.m_sweep.localCenter),this.isStatic()||this.isKinematic())return N(this.m_sweep.c0,this.m_xf.p),N(this.m_sweep.c,this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);j(qt);for(var t=this.m_fixtureList;t;t=t.m_next)if(0!=t.m_density){var e={mass:0,center:q(0,0),I:0};t.getMassData(e),this.m_mass+=e.mass,W(qt,e.mass,e.center),this.m_I+=e.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,Y(qt,this.m_invMass,qt)):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I-=this.m_mass*Q(qt,qt),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0),N(Lt,this.m_sweep.c),this.m_sweep.setLocalCenter(qt,this.m_xf),E(kt,this.m_sweep.c,Lt),X(Nt,this.m_angularVelocity,kt),O(this.m_linearVelocity,Nt)},t.prototype.setMassData=function(t){1!=this.isWorldLocked()&&this.m_type==Ft&&(this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,t.I>0&&0==this.m_fixedRotationFlag&&(this.m_I=t.I-this.m_mass*Q(t.center,t.center),this.m_invI=1/this.m_I),N(Lt,this.m_sweep.c),this.m_sweep.setLocalCenter(t.center,this.m_xf),E(kt,this.m_sweep.c,Lt),X(Nt,this.m_angularVelocity,kt),O(this.m_linearVelocity,Nt))},t.prototype.applyForce=function(t,e,i){void 0===i&&(i=!0),this.m_type==Ft&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(t),this.m_torque+=y.crossVec2Vec2(y.sub(e,this.m_sweep.c),t)))},t.prototype.applyForceToCenter=function(t,e){void 0===e&&(e=!0),this.m_type==Ft&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(t))},t.prototype.applyTorque=function(t,e){void 0===e&&(e=!0),this.m_type==Ft&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))},t.prototype.applyLinearImpulse=function(t,e,i){void 0===i&&(i=!0),this.m_type==Ft&&(i&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,t),this.m_angularVelocity+=this.m_invI*y.crossVec2Vec2(y.sub(e,this.m_sweep.c),t)))},t.prototype.applyAngularImpulse=function(t,e){void 0===e&&(e=!0),this.m_type==Ft&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},t.prototype.shouldCollide=function(t){if(this.m_type!=Ft&&t.m_type!=Ft)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},t.prototype._addFixture=function(t){if(1==this.isWorldLocked())return null;if(this.m_activeFlag){var e=this.m_world.m_broadPhase;t.createProxies(e,this.m_xf)}return t.m_next=this.m_fixtureList,this.m_fixtureList=t,t.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=!0,t},t.prototype.createFixture=function(t,e){if(1==this.isWorldLocked())return null;var i=new St(this,t,e);return this._addFixture(i),i},t.prototype.destroyFixture=function(t){if(1!=this.isWorldLocked()){if(this.m_fixtureList===t)this.m_fixtureList=t.m_next;else for(var e=this.m_fixtureList;null!=e;){if(e.m_next===t){e.m_next=t.m_next;break}e=e.m_next}for(var i=this.m_contactList;i;){var o=i.contact;i=i.next;var s=o.getFixtureA(),n=o.getFixtureB();t!=s&&t!=n||this.m_world.destroyContact(o)}if(this.m_activeFlag){var r=this.m_world.m_broadPhase;t.destroyProxies(r)}t.m_body=null,t.m_next=null,this.m_world.publish("remove-fixture",t),this.resetMassData()}},t.prototype.getWorldPoint=function(t){return vt.mulVec2(this.m_xf,t)},t.prototype.getWorldVector=function(t){return ut.mulVec2(this.m_xf.q,t)},t.prototype.getLocalPoint=function(t){return vt.mulTVec2(this.m_xf,t)},t.prototype.getLocalVector=function(t){return ut.mulTVec2(this.m_xf.q,t)},t.STATIC="static",t.KINEMATIC="kinematic",t.DYNAMIC="dynamic",t}(),Rt=function(){this.other=null,this.joint=null,this.prev=null,this.next=null},Et=function(){function t(t,e,i){this.m_type="unknown-joint",this.m_prev=null,this.m_next=null,this.m_edgeA=new Rt,this.m_edgeB=new Rt,this.m_islandFlag=!1,e="bodyA"in t?t.bodyA:e,i="bodyB"in t?t.bodyB:i,this.m_bodyA=e,this.m_bodyB=i,this.m_collideConnected=!!t.collideConnected,this.m_userData=t.userData}return t.prototype.isActive=function(){return this.m_bodyA.isActive()&&this.m_bodyB.isActive()},t.prototype.getType=function(){return this.m_type},t.prototype.getBodyA=function(){return this.m_bodyA},t.prototype.getBodyB=function(){return this.m_bodyB},t.prototype.getNext=function(){return this.m_next},t.prototype.getUserData=function(){return this.m_userData},t.prototype.setUserData=function(t){this.m_userData=t},t.prototype.getCollideConnected=function(){return this.m_collideConnected},t.prototype.shiftOrigin=function(t){},t}(),Jt={gjkCalls:0,gjkIters:0,gjkMaxIters:0,toiTime:0,toiMaxTime:0,toiCalls:0,toiIters:0,toiMaxIters:0,toiRootIters:0,toiMaxRootIters:0,toString:function(t){t="string"==typeof t?t:"\n";var e="";for(var i in this)"function"!=typeof this[i]&&"object"!=typeof this[i]&&(e+=i+": "+this[i]+t);return e}},Yt=function(){return Date.now()},Wt=function(t){return Date.now()-t},Ht=Math.max,Ut=q(0,0),Zt=q(0,0),Kt=q(0,0),Xt=q(0,0),Gt=q(0,0),Qt=q(0,0),$t=q(0,0);Jt.gjkCalls=0,Jt.gjkIters=0,Jt.gjkMaxIters=0;var te=function(){function t(){this.proxyA=new se,this.proxyB=new se,this.transformA=vt.identity(),this.transformB=vt.identity(),this.useRadii=!1}return t.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.transformA.setIdentity(),this.transformB.setIdentity(),this.useRadii=!1},t}(),ee=function(){function t(){this.pointA=q(0,0),this.pointB=q(0,0),this.distance=0,this.iterations=0}return t.prototype.recycle=function(){j(this.pointA),j(this.pointB),this.distance=0,this.iterations=0},t}(),ie=function(){function t(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}return t.prototype.recycle=function(){this.metric=0,this.indexA.length=0,this.indexB.length=0,this.count=0},t}(),oe=function(t,e,i){++Jt.gjkCalls;var o=i.proxyA,s=i.proxyB,n=i.transformA,a=i.transformB;he.recycle(),he.readCache(e,o,n,s,a);for(var m=he.m_v,h=g.maxDistanceIterations,c=[],_=[],l=0,u=0;u<h;){l=he.m_count;for(var p=0;p<l;++p)c[p]=m[p].indexA,_[p]=m[p].indexB;if(he.solve(),3===he.m_count)break;var y=he.getSearchDirection();if($(y)<1e-18)break;var d=m[he.m_count];d.indexA=o.getSupport(ot(Ut,n.q,Y(Ut,-1,y))),rt(d.wA,n,o.getVertex(d.indexA)),d.indexB=s.getSupport(ot(Ut,a.q,y)),rt(d.wB,a,s.getVertex(d.indexB)),E(d.w,d.wB,d.wA),++u,++Jt.gjkIters;var f=!1;for(p=0;p<l;++p)if(d.indexA===c[p]&&d.indexB===_[p]){f=!0;break}if(f)break;++he.m_count}if(Jt.gjkMaxIters=Ht(Jt.gjkMaxIters,u),he.getWitnessPoints(t.pointA,t.pointB),t.distance=tt(t.pointA,t.pointB),t.iterations=u,he.writeCache(e),i.useRadii){var v=o.m_radius,x=s.m_radius;if(t.distance>v+x&&t.distance>r)t.distance-=v+x,E(Zt,t.pointB,t.pointA),Z(Zt),W(t.pointA,v,Zt),H(t.pointB,x,Zt);else{var A=E(Ut,t.pointA,t.pointB);N(t.pointA,A),N(t.pointB,A),t.distance=0}}},se=function(){function t(){this.m_vertices=[],this.m_count=0,this.m_radius=0}return t.prototype.recycle=function(){this.m_vertices.length=0,this.m_count=0,this.m_radius=0},t.prototype.getVertexCount=function(){return this.m_count},t.prototype.getVertex=function(t){return this.m_vertices[t]},t.prototype.getSupport=function(t){for(var e=-1,i=-1/0,o=0;o<this.m_count;++o){var s=Q(this.m_vertices[o],t);s>i&&(e=o,i=s)}return e},t.prototype.getSupportVertex=function(t){return this.m_vertices[this.getSupport(t)]},t.prototype.set=function(t,e){t.computeDistanceProxy(this,e)},t.prototype.setVertices=function(t,e,i){this.m_vertices=t,this.m_count=e,this.m_radius=i},t}(),ne=function(){function t(){this.wA=q(0,0),this.indexA=0,this.wB=q(0,0),this.indexB=0,this.w=q(0,0),this.a=0}return t.prototype.recycle=function(){this.indexA=0,this.indexB=0,j(this.wA),j(this.wB),j(this.w),this.a=0},t.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,N(this.wA,t.wA),N(this.wB,t.wB),N(this.w,t.w),this.a=t.a},t}(),re=q(0,0),ae=q(0,0),me=function(){function t(){this.m_v1=new ne,this.m_v2=new ne,this.m_v3=new ne,this.m_v=[this.m_v1,this.m_v2,this.m_v3]}return t.prototype.recycle=function(){this.m_v1.recycle(),this.m_v2.recycle(),this.m_v3.recycle(),this.m_count=0},t.prototype.toString=function(){return 3===this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():2===this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():1===this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},t.prototype.readCache=function(t,e,i,o,s){this.m_count=t.count;for(var n=0;n<this.m_count;++n){(_=this.m_v[n]).indexA=t.indexA[n],_.indexB=t.indexB[n];var a=e.getVertex(_.indexA),m=o.getVertex(_.indexB);rt(_.wA,i,a),rt(_.wB,s,m),E(_.w,_.wB,_.wA),_.a=0}if(this.m_count>1){var h=t.metric,c=this.getMetric();(c<.5*h||2*h<c||c<r)&&(this.m_count=0)}if(0===this.m_count){var _;(_=this.m_v[0]).indexA=0,_.indexB=0;a=e.getVertex(0),m=o.getVertex(0);rt(_.wA,i,a),rt(_.wB,s,m),E(_.w,_.wB,_.wA),_.a=1,this.m_count=1}},t.prototype.writeCache=function(t){t.metric=this.getMetric(),t.count=this.m_count;for(var e=0;e<this.m_count;++e)t.indexA[e]=this.m_v[e].indexA,t.indexB[e]=this.m_v[e].indexB},t.prototype.getSearchDirection=function(){var t=this.m_v1,e=this.m_v2;switch(this.m_v3,this.m_count){case 1:return k(re,-t.w.x,-t.w.y);case 2:return E(Kt,e.w,t.w),-G(Kt,t.w)>0?k(re,-Kt.y,Kt.x):k(re,Kt.y,-Kt.x);default:return j(re)}},t.prototype.getClosestPoint=function(){var t=this.m_v1,e=this.m_v2;switch(this.m_v3,this.m_count){case 0:return j(ae);case 1:return N(ae,t.w);case 2:return U(ae,t.a,t.w,e.a,e.w);case 3:default:return j(ae)}},t.prototype.getWitnessPoints=function(t,e){var i=this.m_v1,o=this.m_v2,s=this.m_v3;switch(this.m_count){case 0:break;case 1:N(t,i.wA),N(e,i.wB);break;case 2:U(t,i.a,i.wA,o.a,o.wA),U(e,i.a,i.wB,o.a,o.wB);break;case 3:e.x=t.x=i.a*i.wA.x+o.a*o.wA.x+s.a*s.wA.x,e.y=t.y=i.a*i.wA.y+o.a*o.wA.y+s.a*s.wA.y}},t.prototype.getMetric=function(){switch(this.m_count){case 0:case 1:return 0;case 2:return tt(this.m_v1.w,this.m_v2.w);case 3:return G(E(Qt,this.m_v2.w,this.m_v1.w),E($t,this.m_v3.w,this.m_v1.w));default:return 0}},t.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3()}},t.prototype.solve2=function(){var t=this.m_v1.w,e=this.m_v2.w;E(Kt,e,t);var i=-Q(t,Kt);if(i<=0)return this.m_v1.a=1,void(this.m_count=1);var o=Q(e,Kt);if(o<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);var s=1/(o+i);this.m_v1.a=o*s,this.m_v2.a=i*s,this.m_count=2},t.prototype.solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,i=this.m_v3.w;E(Kt,e,t);var o=Q(t,Kt),s=Q(e,Kt),n=-o;E(Xt,i,t);var r=Q(t,Xt),a=Q(i,Xt),m=-r;E(Gt,i,e);var h=Q(e,Gt),c=Q(i,Gt),_=-h,l=G(Kt,Xt),u=l*G(e,i),p=l*G(i,t),y=l*G(t,e);if(n<=0&&m<=0)return this.m_v1.a=1,void(this.m_count=1);if(s>0&&n>0&&y<=0){var d=1/(s+n);return this.m_v1.a=s*d,this.m_v2.a=n*d,void(this.m_count=2)}if(a>0&&m>0&&p<=0){var f=1/(a+m);return this.m_v1.a=a*f,this.m_v3.a=m*f,this.m_count=2,void this.m_v2.set(this.m_v3)}if(s<=0&&_<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);if(a<=0&&c<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.set(this.m_v3);if(c>0&&_>0&&u<=0){var v=1/(c+_);return this.m_v2.a=c*v,this.m_v3.a=_*v,this.m_count=2,void this.m_v1.set(this.m_v3)}var x=1/(u+p+y);this.m_v1.a=u*x,this.m_v2.a=p*x,this.m_v3.a=y*x,this.m_count=3},t}(),he=new me,ce=new te,_e=new ie,le=new ee,ue=function(t,e,i,o,s,n){return ce.recycle(),ce.proxyA.set(t,e),ce.proxyB.set(i,o),nt(ce.transformA,s),nt(ce.transformB,n),ce.useRadii=!0,le.recycle(),_e.recycle(),oe(le,_e,ce),le.distance<1e-8};oe.testOverlap=ue,oe.Input=te,oe.Output=ee,oe.Proxy=se,oe.Cache=ie;var pe,ye=function(){function t(){this.proxyA=new se,this.proxyB=new se,this.transformA=vt.identity(),this.transformB=vt.identity(),this.translationB=y.zero()}return t.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.transformA.setIdentity(),this.transformB.setIdentity(),j(this.translationB)},t}(),de=function(){this.point=y.zero(),this.normal=y.zero(),this.lambda=1,this.iterations=0},fe=function(t,e){t.iterations=0,t.lambda=1,t.normal.setZero(),t.point.setZero();var i=e.proxyA,o=e.proxyB,s=Ht(i.m_radius,g.polygonRadius),n=s+Ht(o.m_radius,g.polygonRadius),r=e.transformA,a=e.transformB,m=e.translationB,h=y.zero(),c=0,_=new me;_.m_count=0;for(var l=_.m_v,u=i.getSupport(ut.mulTVec2(r.q,y.neg(m))),p=vt.mulVec2(r,i.getVertex(u)),d=o.getSupport(ut.mulTVec2(a.q,m)),f=vt.mulVec2(a,o.getVertex(d)),v=y.sub(p,f),x=Ht(g.polygonRadius,n-g.polygonRadius),A=.5*g.linearSlop,b=0;b<20&&v.length()-x>A;){t.iterations+=1,u=i.getSupport(ut.mulTVec2(r.q,y.neg(v))),p=vt.mulVec2(r,i.getVertex(u)),d=o.getSupport(ut.mulTVec2(a.q,v)),f=vt.mulVec2(a,o.getVertex(d));var B=y.sub(p,f);v.normalize();var w=y.dot(v,B),V=y.dot(v,m);if(w-x>c*V){if(V<=0)return!1;if((c=(w-x)/V)>1)return!1;h.setMul(-1,v),_.m_count=0}var C=l[_.m_count];switch(C.indexA=d,C.wA=y.combine(1,f,c,m),C.indexB=u,C.wB=p,C.w=y.sub(C.wB,C.wA),C.a=1,_.m_count+=1,_.m_count){case 1:break;case 2:_.solve2();break;case 3:_.solve3()}if(3==_.m_count)return!1;v.setVec2(_.getClosestPoint()),++b}if(0==b)return!1;var M=y.zero(),I=y.zero();return _.getWitnessPoints(I,M),v.lengthSquared()>0&&(h.setMul(-1,v),h.normalize()),t.point=y.combine(1,M,s,h),t.normal=h,t.lambda=c,t.iterations=b,!0},ve=Math.abs,xe=Math.max,Ae=function(){function t(){this.proxyA=new se,this.proxyB=new se,this.sweepA=new ft,this.sweepB=new ft}return t.prototype.recycle=function(){this.proxyA.recycle(),this.proxyB.recycle(),this.sweepA.recycle(),this.sweepB.recycle(),this.tMax=-1},t}();t.TOIOutputState=void 0,(pe=t.TOIOutputState||(t.TOIOutputState={}))[pe.e_unset=-1]="e_unset",pe[pe.e_unknown=0]="e_unknown",pe[pe.e_failed=1]="e_failed",pe[pe.e_overlapped=2]="e_overlapped",pe[pe.e_touching=3]="e_touching",pe[pe.e_separated=4]="e_separated";var ge=function(){function e(){this.state=t.TOIOutputState.e_unset,this.t=-1}return e.prototype.recycle=function(){this.state=t.TOIOutputState.e_unset,this.t=-1},e}();Jt.toiTime=0,Jt.toiMaxTime=0,Jt.toiCalls=0,Jt.toiIters=0,Jt.toiMaxIters=0,Jt.toiRootIters=0,Jt.toiMaxRootIters=0;var be,Be=new te,we=new ee,Ve=new ie,Ce=st(0,0,0),Me=st(0,0,0),Ie=q(0,0),Pe=q(0,0),Se=q(0,0),Te=q(0,0),ze=q(0,0),Fe=q(0,0),Le=q(0,0),qe=q(0,0),ke=function(e,i){var o=Yt();++Jt.toiCalls,e.state=t.TOIOutputState.e_unknown,e.t=i.tMax;var s=i.proxyA,n=i.proxyB,r=i.sweepA,a=i.sweepB;r.normalize(),a.normalize();var m=i.tMax,h=s.m_radius+n.m_radius,c=xe(g.linearSlop,h-3*g.linearSlop),_=.25*g.linearSlop,l=0,u=g.maxTOIIterations,p=0;for(Ve.recycle(),Be.proxyA.setVertices(s.m_vertices,s.m_count,s.m_radius),Be.proxyB.setVertices(n.m_vertices,n.m_count,n.m_radius),Be.useRadii=!1;;){if(r.getTransform(Ce,l),a.getTransform(Me,l),nt(Be.transformA,Ce),nt(Be.transformB,Me),oe(we,Ve,Be),we.distance<=0){e.state=t.TOIOutputState.e_overlapped,e.t=0;break}if(we.distance<c+_){e.state=t.TOIOutputState.e_touching,e.t=l;break}Ne.initialize(Ve,s,r,n,a,l);for(var y=!1,d=m,f=0;;){var v=Ne.findMinSeparation(d);if(v>c+_){e.state=t.TOIOutputState.e_separated,e.t=m,y=!0;break}if(v>c-_){l=d;break}var x=Ne.evaluate(l);if(x<c-_){e.state=t.TOIOutputState.e_failed,e.t=l,y=!0;break}if(x<=c+_){e.state=t.TOIOutputState.e_touching,e.t=l,y=!0;break}for(var A=0,b=l,B=d;;){var w=void 0;w=1&A?b+(c-x)*(B-b)/(v-x):.5*(b+B),++A,++Jt.toiRootIters;var V=Ne.evaluate(w);if(ve(V-c)<_){d=w;break}if(V>c?(b=w,x=V):(B=w,v=V),50===A)break}if(Jt.toiMaxRootIters=xe(Jt.toiMaxRootIters,A),++f===g.maxPolygonVertices)break}if(++p,++Jt.toiIters,y)break;if(p===u){e.state=t.TOIOutputState.e_failed,e.t=l;break}}Jt.toiMaxIters=xe(Jt.toiMaxIters,p);var C=Wt(o);Jt.toiMaxTime=xe(Jt.toiMaxTime,C),Jt.toiTime+=C,Ne.recycle()};!function(t){t[t.e_unset=-1]="e_unset",t[t.e_points=1]="e_points",t[t.e_faceA=2]="e_faceA",t[t.e_faceB=3]="e_faceB"}(be||(be={}));var Ne=new(function(){function t(){this.m_proxyA=null,this.m_proxyB=null,this.m_sweepA=null,this.m_sweepB=null,this.m_type=be.e_unset,this.m_localPoint=q(0,0),this.m_axis=q(0,0),this.indexA=-1,this.indexB=-1}return t.prototype.recycle=function(){this.m_proxyA=null,this.m_proxyB=null,this.m_sweepA=null,this.m_sweepB=null,this.m_type=be.e_unset,j(this.m_localPoint),j(this.m_axis),this.indexA=-1,this.indexB=-1},t.prototype.initialize=function(t,e,i,o,s,n){var r=t.count;if(this.m_proxyA=e,this.m_proxyB=o,this.m_sweepA=i,this.m_sweepB=s,this.m_sweepA.getTransform(Ce,n),this.m_sweepB.getTransform(Me,n),1===r){this.m_type=be.e_points;var a=this.m_proxyA.getVertex(t.indexA[0]),m=this.m_proxyB.getVertex(t.indexB[0]);return rt(Pe,Ce,a),rt(Se,Me,m),E(this.m_axis,Se,Pe),p=function(t){var e=L(t.x*t.x+t.y*t.y);if(0!==e){var i=1/e;t.x*=i,t.y*=i}return e}(this.m_axis)}if(t.indexA[0]===t.indexA[1]){this.m_type=be.e_faceB;var h=o.getVertex(t.indexB[0]),c=o.getVertex(t.indexB[1]);K(this.m_axis,E(Ie,c,h),1),Z(this.m_axis),it(Te,Me.q,this.m_axis),U(this.m_localPoint,.5,h,.5,c),rt(Se,Me,this.m_localPoint);var _=e.getVertex(t.indexA[0]);return(p=Q(vt.mulVec2(Ce,_),Te)-Q(Se,Te))<0&&(D(this.m_axis),p=-p),p}this.m_type=be.e_faceA;var l=this.m_proxyA.getVertex(t.indexA[0]),u=this.m_proxyA.getVertex(t.indexA[1]);K(this.m_axis,E(Ie,u,l),1),Z(this.m_axis),it(Te,Ce.q,this.m_axis),U(this.m_localPoint,.5,l,.5,u),rt(Pe,Ce,this.m_localPoint);var p,y=this.m_proxyB.getVertex(t.indexB[0]);return rt(Se,Me,y),(p=Q(Se,Te)-Q(Pe,Te))<0&&(D(this.m_axis),p=-p),p},t.prototype.compute=function(t,e){switch(this.m_sweepA.getTransform(Ce,e),this.m_sweepB.getTransform(Me,e),this.m_type){case be.e_points:return t&&(ot(ze,Ce.q,this.m_axis),ot(Fe,Me.q,Y(Ie,-1,this.m_axis)),this.indexA=this.m_proxyA.getSupport(ze),this.indexB=this.m_proxyB.getSupport(Fe)),N(Le,this.m_proxyA.getVertex(this.indexA)),N(qe,this.m_proxyB.getVertex(this.indexB)),rt(Pe,Ce,Le),rt(Se,Me,qe),Q(Se,this.m_axis)-Q(Pe,this.m_axis);case be.e_faceA:return it(Te,Ce.q,this.m_axis),rt(Pe,Ce,this.m_localPoint),t&&(ot(Fe,Me.q,Y(Ie,-1,Te)),this.indexA=-1,this.indexB=this.m_proxyB.getSupport(Fe)),N(qe,this.m_proxyB.getVertex(this.indexB)),rt(Se,Me,qe),Q(Se,Te)-Q(Pe,Te);case be.e_faceB:return it(Te,Me.q,this.m_axis),rt(Se,Me,this.m_localPoint),t&&(ot(ze,Ce.q,Y(Ie,-1,Te)),this.indexB=-1,this.indexA=this.m_proxyA.getSupport(ze)),N(Le,this.m_proxyA.getVertex(this.indexA)),rt(Pe,Ce,Le),Q(Pe,Te)-Q(Se,Te);default:return t&&(this.indexA=-1,this.indexB=-1),0}},t.prototype.findMinSeparation=function(t){return this.compute(!0,t)},t.prototype.evaluate=function(t){return this.compute(!1,t)},t}());ke.Input=Ae,ke.Output=ge;var je=Math.abs,De=Math.sqrt,Oe=Math.min,Re=function(){function t(){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}return t.prototype.reset=function(t){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=t,this.inv_dt=0==t?0:1/t,this.dtRatio=t*this.inv_dt0},t}(),Ee=new Re,Je=q(0,0),Ye=q(0,0),We=q(0,0),He=new Ae,Ue=new ge,Ze=new ft,Ke=new ft,Xe=new ft,Ge=function(){function t(t){this.contact=t,this.normals=[],this.tangents=[]}return t.prototype.recycle=function(){this.normals.length=0,this.tangents.length=0},Object.defineProperty(t.prototype,"normalImpulses",{get:function(){var t=this.contact,e=this.normals;e.length=0;for(var i=0;i<t.v_points.length;++i)e.push(t.v_points[i].normalImpulse);return e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tangentImpulses",{get:function(){var t=this.contact,e=this.tangents;e.length=0;for(var i=0;i<t.v_points.length;++i)e.push(t.v_points[i].tangentImpulse);return e},enumerable:!1,configurable:!0}),t}(),Qe=function(){function e(t){this.m_world=t,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}return e.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},e.prototype.addBody=function(t){this.m_bodies.push(t)},e.prototype.addContact=function(t){this.m_contacts.push(t)},e.prototype.addJoint=function(t){this.m_joints.push(t)},e.prototype.solveWorld=function(t){for(var e=this.m_world,i=e.m_bodyList;i;i=i.m_next)i.m_islandFlag=!1;for(var o=e.m_contactList;o;o=o.m_next)o.m_islandFlag=!1;for(var s=e.m_jointList;s;s=s.m_next)s.m_islandFlag=!1;for(var n=this.m_stack,r=e.m_bodyList;r;r=r.m_next)if(!r.m_islandFlag&&0!=r.isAwake()&&0!=r.isActive()&&!r.isStatic()){for(this.clear(),n.push(r),r.m_islandFlag=!0;n.length>0;){i=n.pop();if(this.addBody(i),i.m_awakeFlag=!0,!i.isStatic()){for(var a=i.m_contactList;a;a=a.next){var m=a.contact;if(!m.m_islandFlag&&(0!=m.isEnabled()&&0!=m.isTouching())){var h=m.m_fixtureA.m_isSensor,c=m.m_fixtureB.m_isSensor;if(!h&&!c)this.addContact(m),m.m_islandFlag=!0,(l=a.other).m_islandFlag||(n.push(l),l.m_islandFlag=!0)}}for(var _=i.m_jointList;_;_=_.next){var l;if(1!=_.joint.m_islandFlag)0!=(l=_.other).isActive()&&(this.addJoint(_.joint),_.joint.m_islandFlag=!0,l.m_islandFlag||(n.push(l),l.m_islandFlag=!0))}}}this.solveIsland(t);for(var u=0;u<this.m_bodies.length;++u){(i=this.m_bodies[u]).isStatic()&&(i.m_islandFlag=!1)}}},e.prototype.solveIsland=function(t){for(var e=this.m_world,i=e.m_gravity,o=e.m_allowSleep,s=t.dt,n=0;n<this.m_bodies.length;++n){var r=this.m_bodies[n];N(Je,r.m_sweep.c);var a=r.m_sweep.a;N(Ye,r.m_linearVelocity);var m=r.m_angularVelocity;N(r.m_sweep.c0,r.m_sweep.c),r.m_sweep.a0=r.m_sweep.a,r.isDynamic()&&(W(Ye,s*r.m_gravityScale,i),W(Ye,s*r.m_invMass,r.m_force),m+=s*r.m_invI*r.m_torque,Y(Ye,1/(1+s*r.m_linearDamping),Ye),m*=1/(1+s*r.m_angularDamping)),N(r.c_position.c,Je),r.c_position.a=a,N(r.c_velocity.v,Ye),r.c_velocity.w=m}for(n=0;n<this.m_contacts.length;++n){this.m_contacts[n].initConstraint(t)}for(n=0;n<this.m_contacts.length;++n){this.m_contacts[n].initVelocityConstraint(t)}if(t.warmStarting)for(n=0;n<this.m_contacts.length;++n){this.m_contacts[n].warmStartConstraint(t)}for(n=0;n<this.m_joints.length;++n){this.m_joints[n].initVelocityConstraints(t)}for(n=0;n<t.velocityIterations;++n){for(var h=0;h<this.m_joints.length;++h){this.m_joints[h].solveVelocityConstraints(t)}for(h=0;h<this.m_contacts.length;++h){this.m_contacts[h].solveVelocityConstraint(t)}}for(n=0;n<this.m_contacts.length;++n){this.m_contacts[n].storeConstraintImpulses(t)}for(n=0;n<this.m_bodies.length;++n){r=this.m_bodies[n];N(Je,r.c_position.c);a=r.c_position.a;N(Ye,r.c_velocity.v);m=r.c_velocity.w;Y(We,s,Ye);var c=$(We);if(c>g.maxTranslationSquared){var _=g.maxTranslation/De(c);J(Ye,_)}var l=s*m;if(l*l>g.maxRotationSquared)m*=_=g.maxRotation/je(l);W(Je,s,Ye),a+=s*m,N(r.c_position.c,Je),r.c_position.a=a,N(r.c_velocity.v,Ye),r.c_velocity.w=m}var u=!1;for(n=0;n<t.positionIterations;++n){var p=0;for(h=0;h<this.m_contacts.length;++h){var y=this.m_contacts[h].solvePositionConstraint(t);p=Oe(p,y)}var d=p>=-3*g.linearSlop,f=!0;for(h=0;h<this.m_joints.length;++h){var v=this.m_joints[h].solvePositionConstraints(t);f=f&&v}if(d&&f){u=!0;break}}for(n=0;n<this.m_bodies.length;++n){N((r=this.m_bodies[n]).m_sweep.c,r.c_position.c),r.m_sweep.a=r.c_position.a,N(r.m_linearVelocity,r.c_velocity.v),r.m_angularVelocity=r.c_velocity.w,r.synchronizeTransform()}if(this.postSolveIsland(),o){var x=1/0,A=g.linearSleepToleranceSqr,b=g.angularSleepToleranceSqr;for(n=0;n<this.m_bodies.length;++n){(r=this.m_bodies[n]).isStatic()||(0==r.m_autoSleepFlag||r.m_angularVelocity*r.m_angularVelocity>b||$(r.m_linearVelocity)>A?(r.m_sleepTime=0,x=0):(r.m_sleepTime+=s,x=Oe(x,r.m_sleepTime)))}if(x>=g.timeToSleep&&u)for(n=0;n<this.m_bodies.length;++n){(r=this.m_bodies[n]).setAwake(!1)}}},e.prototype.solveWorldTOI=function(e){var i=this.m_world;if(i.m_stepComplete){for(var o=i.m_bodyList;o;o=o.m_next)o.m_islandFlag=!1,o.m_sweep.alpha0=0;for(var s=i.m_contactList;s;s=s.m_next)s.m_toiFlag=!1,s.m_islandFlag=!1,s.m_toiCount=0,s.m_toi=1}for(;;){for(var n=null,r=1,a=i.m_contactList;a;a=a.m_next)if(0!=a.isEnabled()&&!(a.m_toiCount>g.maxSubSteps)){var m=1;if(a.m_toiFlag)m=a.m_toi;else{var h=a.getFixtureA(),c=a.getFixtureB();if(h.isSensor()||c.isSensor())continue;var _=h.getBody(),l=c.getBody(),u=_.isAwake()&&!_.isStatic(),p=l.isAwake()&&!l.isStatic();if(0==u&&0==p)continue;var y=_.isBullet()||!_.isDynamic(),d=l.isBullet()||!l.isDynamic();if(0==y&&0==d)continue;var f=_.m_sweep.alpha0;_.m_sweep.alpha0<l.m_sweep.alpha0?(f=l.m_sweep.alpha0,_.m_sweep.advance(f)):l.m_sweep.alpha0<_.m_sweep.alpha0&&(f=_.m_sweep.alpha0,l.m_sweep.advance(f));var v=a.getChildIndexA(),x=a.getChildIndexB();_.m_sweep,l.m_sweep,He.proxyA.set(h.getShape(),v),He.proxyB.set(c.getShape(),x),He.sweepA.set(_.m_sweep),He.sweepB.set(l.m_sweep),He.tMax=1,ke(Ue,He);var A=Ue.t;m=Ue.state==t.TOIOutputState.e_touching?Oe(f+(1-f)*A,1):1,a.m_toi=m,a.m_toiFlag=!0}m<r&&(n=a,r=m)}if(null==n||1-1e-8<r){i.m_stepComplete=!0;break}var b=n.getFixtureA(),B=n.getFixtureB(),w=b.getBody(),V=B.getBody();if(Ke.set(w.m_sweep),Xe.set(V.m_sweep),w.advance(r),V.advance(r),n.update(i),n.m_toiFlag=!1,++n.m_toiCount,0!=n.isEnabled()&&0!=n.isTouching()){w.setAwake(!0),V.setAwake(!0),this.clear(),this.addBody(w),this.addBody(V),this.addContact(n),w.m_islandFlag=!0,V.m_islandFlag=!0,n.m_islandFlag=!0;for(var C=[w,V],M=0;M<C.length;++M){if((F=C[M]).isDynamic())for(var I=F.m_contactList;I;I=I.next){var P=I.contact;if(!P.m_islandFlag){var S=I.other;if(!S.isDynamic()||F.isBullet()||S.isBullet()){var T=P.m_fixtureA.m_isSensor,z=P.m_fixtureB.m_isSensor;T||z||(Ze.set(S.m_sweep),0==S.m_islandFlag&&S.advance(r),P.update(i),0!=P.isEnabled()&&0!=P.isTouching()?(P.m_islandFlag=!0,this.addContact(P),S.m_islandFlag||(S.m_islandFlag=!0,S.isStatic()||S.setAwake(!0),this.addBody(S))):(S.m_sweep.set(Ze),S.synchronizeTransform()))}}}}Ee.reset((1-r)*e.dt),Ee.dtRatio=1,Ee.positionIterations=20,Ee.velocityIterations=e.velocityIterations,Ee.warmStarting=!1,this.solveIslandTOI(Ee,w,V);for(M=0;M<this.m_bodies.length;++M){var F;if((F=this.m_bodies[M]).m_islandFlag=!1,F.isDynamic()){F.synchronizeFixtures();for(I=F.m_contactList;I;I=I.next)I.contact.m_toiFlag=!1,I.contact.m_islandFlag=!1}}if(i.findNewContacts(),i.m_subStepping){i.m_stepComplete=!1;break}}else n.setEnabled(!1),w.m_sweep.set(Ke),V.m_sweep.set(Xe),w.synchronizeTransform(),V.synchronizeTransform()}},e.prototype.solveIslandTOI=function(t,e,i){for(var o=0;o<this.m_bodies.length;++o){N((m=this.m_bodies[o]).c_position.c,m.m_sweep.c),m.c_position.a=m.m_sweep.a,N(m.c_velocity.v,m.m_linearVelocity),m.c_velocity.w=m.m_angularVelocity}for(o=0;o<this.m_contacts.length;++o){this.m_contacts[o].initConstraint(t)}for(o=0;o<t.positionIterations;++o){for(var s=0,n=0;n<this.m_contacts.length;++n){var r=this.m_contacts[n].solvePositionConstraintTOI(t,e,i);s=Oe(s,r)}if(s>=-1.5*g.linearSlop)break}N(e.m_sweep.c0,e.c_position.c),e.m_sweep.a0=e.c_position.a,N(i.m_sweep.c0,i.c_position.c),i.m_sweep.a0=i.c_position.a;for(o=0;o<this.m_contacts.length;++o){this.m_contacts[o].initVelocityConstraint(t)}for(o=0;o<t.velocityIterations;++o)for(n=0;n<this.m_contacts.length;++n){this.m_contacts[n].solveVelocityConstraint(t)}var a=t.dt;for(o=0;o<this.m_bodies.length;++o){var m=this.m_bodies[o];N(Je,m.c_position.c);var h=m.c_position.a;N(Ye,m.c_velocity.v);var c=m.c_velocity.w;Y(We,a,Ye);var _=$(We);if(_>g.maxTranslationSquared){var l=g.maxTranslation/De(_);J(Ye,l)}var u=a*c;if(u*u>g.maxRotationSquared)c*=l=g.maxRotation/je(u);W(Je,a,Ye),h+=a*c,N(m.c_position.c,Je),m.c_position.a=h,N(m.c_velocity.v,Ye),m.c_velocity.w=c,N(m.m_sweep.c,Je),m.m_sweep.a=h,N(m.m_linearVelocity,Ye),m.m_angularVelocity=c,m.synchronizeTransform()}this.postSolveIsland()},e.prototype.postSolveIsland=function(){for(var t=0;t<this.m_contacts.length;++t){var e=this.m_contacts[t];this.m_world.postSolve(e,e.m_impulse)}},e}();Qe.TimeStep=Re;var $e,ti,ei,ii=function(){function t(t,e,i,o){"object"==typeof t&&null!==t?(this.ex=y.clone(t),this.ey=y.clone(e)):"number"==typeof t?(this.ex=y.neo(t,i),this.ey=y.neo(e,o)):(this.ex=y.zero(),this.ey=y.zero())}return t.prototype.toString=function(){return JSON.stringify(this)},t.isValid=function(t){return null!=t&&(y.isValid(t.ex)&&y.isValid(t.ey))},t.assert=function(t){},t.prototype.set=function(t,e,i,o){"number"==typeof t&&"number"==typeof e&&"number"==typeof i&&"number"==typeof o?(this.ex.setNum(t,i),this.ey.setNum(e,o)):"object"==typeof t&&"object"==typeof e?(this.ex.setVec2(t),this.ey.setVec2(e)):"object"==typeof t&&(this.ex.setVec2(t.ex),this.ey.setVec2(t.ey))},t.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},t.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},t.prototype.getInverse=function(){var e=this.ex.x,i=this.ey.x,o=this.ex.y,s=this.ey.y,n=e*s-i*o;0!==n&&(n=1/n);var r=new t;return r.ex.x=n*s,r.ey.x=-n*i,r.ex.y=-n*o,r.ey.y=n*e,r},t.prototype.solve=function(t){var e=this.ex.x,i=this.ey.x,o=this.ex.y,s=this.ey.y,n=e*s-i*o;0!==n&&(n=1/n);var r=y.zero();return r.x=n*(s*t.x-i*t.y),r.y=n*(e*t.y-o*t.x),r},t.mul=function(e,i){if(i&&"x"in i&&"y"in i){var o=e.ex.x*i.x+e.ey.x*i.y,s=e.ex.y*i.x+e.ey.y*i.y;return y.neo(o,s)}if(i&&"ex"in i&&"ey"in i)return new t(e.ex.x*i.ex.x+e.ey.x*i.ex.y,e.ex.x*i.ey.x+e.ey.x*i.ey.y,e.ex.y*i.ex.x+e.ey.y*i.ex.y,e.ex.y*i.ey.x+e.ey.y*i.ey.y)},t.mulVec2=function(t,e){var i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return y.neo(i,o)},t.mulMat22=function(e,i){return new t(e.ex.x*i.ex.x+e.ey.x*i.ex.y,e.ex.x*i.ey.x+e.ey.x*i.ey.y,e.ex.y*i.ex.x+e.ey.y*i.ex.y,e.ex.y*i.ey.x+e.ey.y*i.ey.y)},t.mulT=function(e,i){return i&&"x"in i&&"y"in i?y.neo(y.dot(i,e.ex),y.dot(i,e.ey)):i&&"ex"in i&&"ey"in i?new t(y.neo(y.dot(e.ex,i.ex),y.dot(e.ey,i.ex)),y.neo(y.dot(e.ex,i.ey),y.dot(e.ey,i.ey))):void 0},t.mulTVec2=function(t,e){return y.neo(y.dot(e,t.ex),y.dot(e,t.ey))},t.mulTMat22=function(e,i){return new t(y.neo(y.dot(e.ex,i.ex),y.dot(e.ey,i.ex)),y.neo(y.dot(e.ex,i.ey),y.dot(e.ey,i.ey)))},t.abs=function(e){return new t(y.abs(e.ex),y.abs(e.ey))},t.add=function(e,i){return new t(y.add(e.ex,i.ex),y.add(e.ey,i.ey))},t}(),oi=Math.sqrt,si=q(0,0),ni=q(0,0),ri=q(0,0),ai=q(0,0),mi=q(0,0),hi=q(0,0),ci=q(0,0),_i=q(0,0);t.ManifoldType=void 0,($e=t.ManifoldType||(t.ManifoldType={}))[$e.e_unset=-1]="e_unset",$e[$e.e_circles=0]="e_circles",$e[$e.e_faceA=1]="e_faceA",$e[$e.e_faceB=2]="e_faceB",t.ContactFeatureType=void 0,(ti=t.ContactFeatureType||(t.ContactFeatureType={}))[ti.e_unset=-1]="e_unset",ti[ti.e_vertex=0]="e_vertex",ti[ti.e_face=1]="e_face",t.PointState=void 0,(ei=t.PointState||(t.PointState={}))[ei.nullState=0]="nullState",ei[ei.addState=1]="addState",ei[ei.persistState=2]="persistState",ei[ei.removeState=3]="removeState";var li=function(){function t(){this.v=q(0,0),this.id=new yi}return t.prototype.set=function(t){N(this.v,t.v),this.id.set(t.id)},t.prototype.recycle=function(){j(this.v),this.id.recycle()},t}(),ui=function(){function e(){this.localNormal=q(0,0),this.localPoint=q(0,0),this.points=[new pi,new pi],this.pointCount=0}return e.prototype.set=function(t){this.type=t.type,N(this.localNormal,t.localNormal),N(this.localPoint,t.localPoint),this.pointCount=t.pointCount,this.points[0].set(t.points[0]),this.points[1].set(t.points[1])},e.prototype.recycle=function(){this.type=t.ManifoldType.e_unset,j(this.localNormal),j(this.localPoint),this.pointCount=0,this.points[0].recycle(),this.points[1].recycle()},e.prototype.getWorldManifold=function(e,i,o,s,n){if(0==this.pointCount)return e;(e=e||new di).pointCount=this.pointCount;var r=e.normal,a=e.points,m=e.separations;switch(this.type){case t.ManifoldType.e_circles:k(r,1,0);var h=this.points[0];rt(si,i,this.localPoint),rt(ni,s,h.localPoint),E(hi,ni,si);var c=$(hi);if(c>1e-18)Y(r,1/oi(c),hi);U(ai,1,si,o,r),U(mi,1,ni,-n,r),U(a[0],.5,ai,.5,mi),m[0]=Q(E(ri,mi,ai),r);break;case t.ManifoldType.e_faceA:it(r,i.q,this.localNormal),rt(ci,i,this.localPoint);for(var _=0;_<this.pointCount;++_){h=this.points[_];rt(_i,s,h.localPoint),U(ai,1,_i,o-Q(E(ri,_i,ci),r),r),U(mi,1,_i,-n,r),U(a[_],.5,ai,.5,mi),m[_]=Q(E(ri,mi,ai),r)}break;case t.ManifoldType.e_faceB:it(r,s.q,this.localNormal),rt(ci,s,this.localPoint);for(_=0;_<this.pointCount;++_){h=this.points[_];rt(_i,i,h.localPoint),U(mi,1,_i,n-Q(E(ri,_i,ci),r),r),U(ai,1,_i,-o,r),U(a[_],.5,ai,.5,mi),m[_]=Q(E(ri,ai,mi),r)}D(r)}return e},e.clipSegmentToLine=vi,e.ClipVertex=li,e.getPointStates=fi,e.PointState=t.PointState,e}(),pi=function(){function t(){this.localPoint=q(0,0),this.normalImpulse=0,this.tangentImpulse=0,this.id=new yi}return t.prototype.set=function(t){N(this.localPoint,t.localPoint),this.normalImpulse=t.normalImpulse,this.tangentImpulse=t.tangentImpulse,this.id.set(t.id)},t.prototype.recycle=function(){j(this.localPoint),this.normalImpulse=0,this.tangentImpulse=0,this.id.recycle()},t}(),yi=function(){function e(){this.key=-1,this.indexA=-1,this.indexB=-1,this.typeA=t.ContactFeatureType.e_unset,this.typeB=t.ContactFeatureType.e_unset}return e.prototype.setFeatures=function(t,e,i,o){this.indexA=t,this.indexB=i,this.typeA=e,this.typeB=o,this.key=this.indexA+4*this.indexB+16*this.typeA+64*this.typeB},e.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB,this.key=this.indexA+4*this.indexB+16*this.typeA+64*this.typeB},e.prototype.swapFeatures=function(){var t=this.indexA,e=this.indexB,i=this.typeA,o=this.typeB;this.indexA=e,this.indexB=t,this.typeA=o,this.typeB=i,this.key=this.indexA+4*this.indexB+16*this.typeA+64*this.typeB},e.prototype.recycle=function(){this.indexA=0,this.indexB=0,this.typeA=t.ContactFeatureType.e_unset,this.typeB=t.ContactFeatureType.e_unset,this.key=-1},e}(),di=function(){function t(){this.normal=q(0,0),this.points=[q(0,0),q(0,0)],this.separations=[0,0],this.pointCount=0}return t.prototype.recycle=function(){j(this.normal),j(this.points[0]),j(this.points[1]),this.separations[0]=0,this.separations[1]=0,this.pointCount=0},t}();function fi(e,i,o,s){for(var n=0;n<o.pointCount;++n){var r=o.points[n].id;e[n]=t.PointState.removeState;for(var a=0;a<s.pointCount;++a)if(s.points[a].id.key===r.key){e[n]=t.PointState.persistState;break}}for(n=0;n<s.pointCount;++n){r=s.points[n].id;i[n]=t.PointState.addState;for(a=0;a<o.pointCount;++a)if(o.points[a].id.key===r.key){i[n]=t.PointState.persistState;break}}}function vi(e,i,o,s,n){var r=0,a=Q(o,i[0].v)-s,m=Q(o,i[1].v)-s;if(a<=0&&e[r++].set(i[0]),m<=0&&e[r++].set(i[1]),a*m<0){var h=a/(a-m);U(e[r].v,1-h,i[0].v,h,i[1].v),e[r].id.setFeatures(n,t.ContactFeatureType.e_vertex,i[0].id.indexB,t.ContactFeatureType.e_face),++r}return r}var xi=Math.sqrt,Ai=Math.max,gi=Math.min,bi=new b({create:function(){return new io},release:function(t){t.recycle()}}),Bi=new ui,wi=new di,Vi=function(){function t(t){this.prev=null,this.next=null,this.other=null,this.contact=t}return t.prototype.recycle=function(){this.prev=null,this.next=null,this.other=null},t}();function Ci(t,e){return xi(t*e)}function Mi(t,e){return t>e?t:e}var Ii=[],Pi=function(){function t(){this.rA=q(0,0),this.rB=q(0,0),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}return t.prototype.recycle=function(){j(this.rA),j(this.rB),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0},t}(),Si=q(0,0),Ti=q(0,0),zi=q(0,0),Fi=q(0,0),Li=q(0,0),qi=st(0,0,0),ki=st(0,0,0),Ni=q(0,0),ji=q(0,0),Di=q(0,0),Oi=q(0,0),Ri=q(0,0),Ei=q(0,0),Ji=q(0,0),Yi=q(0,0),Wi=q(0,0),Hi=q(0,0),Ui=q(0,0),Zi=q(0,0),Ki=q(0,0),Xi=q(0,0),Gi=q(0,0),Qi=q(0,0),$i=q(0,0),to=q(0,0),eo=q(0,0),io=function(){function e(){this.m_nodeA=new Vi(this),this.m_nodeB=new Vi(this),this.m_fixtureA=null,this.m_fixtureB=null,this.m_indexA=-1,this.m_indexB=-1,this.m_evaluateFcn=null,this.m_manifold=new ui,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_impulse=new Ge(this),this.v_points=[new Pi,new Pi],this.v_normal=q(0,0),this.v_normalMass=new ii,this.v_K=new ii,this.v_pointCount=0,this.v_tangentSpeed=0,this.v_friction=0,this.v_restitution=0,this.v_invMassA=0,this.v_invMassB=0,this.v_invIA=0,this.v_invIB=0,this.p_localPoints=[q(0,0),q(0,0)],this.p_localNormal=q(0,0),this.p_localPoint=q(0,0),this.p_localCenterA=q(0,0),this.p_localCenterB=q(0,0),this.p_type=t.ManifoldType.e_unset,this.p_radiusA=0,this.p_radiusB=0,this.p_pointCount=0,this.p_invMassA=0,this.p_invMassB=0,this.p_invIA=0,this.p_invIB=0}return e.prototype.initialize=function(t,e,i,o,s){this.m_fixtureA=t,this.m_fixtureB=i,this.m_indexA=e,this.m_indexB=o,this.m_evaluateFcn=s,this.m_friction=Ci(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=Mi(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},e.prototype.recycle=function(){this.m_nodeA.recycle(),this.m_nodeB.recycle(),this.m_fixtureA=null,this.m_fixtureB=null,this.m_indexA=-1,this.m_indexB=-1,this.m_evaluateFcn=null,this.m_manifold.recycle(),this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=0,this.m_restitution=0,this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_impulse.recycle();for(var e=0,i=this.v_points;e<i.length;e++){i[e].recycle()}j(this.v_normal),this.v_normalMass.setZero(),this.v_K.setZero(),this.v_pointCount=0,this.v_tangentSpeed=0,this.v_friction=0,this.v_restitution=0,this.v_invMassA=0,this.v_invMassB=0,this.v_invIA=0,this.v_invIB=0;for(var o=0,s=this.p_localPoints;o<s.length;o++){j(s[o])}j(this.p_localNormal),j(this.p_localPoint),j(this.p_localCenterA),j(this.p_localCenterB),this.p_type=t.ManifoldType.e_unset,this.p_radiusA=0,this.p_radiusB=0,this.p_pointCount=0,this.p_invMassA=0,this.p_invMassB=0,this.p_invIA=0,this.p_invIB=0},e.prototype.initConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB;if(null!==e&&null!==i){var o=e.m_body,s=i.m_body;if(null!==o&&null!==s){var n=e.m_shape,r=i.m_shape;if(null!==n&&null!==r){var a=this.m_manifold,m=a.pointCount;this.v_invMassA=o.m_invMass,this.v_invMassB=s.m_invMass,this.v_invIA=o.m_invI,this.v_invIB=s.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=m,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=o.m_invMass,this.p_invMassB=s.m_invMass,this.p_invIA=o.m_invI,this.p_invIB=s.m_invI,N(this.p_localCenterA,o.m_sweep.localCenter),N(this.p_localCenterB,s.m_sweep.localCenter),this.p_radiusA=n.m_radius,this.p_radiusB=r.m_radius,this.p_type=a.type,N(this.p_localNormal,a.localNormal),N(this.p_localPoint,a.localPoint),this.p_pointCount=m;for(var h=0;h<g.maxManifoldPoints;++h)this.v_points[h].recycle(),j(this.p_localPoints[h]);for(h=0;h<m;++h){var c=a.points[h],_=this.v_points[h];t.warmStarting&&(_.normalImpulse=t.dtRatio*c.normalImpulse,_.tangentImpulse=t.dtRatio*c.tangentImpulse),N(this.p_localPoints[h],c.localPoint)}}}}},e.prototype.getManifold=function(){return this.m_manifold},e.prototype.getWorldManifold=function(t){var e=this.m_fixtureA,i=this.m_fixtureB;if(null!==e&&null!==i){var o=e.m_body,s=i.m_body;if(null!==o&&null!==s){var n=e.m_shape,r=i.m_shape;if(null!==n&&null!==r)return this.m_manifold.getWorldManifold(t,o.getTransform(),n.m_radius,s.getTransform(),r.m_radius)}}},e.prototype.setEnabled=function(t){this.m_enabledFlag=!!t},e.prototype.isEnabled=function(){return this.m_enabledFlag},e.prototype.isTouching=function(){return this.m_touchingFlag},e.prototype.getNext=function(){return this.m_next},e.prototype.getFixtureA=function(){return this.m_fixtureA},e.prototype.getFixtureB=function(){return this.m_fixtureB},e.prototype.getChildIndexA=function(){return this.m_indexA},e.prototype.getChildIndexB=function(){return this.m_indexB},e.prototype.flagForFiltering=function(){this.m_filterFlag=!0},e.prototype.setFriction=function(t){this.m_friction=t},e.prototype.getFriction=function(){return this.m_friction},e.prototype.resetFriction=function(){var t=this.m_fixtureA,e=this.m_fixtureB;null!==t&&null!==e&&(this.m_friction=Ci(t.m_friction,e.m_friction))},e.prototype.setRestitution=function(t){this.m_restitution=t},e.prototype.getRestitution=function(){return this.m_restitution},e.prototype.resetRestitution=function(){var t=this.m_fixtureA,e=this.m_fixtureB;null!==t&&null!==e&&(this.m_restitution=Mi(t.m_restitution,e.m_restitution))},e.prototype.setTangentSpeed=function(t){this.m_tangentSpeed=t},e.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},e.prototype.evaluate=function(t,e,i){var o=this.m_fixtureA,s=this.m_fixtureB;null!==o&&null!==s&&this.m_evaluateFcn(t,e,o,this.m_indexA,i,s,this.m_indexB)},e.prototype.update=function(t){var e=this.m_fixtureA,i=this.m_fixtureB;if(null!==e&&null!==i){var o=e.m_body,s=i.m_body;if(null!==o&&null!==s){var n=e.m_shape,r=i.m_shape;if(null!==n&&null!==r){this.m_enabledFlag=!0;var a=!1,m=this.m_touchingFlag,h=e.m_isSensor,c=i.m_isSensor,_=h||c,l=o.m_xf,u=s.m_xf;if(_)a=ue(n,this.m_indexA,r,this.m_indexB,l,u),this.m_manifold.pointCount=0;else{Bi.recycle(),Bi.set(this.m_manifold),this.m_manifold.recycle(),this.evaluate(this.m_manifold,l,u),a=this.m_manifold.pointCount>0;for(var p=0;p<this.m_manifold.pointCount;++p){var y=this.m_manifold.points[p];y.normalImpulse=0,y.tangentImpulse=0;for(var d=0;d<Bi.pointCount;++d){var f=Bi.points[d];if(f.id.key===y.id.key){y.normalImpulse=f.normalImpulse,y.tangentImpulse=f.tangentImpulse;break}}}a!==m&&(o.setAwake(!0),s.setAwake(!0))}this.m_touchingFlag=a;var v="object"==typeof t&&null!==t;!m&&a&&v&&t.beginContact(this),m&&!a&&v&&t.endContact(this),!_&&a&&v&&Bi&&t.preSolve(this,Bi)}}}},e.prototype.solvePositionConstraint=function(t){return this._solvePositionConstraint(t,null,null)},e.prototype.solvePositionConstraintTOI=function(t,e,i){return this._solvePositionConstraint(t,e,i)},e.prototype._solvePositionConstraint=function(e,i,o){var s=null!==i&&null!==o,n=0,r=this.m_fixtureA,a=this.m_fixtureB;if(null===r||null===a)return n;var m=r.m_body,c=a.m_body;if(null===m||null===c)return n;m.c_velocity,c.c_velocity;var _=m.c_position,l=c.c_position,u=this.p_localCenterA,p=this.p_localCenterB,y=0,d=0;s&&m!==i&&m!==o||(y=this.p_invMassA,d=this.p_invIA);var f=0,v=0;s&&c!==i&&c!==o||(f=this.p_invMassB,v=this.p_invIB),N(Si,_.c);var x=_.a;N(zi,l.c);for(var A=l.a,b=0;b<this.p_pointCount;++b){Bt(qi,u,Si,x),Bt(ki,p,zi,A);var B=void 0;switch(this.p_type){case t.ManifoldType.e_circles:rt(Ni,qi,this.p_localPoint),rt(ji,ki,this.p_localPoints[0]),E(Yi,ji,Ni),Z(Yi),U(Wi,.5,Ni,.5,ji),B=Q(ji,Yi)-Q(Ni,Yi)-this.p_radiusA-this.p_radiusB;break;case t.ManifoldType.e_faceA:it(Yi,qi.q,this.p_localNormal),rt(Oi,qi,this.p_localPoint),rt(Di,ki,this.p_localPoints[b]),B=Q(Di,Yi)-Q(Oi,Yi)-this.p_radiusA-this.p_radiusB,N(Wi,Di);break;case t.ManifoldType.e_faceB:it(Yi,ki.q,this.p_localNormal),rt(Oi,ki,this.p_localPoint),rt(Di,qi,this.p_localPoints[b]),B=Q(Di,Yi)-Q(Oi,Yi)-this.p_radiusA-this.p_radiusB,N(Wi,Di),D(Yi);break;default:return n}E(Ri,Wi,Si),E(Ei,Wi,zi),n=gi(n,B);var w=h((s?g.toiBaugarte:g.baumgarte)*(B+g.linearSlop),-g.maxLinearCorrection,0),V=G(Ri,Yi),C=G(Ei,Yi),M=y+f+d*V*V+v*C*C;Y(Ji,M>0?-w/M:0,Yi),H(Si,y,Ji),x-=d*G(Ri,Ji),W(zi,f,Ji),A+=v*G(Ei,Ji)}return N(_.c,Si),_.a=x,N(l.c,zi),l.a=A,n},e.prototype.initVelocityConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB;if(null!==e&&null!==i){var o=e.m_body,s=i.m_body;if(null!==o&&null!==s){var n=o.c_velocity,r=s.c_velocity,a=o.c_position,m=s.c_position,h=this.p_radiusA,c=this.p_radiusB,_=this.m_manifold,l=this.v_invMassA,u=this.v_invMassB,p=this.v_invIA,y=this.v_invIB,d=this.p_localCenterA,f=this.p_localCenterB;N(Si,a.c);var v=a.a;N(Ti,n.v);var x=n.w;N(zi,m.c);var A=m.a;N(Fi,r.v);var b=r.w;Bt(qi,d,Si,v),Bt(ki,f,zi,A),wi.recycle(),_.getWorldManifold(wi,qi,h,ki,c),N(this.v_normal,wi.normal);for(var B=0;B<this.v_pointCount;++B){var w=this.v_points[B],V=wi.points[B];E(w.rA,V,Si),E(w.rB,V,zi);var C=G(w.rA,this.v_normal),M=G(w.rB,this.v_normal),I=l+u+p*C*C+y*M*M;w.normalMass=I>0?1/I:0,K(Li,this.v_normal,1);var P=G(w.rA,Li),S=G(w.rB,Li),T=l+u+p*P*P+y*S*S;w.tangentMass=T>0?1/T:0,w.velocityBias=0;var z=0;z+=Q(this.v_normal,Fi),z+=Q(this.v_normal,X(eo,b,w.rB)),z-=Q(this.v_normal,Ti),(z-=Q(this.v_normal,X(eo,x,w.rA)))<-g.velocityThreshold&&(w.velocityBias=-this.v_restitution*z)}if(2==this.v_pointCount&&t.blockSolve){var F=this.v_points[0],L=this.v_points[1],q=G(F.rA,this.v_normal),k=G(F.rB,this.v_normal),j=G(L.rA,this.v_normal),D=G(L.rB,this.v_normal),O=l+u+p*q*q+y*k*k,R=l+u+p*j*j+y*D*D,J=l+u+p*q*j+y*k*D;if(O*O<1e3*(O*R-J*J)){this.v_K.ex.setNum(O,J),this.v_K.ey.setNum(J,R);var Y=this.v_K.ex.x,W=this.v_K.ey.x,H=this.v_K.ex.y,U=this.v_K.ey.y,Z=Y*U-W*H;0!==Z&&(Z=1/Z),this.v_normalMass.ex.x=Z*U,this.v_normalMass.ey.x=-Z*W,this.v_normalMass.ex.y=-Z*H,this.v_normalMass.ey.y=Z*Y}else this.v_pointCount=1}N(a.c,Si),a.a=v,N(n.v,Ti),n.w=x,N(m.c,zi),m.a=A,N(r.v,Fi),r.w=b}}},e.prototype.warmStartConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB;if(null!==e&&null!==i){var o=e.m_body,s=i.m_body;if(null!==o&&null!==s){var n=o.c_velocity,r=s.c_velocity;o.c_position,s.c_position;var a=this.v_invMassA,m=this.v_invIA,h=this.v_invMassB,c=this.v_invIB;N(Ti,n.v);var _=n.w;N(Fi,r.v);var l=r.w;N(Yi,this.v_normal),K(Li,Yi,1);for(var u=0;u<this.v_pointCount;++u){var p=this.v_points[u];U(Ji,p.normalImpulse,Yi,p.tangentImpulse,Li),_-=m*G(p.rA,Ji),H(Ti,a,Ji),l+=c*G(p.rB,Ji),W(Fi,h,Ji)}N(n.v,Ti),n.w=_,N(r.v,Fi),r.w=l}}},e.prototype.storeConstraintImpulses=function(t){for(var e=this.m_manifold,i=0;i<this.v_pointCount;++i)e.points[i].normalImpulse=this.v_points[i].normalImpulse,e.points[i].tangentImpulse=this.v_points[i].tangentImpulse},e.prototype.solveVelocityConstraint=function(t){var e=this.m_fixtureA,i=this.m_fixtureB;if(null!==e&&null!==i){var o=e.m_body,s=i.m_body;if(null!==o&&null!==s){var n=o.c_velocity;o.c_position;var r=s.c_velocity;s.c_position;var a=this.v_invMassA,m=this.v_invIA,c=this.v_invMassB,_=this.v_invIB;N(Ti,n.v);var l=n.w;N(Fi,r.v);var u=r.w;N(Yi,this.v_normal),K(Li,Yi,1);for(var p=this.v_friction,y=0;y<this.v_pointCount;++y){var d=this.v_points[y];j(Hi),O(Hi,Fi),O(Hi,X(eo,u,d.rB)),R(Hi,Ti),R(Hi,X(eo,l,d.rA));var f=Q(Hi,Li)-this.v_tangentSpeed,v=d.tangentMass*-f,x=p*d.normalImpulse;v=(g=h(d.tangentImpulse+v,-x,x))-d.tangentImpulse,d.tangentImpulse=g,Y(Ji,v,Li),H(Ti,a,Ji),l-=m*G(d.rA,Ji),W(Fi,c,Ji),u+=_*G(d.rB,Ji)}if(1==this.v_pointCount||0==t.blockSolve)for(var A=0;A<this.v_pointCount;++A){d=this.v_points[A];j(Hi),O(Hi,Fi),O(Hi,X(eo,u,d.rB)),R(Hi,Ti),R(Hi,X(eo,l,d.rA));var g,b=Q(Hi,Yi);v=-d.normalMass*(b-d.velocityBias);v=(g=Ai(d.normalImpulse+v,0))-d.normalImpulse,d.normalImpulse=g,Y(Ji,v,Yi),H(Ti,a,Ji),l-=m*G(d.rA,Ji),W(Fi,c,Ji),u+=_*G(d.rB,Ji)}else{var B=this.v_points[0],w=this.v_points[1];k(Xi,B.normalImpulse,w.normalImpulse),j(Ui),O(Ui,Fi),O(Ui,X(eo,u,B.rB)),R(Ui,Ti),R(Ui,X(eo,l,B.rA)),j(Zi),O(Zi,Fi),O(Zi,X(eo,u,w.rB)),R(Zi,Ti),R(Zi,X(eo,l,w.rA));var V=Q(Ui,Yi),C=Q(Zi,Yi);for(k(Ki,V-B.velocityBias,C-w.velocityBias),Ki.x-=this.v_K.ex.x*Xi.x+this.v_K.ey.x*Xi.y,Ki.y-=this.v_K.ex.y*Xi.x+this.v_K.ey.y*Xi.y;;){if(j(Gi),Gi.x=-(this.v_normalMass.ex.x*Ki.x+this.v_normalMass.ey.x*Ki.y),Gi.y=-(this.v_normalMass.ex.y*Ki.x+this.v_normalMass.ey.y*Ki.y),Gi.x>=0&&Gi.y>=0){E(Qi,Gi,Xi),Y($i,Qi.x,Yi),Y(to,Qi.y,Yi),H(Ti,a,$i),H(Ti,a,to),l-=m*(G(B.rA,$i)+G(w.rA,to)),W(Fi,c,$i),W(Fi,c,to),u+=_*(G(B.rB,$i)+G(w.rB,to)),B.normalImpulse=Gi.x,w.normalImpulse=Gi.y;break}if(Gi.x=-B.normalMass*Ki.x,Gi.y=0,V=0,C=this.v_K.ex.y*Gi.x+Ki.y,Gi.x>=0&&C>=0){E(Qi,Gi,Xi),Y($i,Qi.x,Yi),Y(to,Qi.y,Yi),H(Ti,a,$i),H(Ti,a,to),l-=m*(G(B.rA,$i)+G(w.rA,to)),W(Fi,c,$i),W(Fi,c,to),u+=_*(G(B.rB,$i)+G(w.rB,to)),B.normalImpulse=Gi.x,w.normalImpulse=Gi.y;break}if(Gi.x=0,Gi.y=-w.normalMass*Ki.y,V=this.v_K.ey.x*Gi.y+Ki.x,C=0,Gi.y>=0&&V>=0){E(Qi,Gi,Xi),Y($i,Qi.x,Yi),Y(to,Qi.y,Yi),H(Ti,a,$i),H(Ti,a,to),l-=m*(G(B.rA,$i)+G(w.rA,to)),W(Fi,c,$i),W(Fi,c,to),u+=_*(G(B.rB,$i)+G(w.rB,to)),B.normalImpulse=Gi.x,w.normalImpulse=Gi.y;break}if(Gi.x=0,Gi.y=0,V=Ki.x,C=Ki.y,V>=0&&C>=0){E(Qi,Gi,Xi),Y($i,Qi.x,Yi),Y(to,Qi.y,Yi),H(Ti,a,$i),H(Ti,a,to),l-=m*(G(B.rA,$i)+G(w.rA,to)),W(Fi,c,$i),W(Fi,c,to),u+=_*(G(B.rB,$i)+G(w.rB,to)),B.normalImpulse=Gi.x,w.normalImpulse=Gi.y;break}break}}N(n.v,Ti),n.w=l,N(r.v,Fi),r.w=u}}},e.addType=function(t,e,i){Ii[t]=Ii[t]||{},Ii[t][e]=i},e.create=function(t,e,i,o){var s,n=t.m_shape.m_type,r=i.m_shape.m_type,a=bi.allocate();if(s=Ii[n]&&Ii[n][r])a.initialize(t,e,i,o,s);else{if(!(s=Ii[r]&&Ii[r][n]))return null;a.initialize(i,o,t,e,s)}t=a.m_fixtureA,i=a.m_fixtureB,e=a.getChildIndexA(),o=a.getChildIndexB();var m=t.m_body,h=i.m_body;return a.m_nodeA.contact=a,a.m_nodeA.other=h,a.m_nodeA.prev=null,a.m_nodeA.next=m.m_contactList,null!=m.m_contactList&&(m.m_contactList.prev=a.m_nodeA),m.m_contactList=a.m_nodeA,a.m_nodeB.contact=a,a.m_nodeB.other=m,a.m_nodeB.prev=null,a.m_nodeB.next=h.m_contactList,null!=h.m_contactList&&(h.m_contactList.prev=a.m_nodeB),h.m_contactList=a.m_nodeB,0==t.isSensor()&&0==i.isSensor()&&(m.setAwake(!0),h.setAwake(!0)),a},e.destroy=function(t,e){var i=t.m_fixtureA,o=t.m_fixtureB;if(null!==i&&null!==o){var s=i.m_body,n=o.m_body;null!==s&&null!==n&&(t.isTouching()&&e.endContact(t),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==s.m_contactList&&(s.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==n.m_contactList&&(n.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&!i.m_isSensor&&!o.m_isSensor&&(s.setAwake(!0),n.setAwake(!0)),bi.release(t))}},e}(),oo={gravity:y.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3},so=function(){function t(e){if(!(this instanceof t))return new t(e);this.s_step=new Re,e&&y.isValid(e)&&(e={gravity:e}),e=s(e,oo),this.m_solver=new Qe(this),this.m_broadPhase=new T,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=e.allowSleep,this.m_gravity=y.clone(e.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=e.warmStarting,this.m_continuousPhysics=e.continuousPhysics,this.m_subStepping=e.subStepping,this.m_blockSolve=e.blockSolve,this.m_velocityIterations=e.velocityIterations,this.m_positionIterations=e.positionIterations,this.m_t=0}return t.prototype._serialize=function(){for(var t=[],e=[],i=this.getBodyList();i;i=i.getNext())t.push(i);for(var o=this.getJointList();o;o=o.getNext())"function"==typeof o._serialize&&e.push(o);return{gravity:this.m_gravity,bodies:t,joints:e}},t._deserialize=function(e,i,o){if(!e)return new t;var s=new t(e.gravity);if(e.bodies)for(var n=e.bodies.length-1;n>=0;n-=1)s._addBody(o(Ot,e.bodies[n],s));if(e.joints)for(n=e.joints.length-1;n>=0;n--)s.createJoint(o(Et,e.joints[n],s));return s},t.prototype.getBodyList=function(){return this.m_bodyList},t.prototype.getJointList=function(){return this.m_jointList},t.prototype.getContactList=function(){return this.m_contactList},t.prototype.getBodyCount=function(){return this.m_bodyCount},t.prototype.getJointCount=function(){return this.m_jointCount},t.prototype.getContactCount=function(){return this.m_contactCount},t.prototype.setGravity=function(t){this.m_gravity=t},t.prototype.getGravity=function(){return this.m_gravity},t.prototype.isLocked=function(){return this.m_locked},t.prototype.setAllowSleeping=function(t){if(t!=this.m_allowSleep&&(this.m_allowSleep=t,0==this.m_allowSleep))for(var e=this.m_bodyList;e;e=e.m_next)e.setAwake(!0)},t.prototype.getAllowSleeping=function(){return this.m_allowSleep},t.prototype.setWarmStarting=function(t){this.m_warmStarting=t},t.prototype.getWarmStarting=function(){return this.m_warmStarting},t.prototype.setContinuousPhysics=function(t){this.m_continuousPhysics=t},t.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},t.prototype.setSubStepping=function(t){this.m_subStepping=t},t.prototype.getSubStepping=function(){return this.m_subStepping},t.prototype.setAutoClearForces=function(t){this.m_clearForces=t},t.prototype.getAutoClearForces=function(){return this.m_clearForces},t.prototype.clearForces=function(){for(var t=this.m_bodyList;t;t=t.getNext())t.m_force.setZero(),t.m_torque=0},t.prototype.queryAABB=function(t,e){var i=this.m_broadPhase;this.m_broadPhase.query(t,function(t){var o=i.getUserData(t);return e(o.fixture)})},t.prototype.rayCast=function(t,e,i){var o=this.m_broadPhase;this.m_broadPhase.rayCast({maxFraction:1,p1:t,p2:e},function(t,e){var s=o.getUserData(e),n=s.fixture,r=s.childIndex,a={};if(n.rayCast(a,t,r)){var m=a.fraction,h=y.add(y.mulNumVec2(1-m,t.p1),y.mulNumVec2(m,t.p2));return i(n,h,a.normal,m)}return t.maxFraction})},t.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},t.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},t.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},t.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},t.prototype.shiftOrigin=function(t){if(!this.m_locked){for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.sub(t),e.m_sweep.c0.sub(t),e.m_sweep.c.sub(t);for(var i=this.m_jointList;i;i=i.m_next)i.shiftOrigin(t);this.m_broadPhase.shiftOrigin(t)}},t.prototype._addBody=function(t){this.isLocked()||(t.m_prev=null,t.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=t),this.m_bodyList=t,++this.m_bodyCount)},t.prototype.createBody=function(t,e){if(this.isLocked())return null;var i={};t&&(y.isValid(t)?i={position:t,angle:e}:"object"==typeof t&&(i=t));var o=new Ot(this,i);return this._addBody(o),o},t.prototype.createDynamicBody=function(t,e){var i={};return t&&(y.isValid(t)?i={position:t,angle:e}:"object"==typeof t&&(i=t)),i.type="dynamic",this.createBody(i)},t.prototype.createKinematicBody=function(t,e){var i={};return t&&(y.isValid(t)?i={position:t,angle:e}:"object"==typeof t&&(i=t)),i.type="kinematic",this.createBody(i)},t.prototype.destroyBody=function(t){if(!this.isLocked()){if(t.m_destroyed)return!1;for(var e=t.m_jointList;e;){var i=e;e=e.next,this.publish("remove-joint",i.joint),this.destroyJoint(i.joint),t.m_jointList=e}t.m_jointList=null;for(var o=t.m_contactList;o;){var s=o;o=o.next,this.destroyContact(s.contact),t.m_contactList=o}t.m_contactList=null;for(var n=t.m_fixtureList;n;){var r=n;n=n.m_next,this.publish("remove-fixture",r),r.destroyProxies(this.m_broadPhase),t.m_fixtureList=n}return t.m_fixtureList=null,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",t),!0}},t.prototype.createJoint=function(t){if(this.isLocked())return null;if(t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.m_edgeA.joint=t,t.m_edgeA.other=t.m_bodyB,t.m_edgeA.prev=null,t.m_edgeA.next=t.m_bodyA.m_jointList,t.m_bodyA.m_jointList&&(t.m_bodyA.m_jointList.prev=t.m_edgeA),t.m_bodyA.m_jointList=t.m_edgeA,t.m_edgeB.joint=t,t.m_edgeB.other=t.m_bodyA,t.m_edgeB.prev=null,t.m_edgeB.next=t.m_bodyB.m_jointList,t.m_bodyB.m_jointList&&(t.m_bodyB.m_jointList.prev=t.m_edgeB),t.m_bodyB.m_jointList=t.m_edgeB,0==t.m_collideConnected)for(var e=t.m_bodyB.getContactList();e;e=e.next)e.other==t.m_bodyA&&e.contact.flagForFiltering();return t},t.prototype.destroyJoint=function(t){if(!this.isLocked()){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var e=t.m_bodyA,i=t.m_bodyB;if(e.setAwake(!0),i.setAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==e.m_jointList&&(e.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==i.m_jointList&&(i.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,--this.m_jointCount,0==t.m_collideConnected)for(var o=i.getContactList();o;)o.other==e&&o.contact.flagForFiltering(),o=o.next;this.publish("remove-joint",t)}},t.prototype.step=function(t,e,i){if(this.publish("pre-step",t),(0|e)!==e&&(e=0),e=e||this.m_velocityIterations,i=i||this.m_positionIterations,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,this.s_step.reset(t),this.s_step.velocityIterations=e,this.s_step.positionIterations=i,this.s_step.warmStarting=this.m_warmStarting,this.s_step.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&t>0){this.m_solver.solveWorld(this.s_step);for(var o=this.m_bodyList;o;o=o.getNext())0!=o.m_islandFlag&&(o.isStatic()||o.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&t>0&&this.m_solver.solveWorldTOI(this.s_step),this.m_clearForces&&this.clearForces(),this.m_locked=!1,this.publish("post-step",t)},t.prototype.findNewContacts=function(){var t=this;this.m_broadPhase.updatePairs(function(e,i){return t.createContact(e,i)})},t.prototype.createContact=function(t,e){var i=t.fixture,o=e.fixture,s=t.childIndex,n=e.childIndex,r=i.getBody(),a=o.getBody();if(r!=a){for(var m=a.getContactList();m;){if(m.other==r){var h=m.contact.getFixtureA(),c=m.contact.getFixtureB(),_=m.contact.getChildIndexA(),l=m.contact.getChildIndexB();if(h==i&&c==o&&_==s&&l==n)return;if(h==o&&c==i&&_==n&&l==s)return}m=m.next}if(0!=a.shouldCollide(r)&&0!=o.shouldCollide(i)){var u=io.create(i,s,o,n);null!=u&&(u.m_prev=null,null!=this.m_contactList&&(u.m_next=this.m_contactList,this.m_contactList.m_prev=u),this.m_contactList=u,++this.m_contactCount)}}},t.prototype.updateContacts=function(){for(var t,e=this.m_contactList;t=e;){e=t.getNext();var i=t.getFixtureA(),o=t.getFixtureB(),s=t.getChildIndexA(),n=t.getChildIndexB(),r=i.getBody(),a=o.getBody();if(t.m_filterFlag){if(0==a.shouldCollide(r)){this.destroyContact(t);continue}if(0==o.shouldCollide(i)){this.destroyContact(t);continue}t.m_filterFlag=!1}var m=r.isAwake()&&!r.isStatic(),h=a.isAwake()&&!a.isStatic();if(0!=m||0!=h){var c=i.m_proxies[s].proxyId,_=o.m_proxies[n].proxyId;0!=this.m_broadPhase.testOverlap(c,_)?t.update(this):this.destroyContact(t)}}},t.prototype.destroyContact=function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),io.destroy(t,this),--this.m_contactCount},t.prototype.on=function(t,e){return"string"!=typeof t||"function"!=typeof e||(this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)),this},t.prototype.off=function(t,e){if("string"!=typeof t||"function"!=typeof e)return this;var i=this._listeners&&this._listeners[t];if(!i||!i.length)return this;var o=i.indexOf(e);return o>=0&&i.splice(o,1),this},t.prototype.publish=function(t,e,i,o){var s=this._listeners&&this._listeners[t];if(!s||!s.length)return 0;for(var n=0;n<s.length;n++)s[n].call(this,e,i,o);return s.length},t.prototype.beginContact=function(t){this.publish("begin-contact",t)},t.prototype.endContact=function(t){this.publish("end-contact",t)},t.prototype.preSolve=function(t,e){this.publish("pre-solve",t,e)},t.prototype.postSolve=function(t,e){this.publish("post-solve",t,e)},t}(),no=function(){function t(e,i,o){if(!(this instanceof t))return new t(e,i,o);void 0===e?(this.x=0,this.y=0,this.z=0):"object"==typeof e?(this.x=e.x,this.y=e.y,this.z=e.z):(this.x=e,this.y=i,this.z=o)}return t.prototype._serialize=function(){return{x:this.x,y:this.y,z:this.z}},t._deserialize=function(e){var i=Object.create(t.prototype);return i.x=e.x,i.y=e.y,i.z=e.z,i},t.neo=function(e,i,o){var s=Object.create(t.prototype);return s.x=e,s.y=i,s.z=o,s},t.zero=function(){var e=Object.create(t.prototype);return e.x=0,e.y=0,e.z=0,e},t.clone=function(e){return t.neo(e.x,e.y,e.z)},t.prototype.toString=function(){return JSON.stringify(this)},t.isValid=function(t){return null!=t&&(Number.isFinite(t.x)&&Number.isFinite(t.y)&&Number.isFinite(t.z))},t.assert=function(t){},t.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},t.prototype.set=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},t.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},t.prototype.mul=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.areEqual=function(t,e){return t===e||"object"==typeof t&&null!==t&&"object"==typeof e&&null!==e&&t.x===e.x&&t.y===e.y&&t.z===e.z},t.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},t.cross=function(e,i){return new t(e.y*i.z-e.z*i.y,e.z*i.x-e.x*i.z,e.x*i.y-e.y*i.x)},t.add=function(e,i){return new t(e.x+i.x,e.y+i.y,e.z+i.z)},t.sub=function(e,i){return new t(e.x-i.x,e.y-i.y,e.z-i.z)},t.mul=function(e,i){return new t(i*e.x,i*e.y,i*e.z)},t.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},t.neg=function(e){return new t(-e.x,-e.y,-e.z)},t}(),ro=q(0,0),ao=q(0,0),mo=function(t){function e(i,o){var s=this;return s instanceof e?((s=t.call(this)||this).m_type=e.TYPE,s.m_radius=g.polygonRadius,s.m_vertex1=i?y.clone(i):y.zero(),s.m_vertex2=o?y.clone(o):y.zero(),s.m_vertex0=y.zero(),s.m_vertex3=y.zero(),s.m_hasVertex0=!1,s.m_hasVertex3=!1,s):new e(i,o)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,vertex1:this.m_vertex1,vertex2:this.m_vertex2,vertex0:this.m_vertex0,vertex3:this.m_vertex3,hasVertex0:this.m_hasVertex0,hasVertex3:this.m_hasVertex3}},e._deserialize=function(t){var i=new e(t.vertex1,t.vertex2);return i.m_hasVertex0&&i.setPrevVertex(t.vertex0),i.m_hasVertex3&&i.setNextVertex(t.vertex3),i},e.prototype._reset=function(){},e.prototype.getRadius=function(){return this.m_radius},e.prototype.getType=function(){return this.m_type},e.prototype.setNext=function(t){return this.setNextVertex(t)},e.prototype.setNextVertex=function(t){return t?(this.m_vertex3.setVec2(t),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},e.prototype.getNextVertex=function(){return this.m_vertex3},e.prototype.setPrev=function(t){return this.setPrevVertex(t)},e.prototype.setPrevVertex=function(t){return t?(this.m_vertex0.setVec2(t),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},e.prototype.getPrevVertex=function(){return this.m_vertex0},e.prototype._set=function(t,e){return this.m_vertex1.setVec2(t),this.m_vertex2.setVec2(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},e.prototype._clone=function(){var t=new e;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_vertex1.setVec2(this.m_vertex1),t.m_vertex2.setVec2(this.m_vertex2),t.m_vertex0.setVec2(this.m_vertex0),t.m_vertex3.setVec2(this.m_vertex3),t.m_hasVertex0=this.m_hasVertex0,t.m_hasVertex3=this.m_hasVertex3,t},e.prototype.getChildCount=function(){return 1},e.prototype.testPoint=function(t,e){return!1},e.prototype.rayCast=function(t,e,i,o){var s=ut.mulTVec2(i.q,y.sub(e.p1,i.p)),n=ut.mulTVec2(i.q,y.sub(e.p2,i.p)),r=y.sub(n,s),a=this.m_vertex1,m=this.m_vertex2,h=y.sub(m,a),c=y.neo(h.y,-h.x);c.normalize();var _=y.dot(c,y.sub(a,s)),l=y.dot(c,r);if(0==l)return!1;var u=_/l;if(u<0||e.maxFraction<u)return!1;var p=y.add(s,y.mulNumVec2(u,r)),d=y.sub(m,a),f=y.dot(d,d);if(0==f)return!1;var v=y.dot(y.sub(p,a),d)/f;return!(v<0||1<v)&&(t.fraction=u,t.normal=_>0?ut.mulVec2(i.q,c).neg():ut.mulVec2(i.q,c),!0)},e.prototype.computeAABB=function(t,e,i){rt(ro,e,this.m_vertex1),rt(ao,e,this.m_vertex2),v.combinePoints(t,ro,ao),v.extend(t,this.m_radius)},e.prototype.computeMass=function(t,e){t.mass=0,U(t.center,.5,this.m_vertex1,.5,this.m_vertex2),t.I=0},e.prototype.computeDistanceProxy=function(t){t.m_vertices[0]=this.m_vertex1,t.m_vertices[1]=this.m_vertex2,t.m_vertices.length=2,t.m_count=2,t.m_radius=this.m_radius},e.TYPE="edge",e}(wt),ho=mo,co=q(0,0),_o=q(0,0),lo=function(t){function e(i,o){var s=this;return s instanceof e?((s=t.call(this)||this).m_type=e.TYPE,s.m_radius=g.polygonRadius,s.m_vertices=[],s.m_count=0,s.m_prevVertex=null,s.m_nextVertex=null,s.m_hasPrevVertex=!1,s.m_hasNextVertex=!1,s.m_isLoop=!!o,i&&i.length&&(o?s._createLoop(i):s._createChain(i)),s):new e(i,o)}return i(e,t),e.prototype._serialize=function(){var t={type:this.m_type,vertices:this.m_vertices,isLoop:this.m_isLoop,hasPrevVertex:this.m_hasPrevVertex,hasNextVertex:this.m_hasNextVertex,prevVertex:null,nextVertex:null};return this.m_prevVertex&&(t.prevVertex=this.m_prevVertex),this.m_nextVertex&&(t.nextVertex=this.m_nextVertex),t},e._deserialize=function(t,i,o){var s=[];if(t.vertices)for(var n=0;n<t.vertices.length;n++)s.push(o(y,t.vertices[n]));var r=new e(s,t.isLoop);return t.prevVertex&&r.setPrevVertex(t.prevVertex),t.nextVertex&&r.setNextVertex(t.nextVertex),r},e.prototype.getType=function(){return this.m_type},e.prototype.getRadius=function(){return this.m_radius},e.prototype._createLoop=function(t){if(!(t.length<3)){for(var e=1;e<t.length;++e)t[e-1],t[e];this.m_vertices=[],this.m_count=t.length+1;for(e=0;e<t.length;++e)this.m_vertices[e]=y.clone(t[e]);return this.m_vertices[t.length]=y.clone(t[0]),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this}},e.prototype._createChain=function(t){for(var e=1;e<t.length;++e)t[e-1],t[e];this.m_count=t.length;for(e=0;e<t.length;++e)this.m_vertices[e]=y.clone(t[e]);return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex=null,this.m_nextVertex=null,this},e.prototype._reset=function(){this.m_isLoop?this._createLoop(this.m_vertices):this._createChain(this.m_vertices)},e.prototype.setPrevVertex=function(t){this.m_prevVertex=t,this.m_hasPrevVertex=!0},e.prototype.getPrevVertex=function(){return this.m_prevVertex},e.prototype.setNextVertex=function(t){this.m_nextVertex=t,this.m_hasNextVertex=!0},e.prototype.getNextVertex=function(){return this.m_nextVertex},e.prototype._clone=function(){var t=new e;return t._createChain(this.m_vertices),t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_prevVertex=this.m_prevVertex,t.m_nextVertex=this.m_nextVertex,t.m_hasPrevVertex=this.m_hasPrevVertex,t.m_hasNextVertex=this.m_hasNextVertex,t},e.prototype.getChildCount=function(){return this.m_count-1},e.prototype.getChildEdge=function(t,e){t.m_type=mo.TYPE,t.m_radius=this.m_radius,t.m_vertex1=this.m_vertices[e],t.m_vertex2=this.m_vertices[e+1],e>0?(t.m_vertex0=this.m_vertices[e-1],t.m_hasVertex0=!0):(t.m_vertex0=this.m_prevVertex,t.m_hasVertex0=this.m_hasPrevVertex),e<this.m_count-2?(t.m_vertex3=this.m_vertices[e+2],t.m_hasVertex3=!0):(t.m_vertex3=this.m_nextVertex,t.m_hasVertex3=this.m_hasNextVertex)},e.prototype.getVertex=function(t){return t<this.m_count?this.m_vertices[t]:this.m_vertices[0]},e.prototype.isLoop=function(){return this.m_isLoop},e.prototype.testPoint=function(t,e){return!1},e.prototype.rayCast=function(t,e,i,o){return new mo(this.getVertex(o),this.getVertex(o+1)).rayCast(t,e,i,0)},e.prototype.computeAABB=function(t,e,i){rt(co,e,this.getVertex(i)),rt(_o,e,this.getVertex(i+1)),v.combinePoints(t,co,_o)},e.prototype.computeMass=function(t,e){t.mass=0,j(t.center),t.I=0},e.prototype.computeDistanceProxy=function(t,e){t.m_vertices[0]=this.getVertex(e),t.m_vertices[1]=this.getVertex(e+1),t.m_count=2,t.m_radius=this.m_radius},e.TYPE="chain",e}(wt),uo=lo,po=Math.max,yo=Math.min,fo=q(0,0),vo=q(0,0),xo=q(0,0),Ao=q(0,0),go=q(0,0),bo=q(0,0),Bo=function(t){function e(i){var o=this;return o instanceof e?((o=t.call(this)||this).m_type=e.TYPE,o.m_radius=g.polygonRadius,o.m_centroid=y.zero(),o.m_vertices=[],o.m_normals=[],o.m_count=0,i&&i.length&&o._set(i),o):new e(i)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,vertices:this.m_vertices}},e._deserialize=function(t,i,o){var s=[];if(t.vertices)for(var n=0;n<t.vertices.length;n++)s.push(o(y,t.vertices[n]));return new e(s)},e.prototype.getType=function(){return this.m_type},e.prototype.getRadius=function(){return this.m_radius},e.prototype._clone=function(){var t=new e;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count,t.m_centroid.setVec2(this.m_centroid);for(var i=0;i<this.m_count;i++)t.m_vertices.push(this.m_vertices[i].clone());for(i=0;i<this.m_normals.length;i++)t.m_normals.push(this.m_normals[i].clone());return t},e.prototype.getChildCount=function(){return 1},e.prototype._reset=function(){this._set(this.m_vertices)},e.prototype._set=function(t){if(t.length<3)this._setAsBox(1,1);else{for(var e=yo(t.length,g.maxPolygonVertices),i=[],o=0;o<e;++o){for(var s=t[o],n=!0,r=0;r<i.length;++r)if(y.distanceSquared(s,i[r])<.25*g.linearSlopSquared){n=!1;break}n&&i.push(y.clone(s))}if((e=i.length)<3)this._setAsBox(1,1);else{var a=0,m=i[0].x;for(o=1;o<e;++o){var h=i[o].x;(h>m||h===m&&i[o].y<i[a].y)&&(a=o,m=h)}for(var c=[],_=0,l=a;;){c[_]=l;var u=0;for(r=1;r<e;++r)if(u!==l){var p=y.sub(i[u],i[c[_]]),d=(s=y.sub(i[r],i[c[_]]),y.crossVec2Vec2(p,s));d<0&&(u=r),0===d&&s.lengthSquared()>p.lengthSquared()&&(u=r)}else u=r;if(++_,l=u,u===a)break}if(_<3)this._setAsBox(1,1);else{this.m_count=_,this.m_vertices=[];for(o=0;o<_;++o)this.m_vertices[o]=i[c[o]];for(o=0;o<_;++o){var f=o,v=o+1<_?o+1:0,x=y.sub(this.m_vertices[v],this.m_vertices[f]);this.m_normals[o]=y.crossVec2Num(x,1),this.m_normals[o].normalize()}this.m_centroid=function(t,e){for(var i=y.zero(),o=0,s=y.zero(),n=1/3,r=0;r<e;++r){var a=s,m=t[r],h=r+1<e?t[r+1]:t[0],c=y.sub(m,a),_=y.sub(h,a),l=.5*y.crossVec2Vec2(c,_);o+=l,i.addMul(l*n,a),i.addMul(l*n,m),i.addMul(l*n,h)}return i.mul(1/o),i}(this.m_vertices,_)}}}},e.prototype._setAsBox=function(t,e,i,o){if(this.m_vertices[0]=y.neo(t,-e),this.m_vertices[1]=y.neo(t,e),this.m_vertices[2]=y.neo(-t,e),this.m_vertices[3]=y.neo(-t,-e),this.m_normals[0]=y.neo(1,0),this.m_normals[1]=y.neo(0,1),this.m_normals[2]=y.neo(-1,0),this.m_normals[3]=y.neo(0,-1),this.m_count=4,i&&y.isValid(i)){o=o||0,N(this.m_centroid,i);var s=vt.identity();s.p.setVec2(i),s.q.setAngle(o);for(var n=0;n<this.m_count;++n)this.m_vertices[n]=vt.mulVec2(s,this.m_vertices[n]),this.m_normals[n]=ut.mulVec2(s.q,this.m_normals[n])}},e.prototype.testPoint=function(t,e){for(var i=at(fo,t,e),o=0;o<this.m_count;++o){if(Q(this.m_normals[o],i)-Q(this.m_normals[o],this.m_vertices[o])>0)return!1}return!0},e.prototype.rayCast=function(t,e,i,o){for(var s=ut.mulTVec2(i.q,y.sub(e.p1,i.p)),n=ut.mulTVec2(i.q,y.sub(e.p2,i.p)),r=y.sub(n,s),a=0,m=e.maxFraction,h=-1,c=0;c<this.m_count;++c){var _=y.dot(this.m_normals[c],y.sub(this.m_vertices[c],s)),l=y.dot(this.m_normals[c],r);if(0==l){if(_<0)return!1}else l<0&&_<a*l?(a=_/l,h=c):l>0&&_<m*l&&(m=_/l);if(m<a)return!1}return h>=0&&(t.fraction=a,t.normal=ut.mulVec2(i.q,this.m_normals[h]),!0)},e.prototype.computeAABB=function(t,e,i){for(var o=1/0,s=1/0,n=-1/0,r=-1/0,a=0;a<this.m_count;++a){var m=rt(fo,e,this.m_vertices[a]);o=yo(o,m.x),n=po(n,m.x),s=yo(s,m.y),r=po(r,m.y)}k(t.lowerBound,o-this.m_radius,s-this.m_radius),k(t.upperBound,n+this.m_radius,r+this.m_radius)},e.prototype.computeMass=function(t,e){j(go);var i=0,o=0;j(bo);for(var s=0;s<this.m_count;++s)O(bo,this.m_vertices[s]);Y(bo,1/this.m_count,bo);var n=1/3;for(s=0;s<this.m_count;++s){E(xo,this.m_vertices[s],bo),s+1<this.m_count?E(Ao,this.m_vertices[s+1],bo):E(Ao,this.m_vertices[0],bo);var r=G(xo,Ao),a=.5*r;i+=a,U(go,1,go,a*n,xo),U(go,1,go,a*n,Ao);var m=xo.x,h=xo.y,c=Ao.x,_=Ao.y;o+=.25*n*r*(m*m+c*m+c*c+(h*h+_*h+_*_))}t.mass=e*i,Y(go,1/i,go),function(t,e,i){t.x=e.x+i.x,t.y=e.x+i.y}(t.center,go,bo),t.I=e*o,t.I+=t.mass*(Q(t.center,t.center)-Q(go,go))},e.prototype.validate=function(){for(var t=0;t<this.m_count;++t){var e=t,i=t<this.m_count-1?e+1:0,o=this.m_vertices[e];E(vo,this.m_vertices[i],o);for(var s=0;s<this.m_count;++s){if(s!=e&&s!=i)if(G(vo,E(fo,this.m_vertices[s],o))<0)return!1}}return!0},e.prototype.computeDistanceProxy=function(t){for(var e=0;e<this.m_count;++e)t.m_vertices[e]=this.m_vertices[e];t.m_vertices.length=this.m_count,t.m_count=this.m_count,t.m_radius=this.m_radius},e.TYPE="polygon",e}(wt);var wo,Vo=Bo,Co=function(t){function e(i,o,s,n){var r=this;return r instanceof e?((r=t.call(this)||this)._setAsBox(i,o,s,n),r):new e(i,o,s,n)}return i(e,t),e.TYPE="polygon",e}(Bo),Mo=Co,Io=Math.sqrt,Po=Math.PI,So=q(0,0),To=function(t){function e(i,o){var s=this;return s instanceof e?((s=t.call(this)||this).m_type=e.TYPE,s.m_p=y.zero(),s.m_radius=1,"object"==typeof i&&y.isValid(i)?(s.m_p.setVec2(i),"number"==typeof o&&(s.m_radius=o)):"number"==typeof i&&(s.m_radius=i),s):new e(i,o)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,p:this.m_p,radius:this.m_radius}},e._deserialize=function(t){return new e(t.p,t.radius)},e.prototype._reset=function(){},e.prototype.getType=function(){return this.m_type},e.prototype.getRadius=function(){return this.m_radius},e.prototype.getCenter=function(){return this.m_p},e.prototype._clone=function(){var t=new e;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_p=this.m_p.clone(),t},e.prototype.getChildCount=function(){return 1},e.prototype.testPoint=function(t,e){return et(e,rt(So,t,this.m_p))<=this.m_radius*this.m_radius},e.prototype.rayCast=function(t,e,i,o){var s=y.add(i.p,ut.mulVec2(i.q,this.m_p)),n=y.sub(e.p1,s),a=y.dot(n,n)-this.m_radius*this.m_radius,m=y.sub(e.p2,e.p1),h=y.dot(n,m),c=y.dot(m,m),_=h*h-c*a;if(_<0||c<r)return!1;var l=-(h+Io(_));return 0<=l&&l<=e.maxFraction*c&&(l/=c,t.fraction=l,t.normal=y.add(n,y.mulNumVec2(l,m)),t.normal.normalize(),!0)},e.prototype.computeAABB=function(t,e,i){var o=rt(So,e,this.m_p);k(t.lowerBound,o.x-this.m_radius,o.y-this.m_radius),k(t.upperBound,o.x+this.m_radius,o.y+this.m_radius)},e.prototype.computeMass=function(t,e){t.mass=e*Po*this.m_radius*this.m_radius,N(t.center,this.m_p),t.I=t.mass*(.5*this.m_radius*this.m_radius+$(this.m_p))},e.prototype.computeDistanceProxy=function(t){t.m_vertices[0]=this.m_p,t.m_vertices.length=1,t.m_count=1,t.m_radius=this.m_radius},e.TYPE="circle",e}(wt),zo=To,Fo=Math.abs,Lo=Math.PI,qo={frequencyHz:0,dampingRatio:0},ko=function(t){function e(i,o,n,r,a){var m=this;if(!(m instanceof e))return new e(i,o,n,r,a);if(n&&r&&"m_type"in r&&"x"in n&&"y"in n){var h=n;n=r,r=h}return i=s(i,qo),o=(m=t.call(this,i,o,n)||this).m_bodyA,n=m.m_bodyB,m.m_type=e.TYPE,m.m_localAnchorA=y.clone(r?o.getLocalPoint(r):i.localAnchorA||y.zero()),m.m_localAnchorB=y.clone(a?n.getLocalPoint(a):i.localAnchorB||y.zero()),m.m_length=Number.isFinite(i.length)?i.length:y.distance(o.getWorldPoint(m.m_localAnchorA),n.getWorldPoint(m.m_localAnchorB)),m.m_frequencyHz=i.frequencyHz,m.m_dampingRatio=i.dampingRatio,m.m_impulse=0,m.m_gamma=0,m.m_bias=0,m}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,length:this.m_length,impulse:this.m_impulse,gamma:this.m_gamma,bias:this.m_bias}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),new e(t)},e.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.setVec2(t.localAnchorA),t.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.setVec2(t.localAnchorB),t.length>0?this.m_length=+t.length:t.length<0||(t.anchorA||t.anchorA||t.anchorA||t.anchorA)&&(this.m_length=y.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.setLength=function(t){this.m_length=t},e.prototype.getLength=function(){return this.m_length},e.prototype.setFrequency=function(t){this.m_frequencyHz=t},e.prototype.getFrequency=function(){return this.m_frequencyHz},e.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.getDampingRatio=function(){return this.m_dampingRatio},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.mulNumVec2(this.m_impulse,this.m_u).mul(t)},e.prototype.getReactionTorque=function(t){return 0},e.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,h=ut.neo(i),c=ut.neo(r);this.m_rA=ut.mulVec2(h,y.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=ut.mulVec2(c,y.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=y.sub(y.add(n,this.m_rB),y.add(e,this.m_rA));var _=this.m_u.length();_>g.linearSlop?this.m_u.mul(1/_):this.m_u.setNum(0,0);var l=y.crossVec2Vec2(this.m_rA,this.m_u),u=y.crossVec2Vec2(this.m_rB,this.m_u),p=this.m_invMassA+this.m_invIA*l*l+this.m_invMassB+this.m_invIB*u*u;if(this.m_mass=0!=p?1/p:0,this.m_frequencyHz>0){var d=_-this.m_length,f=2*Lo*this.m_frequencyHz,v=2*this.m_mass*this.m_dampingRatio*f,x=this.m_mass*f*f,A=t.dt;this.m_gamma=A*(v+A*x),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=d*A*x*this.m_gamma,p+=this.m_gamma,this.m_mass=0!=p?1/p:0}else this.m_gamma=0,this.m_bias=0;if(t.warmStarting){this.m_impulse*=t.dtRatio;var b=y.mulNumVec2(this.m_impulse,this.m_u);o.subMul(this.m_invMassA,b),s-=this.m_invIA*y.crossVec2Vec2(this.m_rA,b),a.addMul(this.m_invMassB,b),m+=this.m_invIB*y.crossVec2Vec2(this.m_rB,b)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.setVec2(o),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.setVec2(a),this.m_bodyB.c_velocity.w=m},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,n=y.add(e,y.crossNumVec2(i,this.m_rA)),r=y.add(o,y.crossNumVec2(s,this.m_rB)),a=y.dot(this.m_u,r)-y.dot(this.m_u,n),m=-this.m_mass*(a+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=m;var h=y.mulNumVec2(m,this.m_u);e.subMul(this.m_invMassA,h),i-=this.m_invIA*y.crossVec2Vec2(this.m_rA,h),o.addMul(this.m_invMassB,h),s+=this.m_invIB*y.crossVec2Vec2(this.m_rB,h),this.m_bodyA.c_velocity.v.setVec2(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.setVec2(o),this.m_bodyB.c_velocity.w=s},e.prototype.solvePositionConstraints=function(t){if(this.m_frequencyHz>0)return!0;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,n=ut.neo(i),r=ut.neo(s),a=ut.mulSub(n,this.m_localAnchorA,this.m_localCenterA),m=ut.mulSub(r,this.m_localAnchorB,this.m_localCenterB),c=y.sub(y.add(o,m),y.add(e,a)),_=h(c.normalize()-this.m_length,-g.maxLinearCorrection,g.maxLinearCorrection),l=-this.m_mass*_,u=y.mulNumVec2(l,c);return e.subMul(this.m_invMassA,u),i-=this.m_invIA*y.crossVec2Vec2(a,u),o.addMul(this.m_invMassB,u),s+=this.m_invIB*y.crossVec2Vec2(m,u),this.m_bodyA.c_position.c.setVec2(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=s,Fo(_)<g.linearSlop},e.TYPE="distance-joint",e}(Et),No={maxForce:0,maxTorque:0},jo=function(t){function e(i,o,n,r){var a=this;return a instanceof e?(i=s(i,No),o=(a=t.call(this,i,o,n)||this).m_bodyA,n=a.m_bodyB,a.m_type=e.TYPE,a.m_localAnchorA=y.clone(r?o.getLocalPoint(r):i.localAnchorA||y.zero()),a.m_localAnchorB=y.clone(r?n.getLocalPoint(r):i.localAnchorB||y.zero()),a.m_linearImpulse=y.zero(),a.m_angularImpulse=0,a.m_maxForce=i.maxForce,a.m_maxTorque=i.maxTorque,a):new e(i,o,n,r)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),new e(t)},e.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.setVec2(t.localAnchorA),t.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.setVec2(t.localAnchorB)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.setMaxForce=function(t){this.m_maxForce=t},e.prototype.getMaxForce=function(){return this.m_maxForce},e.prototype.setMaxTorque=function(t){this.m_maxTorque=t},e.prototype.getMaxTorque=function(){return this.m_maxTorque},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.mulNumVec2(t,this.m_linearImpulse)},e.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},e.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,a=ut.neo(e),m=ut.neo(s);this.m_rA=ut.mulVec2(a,y.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=ut.mulVec2(m,y.sub(this.m_localAnchorB,this.m_localCenterB));var h=this.m_invMassA,c=this.m_invMassB,_=this.m_invIA,l=this.m_invIB,u=new ii;if(u.ex.x=h+c+_*this.m_rA.y*this.m_rA.y+l*this.m_rB.y*this.m_rB.y,u.ex.y=-_*this.m_rA.x*this.m_rA.y-l*this.m_rB.x*this.m_rB.y,u.ey.x=u.ex.y,u.ey.y=h+c+_*this.m_rA.x*this.m_rA.x+l*this.m_rB.x*this.m_rB.x,this.m_linearMass=u.getInverse(),this.m_angularMass=_+l,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var p=y.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);i.subMul(h,p),o-=_*(y.crossVec2Vec2(this.m_rA,p)+this.m_angularImpulse),n.addMul(c,p),r+=l*(y.crossVec2Vec2(this.m_rB,p)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,n=this.m_invMassA,r=this.m_invMassB,a=this.m_invIA,m=this.m_invIB,c=t.dt,_=s-i,l=-this.m_angularMass*_,u=this.m_angularImpulse,p=c*this.m_maxTorque;this.m_angularImpulse=h(this.m_angularImpulse+l,-p,p),i-=a*(l=this.m_angularImpulse-u),s+=m*l;_=y.sub(y.add(o,y.crossNumVec2(s,this.m_rB)),y.add(e,y.crossNumVec2(i,this.m_rA))),l=y.neg(ii.mulVec2(this.m_linearMass,_)),u=this.m_linearImpulse;this.m_linearImpulse.add(l);p=c*this.m_maxForce;this.m_linearImpulse.lengthSquared()>p*p&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(p)),l=y.sub(this.m_linearImpulse,u),e.subMul(n,l),i-=a*y.crossVec2Vec2(this.m_rA,l),o.addMul(r,l),s+=m*y.crossVec2Vec2(this.m_rB,l),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},e.prototype.solvePositionConstraints=function(t){return!0},e.TYPE="friction-joint",e}(Et),Do=function(){function t(t,e,i){"object"==typeof t&&null!==t?(this.ex=no.clone(t),this.ey=no.clone(e),this.ez=no.clone(i)):(this.ex=no.zero(),this.ey=no.zero(),this.ez=no.zero())}return t.prototype.toString=function(){return JSON.stringify(this)},t.isValid=function(t){return null!=t&&(no.isValid(t.ex)&&no.isValid(t.ey)&&no.isValid(t.ez))},t.assert=function(t){},t.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},t.prototype.solve33=function(t){var e=this.ey.y*this.ez.z-this.ey.z*this.ez.y,i=this.ey.z*this.ez.x-this.ey.x*this.ez.z,o=this.ey.x*this.ez.y-this.ey.y*this.ez.x,s=this.ex.x*e+this.ex.y*i+this.ex.z*o;0!==s&&(s=1/s);var n=new no;return e=this.ey.y*this.ez.z-this.ey.z*this.ez.y,i=this.ey.z*this.ez.x-this.ey.x*this.ez.z,o=this.ey.x*this.ez.y-this.ey.y*this.ez.x,n.x=s*(t.x*e+t.y*i+t.z*o),e=t.y*this.ez.z-t.z*this.ez.y,i=t.z*this.ez.x-t.x*this.ez.z,o=t.x*this.ez.y-t.y*this.ez.x,n.y=s*(this.ex.x*e+this.ex.y*i+this.ex.z*o),e=this.ey.y*t.z-this.ey.z*t.y,i=this.ey.z*t.x-this.ey.x*t.z,o=this.ey.x*t.y-this.ey.y*t.x,n.z=s*(this.ex.x*e+this.ex.y*i+this.ex.z*o),n},t.prototype.solve22=function(t){var e=this.ex.x,i=this.ey.x,o=this.ex.y,s=this.ey.y,n=e*s-i*o;0!==n&&(n=1/n);var r=y.zero();return r.x=n*(s*t.x-i*t.y),r.y=n*(e*t.y-o*t.x),r},t.prototype.getInverse22=function(t){var e=this.ex.x,i=this.ey.x,o=this.ex.y,s=this.ey.y,n=e*s-i*o;0!==n&&(n=1/n),t.ex.x=n*s,t.ey.x=-n*i,t.ex.z=0,t.ex.y=-n*o,t.ey.y=n*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0},t.prototype.getSymInverse33=function(t){var e=no.dot(this.ex,no.cross(this.ey,this.ez));0!==e&&(e=1/e);var i=this.ex.x,o=this.ey.x,s=this.ez.x,n=this.ey.y,r=this.ez.y,a=this.ez.z;t.ex.x=e*(n*a-r*r),t.ex.y=e*(s*r-o*a),t.ex.z=e*(o*r-s*n),t.ey.x=t.ex.y,t.ey.y=e*(i*a-s*s),t.ey.z=e*(s*o-i*r),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(i*n-o*o)},t.mul=function(t,e){if(e&&"z"in e&&"y"in e&&"x"in e){var i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,o=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,s=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new no(i,o,s)}if(e&&"y"in e&&"x"in e){i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return y.neo(i,o)}},t.mulVec3=function(t,e){var i=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,o=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,s=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new no(i,o,s)},t.mulVec2=function(t,e){var i=t.ex.x*e.x+t.ey.x*e.y,o=t.ex.y*e.x+t.ey.y*e.y;return y.neo(i,o)},t.add=function(e,i){return new t(no.add(e.ex,i.ex),no.add(e.ey,i.ey),no.add(e.ez,i.ez))},t}(),Oo=Math.abs;!function(t){t[t.inactiveLimit=0]="inactiveLimit",t[t.atLowerLimit=1]="atLowerLimit",t[t.atUpperLimit=2]="atUpperLimit",t[t.equalLimits=3]="equalLimits"}(wo||(wo={}));var Ro,Eo=0,Jo=0,Yo=0,Wo=0,Ho=!1,Uo=!1,Zo=function(t){function e(i,o,s,n){var r,a,m,h,c,_,l=this;return l instanceof e?(i=null!=i?i:{},o=(l=t.call(this,i,o,s)||this).m_bodyA,s=l.m_bodyB,l.m_mass=new Do,l.m_limitState=wo.inactiveLimit,l.m_type=e.TYPE,y.isValid(n)?l.m_localAnchorA=o.getLocalPoint(n):y.isValid(i.localAnchorA)?l.m_localAnchorA=y.clone(i.localAnchorA):l.m_localAnchorA=y.zero(),y.isValid(n)?l.m_localAnchorB=s.getLocalPoint(n):y.isValid(i.localAnchorB)?l.m_localAnchorB=y.clone(i.localAnchorB):l.m_localAnchorB=y.zero(),Number.isFinite(i.referenceAngle)?l.m_referenceAngle=i.referenceAngle:l.m_referenceAngle=s.getAngle()-o.getAngle(),l.m_impulse=new no,l.m_motorImpulse=0,l.m_lowerAngle=null!==(r=i.lowerAngle)&&void 0!==r?r:Eo,l.m_upperAngle=null!==(a=i.upperAngle)&&void 0!==a?a:Jo,l.m_maxMotorTorque=null!==(m=i.maxMotorTorque)&&void 0!==m?m:Yo,l.m_motorSpeed=null!==(h=i.motorSpeed)&&void 0!==h?h:Wo,l.m_enableLimit=null!==(c=i.enableLimit)&&void 0!==c?c:Ho,l.m_enableMotor=null!==(_=i.enableMotor)&&void 0!==_?_:Uo,l):new e(i,o,s,n)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerAngle:this.m_lowerAngle,upperAngle:this.m_upperAngle,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),new e(t)},e.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.setVec2(t.localAnchorA),t.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.setVec2(t.localAnchorB)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.getReferenceAngle=function(){return this.m_referenceAngle},e.prototype.getJointAngle=function(){var t=this.m_bodyA;return this.m_bodyB.m_sweep.a-t.m_sweep.a-this.m_referenceAngle},e.prototype.getJointSpeed=function(){var t=this.m_bodyA;return this.m_bodyB.m_angularVelocity-t.m_angularVelocity},e.prototype.isMotorEnabled=function(){return this.m_enableMotor},e.prototype.enableMotor=function(t){t!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t)},e.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},e.prototype.setMotorSpeed=function(t){t!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t)},e.prototype.getMotorSpeed=function(){return this.m_motorSpeed},e.prototype.setMaxMotorTorque=function(t){t!=this.m_maxMotorTorque&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t)},e.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},e.prototype.isLimitEnabled=function(){return this.m_enableLimit},e.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},e.prototype.getLowerLimit=function(){return this.m_lowerAngle},e.prototype.getUpperLimit=function(){return this.m_upperAngle},e.prototype.setLimits=function(t,e){t==this.m_lowerAngle&&e==this.m_upperAngle||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.neo(this.m_impulse.x,this.m_impulse.y).mul(t)},e.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},e.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,a=ut.neo(e),m=ut.neo(s);this.m_rA=ut.mulVec2(a,y.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=ut.mulVec2(m,y.sub(this.m_localAnchorB,this.m_localCenterB));var h=this.m_invMassA,c=this.m_invMassB,_=this.m_invIA,l=this.m_invIB,u=_+l===0;if(this.m_mass.ex.x=h+c+this.m_rA.y*this.m_rA.y*_+this.m_rB.y*this.m_rB.y*l,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*_-this.m_rB.y*this.m_rB.x*l,this.m_mass.ez.x=-this.m_rA.y*_-this.m_rB.y*l,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=h+c+this.m_rA.x*this.m_rA.x*_+this.m_rB.x*this.m_rB.x*l,this.m_mass.ez.y=this.m_rA.x*_+this.m_rB.x*l,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=_+l,this.m_motorMass=_+l,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(0==this.m_enableMotor||u)&&(this.m_motorImpulse=0),this.m_enableLimit&&0==u){var p=s-e-this.m_referenceAngle;Oo(this.m_upperAngle-this.m_lowerAngle)<2*g.angularSlop?this.m_limitState=wo.equalLimits:p<=this.m_lowerAngle?(this.m_limitState!=wo.atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=wo.atLowerLimit):p>=this.m_upperAngle?(this.m_limitState!=wo.atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=wo.atUpperLimit):(this.m_limitState=wo.inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=wo.inactiveLimit;if(t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var d=y.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(h,d),o-=_*(y.crossVec2Vec2(this.m_rA,d)+this.m_motorImpulse+this.m_impulse.z),n.addMul(c,d),r+=l*(y.crossVec2Vec2(this.m_rB,d)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,n=this.m_invMassA,r=this.m_invMassB,a=this.m_invIA,m=this.m_invIB,c=a+m===0;if(this.m_enableMotor&&this.m_limitState!=wo.equalLimits&&0==c){var _=s-i-this.m_motorSpeed,l=-this.m_motorMass*_,u=this.m_motorImpulse,p=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=h(this.m_motorImpulse+l,-p,p),i-=a*(l=this.m_motorImpulse-u),s+=m*l}if(this.m_enableLimit&&this.m_limitState!=wo.inactiveLimit&&0==c){var d=y.zero();d.addCombine(1,o,1,y.crossNumVec2(s,this.m_rB)),d.subCombine(1,e,1,y.crossNumVec2(i,this.m_rA));var f=s-i;_=new no(d.x,d.y,f),l=no.neg(this.m_mass.solve33(_));if(this.m_limitState==wo.equalLimits)this.m_impulse.add(l);else if(this.m_limitState==wo.atLowerLimit){if(this.m_impulse.z+l.z<0){var v=y.combine(-1,d,this.m_impulse.z,y.neo(this.m_mass.ez.x,this.m_mass.ez.y)),x=this.m_mass.solve22(v);l.x=x.x,l.y=x.y,l.z=-this.m_impulse.z,this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,this.m_impulse.z=0}else this.m_impulse.add(l)}else if(this.m_limitState==wo.atUpperLimit){if(this.m_impulse.z+l.z>0){v=y.combine(-1,d,this.m_impulse.z,y.neo(this.m_mass.ez.x,this.m_mass.ez.y)),x=this.m_mass.solve22(v);l.x=x.x,l.y=x.y,l.z=-this.m_impulse.z,this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,this.m_impulse.z=0}else this.m_impulse.add(l)}var A=y.neo(l.x,l.y);e.subMul(n,A),i-=a*(y.crossVec2Vec2(this.m_rA,A)+l.z),o.addMul(r,A),s+=m*(y.crossVec2Vec2(this.m_rB,A)+l.z)}else{(_=y.zero()).addCombine(1,o,1,y.crossNumVec2(s,this.m_rB)),_.subCombine(1,e,1,y.crossNumVec2(i,this.m_rA));l=this.m_mass.solve22(y.neg(_));this.m_impulse.x+=l.x,this.m_impulse.y+=l.y,e.subMul(n,l),i-=a*y.crossVec2Vec2(this.m_rA,l),o.addMul(r,l),s+=m*y.crossVec2Vec2(this.m_rB,l)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},e.prototype.solvePositionConstraints=function(t){var e,i=this.m_bodyA.c_position.c,o=this.m_bodyA.c_position.a,s=this.m_bodyB.c_position.c,n=this.m_bodyB.c_position.a,r=ut.neo(o),a=ut.neo(n),m=0,c=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&this.m_limitState!=wo.inactiveLimit&&0==c){var _=n-o-this.m_referenceAngle,l=0;if(this.m_limitState==wo.equalLimits){var u=h(_-this.m_lowerAngle,-g.maxAngularCorrection,g.maxAngularCorrection);l=-this.m_motorMass*u,m=Oo(u)}else if(this.m_limitState==wo.atLowerLimit){m=-(u=_-this.m_lowerAngle),u=h(u+g.angularSlop,-g.maxAngularCorrection,0),l=-this.m_motorMass*u}else if(this.m_limitState==wo.atUpperLimit){m=u=_-this.m_upperAngle,u=h(u-g.angularSlop,0,g.maxAngularCorrection),l=-this.m_motorMass*u}o-=this.m_invIA*l,n+=this.m_invIB*l}r.setAngle(o),a.setAngle(n);var p=ut.mulVec2(r,y.sub(this.m_localAnchorA,this.m_localCenterA)),d=ut.mulVec2(a,y.sub(this.m_localAnchorB,this.m_localCenterB));(u=y.zero()).addCombine(1,s,1,d),u.subCombine(1,i,1,p),e=u.length();var f=this.m_invMassA,v=this.m_invMassB,x=this.m_invIA,A=this.m_invIB,b=new ii;b.ex.x=f+v+x*p.y*p.y+A*d.y*d.y,b.ex.y=-x*p.x*p.y-A*d.x*d.y,b.ey.x=b.ex.y,b.ey.y=f+v+x*p.x*p.x+A*d.x*d.x;var B=y.neg(b.solve(u));return i.subMul(f,B),o-=x*y.crossVec2Vec2(p,B),s.addMul(v,B),n+=A*y.crossVec2Vec2(d,B),this.m_bodyA.c_position.c.setVec2(i),this.m_bodyA.c_position.a=o,this.m_bodyB.c_position.c.setVec2(s),this.m_bodyB.c_position.a=n,e<=g.linearSlop&&m<=g.angularSlop},e.TYPE="revolute-joint",e}(Et),Ko=Math.abs,Xo=Math.max,Go=Math.min;!function(t){t[t.inactiveLimit=0]="inactiveLimit",t[t.atLowerLimit=1]="atLowerLimit",t[t.atUpperLimit=2]="atUpperLimit",t[t.equalLimits=3]="equalLimits"}(Ro||(Ro={}));var Qo,$o={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:0,motorSpeed:0},ts=function(t){function e(i,o,n,r,a){var m=this;return m instanceof e?(i=s(i,$o),o=(m=t.call(this,i,o,n)||this).m_bodyA,n=m.m_bodyB,m.m_type=e.TYPE,m.m_localAnchorA=y.clone(r?o.getLocalPoint(r):i.localAnchorA||y.zero()),m.m_localAnchorB=y.clone(r?n.getLocalPoint(r):i.localAnchorB||y.zero()),m.m_localXAxisA=y.clone(a?o.getLocalVector(a):i.localAxisA||y.neo(1,0)),m.m_localXAxisA.normalize(),m.m_localYAxisA=y.crossNumVec2(1,m.m_localXAxisA),m.m_referenceAngle=Number.isFinite(i.referenceAngle)?i.referenceAngle:n.getAngle()-o.getAngle(),m.m_impulse=new no,m.m_motorMass=0,m.m_motorImpulse=0,m.m_lowerTranslation=i.lowerTranslation,m.m_upperTranslation=i.upperTranslation,m.m_maxMotorForce=i.maxMotorForce,m.m_motorSpeed=i.motorSpeed,m.m_enableLimit=i.enableLimit,m.m_enableMotor=i.enableMotor,m.m_limitState=Ro.inactiveLimit,m.m_axis=y.zero(),m.m_perp=y.zero(),m.m_K=new Do,m):new e(i,o,n,r,a)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerTranslation:this.m_lowerTranslation,upperTranslation:this.m_upperTranslation,maxMotorForce:this.m_maxMotorForce,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA,referenceAngle:this.m_referenceAngle}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),t.localAxisA=y.clone(t.localAxisA),new e(t)},e.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.setVec2(t.localAnchorA),t.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.setVec2(t.localAnchorB),t.localAxisA&&(this.m_localXAxisA.setVec2(t.localAxisA),this.m_localYAxisA.setVec2(y.crossNumVec2(1,t.localAxisA)))},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.getLocalAxisA=function(){return this.m_localXAxisA},e.prototype.getReferenceAngle=function(){return this.m_referenceAngle},e.prototype.getJointTranslation=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_bodyB.getWorldPoint(this.m_localAnchorB),i=y.sub(e,t),o=this.m_bodyA.getWorldVector(this.m_localXAxisA);return y.dot(i,o)},e.prototype.getJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB,i=ut.mulVec2(t.m_xf.q,y.sub(this.m_localAnchorA,t.m_sweep.localCenter)),o=ut.mulVec2(e.m_xf.q,y.sub(this.m_localAnchorB,e.m_sweep.localCenter)),s=y.add(t.m_sweep.c,i),n=y.add(e.m_sweep.c,o),r=y.sub(n,s),a=ut.mulVec2(t.m_xf.q,this.m_localXAxisA),m=t.m_linearVelocity,h=e.m_linearVelocity,c=t.m_angularVelocity,_=e.m_angularVelocity;return y.dot(r,y.crossNumVec2(c,a))+y.dot(a,y.sub(y.addCrossNumVec2(h,_,o),y.addCrossNumVec2(m,c,i)))},e.prototype.isLimitEnabled=function(){return this.m_enableLimit},e.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},e.prototype.getLowerLimit=function(){return this.m_lowerTranslation},e.prototype.getUpperLimit=function(){return this.m_upperTranslation},e.prototype.setLimits=function(t,e){t==this.m_lowerTranslation&&e==this.m_upperTranslation||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)},e.prototype.isMotorEnabled=function(){return this.m_enableMotor},e.prototype.enableMotor=function(t){t!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t)},e.prototype.setMotorSpeed=function(t){t!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t)},e.prototype.setMaxMotorForce=function(t){t!=this.m_maxMotorForce&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=t)},e.prototype.getMaxMotorForce=function(){return this.m_maxMotorForce},e.prototype.getMotorSpeed=function(){return this.m_motorSpeed},e.prototype.getMotorForce=function(t){return t*this.m_motorImpulse},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(t)},e.prototype.getReactionTorque=function(t){return t*this.m_impulse.y},e.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,h=ut.neo(i),c=ut.neo(r),_=ut.mulVec2(h,y.sub(this.m_localAnchorA,this.m_localCenterA)),l=ut.mulVec2(c,y.sub(this.m_localAnchorB,this.m_localCenterB)),u=y.zero();u.addCombine(1,n,1,l),u.subCombine(1,e,1,_);var p=this.m_invMassA,d=this.m_invMassB,f=this.m_invIA,v=this.m_invIB;this.m_axis=ut.mulVec2(h,this.m_localXAxisA),this.m_a1=y.crossVec2Vec2(y.add(u,_),this.m_axis),this.m_a2=y.crossVec2Vec2(l,this.m_axis),this.m_motorMass=p+d+f*this.m_a1*this.m_a1+v*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),this.m_perp=ut.mulVec2(h,this.m_localYAxisA),this.m_s1=y.crossVec2Vec2(y.add(u,_),this.m_perp),this.m_s2=y.crossVec2Vec2(l,this.m_perp),y.crossVec2Vec2(_,this.m_perp);var x=p+d+f*this.m_s1*this.m_s1+v*this.m_s2*this.m_s2,A=f*this.m_s1+v*this.m_s2,b=f*this.m_s1*this.m_a1+v*this.m_s2*this.m_a2,B=f+v;0==B&&(B=1);var w=f*this.m_a1+v*this.m_a2,V=p+d+f*this.m_a1*this.m_a1+v*this.m_a2*this.m_a2;if(this.m_K.ex.set(x,A,b),this.m_K.ey.set(A,B,w),this.m_K.ez.set(b,w,V),this.m_enableLimit){var C=y.dot(this.m_axis,u);Ko(this.m_upperTranslation-this.m_lowerTranslation)<2*g.linearSlop?this.m_limitState=Ro.equalLimits:C<=this.m_lowerTranslation?this.m_limitState!=Ro.atLowerLimit&&(this.m_limitState=Ro.atLowerLimit,this.m_impulse.z=0):C>=this.m_upperTranslation?this.m_limitState!=Ro.atUpperLimit&&(this.m_limitState=Ro.atUpperLimit,this.m_impulse.z=0):(this.m_limitState=Ro.inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=Ro.inactiveLimit,this.m_impulse.z=0;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var M=y.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),I=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,P=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;o.subMul(p,M),s-=f*I,a.addMul(d,M),m+=v*P}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.setVec2(o),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.setVec2(a),this.m_bodyB.c_velocity.w=m},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,n=this.m_invMassA,r=this.m_invMassB,a=this.m_invIA,m=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!=Ro.equalLimits){var c=y.dot(this.m_axis,y.sub(o,e))+this.m_a2*s-this.m_a1*i,_=this.m_motorMass*(this.m_motorSpeed-c),l=this.m_motorImpulse,u=t.dt*this.m_maxMotorForce;this.m_motorImpulse=h(this.m_motorImpulse+_,-u,u),_=this.m_motorImpulse-l;var p=y.mulNumVec2(_,this.m_axis),d=_*this.m_a1,f=_*this.m_a2;e.subMul(n,p),i-=a*d,o.addMul(r,p),s+=m*f}var v=y.zero();if(v.x+=y.dot(this.m_perp,o)+this.m_s2*s,v.x-=y.dot(this.m_perp,e)+this.m_s1*i,v.y=s-i,this.m_enableLimit&&this.m_limitState!=Ro.inactiveLimit){var x=0;x+=y.dot(this.m_axis,o)+this.m_a2*s,x-=y.dot(this.m_axis,e)+this.m_a1*i;c=new no(v.x,v.y,x);var A=no.clone(this.m_impulse),g=this.m_K.solve33(no.neg(c));this.m_impulse.add(g),this.m_limitState==Ro.atLowerLimit?this.m_impulse.z=Xo(this.m_impulse.z,0):this.m_limitState==Ro.atUpperLimit&&(this.m_impulse.z=Go(this.m_impulse.z,0));var b=y.combine(-1,v,-(this.m_impulse.z-A.z),y.neo(this.m_K.ez.x,this.m_K.ez.y)),B=y.add(this.m_K.solve22(b),y.neo(A.x,A.y));this.m_impulse.x=B.x,this.m_impulse.y=B.y,g=no.sub(this.m_impulse,A);p=y.combine(g.x,this.m_perp,g.z,this.m_axis),d=g.x*this.m_s1+g.y+g.z*this.m_a1,f=g.x*this.m_s2+g.y+g.z*this.m_a2;e.subMul(n,p),i-=a*d,o.addMul(r,p),s+=m*f}else{g=this.m_K.solve22(y.neg(v));this.m_impulse.x+=g.x,this.m_impulse.y+=g.y;p=y.mulNumVec2(g.x,this.m_perp),d=g.x*this.m_s1+g.y,f=g.x*this.m_s2+g.y;e.subMul(n,p),i-=a*d,o.addMul(r,p),s+=m*f}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},e.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,n=ut.neo(i),r=ut.neo(s),a=this.m_invMassA,m=this.m_invMassB,c=this.m_invIA,_=this.m_invIB,l=ut.mulVec2(n,y.sub(this.m_localAnchorA,this.m_localCenterA)),u=ut.mulVec2(r,y.sub(this.m_localAnchorB,this.m_localCenterB)),p=y.sub(y.add(o,u),y.add(e,l)),d=ut.mulVec2(n,this.m_localXAxisA),f=y.crossVec2Vec2(y.add(p,l),d),v=y.crossVec2Vec2(u,d),x=ut.mulVec2(n,this.m_localYAxisA),A=y.crossVec2Vec2(y.add(p,l),x),b=y.crossVec2Vec2(u,x),B=new no,w=y.zero();w.x=y.dot(x,p),w.y=s-i-this.m_referenceAngle;var V=Ko(w.x),C=Ko(w.y),M=g.linearSlop,I=g.maxLinearCorrection,P=!1,S=0;if(this.m_enableLimit){var T=y.dot(d,p);Ko(this.m_upperTranslation-this.m_lowerTranslation)<2*M?(S=h(T,-I,I),V=Xo(V,Ko(T)),P=!0):T<=this.m_lowerTranslation?(S=h(T-this.m_lowerTranslation+M,-I,0),V=Math.max(V,this.m_lowerTranslation-T),P=!0):T>=this.m_upperTranslation&&(S=h(T-this.m_upperTranslation-M,0,I),V=Math.max(V,T-this.m_upperTranslation),P=!0)}if(P){var z=a+m+c*A*A+_*b*b,F=c*A+_*b,L=c*A*f+_*b*v;0==(j=c+_)&&(j=1);var q=c*f+_*v,k=a+m+c*f*f+_*v*v;(D=new Do).ex.set(z,F,L),D.ey.set(F,j,q),D.ez.set(L,q,k);var N=new no;N.x=w.x,N.y=w.y,N.z=S,B=D.solve33(no.neg(N))}else{var j,D;z=a+m+c*A*A+_*b*b,F=c*A+_*b;0==(j=c+_)&&(j=1),(D=new ii).ex.setNum(z,F),D.ey.setNum(F,j);var O=D.solve(y.neg(w));B.x=O.x,B.y=O.y,B.z=0}var R=y.combine(B.x,x,B.z,d),E=B.x*A+B.y+B.z*f,J=B.x*b+B.y+B.z*v;return e.subMul(a,R),i-=c*E,o.addMul(m,R),s+=_*J,this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=s,V<=g.linearSlop&&C<=g.angularSlop},e.TYPE="prismatic-joint",e}(Et),es={ratio:1},is=function(t){function e(i,o,n,r,a,m){var h,c,_=this;if(!(_ instanceof e))return new e(i,o,n,r,a,m);i=s(i,es),o=(_=t.call(this,i,o,n)||this).m_bodyA,n=_.m_bodyB,_.m_type=e.TYPE,_.m_joint1=r||i.joint1,_.m_joint2=a||i.joint2,_.m_ratio=Number.isFinite(m)?m:i.ratio,_.m_type1=_.m_joint1.getType(),_.m_type2=_.m_joint2.getType(),_.m_bodyC=_.m_joint1.getBodyA(),_.m_bodyA=_.m_joint1.getBodyB();var l=_.m_bodyA.m_xf,u=_.m_bodyA.m_sweep.a,p=_.m_bodyC.m_xf,d=_.m_bodyC.m_sweep.a;if(_.m_type1===Zo.TYPE){var f=_.m_joint1;_.m_localAnchorC=f.m_localAnchorA,_.m_localAnchorA=f.m_localAnchorB,_.m_referenceAngleA=f.m_referenceAngle,_.m_localAxisC=y.zero(),h=u-d-_.m_referenceAngleA}else{var v=_.m_joint1;_.m_localAnchorC=v.m_localAnchorA,_.m_localAnchorA=v.m_localAnchorB,_.m_referenceAngleA=v.m_referenceAngle,_.m_localAxisC=v.m_localXAxisA;var x=_.m_localAnchorC,A=ut.mulTVec2(p.q,y.add(ut.mulVec2(l.q,_.m_localAnchorA),y.sub(l.p,p.p)));h=y.dot(A,_.m_localAxisC)-y.dot(x,_.m_localAxisC)}_.m_bodyD=_.m_joint2.getBodyA(),_.m_bodyB=_.m_joint2.getBodyB();var g=_.m_bodyB.m_xf,b=_.m_bodyB.m_sweep.a,B=_.m_bodyD.m_xf,w=_.m_bodyD.m_sweep.a;if(_.m_type2===Zo.TYPE){f=_.m_joint2;_.m_localAnchorD=f.m_localAnchorA,_.m_localAnchorB=f.m_localAnchorB,_.m_referenceAngleB=f.m_referenceAngle,_.m_localAxisD=y.zero(),c=b-w-_.m_referenceAngleB}else{v=_.m_joint2;_.m_localAnchorD=v.m_localAnchorA,_.m_localAnchorB=v.m_localAnchorB,_.m_referenceAngleB=v.m_referenceAngle,_.m_localAxisD=v.m_localXAxisA;var V=_.m_localAnchorD,C=ut.mulTVec2(B.q,y.add(ut.mulVec2(g.q,_.m_localAnchorB),y.sub(g.p,B.p)));c=y.dot(C,_.m_localAxisD)-y.dot(V,_.m_localAxisD)}return _.m_constant=h+_.m_ratio*c,_.m_impulse=0,_}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,joint1:this.m_joint1,joint2:this.m_joint2,ratio:this.m_ratio}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),t.joint1=s(Et,t.joint1,i),t.joint2=s(Et,t.joint2,i),new e(t)},e.prototype.getJoint1=function(){return this.m_joint1},e.prototype.getJoint2=function(){return this.m_joint2},e.prototype.setRatio=function(t){this.m_ratio=t},e.prototype.getRatio=function(){return this.m_ratio},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.mulNumVec2(this.m_impulse,this.m_JvAC).mul(t)},e.prototype.getReactionTorque=function(t){return t*(this.m_impulse*this.m_JwA)},e.prototype.initVelocityConstraints=function(t){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,a=this.m_bodyC.c_position.a,m=this.m_bodyC.c_velocity.v,h=this.m_bodyC.c_velocity.w,c=this.m_bodyD.c_position.a,_=this.m_bodyD.c_velocity.v,l=this.m_bodyD.c_velocity.w,u=ut.neo(e),p=ut.neo(s),d=ut.neo(a),f=ut.neo(c);if(this.m_mass=0,this.m_type1==Zo.TYPE)this.m_JvAC=y.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var v=ut.mulVec2(d,this.m_localAxisC),x=ut.mulSub(d,this.m_localAnchorC,this.m_lcC),A=ut.mulSub(u,this.m_localAnchorA,this.m_lcA);this.m_JvAC=v,this.m_JwC=y.crossVec2Vec2(x,v),this.m_JwA=y.crossVec2Vec2(A,v),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==Zo.TYPE)this.m_JvBD=y.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{v=ut.mulVec2(f,this.m_localAxisD);var g=ut.mulSub(f,this.m_localAnchorD,this.m_lcD),b=ut.mulSub(p,this.m_localAnchorB,this.m_lcB);this.m_JvBD=y.mulNumVec2(this.m_ratio,v),this.m_JwD=this.m_ratio*y.crossVec2Vec2(g,v),this.m_JwB=this.m_ratio*y.crossVec2Vec2(b,v),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.warmStarting?(i.addMul(this.m_mA*this.m_impulse,this.m_JvAC),o+=this.m_iA*this.m_impulse*this.m_JwA,n.addMul(this.m_mB*this.m_impulse,this.m_JvBD),r+=this.m_iB*this.m_impulse*this.m_JwB,m.subMul(this.m_mC*this.m_impulse,this.m_JvAC),h-=this.m_iC*this.m_impulse*this.m_JwC,_.subMul(this.m_mD*this.m_impulse,this.m_JvBD),l-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.setVec2(i),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.setVec2(n),this.m_bodyB.c_velocity.w=r,this.m_bodyC.c_velocity.v.setVec2(m),this.m_bodyC.c_velocity.w=h,this.m_bodyD.c_velocity.v.setVec2(_),this.m_bodyD.c_velocity.w=l},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,n=this.m_bodyC.c_velocity.v,r=this.m_bodyC.c_velocity.w,a=this.m_bodyD.c_velocity.v,m=this.m_bodyD.c_velocity.w,h=y.dot(this.m_JvAC,e)-y.dot(this.m_JvAC,n)+y.dot(this.m_JvBD,o)-y.dot(this.m_JvBD,a);h+=this.m_JwA*i-this.m_JwC*r+(this.m_JwB*s-this.m_JwD*m);var c=-this.m_mass*h;this.m_impulse+=c,e.addMul(this.m_mA*c,this.m_JvAC),i+=this.m_iA*c*this.m_JwA,o.addMul(this.m_mB*c,this.m_JvBD),s+=this.m_iB*c*this.m_JwB,n.subMul(this.m_mC*c,this.m_JvAC),r-=this.m_iC*c*this.m_JwC,a.subMul(this.m_mD*c,this.m_JvBD),m-=this.m_iD*c*this.m_JwD,this.m_bodyA.c_velocity.v.setVec2(e),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.setVec2(o),this.m_bodyB.c_velocity.w=s,this.m_bodyC.c_velocity.v.setVec2(n),this.m_bodyC.c_velocity.w=r,this.m_bodyD.c_velocity.v.setVec2(a),this.m_bodyD.c_velocity.w=m},e.prototype.solvePositionConstraints=function(t){var e,i,o,s,n,r,a,m,h=this.m_bodyA.c_position.c,c=this.m_bodyA.c_position.a,_=this.m_bodyB.c_position.c,l=this.m_bodyB.c_position.a,u=this.m_bodyC.c_position.c,p=this.m_bodyC.c_position.a,d=this.m_bodyD.c_position.c,f=this.m_bodyD.c_position.a,v=ut.neo(c),x=ut.neo(l),A=ut.neo(p),b=ut.neo(f),B=0;if(this.m_type1==Zo.TYPE)o=y.zero(),n=1,a=1,B+=this.m_iA+this.m_iC,e=c-p-this.m_referenceAngleA;else{var w=ut.mulVec2(A,this.m_localAxisC),V=ut.mulSub(A,this.m_localAnchorC,this.m_lcC),C=ut.mulSub(v,this.m_localAnchorA,this.m_lcA);o=w,a=y.crossVec2Vec2(V,w),n=y.crossVec2Vec2(C,w),B+=this.m_mC+this.m_mA+this.m_iC*a*a+this.m_iA*n*n;var M=y.sub(this.m_localAnchorC,this.m_lcC),I=ut.mulTVec2(A,y.add(C,y.sub(h,u)));e=y.dot(y.sub(I,M),this.m_localAxisC)}if(this.m_type2==Zo.TYPE)s=y.zero(),r=this.m_ratio,m=this.m_ratio,B+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),i=l-f-this.m_referenceAngleB;else{w=ut.mulVec2(b,this.m_localAxisD);var P=ut.mulSub(b,this.m_localAnchorD,this.m_lcD),S=ut.mulSub(x,this.m_localAnchorB,this.m_lcB);s=y.mulNumVec2(this.m_ratio,w),m=this.m_ratio*y.crossVec2Vec2(P,w),r=this.m_ratio*y.crossVec2Vec2(S,w),B+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*m*m+this.m_iB*r*r;var T=y.sub(this.m_localAnchorD,this.m_lcD),z=ut.mulTVec2(b,y.add(S,y.sub(_,d)));i=y.dot(z,this.m_localAxisD)-y.dot(T,this.m_localAxisD)}var F=e+this.m_ratio*i-this.m_constant,L=0;return B>0&&(L=-F/B),h.addMul(this.m_mA*L,o),c+=this.m_iA*L*n,_.addMul(this.m_mB*L,s),l+=this.m_iB*L*r,u.subMul(this.m_mC*L,o),p-=this.m_iC*L*a,d.subMul(this.m_mD*L,s),f-=this.m_iD*L*m,this.m_bodyA.c_position.c.setVec2(h),this.m_bodyA.c_position.a=c,this.m_bodyB.c_position.c.setVec2(_),this.m_bodyB.c_position.a=l,this.m_bodyC.c_position.c.setVec2(u),this.m_bodyC.c_position.a=p,this.m_bodyD.c_position.c.setVec2(d),this.m_bodyD.c_position.a=f,0<g.linearSlop},e.TYPE="gear-joint",e}(Et),os={maxForce:1,maxTorque:1,correctionFactor:.3},ss=function(t){function e(i,o,n){var r=this;return r instanceof e?(i=s(i,os),o=(r=t.call(this,i,o,n)||this).m_bodyA,n=r.m_bodyB,r.m_type=e.TYPE,r.m_linearOffset=Number.isFinite(i.linearOffset)?y.clone(i.linearOffset):o.getLocalPoint(n.getPosition()),r.m_angularOffset=Number.isFinite(i.angularOffset)?i.angularOffset:n.getAngle()-o.getAngle(),r.m_linearImpulse=y.zero(),r.m_angularImpulse=0,r.m_maxForce=i.maxForce,r.m_maxTorque=i.maxTorque,r.m_correctionFactor=i.correctionFactor,r):new e(i,o,n)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,correctionFactor:this.m_correctionFactor,linearOffset:this.m_linearOffset,angularOffset:this.m_angularOffset}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),new e(t)},e.prototype._setAnchors=function(t){},e.prototype.setMaxForce=function(t){this.m_maxForce=t},e.prototype.getMaxForce=function(){return this.m_maxForce},e.prototype.setMaxTorque=function(t){this.m_maxTorque=t},e.prototype.getMaxTorque=function(){return this.m_maxTorque},e.prototype.setCorrectionFactor=function(t){this.m_correctionFactor=t},e.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},e.prototype.setLinearOffset=function(t){t.x==this.m_linearOffset.x&&t.y==this.m_linearOffset.y||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset.set(t))},e.prototype.getLinearOffset=function(){return this.m_linearOffset},e.prototype.setAngularOffset=function(t){t!=this.m_angularOffset&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=t)},e.prototype.getAngularOffset=function(){return this.m_angularOffset},e.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},e.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},e.prototype.getReactionForce=function(t){return y.mulNumVec2(t,this.m_linearImpulse)},e.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},e.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,h=ut.neo(i),c=ut.neo(r);this.m_rA=ut.mulVec2(h,y.sub(this.m_linearOffset,this.m_localCenterA)),this.m_rB=ut.mulVec2(c,y.neg(this.m_localCenterB));var _=this.m_invMassA,l=this.m_invMassB,u=this.m_invIA,p=this.m_invIB,d=new ii;if(d.ex.x=_+l+u*this.m_rA.y*this.m_rA.y+p*this.m_rB.y*this.m_rB.y,d.ex.y=-u*this.m_rA.x*this.m_rA.y-p*this.m_rB.x*this.m_rB.y,d.ey.x=d.ex.y,d.ey.y=_+l+u*this.m_rA.x*this.m_rA.x+p*this.m_rB.x*this.m_rB.x,this.m_linearMass=d.getInverse(),this.m_angularMass=u+p,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=y.zero(),this.m_linearError.addCombine(1,n,1,this.m_rB),this.m_linearError.subCombine(1,e,1,this.m_rA),this.m_angularError=r-i-this.m_angularOffset,t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var f=y.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);o.subMul(_,f),s-=u*(y.crossVec2Vec2(this.m_rA,f)+this.m_angularImpulse),a.addMul(l,f),m+=p*(y.crossVec2Vec2(this.m_rB,f)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=o,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=m},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,n=this.m_invMassA,r=this.m_invMassB,a=this.m_invIA,m=this.m_invIB,c=t.dt,_=t.inv_dt,l=s-i+_*this.m_correctionFactor*this.m_angularError,u=-this.m_angularMass*l,p=this.m_angularImpulse,d=c*this.m_maxTorque;this.m_angularImpulse=h(this.m_angularImpulse+u,-d,d),i-=a*(u=this.m_angularImpulse-p),s+=m*u,(l=y.zero()).addCombine(1,o,1,y.crossNumVec2(s,this.m_rB)),l.subCombine(1,e,1,y.crossNumVec2(i,this.m_rA)),l.addMul(_*this.m_correctionFactor,this.m_linearError);u=y.neg(ii.mulVec2(this.m_linearMass,l)),p=y.clone(this.m_linearImpulse);this.m_linearImpulse.add(u);d=c*this.m_maxForce;this.m_linearImpulse.clamp(d),u=y.sub(this.m_linearImpulse,p),e.subMul(n,u),i-=a*y.crossVec2Vec2(this.m_rA,u),o.addMul(r,u),s+=m*y.crossVec2Vec2(this.m_rB,u),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},e.prototype.solvePositionConstraints=function(t){return!0},e.TYPE="motor-joint",e}(Et),ns=Math.PI,rs={maxForce:0,frequencyHz:5,dampingRatio:.7},as=function(t){function e(i,o,n,r){var a=this;return a instanceof e?(i=s(i,rs),o=(a=t.call(this,i,o,n)||this).m_bodyA,n=a.m_bodyB,a.m_type=e.TYPE,y.isValid(r)?a.m_targetA=y.clone(r):y.isValid(i.target)?a.m_targetA=y.clone(i.target):a.m_targetA=y.zero(),a.m_localAnchorB=vt.mulTVec2(n.getTransform(),a.m_targetA),a.m_maxForce=i.maxForce,a.m_impulse=y.zero(),a.m_frequencyHz=i.frequencyHz,a.m_dampingRatio=i.dampingRatio,a.m_beta=0,a.m_gamma=0,a.m_rB=y.zero(),a.m_localCenterB=y.zero(),a.m_invMassB=0,a.m_invIB=0,a.m_mass=new ii,a.m_C=y.zero(),a):new e(i,o,n,r)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,target:this.m_targetA,maxForce:this.m_maxForce,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,_localAnchorB:this.m_localAnchorB}},e._deserialize=function(t,i,s){(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),t.target=y.clone(t.target);var n=new e(t);return t._localAnchorB&&(n.m_localAnchorB=t._localAnchorB),n},e.prototype.setTarget=function(t){y.areEqual(t,this.m_targetA)||(this.m_bodyB.setAwake(!0),this.m_targetA.set(t))},e.prototype.getTarget=function(){return this.m_targetA},e.prototype.setMaxForce=function(t){this.m_maxForce=t},e.prototype.getMaxForce=function(){return this.m_maxForce},e.prototype.setFrequency=function(t){this.m_frequencyHz=t},e.prototype.getFrequency=function(){return this.m_frequencyHz},e.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.getDampingRatio=function(){return this.m_dampingRatio},e.prototype.getAnchorA=function(){return y.clone(this.m_targetA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.mulNumVec2(t,this.m_impulse)},e.prototype.getReactionTorque=function(t){return 0*t},e.prototype.shiftOrigin=function(t){this.m_targetA.sub(t)},e.prototype.initVelocityConstraints=function(t){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyB.c_position,i=this.m_bodyB.c_velocity,o=e.c,s=e.a,n=i.v,r=i.w,a=ut.neo(s),m=this.m_bodyB.getMass(),h=2*ns*this.m_frequencyHz,c=2*m*this.m_dampingRatio*h,_=m*(h*h),l=t.dt;this.m_gamma=l*(c+l*_),0!=this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=l*_*this.m_gamma,this.m_rB=ut.mulVec2(a,y.sub(this.m_localAnchorB,this.m_localCenterB));var u=new ii;u.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,u.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,u.ey.x=u.ex.y,u.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=u.getInverse(),this.m_C.setVec2(o),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),r*=.98,t.warmStarting?(this.m_impulse.mul(t.dtRatio),n.addMul(this.m_invMassB,this.m_impulse),r+=this.m_invIB*y.crossVec2Vec2(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),i.v.setVec2(n),i.w=r},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyB.c_velocity,i=y.clone(e.v),o=e.w,s=y.crossNumVec2(o,this.m_rB);s.add(i),s.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),s.neg();var n=ii.mulVec2(this.m_mass,s),r=y.clone(this.m_impulse);this.m_impulse.add(n);var a=t.dt*this.m_maxForce;this.m_impulse.clamp(a),n=y.sub(this.m_impulse,r),i.addMul(this.m_invMassB,n),o+=this.m_invIB*y.crossVec2Vec2(this.m_rB,n),e.v.setVec2(i),e.w=o},e.prototype.solvePositionConstraints=function(t){return!0},e.TYPE="mouse-joint",e}(Et),ms=Math.abs,hs={collideConnected:!0},cs=function(t){function e(i,o,n,r,a,m,h,c){var _=this;return _ instanceof e?(i=s(i,hs),o=(_=t.call(this,i,o,n)||this).m_bodyA,n=_.m_bodyB,_.m_type=e.TYPE,_.m_groundAnchorA=y.clone(r||(i.groundAnchorA||y.neo(-1,1))),_.m_groundAnchorB=y.clone(a||(i.groundAnchorB||y.neo(1,1))),_.m_localAnchorA=y.clone(m?o.getLocalPoint(m):i.localAnchorA||y.neo(-1,0)),_.m_localAnchorB=y.clone(h?n.getLocalPoint(h):i.localAnchorB||y.neo(1,0)),_.m_lengthA=Number.isFinite(i.lengthA)?i.lengthA:y.distance(m,r),_.m_lengthB=Number.isFinite(i.lengthB)?i.lengthB:y.distance(h,a),_.m_ratio=Number.isFinite(c)?c:i.ratio,_.m_constant=_.m_lengthA+_.m_ratio*_.m_lengthB,_.m_impulse=0,_):new e(i,o,n,r,a,m,h,c)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,groundAnchorA:this.m_groundAnchorA,groundAnchorB:this.m_groundAnchorB,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,lengthA:this.m_lengthA,lengthB:this.m_lengthB,ratio:this.m_ratio}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),new e(t)},e.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},e.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},e.prototype.getLengthA=function(){return this.m_lengthA},e.prototype.getLengthB=function(){return this.m_lengthB},e.prototype.getRatio=function(){return this.m_ratio},e.prototype.getCurrentLengthA=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_groundAnchorA;return y.distance(t,e)},e.prototype.getCurrentLengthB=function(){var t=this.m_bodyB.getWorldPoint(this.m_localAnchorB),e=this.m_groundAnchorB;return y.distance(t,e)},e.prototype.shiftOrigin=function(t){this.m_groundAnchorA.sub(t),this.m_groundAnchorB.sub(t)},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.mulNumVec2(this.m_impulse,this.m_uB).mul(t)},e.prototype.getReactionTorque=function(t){return 0},e.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,h=ut.neo(i),c=ut.neo(r);this.m_rA=ut.mulVec2(h,y.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=ut.mulVec2(c,y.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=y.sub(y.add(e,this.m_rA),this.m_groundAnchorA),this.m_uB=y.sub(y.add(n,this.m_rB),this.m_groundAnchorB);var _=this.m_uA.length(),l=this.m_uB.length();_>10*g.linearSlop?this.m_uA.mul(1/_):this.m_uA.setZero(),l>10*g.linearSlop?this.m_uB.mul(1/l):this.m_uB.setZero();var u=y.crossVec2Vec2(this.m_rA,this.m_uA),p=y.crossVec2Vec2(this.m_rB,this.m_uB),d=this.m_invMassA+this.m_invIA*u*u,f=this.m_invMassB+this.m_invIB*p*p;if(this.m_mass=d+this.m_ratio*this.m_ratio*f,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.warmStarting){this.m_impulse*=t.dtRatio;var v=y.mulNumVec2(-this.m_impulse,this.m_uA),x=y.mulNumVec2(-this.m_ratio*this.m_impulse,this.m_uB);o.addMul(this.m_invMassA,v),s+=this.m_invIA*y.crossVec2Vec2(this.m_rA,v),a.addMul(this.m_invMassB,x),m+=this.m_invIB*y.crossVec2Vec2(this.m_rB,x)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=o,this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=m},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,n=y.add(e,y.crossNumVec2(i,this.m_rA)),r=y.add(o,y.crossNumVec2(s,this.m_rB)),a=-y.dot(this.m_uA,n)-this.m_ratio*y.dot(this.m_uB,r),m=-this.m_mass*a;this.m_impulse+=m;var h=y.mulNumVec2(-m,this.m_uA),c=y.mulNumVec2(-this.m_ratio*m,this.m_uB);e.addMul(this.m_invMassA,h),i+=this.m_invIA*y.crossVec2Vec2(this.m_rA,h),o.addMul(this.m_invMassB,c),s+=this.m_invIB*y.crossVec2Vec2(this.m_rB,c),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},e.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,n=ut.neo(i),r=ut.neo(s),a=ut.mulVec2(n,y.sub(this.m_localAnchorA,this.m_localCenterA)),m=ut.mulVec2(r,y.sub(this.m_localAnchorB,this.m_localCenterB)),h=y.sub(y.add(e,this.m_rA),this.m_groundAnchorA),c=y.sub(y.add(o,this.m_rB),this.m_groundAnchorB),_=h.length(),l=c.length();_>10*g.linearSlop?h.mul(1/_):h.setZero(),l>10*g.linearSlop?c.mul(1/l):c.setZero();var u=y.crossVec2Vec2(a,h),p=y.crossVec2Vec2(m,c),d=this.m_invMassA+this.m_invIA*u*u,f=this.m_invMassB+this.m_invIB*p*p,v=d+this.m_ratio*this.m_ratio*f;v>0&&(v=1/v);var x=this.m_constant-_-this.m_ratio*l,A=ms(x),b=-v*x,B=y.mulNumVec2(-b,h),w=y.mulNumVec2(-this.m_ratio*b,c);return e.addMul(this.m_invMassA,B),i+=this.m_invIA*y.crossVec2Vec2(a,B),o.addMul(this.m_invMassB,w),s+=this.m_invIB*y.crossVec2Vec2(m,w),this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=o,this.m_bodyB.c_position.a=s,A<g.linearSlop},e.TYPE="pulley-joint",e}(Et),_s=Math.min;!function(t){t[t.inactiveLimit=0]="inactiveLimit",t[t.atLowerLimit=1]="atLowerLimit",t[t.atUpperLimit=2]="atUpperLimit",t[t.equalLimits=3]="equalLimits"}(Qo||(Qo={}));var ls={maxLength:0},us=function(t){function e(i,o,n,r){var a=this;return a instanceof e?(i=s(i,ls),o=(a=t.call(this,i,o,n)||this).m_bodyA,n=a.m_bodyB,a.m_type=e.TYPE,a.m_localAnchorA=y.clone(r?o.getLocalPoint(r):i.localAnchorA||y.neo(-1,0)),a.m_localAnchorB=y.clone(r?n.getLocalPoint(r):i.localAnchorB||y.neo(1,0)),a.m_maxLength=i.maxLength,a.m_mass=0,a.m_impulse=0,a.m_length=0,a.m_state=Qo.inactiveLimit,a):new e(i,o,n,r)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,maxLength:this.m_maxLength}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),new e(t)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.setMaxLength=function(t){this.m_maxLength=t},e.prototype.getMaxLength=function(){return this.m_maxLength},e.prototype.getLimitState=function(){return this.m_state},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.mulNumVec2(this.m_impulse,this.m_u).mul(t)},e.prototype.getReactionTorque=function(t){return 0},e.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyA.c_velocity.v,s=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,h=ut.neo(i),c=ut.neo(r);this.m_rA=ut.mulSub(h,this.m_localAnchorA,this.m_localCenterA),this.m_rB=ut.mulSub(c,this.m_localAnchorB,this.m_localCenterB),this.m_u=y.zero(),this.m_u.addCombine(1,n,1,this.m_rB),this.m_u.subCombine(1,e,1,this.m_rA),this.m_length=this.m_u.length();var _=this.m_length-this.m_maxLength;if(this.m_state=_>0?Qo.atUpperLimit:Qo.inactiveLimit,!(this.m_length>g.linearSlop))return this.m_u.setZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.mul(1/this.m_length);var l=y.crossVec2Vec2(this.m_rA,this.m_u),u=y.crossVec2Vec2(this.m_rB,this.m_u),p=this.m_invMassA+this.m_invIA*l*l+this.m_invMassB+this.m_invIB*u*u;if(this.m_mass=0!=p?1/p:0,t.warmStarting){this.m_impulse*=t.dtRatio;var d=y.mulNumVec2(this.m_impulse,this.m_u);o.subMul(this.m_invMassA,d),s-=this.m_invIA*y.crossVec2Vec2(this.m_rA,d),a.addMul(this.m_invMassB,d),m+=this.m_invIB*y.crossVec2Vec2(this.m_rB,d)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.setVec2(o),this.m_bodyA.c_velocity.w=s,this.m_bodyB.c_velocity.v.setVec2(a),this.m_bodyB.c_velocity.w=m},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,n=y.addCrossNumVec2(e,i,this.m_rA),r=y.addCrossNumVec2(o,s,this.m_rB),a=this.m_length-this.m_maxLength,m=y.dot(this.m_u,y.sub(r,n));a<0&&(m+=t.inv_dt*a);var h=-this.m_mass*m,c=this.m_impulse;this.m_impulse=_s(0,this.m_impulse+h),h=this.m_impulse-c;var _=y.mulNumVec2(h,this.m_u);e.subMul(this.m_invMassA,_),i-=this.m_invIA*y.crossVec2Vec2(this.m_rA,_),o.addMul(this.m_invMassB,_),s+=this.m_invIB*y.crossVec2Vec2(this.m_rB,_),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},e.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,n=ut.neo(i),r=ut.neo(s),a=ut.mulSub(n,this.m_localAnchorA,this.m_localCenterA),m=ut.mulSub(r,this.m_localAnchorB,this.m_localCenterB),c=y.zero();c.addCombine(1,o,1,m),c.subCombine(1,e,1,a);var _=c.normalize(),l=_-this.m_maxLength;l=h(l,0,g.maxLinearCorrection);var u=-this.m_mass*l,p=y.mulNumVec2(u,c);return e.subMul(this.m_invMassA,p),i-=this.m_invIA*y.crossVec2Vec2(a,p),o.addMul(this.m_invMassB,p),s+=this.m_invIB*y.crossVec2Vec2(m,p),this.m_bodyA.c_position.c.setVec2(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=s,_-this.m_maxLength<g.linearSlop},e.TYPE="rope-joint",e}(Et),ps=Math.abs,ys=Math.PI,ds={frequencyHz:0,dampingRatio:0},fs=function(t){function e(i,o,n,r){var a=this;return a instanceof e?(i=s(i,ds),o=(a=t.call(this,i,o,n)||this).m_bodyA,n=a.m_bodyB,a.m_type=e.TYPE,a.m_localAnchorA=y.clone(r?o.getLocalPoint(r):i.localAnchorA||y.zero()),a.m_localAnchorB=y.clone(r?n.getLocalPoint(r):i.localAnchorB||y.zero()),a.m_referenceAngle=Number.isFinite(i.referenceAngle)?i.referenceAngle:n.getAngle()-o.getAngle(),a.m_frequencyHz=i.frequencyHz,a.m_dampingRatio=i.dampingRatio,a.m_impulse=new no,a.m_bias=0,a.m_gamma=0,a.m_rA,a.m_rB,a.m_localCenterA,a.m_localCenterB,a.m_invMassA,a.m_invMassB,a.m_invIA,a.m_invIB,a.m_mass=new Do,a):new e(i,o,n,r)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),new e(t)},e.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.setVec2(t.localAnchorA),t.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.setVec2(t.localAnchorB)},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.getReferenceAngle=function(){return this.m_referenceAngle},e.prototype.setFrequency=function(t){this.m_frequencyHz=t},e.prototype.getFrequency=function(){return this.m_frequencyHz},e.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.getDampingRatio=function(){return this.m_dampingRatio},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.neo(this.m_impulse.x,this.m_impulse.y).mul(t)},e.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},e.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.a,n=this.m_bodyB.c_velocity.v,r=this.m_bodyB.c_velocity.w,a=ut.neo(e),m=ut.neo(s);this.m_rA=ut.mulVec2(a,y.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=ut.mulVec2(m,y.sub(this.m_localAnchorB,this.m_localCenterB));var h=this.m_invMassA,c=this.m_invMassB,_=this.m_invIA,l=this.m_invIB,u=new Do;if(u.ex.x=h+c+this.m_rA.y*this.m_rA.y*_+this.m_rB.y*this.m_rB.y*l,u.ey.x=-this.m_rA.y*this.m_rA.x*_-this.m_rB.y*this.m_rB.x*l,u.ez.x=-this.m_rA.y*_-this.m_rB.y*l,u.ex.y=u.ey.x,u.ey.y=h+c+this.m_rA.x*this.m_rA.x*_+this.m_rB.x*this.m_rB.x*l,u.ez.y=this.m_rA.x*_+this.m_rB.x*l,u.ex.z=u.ez.x,u.ey.z=u.ez.y,u.ez.z=_+l,this.m_frequencyHz>0){u.getInverse22(this.m_mass);var p=_+l,d=p>0?1/p:0,f=s-e-this.m_referenceAngle,v=2*ys*this.m_frequencyHz,x=2*d*this.m_dampingRatio*v,A=d*v*v,g=t.dt;this.m_gamma=g*(x+g*A),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=f*g*A*this.m_gamma,p+=this.m_gamma,this.m_mass.ez.z=0!=p?1/p:0}else 0==u.ez.z?(u.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(u.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(t.warmStarting){this.m_impulse.mul(t.dtRatio);var b=y.neo(this.m_impulse.x,this.m_impulse.y);i.subMul(h,b),o-=_*(y.crossVec2Vec2(this.m_rA,b)+this.m_impulse.z),n.addMul(c,b),r+=l*(y.crossVec2Vec2(this.m_rB,b)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=r},e.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,n=this.m_invMassA,r=this.m_invMassB,a=this.m_invIA,m=this.m_invIB;if(this.m_frequencyHz>0){var h=s-i,c=-this.m_mass.ez.z*(h+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=c,i-=a*c,s+=m*c,(u=y.zero()).addCombine(1,o,1,y.crossNumVec2(s,this.m_rB)),u.subCombine(1,e,1,y.crossNumVec2(i,this.m_rA));var _=y.neg(Do.mulVec2(this.m_mass,u));this.m_impulse.x+=_.x,this.m_impulse.y+=_.y;var l=y.clone(_);e.subMul(n,l),i-=a*y.crossVec2Vec2(this.m_rA,l),o.addMul(r,l),s+=m*y.crossVec2Vec2(this.m_rB,l)}else{var u;(u=y.zero()).addCombine(1,o,1,y.crossNumVec2(s,this.m_rB)),u.subCombine(1,e,1,y.crossNumVec2(i,this.m_rA));h=s-i;var p=new no(u.x,u.y,h),d=no.neg(Do.mulVec3(this.m_mass,p));this.m_impulse.add(d);l=y.neo(d.x,d.y);e.subMul(n,l),i-=a*(y.crossVec2Vec2(this.m_rA,l)+d.z),o.addMul(r,l),s+=m*(y.crossVec2Vec2(this.m_rB,l)+d.z)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},e.prototype.solvePositionConstraints=function(t){var e,i,o=this.m_bodyA.c_position.c,s=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,r=this.m_bodyB.c_position.a,a=ut.neo(s),m=ut.neo(r),h=this.m_invMassA,c=this.m_invMassB,_=this.m_invIA,l=this.m_invIB,u=ut.mulVec2(a,y.sub(this.m_localAnchorA,this.m_localCenterA)),p=ut.mulVec2(m,y.sub(this.m_localAnchorB,this.m_localCenterB)),d=new Do;if(d.ex.x=h+c+u.y*u.y*_+p.y*p.y*l,d.ey.x=-u.y*u.x*_-p.y*p.x*l,d.ez.x=-u.y*_-p.y*l,d.ex.y=d.ey.x,d.ey.y=h+c+u.x*u.x*_+p.x*p.x*l,d.ez.y=u.x*_+p.x*l,d.ex.z=d.ez.x,d.ey.z=d.ez.y,d.ez.z=_+l,this.m_frequencyHz>0){(v=y.zero()).addCombine(1,n,1,p),v.subCombine(1,o,1,u),e=v.length(),i=0;var f=y.neg(d.solve22(v));o.subMul(h,f),s-=_*y.crossVec2Vec2(u,f),n.addMul(c,f),r+=l*y.crossVec2Vec2(p,f)}else{var v;(v=y.zero()).addCombine(1,n,1,p),v.subCombine(1,o,1,u);var x=r-s-this.m_referenceAngle;e=v.length(),i=ps(x);var A=new no(v.x,v.y,x),b=new no;if(d.ez.z>0)b=no.neg(d.solve33(A));else{var B=y.neg(d.solve22(v));b.set(B.x,B.y,0)}f=y.neo(b.x,b.y);o.subMul(h,f),s-=_*(y.crossVec2Vec2(u,f)+b.z),n.addMul(c,f),r+=l*(y.crossVec2Vec2(p,f)+b.z)}return this.m_bodyA.c_position.c=o,this.m_bodyA.c_position.a=s,this.m_bodyB.c_position.c=n,this.m_bodyB.c_position.a=r,e<=g.linearSlop&&i<=g.angularSlop},e.TYPE="weld-joint",e}(Et),vs=Math.abs,xs=Math.PI,As={enableMotor:!1,maxMotorTorque:0,motorSpeed:0,frequencyHz:2,dampingRatio:.7},gs=function(t){function e(i,o,n,r,a){var m=this;return m instanceof e?(i=s(i,As),o=(m=t.call(this,i,o,n)||this).m_bodyA,n=m.m_bodyB,m.m_ax=y.zero(),m.m_ay=y.zero(),m.m_type=e.TYPE,m.m_localAnchorA=y.clone(r?o.getLocalPoint(r):i.localAnchorA||y.zero()),m.m_localAnchorB=y.clone(r?n.getLocalPoint(r):i.localAnchorB||y.zero()),y.isValid(a)?m.m_localXAxisA=o.getLocalVector(a):y.isValid(i.localAxisA)?m.m_localXAxisA=y.clone(i.localAxisA):y.isValid(i.localAxis)?m.m_localXAxisA=y.clone(i.localAxis):m.m_localXAxisA=y.neo(1,0),m.m_localYAxisA=y.crossNumVec2(1,m.m_localXAxisA),m.m_mass=0,m.m_impulse=0,m.m_motorMass=0,m.m_motorImpulse=0,m.m_springMass=0,m.m_springImpulse=0,m.m_maxMotorTorque=i.maxMotorTorque,m.m_motorSpeed=i.motorSpeed,m.m_enableMotor=i.enableMotor,m.m_frequencyHz=i.frequencyHz,m.m_dampingRatio=i.dampingRatio,m.m_bias=0,m.m_gamma=0,m):new e(i,o,n,r,a)}return i(e,t),e.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,enableMotor:this.m_enableMotor,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA}},e._deserialize=function(t,i,s){return(t=o({},t)).bodyA=s(Ot,t.bodyA,i),t.bodyB=s(Ot,t.bodyB,i),new e(t)},e.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.setVec2(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.setVec2(t.localAnchorA),t.anchorB?this.m_localAnchorB.setVec2(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.setVec2(t.localAnchorB),t.localAxisA&&(this.m_localXAxisA.setVec2(t.localAxisA),this.m_localYAxisA.setVec2(y.crossNumVec2(1,t.localAxisA)))},e.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},e.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},e.prototype.getLocalAxisA=function(){return this.m_localXAxisA},e.prototype.getJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,i=t.getWorldPoint(this.m_localAnchorA),o=e.getWorldPoint(this.m_localAnchorB),s=y.sub(o,i),n=t.getWorldVector(this.m_localXAxisA);return y.dot(s,n)},e.prototype.getJointSpeed=function(){var t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t},e.prototype.isMotorEnabled=function(){return this.m_enableMotor},e.prototype.enableMotor=function(t){t!=this.m_enableMotor&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t)},e.prototype.setMotorSpeed=function(t){t!=this.m_motorSpeed&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t)},e.prototype.getMotorSpeed=function(){return this.m_motorSpeed},e.prototype.setMaxMotorTorque=function(t){t!=this.m_maxMotorTorque&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t)},e.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},e.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},e.prototype.setSpringFrequencyHz=function(t){this.m_frequencyHz=t},e.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},e.prototype.setSpringDampingRatio=function(t){this.m_dampingRatio=t},e.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},e.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},e.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},e.prototype.getReactionForce=function(t){return y.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(t)},e.prototype.getReactionTorque=function(t){return t*this.m_motorImpulse},e.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_invMassA,i=this.m_invMassB,o=this.m_invIA,s=this.m_invIB,n=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,a=this.m_bodyA.c_velocity.v,m=this.m_bodyA.c_velocity.w,h=this.m_bodyB.c_position.c,c=this.m_bodyB.c_position.a,_=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,u=ut.neo(r),p=ut.neo(c),d=ut.mulVec2(u,y.sub(this.m_localAnchorA,this.m_localCenterA)),f=ut.mulVec2(p,y.sub(this.m_localAnchorB,this.m_localCenterB)),v=y.zero();if(v.addCombine(1,h,1,f),v.subCombine(1,n,1,d),this.m_ay=ut.mulVec2(u,this.m_localYAxisA),this.m_sAy=y.crossVec2Vec2(y.add(v,d),this.m_ay),this.m_sBy=y.crossVec2Vec2(f,this.m_ay),this.m_mass=e+i+o*this.m_sAy*this.m_sAy+s*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=ut.mulVec2(u,this.m_localXAxisA),this.m_sAx=y.crossVec2Vec2(y.add(v,d),this.m_ax),this.m_sBx=y.crossVec2Vec2(f,this.m_ax);var x=e+i+o*this.m_sAx*this.m_sAx+s*this.m_sBx*this.m_sBx;if(x>0){this.m_springMass=1/x;var A=y.dot(v,this.m_ax),g=2*xs*this.m_frequencyHz,b=2*this.m_springMass*this.m_dampingRatio*g,B=this.m_springMass*g*g,w=t.dt;this.m_gamma=w*(b+w*B),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=A*w*B*this.m_gamma,this.m_springMass=x+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=o+s,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.warmStarting){this.m_impulse*=t.dtRatio,this.m_springImpulse*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var V=y.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),C=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,M=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;a.subMul(this.m_invMassA,V),m-=this.m_invIA*C,_.addMul(this.m_invMassB,V),l+=this.m_invIB*M}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.setVec2(a),this.m_bodyA.c_velocity.w=m,this.m_bodyB.c_velocity.v.setVec2(_),this.m_bodyB.c_velocity.w=l},e.prototype.solveVelocityConstraints=function(t){var e=this.m_invMassA,i=this.m_invMassB,o=this.m_invIA,s=this.m_invIB,n=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,c=y.dot(this.m_ax,a)-y.dot(this.m_ax,n)+this.m_sBx*m-this.m_sAx*r,_=-this.m_springMass*(c+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=_;var l=y.mulNumVec2(_,this.m_ax),u=_*this.m_sAx,p=_*this.m_sBx;n.subMul(e,l),r-=o*u,a.addMul(i,l);c=(m+=s*p)-r-this.m_motorSpeed,_=-this.m_motorMass*c;var d=this.m_motorImpulse,f=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=h(this.m_motorImpulse+_,-f,f),r-=o*(_=this.m_motorImpulse-d),m+=s*_;c=y.dot(this.m_ay,a)-y.dot(this.m_ay,n)+this.m_sBy*m-this.m_sAy*r,_=-this.m_mass*c;this.m_impulse+=_;l=y.mulNumVec2(_,this.m_ay),u=_*this.m_sAy,p=_*this.m_sBy;n.subMul(e,l),r-=o*u,a.addMul(i,l),m+=s*p,this.m_bodyA.c_velocity.v.setVec2(n),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.setVec2(a),this.m_bodyB.c_velocity.w=m},e.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,n=ut.neo(i),r=ut.neo(s),a=ut.mulVec2(n,y.sub(this.m_localAnchorA,this.m_localCenterA)),m=ut.mulVec2(r,y.sub(this.m_localAnchorB,this.m_localCenterB)),h=y.zero();h.addCombine(1,o,1,m),h.subCombine(1,e,1,a);var c=ut.mulVec2(n,this.m_localYAxisA),_=y.crossVec2Vec2(y.add(h,a),c),l=y.crossVec2Vec2(m,c),u=y.dot(h,c),p=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy,d=0!=p?-u/p:0,f=y.mulNumVec2(d,c),v=d*_,x=d*l;return e.subMul(this.m_invMassA,f),i-=this.m_invIA*v,o.addMul(this.m_invMassB,f),s+=this.m_invIB*x,this.m_bodyA.c_position.c.setVec2(e),this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c.setVec2(o),this.m_bodyB.c_position.a=s,vs(u)<=g.linearSlop},e.TYPE="wheel-joint",e}(Et),bs=0;function Bs(t){var e,i=(t=t||{}).rootClass||so,s=t.preSerialize||function(t){return t},n=t.postSerialize||function(t,e){return t},r=t.preDeserialize||function(t){return t},a=t.postDeserialize||function(t,e){return t},m={World:so,Body:Ot,Joint:Et,Fixture:St,Shape:wt},h=o({Vec2:y,Vec3:no},m),c=((e={})[Ot.STATIC]=Ot,e[Ot.DYNAMIC]=Ot,e[Ot.KINEMATIC]=Ot,e[lo.TYPE]=lo,e[Co.TYPE]=Co,e[mo.TYPE]=mo,e[Bo.TYPE]=Bo,e[To.TYPE]=To,e[ko.TYPE]=ko,e[jo.TYPE]=jo,e[is.TYPE]=is,e[ss.TYPE]=ss,e[as.TYPE]=as,e[ts.TYPE]=ts,e[cs.TYPE]=cs,e[Zo.TYPE]=Zo,e[us.TYPE]=us,e[fs.TYPE]=fs,e[gs.TYPE]=gs,e);this.toJson=function(t){var e=[],i=[t],o={};function r(t,s){if(t.__sid=t.__sid||++bs,!o[t.__sid]){i.push(t);var n={refIndex:e.length+i.length,refType:s};o[t.__sid]=n}return o[t.__sid]}function a(t,e){if("object"!=typeof t||null===t)return t;if("function"==typeof t._serialize){if(t!==e)for(var i in m)if(t instanceof m[i])return r(t,i);t=function(t){var e=(t=s(t))._serialize();return n(e,t)}(t)}if(Array.isArray(t)){for(var o=[],h=0;h<t.length;h++)o[h]=a(t[h]);t=o}else{o={};for(var h in t)t.hasOwnProperty(h)&&(o[h]=a(t[h]));t=o}return t}for(;i.length;){var h=i.shift(),c=a(h,h);e.push(c)}return e},this.fromJson=function(t){var e={};function o(t,e,i){var o=function(t,e){return e&&e._deserialize||(e=c[t.type]),e&&e._deserialize}(e,t);if(o){var n=o(e=r(e),i,s);return n=a(n,e)}}function s(i,s,n){if(!s.refIndex)return i&&i._deserialize&&o(i,s,n);i=h[s.refType]||i;var r=s.refIndex;if(!e[r]){var a=o(i,t[r],n);e[r]=a}return e[r]}return i._deserialize(t[0],null,s)}}var ws=new Bs;Bs.toJson=ws.toJson,Bs.fromJson=ws.fromJson;var Vs=function(){function t(){this.width=80,this.height=60,this.x=0,this.y=-10,this.scaleY=-1,this.hz=60,this.speed=1,this.ratio=16,this.background="#222222",this.activeKeys={},this.step=function(t,e){},this.keydown=function(t,e){},this.keyup=function(t,e){},this.statusText="",this.statusMap={}}return t.mount=function(t){throw new Error("Not implemented")},t.prototype.status=function(t,e){if(void 0!==e){var i=t,o=e;"function"!=typeof o&&"object"!=typeof o&&(this.statusMap[i]=o)}else if(t&&"object"==typeof t)for(var s in t){var n=t[s];"function"!=typeof n&&"object"!=typeof n&&(this.statusMap[s]=n)}else"string"==typeof t&&(this.statusText=t);var r=this.statusText||"";for(var a in this.statusMap){var m=this.statusMap[a];"function"!=typeof m&&(r+=(r&&"\n")+a+": "+m)}this._status(r)},t.prototype.info=function(t){this._info(t)},t.prototype.color=function(t,e,i){return"rgb("+(t=256*t|0)+", "+(e=256*e|0)+", "+(i=256*i|0)+")"},t}();function Cs(t,e){var i,o;"function"==typeof t?(i=t,o=e):"function"==typeof e?(i=e,o=t):o=null!=t?t:e;var s=Vs.mount(o);if(!i)return s;var n=i(s)||s.world;s.start(n)}io.addType(To.TYPE,To.TYPE,function(t,e,i,o,s,n,r){Ps(t,i.getShape(),e,n.getShape(),s)});var Ms=q(0,0),Is=q(0,0),Ps=function(e,i,o,s,n){e.pointCount=0,rt(Ms,o,i.m_p),rt(Is,n,s.m_p);var r=et(Is,Ms),a=i.m_radius+s.m_radius;r>a*a||(e.type=t.ManifoldType.e_circles,N(e.localPoint,i.m_p),j(e.localNormal),e.pointCount=1,N(e.points[0].localPoint,s.m_p),e.points[0].id.setFeatures(0,t.ContactFeatureType.e_vertex,0,t.ContactFeatureType.e_vertex))};io.addType(mo.TYPE,To.TYPE,function(t,e,i,o,s,n,r){var a=i.getShape(),m=n.getShape();ks(t,a,e,m,s)}),io.addType(lo.TYPE,To.TYPE,function(t,e,i,o,s,n,r){var a=i.getShape(),m=new mo;a.getChildEdge(m,o);var h=m,c=n.getShape();ks(t,h,e,c,s)});var Ss=q(0,0),Ts=q(0,0),zs=q(0,0),Fs=q(0,0),Ls=q(0,0),qs=q(0,0),ks=function(e,i,o,s,n){e.pointCount=0,mt(Fs,n,o,s.m_p);var r=i.m_vertex1,a=i.m_vertex2;E(Ss,a,r);var m=Q(Ss,a)-Q(Ss,Fs),h=Q(Ss,Fs)-Q(Ss,r),c=i.m_radius+s.m_radius;if(h<=0){if(N(Ls,r),et(Fs,r)>c*c)return;if(i.m_hasVertex0){var _=i.m_vertex0,l=r;if(E(Ts,l,_),Q(Ts,l)-Q(Ts,Fs)>0)return}return e.type=t.ManifoldType.e_circles,j(e.localNormal),N(e.localPoint,Ls),e.pointCount=1,N(e.points[0].localPoint,s.m_p),void e.points[0].id.setFeatures(0,t.ContactFeatureType.e_vertex,0,t.ContactFeatureType.e_vertex)}if(m<=0){if(N(Ls,a),et(Fs,Ls)>c*c)return;if(i.m_hasVertex3){var u=i.m_vertex3,p=a;if(E(zs,u,p),Q(zs,Fs)-Q(zs,p)>0)return}return e.type=t.ManifoldType.e_circles,j(e.localNormal),N(e.localPoint,Ls),e.pointCount=1,N(e.points[0].localPoint,s.m_p),void e.points[0].id.setFeatures(1,t.ContactFeatureType.e_vertex,0,t.ContactFeatureType.e_vertex)}var y=$(Ss);U(Ls,m/y,r,h/y,a),et(Fs,Ls)>c*c||(X(qs,1,Ss),Q(qs,Fs)-Q(qs,r)<0&&D(qs),Z(qs),e.type=t.ManifoldType.e_faceA,N(e.localNormal,qs),N(e.localPoint,r),e.pointCount=1,N(e.points[0].localPoint,s.m_p),e.points[0].id.setFeatures(0,t.ContactFeatureType.e_face,0,t.ContactFeatureType.e_vertex))},Ns=[new li,new li],js=[new li,new li],Ds=[new li,new li],Os=q(0,0),Rs=q(0,0),Es=q(0,0),Js=st(0,0,0),Ys=q(0,0),Ws=q(0,0),Hs=q(0,0),Us=q(0,0),Zs=q(0,0),Ks=q(0,0),Xs=q(0,0),Gs=q(0,0);function Qs(t,e,i,o,s){var n=t.m_count,r=i.m_count,a=t.m_normals,m=t.m_vertices,h=i.m_vertices;ht(Js,o,e);for(var c=0,_=-1/0,l=0;l<n;++l){it(Es,Js.q,a[l]),rt(Rs,Js,m[l]);for(var u=1/0,p=0;p<r;++p){var y=Q(Es,h[p])-Q(Es,Rs);y<u&&(u=y)}u>_&&(_=u,c=l)}s.maxSeparation=_,s.bestIndex=c}io.addType(Bo.TYPE,Bo.TYPE,function(t,e,i,o,s,n,r){tn(t,i.getShape(),e,n.getShape(),s)});var $s={maxSeparation:0,bestIndex:0},tn=function(e,i,o,s,n){e.pointCount=0;var r=i.m_radius+s.m_radius;Qs(i,o,s,n,$s);var a=$s.bestIndex,m=$s.maxSeparation;if(!(m>r)){Qs(s,n,i,o,$s);var h=$s.bestIndex,c=$s.maxSeparation;if(!(c>r)){var _,l,u,p,y,d;c>m+.1*g.linearSlop?(_=s,l=i,u=n,p=o,y=h,e.type=t.ManifoldType.e_faceB,d=!0):(_=i,l=s,u=o,p=n,y=a,e.type=t.ManifoldType.e_faceA,d=!1),Ns[0].recycle(),Ns[1].recycle(),function(e,i,o,s,n,r){var a=i.m_normals,m=n.m_count,h=n.m_vertices,c=n.m_normals;!function(t,e,i,o){var s=e.c*o.x+e.s*o.y,n=-e.s*o.x+e.c*o.y,r=i.c*s-i.s*n,a=i.s*s+i.c*n;t.x=r,t.y=a}(Gs,r.q,o.q,a[s]);for(var _=0,l=1/0,u=0;u<m;++u){var p=Q(Gs,c[u]);p<l&&(l=p,_=u)}var y=_,d=y+1<m?y+1:0;rt(e[0].v,r,h[y]),e[0].id.setFeatures(s,t.ContactFeatureType.e_face,y,t.ContactFeatureType.e_vertex),rt(e[1].v,r,h[d]),e[1].id.setFeatures(s,t.ContactFeatureType.e_face,d,t.ContactFeatureType.e_vertex)}(Ns,_,u,y,l,p);var f=_.m_count,v=_.m_vertices,x=y,A=y+1<f?y+1:0;N(Ys,v[x]),N(Ws,v[A]),E(Hs,Ws,Ys),Z(Hs),K(Us,Hs,1),U(Zs,.5,Ys,.5,Ws),it(Ks,u.q,Hs),K(Xs,Ks,1),rt(Ys,u,Ys),rt(Ws,u,Ws);var b=Q(Xs,Ys),B=-Q(Ks,Ys)+r,w=Q(Ks,Ws)+r;if(js[0].recycle(),js[1].recycle(),Ds[0].recycle(),Ds[1].recycle(),k(Os,-Ks.x,-Ks.y),!(vi(js,Ns,Os,B,x)<2))if(k(Os,Ks.x,Ks.y),!(vi(Ds,js,Os,w,A)<2)){N(e.localNormal,Us),N(e.localPoint,Zs);for(var V=0,C=0;C<Ds.length;++C){if(Q(Xs,Ds[C].v)-b<=r){var M=e.points[V];at(M.localPoint,p,Ds[C].v),M.id.set(Ds[C].id),d&&M.id.swapFeatures(),++V}}e.pointCount=V}}}};io.addType(Bo.TYPE,To.TYPE,function(t,e,i,o,s,n,r){sn(t,i.getShape(),e,n.getShape(),s)});var en=q(0,0),on=q(0,0),sn=function(e,i,o,s,n){e.pointCount=0,mt(en,n,o,s.m_p);for(var a=0,m=-1/0,h=i.m_radius+s.m_radius,c=i.m_count,_=i.m_vertices,l=i.m_normals,u=0;u<c;++u){var p=Q(l[u],en)-Q(l[u],_[u]);if(p>h)return;p>m&&(m=p,a=u)}var y=a,d=y+1<c?y+1:0,f=_[y],v=_[d];if(m<r)return e.pointCount=1,e.type=t.ManifoldType.e_faceA,N(e.localNormal,l[a]),U(e.localPoint,.5,f,.5,v),N(e.points[0].localPoint,s.m_p),void e.points[0].id.setFeatures(0,t.ContactFeatureType.e_vertex,0,t.ContactFeatureType.e_vertex);var x=Q(en,v)-Q(en,f)-Q(f,v)+Q(f,f),A=Q(en,f)-Q(en,v)-Q(v,f)+Q(v,v);if(x<=0){if(et(en,f)>h*h)return;e.pointCount=1,e.type=t.ManifoldType.e_faceA,E(e.localNormal,en,f),Z(e.localNormal),N(e.localPoint,f),N(e.points[0].localPoint,s.m_p),e.points[0].id.setFeatures(0,t.ContactFeatureType.e_vertex,0,t.ContactFeatureType.e_vertex)}else if(A<=0){if(et(en,v)>h*h)return;e.pointCount=1,e.type=t.ManifoldType.e_faceA,E(e.localNormal,en,v),Z(e.localNormal),N(e.localPoint,v),N(e.points[0].localPoint,s.m_p),e.points[0].id.setFeatures(0,t.ContactFeatureType.e_vertex,0,t.ContactFeatureType.e_vertex)}else{if(U(on,.5,f,.5,v),Q(en,l[y])-Q(on,l[y])>h)return;e.pointCount=1,e.type=t.ManifoldType.e_faceA,N(e.localNormal,l[y]),N(e.localPoint,on),N(e.points[0].localPoint,s.m_p),e.points[0].id.setFeatures(0,t.ContactFeatureType.e_vertex,0,t.ContactFeatureType.e_vertex)}},nn=Math.min;io.addType(mo.TYPE,Bo.TYPE,function(t,e,i,o,s,n,r){zn(t,i.getShape(),e,n.getShape(),s)}),io.addType(lo.TYPE,Bo.TYPE,function(t,e,i,o,s,n,r){i.getShape().getChildEdge(mn,o),zn(t,mn,e,n.getShape(),s)});var rn,an,mn=new mo;!function(t){t[t.e_unknown=-1]="e_unknown",t[t.e_edgeA=1]="e_edgeA",t[t.e_edgeB=2]="e_edgeB"}(rn||(rn={})),function(t){t[t.e_isolated=0]="e_isolated",t[t.e_concave=1]="e_concave",t[t.e_convex=2]="e_convex"}(an||(an={}));var hn=function(){},cn=function(){this.vertices=[],this.normals=[],this.count=0;for(var t=0;t<g.maxPolygonVertices;t++)this.vertices.push(q(0,0)),this.normals.push(q(0,0))},_n=function(){function t(){this.v1=q(0,0),this.v2=q(0,0),this.normal=q(0,0),this.sideNormal1=q(0,0),this.sideNormal2=q(0,0)}return t.prototype.recycle=function(){j(this.v1),j(this.v2),j(this.normal),j(this.sideNormal1),j(this.sideNormal2)},t}(),ln=[new li,new li],un=[new li,new li],pn=[new li,new li],yn=new hn,dn=new hn,fn=new cn,vn=new _n,xn=q(0,0),An=q(0,0),gn=q(0,0),bn=q(0,0),Bn=st(0,0,0),wn=q(0,0),Vn=q(0,0),Cn=q(0,0),Mn=q(0,0),In=q(0,0),Pn=q(0,0),Sn=q(0,0),Tn=q(0,0),zn=function(e,i,o,s,n){ht(Bn,o,n),rt(xn,Bn,s.m_centroid);var r=i.m_vertex0,a=i.m_vertex1,m=i.m_vertex2,h=i.m_vertex3,c=i.m_hasVertex0,_=i.m_hasVertex3;E(gn,m,a),Z(gn),k(Cn,gn.y,-gn.x);var l,u=Q(Cn,xn)-Q(Cn,a),p=0,d=0,f=!1,v=!1;j(Vn),j(Mn),c&&(E(An,a,r),Z(An),k(Vn,An.y,-An.x),f=G(An,gn)>=0,p=y.dot(Vn,xn)-y.dot(Vn,r)),_&&(E(bn,h,m),Z(bn),k(Mn,bn.y,-bn.x),v=y.crossVec2Vec2(gn,bn)>0,d=y.dot(Mn,xn)-y.dot(Mn,m)),j(wn),j(In),j(Pn),c&&_?f&&v?(l=p>=0||u>=0||d>=0)?(N(wn,Cn),N(In,Vn),N(Pn,Mn)):(Y(wn,-1,Cn),Y(In,-1,Cn),Y(Pn,-1,Cn)):f?(l=p>=0||u>=0&&d>=0)?(N(wn,Cn),N(In,Vn),N(Pn,Cn)):(Y(wn,-1,Cn),Y(In,-1,Mn),Y(Pn,-1,Cn)):v?(l=d>=0||p>=0&&u>=0)?(N(wn,Cn),N(In,Cn),N(Pn,Mn)):(Y(wn,-1,Cn),Y(In,-1,Cn),Y(Pn,-1,Vn)):(l=p>=0&&u>=0&&d>=0)?(N(wn,Cn),N(In,Cn),N(Pn,Cn)):(Y(wn,-1,Cn),Y(In,-1,Mn),Y(Pn,-1,Vn)):c?f?(l=p>=0||u>=0)?(N(wn,Cn),N(In,Vn),Y(Pn,-1,Cn)):(Y(wn,-1,Cn),N(In,Cn),Y(Pn,-1,Cn)):(l=p>=0&&u>=0)?(N(wn,Cn),N(In,Cn),Y(Pn,-1,Cn)):(Y(wn,-1,Cn),N(In,Cn),Y(Pn,-1,Vn)):_?v?(l=u>=0||d>=0)?(N(wn,Cn),Y(In,-1,Cn),N(Pn,Mn)):(Y(wn,-1,Cn),Y(In,-1,Cn),N(Pn,Cn)):(l=u>=0&&d>=0)?(N(wn,Cn),Y(In,-1,Cn),N(Pn,Cn)):(Y(wn,-1,Cn),Y(In,-1,Mn),N(Pn,Cn)):(l=u>=0)?(N(wn,Cn),Y(In,-1,Cn),Y(Pn,-1,Cn)):(Y(wn,-1,Cn),N(In,Cn),N(Pn,Cn)),fn.count=s.m_count;for(var x=0;x<s.m_count;++x)rt(fn.vertices[x],Bn,s.m_vertices[x]),it(fn.normals[x],Bn.q,s.m_normals[x]);var A=s.m_radius+i.m_radius;e.pointCount=0,yn.type=rn.e_edgeA,yn.index=l?0:1,yn.separation=1/0;for(x=0;x<fn.count;++x){var b=fn.vertices[x];(B=Q(wn,b)-Q(wn,a))<yn.separation&&(yn.separation=B)}if(yn.type!=rn.e_unknown&&!(yn.separation>A)){dn.type=rn.e_unknown,dn.index=-1,dn.separation=-1/0,k(Sn,-wn.y,wn.x);for(x=0;x<fn.count;++x){Y(Tn,-1,fn.normals[x]);var B,w=Q(Tn,fn.vertices[x])-Q(Tn,a),V=Q(Tn,fn.vertices[x])-Q(Tn,m);if((B=nn(w,V))>A){dn.type=rn.e_edgeB,dn.index=x,dn.separation=B;break}if(Q(Tn,Sn)>=0){if(Q(Tn,wn)-Q(Pn,wn)<-g.angularSlop)continue}else if(Q(Tn,wn)-Q(In,wn)<-g.angularSlop)continue;B>dn.separation&&(dn.type=rn.e_edgeB,dn.index=x,dn.separation=B)}if(!(dn.type!=rn.e_unknown&&dn.separation>A)){var C;if(C=dn.type==rn.e_unknown?yn:dn.separation>.98*yn.separation+.001?dn:yn,pn[0].recycle(),pn[1].recycle(),C.type==rn.e_edgeA){e.type=t.ManifoldType.e_faceA;var M=0,I=Q(wn,fn.normals[0]);for(x=1;x<fn.count;++x){var P=Q(wn,fn.normals[x]);P<I&&(I=P,M=x)}var S=M,T=S+1<fn.count?S+1:0;N(pn[0].v,fn.vertices[S]),pn[0].id.setFeatures(0,t.ContactFeatureType.e_face,S,t.ContactFeatureType.e_vertex),N(pn[1].v,fn.vertices[T]),pn[1].id.setFeatures(0,t.ContactFeatureType.e_face,T,t.ContactFeatureType.e_vertex),l?(vn.i1=0,vn.i2=1,N(vn.v1,a),N(vn.v2,m),N(vn.normal,Cn)):(vn.i1=1,vn.i2=0,N(vn.v1,m),N(vn.v2,a),Y(vn.normal,-1,Cn))}else e.type=t.ManifoldType.e_faceB,N(pn[0].v,a),pn[0].id.setFeatures(0,t.ContactFeatureType.e_vertex,C.index,t.ContactFeatureType.e_face),N(pn[1].v,m),pn[1].id.setFeatures(0,t.ContactFeatureType.e_vertex,C.index,t.ContactFeatureType.e_face),vn.i1=C.index,vn.i2=vn.i1+1<fn.count?vn.i1+1:0,N(vn.v1,fn.vertices[vn.i1]),N(vn.v2,fn.vertices[vn.i2]),N(vn.normal,fn.normals[vn.i1]);if(k(vn.sideNormal1,vn.normal.y,-vn.normal.x),k(vn.sideNormal2,-vn.sideNormal1.x,-vn.sideNormal1.y),vn.sideOffset1=Q(vn.sideNormal1,vn.v1),vn.sideOffset2=Q(vn.sideNormal2,vn.v2),ln[0].recycle(),ln[1].recycle(),un[0].recycle(),un[1].recycle(),!(vi(ln,pn,vn.sideNormal1,vn.sideOffset1,vn.i1)<g.maxManifoldPoints))if(!(vi(un,ln,vn.sideNormal2,vn.sideOffset2,vn.i2)<g.maxManifoldPoints)){C.type==rn.e_edgeA?(N(e.localNormal,vn.normal),N(e.localPoint,vn.v1)):(N(e.localNormal,s.m_normals[vn.i1]),N(e.localPoint,s.m_vertices[vn.i1]));var z=0;for(x=0;x<g.maxManifoldPoints;++x){if(Q(vn.normal,un[x].v)-Q(vn.normal,vn.v1)<=A){var F=e.points[z];C.type==rn.e_edgeA?(at(F.localPoint,Bn,un[x].v),F.id.set(un[x].id)):(N(F.localPoint,un[x].v),F.id.set(un[x].id),F.id.swapFeatures()),++z}}e.pointCount=z}}}},Fn={CollidePolygons:tn,Settings:g,Sweep:ft,Manifold:ui,Distance:oe,TimeOfImpact:ke,DynamicTree:M,stats:Jt},Ln=Object.freeze({__proto__:null,Math:c,Serializer:Bs,Testbed:Vs,testbed:Cs,Vec2:y,Vec3:no,Mat22:ii,Mat33:Do,Transform:vt,Rot:ut,AABB:v,Shape:wt,FixtureProxy:Pt,Fixture:St,Body:Ot,ContactEdge:Vi,mixFriction:Ci,mixRestitution:Mi,VelocityConstraintPoint:Pi,Contact:io,JointEdge:Rt,Joint:Et,World:so,CircleShape:To,Circle:zo,EdgeShape:mo,Edge:ho,PolygonShape:Bo,Polygon:Vo,ChainShape:lo,Chain:uo,BoxShape:Co,Box:Mo,CollideCircles:Ps,CollideEdgeCircle:ks,CollidePolygons:tn,CollidePolygonCircle:sn,CollideEdgePolygon:zn,DistanceJoint:ko,FrictionJoint:jo,GearJoint:is,MotorJoint:ss,MouseJoint:as,PrismaticJoint:ts,PulleyJoint:cs,RevoluteJoint:Zo,RopeJoint:us,WeldJoint:fs,WheelJoint:gs,Settings:A,SettingsInternal:g,Sweep:ft,get ManifoldType(){return t.ManifoldType},get ContactFeatureType(){return t.ContactFeatureType},get PointState(){return t.PointState},ClipVertex:li,Manifold:ui,ManifoldPoint:pi,ContactID:yi,WorldManifold:di,getPointStates:fi,clipSegmentToLine:vi,DistanceInput:te,DistanceOutput:ee,SimplexCache:ie,Distance:oe,DistanceProxy:se,testOverlap:ue,ShapeCastInput:ye,ShapeCastOutput:de,ShapeCast:fe,TOIInput:Ae,get TOIOutputState(){return t.TOIOutputState},TOIOutput:ge,TimeOfImpact:ke,TreeNode:V,DynamicTree:M,stats:Jt,internal:Fn});t.AABB=v,t.Body=Ot,t.Box=Mo,t.BoxShape=Co,t.Chain=uo,t.ChainShape=lo,t.Circle=zo,t.CircleShape=To,t.ClipVertex=li,t.CollideCircles=Ps,t.CollideEdgeCircle=ks,t.CollideEdgePolygon=zn,t.CollidePolygonCircle=sn,t.CollidePolygons=tn,t.Contact=io,t.ContactEdge=Vi,t.ContactID=yi,t.Distance=oe,t.DistanceInput=te,t.DistanceJoint=ko,t.DistanceOutput=ee,t.DistanceProxy=se,t.DynamicTree=M,t.Edge=ho,t.EdgeShape=mo,t.Fixture=St,t.FixtureProxy=Pt,t.FrictionJoint=jo,t.GearJoint=is,t.Joint=Et,t.JointEdge=Rt,t.Manifold=ui,t.ManifoldPoint=pi,t.Mat22=ii,t.Mat33=Do,t.Math=c,t.MotorJoint=ss,t.MouseJoint=as,t.Polygon=Vo,t.PolygonShape=Bo,t.PrismaticJoint=ts,t.PulleyJoint=cs,t.RevoluteJoint=Zo,t.RopeJoint=us,t.Rot=ut,t.Serializer=Bs,t.Settings=A,t.SettingsInternal=g,t.Shape=wt,t.ShapeCast=fe,t.ShapeCastInput=ye,t.ShapeCastOutput=de,t.SimplexCache=ie,t.Sweep=ft,t.TOIInput=Ae,t.TOIOutput=ge,t.Testbed=Vs,t.TimeOfImpact=ke,t.Transform=vt,t.TreeNode=V,t.Vec2=y,t.Vec3=no,t.VelocityConstraintPoint=Pi,t.WeldJoint=fs,t.WheelJoint=gs,t.World=so,t.WorldManifold=di,t.clipSegmentToLine=vi,t.default=Ln,t.getPointStates=fi,t.internal=Fn,t.mixFriction=Ci,t.mixRestitution=Mi,t.stats=Jt,t.testOverlap=ue,t.testbed=Cs,Object.defineProperty(t,"__esModule",{value:!0})});p5.prototype.registerMethod("init",function p5playInit(){if(typeof window.planck=="undefined"){throw"planck.js must be loaded before p5play"}const pInst=this;const pl=planck;const plScale=60;if(typeof window._p5play_gtagged=="undefined"&&typeof process=="undefined"){let script=document.createElement("script");script.src="https://www.googletagmanager.com/gtag/js?id=G-EHXNCTSYLK";script.async=true;document.head.append(script);window._p5play_gtagged=true;script.onload=()=>{window.dataLayer??=[];window.gtag=function(){dataLayer.push(arguments)};gtag("js",new Date);gtag("config","G-EHXNCTSYLK");gtag("event","p5play_v3_14")}}this.angleMode("degrees");const scaleTo=(x,y,tileSize)=>new pl.Vec2(x*tileSize/plScale,y*tileSize/plScale);const scaleXTo=(x,tileSize)=>x*tileSize/plScale;const scaleFrom=(x,y,tileSize)=>new pl.Vec2(x/tileSize*plScale,y/tileSize*plScale);const scaleXFrom=(x,tileSize)=>x/tileSize*plScale;const isSlop=val=>Math.abs(val)<=pl.Settings.linearSlop;const fixRound=val=>Math.abs(val-Math.round(val))<=pl.Settings.linearSlop?Math.round(val):val;const eventTypes={_collisions:["_collides","_colliding","_collided"],_overlappers:["_overlaps","_overlapping","_overlapped"]};this.P5Play=class{constructor(){this.sprites={};this.groups={};this.groupsCreated=0;this.spritesCreated=0;this.spritesDrawn=0;this.disableImages=false;this.palettes=[];this.targetVersion=0;this.os={};this.context="web";if(window.matchMedia)this.hasMouse=window.matchMedia("(any-hover: none)").matches?false:true;else this.hasMouse=true;this.standardizeKeyboard=false;this._renderStats={};this._collides={};this._colliding={};this._collided={};this._overlaps={};this._overlapping={};this._overlapped={}}};this.p5play=new this.P5Play;delete this.P5Play;const log=console.log;this.log=console.log;this.Sprite=class{constructor(x,y,w,h,collider){this.p=pInst;this._isSprite=true;this.idNum;let args=[...arguments];let group,ani;if(args[0]!==undefined&&args[0]._isGroup){group=args[0];args=args.slice(1)}if(args[0]!==undefined&&(typeof args[0]=="string"||args[0]instanceof this.p.SpriteAnimation||args[0]instanceof p5.Image)){ani=args[0];args=args.slice(1)}if(args.length==1&&typeof args[0]=="number"){throw new FriendlyError("Sprite",0,[args[0]])}if(!Array.isArray(args[0])){x=args[0];y=args[1];w=args[2];h=args[3];collider=args[4]}else{x=undefined;y=undefined;w=args[0];h=undefined;collider=args[1];if(Array.isArray(collider)){throw new FriendlyError("Sprite",1,[`[[${w}], [${h}]]`])}}if(typeof w=="string"){collider=w;w=undefined}if(typeof h=="string"){if(isColliderType(h)){collider=h}else{w=getRegularPolygon(w,h)}h=undefined}this.idNum=this.p.p5play.spritesCreated;this._uid=1e3+this.idNum;this.p.p5play.sprites[this._uid]=this;this.p.p5play.spritesCreated++;this.groups=[];this.animations=new this.p.SpriteAnimations;this.joints=[];this.joints.removeAll=()=>{for(let j of this.joints){j.remove()}};this.watch;this.mod={};this._removed=false;this._life=2147483647;this._visible=true;this._pixelPerfect=false;this._aniChangeCount=0;this._draw=()=>this.__draw();this._hasOverlap={};this._collisions={};this._overlappers={};group??=this.p.allSprites;this.tileSize=group.tileSize||1;let _this=this;this._position={x:0,y:0};this._pos=pInst.createVector.call(pInst);Object.defineProperty(this._pos,"x",{get(){if(!_this.body)return _this._position.x;let x=_this.body.getPosition().x/_this.tileSize*plScale;return fixRound(x)},set(val){if(_this.body){let pos=new pl.Vec2(val*_this.tileSize/plScale,_this.body.getPosition().y);_this.body.setPosition(pos)}_this._position.x=val}});Object.defineProperty(this._pos,"y",{get(){if(!_this.body)return _this._position.y;let y=_this.body.getPosition().y/_this.tileSize*plScale;return fixRound(y)},set(val){if(_this.body){let pos=new pl.Vec2(_this.body.getPosition().x,val*_this.tileSize/plScale);_this.body.setPosition(pos)}_this._position.y=val}});this._velocity={x:0,y:0};this._vel=pInst.createVector.call(pInst);Object.defineProperties(this._vel,{x:{get(){let val;if(_this.body)val=_this.body.getLinearVelocity().x;else val=_this._velocity.x;return fixRound(val/_this.tileSize)},set(val){val*=_this.tileSize;if(_this.body){_this.body.setLinearVelocity(new pl.Vec2(val,_this.body.getLinearVelocity().y))}else{_this._velocity.x=val}}},y:{get(){let val;if(_this.body)val=_this.body.getLinearVelocity().y;else val=_this._velocity.y;return fixRound(val/_this.tileSize)},set(val){val*=_this.tileSize;if(_this.body){_this.body.setLinearVelocity(new pl.Vec2(_this.body.getLinearVelocity().x,val))}else{_this._velocity.y=val}}}});this._mirror={_x:1,_y:1,get x(){return this._x<0},set x(val){if(_this.watch)_this.mod[22]=true;this._x=val?-1:1},get y(){return this._y<0},set y(val){if(_this.watch)_this.mod[22]=true;this._y=val?-1:1}};this._heading="right";this._layer=group._layer;this._layer??=this.p.allSprites._getTopLayer()+1;if(group.dynamic)collider??="dynamic";if(group.kinematic)collider??="kinematic";if(group.static)collider??="static";collider??=group.collider;if(!collider||typeof collider!="string"){collider="dynamic"}this.collider=collider;x??=group.x;if(x===undefined){x=this.p.width/this.tileSize/2;if(w)this._vertexMode=true}y??=group.y;if(y===undefined){y=this.p.height/this.tileSize/2}let forcedBoxShape=false;if(w===undefined){w=group.w||group.width||group.d||group.diameter||group.v||group.vertices;if(!h&&!group.d&&!group.diameter){h=group.h||group.height;forcedBoxShape=true}}if(typeof x=="function")x=x(group.length);if(typeof y=="function")y=y(group.length);if(typeof w=="function")w=w(group.length);if(typeof h=="function")h=h(group.length);this.x=x;this.y=y;if(!group._isAllSpritesGroup){if(!ani){for(let _ani in group.animations){ani=_ani;break}}}for(let g=group;g;g=this.p.p5play.groups[g.parent]){this.groups.push(g)}this.groups.reverse();if(ani){if(ani instanceof p5.Image){this.addAni(ani)}else{if(typeof ani=="string")this._changeAni(ani);else this._ani=ani.clone()}let ts=this.tileSize;if(!w&&(this._ani.w!=1||this._ani.h!=1)){w=this._ani.w/ts;h??=this._ani.h/ts}}this.groups=[];this.mouse=new this.p._SpriteMouse;this._angle=0;this._rotationSpeed=0;this._bearing=0;this._scale=new Scale;Object.defineProperty(this._scale,"x",{get(){return this._x},set(val){if(val==this._x)return;if(_this.watch)_this.mod[28]=true;let scalarX=Math.abs(val/this._x);_this._w*=scalarX;_this._hw*=scalarX;_this._resizeColliders({x:scalarX,y:1});this._x=val;this._avg=(this._x+this._y)*.5}});Object.defineProperty(this._scale,"y",{get(){return this._y},set(val){if(val==this._y)return;if(_this.watch)_this.mod[28]=true;let scalarY=Math.abs(val/this._y);if(_this._h){this._h*=scalarY;this._hh*=scalarY}_this._resizeColliders({x:1,y:scalarY});this._y=val;this._avg=(this._x+this._y)*.5}});this._offset={_x:0,_y:0,get x(){return this._x},set x(val){if(val==this._x)return;if(_this.watch)_this.mod[23]=true;_this._offsetCenterBy(val-this._x,0)},get y(){return this._y},set y(val){if(val==this._y)return;if(_this.watch)_this.mod[23]=true;_this._offsetCenterBy(0,val-this._y)}};this._massUndef=true;if(w===undefined){this._dimensionsUndef=true;this._widthUndef=true;w=this.tileSize>1?1:50;if(h===undefined)this._heightUndef=true}if(forcedBoxShape)h??=this.tileSize>1?1:50;this._shape=group.shape;if(this.__collider!=3){if(this._vertexMode)this.addCollider(w);else this.addCollider(0,0,w,h);this.shape=this._shape}else{this.w=w;if(Array.isArray(w)){throw new Error('Cannot set the collider type of a sprite with a polygon or chain shape to "none". To achieve the same effect, use .overlaps(allSprites) to have your sprite overlap with the allSprites group.')}if(w!==undefined&&h===undefined)this.shape="circle";else{this.shape="box";this.h=h}}this.prevPos={x:x,y:y};this.prevRotation=0;this._dest={x:x,y:y};this._destIdx=0;this.drag=0;this.debug=false;if(!group._isAllSpritesGroup)this.p.allSprites.push(this);group.push(this);let gvx=group.vel.x||0;let gvy=group.vel.y||0;if(typeof gvx=="function")gvx=gvx(group.length-1);if(typeof gvy=="function")gvy=gvy(group.length-1);this.vel.x=gvx;this.vel.y=gvy;let skipProps=["ani","collider","x","y","w","h","d","diameter","dynamic","height","kinematic","static","vel","width"];for(let prop of this.p.Sprite.propsAll){if(skipProps.includes(prop))continue;let val=group[prop];if(val===undefined)continue;if(typeof val=="function"&&isArrowFunction(val)){val=val(group.length-1)}if(typeof val=="object"){this[prop]=Object.assign({},val)}else{this[prop]=val}}skipProps=["add","animation","animations","autoCull","contains","GroupSprite","Group","idNum","length","mod","mouse","p","parent","Sprite","Subgroup","subgroups","velocity"];for(let i=0;i<this.groups.length;i++){let g=this.groups[i];let props=Object.keys(g);for(let prop of props){if(!isNaN(prop)||prop[0]=="_"||skipProps.includes(prop)||this.p.Sprite.propsAll.includes(prop)){continue}let val=g[prop];if(val===undefined)continue;if(typeof val=="function"&&isArrowFunction(val)){val=val(g.length-1)}if(typeof val=="object"){this[prop]=Object.assign({},val)}else{this[prop]=val}}}this.color??=this.p.color(Math.round(this.p.random(30,245)),Math.round(this.p.random(30,245)),Math.round(this.p.random(30,245)));this._textFill??=this.p.color(0);this._textSize??=this.tileSize==1?this.p.canvas?this.p.textSize():12:.8}addCollider(offsetX,offsetY,w,h){if(this._removed){console.error("Can't add colliders to a sprite that was removed.");return}if(this.__collider==3){this._collider="dynamic";this.__collider=0}let props={};props.shape=this._parseShape(...arguments);if(props.shape.m_type=="chain"){props.density=0;props.restitution=0}props.density??=this.density||5;props.friction??=this.friction||.5;props.restitution??=this.bounciness||.2;if(!this.body){this.body=this.p.world.createBody({position:scaleTo(this.x,this.y,this.tileSize),type:this.collider});this.body.sprite=this}else this.body.m_gravityScale||=1;this.body.createFixture(props);this.resetMass()}addSensor(offsetX,offsetY,w,h){if(this._removed){console.error("Can't add sensors to a sprite that was removed.");return}let s=this._parseShape(...arguments);if(!this.body){this.body=this.p.world.createBody({position:scaleTo(this.x,this.y,this.tileSize),type:"dynamic",gravityScale:0});this.body.sprite=this;this.mass=0;this._massUndef=true;this.rotation=this._angle;this.vel=this._velocity}this.body.createFixture({shape:s,isSensor:true});this._sortFixtures();this._hasSensors=true}_parseShape(offsetX,offsetY,w,h){let args=[...arguments];let path,shape;if(args.length==0){offsetX=0;offsetY=0;w=this._w;h=this._h}else if(args.length<=2){offsetX=0;offsetY=0;w=args[0];h=args[1];this._vertexMode=true}let dimensions;if(Array.isArray(w)||typeof h=="string"){if(!isNaN(w))w=Number(w);if(typeof w!="number"&&Array.isArray(w[0])){this._originMode??="start"}if(typeof h=="string"){path=getRegularPolygon(w,h);h=undefined}else{path=w}}else{if(w!==undefined&&h===undefined){shape="circle"}else{shape="box"}w??=this.tileSize>1?1:50;h??=w;dimensions=scaleTo(w-.08,h-.08,this.tileSize)}let s;if(shape=="box"){s=pl.Box(dimensions.x/2,dimensions.y/2,scaleTo(offsetX,offsetY,this.tileSize),0)}else if(shape=="circle"){s=pl.Circle(scaleTo(offsetX,offsetY,this.tileSize),dimensions.x/2)}else if(path){let vecs=[{x:0,y:0}];let vert={x:0,y:0};let min={x:0,y:0};let max={x:0,y:0};let usesVertices=Array.isArray(path[0]);function checkVert(){if(vert.x<min.x)min.x=vert.x;if(vert.y<min.y)min.y=vert.y;if(vert.x>max.x)max.x=vert.x;if(vert.y>max.y)max.y=vert.y}let x,y;if(usesVertices){if(this._vertexMode){x=path[0][0];y=path[0][1];if(!this.fixture||!this._relativeOrigin){this.x=x;this.y=y}else{x=this.x-this._relativeOrigin.x;y=this.y-this._relativeOrigin.y;vecs.pop()}}for(let i=0;i<path.length;i++){if(this._vertexMode){if(i==0&&!this.fixture)continue;vert.x=path[i][0]-x;vert.y=path[i][1]-y}else{vert.x+=path[i][0];vert.y+=path[i][1]}vecs.push({x:vert.x,y:vert.y});checkVert()}}else{let rep=1;if(path.length%2)rep=path[path.length-1];let mod=rep>0?1:-1;rep=Math.abs(rep);let ang=0;for(let i=0;i<rep;i++){for(let j=0;j<path.length-1;j+=2){let len=path[j];ang+=path[j+1];vert.x+=len*this.p.cos(ang);vert.y+=len*this.p.sin(ang);vecs.push({x:vert.x,y:vert.y});checkVert()}ang*=mod}}let isConvex=false;if(isSlop(Math.abs(vecs[0].x)-Math.abs(vecs[vecs.length-1].x))&&isSlop(Math.abs(vecs[0].y)-Math.abs(vecs[vecs.length-1].y))){if(this._shape!="chain")shape="polygon";else shape="chain";this._originMode="center";if(this._isConvexPoly(vecs.slice(0,-1)))isConvex=true}else{shape="chain"}w=max.x-min.x;this._hw=w*.5;h=max.y-min.y;this._hh=h*.5;if(this._originMode=="start"){for(let i=0;i<vecs.length;i++){vecs[i]=scaleTo(vecs[i].x,vecs[i].y,this.tileSize)}}else{let centerX=0;let centerY=0;let sumX=0;let sumY=0;let vl=vecs.length;if(shape=="polygon"||isConvex)vl--;for(let i=0;i<vl;i++){sumX+=vecs[i].x;sumY+=vecs[i].y}centerX=sumX/vl;centerY=sumY/vl;if(!this.fixture){this._relativeOrigin={x:centerX,y:centerY}}if(this._vertexMode&&usesVertices){if(!this.fixture){this.x+=centerX;this.y+=centerY}else{centerX=this._relativeOrigin.x;centerY=this._relativeOrigin.y}}for(let i=0;i<vecs.length;i++){let vec=vecs[i];vecs[i]=scaleTo(vec.x+offsetX-centerX,vec.y+offsetY-centerY,this.tileSize)}}if(!isConvex||vecs.length-1>pl.Settings.maxPolygonVertices||this._shape=="chain"){shape="chain"}if(shape=="polygon"){s=pl.Polygon(vecs)}else if(shape=="chain"){s=pl.Chain(vecs,false)}}this.shape??=shape;this._w=w;this._hw=w*.5;if(this.__shape!=1){this._h=h;this._hh=h*.5}return s}removeColliders(){if(!this.body)return;this._removeContacts(0);this._removeFixtures(0)}removeSensors(){if(!this.body)return;this._removeContacts(1);this._removeFixtures(1);this._hasSensors=false}_removeFixtures(type){let prevFxt;for(let fxt=this.fixtureList;fxt;fxt=fxt.getNext()){if(type===undefined||fxt.m_isSensor==type){let _fxt=fxt.m_next;fxt.destroyProxies(this.p.world.m_broadPhase);if(!prevFxt){this.body.m_fixtureList=_fxt}else{prevFxt.m_next=_fxt}}else{prevFxt=fxt}}}_removeContacts(type){if(!this.body)return;let ce=this.body.m_contactList;while(ce){let con=ce.contact;ce=ce.next;if(type===undefined||con.m_fixtureA.m_isSensor==type){this.p.world.destroyContact(con)}}}_offsetCenterBy(x,y){if(!x&&!y)return;this._offset._x+=x;this._offset._y+=y;if(!this.body)return;let off=scaleTo(x,y,this.tileSize);for(let fxt=this.body.m_fixtureList;fxt;fxt=fxt.m_next){let shape=fxt.m_shape;if(shape.m_type!="circle"){let vertices=shape.m_vertices;for(let v of vertices){v.x+=off.x;v.y+=off.y}}else{shape.m_p.x+=off.x;shape.m_p.y+=off.y}}}_cloneBodyProps(){let body={};let props=["bounciness","density","drag","friction","heading","isSuperFast","rotation","rotationDrag","rotationLock","rotationSpeed","scale","vel","x","y"];if(!this._massUndef||!this._dimensionsUndef){props.push("mass")}for(let prop of props){if(typeof this[prop]=="object"){body[prop]=Object.assign({},this[prop])}else{body[prop]=this[prop]}}return body}get animation(){return this._ani}set animation(val){this.changeAni(val)}get ani(){return this._ani}set ani(val){this.changeAni(val)}get anis(){return this.animations}get autoDraw(){return this._autoDraw}set autoDraw(val){if(this.watch)this.mod[6]=true;this._autoDraw=val}get allowSleeping(){return this.body?.isSleepingAllowed()}set allowSleeping(val){if(this.watch)this.mod[7]=true;if(this.body)this.body.setSleepingAllowed(val)}get autoUpdate(){return this._autoUpdate}set autoUpdate(val){if(this.watch)this.mod[8]=true;this._autoUpdate=val}get bounciness(){if(!this.fixture)return;return this.fixture.getRestitution()}set bounciness(val){if(this.watch)this.mod[9]=true;for(let fxt=this.fixtureList;fxt;fxt=fxt.getNext()){fxt.setRestitution(val)}}get centerOfMass(){let center=this.body.getWorldCenter();let v=scaleFrom(center.x,center.y,this.tileSize);return this.p.createVector(v.x,v.y)}get collider(){return this._collider}set collider(val){if(val==this._collider)return;val=val.toLowerCase();let c=val[0];if(c=="d")val="dynamic";if(c=="s")val="static";if(c=="k")val="kinematic";if(c=="n")val="none";if(val==this._collider)return;if(val=="none"&&(this._shape=="chain"||this._shape=="polygon")){console.error('Cannot set the collider type of a polygon or chain collider to "none". To achieve the same effect, use .overlaps(allSprites) to have your sprite overlap with the allSprites group.');return}if(this._removed){throw new Error("Cannot change the collider type of a sprite that was removed.")}let oldCollider=this.__collider;this._collider=val;this.__collider=["d","s","k","n"].indexOf(c);if(this.watch)this.mod[10]=true;if(oldCollider===undefined)return;if(this.__collider!=3){if(this.body)this.body.setType(val);if(oldCollider==3)this.addCollider()}else{this.removeColliders();if(this.fixture?.m_isSensor)this.body.m_gravityScale=0;else{this.p.world.destroyBody(this.body);this.body=null}}}_parseColor(val){if(val instanceof p5.Color){return val}else if(typeof val!="object"){if(typeof val=="string"&&val.length==1){return this.p.colorPal(val)}else{return this.p.color(val)}}if(val.levels)return this.p.color(...val.levels);if(val._r!==undefined)return this.p.color(val._r,val._g,val._b,val._a*255);if(val._h!==undefined)return this.p.color(val._h,val._s,val._v,val._a*255);throw new Error("Invalid color")}get color(){return this._color}set color(val){if(this.watch)this.mod[11]=true;this._color=this._parseColor(val)}get colour(){return this._color}set colour(val){this.color=val}get fill(){return this._color}set fill(val){this.color=val}get fillColor(){return this._color}set fillColor(val){this.color=val}get stroke(){return this._stroke}set stroke(val){if(this.watch)this.mod[31]=true;this._stroke=this._parseColor(val)}get strokeColor(){return this._stroke}set strokeColor(val){this.stroke=val}get strokeWeight(){return this._strokeWeight}set strokeWeight(val){if(this.watch)this.mod[32]=true;this._strokeWeight=val}get textColor(){return this._textFill}set textColor(val){if(this.watch)this.mod[34]=true;this._textFill=this._parseColor(val)}get textColour(){return this._textFill}set textColour(val){this.textColor=val}get textFill(){return this._textFill}set textFill(val){this.textColor=val}get textSize(){return this._textSize}set textSize(val){if(this.watch)this.mod[40]=true;this._textSize=val}get textStroke(){return this._textStroke}set textStroke(val){if(this.watch)this.mod[41]=true;this._textStroke=this._parseColor(val)}get textStrokeWeight(){return this._textStrokeWeight}set textStrokeWeight(val){if(this.watch)this.mod[42]=true;this._textStrokeWeight=val}get bearing(){return this._bearing}set bearing(val){if(this.watch)this.mod[39]=true;this._bearing=val}get debug(){return this._debug}set debug(val){if(this.watch)this.mod[12]=true;this._debug=val}get density(){if(!this.fixture)return;return this.fixture.getDensity()}set density(val){if(this.watch)this.mod[13]=true;for(let fxt=this.fixtureList;fxt;fxt=fxt.getNext()){fxt.setDensity(val)}}_getDirectionAngle(name){name=name.toLowerCase().replaceAll(/[ _-]/g,"");let dirs={up:-90,down:90,left:180,right:0,upright:-45,rightup:-45,upleft:-135,leftup:-135,downright:45,rightdown:45,downleft:135,leftdown:135,forward:this.rotation,backward:this.rotation+180};let val=dirs[name];if(this.p._angleMode=="radians"){val=this.p.radians(val)}return val}get direction(){if(this.vel.x!==0||this.vel.y!==0){return this.p.atan2(this.vel.y,this.vel.x)}if(this._direction===undefined)return this.rotation;return this._direction}set direction(val){if(this.watch)this.mod[14]=true;if(typeof val=="string"){this._heading=val;val=this._getDirectionAngle(val)}this._direction=val;let speed=this.speed;this.vel.x=this.p.cos(val)*speed;this.vel.y=this.p.sin(val)*speed}get drag(){return this.body?.getLinearDamping()}set drag(val){if(this.watch)this.mod[15]=true;if(this.body)this.body.setLinearDamping(val)}get draw(){return this._display}set draw(val){this._draw=val}get dynamic(){return this.body?.isDynamic()}set dynamic(val){if(val)this.collider="dynamic";else this.collider="kinematic"}get fixture(){return this.fixtureList}get fixtureList(){if(!this.body)return null;return this.body.m_fixtureList}get friction(){if(!this.fixture)return;return this.fixture.getFriction()}set friction(val){if(this.watch)this.mod[16]=true;for(let fxt=this.fixtureList;fxt;fxt=fxt.getNext()){fxt.setFriction(val)}}get heading(){return this._heading}set heading(val){this.direction=val}get img(){return this._ani?.frameImage}set img(val){this.changeAni(val)}get image(){return this._ani?.frameImage}set image(val){this.changeAni(val)}get isMoving(){return this.vel.x!=0||this.vel.y!=0}get isSuperFast(){return this.body?.isBullet()}set isSuperFast(val){if(this.watch)this.mod[18]=true;if(this.body)this.body.setBullet(val)}get kinematic(){return this.body?.isKinematic()}set kinematic(val){if(val)this.collider="kinematic";else this.collider="dynamic"}get layer(){return this._layer}set layer(val){if(this.watch)this.mod[19]=true;this._layer=val}get life(){return this._life}set life(val){if(this.watch)this.mod[20]=true;this._life=val}get mass(){return this.body?.getMass()}set mass(val){if(!this.body)return;if(this.watch)this.mod[21]=true;let t=this.massData;t.mass=val>0?val:1e-8;this.body.setMassData(t);delete this._massUndef}get massData(){const t={I:0,center:new pl.Vec2(0,0),mass:0};this.body.getMassData(t);t.center=scaleFrom(t.center.x,t.center.y,this.tileSize);return t}resetMass(){if(!this.body)return;if(this.watch)this.mod[21]=true;this.body.resetMassData()}get mirror(){return this._mirror}set mirror(val){if(this.watch)this.mod[22]=true;if(val.x!==undefined)this._mirror.x=val.x;if(val.y!==undefined)this._mirror.y=val.y}get offset(){return this._offset}set offset(val){val.x??=this._offset._x;val.y??=this._offset._y;if(val.x==this._offset._x&&val.y==this._offset._y)return;if(this.watch)this.mod[23]=true;this._offsetCenterBy(val.x-this._offset._x,val.y-this._offset._y)}get previousPosition(){return this.prevPos}set previousPosition(val){this.prevPos=val}get previousRotation(){return this.prevRotation}set previousRotation(val){this.prevRotation=val}get pixelPerfect(){return this._pixelPerfect}set pixelPerfect(val){if(this.watch)this.mod[24]=true;this._pixelPerfect=val}get rotation(){if(!this.body)return this._angle||0;let val=this.body.getAngle();if(this.p._angleMode==="degrees")return this.p.degrees(val);return val}set rotation(val){if(this.body){if(this.p._angleMode==="degrees")val=this.p.radians(val);this.body.setAngle(val);this.body.synchronizeTransform()}else{this._angle=val}}get rotationDrag(){return this.body?.getAngularDamping()}set rotationDrag(val){if(!this.body)return;if(this.watch)this.mod[26]=true;this.body.setAngularDamping(val)}get rotationLock(){return this.body?.isFixedRotation()}set rotationLock(val){if(!this.body)return;if(this.watch)this.mod[27]=true;let mass=this.mass;this.body.setFixedRotation(val);this.mass=mass}get rotationSpeed(){if(this.body)return this.body.getAngularVelocity();return this._rotationSpeed}set rotationSpeed(val){if(this.body)this.body.setAngularVelocity(val);else this._rotationSpeed=val}get scale(){return this._scale}set scale(val){if(val==0)val=.01;if(typeof val==="number"){val={x:val,y:val}}else{val.x??=this._scale._x;val.y??=this._scale._y}if(val.x==this._scale._x&&val.y==this._scale._y)return;if(this.watch)this.mod[28]=true;let scalars={x:Math.abs(val.x/this._scale._x),y:Math.abs(val.y/this._scale._y)};this._w*=scalars.x;this._hw*=scalars.x;if(this._h){this._h*=scalars.y;this._hh*=scalars.y}this._resizeColliders(scalars);this._scale._x=val.x;this._scale._y=val.y;this._scale._avg=val.x}get sleeping(){if(this.body)return!this.body.isAwake();return undefined}set sleeping(val){if(!this.body)return;if(this.watch)this.mod[30]=true;this.body.setAwake(!val)}get speed(){return this.p.createVector(this.vel.x,this.vel.y).mag()}set speed(val){let angle=this.direction;this.vel.x=this.p.cos(angle)*val;this.vel.y=this.p.sin(angle)*val}get static(){return this.body?.isStatic()}set static(val){if(val)this.collider="static";else this.collider="dynamic"}get removed(){return this._removed}set removed(val){if(!val||this._removed)return;if(this.watch)this.mod[25]=true;this._removed=true;this._remove()}set vertices(val){if(this.__collider==3){throw new Error('Cannot set vertices of a sprite with collider type of "none".')}if(this.watch)this.mod[29]=true;this._removeFixtures();this._originMode="start";this.addCollider(val);if(this._hasSensors){this.addDefaultSensors()}}get vertices(){return this._getVertices()}_getVertices(internalUse){let f=this.fixture;let s=f.getShape();let v=[...s.m_vertices];if(s.m_type=="polygon")v.unshift(v.at(-1));let x=this.x;let y=this.y;for(let i=0;i<v.length;i++){let arr=[fixRound(v[i].x/this.tileSize*plScale+x),fixRound(v[i].y/this.tileSize*plScale+y)];if(internalUse)v[i]=arr;else v[i]=this.p.createVector(arr[0],arr[1])}return v}get visible(){return this._visible}set visible(val){if(this.watch)this.mod[37]=true;this._visible=val}get x(){return this._pos.x}set x(val){this._pos.x=val}get y(){return this._pos.y}set y(val){this._pos.y=val}get pos(){return this._pos}set pos(val){if(this.body){let pos=new pl.Vec2(val.x*this.tileSize/plScale,val.y*this.tileSize/plScale);this.body.setPosition(pos)}this._position.x=val.x;this._position.y=val.y}get position(){return this._pos}set position(val){this.pos=val}get w(){return this._w}set w(val){if(val<0)val=.01;if(val==this._w)return;if(this.watch)this.mod[38]=true;let scalarX=val/this._w;this._w=val;this._hw=val*.5;this._resizeColliders({x:scalarX,y:1});delete this._widthUndef;delete this._dimensionsUndef}get hw(){return this._hw}set hw(val){throw new FriendlyError("Sprite.hw")}get width(){return this._w}set width(val){this.w=val}get halfWidth(){return this.hw}set halfWidth(val){throw new FriendlyError("Sprite.hw")}get h(){return this._h||this._w}set h(val){if(val<0)val=.01;if(this.__shape==1){this.w=val;return}if(val==this._h)return;if(this.watch)this.mod[17]=true;let scalarY=val/this._h;this._h=val;this._hh=val*.5;this._resizeColliders({x:1,y:scalarY});delete this._heightUndef;delete this._dimensionsUndef}get hh(){return this._hh||this._hw}set hh(val){throw new FriendlyError("Sprite.hh")}get height(){return this.h}set height(val){this.h=val}get halfHeight(){return this.hh}set halfHeight(val){throw new FriendlyError("Sprite.hh")}get d(){return this._w}set d(val){if(val<0)val=.01;let shapeChange=this.__shape!=1;if(!shapeChange&&this._w==val)return;if(this.watch)this.mod[38]=true;if(!shapeChange){let scalar=val/this._w;this._resizeColliders({x:scalar,y:scalar})}this._w=val;this._hw=val*.5;if(shapeChange)this.shape="circle"}get diameter(){return this._w}set diameter(val){this.d=val}get r(){return this._hw}set r(val){this.d=val*2}get radius(){return this._hw}set radius(val){this.d=val*2}_resizeColliders(scalars){if(!this.body)return;for(let fxt=this.fixtureList;fxt;fxt=fxt.getNext()){if(fxt.m_isSensor)continue;let sh=fxt.m_shape;if(sh.m_type=="circle"){if(scalars.x!=1)sh.m_radius*=scalars.x;else sh.m_radius*=scalars.y}else{for(let vert of sh.m_vertices){vert.x*=scalars.x;vert.y*=scalars.y}}}if(this._widthUndef||this._heightUndef)this.resetMass();this.body.synchronizeFixtures()}_isConvexPoly(vecs){loopk:for(let k=0;k<2;k++){if(k==1)vecs=vecs.reverse();for(let i=0;i<vecs.length;++i){const i1=i;const i2=i<vecs.length-1?i1+1:0;const p=vecs[i1];const e=pl.Vec2.sub(vecs[i2],p);for(let j=0;j<vecs.length;++j){if(j==i1||j==i2){continue}const v=pl.Vec2.sub(vecs[j],p);const c=pl.Vec2.cross(e,v);if(c<0){if(k==0)continue loopk;else return false}}}break}return true}get shape(){return this._shape}set shape(val){if(val==this._shape)return;let __shape=this.p.Sprite.shapeTypes.indexOf(val);if(__shape==-1){throw new Error('Invalid shape type: "'+val+'"\nThe valid shape types are: "'+this.p.Sprite.shapeTypes.join('", "')+'"')}if(this.__collider==3&&__shape>=2){console.error('Cannot set the collider shape to chain or polygon if the sprite has a collider type of "none". To achieve the same effect, use .overlaps(allSprites) to have your sprite overlap with the allSprites group.');return}if(this.__shape==1&&__shape!=0){console.error("Cannot change a circle collider into a chain or polygon shape.");return}let prevShape=this.__shape;this.__shape=__shape;this._shape=val;if(this.watch)this.mod[29]=true;if(prevShape===undefined)return;if(this.__shape==0){this._h=this._w;this._hh=this._hw}else{this._h=undefined;this._hh=undefined}let v,w;if(prevShape!=1&&this.__shape!=1){v=this._getVertices(true)}else{w=this._w}this._removeFixtures();if(this.__collider!=3){if(v){this._originMode??="center";this.addCollider(v)}else{this.addCollider()}}if(this._hasSensors){this.addDefaultSensors()}let ox=this._offset._x;let oy=this._offset._y;if(!ox&&!oy)return;this._offset._x=0;this._offset._y=0;this._offsetCenterBy(ox,oy)}get update(){return this._update}set update(val){this._customUpdate=val}get vel(){return this._vel}set vel(val){this.vel.x=val.x;this.vel.y=val.y}set velocity(val){this.vel=val}get velocity(){return this._vel}_update(){if(this._ani?.update)this._ani.update();for(let prop in this.mouse){if(this.mouse[prop]==-1)this.mouse[prop]=0}if(this._customUpdate)this._customUpdate();if(this.autoUpdate)this.autoUpdate=null}_step(){if(!this.body&&!this._removed){this.rotation+=this._rotationSpeed;this.x+=this.vel.x;this.y+=this.vel.y}if(this.watch){if(this.x!=this.prevX)this.mod[0]=this.mod[2]=true;if(this.y!=this.prevY)this.mod[1]=this.mod[2]=true;if(this.rotation!=this.prevRotation){this.mod[3]=this.mod[4]=true}}if(!this.body&&!this._removed)return;this.__step()}__draw(){if(this._strokeWeight!==undefined){this.p.strokeWeight(this._strokeWeight)}if(this._ani&&this.debug!="colliders"&&!this.p.p5play.disableImages){this._ani.draw(this._offset._x,this._offset._y,0,this._scale._x,this._scale._y)}if(!this._ani||this.debug||this.p.p5play.disableImages){if(this.debug&&this.debug!="colliders"){this.p.noFill();if(this.__collider!=3)this.p.stroke(0,255,0);else this.p.stroke(120);this.p.line(0,-2,0,2);this.p.line(-2,0,2,0)}if(this.__collider!=3){if(!this.debug&&this._strokeWeight!==0){if(this.__shape==2)this.p.stroke(this.stroke||this.color);else if(this._stroke)this.p.stroke(this._stroke)}for(let fxt=this.fixtureList;fxt;fxt=fxt.getNext()){if(fxt.m_isSensor&&!this.debug)continue;this._drawFixture(fxt)}}else{if(this._strokeWeight!==0)this.p.stroke(this._stroke||120);if(this.__shape==0){this.p.rect(this._offset._x,this._offset._y,this.w*this.tileSize,this.h*this.tileSize)}else if(this.__shape==1){this.p.circle(this._offset._x,this._offset._y,this.d*this.tileSize)}}}if(this.text!==undefined){this.p.textAlign(this.p.CENTER,this.p.CENTER);this.p.fill(this._textFill);if(this._textStrokeWeight)this.p.strokeWeight(this._textStrokeWeight);if(this._textStroke)this.p.stroke(this._textStroke);else this.p.noStroke();this.p.textSize(this.textSize*this.tileSize);this.p.text(this.text,0,0)}}_display(){let x=this.x*this.tileSize+this.p.world.origin.x;let y=this.y*this.tileSize+this.p.world.origin.y;let largestSide=Math.max(this._w,this._h);if(this.shape!="chain"&&this.p.camera.active&&(x+largestSide<this.p.camera.bound.min.x||x-largestSide>this.p.camera.bound.max.x||y+largestSide<this.p.camera.bound.min.y||y-largestSide>this.p.camera.bound.max.y)){this._visible=null;return}this._visible=true;this.p.p5play.spritesDrawn++;if(!this._pixelPerfect){x=fixRound(x);y=fixRound(y)}else{let w,h;if(this.ani&&!this.p.p5play.disableImages){w=this.ani[this.ani._frame].w;h=this.ani[this.ani._frame].h}else{w=this._w;h=this._h}if(w%2==0)x=Math.round(x);else x=Math.round(x-.5)+.5;if(h%2==0)y=Math.round(y);else y=Math.round(y-.5)+.5}for(let j of this.joints){if(!j.visible){j.visible??=true;continue}if(this._uid==j.spriteA._uid){if(!j.spriteB._visible||this.layer<=j.spriteB.layer){j._display()}}else if(!j.spriteA._visible||this.layer<j.spriteA.layer){j._display()}}this.p.push();this.p.imageMode("center");this.p.rectMode("center");this.p.ellipseMode("center");this.p.translate(x,y);if(this.rotation)this.p.rotate(this.rotation);this.p.scale(this._mirror._x,this._mirror._y);this.p.fill(this.color);this._draw();this.p.pop();this._cameraActiveWhenDrawn=this.p.camera.active;if(this.autoDraw)this.autoDraw=null}_drawFixture(fxt){const sh=fxt.m_shape;if(sh.m_type=="polygon"||sh.m_type=="chain"){if(sh.m_type=="chain"){this.p.push();this.p.noFill()}let v=sh.m_vertices;this.p.beginShape();for(let i=0;i<v.length;i++){this.p.vertex(v[i].x*plScale,v[i].y*plScale)}if(sh.m_type!="chain")this.p.endShape("close");else{this.p.endShape();this.p.pop()}}else if(sh.m_type=="circle"){const d=sh.m_radius*2*plScale;this.p.ellipse(sh.m_p.x*plScale,sh.m_p.y*plScale,d,d)}else if(sh.m_type=="edge"){this.p.line(sh.m_vertex1.x*plScale,sh.m_vertex1.y*plScale,sh.m_vertex2.x*plScale,sh.m_vertex2.y*plScale)}}_args2Vec(x,y){if(Array.isArray(x)){return{x:x[0],y:x[1]}}else if(typeof x=="object"){y=x.y;x=x.x}return{x:x||0,y:y||0}}_parseForceArgs(){let args=arguments;if(typeof args[0]=="number"&&(args.length==1||typeof args[1]!="number")){args[3]=args[2];args[2]=args[1];args[1]=this.p.sin(this._bearing)*args[0];args[0]=this.p.cos(this._bearing)*args[0]}else if(args.length==2&&typeof args[1]!="number"){args[2]=args[1];args[1]=undefined}let o={};o.forceVector=new pl.Vec2(this._args2Vec(args[0],args[1]));if(args[2]!==undefined){o.poa=this._args2Vec(args[2],args[3]);o.poa=scaleTo(o.poa.x,o.poa.y,this.tileSize)}return o}applyForce(x,y,originX,originY){if(!this.body)return;if(location.host=="game.thegamebox.ca"){return this.applyForceScaled(...arguments)}let{forceVector,poa}=this._parseForceArgs(...arguments);if(!poa)this.body.applyForceToCenter(forceVector);else this.body.applyForce(forceVector,poa)}applyForceScaled(){if(!this.body)return;let{forceVector,poa}=this._parseForceArgs(...arguments);forceVector.mul(this.mass);if(!poa)this.body.applyForceToCenter(forceVector);else this.body.applyForce(forceVector,poa)}attractTo(x,y,force,radius,easing){if(!this.body)return;if(typeof x!="number"){let obj=x;if(!obj||obj==this.p.mouse&&!this.p.mouse.active)return;force=y;y=obj.y;x=obj.x}if(this.x==x&&this.y==y)return;let a=y-this.y;let b=x-this.x;let c=Math.sqrt(a*a+b*b);let percent=force/c;let forceVector=new pl.Vec2(b*percent,a*percent);this.body.applyForceToCenter(forceVector)}repelFrom(x,y,force,radius,easing){if(!this.body)return;if(typeof x!="number"){let obj=x;if(!obj||obj==this.p.mouse&&!this.p.mouse.active)return;force=y;y=obj.y;x=obj.x}this.attractTo(x,y,-force,radius,easing)}applyTorque(val){if(!this.body)return;this.body.applyTorque(val)}moveTowards(x,y,tracking){if(x===undefined)return;if(typeof x!="number"&&x!==null){let obj=x;if(obj==this.p.mouse&&!this.p.mouse.active)return;if(!obj||obj.x===undefined||obj.y===undefined){throw"sprite.moveTowards/moveAway ERROR: movement destination not defined."}tracking=y;y=obj.y;x=obj.x}tracking??=.1;if(x!==undefined&&x!==null){let diffX=x-this.x;if(!isSlop(diffX)){this.vel.x=diffX*tracking*this.tileSize}else this.vel.x=0}if(y!==undefined&&y!==null){let diffY=y-this.y;if(!isSlop(diffY)){this.vel.y=diffY*tracking*this.tileSize}else this.vel.y=0}}moveAway(x,y,repel){this.moveTowards(...arguments);this.vel.x*=-1;this.vel.y*=-1}move(distance,direction,speed){if(!distance)return;let directionNamed=isNaN(arguments[0]);if(directionNamed){distance=1;direction=arguments[0];speed=arguments[1]}if(typeof direction=="string"){directionNamed=true;this._heading=direction;direction=this._getDirectionAngle(direction)}direction??=this.direction;let x=null;let y=null;if(direction!=90&&direction!=270){x=this.x+this.p.cos(direction)*distance}if(direction!=0&&direction!=180){y=this.y+this.p.sin(direction)*distance}if(directionNamed&&this.tileSize!=1){if(x)x=Math.round(x*2)/2;if(y)y=Math.round(y*2)/2}else if(direction%45==0){if(x)x=fixRound(x);if(y)y=fixRound(y)}return this.moveTo(x,y,speed)}moveTo(x,y,speed){if(typeof x!="number"&&x){let obj=x;if(obj==this.p.mouse&&!this.p.mouse.active)return;if(!obj||obj.x===undefined||obj.y===undefined){throw"sprite.moveTo ERROR: destination not defined."}speed=y;y=obj.y;x=obj.x}this._dest.x=this.x;this._dest.y=this.y;if(x==this.x)x=false;else if(x||x===0){this._dest.x=x;x=true}if(y==this.y)y=false;else if(y||y===0){this._dest.y=y;y=true}this._destIdx++;if(!x&&!y)return Promise.resolve(true);if(this.speed)speed??=this.speed;if(this.tileSize>1)speed??=.1;speed??=1;if(speed<=0){console.warn("sprite.move: speed should be a positive number");return Promise.resolve(false)}let a=this._dest.y-this.y;let b=this._dest.x-this.x;let c=Math.sqrt(a*a+b*b);let percent=speed/c;if(x)this.vel.x=b*percent;if(y)this.vel.y=a*percent;let destD=this.direction;let destDMin=destD-.1;let destDMax=destD+.1;let velThresh=this.p.world.velocityThreshold;let margin=speed+velThresh;velThresh=Math.max(velThresh,margin*.25);let checkDir=x&&y;let destIdx=this._destIdx;return(async()=>{let distX=margin+margin;let distY=margin+margin;do{if(destIdx!=this._destIdx)return false;await pInst.delay();if(checkDir&&(this.direction<=destDMin||this.direction>=destDMax)||Math.abs(this.vel.x)<=velThresh&&Math.abs(this.vel.y)<=velThresh){return false}distX=Math.abs(this.x-this._dest.x);distY=Math.abs(this.y-this._dest.y)}while(x&&distX>margin||y&&distY>margin);if(distX<margin)this.x=this._dest.x;if(distY<margin)this.y=this._dest.y;this.vel.x=0;this.vel.y=0;return true})()}rotateTowards(angle,tracking){if(this.__collider==1)throw new FriendlyError(0);let args=arguments;let x,y,facing;if(typeof args[0]!="number"){x=args[0].x;y=args[0].y;tracking=args[1];facing=args[2]}else if(arguments.length>2){x=args[0];y=args[1];tracking=args[2];facing=args[3]}if(x!==undefined)angle=this.angleToFace(x,y,facing);else{angle-=this.rotation}tracking??=.1;this.rotationSpeed=angle*tracking}angleTo(x,y){if(typeof x=="object"){let obj=x;if(obj==this.p.mouse&&!this.p.mouse.active)return 0;if(obj.x===undefined||obj.y===undefined){console.error("sprite.angleTo ERROR: rotation destination not defined, object given with no x or y properties");return 0}y=obj.y;x=obj.x}return this.p.atan2(y-this.y,x-this.x)}angleToFace(x,y,facing){if(typeof x=="object"){facing=y;y=x.y;x=x.x}if(Math.abs(x-this.x)<.01&&Math.abs(y-this.y)<.01){return 0}let ang=this.angleTo(x,y);facing??=0;ang+=facing;let dist1=ang-this.rotation%360;let dist2=360-Math.abs(dist1);dist2*=dist1<0?1:-1;return Math.abs(dist1)<Math.abs(dist2)?dist1:dist2}rotateTo(angle,speed){if(this.__collider==1)throw new FriendlyError(0);let args=arguments;let x,y,facing;if(typeof args[0]!="number"){x=args[0].x;y=args[0].y;speed=args[1];facing=args[2]}else if(arguments.length>2){x=args[0];y=args[1];speed=args[2];facing=args[3]}if(x!==undefined)angle=this.angleToFace(x,y,facing);else{if(angle==this.rotation)return;angle-=this.rotation}return this.rotate(angle,speed)}rotate(angle,speed){if(this.__collider==1)throw new FriendlyError(0);if(isNaN(angle))throw new FriendlyError(1,[angle]);if(angle==0)return;let absA=Math.abs(angle);speed??=1;if(speed>absA)speed=absA;let ang=this.rotation+angle;let cw=angle>0;this.rotationSpeed=speed*(cw?1:-1);let frames=Math.floor(absA/speed)-1;this._rotateIdx??=0;this._rotateIdx++;let _rotateIdx=this._rotateIdx;return(async()=>{if(frames>1){let limit=Math.abs(this.rotationSpeed)+.01;do{if(this._rotateIdx!=_rotateIdx)return false;await pInst.delay();if(cw&&this.rotationSpeed<.01||!cw&&this.rotationSpeed>-.01){return false}}while((cw&&ang>this.rotation||!cw&&ang<this.rotation)&&limit<Math.abs(ang-this.rotation));if(Math.abs(ang-this.rotation)>.01){this.rotationSpeed=ang-this.rotation;await pInst.delay()}}else{await pInst.delay()}if(this._rotateIdx!=_rotateIdx)return false;this.rotationSpeed=0;this.rotation=ang;return true})()}async changeAni(anis){if(this.p.p5play.disableImages)return;if(arguments.length>1)anis=[...arguments];else if(anis instanceof this.p.SpriteAnimation){if(anis==this._ani)return;anis=[anis]}else if(!Array.isArray(anis)){if(anis==this._ani?.name)return;anis=[anis]}this._aniChangeCount++;let loop,stopOnLastAni;for(let i=0;i<anis.length;i++){let ani=anis[i];if(ani instanceof this.p.SpriteAnimation||ani instanceof p5.Image||typeof ani=="string"&&ani.length!=1&&ani.includes(".")){ani=this.addAni(ani);anis[i]=ani}if(typeof ani=="string"){ani={name:ani};anis[i]=ani}if(ani.name.length>1){if(ani.name[0]=="!"){ani.name=ani.name.slice(1);ani.start=-1;ani.end=0}if(ani.name[0]=="<"||ani.name[0]==">"){ani.name=ani.name.slice(1);ani.flipX=true}if(ani.name[0]=="^"){ani.name=ani.name.slice(1);ani.flipY=true}if(ani.name=="**"){loop=true;anis=anis.slice(0,-1)}if(ani.name==";;"){stopOnLastAni=true;anis=anis.slice(0,-1)}}}let count=this._aniChangeCount;do{for(let i=0;i<anis.length;i++){let ani=anis[i];if(!ani.start&&anis.length>1)ani.start=0;await this._playSequencedAni(ani)}}while(loop&&count==this._aniChangeCount);if(anis.length!=1&&stopOnLastAni)this._ani.stop()}_playSequencedAni(ani){return new Promise(resolve=>{let{name,start,end,flipX,flipY}=ani;this._changeAni(name);if(flipX)this._ani.scale.x=-this._ani.scale.x;if(flipY)this._ani.scale.y=-this._ani.scale.y;if(start<0)start=this._ani.length+start;if(start!==undefined)this._ani._frame=start;if(end!==undefined)this._ani.goToFrame(end);else if(this._ani._frame==this._ani.lastFrame)resolve();this._ani._onComplete=this._ani._onChange=()=>{if(flipX)this._ani.scale.x=-this._ani.scale.x;if(flipY)this._ani.scale.y=-this._ani.scale.y;this._ani._onComplete=this._ani._onChange=null;resolve()}})}changeAnimation(){return this.changeAni(...arguments)}_changeAni(label){if(this._ani?._onChange)this._ani._onChange();if(this._ani?.onChange)this._ani.onChange();let ani=this.animations[label];if(!ani){for(let i=this.groups.length-1;i>=0;i--){let g=this.groups[i];ani=g.animations[label];if(ani){ani=ani.clone();break}}}if(!ani){this.p.noLoop();throw new FriendlyError("Sprite.changeAnimation",[label])}this._ani=ani;this._ani.name=label;if(this.resetAnimationsOnChange)this._ani._frame=0}remove(){this.removed=true}_remove(){if(this.body)this.p.world.destroyBody(this.body);this.body=null;for(let g of this.groups){g.remove(this)}}toString(){return"s"+this.idNum}_setContactCB(target,cb,contactType,eventType){let type;if(contactType==0)type=eventTypes._collisions[eventType];else type=eventTypes._overlappers[eventType];let ledger=this.p.p5play[type];let l=ledger[this._uid]??={};if(l[target._uid]==cb)return;l[target._uid]=cb;l=ledger[target._uid];if(!l||!l[this._uid])return;delete l[this._uid];if(Object.keys(l).length==0){delete ledger[target._uid]}}_validateCollideParams(target,cb){if(!target){throw new FriendlyError("Sprite.collide",2)}if(!target._isSprite&&!target._isGroup){throw new FriendlyError("Sprite.collide",0,[target])}if(cb&&typeof cb!="function"){throw new FriendlyError("Sprite.collide",1,[cb])}}_ensureCollide(target,cb,type){if(this._hasOverlap[target._uid]!==false){this._hasOverlap[target._uid]=false}if(target._hasOverlap[this._uid]!==false){target._hasOverlap[this._uid]=false;if(target._isGroup){for(let s of target){s._hasOverlap[this._uid]=false;this._hasOverlap[s._uid]=false}}}}collide(target,callback){return this.collides(target,callback)}collides(target,callback){this._validateCollideParams(target,callback);this._ensureCollide(target);if(callback)this._setContactCB(target,callback,0,0);return this._collisions[target._uid]==1||this._collisions[target._uid]<=-3}colliding(target,callback){this._validateCollideParams(target,callback);this._ensureCollide(target);if(callback)this._setContactCB(target,callback,0,1);let val=this._collisions[target._uid];if(val<=-3)return 1;return val>0?val:0}collided(target,callback){this._validateCollideParams(target,callback);this._ensureCollide(target);if(callback)this._setContactCB(target,callback,0,2);return this._collisions[target._uid]<=-1}_validateOverlapParams(target,cb){if(!target){throw new FriendlyError("Sprite.overlap",2)}if(!target._isSprite&&!target._isGroup){throw new FriendlyError("Sprite.overlap",0,[target])}if(cb&&typeof cb!="function"){throw new FriendlyError("Sprite.overlap",1,[cb])}}_ensureOverlap(target){if(!this._hasSensors)this.addDefaultSensors();if(!target._hasSensors){if(target._isSprite){target.addDefaultSensors()}else{for(let s of target){if(!s._hasSensors)s.addDefaultSensors()}target._hasSensors=true}}if(!this._hasOverlap[target._uid]){this._removeContactsWith(target);this._hasOverlap[target._uid]=true}if(!target._hasOverlap[this._uid]){target._removeContactsWith(this);target._hasOverlap[this._uid]=true;if(target._isGroup){for(let s of target){s._hasOverlap[this._uid]=true;this._hasOverlap[s._uid]=true}}}}overlap(target,callback){return this.overlaps(target,callback)}overlaps(target,callback){this._validateOverlapParams(target,callback);this._ensureOverlap(target);if(callback)this._setContactCB(target,callback,1,0);return this._overlappers[target._uid]==1||this._overlappers[target._uid]<=-3}overlapping(target,callback){this._validateOverlapParams(target,callback);this._ensureOverlap(target);if(callback)this._setContactCB(target,callback,1,1);let val=this._overlappers[target._uid];if(val<=-3)return 1;return val>0?val:0}overlapped(target,callback){this._validateOverlapParams(target,callback);this._ensureOverlap(target);if(callback)this._setContactCB(target,callback,1,2);return this._overlappers[target._uid]<=-1}_removeContactsWith(target){if(target._isGroup){for(let s of target){this._removeContactsWith(s)}}else{this.__removeContactsWith(target)}}__removeContactsWith(o){if(!this.body)return;for(let ce=this.body.getContactList();ce;ce=ce.next){let c=ce.contact;if(c.m_fixtureA.m_body.sprite._uid==o._uid||c.m_fixtureB.m_body.sprite._uid==o._uid){this.p.world.destroyContact(c)}}}_sortFixtures(){let colliders=null;let sensors=null;let lastColl,lastSens;for(let fxt=this.fixtureList;fxt;fxt=fxt.getNext()){if(fxt.m_isSensor){if(!sensors)sensors=fxt;else sensors.m_next=fxt;lastSens=fxt}else{if(!colliders)colliders=fxt;else colliders.m_next=fxt;lastColl=fxt}}if(sensors)lastSens.m_next=null;if(colliders)lastColl.m_next=sensors;this.body.m_fixtureList=colliders||sensors}addDefaultSensors(){if(this._hasSensors)return;let shape;if(this.body&&this.fixtureList){for(let fxt=this.fixtureList;fxt;fxt=fxt.getNext()){if(fxt.m_isSensor)continue;shape=fxt.m_shape;this.body.createFixture({shape:shape,isSensor:true})}this._sortFixtures()}else{this.addSensor()}this._hasSensors=true}};this.Sprite.propTypes={x:"Float64",y:"Float64",vel:"Vec2",rotation:"number",rotationSpeed:"number",ani:"string",autoDraw:"boolean",allowSleeping:"boolean",autoUpdate:"boolean",bounciness:"number",collider:"Uint8",color:"color",debug:"boolean",density:"number",direction:"number",drag:"number",friction:"number",h:"number",isSuperFast:"boolean",layer:"number",life:"Int32",mass:"number",mirror:"Vec2_boolean",offset:"Vec2",pixelPerfect:"boolean",removed:"boolean",rotationDrag:"number",rotationLock:"boolean",scale:"Vec2",shape:"Uint8",sleeping:"boolean",stroke:"color",strokeWeight:"number",text:"string",textColor:"color",tile:"string",tileSize:"number",visible:"boolean",w:"number",bearing:"number",textSize:"number",textStroke:"color",textStrokeWeight:"number"};this.Sprite.props=Object.keys(this.Sprite.propTypes);this.Sprite.propsAll=this.Sprite.props.concat(["d","diameter","dynamic","fill","height","heading","kinematic","resetAnimationsOnChange","speed","spriteSheet","static","width"]);this.Sprite.colliderTypes=["d","s","k","n"];this.Sprite.shapeTypes=["box","circle","chain","polygon"];this.Turtle=function(size){if(pInst.allSprites.tileSize>1){throw new Error(`Turtle can't be used when allSprites.tileSize is greater than 1.`)}size??=25;let t=new pInst.Sprite(size,size,[[size,size*.4],[-size,size*.4],[0,-size*.8]]);t.color="green";t._isTurtleSprite=true;t._prevPos={x:t.x,y:t.y};let _move=t.move;t.move=async function(){this._prevPos.x=this.x;this._prevPos.y=this.y;await _move.call(this,...arguments)};return t};this.SpriteAnimation=class extends Array{constructor(){super();this.p=pInst;let args=[...arguments];this.name="default";let owner;if(typeof args[0]=="object"&&(args[0]._isSprite||args[0]._isGroup)){owner=args[0];args=args.slice(1);this._addedToSpriteOrGroup=true}owner??=this.p.allSprites;if(typeof args[0]=="string"&&(args[0].length==1||!args[0].includes("."))){this.name=args[0];args=args.slice(1)}this._frame=0;this._cycles=0;this.targetFrame=-1;this.offset={x:owner.anis.offset.x??0,y:owner.anis.offset.y??0};this._frameDelay=owner.anis.frameDelay||4;this.demoMode=owner.anis.demoMode??false;this.playing=true;this.visible=true;this.looping=owner.anis.looping??true;this.endOnFirstFrame=owner.anis.endOnFirstFrame??false;this.frameChanged=false;this.onComplete=this.onChange=null;this._onComplete=this._onChange=null;this.rotation=owner.anis.rotation??0;this._scale=new Scale;if(args.length==0||typeof args[0]=="number")return;owner.animations[this.name]=this;owner._ani=this;if(Array.isArray(args[0])&&typeof args[0][0]=="string"){args=[...args[0]]}if(args.length==2&&typeof args[0]=="string"&&(typeof args[1]=="string"||typeof args[1]=="number")){let from=args[0];let to,num2;if(!isNaN(args[1]))num2=Number(args[1]);else to=args[1];if(from.slice(-4)!=".png"||to&&to.slice(-4)!=".png"){throw new FriendlyError("SpriteAnimation",0,[from])}let digits1=0;let digits2=0;for(let i=from.length-5;i>=0;i--){if(!isNaN(from.charAt(i)))digits1++;else break}if(to){for(let i=to.length-5;i>=0;i--){if(!isNaN(to.charAt(i)))digits2++;else break}}let prefix1=from.slice(0,-4-digits1);let prefix2;if(to)prefix2=to.slice(0,-4-digits2);if(to&&prefix1!=prefix2){this.push(this.p.loadImage(from));this.push(this.p.loadImage(to))}else{let num1=parseInt(from.slice(-4-digits1,-4),10);num2??=parseInt(to.slice(-4-digits2,-4),10);if(num2<num1){let t=num2;num2=num1;num1=t}let fileName;if(!to||digits1==digits2){for(let i=num1;i<=num2;i++){fileName=prefix1+this.p.nf(i,digits1)+".png";this.push(this.p.loadImage(fileName))}}else{for(let i=num1;i<=num2;i++){fileName=prefix1+i+".png";this.push(this.p.loadImage(fileName))}}}}else if(typeof args[args.length-1]!="string"&&!(args[args.length-1]instanceof p5.Image)){let sheet=owner.spriteSheet;let atlas;if(args[0]instanceof p5.Image||typeof args[0]=="string"){if(args.length>=3){throw new FriendlyError("SpriteAnimation",1)}sheet=args[0];atlas=args[1]}else{atlas=args[0]}let _this=this;if(sheet instanceof p5.Image&&sheet.width!=1&&sheet.height!=1){this.spriteSheet=sheet;_generateSheetFrames()}else{let url;if(typeof sheet=="string")url=sheet;else url=sheet.url;pInst._incrementPreload();this.spriteSheet=this.p.loadImage(url,()=>{_generateSheetFrames();pInst._decrementPreload()})}function _generateSheetFrames(){if(Array.isArray(atlas)||Array.isArray(atlas.frames)){if(typeof atlas[0]=="number"){if(atlas.length==4){atlas={pos:atlas.slice(0,2),size:atlas.slice(2)}}else{atlas={pos:atlas}}}else{let frames=atlas;if(Array.isArray(atlas.frames)){frames=atlas.frames;delete atlas.frames;for(let i=0;i<frames.length;i++){frames[i]={pos:frames[i]};Object.assign(frames[i],atlas)}}for(let frame of frames){atlas=frame;_generateSheetFrames()}return}}let{w,h,width,height,size,row,col,line,x,y,pos,frames,frameCount,frameDelay,frameSize,delay,rotation}=atlas;frameSize??=size||owner.anis.frameSize;if(delay)_this.frameDelay=delay;if(frameDelay)_this.frameDelay=frameDelay;if(rotation)_this.rotation=rotation;frameCount??=frames||1;w??=width||owner.anis.w;h??=height||owner.anis.h;x??=col||0;y??=line||row||0;if(pos){x=pos[0];y=pos[1]}if(typeof frameSize=="number"){w=h=frameSize}else if(frameSize){w=frameSize[0];h=frameSize[1]}let tileSize=owner.tileSize;if(!w||!h){if(!owner._dimensionsUndef&&owner.w&&owner.h){w=owner.w*tileSize;h=owner.h*tileSize}else if(tileSize){w=h=tileSize}else if(frameCount){w=_this.spriteSheet.width/frameCount;h=_this.spriteSheet.height}else{if(_this.spriteSheet.width<_this.spriteSheet.height){w=h=_this.spriteSheet.width}else{w=h=_this.spriteSheet.height}}}else{w*=tileSize;h*=tileSize}if(tileSize!=1){x*=tileSize;y*=tileSize}else if(line!==undefined||row!==undefined||col!==undefined){x*=w;y*=h}for(let i=0;i<frameCount;i++){_this.push({x:x,y:y,w:w,h:h});x+=w;if(x>=_this.spriteSheet.width){x=0;y+=h;if(y>=_this.spriteSheet.height)y=0}}}}else{for(let i=0;i<args.length;i++){if(args[i]instanceof p5.Image)this.push(args[i]);else this.push(this.p.loadImage(args[i]))}}if(this.length==1)this.playing=false}get frame(){return this._frame}set frame(val){if(val<0||val>=this.length){throw new FriendlyError("SpriteAnimation.frame",[val,this.length])}this._frame=val;this._cycles=0}get frameDelay(){return this._frameDelay}set frameDelay(val){if(val<=0)val=1;this._frameDelay=val}get scale(){return this._scale}set scale(val){if(typeof val=="number"){val={x:val,y:val}}this._scale._x=val.x;this._scale._y=val.y;this._scale._avg=val.x}clone(){if(!this.length){console.error(`The animation named "${this.name}" must be loaded before it can be properly copied. Sprites need their own copy of a group's animation. Try loading the animation in the preload function and creating new group sprites in the setup function.`)}let ani=new this.p.SpriteAnimation;ani.spriteSheet=this.spriteSheet;for(let i=0;i<this.length;i++){ani.push(this[i])}ani.name=this.name;ani.offset.x=this.offset.x;ani.offset.y=this.offset.y;ani.frameDelay=this.frameDelay;ani.playing=this.playing;ani.looping=this.looping;ani.rotation=this.rotation;return ani}draw(x,y,r,sx,sy){this.x=x||0;this.y=y||0;if(!this.visible)return;sx??=1;sy??=1;this.p.push();this.p.imageMode("center");this.p.translate(this.x,this.y);this.p.rotate(r||this.rotation);this.p.scale(sx*this._scale._x,sy*this._scale._y);let img=this[this._frame];if(img!==undefined){if(this.spriteSheet){let{x,y,w,h}=img;if(!this.demoMode){this.p.image(this.spriteSheet,this.offset.x,this.offset.y,w,h,x,y,w,h)}else{this.p.image(this.spriteSheet,this.offset.x,this.offset.y,this.spriteSheet.w,this.spriteSheet.h,x-this.spriteSheet.w/2+w/2,y-this.spriteSheet.h/2+h/2)}}else{this.p.image(img,this.offset.x,this.offset.y)}}else{log("Warning: "+this.name+" animation not loaded yet or frame "+this._frame+" does not exist. Load this animation in the p5.js preload function if you need to use it at the start of your program.")}this.p.pop()}update(){if(!this.playing)return;this._cycles++;if(this._cycles%this.frameDelay==0){this._cycles=0;this.frameChanged=true;if(this.targetFrame==-1&&this._frame==this.lastFrame||this._frame==this.targetFrame){if(this.endOnFirstFrame)this._frame=0;if(this.looping)this.targetFrame=-1;else this.playing=false;if(this._onComplete)this._onComplete();if(this.onComplete)this.onComplete();if(!this.looping)return}if(this.targetFrame>this._frame&&this.targetFrame!==-1){this._frame++}else if(this.targetFrame<this._frame&&this.targetFrame!==-1){this._frame--}else if(this.targetFrame===this._frame&&this.targetFrame!==-1){this.playing=false}else if(this.looping){if(this._frame>=this.lastFrame){this._frame=0}else this._frame++}else{if(this._frame<this.lastFrame)this._frame++}}else{this.frameChanged=false}}play(frame){this.playing=true;if(frame!==undefined&&this._frame!=frame){this._frame=frame;this._cycles=0}this.targetFrame=-1;return new Promise(resolve=>{this._onComplete=()=>{this._onComplete=null;resolve()}})}pause(frame){this.playing=false;if(frame)this._frame=frame}stop(frame){this.playing=false;if(frame)this._frame=frame}rewind(){this.looping=false;return this.goToFrame(0)}loop(){this.looping=true;this.playing=true}noLoop(){this.looping=false}nextFrame(){if(this._frame<this.length-1)this._frame=this._frame+1;else if(this.looping)this._frame=0;this.targetFrame=-1;this.playing=false;this._cycles=0}previousFrame(){if(this._frame>0)this._frame=this._frame-1;else if(this.looping)this._frame=this.length-1;this.targetFrame=-1;this.playing=false;this._cycles=0}goToFrame(toFrame){if(toFrame<0||toFrame>=this.length){return}this.targetFrame=toFrame;this._cycles=0;if(this.targetFrame!==this._frame){this.playing=true}return new Promise(resolve=>{this._onComplete=()=>{this._onComplete=null;resolve()}})}get lastFrame(){return this.length-1}get frameImage(){let f=this._frame;let img=this[f];if(img instanceof p5.Image)return img;let{x,y,w,h}=img;let image=this.p.createImage(w,h);image.copy(this.spriteSheet,this.offset.x,this.offset.y,w,h,x,y,w,h);return image}get w(){return this.width}get width(){if(this[this._frame]instanceof p5.Image){return this[this._frame].width}else if(this[this._frame]){return this[this._frame].w}return 1}get h(){return this.height}get height(){if(this[this._frame]instanceof p5.Image){return this[this._frame].height}else if(this[this._frame]){return this[this._frame].h}return 1}get frames(){let frames=[];for(let i=0;i<this.length;i++){frames.push(this[i])}return frames}};this.SpriteAnimation.props=["demoMode","endOnFirstFrame","frameDelay","frameSize","looping","offset","rotation","scale"];this.SpriteAnimations=class{#_={};constructor(){let _this=this;let props=[...pInst.SpriteAnimation.props];let vecProps=["offset","scale"];for(let prop of props){Object.defineProperty(this,prop,{get(){return _this.#_[prop]},set(val){_this.#_[prop]=val;for(let k in _this){let x=_this[k];if(!(x instanceof SpriteAnimation))continue;x[prop]=val}}})}for(let vecProp of vecProps){this.#_[vecProp]={_x:0,_y:0};for(let prop of["x","y"]){Object.defineProperty(this.#_[vecProp],prop,{get(){return _this.#_[vecProp]["_"+prop]},set(val){_this.#_[vecProp]["_"+prop]=val;for(let k in _this){let x=_this[k];if(!(x instanceof SpriteAnimation))continue;x[vecProp][prop]=val}}})}}}};this.Group=class extends Array{constructor(...args){let parent;if(args[0]instanceof pInst.Group){parent=args[0];args=args.slice(1)}super(...args);this.p=pInst;if(typeof args[0]=="number")return;for(let s of this){if(!(s instanceof this.p.Sprite)){throw new Error("A group can only contain sprites")}}this._isGroup=true;this.x;this.y;this.vel;this.rotation;this.rotationSpeed;this.autoDraw;this.allowSleeping;this.autoUpdate;this.bounciness;this.collider;this.color;this.debug;this.density;this.direction;this.drag;this.friction;this.h;this.isSuperFast;this.layer;this.life;this.mass;this.mirror;this.offset;this.pixelPerfect;this.removed;this.rotationDrag;this.rotationLock;this.scale;this.shape;this.sleeping;this.stroke;this.strokeWeight;this.text;this.textColor;this.tile;this.tileSize;this.visible;this.w;this.bearing;this.d;this.diameter;this.dynamic;this.height;this.heading;this.kinematic;this.resetAnimationsOnChange;this.speed;this.static;this.width;this.idNum;if(this.p.p5play.groupsCreated<999){this.idNum=this.p.p5play.groupsCreated}else{for(let i=1;i<this.p.p5play.groups.length;i++){if(!this.p.p5play.groups[i]?.removed){this.idNum=i;break}}if(!this.idNum){console.warn("ERROR: Surpassed the limit of 999 groups in memory. Use less groups or delete groups from the p5play.groups array to recycle ids.");for(let i=1;i<this.p.p5play.groups.length;i++){if(!this.p.p5play.groups[i].length){this.idNum=i;break}}this.idNum??=1}}this._uid=this.idNum;this.p.p5play.groups[this._uid]=this;this.p.p5play.groupsCreated++;if(!this.p.allSprites)this._isAllSpritesGroup=true;this.subgroups=[];if(parent instanceof this.p.Group){parent.subgroups.push(this);let p=parent;do{p=this.p.p5play.groups[p.parent];p.subgroups.push(this)}while(!p._isAllSpritesGroup);this.parent=parent._uid}else if(!this._isAllSpritesGroup){this.p.allSprites.subgroups.push(this);this.parent=0}this.animations=new this.p.SpriteAnimations;this._hasOverlap={};this._collisions={};this._overlappers={};let _this=this;this.Sprite=class extends this.p.Sprite{constructor(){super(_this,...arguments)}};this.GroupSprite=this.Sprite;this.Group=class extends this.p.Group{constructor(){super(_this,...arguments)}};this.Subgroup=this.Group;this.mouse={presses:null,pressing:null,pressed:null,holds:null,holding:null,held:null,released:null,hovers:null,hovering:null,hovered:null};for(let state in this.mouse){this.mouse[state]=function(inp){for(let s of _this){if(s.mouse[state](inp))return true}return false}}for(let prop of this.p.Sprite.propsAll){if(prop=="ani"||prop=="velocity")continue;Object.defineProperty(this,prop,{get(){let val=_this["_"+prop];let i=_this.length-1;if(val===undefined&&!_this._isAllSpritesGroup){let parent=this.p.p5play.groups[_this.parent];if(parent){val=parent[prop];i=parent.length-1}}return val},set(val){_this["_"+prop]=val;for(let i=0;i<_this.length;i++){let s=_this[i];let v=val;if(typeof val=="function")v=val(i);s[prop]=v}}})}let vecProps=["mirror","offset","scale","vel"];for(let vecProp of vecProps){vecProp="_"+vecProp;if(vecProp!="vel")this[vecProp]={};else this[vecProp]=new this.p.Vector;this[vecProp]._x=0;this[vecProp]._y=0;for(let prop of["x","y"]){Object.defineProperty(this[vecProp],prop,{get(){let val=_this[vecProp]["_"+prop];let i=_this.length-1;if(val===undefined&&!_this._isAllSpritesGroup){let parent=_this.p.p5play.groups[_this.parent];if(parent){val=parent[vecProp][prop];i=parent.length-1}}return val},set(val){_this[vecProp]["_"+prop]=val;for(let i=0;i<_this.length;i++){let s=_this[i];let v=val;if(typeof val=="function")v=val(i);s[vecProp][prop]=v}}})}}if(this._isAllSpritesGroup){this.autoCull=true;this.tileSize=1;this.autoDraw=true;this.autoUpdate=true}this.add=this.push;this.contains=this.includes}_getTopLayer(){if(this.length==0)return 0;if(this.length==1&&this[0]._layer===undefined)return 0;let max=this[0]._layer;for(let s of this){if(s._layer>max)max=s._layer}return max}get ani(){return this._ani}set ani(val){this.addAni(val);for(let s of this)s.changeAni(val)}get animation(){return this._ani}set animation(val){this.ani=val}get anis(){return this.animations}get img(){return this._ani.frameImage}set img(val){this.ani=val}get image(){return this._ani.frameImage}set image(val){this.ani=val}set amount(val){let diff=val-this.length;let shouldAdd=diff>0;diff=Math.abs(diff);for(let i=0;i<diff;i++){if(shouldAdd)new this.Sprite;else this[this.length-1].remove()}}get velocity(){return this.vel}set velocity(val){this.vel=val}_resetCentroid(){let x=0;let y=0;for(let s of this){x+=s.x;y+=s.y}this.centroid={x:x/this.length,y:y/this.length};return this.centroid}_resetDistancesFromCentroid(){for(let s of this){s.distCentroid={x:s.x-this.centroid.x,y:s.y-this.centroid.y}}}_validateCollideParams(target,cb){if(cb&&typeof cb!="function"){throw new FriendlyError("Group.collide",1,[cb])}if(!target){throw new FriendlyError("Group.collide",2)}if(!target._isGroup&&!target._isSprite){throw new FriendlyError("Group.collide",0,[target])}}_setContactCB(target,cb,contactType,eventType){if(target._isSprite){let reversedCB=function(a,b,v){return cb.call(b,b,a,v)};target._setContactCB(this,reversedCB,contactType,eventType);return}let type;if(contactType==0)type=eventTypes._collisions[eventType];else type=eventTypes._overlappers[eventType];let ledger=this.p.p5play[type];let l=ledger[this._uid]??={};if(l[target._uid]==cb)return;l[target._uid]=cb;for(let s of this){let c2=ledger[s._uid]??={};c2[target._uid]=cb}if(this._uid==target._uid)return;l=ledger[target._uid];if(!l||!l[this._uid])return;if(this._uid!=target._uid)delete l[this._uid];for(let s of target){l=ledger[s._uid];if(!l||!l[this._uid])continue;delete l[this._uid];if(Object.keys(l).length==0){delete ledger[s._uid]}}if(Object.keys(l).length==0){delete ledger[target._uid]}}_ensureCollide(target){if(this._hasOverlap[target._uid]!==false){this._hasOverlap[target._uid]=false;for(let s of this){s._hasOverlap[target._uid]=false;target._hasOverlap[s._uid]=false;if(this._uid==target._uid){for(let s2 of target){s._hasOverlap[s2._uid]=false;s2._hasOverlap[s._uid]=false}}}}if(target._hasOverlap[this._uid]!==false){target._hasOverlap[this._uid]=false;if(target._isGroup){for(let s of target){s._hasOverlap[this._uid]=false;this._hasOverlap[s._uid]=false;for(let s2 of this){s._hasOverlap[s2._uid]=false;s2._hasOverlap[s._uid]=false}}}}}collide(target,callback){return this.collides(target,callback)}collides(target,callback){this._validateCollideParams(target,callback);this._ensureCollide(target);if(callback)this._setContactCB(target,callback,0,0);return this._collisions[target._uid]==1||this._collisions[target._uid]<=-3}colliding(target,callback){this._validateCollideParams(target,callback);this._ensureCollide(target);if(callback)this._setContactCB(target,callback,0,1);let val=this._collisions[target._uid];if(val<=-3)return 1;return val>0?val:0}collided(target,callback){this._validateCollideParams(target,callback);this._ensureCollide(target);if(callback)this._setContactCB(target,callback,0,2);return this._collisions[target._uid]<=-1}_validateOverlapParams(target,cb){if(cb&&typeof cb!="function"){throw new FriendlyError("Group.overlap",1,[cb])}if(!target){throw new FriendlyError("Group.overlap",2)}if(!target._isGroup&&!target._isSprite){throw new FriendlyError("Group.overlap",0,[target])}}_ensureOverlap(target){if(!this._hasSensors){for(let s of this){if(!s._hasSensors)s.addDefaultSensors()}this._hasSensors=true}if(!target._hasSensors){if(target._isSprite){target.addDefaultSensors()}else{for(let s of target){if(!s._hasSensors)s.addDefaultSensors()}target._hasSensors=true}}if(this._hasOverlap[target._uid]!=true){this._removeContactsWith(target);this._hasOverlap[target._uid]=true;for(let s of this){s._hasOverlap[target._uid]=true;target._hasOverlap[s._uid]=true;if(this._uid==target._uid){for(let s2 of target){s._hasOverlap[s2._uid]=true;s2._hasOverlap[s._uid]=true}}}}if(target._hasOverlap[this._uid]!=true){target._removeContactsWith(this);target._hasOverlap[this._uid]=true;if(target._isGroup){for(let s of target){s._hasOverlap[this._uid]=true;this._hasOverlap[s._uid]=true;for(let s2 of this){s._hasOverlap[s2._uid]=true;s2._hasOverlap[s._uid]=true}}}}}overlap(target,callback){return this.overlaps(target,callback)}overlaps(target,callback){this._validateOverlapParams(target,callback);this._ensureOverlap(target);if(callback)this._setContactCB(target,callback,1,0);return this._overlappers[target._uid]==1||this._overlappers[target._uid]<=-3}overlapping(target,callback){this._validateOverlapParams(target,callback);this._ensureOverlap(target);if(callback)this._setContactCB(target,callback,1,1);let val=this._overlappers[target._uid];if(val<=-3)return 1;return val>0?val:0}overlapped(target,callback){this._validateOverlapParams(target,callback);this._ensureOverlap(target);if(callback)this._setContactCB(target,callback,1,2);return this._overlappers[target._uid]<=-1}_removeContactsWith(o){for(let s of this){s._removeContactsWith(o)}}applyForce(){for(let s of this){s.applyForce(...arguments)}}applyForceScaled(){for(let s of this){s.applyForceScaled(...arguments)}}attractTo(){for(let s of this){s.attractTo(...arguments)}}applyTorque(){for(let s of this){s.applyTorque(...arguments)}}move(distance,direction,speed){let movements=[];for(let s of this){movements.push(s.move(distance,direction,speed))}return Promise.all(movements)}moveTo(x,y,speed){if(typeof x!="number"){let obj=x;if(obj==this.p.mouse&&!this.p.mouse.active)return;speed=y;y=obj.y;x=obj.x}let centroid=this._resetCentroid();let movements=[];for(let s of this){let dest={x:s.x-centroid.x+x,y:s.y-centroid.y+y};movements.push(s.moveTo(dest.x,dest.y,speed))}return Promise.all(movements)}moveTowards(x,y,tracking){if(typeof x!="number"){let obj=x;if(obj==this.p.mouse&&!this.p.mouse.active)return;tracking=y;y=obj.y;x=obj.x}if(x===undefined&&y===undefined)return;this._resetCentroid();for(let s of this){if(s.distCentroid===undefined)this._resetDistancesFromCentroid();let dest={x:s.distCentroid.x+x,y:s.distCentroid.y+y};s.moveTowards(dest.x,dest.y,tracking)}}moveAway(x,y,repel){if(typeof x!="number"){let obj=x;if(obj==this.p.mouse&&!this.p.mouse.active)return;repel=y;y=obj.y;x=obj.x}if(x===undefined&&y===undefined)return;this._resetCentroid();for(let s of this){if(s.distCentroid===undefined)this._resetDistancesFromCentroid();let dest={x:s.distCentroid.x+x,y:s.distCentroid.y+y};s.moveAway(dest.x,dest.y,repel)}}push(...sprites){if(this.removed){console.warn("Adding a sprite to a group that was removed. Use `group.removeAll()` to remove all of a group's sprites without removing the group itself. Restoring the group in p5play's memory.");this.p.p5play.groups[this._uid]=this;this.removed=false}for(let s of sprites){if(!(s instanceof this.p.Sprite)){throw new Error("You can only add sprites to a group, not "+typeof s)}if(s.removed){console.error("Can't add a removed sprite to a group");continue}let b;for(let tuid in this._hasOverlap){let hasOverlap=this._hasOverlap[tuid];if(hasOverlap&&!s._hasSensors){s.addDefaultSensors()}if(tuid>=1e3)b=this.p.p5play.sprites[tuid];else b=this.p.p5play.groups[tuid];if(!b||b.removed)continue;if(!hasOverlap)b._ensureCollide(s);else b._ensureOverlap(s)}for(let event in eventTypes){let contactTypes=eventTypes[event];for(let contactType of contactTypes){let ledger=this.p.p5play[contactType];let lg=ledger[this._uid];if(!lg)continue;let ls=ledger[s._uid]??={};for(let b_uid in lg){ls[b_uid]=lg[b_uid]}}}super.push(s);if(this.parent)this.p.p5play.groups[this.parent].push(s);s.groups.push(this)}return this.length}size(){return this.length}toString(){return"g"+this.idNum}cull(top,bottom,left,right,cb){if(left===undefined){let size=top;cb=bottom;top=bottom=left=right=size}if(isNaN(top)||isNaN(bottom)||isNaN(left)||isNaN(right)){throw new TypeError("The culling boundary must be defined with numbers")}if(cb&&typeof cb!="function"){throw new TypeError("The callback to group.cull must be a function")}let cx=this.p.camera.x-this.p.canvas.hw/this.p.camera.zoom;let cy=this.p.camera.y-this.p.canvas.hh/this.p.camera.zoom;let minX=-left+cx;let minY=-top+cy;let maxX=this.p.width+right+cx;let maxY=this.p.height+bottom+cy;let culled=0;for(let i=0;i<this.length;i++){let s=this[i];if(s.shape=="chain")continue;if(s.x<minX||s.y<minY||s.x>maxX||s.y>maxY){culled++;if(cb)cb(s,culled);else s.remove();if(s.removed)i--}}return culled}remove(item){if(item===undefined){this.removeAll();if(!this._isAllSpritesGroup)this.removed=true;return}let idx;if(typeof item=="number"){if(item>=0)idx=item;else idx=this.length+item}else{idx=this.indexOf(item)}if(idx==-1)return;let s=this[idx];this.splice(idx,1);return s}splice(idx,amount){let removed=super.splice(idx,amount);if(!removed)return;let gIDs=[];for(let s of removed){if(s.removed)continue;let gID=this._uid;do{gIDs.push(gID);let gIdx=s.groups.findIndex(g=>g._uid==gID);let g=s.groups.splice(gIdx,1);gID=g[0].parent}while(gID)}for(let gID of gIDs){let a=this.p.p5play.groups[gID];for(let eventType in eventTypes){for(let b_uid in a[eventType]){if(a[eventType][b_uid]==0)continue;let b;if(b_uid>=1e3)b=this.p.p5play.sprites[b_uid];else b=this.p.p5play.groups[b_uid];let inContact=false;for(let s of a){if(s[eventType][b._uid]>0){inContact=true;break}}if(!inContact){a[eventType][b._uid]=-2;b[eventType][a._uid]=-2}}}}return removed}pop(){return this.remove(this.length-1)}shift(){return this.remove(0)}unshift(){console.error("unshift is not supported for groups");return this.length}removeAll(){while(this.length>0){this[0].remove()}}_step(){this.__step()}draw(){let g=[...this];g.sort((a,b)=>a._layer-b._layer);for(let i=0;i<g.length;i++){let sprite=g[i];if(sprite._life!=2147483647&&sprite._life--<0){sprite.remove();g.splice(i,1);i--;continue}if(sprite._visible!==false&&(!this.p.p5play._inPostDraw||sprite.autoDraw)){sprite.draw()}}if(this._autoDraw)this._autoDraw=null}update(){for(let s of this){if(!this.p.p5play._inPostDraw||this.autoUpdate){s.update()}}if(this._autoUpdate)this._autoUpdate=null}};this.Sprite.prototype.__step=this.Group.prototype.__step=function(){let a=this;let b;for(let event in eventTypes){for(let k in this[event]){if(k>=1e3){if(a._isGroup||a._uid>=k)continue;b=this.p.p5play.sprites[k]}else{if(a._isGroup&&a._uid>=k)continue;b=this.p.p5play.groups[k]}let v=a[event][k]+1;if(!b||v==0||v==-2){delete a[event][k];if(b)delete b[event][a._uid];continue}this[event][k]=v;b[event][a._uid]=v}}};this.Sprite.prototype.___step=this.Group.prototype.___step=function(){let a=this;let b,contactType,shouldOverlap,cb;let checkCollisions=true;for(let event in eventTypes){for(let k in this[event]){if(k>=1e3){if(a._isGroup||a._uid>=k)continue;b=this.p.p5play.sprites[k]}else{if(a._isGroup&&a._uid>=k)continue;b=this.p.p5play.groups[k]}if(a._isGroup||b?._isGroup)continue;shouldOverlap=a._hasOverlap[b._uid]??b._hasOverlap[a._uid];if(checkCollisions&&shouldOverlap!==false||!checkCollisions&&shouldOverlap!==true){continue}let v=a[event][k];for(let i=0;i<3;i++){if(i==0&&v!=1&&v!=-3)continue;if(i==1&&v==-1)continue;if(i==2&&v>=1)continue;contactType=eventTypes[event][i];let la=this.p.p5play[contactType][a._uid];if(la){cb=la[b._uid];if(cb)cb.call(a,a,b,v);for(let g of b.groups){cb=la[g._uid];if(cb)cb.call(a,a,b,v)}}let lb=this.p.p5play[contactType][b._uid];if(lb){cb=lb[a._uid];if(cb)cb.call(b,b,a,v);for(let g of a.groups){cb=lb[g._uid];if(cb&&(!la||cb!=la[g._uid])){cb.call(b,b,a,v)}}}}}checkCollisions=false}if(this._removed){if(Object.keys(this._collisions).length==0&&Object.keys(this._overlappers).length==0){if(this._isSprite)delete this.p.p5play.sprites[this._uid];else if(this.p.p5play.targetVersion>=16)delete this.p.p5play.groups[this._uid];for(let eventType in eventTypes){for(let contactType of eventTypes[eventType]){delete this.p.p5play[contactType][this._uid]}}}}};this.Sprite.prototype.addAnimation=this.Group.prototype.addAnimation=this.Sprite.prototype.addAni=this.Group.prototype.addAni=this.Sprite.prototype.addImage=this.Group.prototype.addImage=this.Sprite.prototype.addImg=this.Group.prototype.addImg=function(){if(this.p.p5play.disableImages){this._ani=new this.p.SpriteAnimation;return}let args=[...arguments];let name,ani;if(args[0]instanceof this.p.SpriteAnimation){ani=args[0];if(ani._addedToSpriteOrGroup)ani=ani.clone();name=ani.name||"default";ani.name=name}else if(args[1]instanceof this.p.SpriteAnimation){name=args[0];ani=args[1];if(ani._addedToSpriteOrGroup)ani=ani.clone();ani.name=name}else{ani=new this.p.SpriteAnimation(this,...args);name=ani.name}this.animations[name]=ani;this._ani=ani;ani._addedToSpriteOrGroup=true;if(this._dimensionsUndef&&(ani.w!=1||ani.h!=1)){this.w=ani.w;this.h=ani.h}return ani};this.Sprite.prototype.addAnis=this.Group.prototype.addAnis=this.Sprite.prototype.addAnimations=this.Group.prototype.addAnimations=this.Sprite.prototype.addImages=this.Group.prototype.addImages=this.Sprite.prototype.addImgs=this.Group.prototype.addImgs=function(){let args=arguments;let atlases;if(args.length==1){atlases=args[0]}else{this.spriteSheet=args[0];atlases=args[1]}for(let name in atlases){let atlas=atlases[name];this.addAni(name,atlas)}};this.World=class extends pl.World{constructor(){super(new pl.Vec2(0,0),true);this.p=pInst;this.mod=[];this.origin={x:0,y:0};this.contacts=[];this.on("begin-contact",this._beginContact);this.on("end-contact",this._endContact);let _this=this;this._gravity={get x(){return _this.m_gravity.x},set x(val){val=Math.round(val||0);if(val==_this.m_gravity.x)return;_this.mod[0]=true;for(let s of _this.p.allSprites){s.sleeping=false}_this.m_gravity.x=val},get y(){return _this.m_gravity.y},set y(val){val=Math.round(val||0);if(val==_this.m_gravity.y)return;_this.mod[0]=true;for(let s of _this.p.allSprites){s.sleeping=false}_this.m_gravity.y=val}};this.velocityThreshold=.19;this.mouseTracking??=true;this.mouseSprite=null;this.mouseSprites=[];this.autoStep=true}get gravity(){return this._gravity}set gravity(val){this._gravity.x=val.x;this._gravity.y=val.y}get velocityThreshold(){return pl.Settings.velocityThreshold}set velocityThreshold(val){pl.Settings.velocityThreshold=val}step(timeStep,velocityIterations,positionIterations){for(let s of this.p.allSprites){s.prevPos.x=s.x;s.prevPos.y=s.y;s.prevRotation=s.rotation}super.step(timeStep||1/(this.p._targetFrameRate||60),velocityIterations||8,positionIterations||3);let sprites=Object.values(this.p.p5play.sprites);let groups=Object.values(this.p.p5play.groups);for(let s of sprites)s._step();for(let g of groups)g._step();for(let s of sprites)s.___step();for(let g of groups)g.___step();if(this.autoStep)this.autoStep=null}getSpritesAt(x,y,group,cameraActiveWhenDrawn){cameraActiveWhenDrawn??=true;const convertedPoint=new pl.Vec2(x/plScale,y/plScale);const aabb=new pl.AABB;aabb.lowerBound=new pl.Vec2(convertedPoint.x-.001,convertedPoint.y-.001);aabb.upperBound=new pl.Vec2(convertedPoint.x+.001,convertedPoint.y+.001);let fxts=[];this.queryAABB(aabb,fxt=>{if(fxt.getShape().testPoint(fxt.getBody().getTransform(),convertedPoint)){fxts.push(fxt)}return true});if(fxts.length==0)return[];group??=this.p.allSprites;let sprites=[];for(let fxt of fxts){const s=fxt.m_body.sprite;if(s._cameraActiveWhenDrawn==cameraActiveWhenDrawn){if(!sprites.find(x=>x._uid==s._uid))sprites.push(s)}}sprites.sort((a,b)=>(a._layer-b._layer)*-1);return sprites}getSpriteAt(x,y,group){const sprites=this.getSpritesAt(x,y,group);return sprites[0]}getMouseSprites(){let sprites=this.getSpritesAt(this.p.mouse.x,this.p.mouse.y);if(this.p.camera._wasOff){let uiSprites=this.getSpritesAt(this.p.camera.mouse.x,this.p.camera.mouse.y,this.p.allSprites,false);if(uiSprites.length)sprites=[...uiSprites,...sprites]}return sprites}_beginContact(contact){let a=contact.m_fixtureA;let b=contact.m_fixtureB;let t="_collisions";if(a.m_isSensor)t="_overlappers";a=a.m_body.sprite;b=b.m_body.sprite;a[t][b._uid]=0;b[t][a._uid]=0;for(let g of b.groups){if(!a[t][g._uid]||a[t][g._uid]<0){a[t][g._uid]=0;g[t][a._uid]=0}}for(let g of a.groups){if(!b[t][g._uid]||b[t][g._uid]<0){b[t][g._uid]=0;g[t][b._uid]=0}for(let g2 of b.groups){if(!g[t][g2._uid]||g[t][g2._uid]<0){g[t][g2._uid]=0;g2[t][g._uid]=0}}}}_endContact(contact){let a=contact.m_fixtureA;let b=contact.m_fixtureB;let contactType="_collisions";if(a.m_isSensor)contactType="_overlappers";a=a.m_body.sprite;b=b.m_body.sprite;a[contactType][b._uid]=a[contactType][b._uid]!=0?-2:-4;b[contactType][a._uid]=b[contactType][a._uid]!=0?-2:-4;for(let g of b.groups){let inContact=false;for(let s of g){if(s[contactType][a._uid]>=0){inContact=true;break}}if(!inContact){g[contactType][a._uid]=g[contactType][a._uid]!=0?-2:-4;a[contactType][g._uid]=a[contactType][g._uid]!=0?-2:-4}}for(let g of a.groups){let inContact=false;for(let s of g){if(s[contactType][b._uid]>=0){inContact=true;break}}if(!inContact){g[contactType][b._uid]=g[contactType][b._uid]!=0?-2:-4;b[contactType][g._uid]=b[contactType][g._uid]!=0?-2:-4;for(let g2 of b.groups){g[contactType][g2._uid]=g[contactType][g2._uid]!=0?-2:-4;g2[contactType][g._uid]=g2[contactType][g._uid]!=0?-2:-4}}}}_findContact(type,s0,s1){let cb=s0[type][s1._uid];if(cb)return cb;for(let g1 of s1.groups){cb=s0[type][g1._uid];if(cb)return cb}for(let g0 of s0.groups){cb=g0[type][s1._uid];if(cb)return cb;for(let g1 of s1.groups){if(g0._uid!=g1._uid)continue;cb=g0[type][g1._uid];if(cb)return cb}}return false}get allowSleeping(){return this.getAllowSleeping()}set allowSleeping(val){this.setAllowSleeping(val)}};this.Camera=class{constructor(){this.p=pInst;let _this=this;this._pos=this.p.createVector.call(this.p);this.__pos={x:0,y:0,rounded:{}};this.mouse={x:this.p.mouseX,y:this.p.mouseY};this.mouse.pos=this.p.createVector.call(this.p);Object.defineProperty(this.mouse.pos,"x",{get(){return _this.mouse.x},set(val){_this.mouse.x=val}});Object.defineProperty(this.mouse.pos,"y",{get(){return _this.mouse.y},set(val){_this.mouse.y=val}});this.active=false;this.bound={min:{x:0,y:0},max:{x:0,y:0}};this._zoomIdx=-1;this._zoom=1;this._destIdx=0}get pos(){return this._pos}set pos(val){this.x=val.x;this.y=val.y}get position(){return this._pos}set position(val){this.x=val.x;this.y=val.y}_calcBoundsX(val){let mod=this.p.canvas.hw/this._zoom;this.bound.min.x=val-mod-100;this.bound.max.x=val+mod+100}_calcBoundsY(val){let mod=this.p.canvas.hh/this._zoom;this.bound.min.y=val-mod-100;this.bound.max.y=val+mod+100}get x(){return this._pos.x}set x(val){if(val===undefined||isNaN(val))return;this._pos.x=val;let x=-val+this.p.canvas.hw/this._zoom;this.__pos.x=x;if(this.p.allSprites.pixelPerfect){this.__pos.rounded.x=Math.round(x)}this._calcBoundsX(val)}get y(){return this._pos.y}set y(val){if(val===undefined||isNaN(val))return;this._pos.y=val;let y=-val+this.p.canvas.hh/this._zoom;this.__pos.y=y;if(this.p.allSprites.pixelPerfect){this.__pos.rounded.y=Math.round(y)}this._calcBoundsY(val)}moveTo(x,y,speed){if(x===undefined)return;if(isNaN(x)){speed=y;y=x.y;x=x.x}speed??=1;if(speed<=0){console.warn("camera.moveTo: speed should be a positive number");return Promise.resolve(false)}let a=y-this.y;let b=x-this.x;let c=Math.sqrt(a*a+b*b);let percent=speed/c;let velX=b*percent;let velY=a*percent;this._destIdx++;let destIdx=this._destIdx;let steps=Math.ceil(c/speed);return(async()=>{for(let i=0;i<steps;i++){this.x+=velX;this.y+=velY;await this.p.delay();if(destIdx!=this._destIdx)return false}this.x=x;this.y=y;return true})()}get zoom(){return this._zoom}set zoom(val){if(val===undefined||isNaN(val))return;this._zoom=val;let x=-this._pos.x+this.p.canvas.hw/val;let y=-this._pos.y+this.p.canvas.hh/val;this.__pos.x=x;this.__pos.y=y;if(this.p.allSprites.pixelPerfect){this.__pos.rounded.x=Math.round(x);this.__pos.rounded.y=Math.round(y)}this._calcBoundsX(this._pos.x);this._calcBoundsY(this._pos.y)}zoomTo(target,speed){if(target==this._zoom)return Promise.resolve(true);speed??=.1;let delta=Math.abs(target-this._zoom);let frames=Math.round(delta/speed);if(target<this.zoom)speed=-speed;this._zoomIdx++;let zoomIdx=this._zoomIdx;return(async()=>{for(let i=0;i<frames;i++){if(zoomIdx!=this._zoomIdx)return false;this.zoom+=speed;await this.p.delay()}this.zoom=target;return true})()}on(){if(!this.active){this.p.push();this.p.scale(this._zoom);if(!this.p.allSprites.pixelPerfect){this.p.translate(this.__pos.x,this.__pos.y)}else{this.__pos.rounded.x??=Math.round(this.__pos.x);this.__pos.rounded.y??=Math.round(this.__pos.y);this.p.translate(this.__pos.rounded.x,this.__pos.rounded.y)}this.active=true}}off(){if(this.active){this.p.pop();this.active=false;this._wasOff=true}}};pl.Fixture.prototype.shouldCollide=function(that){let a=this;let b=that;if(a.m_isSensor&&b.m_isSensor)return true;if(a.m_isSensor||b.m_isSensor)return false;a=a.m_body.sprite;b=b.m_body.sprite;let shouldOverlap=a._hasOverlap[b._uid]??b._hasOverlap[a._uid];if(shouldOverlap)return false;return true};this.Tiles=class{constructor(tiles,x,y,w,h){if(typeof tiles=="string"){if(tiles[0]=="\n")tiles=tiles.slice(1);tiles=tiles.replaceAll("\t","  ");tiles=tiles.split("\n")}x??=0;y??=0;w??=1;h??=1;let sprites=new pInst.Group;for(let row=0;row<tiles.length;row++){for(let col=0;col<tiles[row].length;col++){let t=tiles[row][col];if(t==" "||t==".")continue;let ani,g;let groups=Object.values(pInst.p5play.groups);for(g of groups){ani=g.animations[t];if(ani)break}if(ani){sprites.push(new g.Sprite(ani,x+col*w,y+row*h));continue}let wasFound=false;for(g of groups){if(g.tile==t){wasFound=true;break}}if(wasFound){sprites.push(new g.Sprite(x+col*w,y+row*h));continue}let s;for(s of pInst.allSprites){if(s.tile==t){wasFound=true;break}}if(wasFound){s.x=x+col*w;s.y=y+row*h;continue}throw"Tile not found: "+t}}return sprites}};this.createTiles=function(tiles,x,y,w,h){return new this.Tiles(tiles,x,y,w,h)};this.Joint=class{constructor(spriteA,spriteB,type){this.p=pInst;if(!spriteA?._isSprite||!spriteB?._isSprite){throw new Error("The Joint constructor requires two sprites as input.")}if(!spriteA.body)spriteA.addDefaultSensors();if(!spriteB.body)spriteB.addDefaultSensors();this.spriteA=spriteA;this.spriteB=spriteB;type??="glue";this.type=type;if(type=="glue"){let j=pl.WeldJoint({},spriteA.body,spriteB.body,spriteA.body.getWorldCenter());this._createJoint(j)}let _this=this;if(type!="glue"&&type!="slider"&&type!="rope"){for(let l of["A","B"]){if(l=="A"&&type=="wheel")continue;const prop="_offset"+l;this[prop]=pInst.createVector.call(pInst);for(let axis of["x","y"]){Object.defineProperty(this[prop],axis,{get(){let val=_this._j["m_localAnchor"+l][axis]/_this["sprite"+l].tileSize*plScale;return fixRound(val)},set(val){_this._j["m_localAnchor"+l][axis]=val/plScale*_this["sprite"+l].tileSize;if(_this.type=="distance"||_this.type=="rope"){_this._j.m_length=pl.Vec2.distance(_this._j.m_bodyA.getWorldPoint(_this._j.m_localAnchorA),_this._j.m_bodyB.getWorldPoint(_this._j.m_localAnchorB))}else if(_this.type=="hinge"||_this.type=="wheel"){let o;if(l=="A")o="B";else o="A";_this._j["m_localAnchor"+o][axis]=_this._j["m_body"+o].getLocalPoint(_this._j["m_body"+l].getWorldPoint(_this._j["m_localAnchor"+l]))[axis]}}})}}}let removeProps=[];if(type=="distance"||type=="glue"||type=="rope"){removeProps.push("enableMotor","maxPower","motorSpeed","power","speed")}if(type=="rope"){removeProps.push("damping","springiness")}let def={};for(let prop of removeProps){def[prop]={value:null,enumerable:false}}Object.defineProperties(this,def);this.visible=true;spriteA.joints.push(this);spriteB.joints.push(this)}_createJoint(j){this._j=this.p.world.createJoint(j)}_display(){this._draw(this.spriteA.x,this.spriteA.y,this.spriteB.x,this.spriteB.y);this.visible=null}_draw(xA,yA,xB,yB){if(yB){this.p.line(xA,yA,xB,yB)}else{this.p.point(xA,yA)}}get draw(){return this._display}set draw(val){this._draw=val}get offsetA(){return this._offsetA}set offsetA(val){this._offsetA.x=val.x;this._offsetA.y=val.y}get offsetB(){return this._offsetB}set offsetB(val){this._offsetB.x=val.x;this._offsetB.y=val.y}get springiness(){return this._springiness}set springiness(val){if(val>0){if(val<.1){val=this.p.map(val,0,.1,30,4)}else if(val<.5){val=this.p.map(val,.1,.5,4,2.5)}else if(val<.8){val=this.p.map(val,.5,.8,2.5,1)}else if(val<.9){val=this.p.map(val,.8,.9,1,.5)}else{val=this.p.map(val,.9,1,.5,.2)}}this._springiness=val;if(this.type!="wheel"){this._j.setFrequency(val);return}this._j.setSpringFrequencyHz(val)}get damping(){if(this.type!="wheel"){return this._j.getDampingRatio()}return this._j.getSpringDampingRatio()}set damping(val){if(this.type!="wheel"){this._j.setDampingRatio(val);return}this._j.setSpringDampingRatio(val)}get speed(){return this._j.getJointSpeed()}set speed(val){if(!this._j.isMotorEnabled()){this._j.enableMotor(true)}this._j.setMotorSpeed(val)}get motorSpeed(){return this._j.getMotorSpeed()}get enableMotor(){return this._j.isMotorEnabled()}set enableMotor(val){this._j.enableMotor(val)}get maxPower(){return this._j.getMaxMotorTorque()}set maxPower(val){if(!this._j.isMotorEnabled()&&val){this._j.enableMotor(true)}this._j.setMaxMotorTorque(val);if(!val)this._j.enableMotor(false)}get power(){return this._j.getMotorTorque()}get collideConnected(){return this._j.getCollideConnected()}set collideConnected(val){this._j.m_collideConnected=val}remove(){if(this._removed)return;this.spriteA.joints.splice(this.spriteA.joints.indexOf(this),1);this.spriteB.joints.splice(this.spriteB.joints.indexOf(this),1);this.p.world.destroyJoint(this._j);this._removed=true}};this.GlueJoint=class extends this.Joint{constructor(spriteA,spriteB){super(...arguments,"glue")}};this.DistanceJoint=class extends this.Joint{constructor(spriteA,spriteB){super(...arguments,"distance");let j=pl.DistanceJoint({},spriteA.body,spriteB.body,spriteA.body.getWorldCenter(),spriteB.body.getWorldCenter());this._createJoint(j)}_display(){let ancA,ancB;if(this.offsetA.x||this.offsetA.y){ancA=this.spriteA.body.getWorldPoint(this._j.m_localAnchorA);ancA=scaleFrom(ancA.x,ancA.y,this.spriteA.tileSize)}if(this.offsetB.x||this.offsetB.y){ancB=this.spriteB.body.getWorldPoint(this._j.m_localAnchorB);ancB=scaleFrom(ancB.x,ancB.y,this.spriteB.tileSize)}this._draw(!ancA?this.spriteA.x:ancA.x,!ancA?this.spriteA.y:ancA.y,!ancB?this.spriteB.x:ancB.x,!ancB?this.spriteB.y:ancB.y);this.visible=null}};this.WheelJoint=class extends this.Joint{constructor(spriteA,spriteB){super(...arguments,"wheel");let j=pl.WheelJoint({maxMotorTorque:1e3,frequencyHz:4,dampingRatio:.7},spriteA.body,spriteB.body,spriteB.body.getWorldCenter(),new pl.Vec2(0,1));this._createJoint(j);this._angle=this.p._angleMode=="degrees"?90:1.5707963267948966}_display(){let xA=this.spriteA.x;let yA=this.spriteA.y;let xB,yB;if(!this.offsetB.x&&!this.offsetB.y){xB=this.spriteB.x;yB=this.spriteB.y}else{let ancB=this.spriteB.body.getWorldPoint(this._j.m_localAnchorB);ancB=scaleFrom(ancB.x,ancB.y,this.spriteB.tileSize);xB=ancB.x;yB=ancB.y}let slopeA=this.p.tan(this.spriteA.rotation);let slopeB=this.p.tan(this._angle+this.spriteA.rotation);let xI=(yB-yA+slopeA*xA-slopeB*xB)/(slopeA-slopeB);let yI=slopeA*(xI-xA)+yA;this._draw(xI,yI,xB,yB);this.visible=null}get angle(){return this._angle}set angle(val){if(val==this._angle)return;this._angle=val;this._j.m_localXAxisA=new pl.Vec2(this.p.cos(val),this.p.sin(val));this._j.m_localXAxisA.normalize();this._j.m_localYAxisA=pl.Vec2.crossNumVec2(1,this._j.m_localXAxisA)}};this.HingeJoint=class extends this.Joint{constructor(spriteA,spriteB){super(...arguments,"hinge");let j=pl.RevoluteJoint({},spriteA.body,spriteB.body,spriteA.body.getWorldCenter());this._createJoint(j)}_display(){const offsetAx=this.offsetA.x;const offsetAy=this.offsetA.y;const rotationA=this.spriteA.rotation;const rotatedOffsetAx=offsetAx*this.p.cos(rotationA)-offsetAy*this.p.sin(rotationA);const rotatedOffsetAy=offsetAx*this.p.sin(rotationA)+offsetAy*this.p.cos(rotationA);this._draw(this.spriteA.x+rotatedOffsetAx,this.spriteA.y+rotatedOffsetAy);this.visible=null}get range(){return this.upperLimit-this.lowerLimit}set range(val){val/=2;this.upperLimit=val;this.lowerLimit=-val}get lowerLimit(){let val=this._j.getLowerLimit();if(this.p._angleMode=="radians")return val;return this.p.degrees(val)}set lowerLimit(val){if(!this._j.isLimitEnabled()){this._j.enableLimit(true)}this.spriteA.body.setAwake(true);this.spriteB.body.setAwake(true);if(this.p._angleMode=="degrees")val=this.p.radians(val);this._j.m_lowerAngle=val}get upperLimit(){let val=this._j.getUpperLimit();if(this.p._angleMode=="radians")return val;return this.p.degrees(val)}set upperLimit(val){if(!this._j.isLimitEnabled()){this._j.enableLimit(true)}this.spriteA.body.setAwake(true);this.spriteB.body.setAwake(true);if(this.p._angleMode=="degrees")val=this.p.radians(val);this._j.m_upperAngle=val}get angle(){let ang=this._j.getJointAngle();if(this.p._angleMode=="radians")return ang;return pInst.radians(ang)}};this.RevoluteJoint=this.HingeJoint;this.SliderJoint=class extends this.Joint{constructor(spriteA,spriteB){super(...arguments,"slider");let j=pl.PrismaticJoint({lowerTranslation:-1,upperTranslation:1,enableLimit:true,maxMotorForce:50,motorSpeed:0,enableMotor:true},spriteA.body,spriteB.body,spriteA.body.getWorldCenter(),new pl.Vec2(1,0));this._createJoint(j);this._angle=0}get angle(){return this._angle}set angle(val){if(val==this._angle)return;this._angle=val;this._j.m_localXAxisA=new pl.Vec2(this.p.cos(val),this.p.sin(val));this._j.m_localXAxisA.normalize();this._j.m_localYAxisA=pl.Vec2.crossNumVec2(1,this._j.m_localXAxisA)}get range(){return this.upperLimit-this.lowerLimit}set range(val){val/=2;this.upperLimit=val;this.lowerLimit=-val}get lowerLimit(){return this._j.getLowerLimit()/this.spriteA.tileSize*plScale}set lowerLimit(val){if(!this._j.isLimitEnabled()){this._j.enableLimit(true)}val=val*this.spriteA.tileSize/plScale;this._j.setLimits(val,this._j.getUpperLimit())}get upperLimit(){return this._j.getUpperLimit()/this.spriteA.tileSize*plScale}set upperLimit(val){if(!this._j.isLimitEnabled()){this._j.enableLimit(true)}val=val*this.spriteA.tileSize/plScale;this._j.setLimits(this._j.getLowerLimit(),val)}};this.PrismaticJoint=this.SliderJoint;this.RopeJoint=class extends this.Joint{constructor(spriteA,spriteB){super(...arguments,"rope");let j=pl.RopeJoint({maxLength:1},spriteA.body,spriteB.body,spriteA.body.getWorldCenter());this._createJoint(j);this._j.m_localAnchorB.x=0;this._j.m_localAnchorB.y=0}get maxLength(){return scaleXFrom(this._j.getMaxLength(),this.spriteA.tileSize)}set maxLength(val){this._j.setMaxLength(scaleXTo(val,this.spriteA.tileSize))}};class Scale{constructor(){let _this=this;Object.defineProperties(this,{x:{get(){return _this._x},set(val){if(val==_this._x)return;_this._x=val;_this._avg=(_this._x+_this._y)*.5},configurable:true,enumerable:true},y:{get(){return _this._y},set(val){if(val==_this._y)return;_this._y=val;_this._avg=(_this._x+_this._y)*.5},configurable:true,enumerable:true},_x:{value:1,enumerable:false,writable:true},_y:{value:1,enumerable:false,writable:true},_avg:{value:1,enumerable:false,writable:true}})}valueOf(){return this._avg}}function decodeFloat16(b){let e=(b&31744)>>10,f=b&1023;return(b>>15?-1:1)*(e?e===31?f?NaN:Infinity:Math.pow(2,e-15)*(1+f/1024):6103515625e-14*(f/1024))}const encodeFloat16=function(){let fv=new Float32Array(1);let iv=new Int32Array(fv.buffer);return function toHalf(v){fv[0]=v;let x=iv[0];let b=x>>16&32768;let m=x>>12&2047;let e=x>>23&255;if(e<103)return b;if(e>142){b|=31744;b|=(e==255?0:1)&&x&8388607;return b}if(e<113){m|=2048;b|=(m>>114-e)+(m>>113-e&1);return b}b|=e-112<<10|m>>1;b+=m&1;return b}}();function isArrowFunction(fn){return!/^(?:(?:\/\*[^(?:\*\/)]*\*\/\s*)|(?:\/\/[^\r\n]*))*\s*(?:(?:(?:async\s(?:(?:\/\*[^(?:\*\/)]*\*\/\s*)|(?:\/\/[^\r\n]*))*\s*)?function|class)(?:\s|(?:(?:\/\*[^(?:\*\/)]*\*\/\s*)|(?:\/\/[^\r\n]*))*)|(?:[_$\w][\w0-9_$]*\s*(?:\/\*[^(?:\*\/)]*\*\/\s*)*\s*\()|(?:\[\s*(?:\/\*[^(?:\*\/)]*\*\/\s*)*\s*(?:(?:['][^']+['])|(?:["][^"]+["]))\s*(?:\/\*[^(?:\*\/)]*\*\/\s*)*\s*\]\())/.test(fn.toString())}function isColliderType(t){if(t=="d"||t=="s"||t=="k"||t=="n")return true;let abr=t.slice(0,2);return abr=="dy"||abr=="st"||abr=="ki"||abr=="no"}function getRegularPolygon(lineLength,name){let l=lineLength;let n=name.toLowerCase();if(n=="triangle")l=[l,-120,3];else if(n=="square")l=[l,-90,4];else if(n=="pentagon")l=[l,-72,5];else if(n=="hexagon")l=[l,-60,6];else if(n=="septagon")l=[l,-51.4285714286,7];else if(n=="octagon")l=[l,-45,8];else if(n=="enneagon")l=[l,-40,9];else if(n=="decagon")l=[l,-36,10];else if(n=="hendecagon")l=[l,-32.7272727273,11];else if(n=="dodecagon")l=[l,-30,12];if(l==lineLength)throw new Error("Invalid, not a regular polygon: "+name);return l}this.p5play.palettes=[{a:"aqua",b:"black",c:"crimson",d:"darkviolet",e:"peachpuff",f:"olive",g:"green",h:"hotpink",i:"indigo",j:"navy",k:"khaki",l:"lime",m:"magenta",n:"brown",o:"orange",p:"pink",q:"turquoise",r:"red",s:"skyblue",t:"tan",u:"blue",v:"violet",w:"white",x:"gold",y:"yellow",z:"gray"}];this.colorPal=(c,palette)=>{if(c instanceof p5.Color)return c;if(typeof palette=="number"){palette=pInst.p5play.palettes[palette]}palette??=pInst.p5play.palettes[0];let clr;if(palette)clr=palette[c];if(clr===""||c==="."||c===" "){return pInst.color(0,0,0,0)}return pInst.color(clr||c)};this.spriteArt=(txt,scale,palette)=>{scale??=1;if(typeof palette=="number"){palette=pInst.p5play.palettes[palette]}palette??=pInst.p5play.palettes[0];let lines=txt;if(typeof txt=="string"){txt=txt.trim();txt=txt.replace(/\r*\n\t+/g,"\n");txt=txt.replace(/\s+$/g,"");lines=txt.split("\n")}let w=0;for(let line of lines){if(line.length>w)w=line.length}let h=lines.length;let img=pInst.createImage(w*scale,h*scale);img.loadPixels();for(let i=0;i<lines.length;i++){for(let j=0;j<lines[i].length;j++){for(let sX=0;sX<scale;sX++){for(let sY=0;sY<scale;sY++){let c=this.colorPal(lines[i][j],palette);img.set(j*scale+sX,i*scale+sY,c)}}}}img.updatePixels();img.w=img.width;img.h=img.height;pInst.p5play.images.onLoad(img);return img};this.createSprite=function(){return new this.Sprite(...arguments)};this.createGroup=function(){return new this.Group(...arguments)};this.loadAnimation=this.loadAni=function(){return new this.SpriteAnimation(...arguments)};this.animation=function(ani,x,y,r,sX,sY){if(ani.visible)ani.update();ani.draw(x,y,r,sX,sY)};this.delay=millisecond=>{if(!millisecond){return new Promise(requestAnimationFrame)}else{return new Promise(resolve=>{setTimeout(resolve,millisecond)})}};this.sleep=millisecond=>{return this.delay(millisecond)};this.play=sound=>{if(!sound?.play){throw new Error("Tried to play your sound but it wasn't a sound object.")}return new Promise(resolve=>{sound.play();sound.onended(()=>resolve())})};async function playIntro(){if(document.getElementById("p5play-intro"))return;pInst._incrementPreload();let d=document.createElement("div");d.id="p5play-intro";d.style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; z-index: 1000; background-color: black;";let logo=document.createElement("img");logo.src="https://p5play.org/v3/made_with_p5play.png";logo.style="position: absolute; top: 50%; left: 50%; width: 40vh; height: 20vh; margin-left: -20vh; margin-top: -10vh; z-index: 1000; opacity: 0; transition: opacity 0.1s ease-in-out;";document.body.append(d);d.append(logo);await pInst.delay(100);logo.style.opacity="1";logo.style.transition="scale 1.4s, opacity 0.4s ease-in-out";logo.style.scale="1.1";await pInst.delay(1100);logo.style.opacity="0";await pInst.delay(300);d.style.display="none";d.remove();document.getElementById("p5play-intro")?.remove();pInst._decrementPreload()}{let lh=location.hostname;switch(lh){case"":case"127.0.0.1":case"localhost":case"p5play.org":case"editor.p5js.org":case"codepen.io":case"codera.app":case"cdpn.io":case"glitch.com":case"replit.com":case"stackblitz.com":case"jsfiddle.net":case"aijs-912fe.web.app":break;default:if(/^[\d\.]+$/.test(lh)||lh.endsWith("stackblitz.io")||lh.endsWith("glitch.me")||lh.endsWith("repl.co")||lh.endsWith("codehs.com")||lh.endsWith("openprocessing.org")||location.origin.endsWith("preview.p5js.org")){break}playIntro()}}let userDisabledP5Errors=p5.disableFriendlyErrors;p5.disableFriendlyErrors=true;this.canvas=this.canvas;const _createCanvas=this.createCanvas;this.createCanvas=function(){let args=[...arguments];let isFullScreen=false;let pixelated=false;let w,h,ratio;if(typeof args[0]=="string"){if(args[0].includes(":"))ratio=args[0].split(":");else{args[2]=args[0];args[0]=undefined}if(args[1]=="fullscreen")isFullScreen=true}if(!args[0]){args[0]=window.innerWidth;args[1]=window.innerHeight;isFullScreen=true}else if(typeof args[0]=="number"&&typeof args[1]!="number"){args[2]=args[1];args[1]=args[0]}let scale;if(typeof args[2]=="string"){let rend=args[2].toLowerCase();if(rend!="p2d"&&rend!="webgl"){rend=rend.split(" ");args.pop()}if(rend[0]=="pixelated"){pixelated=true;if(!rend[1])isFullScreen=true;else scale=Number(rend[1].slice(1));ratio=[args[0],args[1]]}if(rend[0]=="fullscreen"){isFullScreen=true}}if(ratio){let rW=Number(ratio[0]);let rH=Number(ratio[1]);if(!scale){w=window.innerWidth;h=window.innerWidth*(rH/rW);if(h>window.innerHeight){w=window.innerHeight*(rW/rH);h=window.innerHeight}}else{w=rW*scale;h=rH*scale}w=Math.round(w);h=Math.round(h);if(!pixelated){args[0]=w;args[1]=h}}let can=_createCanvas.call(pInst,...args);this.canvas.tabIndex=0;this.canvas.w=args[0];this.canvas.h=args[1];this.canvas.addEventListener("keydown",function(e){if(e.key==" "||e.key=="/"||e.key=="ArrowUp"||e.key=="ArrowDown"||e.key=="ArrowLeft"||e.key=="ArrowRight"){e.preventDefault()}});this.canvas.addEventListener("mouseover",()=>{this.mouse.isOnCanvas=true;this.mouse.active=true});this.canvas.addEventListener("mouseleave",()=>{this.mouse.isOnCanvas=false});this.canvas.addEventListener("touchstart",e=>e.preventDefault());this.canvas.addEventListener("contextmenu",e=>e.preventDefault());this.canvas.resize=this.resizeCanvas;this.canvas.hw=this.canvas.w*.5;this.canvas.hh=this.canvas.h*.5;this.camera.x=this.canvas.hw;this.camera.y=this.canvas.hh;if(!userDisabledP5Errors)p5.disableFriendlyErrors=false;let style=`
.p5Canvas, .q5Canvas {
	outline: none;
	-webkit-touch-callout: none;
	-webkit-text-size-adjust: none;
	-webkit-user-select: none;
	overscroll-behavior: none;
}
main {
	overscroll-behavior: none;
}`;if(isFullScreen){style="html,\nbody,\n"+style;style+=`
html, body {
	margin: 0;
	padding: 0;
	overflow: hidden;
	height: 100%;
}
main {
	margin: auto;
	display: flex;
	flex-wrap: wrap;
	align-content: center;
	justify-content: center;
	height: 100%;
}`}if(pixelated){style+=`
#${this.canvas.id} {
	image-rendering: pixelated;
	font-smooth: never;
	-webkit-font-smoothing: none;
	-moz-osx-font-smoothing: none;
	width: ${w}px!important;
	height: ${h}px!important;
}`}let styleElem=document.createElement("style");styleElem.innerHTML=style;document.head.appendChild(styleElem);if(pixelated){pInst.pixelDensity(1);pInst.noSmooth()}let idx=navigator.userAgent.indexOf("iPhone OS");if(idx>-1){let version=navigator.userAgent.substring(idx+10,idx+12);this.p5play.version=version;if(version<16){pInst.pixelDensity(1)}this.p5play.os.platform="iOS";this.p5play.os.version=version}else if(navigator.userAgentData!==undefined){this.p5play.os.platform=navigator.userAgentData.platform}return can};this.Canvas=class{constructor(w,h,mode){}get w(){}get width(){}get h(){}get height(){}resize(){}};this.Canvas=function(){return pInst.createCanvas(...arguments)};const _resizeCanvas=this.resizeCanvas;this.resizeCanvas=(w,h)=>{_resizeCanvas.call(this,w,h);this.canvas.hw=this.canvas.w*.5;this.canvas.hh=this.canvas.h*.5;this.camera._pos.x=this.canvas.hw;this.camera._pos.y=this.canvas.hh};const _background=this.background;this.background=function(){let args=arguments;let c;if(args.length==1&&(typeof args[0]=="string"||args[0]instanceof p5.Color)){c=this.colorPal(args[0])}if(c!==undefined)_background.call(this,c);else _background.call(this,...args)};const _fill=this.fill;this.fill=function(){let args=arguments;let c;if(args.length==1){c=this.colorPal(args[0])}if(c!==undefined)_fill.call(this,c);else _fill.call(this,...args)};const _stroke=this.stroke;this.stroke=function(){let args=arguments;let c;if(args.length==1){c=this.colorPal(args[0])}if(c!==undefined)_stroke.call(this,c);else _stroke.call(this,...args)};this.p5play.images={onLoad:img=>{}};this.p5play.disableImages=false;const _loadImage=this.loadImage;this.loadImage=this.loadImg=function(){if(this.p5play.disableImages){pInst._decrementPreload();return{w:16,width:16,h:16,height:16,pixels:[]}}let args=arguments;let url=args[0];let img=pInst.p5play.images[url];let cb;if(typeof args[args.length-1]=="function"){cb=args[args.length-1]}if(img){if(img.width==1&&img.height==1||!img.pixels.length){if(cb){img.cbs.push(cb);img.calls++}else pInst._decrementPreload()}else{if(cb)cb();pInst._decrementPreload()}return img}const _cb=_img=>{_img.w=_img.width;_img.h=_img.height;for(let cb of _img.cbs){cb(_img)}for(let i=1;i<_img.calls;i++){pInst._decrementPreload()}_img.cbs=[];pInst.p5play.images.onLoad(img)};img=_loadImage.call(pInst,url,_cb);img.cbs=[];img.calls=1;if(cb)img.cbs.push(cb);img.url=url;pInst.p5play.images[url]=img;return img};const _image=this.image;this.image=function(){if(pInst.p5play.disableImages)return;_image.call(pInst,...arguments)};if(typeof this._textCache==="undefined"){const $=this;$._textCache=true;$._TimedCache=class extends Map{constructor(){super();this.maxSize=500}set(k,v){v.lastAccessed=Date.now();super.set(k,v);if(this.size>this.maxSize)this.gc()}get(k){const v=super.get(k);if(v)v.lastAccessed=Date.now();return v}gc(){let t=Infinity;let oldest;let i=0;for(const[k,v]of this.entries()){if(v.lastAccessed<t){t=v.lastAccessed;oldest=i}i++}i=oldest;for(const k of this.keys()){if(i==0){oldest=k;break}i--}this.delete(oldest)}};$._tic=new $._TimedCache;$.textCache=(b,maxSize)=>{if(maxSize)$._tic.maxSize=maxSize;if(b!==undefined)$._textCache=b;return $._textCache};function _genTextImageKey(str,w,h){const ctx=$.canvas.getContext("2d");const r=$._renderer;let font=r._textFont;if(typeof font!="string"){font=font.font.names.fullName;font=font[Object.keys(font)[0]]}return str.slice(0,200)+(r._textStyle||"normal")+r._textSize+font+(r._doFill?ctx.fillStyle:"")+"_"+(r._doStroke&&r._strokeSet?ctx.lineWidth+ctx.strokeStyle+"_":"")+(w||"")+(h?"x"+h:"")}$.createTextImage=(str,w,h)=>{let og=$._textCache;$._textCache=true;$._useCache=true;$.text(str,0,0,w,h);$._useCache=false;let k=_genTextImageKey(str,w,h);$._textCache=og;return $._tic.get(k)};const _text=$.text;$.text=(str,x,y,w,h)=>{if(str===undefined)return;str=str.toString();const r=$._renderer;if(!r._doFill&&!r._doStroke)return;const ctx=$.canvas.getContext("2d");let t=ctx.getTransform();let useCache=$._useCache||$._textCache&&(t.b!=0||t.c!=0);if(!useCache)return _text.call($,str,x,y,w,h);let c,ti,k,cX,cY,_ascent,_descent;k=_genTextImageKey(str,w,h);ti=$._tic.get(k);if(ti){$.textImage(ti,x,y);return}let tg=$.createGraphics.call($,1,1);tg.textFont(r._textFont);if(r._textStyle)tg.textStyle(r._textStyle);tg.textSize(r._textSize);c=tg.canvas.getContext("2d");let lines=str.split("\n");cX=0;cY=r._textLeading*lines.length;let m=c.measureText(" ");_ascent=m.fontBoundingBoxAscent;_descent=m.fontBoundingBoxDescent;h??=cY+_descent;tg.resizeCanvas(Math.ceil(tg.textWidth(str)),Math.ceil(h));c.fillStyle=ctx.fillStyle;c.strokeStyle=ctx.strokeStyle;c.lineWidth=ctx.lineWidth;let f=c.fillStyle;if(!r._fillSet)c.fillStyle="black";for(let i=0;i<lines.length;i++){tg.text(lines[i],cX,cY);cY+=r._textLeading;if(cY>h)break}if(!r._fillSet)c.fillStyle=f;ti=tg.get();let pd=$.pixelDensity();ti.width/=pd;ti.height/=pd;ti._ascent=_ascent;ti._descent=_descent;$._tic.set(k,ti);$.textImage(ti,x,y)};$.textImage=(img,x,y)=>{let og=$._renderer._imageMode;$.imageMode.call($,"corner");const ctx=$.canvas.getContext("2d");if(ctx.textAlign=="center")x-=img.width*.5;else if(ctx.textAlign=="right")x-=img.width;let leadDiff;if(ctx.textBaseline=="alphabetic")y-=$._renderer._textLeading;else leadDiff=$._renderer._textLeading-$._renderer._textSize;if(ctx.textBaseline=="middle")y-=img._descent+img._ascent*.5+leadDiff;else if(ctx.textBaseline=="bottom")y-=img._ascent+img._descent+leadDiff;else if(ctx.textBaseline=="top")y-=img._descent+leadDiff;$.image.call($,img,x,y);$.imageMode.call($,og)}}let errMsgs={generic:["Ah! I found an error","Oh no! Something went wrong","Oof! Something went wrong","Houston, we have a problem","Whoops, having trouble here"],Sprite:{constructor:{base:"Sorry I'm unable to make a new Sprite",0:"What is $0 for? If you're trying to specify the x position of the sprite, please specify the y position as well.",1:"If you're trying to specify points for a chain Sprite, please use an array of position arrays.\n$0",2:"Invalid input parameters: $0"},hw:{0:"I can't change the halfWidth of a Sprite directly, change the sprite's width instead."},hh:{1:"I can't change the halfHeight of a Sprite directly, change the sprite's height instead."},rotate:{0:"Can't use this function on a sprite with a static collider, try changing the sprite's collider type to kinematic.",1:'Can\'t use "$0" for the angle of rotation, it must be a number.'},rotateTo:{},rotateTowards:{},changeAnimation:`I can't find any animation named "$0".`,collide:{0:"I can't make that sprite collide with $0. Sprites can only collide with another sprite or a group.",1:"The collision callback has to be a function.",2:"You're trying to check for an collision with a sprite or group that doesn't exist!"},overlap:{0:"I can't make that sprite overlap with $0. Sprites can only overlap with another sprite or a group.",1:"The overlap callback has to be a function.",2:"You're trying to check for an overlap with a sprite or group that doesn't exist!"}},SpriteAnimation:{constructor:{base:"Hey so, I tried to make a new SpriteAnimation but couldn't",0:`I don't know how to display this type of image: "$0". I can only use ".png" image files.`,1:"The name of the animation must be the first input parameter."},frame:"Index $0 out of bounds. That means there is no frame $0 in this animation. It only has $1 frames!"},Group:{constructor:{base:"Hmm awkward! Well it seems I can't make that new Group you wanted"}}};errMsgs.Group.collide=errMsgs.Sprite.collide;errMsgs.Group.overlap=errMsgs.Sprite.overlap;errMsgs.Sprite.rotateTo[0]=errMsgs.Sprite.rotateTowards[0]=errMsgs.Sprite.rotate[0];class FriendlyError extends Error{constructor(func,errorNum,e){super();if(typeof func!="string"){e=errorNum;errorNum=func;func=this.stack.match(/\n\s*at ([^\(]*)/)[1];func=func.slice(0,-1)}if(typeof errorNum!="number"){e=errorNum;errorNum=undefined}if(func.slice(0,3)=="new")func=func.slice(4);func=func.split(".");let className=func[0];func=func[1]||"constructor";let ln=this.stack.match(/\/([^p\/][^5][^\/:]*:[^\/:]+):/);if(ln){ln=ln[1].split(":");ln=" in "+ln[0]+" at line "+ln[1]}ln=" using "+className+"."+func+". ";e=e||[];let m=errMsgs[className][func];let msg;if(m.base)msg=m.base+ln;else msg=errMsgs.generic[Math.floor(Math.random()*errMsgs.generic.length)]+ln;if(errorNum!==undefined)m=m[errorNum];m=m.replace(/\$([0-9]+)/g,(m,n)=>{return e[n]});msg+=m;p5._friendlyError(msg,func)}}this.allSprites=new this.Group;this.world=new this.World;this.camera=new this.Camera;this.InputDevice=class{constructor(){this.holdThreshold=12;this._default=0}_init(inputs){for(let inp of inputs){this[inp]=0}}_ac(inp){return inp}presses(inp){inp??=this._default;if(this[inp]===undefined)inp=this._ac(inp);return this[inp]==1||this[inp]==-3}pressing(inp){inp??=this._default;if(this[inp]===undefined)inp=this._ac(inp);if(this[inp]==-3)return 1;return this[inp]>0?this[inp]:0}pressed(inp){return this.released(inp)}holds(inp){inp??=this._default;if(this[inp]===undefined)inp=this._ac(inp);return this[inp]==this.holdThreshold}holding(inp){inp??=this._default;if(this[inp]===undefined)inp=this._ac(inp);return this[inp]>=this.holdThreshold?this[inp]:0}held(inp){inp??=this._default;if(this[inp]===undefined)inp=this._ac(inp);return this[inp]==-2}released(inp){inp??=this._default;if(this[inp]===undefined)inp=this._ac(inp);return this[inp]<=-1}releases(inp){return this.released(inp)}};this._Mouse=class extends this.InputDevice{constructor(){super();this._default="left";let _this=this;this._pos=pInst.createVector.call(pInst);Object.defineProperty(this._pos,"x",{get(){return _this.x},set(val){_this.x=val}});Object.defineProperty(this._pos,"y",{get(){return _this.y},set(val){_this.y=val}});this.x;this.y;this.left;this.center;this.right;let inputs=["x","y","left","center","right"];this._init(inputs);this.drag={left:0,center:0,right:0};this.isOnCanvas=false;this.active=false;this._visible=true;this._cursor="default"}_ac(inp){inp=inp.toLowerCase();if(inp.slice(0,4)=="left")inp="left";else if(inp.slice(0,5)=="right")inp="right";else if(inp.slice(0,6)=="middle")inp="center";return inp}update(){this.x=(pInst.mouseX-pInst.canvas.hw)/pInst.camera.zoom+pInst.camera.x;this.y=(pInst.mouseY-pInst.canvas.hh)/pInst.camera.zoom+pInst.camera.y;pInst.camera.mouse.x=pInst.mouseX;pInst.camera.mouse.y=pInst.mouseY}get pos(){return this._pos}get position(){return this._pos}get cursor(){return pInst.canvas.style.cursor}set cursor(val){if(val!=this._cursor){pInst.cursor(val);this._cursor=val}}get visible(){return this._visible}set visible(val){this._visible=val;if(val)pInst.canvas.style.cursor="default";else pInst.canvas.style.cursor="none"}drags(inp){inp??=this._default;return this.drag[inp]==1}dragging(inp){inp??=this._default;return this.drag[inp]>0?this.drag[inp]:0}dragged(inp){inp??=this._default;return this.drag[inp]<=-1}};this.mouse=new this._Mouse;this._SpriteMouse=class extends this._Mouse{constructor(){super();this.hover=0}hovers(){return this.hover==1}hovering(){return this.hover>0?this.hover:0}hovered(){return this.hover<=-1}};const __onmousedown=function(btn){this.mouse.active=true;this.mouse[btn]++;if(this.world.mouseSprites.length){let msm=this.world.mouseSprite?.mouse;if(msm){msm[btn]=0;msm.hover=0;msm.drag[btn]=0}ms=this.world.mouseSprites[0];this.world.mouseSprite=ms;msm=ms.mouse;msm[btn]=1;if(msm.hover<=0)msm.hover=1}};const _onmousedown=pInst._onmousedown;pInst._onmousedown=function(e){if(!this._setupDone)return;let btn="left";if(e.button===1)btn="center";else if(e.button===2)btn="right";__onmousedown.call(this,btn);_onmousedown.call(this,e)};const _ontouchstart=pInst._ontouchstart;pInst._ontouchstart=function(e){if(!this._setupDone)return;_ontouchstart.call(this,e);let touch=this.touches.at(-1);touch.duration=0;touch.presses=function(){return this.duration==1||this.duration==-3};touch.pressing=function(){return this.duration>0?this.duration:0};touch.released=function(){return this.duration<=-1};if(this.touches.length==1){this.mouse.update();this.world.mouseSprites=this.world.getMouseSprites()}__onmousedown.call(this,"left")};const __onmousemove=function(btn){let m=this.mouse;if(m[btn]>0&&m.drag[btn]<=0){m.drag[btn]=1;let ms=this.world.mouseSprite?.mouse;if(ms){ms.drag[btn]=1}}};const _onmousemove=pInst._onmousemove;pInst._onmousemove=function(e){if(!this._setupDone)return;let btn="left";if(e.button===1)btn="center";else if(e.button===2)btn="right";__onmousemove.call(this,btn);_onmousemove.call(this,e)};const _ontouchmove=pInst._ontouchmove;pInst._ontouchmove=function(e){if(!this._setupDone)return;_ontouchmove.call(this,e);__onmousemove.call(this,"left")};const __onmouseup=function(btn){let m=this.mouse;if(m[btn]>=m.holdThreshold){m[btn]=-2}else if(m[btn]>1)m[btn]=-1;else m[btn]=-3;if(m.drag[btn]>0)m.drag[btn]=-1;let msm=this.world.mouseSprite?.mouse;if(msm){if(msm.hover>1){if(msm[btn]>=this.mouse.holdThreshold){msm[btn]=-2}else if(msm[btn]>1){msm[btn]=-1}else{msm[btn]=-3}if(msm.drag[btn]>0)msm.drag[btn]=-1}else{msm[btn]=0;msm.drag[btn]=0}}};const _onmouseup=pInst._onmouseup;pInst._onmouseup=function(e){if(!this._setupDone)return;let btn="left";if(e.button===1)btn="center";else if(e.button===2)btn="right";__onmouseup.call(this,btn);_onmouseup.call(this,e)};const _ontouchend=pInst._ontouchend;pInst._ontouchend=function(e){if(!this._setupDone)return;_ontouchend.call(this,e);__onmouseup.call(this,"left")};delete this._Mouse;this._KeyBoard=class extends this.InputDevice{#test;constructor(){super();this._default=" ";this.alt=0;this.arrowUp=0;this.arrowDown=0;this.arrowLeft=0;this.arrowRight=0;this.backspace=0;this.capsLock=0;this.control=0;this.enter=0;this.meta=0;this.shift=0;this.tab=0;let k=this._simpleKeyControls={arrowUp:"up",arrowDown:"down",arrowLeft:"left",arrowRight:"right"};k.w=k.W="up";k.s=k.S="down";k.a=k.A="left";k.d=k.D="right";k.i=k.I="up2";k.k=k.K="down2";k.j=k.J="left2";k.l=k.L="right2"}_ac(inp){if(inp.length!=1){if(!isNaN(inp)){if(inp==38)return"arrowUp";if(inp==40)return"arrowDown";if(inp==37)return"arrowLeft";if(inp==39)return"arrowRight";if(inp>=10){throw new Error("Use key names with the keyboard input functions, not keyCode numbers!")}return inp}inp=inp.replaceAll(/[ _-]/g,"")}inp=inp.toLowerCase();if(inp.length!=1){if(inp=="arrowup")return"arrowUp";if(inp=="arrowdown")return"arrowDown";if(inp=="arrowleft")return"arrowLeft";if(inp=="arrowright")return"arrowRight";if(inp=="capslock")return"capsLock"}return inp}_pre(k){if(!this[k]||this[k]<0){this[k]=1}}_rel(k){if(this[k]>=this.holdThreshold){this[k]=-2}else if(this[k]>1)this[k]=-1;else this[k]=-3}get cmd(){return this["meta"]}get command(){return this["meta"]}get ctrl(){return this["control"]}get space(){return this[" "]}get spacebar(){return this[" "]}get opt(){return this["alt"]}get option(){return this["alt"]}get win(){return this["meta"]}get windows(){return this["meta"]}};this.kb=new this._KeyBoard;delete this._KeyBoard;this.keyboard=this.kb;if(navigator.keyboard){const keyboard=navigator.keyboard;if(window==window.top){keyboard.getLayoutMap().then(keyboardLayoutMap=>{const key=keyboardLayoutMap.get("KeyW");if(key!="w")this.p5play.standardizeKeyboard=true})}else{this.p5play.standardizeKeyboard=true}}else{this.p5play.standardizeKeyboard=true}function _getKeyFromCode(e){let code=e.code;if(code.length==4&&code.slice(0,3)=="Key"){return code[3].toLowerCase()}return e.key}const _onkeydown=pInst._onkeydown;pInst._onkeydown=function(e){let key=e.key;if(this.p5play.standardizeKeyboard){key=_getKeyFromCode(e)}if(key.length>1){key=key[0].toLowerCase()+key.slice(1)}else{let lower=key.toLowerCase();let upper=key.toUpperCase();if(lower!=upper){if(key!=upper)this.kb._pre(upper);else this.kb._pre(lower)}}this.kb._pre(key);let k=this.kb._simpleKeyControls[key];if(k)this.kb._pre(k);_onkeydown.call(this,e)};const _onkeyup=pInst._onkeyup;pInst._onkeyup=function(e){let key=e.key;if(this.p5play.standardizeKeyboard){key=_getKeyFromCode(e)}if(key.length>1){key=key[0].toLowerCase()+key.slice(1)}else{let lower=key.toLowerCase();let upper=key.toUpperCase();if(lower!=upper){if(key!=upper)this.kb._rel(upper);else this.kb._rel(lower)}}this.kb._rel(key);let k=this.kb._simpleKeyControls[key];if(k)this.kb._rel(k);if(e.shiftKey){let k=key.toLowerCase();if(this.kb[k]>0)this.kb._rel(k)}_onkeyup.call(this,e)};this._Contro=class extends this.InputDevice{constructor(gp){super();this._default="a";this.connected=true;let inputs=["a","b","x","y","l","r","lt","rt","select","start","lsb","rsb","up","down","left","right","leftTrigger","rightTrigger"];this._init(inputs);this.leftStick={x:0,y:0};this.rightStick={x:0,y:0};this._btns={a:0,b:1,x:2,y:3,l:4,r:5,lt:6,rt:7,select:8,start:9,lsb:10,rsb:11,up:12,down:13,left:14,right:15};this._axes={leftStick:{x:0,y:1},rightStick:{x:2,y:3},leftTrigger:4,rightTrigger:5};if(gp.id.includes("GuliKit")){this._btns.a=1;this._btns.b=0;this._btns.x=3;this._btns.y=2}this.gamepad=gp;this.id=gp.id}_ac(inp){inp=inp.toLowerCase();if(inp=="lb")inp="l";else if(inp=="rb")inp="r";else if(inp=="leftstickbutton")inp="lsb";else if(inp=="rightstickbutton")inp="rsb";return inp}_update(){if(!this.connected)return;this.gamepad=navigator.getGamepads()[this.gamepad.index];if(!this.gamepad?.connected)return;let pad=this.gamepad;for(let name in this._btns){let idx=this._btns[name];let b=pad.buttons[idx];if(!b)continue;if(b.pressed)this[name]++;else this[name]=this[name]>0?-1:0}this.leftStick.x=pad.axes[this._axes.leftStick.x];this.leftStick.y=pad.axes[this._axes.leftStick.y];this.rightStick.x=pad.axes[this._axes.rightStick.x];this.rightStick.y=pad.axes[this._axes.rightStick.y];if(pad.axes[this._axes.leftTrigger]!==undefined){this.leftTrigger=pad.axes[this._axes.leftTrigger];this.rightTrigger=pad.axes[this._axes.rightTrigger]}else{this.leftTrigger=pad.buttons[this._btns.lt].value;this.rightTrigger=pad.buttons[this._btns.rt].value}return true}get ls(){return this.leftStick}get rs(){return this.rightStick}get lb(){return this.l}get rb(){return this.r}get leftStickButton(){return this.lsb}get rightStickButton(){return this.rsb}};this._Contros=class extends Array{constructor(){super();let _this=this;window.addEventListener("gamepadconnected",e=>{_this._onConnect(e.gamepad)});window.addEventListener("gamepaddisconnected",e=>{_this._onDisconnect(e.gamepad)});this.presses;this.pressing;this.pressed;this.holds;this.holding;this.held;this.released;let methods=["presses","pressing","pressed","holds","holding","held","released"];for(let m of methods){this[m]=inp=>{if(this[0])return this[0][m](inp)}}this.a=0;this.b=0;this.x=0;this.y=0;this.l=0;this.r=0;this.lt=0;this.rt=0;this.select=0;this.start=0;this.lsb=0;this.rsb=0;this.up=0;this.down=0;this.left=0;this.right=0;this.leftTrigger=0;this.rightTrigger=0;this.lb=0;this.rb=0;this.leftStickButton=0;this.rightStickButton=0;let props=["connected","a","b","x","y","l","r","lt","rt","select","start","lsb","rsb","up","down","left","right","leftTrigger","rightTrigger","lb","rb","leftStickButton","rightStickButton"];for(let prop of props){Object.defineProperty(this,prop,{get(){if(_this[0])return _this[0][prop];return 0}})}this.leftStick;this.rightStick;props=["leftStick","rightStick"];for(let prop of props){this[prop]={};for(let axis of["x","y"]){Object.defineProperty(this[prop],axis,{get(){if(_this[0])return _this[0][prop][axis];return 0}})}}if(!navigator?.getGamepads)return;let gps=navigator.getGamepads();for(let gp of gps){if(gp)this._onConnect(gp)}}_onConnect(gp){if(!gp)return;for(let i=0;i<this.length;i++){if(this[i].gamepad?.index===gp.index){this[i].connected=true;log("contro["+i+"] reconnected: "+gp.id);return}}log(gp);log("contro["+gp.index+"] connected: "+gp.id);let c=new pInst._Contro(gp);this.push(c)}_onDisconnect(gp){if(!gp)return;for(let i=0;i<this.length;i++){if(this[i].gamepad?.index===gp.index){this[i].connected=false;log("contro["+i+"] disconnected: "+gp.id);return}}}_update(){for(let c of this){c._update()}}};this.contro=new this._Contros;delete this._Contros;this.controllers=this.contro;if(!this.getFPS)this.p5play._fps=60;this.getFPS??=()=>this.p5play._fps;this.p5play._fpsArr=[60];this.renderStats=(x,y)=>{let rs=this.p5play._renderStats;if(rs.show===undefined){if(this.allSprites.tileSize==1||this.allSprites.tileSize>16){rs.fontSize=16}else{rs.fontSize=10}rs.gap=rs.fontSize*1.25;console.warn("renderStats() uses inaccurate FPS approximations. Even if your game runs at a solid 60hz display rate, the fps calculations shown may be lower. The only way to get accurate results is to use your web browser's performance testing tools.")}rs.x=x||10;rs.y=y||20;rs.show=true}});p5.prototype.registerMethod("pre",function p5playPreDraw(){if(this.p5play._fps){this.p5play._preDrawFrameTime=performance.now()}this.p5play.spritesDrawn=0;this.mouse.update();this.contro._update()});p5.prototype.registerMethod("post",function p5playPostDraw(){this.p5play._inPostDraw=true;if(this.allSprites.autoCull){this.allSprites.cull(1e4)}if(this.allSprites._autoDraw){this.camera.on();this.allSprites.draw();this.camera.off()}this.allSprites._autoDraw??=true;let rs=this.p5play._renderStats;if(rs.show){if(this.frameCount==1||this.frameCount%60===0){let avg=this.p5play._fpsArr.reduce((a,b)=>a+b);avg=Math.round(avg/this.p5play._fpsArr.length);this.p5play._fpsAvg=avg;this.p5play._fpsMin=Math.min(...this.p5play._fpsArr);this.p5play._fpsMax=Math.max(...this.p5play._fpsArr);this.p5play._fpsArr=[];let c;if(avg>55)c=this.color(30,255,30);else if(avg>25)c=this.color(255,100,30);else c=this.color(255,30,30);this.p5play._statsColor=c}this.p5play._fpsArr.push(this.getFPS());this.push();this.fill(0,0,0,128);this.rect(rs.x-5,rs.y-rs.fontSize,rs.fontSize*8.5,rs.gap*4+5);this.fill(this.p5play._statsColor);this.textAlign("left");this.textSize(rs.fontSize);this.textFont("monospace");let x=rs.x;let y=rs.y;this.text("sprites: "+this.p5play.spritesDrawn,x,y);this.text("fps avg: "+this.p5play._fpsAvg,x,y+rs.gap);this.text("fps min: "+this.p5play._fpsMin,x,y+rs.gap*2);this.text("fps max: "+this.p5play._fpsMax,x,y+rs.gap*3);this.pop();rs.show=false}if(this.world.autoStep){this.world.step()}this.world.autoStep??=true;if(this.allSprites._autoUpdate){this.allSprites.update()}this.allSprites._autoUpdate??=true;for(let s of this.allSprites){s.autoDraw??=true;s.autoUpdate??=true}for(let k in this.kb){if(k=="holdThreshold")continue;if(this.kb[k]<0)this.kb[k]=0;else if(this.kb[k]>0)this.kb[k]++}let m=this.mouse;let msm=this.world.mouseSprite?.mouse;for(let btn of["left","center","right"]){if(m[btn]<0)m[btn]=0;else if(m[btn]>0)m[btn]++;if(msm?.hover)msm[btn]=m[btn];if(m.drag[btn]<0)m.drag[btn]=0;else if(m.drag[btn]>0)m.drag[btn]++;if(msm)msm.drag[btn]=m.drag[btn]}if(this.world.mouseTracking){let sprites=this.world.getMouseSprites();for(let i=0;i<sprites.length;i++){let s=sprites[i];if(i==0)s.mouse.hover++;else if(s.mouse.hover>0)s.mouse.hover=-1;else if(s.mouse.hover<0)s.mouse.hover=0}if(m.left<=0&&m.center<=0&&m.right<=0){this.world.mouseSprite=null}let ms=this.world.mouseSprite;let isDragging=m.drag.left>0||m.drag.center>0||m.drag.right>0;for(let s of this.world.mouseSprites){if(!sprites.includes(s)){let sm=s.mouse;if(sm.hover>0){sm.hover=-1;sm.left=sm.center=sm.right=0}if(!isDragging&&s==ms)this.world.mouseSprite=ms=null}}if(ms){if(!sprites.includes(ms))sprites.push(ms);msm.x=ms.x-m.x;msm.y=ms.y-m.y}this.world.mouseSprites=sprites}this.camera.off();if(this.p5play._fps){this.p5play._postDrawFrameTime=performance.now();this.p5play._fps=Math.round(1e3/(this.p5play._postDrawFrameTime-this.p5play._preDrawFrameTime))||1}this.p5play._inPostDraw=false});